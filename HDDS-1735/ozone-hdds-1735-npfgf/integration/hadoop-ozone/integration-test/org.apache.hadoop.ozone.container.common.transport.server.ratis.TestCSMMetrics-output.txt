2019-07-03 22:46:56,478 INFO  ozone.RatisTestHelper (RatisTestHelper.java:initRatisConf(109)) - dfs.container.ratis.rpc.type = GRPC
2019-07-03 22:46:56,994 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-07-03 22:46:57,060 INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(45)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2019-07-03 22:46:57,065 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 41980 (custom)
2019-07-03 22:46:57,066 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-07-03 22:46:57,068 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-07-03 22:46:57,069 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-07-03 22:46:57,070 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-07-03 22:46:57,219 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/c64945bf-ba68-4b9d-b930-a3da956ac392] (custom)
2019-07-03 22:46:57,226 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(428)) - Starting XceiverServerRatis c64945bf-ba68-4b9d-b930-a3da956ac392 at port 41980
2019-07-03 22:46:57,240 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - c64945bf-ba68-4b9d-b930-a3da956ac392: start RPC server
2019-07-03 22:46:57,328 INFO  server.GrpcService (GrpcService.java:startImpl(149)) - c64945bf-ba68-4b9d-b930-a3da956ac392: GrpcService started, listening on 0.0.0.0/0.0.0.0:41980
2019-07-03 22:46:57,921 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - c64945bf-ba68-4b9d-b930-a3da956ac392: addNew group-1BDBC8AF8BED:[c64945bf-ba68-4b9d-b930-a3da956ac392:0.0.0.0:41980] returns group-1BDBC8AF8BED:java.util.concurrent.CompletableFuture@fa9fc77[Not completed]
2019-07-03 22:46:57,961 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(93)) - c64945bf-ba68-4b9d-b930-a3da956ac392: new RaftServerImpl for group-1BDBC8AF8BED:[c64945bf-ba68-4b9d-b930-a3da956ac392:0.0.0.0:41980] with ContainerStateMachine:uninitialized
2019-07-03 22:46:57,962 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-07-03 22:46:57,963 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-07-03 22:46:57,965 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-07-03 22:46:57,966 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-07-03 22:46:57,967 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-07-03 22:46:57,974 INFO  impl.RaftServerImpl (ServerState.java:<init>(105)) - c64945bf-ba68-4b9d-b930-a3da956ac392:group-1BDBC8AF8BED ConfigurationManager, init=-1: [c64945bf-ba68-4b9d-b930-a3da956ac392:0.0.0.0:41980], old=null, confs=<EMPTY_MAP>
2019-07-03 22:46:57,975 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/c64945bf-ba68-4b9d-b930-a3da956ac392] (custom)
2019-07-03 22:46:57,983 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/c64945bf-ba68-4b9d-b930-a3da956ac392/ab93d0f9-9a26-4ce8-9e14-1bdbc8af8bed does not exist. Creating ...
2019-07-03 22:46:58,006 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/c64945bf-ba68-4b9d-b930-a3da956ac392/ab93d0f9-9a26-4ce8-9e14-1bdbc8af8bed/in_use.lock acquired by nodename 4493@ozone-hdds-1735-npfgf-2442002169
2019-07-03 22:46:58,032 INFO  storage.RaftStorage (RaftStorage.java:format(72)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/c64945bf-ba68-4b9d-b930-a3da956ac392/ab93d0f9-9a26-4ce8-9e14-1bdbc8af8bed has been successfully formatted.
2019-07-03 22:46:58,034 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(198)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-07-03 22:46:58,034 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-07-03 22:46:58,036 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-07-03 22:46:58,041 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000000 (custom)
2019-07-03 22:46:58,041 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-07-03 22:46:58,042 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-07-03 22:46:58,046 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-07-03 22:46:58,051 INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(172)) - new c64945bf-ba68-4b9d-b930-a3da956ac392-SegmentedRaftLogWorker:Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/c64945bf-ba68-4b9d-b930-a3da956ac392/ab93d0f9-9a26-4ce8-9e14-1bdbc8af8bed for RaftStorage:Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/c64945bf-ba68-4b9d-b930-a3da956ac392/ab93d0f9-9a26-4ce8-9e14-1bdbc8af8bed
2019-07-03 22:46:58,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-07-03 22:46:58,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-07-03 22:46:58,117 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-07-03 22:46:58,118 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-07-03 22:46:58,118 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-07-03 22:46:58,119 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-07-03 22:46:58,120 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-07-03 22:46:58,120 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-07-03 22:46:58,120 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-07-03 22:46:58,128 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-07-03 22:46:58,133 INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(132)) - c64945bf-ba68-4b9d-b930-a3da956ac392-SegmentedRaftLogWorker:Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/c64945bf-ba68-4b9d-b930-a3da956ac392/ab93d0f9-9a26-4ce8-9e14-1bdbc8af8bed: flushIndex: setUnconditionally 0 -> -1
2019-07-03 22:46:58,136 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-07-03 22:46:58,137 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-07-03 22:46:58,138 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-07-03 22:46:58,156 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(180)) - c64945bf-ba68-4b9d-b930-a3da956ac392: start group-1BDBC8AF8BED
2019-07-03 22:46:58,157 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(171)) - c64945bf-ba68-4b9d-b930-a3da956ac392:group-1BDBC8AF8BED changes role from null to FOLLOWER at term 0 for startAsFollower
2019-07-03 22:46:58,158 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c64945bf-ba68-4b9d-b930-a3da956ac392: start FollowerState
2019-07-03 22:46:58,160 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-1BDBC8AF8BED,id=c64945bf-ba68-4b9d-b930-a3da956ac392
2019-07-03 22:46:58,463 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(255)) - client-384E1A83EE19->c64945bf-ba68-4b9d-b930-a3da956ac392: receive RaftClientReply:client-384E1A83EE19->c64945bf-ba68-4b9d-b930-a3da956ac392@group-1BDBC8AF8BED, cid=1, FAILED org.apache.ratis.protocol.NotLeaderException: Server c64945bf-ba68-4b9d-b930-a3da956ac392 is not the leader (null). Request must be sent to leader., logIndex=0, commits[c64945bf-ba68-4b9d-b930-a3da956ac392:c-1]
2019-07-03 22:46:59,257 INFO  impl.FollowerState (FollowerState.java:run(106)) - c64945bf-ba68-4b9d-b930-a3da956ac392:group-1BDBC8AF8BED changes to CANDIDATE, lastRpcTime:1099, electionTimeout:1098ms
2019-07-03 22:46:59,258 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - c64945bf-ba68-4b9d-b930-a3da956ac392: shutdown FollowerState
2019-07-03 22:46:59,258 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(171)) - c64945bf-ba68-4b9d-b930-a3da956ac392:group-1BDBC8AF8BED changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-07-03 22:46:59,261 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c64945bf-ba68-4b9d-b930-a3da956ac392: start LeaderElection
2019-07-03 22:46:59,277 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - c64945bf-ba68-4b9d-b930-a3da956ac392:group-1BDBC8AF8BED:LeaderElection1: begin an election at term 1 for -1: [c64945bf-ba68-4b9d-b930-a3da956ac392:0.0.0.0:41980], old=null
2019-07-03 22:46:59,279 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - c64945bf-ba68-4b9d-b930-a3da956ac392: shutdown LeaderElection
2019-07-03 22:46:59,280 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(171)) - c64945bf-ba68-4b9d-b930-a3da956ac392:group-1BDBC8AF8BED changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-07-03 22:46:59,280 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - c64945bf-ba68-4b9d-b930-a3da956ac392:group-1BDBC8AF8BED change Leader from null to c64945bf-ba68-4b9d-b930-a3da956ac392 at term 1 for becomeLeader, leader elected after 1246ms
2019-07-03 22:46:59,288 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-07-03 22:46:59,289 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-07-03 22:46:59,292 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-07-03 22:46:59,296 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-07-03 22:46:59,296 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-07-03 22:46:59,298 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-07-03 22:46:59,309 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c64945bf-ba68-4b9d-b930-a3da956ac392: start LeaderState
2019-07-03 22:46:59,331 INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(380)) - c64945bf-ba68-4b9d-b930-a3da956ac392-SegmentedRaftLogWorker:Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/c64945bf-ba68-4b9d-b930-a3da956ac392/ab93d0f9-9a26-4ce8-9e14-1bdbc8af8bed: Starting segment from index:0
2019-07-03 22:46:59,340 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - c64945bf-ba68-4b9d-b930-a3da956ac392:group-1BDBC8AF8BED set configuration 0: [c64945bf-ba68-4b9d-b930-a3da956ac392:0.0.0.0:41980], old=null at 0
2019-07-03 22:46:59,563 INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(569)) - c64945bf-ba68-4b9d-b930-a3da956ac392-SegmentedRaftLogWorker:Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/c64945bf-ba68-4b9d-b930-a3da956ac392/ab93d0f9-9a26-4ce8-9e14-1bdbc8af8bed: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/c64945bf-ba68-4b9d-b930-a3da956ac392/ab93d0f9-9a26-4ce8-9e14-1bdbc8af8bed/current/log_inprogress_0
2019-07-03 22:47:00,641 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(255)) - client-384E1A83EE19->c64945bf-ba68-4b9d-b930-a3da956ac392: receive RaftClientReply:client-384E1A83EE19->c64945bf-ba68-4b9d-b930-a3da956ac392@group-1BDBC8AF8BED, cid=1, SUCCESS, logIndex=1, commits[c64945bf-ba68-4b9d-b930-a3da956ac392:c1]
2019-07-03 22:47:00,667 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(255)) - client-384E1A83EE19->c64945bf-ba68-4b9d-b930-a3da956ac392: receive RaftClientReply:client-384E1A83EE19->c64945bf-ba68-4b9d-b930-a3da956ac392@group-1BDBC8AF8BED, cid=2, SUCCESS, logIndex=0, commits[c64945bf-ba68-4b9d-b930-a3da956ac392:c2]
2019-07-03 22:47:00,677 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - c64945bf-ba68-4b9d-b930-a3da956ac392: close
2019-07-03 22:47:00,678 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(245)) - c64945bf-ba68-4b9d-b930-a3da956ac392: shutdown group-1BDBC8AF8BED
2019-07-03 22:47:00,679 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-1BDBC8AF8BED,id=c64945bf-ba68-4b9d-b930-a3da956ac392
2019-07-03 22:47:00,679 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - c64945bf-ba68-4b9d-b930-a3da956ac392: shutdown LeaderState
2019-07-03 22:47:00,680 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - c64945bf-ba68-4b9d-b930-a3da956ac392-PendingRequests: sendNotLeaderResponses
2019-07-03 22:47:00,684 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(115)) - StateMachineUpdater:c64945bf-ba68-4b9d-b930-a3da956ac392:group-1BDBC8AF8BED: set stopIndex = 2
2019-07-03 22:47:00,684 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(244)) - Taking snapshot at termIndex:(t:1, i:1)
2019-07-03 22:47:00,685 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(248)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/c64945bf-ba68-4b9d-b930-a3da956ac392/ab93d0f9-9a26-4ce8-9e14-1bdbc8af8bed/sm/snapshot.1_1
2019-07-03 22:47:00,697 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(242)) - StateMachineUpdater:c64945bf-ba68-4b9d-b930-a3da956ac392:group-1BDBC8AF8BED: Took a snapshot at index 1
2019-07-03 22:47:00,698 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(80)) - StateMachineUpdater:c64945bf-ba68-4b9d-b930-a3da956ac392:group-1BDBC8AF8BED: snapshotIndex: updateIncreasingly -1 -> 1
2019-07-03 22:47:00,707 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - c64945bf-ba68-4b9d-b930-a3da956ac392:group-1BDBC8AF8BED closes. The last applied log index is 2
2019-07-03 22:47:00,709 INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(313)) - c64945bf-ba68-4b9d-b930-a3da956ac392-SegmentedRaftLogWorker:Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/c64945bf-ba68-4b9d-b930-a3da956ac392/ab93d0f9-9a26-4ce8-9e14-1bdbc8af8bed was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-07-03 22:47:00,710 INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(228)) - c64945bf-ba68-4b9d-b930-a3da956ac392-SegmentedRaftLogWorker:Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/c64945bf-ba68-4b9d-b930-a3da956ac392/ab93d0f9-9a26-4ce8-9e14-1bdbc8af8bed close()
2019-07-03 22:47:00,711 INFO  server.GrpcService (GrpcService.java:closeImpl(155)) - c64945bf-ba68-4b9d-b930-a3da956ac392: shutdown server with port 41980 now
2019-07-03 22:47:00,715 INFO  server.GrpcService (GrpcService.java:closeImpl(163)) - c64945bf-ba68-4b9d-b930-a3da956ac392: shutdown server with port 41980 successfully
