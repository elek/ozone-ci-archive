2019-07-04 03:24:41,995 INFO  ozone.RatisTestHelper (RatisTestHelper.java:initRatisConf(109)) - dfs.container.ratis.rpc.type = GRPC
2019-07-04 03:24:42,555 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-07-04 03:24:42,619 INFO  grpc.GrpcFactory (GrpcFactory.java:checkPooledByteBufAllocatorUseCacheForAllThreads(45)) - PERFORMANCE WARNING: useCacheForAllThreads is true that may cause Netty to create a lot garbage objects and, as a result, trigger GC.
	It is recommended to disable useCacheForAllThreads by setting -Dorg.apache.ratis.thirdparty.io.netty.allocator.useCacheForAllThreads=false in command line.
2019-07-04 03:24:42,624 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 35625 (custom)
2019-07-04 03:24:42,625 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-07-04 03:24:42,627 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-07-04 03:24:42,628 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-07-04 03:24:42,629 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-07-04 03:24:42,796 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/386bf1d3-e008-478f-8bb2-1f11de0f2f4a] (custom)
2019-07-04 03:24:42,803 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(428)) - Starting XceiverServerRatis 386bf1d3-e008-478f-8bb2-1f11de0f2f4a at port 35625
2019-07-04 03:24:42,818 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a: start RPC server
2019-07-04 03:24:42,910 INFO  server.GrpcService (GrpcService.java:startImpl(149)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a: GrpcService started, listening on 0.0.0.0/0.0.0.0:35625
2019-07-04 03:24:43,542 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a: addNew group-58F2912D5FAD:[386bf1d3-e008-478f-8bb2-1f11de0f2f4a:0.0.0.0:35625] returns group-58F2912D5FAD:java.util.concurrent.CompletableFuture@117cf07a[Not completed]
2019-07-04 03:24:43,595 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(93)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a: new RaftServerImpl for group-58F2912D5FAD:[386bf1d3-e008-478f-8bb2-1f11de0f2f4a:0.0.0.0:35625] with ContainerStateMachine:uninitialized
2019-07-04 03:24:43,596 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-07-04 03:24:43,597 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-07-04 03:24:43,599 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-07-04 03:24:43,600 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.sleep.deviation.threshold = 300 (default)
2019-07-04 03:24:43,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = false (custom)
2019-07-04 03:24:43,608 INFO  impl.RaftServerImpl (ServerState.java:<init>(105)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a:group-58F2912D5FAD ConfigurationManager, init=-1: [386bf1d3-e008-478f-8bb2-1f11de0f2f4a:0.0.0.0:35625], old=null, confs=<EMPTY_MAP>
2019-07-04 03:24:43,609 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/386bf1d3-e008-478f-8bb2-1f11de0f2f4a] (custom)
2019-07-04 03:24:43,619 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/386bf1d3-e008-478f-8bb2-1f11de0f2f4a/5f2c022d-b0ca-4805-bb1b-58f2912d5fad does not exist. Creating ...
2019-07-04 03:24:43,641 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/386bf1d3-e008-478f-8bb2-1f11de0f2f4a/5f2c022d-b0ca-4805-bb1b-58f2912d5fad/in_use.lock acquired by nodename 1985@ozone-hdds-1735-g25x8-3605130544
2019-07-04 03:24:43,661 INFO  storage.RaftStorage (RaftStorage.java:format(72)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/386bf1d3-e008-478f-8bb2-1f11de0f2f4a/5f2c022d-b0ca-4805-bb1b-58f2912d5fad has been successfully formatted.
2019-07-04 03:24:43,665 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(198)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-07-04 03:24:43,666 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-07-04 03:24:43,669 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-07-04 03:24:43,678 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.purge.gap = 1000000000 (custom)
2019-07-04 03:24:43,678 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-07-04 03:24:43,680 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-07-04 03:24:43,687 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-07-04 03:24:43,694 INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:<init>(172)) - new 386bf1d3-e008-478f-8bb2-1f11de0f2f4a-SegmentedRaftLogWorker:Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/386bf1d3-e008-478f-8bb2-1f11de0f2f4a/5f2c022d-b0ca-4805-bb1b-58f2912d5fad for RaftStorage:Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/386bf1d3-e008-478f-8bb2-1f11de0f2f4a/5f2c022d-b0ca-4805-bb1b-58f2912d5fad
2019-07-04 03:24:43,772 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-07-04 03:24:43,773 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-07-04 03:24:43,778 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 1048576 (custom)
2019-07-04 03:24:43,779 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-07-04 03:24:43,779 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-07-04 03:24:43,780 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-07-04 03:24:43,781 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-07-04 03:24:43,781 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-07-04 03:24:43,782 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-07-04 03:24:43,790 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-07-04 03:24:43,794 INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:lambda$new$0(132)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a-SegmentedRaftLogWorker:Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/386bf1d3-e008-478f-8bb2-1f11de0f2f4a/5f2c022d-b0ca-4805-bb1b-58f2912d5fad: flushIndex: setUnconditionally 0 -> -1
2019-07-04 03:24:43,797 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-07-04 03:24:43,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-07-04 03:24:43,799 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-07-04 03:24:43,817 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(180)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a: start group-58F2912D5FAD
2019-07-04 03:24:43,817 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(171)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a:group-58F2912D5FAD changes role from null to FOLLOWER at term 0 for startAsFollower
2019-07-04 03:24:43,818 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a: start FollowerState
2019-07-04 03:24:43,820 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-58F2912D5FAD,id=386bf1d3-e008-478f-8bb2-1f11de0f2f4a
2019-07-04 03:24:44,120 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(255)) - client-807BA9DCC370->386bf1d3-e008-478f-8bb2-1f11de0f2f4a: receive RaftClientReply:client-807BA9DCC370->386bf1d3-e008-478f-8bb2-1f11de0f2f4a@group-58F2912D5FAD, cid=1, FAILED org.apache.ratis.protocol.NotLeaderException: Server 386bf1d3-e008-478f-8bb2-1f11de0f2f4a is not the leader (null). Request must be sent to leader., logIndex=0, commits[386bf1d3-e008-478f-8bb2-1f11de0f2f4a:c-1]
2019-07-04 03:24:44,863 INFO  impl.FollowerState (FollowerState.java:run(106)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a:group-58F2912D5FAD changes to CANDIDATE, lastRpcTime:1045, electionTimeout:1044ms
2019-07-04 03:24:44,864 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a: shutdown FollowerState
2019-07-04 03:24:44,864 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(171)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a:group-58F2912D5FAD changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-07-04 03:24:44,867 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a: start LeaderElection
2019-07-04 03:24:44,894 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a:group-58F2912D5FAD:LeaderElection1: begin an election at term 1 for -1: [386bf1d3-e008-478f-8bb2-1f11de0f2f4a:0.0.0.0:35625], old=null
2019-07-04 03:24:44,897 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a: shutdown LeaderElection
2019-07-04 03:24:44,898 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(171)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a:group-58F2912D5FAD changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-07-04 03:24:44,898 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a:group-58F2912D5FAD change Leader from null to 386bf1d3-e008-478f-8bb2-1f11de0f2f4a at term 1 for becomeLeader, leader elected after 1232ms
2019-07-04 03:24:44,906 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-07-04 03:24:44,906 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-07-04 03:24:44,910 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.write.element-limit = 4096 (default)
2019-07-04 03:24:44,913 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-07-04 03:24:44,914 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-07-04 03:24:44,915 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.element-limit = 65536 (default)
2019-07-04 03:24:44,927 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a: start LeaderState
2019-07-04 03:24:44,948 INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:startLogSegment(380)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a-SegmentedRaftLogWorker:Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/386bf1d3-e008-478f-8bb2-1f11de0f2f4a/5f2c022d-b0ca-4805-bb1b-58f2912d5fad: Starting segment from index:0
2019-07-04 03:24:44,958 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a:group-58F2912D5FAD set configuration 0: [386bf1d3-e008-478f-8bb2-1f11de0f2f4a:0.0.0.0:35625], old=null at 0
2019-07-04 03:24:45,134 INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:execute(569)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a-SegmentedRaftLogWorker:Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/386bf1d3-e008-478f-8bb2-1f11de0f2f4a/5f2c022d-b0ca-4805-bb1b-58f2912d5fad: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/386bf1d3-e008-478f-8bb2-1f11de0f2f4a/5f2c022d-b0ca-4805-bb1b-58f2912d5fad/current/log_inprogress_0
2019-07-04 03:24:46,304 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(255)) - client-807BA9DCC370->386bf1d3-e008-478f-8bb2-1f11de0f2f4a: receive RaftClientReply:client-807BA9DCC370->386bf1d3-e008-478f-8bb2-1f11de0f2f4a@group-58F2912D5FAD, cid=1, SUCCESS, logIndex=1, commits[386bf1d3-e008-478f-8bb2-1f11de0f2f4a:c1]
2019-07-04 03:24:46,343 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(255)) - client-807BA9DCC370->386bf1d3-e008-478f-8bb2-1f11de0f2f4a: receive RaftClientReply:client-807BA9DCC370->386bf1d3-e008-478f-8bb2-1f11de0f2f4a@group-58F2912D5FAD, cid=2, SUCCESS, logIndex=0, commits[386bf1d3-e008-478f-8bb2-1f11de0f2f4a:c2]
2019-07-04 03:24:46,357 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a: close
2019-07-04 03:24:46,361 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(245)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a: shutdown group-58F2912D5FAD
2019-07-04 03:24:46,363 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-58F2912D5FAD,id=386bf1d3-e008-478f-8bb2-1f11de0f2f4a
2019-07-04 03:24:46,363 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a: shutdown LeaderState
2019-07-04 03:24:46,364 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(202)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a-PendingRequests: sendNotLeaderResponses
2019-07-04 03:24:46,372 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(115)) - StateMachineUpdater:386bf1d3-e008-478f-8bb2-1f11de0f2f4a:group-58F2912D5FAD: set stopIndex = 2
2019-07-04 03:24:46,373 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(244)) - Taking snapshot at termIndex:(t:1, i:1)
2019-07-04 03:24:46,373 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(248)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/386bf1d3-e008-478f-8bb2-1f11de0f2f4a/5f2c022d-b0ca-4805-bb1b-58f2912d5fad/sm/snapshot.1_1
2019-07-04 03:24:46,386 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:takeSnapshot(242)) - StateMachineUpdater:386bf1d3-e008-478f-8bb2-1f11de0f2f4a:group-58F2912D5FAD: Took a snapshot at index 1
2019-07-04 03:24:46,387 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:lambda$new$0(80)) - StateMachineUpdater:386bf1d3-e008-478f-8bb2-1f11de0f2f4a:group-58F2912D5FAD: snapshotIndex: updateIncreasingly -1 -> 1
2019-07-04 03:24:46,396 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a:group-58F2912D5FAD closes. The last applied log index is 2
2019-07-04 03:24:46,398 INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:run(313)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a-SegmentedRaftLogWorker:Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/386bf1d3-e008-478f-8bb2-1f11de0f2f4a/5f2c022d-b0ca-4805-bb1b-58f2912d5fad was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-07-04 03:24:46,399 INFO  segmented.SegmentedRaftLogWorker (SegmentedRaftLogWorker.java:close(228)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a-SegmentedRaftLogWorker:Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/386bf1d3-e008-478f-8bb2-1f11de0f2f4a/5f2c022d-b0ca-4805-bb1b-58f2912d5fad close()
2019-07-04 03:24:46,401 INFO  server.GrpcService (GrpcService.java:closeImpl(155)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a: shutdown server with port 35625 now
2019-07-04 03:24:46,405 INFO  server.GrpcService (GrpcService.java:closeImpl(163)) - 386bf1d3-e008-478f-8bb2-1f11de0f2f4a: shutdown server with port 35625 successfully
