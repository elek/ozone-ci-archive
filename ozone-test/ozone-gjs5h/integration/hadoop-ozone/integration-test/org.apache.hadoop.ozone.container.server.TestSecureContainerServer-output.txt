2019-06-14 06:34:55,198 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-14 06:34:55,290 INFO  ozone.RatisTestHelper (RatisTestHelper.java:initRatisConf(109)) - dfs.container.ratis.rpc.type = GRPC
2019-06-14 06:34:55,338 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 06:34:55,346 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42475 (custom)
2019-06-14 06:34:55,347 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 06:34:55,349 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 06:34:55,349 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 06:34:55,350 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 06:34:55,395 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/a6f4e632-feb5-44b1-818d-186192a23d46] (custom)
2019-06-14 06:34:55,400 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis a6f4e632-feb5-44b1-818d-186192a23d46 at port 42475
2019-06-14 06:34:55,430 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - a6f4e632-feb5-44b1-818d-186192a23d46: start RPC server
2019-06-14 06:34:55,431 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - a6f4e632-feb5-44b1-818d-186192a23d46: GrpcService started, listening on 0.0.0.0/0.0.0.0:42475
2019-06-14 06:34:55,515 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - a6f4e632-feb5-44b1-818d-186192a23d46: addNew group-1DD97ABFBCC4:[a6f4e632-feb5-44b1-818d-186192a23d46:0.0.0.0:42475] returns group-1DD97ABFBCC4:java.util.concurrent.CompletableFuture@313e6dec[Not completed]
2019-06-14 06:34:55,522 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - a6f4e632-feb5-44b1-818d-186192a23d46: new RaftServerImpl for group-1DD97ABFBCC4:[a6f4e632-feb5-44b1-818d-186192a23d46:0.0.0.0:42475] with ContainerStateMachine:uninitialized
2019-06-14 06:34:55,523 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 06:34:55,523 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 06:34:55,524 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 06:34:55,525 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 06:34:55,530 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - a6f4e632-feb5-44b1-818d-186192a23d46:group-1DD97ABFBCC4 ConfigurationManager, init=-1: [a6f4e632-feb5-44b1-818d-186192a23d46:0.0.0.0:42475], old=null, confs=<EMPTY_MAP>
2019-06-14 06:34:55,530 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/a6f4e632-feb5-44b1-818d-186192a23d46] (custom)
2019-06-14 06:34:55,536 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/a6f4e632-feb5-44b1-818d-186192a23d46/0e8533eb-cde7-46dc-af56-1dd97abfbcc4 does not exist. Creating ...
2019-06-14 06:34:55,545 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/a6f4e632-feb5-44b1-818d-186192a23d46/0e8533eb-cde7-46dc-af56-1dd97abfbcc4/in_use.lock acquired by nodename 28750@ozone-gjs5h-1633418606
2019-06-14 06:34:55,552 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/a6f4e632-feb5-44b1-818d-186192a23d46/0e8533eb-cde7-46dc-af56-1dd97abfbcc4 has been successfully formatted.
2019-06-14 06:34:55,553 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 06:34:55,554 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 06:34:55,555 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 06:34:55,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 06:34:55,560 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 06:34:55,563 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 06:34:55,565 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new a6f4e632-feb5-44b1-818d-186192a23d46-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/a6f4e632-feb5-44b1-818d-186192a23d46/0e8533eb-cde7-46dc-af56-1dd97abfbcc4
2019-06-14 06:34:55,565 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 06:34:55,566 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 06:34:55,568 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 06:34:55,568 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 06:34:55,568 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 06:34:55,569 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 06:34:55,570 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 06:34:55,570 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 06:34:55,570 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 06:34:55,572 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 06:34:55,577 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 06:34:55,578 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 06:34:55,578 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 06:34:55,592 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - a6f4e632-feb5-44b1-818d-186192a23d46: start group-1DD97ABFBCC4
2019-06-14 06:34:55,593 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a6f4e632-feb5-44b1-818d-186192a23d46:group-1DD97ABFBCC4 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 06:34:55,594 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a6f4e632-feb5-44b1-818d-186192a23d46: start FollowerState
2019-06-14 06:34:55,636 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-1DD97ABFBCC4,id=a6f4e632-feb5-44b1-818d-186192a23d46
2019-06-14 06:34:55,694 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-A303A77CBC26->a6f4e632-feb5-44b1-818d-186192a23d46: receive RaftClientReply:client-A303A77CBC26->a6f4e632-feb5-44b1-818d-186192a23d46@group-1DD97ABFBCC4, cid=1, FAILED org.apache.ratis.protocol.NotLeaderException: Server a6f4e632-feb5-44b1-818d-186192a23d46 is not the leader (null). Request must be sent to leader., logIndex=0, commits[a6f4e632-feb5-44b1-818d-186192a23d46:c-1]
2019-06-14 06:34:56,699 INFO  impl.FollowerState (FollowerState.java:run(101)) - a6f4e632-feb5-44b1-818d-186192a23d46:group-1DD97ABFBCC4 changes to CANDIDATE, lastRpcTime:1105, electionTimeout:1105ms
2019-06-14 06:34:56,700 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a6f4e632-feb5-44b1-818d-186192a23d46: shutdown FollowerState
2019-06-14 06:34:56,700 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a6f4e632-feb5-44b1-818d-186192a23d46:group-1DD97ABFBCC4 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 06:34:56,701 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-A303A77CBC26->a6f4e632-feb5-44b1-818d-186192a23d46: receive RaftClientReply:client-A303A77CBC26->a6f4e632-feb5-44b1-818d-186192a23d46@group-1DD97ABFBCC4, cid=1, FAILED org.apache.ratis.protocol.NotLeaderException: Server a6f4e632-feb5-44b1-818d-186192a23d46 is not the leader (null). Request must be sent to leader., logIndex=0, commits[a6f4e632-feb5-44b1-818d-186192a23d46:c-1]
2019-06-14 06:34:56,701 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a6f4e632-feb5-44b1-818d-186192a23d46: start LeaderElection
2019-06-14 06:34:56,704 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - a6f4e632-feb5-44b1-818d-186192a23d46:group-1DD97ABFBCC4:LeaderElection1: begin an election at term 1 for -1: [a6f4e632-feb5-44b1-818d-186192a23d46:0.0.0.0:42475], old=null
2019-06-14 06:34:56,705 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - a6f4e632-feb5-44b1-818d-186192a23d46: shutdown LeaderElection
2019-06-14 06:34:56,705 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a6f4e632-feb5-44b1-818d-186192a23d46:group-1DD97ABFBCC4 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 06:34:56,706 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - a6f4e632-feb5-44b1-818d-186192a23d46:group-1DD97ABFBCC4 change Leader from null to a6f4e632-feb5-44b1-818d-186192a23d46 at term 1 for becomeLeader, leader elected after 1152ms
2019-06-14 06:34:56,709 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 06:34:56,709 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 06:34:56,711 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 06:34:56,711 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 06:34:56,718 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a6f4e632-feb5-44b1-818d-186192a23d46: start LeaderState
2019-06-14 06:34:56,730 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - a6f4e632-feb5-44b1-818d-186192a23d46-RaftLogWorker: Starting segment from index:0
2019-06-14 06:34:56,739 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - a6f4e632-feb5-44b1-818d-186192a23d46:group-1DD97ABFBCC4 set configuration 0: [a6f4e632-feb5-44b1-818d-186192a23d46:0.0.0.0:42475], old=null at 0
2019-06-14 06:34:56,864 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - a6f4e632-feb5-44b1-818d-186192a23d46-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/a6f4e632-feb5-44b1-818d-186192a23d46/0e8533eb-cde7-46dc-af56-1dd97abfbcc4/current/log_inprogress_0
2019-06-14 06:34:57,725 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-14 06:34:57,743 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-A303A77CBC26->a6f4e632-feb5-44b1-818d-186192a23d46: receive RaftClientReply:client-A303A77CBC26->a6f4e632-feb5-44b1-818d-186192a23d46@group-1DD97ABFBCC4, cid=1, SUCCESS, logIndex=1, commits[a6f4e632-feb5-44b1-818d-186192a23d46:c1]
2019-06-14 06:34:57,744 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-14 06:34:57,766 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-C8B791866189->a6f4e632-feb5-44b1-818d-186192a23d46: receive RaftClientReply:client-C8B791866189->a6f4e632-feb5-44b1-818d-186192a23d46@group-1DD97ABFBCC4, cid=2, SUCCESS, logIndex=3, commits[a6f4e632-feb5-44b1-818d-186192a23d46:c3]
2019-06-14 06:34:57,769 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - a6f4e632-feb5-44b1-818d-186192a23d46: close
2019-06-14 06:34:57,771 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - a6f4e632-feb5-44b1-818d-186192a23d46: shutdown group-1DD97ABFBCC4
2019-06-14 06:34:57,771 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-1DD97ABFBCC4,id=a6f4e632-feb5-44b1-818d-186192a23d46
2019-06-14 06:34:57,772 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - a6f4e632-feb5-44b1-818d-186192a23d46: shutdown LeaderState
2019-06-14 06:34:57,774 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 06:34:57,772 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 06:34:57,774 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - a6f4e632-feb5-44b1-818d-186192a23d46-PendingRequests: sendNotLeaderResponses
2019-06-14 06:34:57,777 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-a6f4e632-feb5-44b1-818d-186192a23d46-group-1DD97ABFBCC4: set stopIndex = 4
2019-06-14 06:34:57,777 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-14 06:34:57,777 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/a6f4e632-feb5-44b1-818d-186192a23d46/0e8533eb-cde7-46dc-af56-1dd97abfbcc4/sm/snapshot.1_3
2019-06-14 06:34:57,784 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - a6f4e632-feb5-44b1-818d-186192a23d46:group-1DD97ABFBCC4 closes. The last applied log index is 4
2019-06-14 06:34:57,784 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - a6f4e632-feb5-44b1-818d-186192a23d46-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 06:34:57,785 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - a6f4e632-feb5-44b1-818d-186192a23d46-RaftLogWorker close()
2019-06-14 06:34:57,786 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - a6f4e632-feb5-44b1-818d-186192a23d46: shutdown server with port 42475 now
2019-06-14 06:34:57,788 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - a6f4e632-feb5-44b1-818d-186192a23d46: shutdown server with port 42475 successfully
2019-06-14 06:34:57,818 INFO  ozone.RatisTestHelper (RatisTestHelper.java:initRatisConf(109)) - dfs.container.ratis.rpc.type = GRPC
2019-06-14 06:34:57,819 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 06:34:57,819 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 40691 (custom)
2019-06-14 06:34:57,819 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 06:34:57,820 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 06:34:57,820 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 06:34:57,821 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 06:34:57,822 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/fac3a304-eb0f-43a8-b08c-55bf33203b66] (custom)
2019-06-14 06:34:57,822 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis fac3a304-eb0f-43a8-b08c-55bf33203b66 at port 40691
2019-06-14 06:34:57,837 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - fac3a304-eb0f-43a8-b08c-55bf33203b66: start RPC server
2019-06-14 06:34:57,838 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - fac3a304-eb0f-43a8-b08c-55bf33203b66: GrpcService started, listening on 0.0.0.0/0.0.0.0:40691
Jun 14, 2019 6:34:57 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=17, target=0.0.0.0:42475} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:130)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 14, 2019 6:34:57 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=9, target=0.0.0.0:45545} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connectToDatanode(XceiverClientGrpc.java:163)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connect(XceiverClientGrpc.java:120)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:227)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServer(TestSecureContainerServer.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-14 06:34:57,868 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - fac3a304-eb0f-43a8-b08c-55bf33203b66: addNew group-F39A8FA9E24D:[fac3a304-eb0f-43a8-b08c-55bf33203b66:0.0.0.0:40691, 251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763, 89a3168d-8062-4463-91cb-30d43dc86706:0.0.0.0:45809] returns group-F39A8FA9E24D:java.util.concurrent.CompletableFuture@c3a6d90[Not completed]
2019-06-14 06:34:57,870 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - fac3a304-eb0f-43a8-b08c-55bf33203b66: new RaftServerImpl for group-F39A8FA9E24D:[fac3a304-eb0f-43a8-b08c-55bf33203b66:0.0.0.0:40691, 251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763, 89a3168d-8062-4463-91cb-30d43dc86706:0.0.0.0:45809] with ContainerStateMachine:uninitialized
2019-06-14 06:34:57,870 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 06:34:57,870 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 06:34:57,871 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 06:34:57,871 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 06:34:57,871 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - fac3a304-eb0f-43a8-b08c-55bf33203b66:group-F39A8FA9E24D ConfigurationManager, init=-1: [fac3a304-eb0f-43a8-b08c-55bf33203b66:0.0.0.0:40691, 251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763, 89a3168d-8062-4463-91cb-30d43dc86706:0.0.0.0:45809], old=null, confs=<EMPTY_MAP>
2019-06-14 06:34:57,871 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/fac3a304-eb0f-43a8-b08c-55bf33203b66] (custom)
2019-06-14 06:34:57,871 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/fac3a304-eb0f-43a8-b08c-55bf33203b66/35c7450a-d2b0-4108-b808-f39a8fa9e24d does not exist. Creating ...
2019-06-14 06:34:57,873 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/fac3a304-eb0f-43a8-b08c-55bf33203b66/35c7450a-d2b0-4108-b808-f39a8fa9e24d/in_use.lock acquired by nodename 28750@ozone-gjs5h-1633418606
2019-06-14 06:34:57,875 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/fac3a304-eb0f-43a8-b08c-55bf33203b66/35c7450a-d2b0-4108-b808-f39a8fa9e24d has been successfully formatted.
2019-06-14 06:34:57,876 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 06:34:57,876 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 06:34:57,876 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 06:34:57,876 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 06:34:57,877 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 06:34:57,877 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 06:34:57,877 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new fac3a304-eb0f-43a8-b08c-55bf33203b66-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/fac3a304-eb0f-43a8-b08c-55bf33203b66/35c7450a-d2b0-4108-b808-f39a8fa9e24d
2019-06-14 06:34:57,877 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 06:34:57,877 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 06:34:57,877 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 06:34:57,878 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 06:34:57,878 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 06:34:57,878 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 06:34:57,878 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 06:34:57,879 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 06:34:57,879 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 06:34:57,879 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 06:34:57,880 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 06:34:57,880 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 06:34:57,880 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 06:34:57,881 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - fac3a304-eb0f-43a8-b08c-55bf33203b66: start group-F39A8FA9E24D
2019-06-14 06:34:57,881 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fac3a304-eb0f-43a8-b08c-55bf33203b66:group-F39A8FA9E24D changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 06:34:57,881 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fac3a304-eb0f-43a8-b08c-55bf33203b66: start FollowerState
2019-06-14 06:34:57,898 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-F39A8FA9E24D,id=fac3a304-eb0f-43a8-b08c-55bf33203b66
2019-06-14 06:34:57,905 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 06:34:57,906 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 45809 (custom)
2019-06-14 06:34:57,906 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 06:34:57,906 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 06:34:57,906 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 06:34:57,907 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 06:34:57,907 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/89a3168d-8062-4463-91cb-30d43dc86706] (custom)
2019-06-14 06:34:57,907 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 89a3168d-8062-4463-91cb-30d43dc86706 at port 45809
2019-06-14 06:34:57,914 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 89a3168d-8062-4463-91cb-30d43dc86706: start RPC server
2019-06-14 06:34:57,917 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 89a3168d-8062-4463-91cb-30d43dc86706: GrpcService started, listening on 0.0.0.0/0.0.0.0:45809
2019-06-14 06:34:57,938 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 89a3168d-8062-4463-91cb-30d43dc86706: addNew group-F39A8FA9E24D:[fac3a304-eb0f-43a8-b08c-55bf33203b66:0.0.0.0:40691, 251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763, 89a3168d-8062-4463-91cb-30d43dc86706:0.0.0.0:45809] returns group-F39A8FA9E24D:java.util.concurrent.CompletableFuture@78bb7cb9[Not completed]
2019-06-14 06:34:57,938 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 89a3168d-8062-4463-91cb-30d43dc86706: new RaftServerImpl for group-F39A8FA9E24D:[fac3a304-eb0f-43a8-b08c-55bf33203b66:0.0.0.0:40691, 251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763, 89a3168d-8062-4463-91cb-30d43dc86706:0.0.0.0:45809] with ContainerStateMachine:uninitialized
2019-06-14 06:34:57,939 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 06:34:57,939 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 06:34:57,939 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 06:34:57,939 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 06:34:57,939 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 89a3168d-8062-4463-91cb-30d43dc86706:group-F39A8FA9E24D ConfigurationManager, init=-1: [fac3a304-eb0f-43a8-b08c-55bf33203b66:0.0.0.0:40691, 251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763, 89a3168d-8062-4463-91cb-30d43dc86706:0.0.0.0:45809], old=null, confs=<EMPTY_MAP>
2019-06-14 06:34:57,939 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/89a3168d-8062-4463-91cb-30d43dc86706] (custom)
2019-06-14 06:34:57,939 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/89a3168d-8062-4463-91cb-30d43dc86706/35c7450a-d2b0-4108-b808-f39a8fa9e24d does not exist. Creating ...
2019-06-14 06:34:57,941 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/89a3168d-8062-4463-91cb-30d43dc86706/35c7450a-d2b0-4108-b808-f39a8fa9e24d/in_use.lock acquired by nodename 28750@ozone-gjs5h-1633418606
2019-06-14 06:34:57,944 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/89a3168d-8062-4463-91cb-30d43dc86706/35c7450a-d2b0-4108-b808-f39a8fa9e24d has been successfully formatted.
2019-06-14 06:34:57,944 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 06:34:57,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 06:34:57,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 06:34:57,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 06:34:57,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 06:34:57,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 06:34:57,945 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 89a3168d-8062-4463-91cb-30d43dc86706-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/89a3168d-8062-4463-91cb-30d43dc86706/35c7450a-d2b0-4108-b808-f39a8fa9e24d
2019-06-14 06:34:57,945 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 06:34:57,945 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 06:34:57,945 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 06:34:57,945 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 06:34:57,945 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 06:34:57,945 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 06:34:57,946 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 06:34:57,946 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 06:34:57,946 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 06:34:57,946 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 06:34:57,947 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 06:34:57,947 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 06:34:57,947 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 06:34:57,947 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 89a3168d-8062-4463-91cb-30d43dc86706: start group-F39A8FA9E24D
2019-06-14 06:34:57,947 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 89a3168d-8062-4463-91cb-30d43dc86706:group-F39A8FA9E24D changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 06:34:57,947 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 89a3168d-8062-4463-91cb-30d43dc86706: start FollowerState
2019-06-14 06:34:57,950 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-F39A8FA9E24D,id=89a3168d-8062-4463-91cb-30d43dc86706
2019-06-14 06:34:57,957 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 06:34:57,957 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42763 (custom)
2019-06-14 06:34:57,957 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 06:34:57,958 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 06:34:57,958 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 06:34:57,958 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 06:34:57,959 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/251ec073-b110-42ae-be02-10a6dadd1530] (custom)
2019-06-14 06:34:57,959 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 251ec073-b110-42ae-be02-10a6dadd1530 at port 42763
2019-06-14 06:34:57,966 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 251ec073-b110-42ae-be02-10a6dadd1530: start RPC server
2019-06-14 06:34:57,967 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 251ec073-b110-42ae-be02-10a6dadd1530: GrpcService started, listening on 0.0.0.0/0.0.0.0:42763
2019-06-14 06:34:57,984 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 251ec073-b110-42ae-be02-10a6dadd1530: addNew group-F39A8FA9E24D:[fac3a304-eb0f-43a8-b08c-55bf33203b66:0.0.0.0:40691, 251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763, 89a3168d-8062-4463-91cb-30d43dc86706:0.0.0.0:45809] returns group-F39A8FA9E24D:java.util.concurrent.CompletableFuture@2e0e9e24[Not completed]
2019-06-14 06:34:57,985 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 251ec073-b110-42ae-be02-10a6dadd1530: new RaftServerImpl for group-F39A8FA9E24D:[fac3a304-eb0f-43a8-b08c-55bf33203b66:0.0.0.0:40691, 251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763, 89a3168d-8062-4463-91cb-30d43dc86706:0.0.0.0:45809] with ContainerStateMachine:uninitialized
2019-06-14 06:34:57,985 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 06:34:57,986 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 06:34:57,986 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 06:34:57,986 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 06:34:57,986 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 251ec073-b110-42ae-be02-10a6dadd1530:group-F39A8FA9E24D ConfigurationManager, init=-1: [fac3a304-eb0f-43a8-b08c-55bf33203b66:0.0.0.0:40691, 251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763, 89a3168d-8062-4463-91cb-30d43dc86706:0.0.0.0:45809], old=null, confs=<EMPTY_MAP>
2019-06-14 06:34:57,986 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/251ec073-b110-42ae-be02-10a6dadd1530] (custom)
2019-06-14 06:34:57,986 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/251ec073-b110-42ae-be02-10a6dadd1530/35c7450a-d2b0-4108-b808-f39a8fa9e24d does not exist. Creating ...
2019-06-14 06:34:57,989 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/251ec073-b110-42ae-be02-10a6dadd1530/35c7450a-d2b0-4108-b808-f39a8fa9e24d/in_use.lock acquired by nodename 28750@ozone-gjs5h-1633418606
2019-06-14 06:34:57,991 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/251ec073-b110-42ae-be02-10a6dadd1530/35c7450a-d2b0-4108-b808-f39a8fa9e24d has been successfully formatted.
2019-06-14 06:34:57,992 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 06:34:57,992 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 06:34:57,992 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 06:34:57,992 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 06:34:57,992 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 06:34:57,992 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 06:34:57,992 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 251ec073-b110-42ae-be02-10a6dadd1530-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/251ec073-b110-42ae-be02-10a6dadd1530/35c7450a-d2b0-4108-b808-f39a8fa9e24d
2019-06-14 06:34:57,993 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 06:34:57,993 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 06:34:57,993 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 06:34:57,993 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 06:34:57,993 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 06:34:57,993 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 06:34:57,994 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 06:34:57,994 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 06:34:57,994 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 06:34:57,994 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 06:34:57,994 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 06:34:57,995 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 06:34:57,995 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 06:34:57,995 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 251ec073-b110-42ae-be02-10a6dadd1530: start group-F39A8FA9E24D
2019-06-14 06:34:57,995 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 251ec073-b110-42ae-be02-10a6dadd1530:group-F39A8FA9E24D changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 06:34:57,995 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 251ec073-b110-42ae-be02-10a6dadd1530: start FollowerState
2019-06-14 06:34:57,995 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-F39A8FA9E24D,id=251ec073-b110-42ae-be02-10a6dadd1530
2019-06-14 06:34:58,008 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-DC50D0F7E58D->fac3a304-eb0f-43a8-b08c-55bf33203b66: receive RaftClientReply:client-DC50D0F7E58D->fac3a304-eb0f-43a8-b08c-55bf33203b66@group-F39A8FA9E24D, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server fac3a304-eb0f-43a8-b08c-55bf33203b66 is not the leader (251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763). Request must be sent to leader., logIndex=0, commits[fac3a304-eb0f-43a8-b08c-55bf33203b66:c-1]
2019-06-14 06:34:58,011 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 06:34:59,038 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-DC50D0F7E58D->89a3168d-8062-4463-91cb-30d43dc86706: receive RaftClientReply:client-DC50D0F7E58D->89a3168d-8062-4463-91cb-30d43dc86706@group-F39A8FA9E24D, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server 89a3168d-8062-4463-91cb-30d43dc86706 is not the leader (251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763). Request must be sent to leader., logIndex=0, commits[89a3168d-8062-4463-91cb-30d43dc86706:c-1]
2019-06-14 06:34:59,041 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 06:34:59,082 INFO  impl.FollowerState (FollowerState.java:run(101)) - fac3a304-eb0f-43a8-b08c-55bf33203b66:group-F39A8FA9E24D changes to CANDIDATE, lastRpcTime:1200, electionTimeout:1184ms
2019-06-14 06:34:59,082 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - fac3a304-eb0f-43a8-b08c-55bf33203b66: shutdown FollowerState
2019-06-14 06:34:59,082 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fac3a304-eb0f-43a8-b08c-55bf33203b66:group-F39A8FA9E24D changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 06:34:59,082 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fac3a304-eb0f-43a8-b08c-55bf33203b66: start LeaderElection
2019-06-14 06:34:59,086 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - fac3a304-eb0f-43a8-b08c-55bf33203b66:group-F39A8FA9E24D:LeaderElection2: begin an election at term 1 for -1: [fac3a304-eb0f-43a8-b08c-55bf33203b66:0.0.0.0:40691, 251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763, 89a3168d-8062-4463-91cb-30d43dc86706:0.0.0.0:45809], old=null
2019-06-14 06:34:59,106 INFO  impl.FollowerState (FollowerState.java:run(101)) - 251ec073-b110-42ae-be02-10a6dadd1530:group-F39A8FA9E24D changes to CANDIDATE, lastRpcTime:1111, electionTimeout:1111ms
2019-06-14 06:34:59,107 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 251ec073-b110-42ae-be02-10a6dadd1530: shutdown FollowerState
2019-06-14 06:34:59,107 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 251ec073-b110-42ae-be02-10a6dadd1530:group-F39A8FA9E24D changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 06:34:59,107 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 251ec073-b110-42ae-be02-10a6dadd1530: start LeaderElection
2019-06-14 06:34:59,109 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 89a3168d-8062-4463-91cb-30d43dc86706:group-F39A8FA9E24D changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:fac3a304-eb0f-43a8-b08c-55bf33203b66
2019-06-14 06:34:59,114 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 89a3168d-8062-4463-91cb-30d43dc86706: shutdown FollowerState
2019-06-14 06:34:59,115 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 251ec073-b110-42ae-be02-10a6dadd1530:group-F39A8FA9E24D changes role from CANDIDATE to FOLLOWER at term 1 for recognizeCandidate:fac3a304-eb0f-43a8-b08c-55bf33203b66
2019-06-14 06:34:59,116 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 89a3168d-8062-4463-91cb-30d43dc86706: start FollowerState
2019-06-14 06:34:59,116 INFO  impl.FollowerState (FollowerState.java:run(109)) - 89a3168d-8062-4463-91cb-30d43dc86706: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 06:34:59,116 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 251ec073-b110-42ae-be02-10a6dadd1530: shutdown LeaderElection
2019-06-14 06:34:59,116 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 251ec073-b110-42ae-be02-10a6dadd1530: start FollowerState
2019-06-14 06:34:59,122 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 251ec073-b110-42ae-be02-10a6dadd1530:group-F39A8FA9E24D:LeaderElection3: begin an election at term 2 for -1: [fac3a304-eb0f-43a8-b08c-55bf33203b66:0.0.0.0:40691, 251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763, 89a3168d-8062-4463-91cb-30d43dc86706:0.0.0.0:45809], old=null
2019-06-14 06:34:59,124 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 251ec073-b110-42ae-be02-10a6dadd1530:group-F39A8FA9E24D:LeaderElection3: Election REJECTED; received 0 response(s) [] and 0 exception(s); 251ec073-b110-42ae-be02-10a6dadd1530:t2, leader=null, voted=251ec073-b110-42ae-be02-10a6dadd1530, raftlog=251ec073-b110-42ae-be02-10a6dadd1530-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [fac3a304-eb0f-43a8-b08c-55bf33203b66:0.0.0.0:40691, 251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763, 89a3168d-8062-4463-91cb-30d43dc86706:0.0.0.0:45809], old=null
2019-06-14 06:34:59,125 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - fac3a304-eb0f-43a8-b08c-55bf33203b66:group-F39A8FA9E24D:LeaderElection2: Election PASSED; received 2 response(s) [fac3a304-eb0f-43a8-b08c-55bf33203b66->251ec073-b110-42ae-be02-10a6dadd1530,false-t1, fac3a304-eb0f-43a8-b08c-55bf33203b66->89a3168d-8062-4463-91cb-30d43dc86706,true-t1] and 0 exception(s); fac3a304-eb0f-43a8-b08c-55bf33203b66:t1, leader=null, voted=fac3a304-eb0f-43a8-b08c-55bf33203b66, raftlog=fac3a304-eb0f-43a8-b08c-55bf33203b66-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [fac3a304-eb0f-43a8-b08c-55bf33203b66:0.0.0.0:40691, 251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763, 89a3168d-8062-4463-91cb-30d43dc86706:0.0.0.0:45809], old=null
2019-06-14 06:34:59,130 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - fac3a304-eb0f-43a8-b08c-55bf33203b66: shutdown LeaderElection
2019-06-14 06:34:59,192 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fac3a304-eb0f-43a8-b08c-55bf33203b66:group-F39A8FA9E24D changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 06:34:59,192 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - fac3a304-eb0f-43a8-b08c-55bf33203b66:group-F39A8FA9E24D change Leader from null to fac3a304-eb0f-43a8-b08c-55bf33203b66 at term 1 for becomeLeader, leader elected after 1315ms
2019-06-14 06:34:59,192 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 06:34:59,192 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 06:34:59,192 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 06:34:59,193 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
Jun 14, 2019 6:34:59 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=43, target=0.0.0.0:45809} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:131)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 14, 2019 6:34:59 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=35, target=0.0.0.0:40691} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:131)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 14, 2019 6:34:59 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=51, target=0.0.0.0:42763} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:131)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-14 06:34:59,195 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 06:34:59,195 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 06:34:59,196 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 06:34:59,202 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 06:34:59,202 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 06:34:59,202 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 06:34:59,202 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 06:34:59,202 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 06:34:59,203 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 06:34:59,203 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 06:34:59,203 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 06:34:59,203 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 06:34:59,203 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fac3a304-eb0f-43a8-b08c-55bf33203b66: start LeaderState
2019-06-14 06:34:59,203 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - fac3a304-eb0f-43a8-b08c-55bf33203b66-RaftLogWorker: Starting segment from index:0
2019-06-14 06:34:59,206 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - fac3a304-eb0f-43a8-b08c-55bf33203b66:group-F39A8FA9E24D set configuration 0: [fac3a304-eb0f-43a8-b08c-55bf33203b66:0.0.0.0:40691, 251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763, 89a3168d-8062-4463-91cb-30d43dc86706:0.0.0.0:45809], old=null at 0
2019-06-14 06:34:59,243 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - fac3a304-eb0f-43a8-b08c-55bf33203b66-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/fac3a304-eb0f-43a8-b08c-55bf33203b66/35c7450a-d2b0-4108-b808-f39a8fa9e24d/current/log_inprogress_0
2019-06-14 06:34:59,250 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - fac3a304-eb0f-43a8-b08c-55bf33203b66:group-F39A8FA9E24D change Leader from fac3a304-eb0f-43a8-b08c-55bf33203b66 to null at term 2 for updateCurrentTerm
2019-06-14 06:34:59,250 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fac3a304-eb0f-43a8-b08c-55bf33203b66:group-F39A8FA9E24D changes role from LEADER to FOLLOWER at term 2 for recognizeCandidate:251ec073-b110-42ae-be02-10a6dadd1530
2019-06-14 06:34:59,250 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - fac3a304-eb0f-43a8-b08c-55bf33203b66: shutdown LeaderState
2019-06-14 06:34:59,253 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 89a3168d-8062-4463-91cb-30d43dc86706:group-F39A8FA9E24D changes role from FOLLOWER to FOLLOWER at term 2 for recognizeCandidate:251ec073-b110-42ae-be02-10a6dadd1530
2019-06-14 06:34:59,253 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 89a3168d-8062-4463-91cb-30d43dc86706: shutdown FollowerState
2019-06-14 06:34:59,253 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - fac3a304-eb0f-43a8-b08c-55bf33203b66-PendingRequests: sendNotLeaderResponses
2019-06-14 06:34:59,253 INFO  impl.FollowerState (FollowerState.java:run(109)) - 89a3168d-8062-4463-91cb-30d43dc86706: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 06:34:59,254 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fac3a304-eb0f-43a8-b08c-55bf33203b66: start FollowerState
2019-06-14 06:34:59,253 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 89a3168d-8062-4463-91cb-30d43dc86706: start FollowerState
2019-06-14 06:34:59,254 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(fac3a304-eb0f-43a8-b08c-55bf33203b66 -> 89a3168d-8062-4463-91cb-30d43dc86706): Wait interrupted by java.lang.InterruptedException
2019-06-14 06:34:59,255 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(fac3a304-eb0f-43a8-b08c-55bf33203b66 -> 251ec073-b110-42ae-be02-10a6dadd1530): Wait interrupted by java.lang.InterruptedException
2019-06-14 06:34:59,260 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 251ec073-b110-42ae-be02-10a6dadd1530: appendEntries completed
2019-06-14 06:34:59,262 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 89a3168d-8062-4463-91cb-30d43dc86706: appendEntries completed
2019-06-14 06:34:59,266 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - fac3a304-eb0f-43a8-b08c-55bf33203b66: follower fac3a304-eb0f-43a8-b08c-55bf33203b66->251ec073-b110-42ae-be02-10a6dadd1530(c-1,m0,n0, attendVote=true, lastRpcSendTime=13, lastRpcResponseTime=0) response Completed
2019-06-14 06:34:59,266 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - fac3a304-eb0f-43a8-b08c-55bf33203b66: follower fac3a304-eb0f-43a8-b08c-55bf33203b66->89a3168d-8062-4463-91cb-30d43dc86706(c-1,m0,n0, attendVote=true, lastRpcSendTime=14, lastRpcResponseTime=1) response Completed
2019-06-14 06:34:59,268 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fac3a304-eb0f-43a8-b08c-55bf33203b66->89a3168d-8062-4463-91cb-30d43dc86706: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 06:34:59,268 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fac3a304-eb0f-43a8-b08c-55bf33203b66->251ec073-b110-42ae-be02-10a6dadd1530: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 06:35:00,048 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-DC50D0F7E58D->251ec073-b110-42ae-be02-10a6dadd1530: receive RaftClientReply:client-DC50D0F7E58D->251ec073-b110-42ae-be02-10a6dadd1530@group-F39A8FA9E24D, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server 251ec073-b110-42ae-be02-10a6dadd1530 is not the leader (fac3a304-eb0f-43a8-b08c-55bf33203b66:0.0.0.0:40691). Request must be sent to leader., logIndex=0, commits[251ec073-b110-42ae-be02-10a6dadd1530:c-1]
2019-06-14 06:35:00,049 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 06:35:00,119 INFO  impl.FollowerState (FollowerState.java:run(101)) - 251ec073-b110-42ae-be02-10a6dadd1530:group-F39A8FA9E24D changes to CANDIDATE, lastRpcTime:1002, electionTimeout:1002ms
2019-06-14 06:35:00,119 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 251ec073-b110-42ae-be02-10a6dadd1530: shutdown FollowerState
2019-06-14 06:35:00,120 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 251ec073-b110-42ae-be02-10a6dadd1530:group-F39A8FA9E24D changes role from FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2019-06-14 06:35:00,120 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 251ec073-b110-42ae-be02-10a6dadd1530: start LeaderElection
2019-06-14 06:35:00,122 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 251ec073-b110-42ae-be02-10a6dadd1530:group-F39A8FA9E24D:LeaderElection4: begin an election at term 3 for -1: [fac3a304-eb0f-43a8-b08c-55bf33203b66:0.0.0.0:40691, 251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763, 89a3168d-8062-4463-91cb-30d43dc86706:0.0.0.0:45809], old=null
2019-06-14 06:35:00,126 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fac3a304-eb0f-43a8-b08c-55bf33203b66:group-F39A8FA9E24D changes role from FOLLOWER to FOLLOWER at term 3 for recognizeCandidate:251ec073-b110-42ae-be02-10a6dadd1530
2019-06-14 06:35:00,126 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - fac3a304-eb0f-43a8-b08c-55bf33203b66: shutdown FollowerState
2019-06-14 06:35:00,126 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 89a3168d-8062-4463-91cb-30d43dc86706:group-F39A8FA9E24D changes role from FOLLOWER to FOLLOWER at term 3 for recognizeCandidate:251ec073-b110-42ae-be02-10a6dadd1530
2019-06-14 06:35:00,127 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fac3a304-eb0f-43a8-b08c-55bf33203b66: start FollowerState
2019-06-14 06:35:00,127 INFO  impl.FollowerState (FollowerState.java:run(109)) - fac3a304-eb0f-43a8-b08c-55bf33203b66: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 06:35:00,127 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 89a3168d-8062-4463-91cb-30d43dc86706: shutdown FollowerState
2019-06-14 06:35:00,128 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 89a3168d-8062-4463-91cb-30d43dc86706: start FollowerState
2019-06-14 06:35:00,128 INFO  impl.FollowerState (FollowerState.java:run(109)) - 89a3168d-8062-4463-91cb-30d43dc86706: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 06:35:00,138 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 251ec073-b110-42ae-be02-10a6dadd1530:group-F39A8FA9E24D:LeaderElection4: Election PASSED; received 1 response(s) [251ec073-b110-42ae-be02-10a6dadd1530->89a3168d-8062-4463-91cb-30d43dc86706,true-t3] and 0 exception(s); 251ec073-b110-42ae-be02-10a6dadd1530:t3, leader=null, voted=251ec073-b110-42ae-be02-10a6dadd1530, raftlog=251ec073-b110-42ae-be02-10a6dadd1530-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [fac3a304-eb0f-43a8-b08c-55bf33203b66:0.0.0.0:40691, 251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763, 89a3168d-8062-4463-91cb-30d43dc86706:0.0.0.0:45809], old=null
2019-06-14 06:35:00,138 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 251ec073-b110-42ae-be02-10a6dadd1530: shutdown LeaderElection
2019-06-14 06:35:00,140 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 251ec073-b110-42ae-be02-10a6dadd1530:group-F39A8FA9E24D changes role from CANDIDATE to LEADER at term 3 for changeToLeader
2019-06-14 06:35:00,140 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 251ec073-b110-42ae-be02-10a6dadd1530:group-F39A8FA9E24D change Leader from null to 251ec073-b110-42ae-be02-10a6dadd1530 at term 3 for becomeLeader, leader elected after 2148ms
2019-06-14 06:35:00,142 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 06:35:00,142 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 06:35:00,142 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 06:35:00,142 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 06:35:00,143 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 06:35:00,143 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 06:35:00,143 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 06:35:00,143 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 06:35:00,143 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 06:35:00,143 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 06:35:00,144 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 06:35:00,144 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 06:35:00,144 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 06:35:00,144 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 06:35:00,144 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 06:35:00,144 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 06:35:00,145 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 251ec073-b110-42ae-be02-10a6dadd1530: start LeaderState
2019-06-14 06:35:00,145 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 251ec073-b110-42ae-be02-10a6dadd1530-RaftLogWorker: Starting segment from index:0
2019-06-14 06:35:00,180 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 251ec073-b110-42ae-be02-10a6dadd1530:group-F39A8FA9E24D set configuration 0: [fac3a304-eb0f-43a8-b08c-55bf33203b66:0.0.0.0:40691, 251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763, 89a3168d-8062-4463-91cb-30d43dc86706:0.0.0.0:45809], old=null at 0
2019-06-14 06:35:00,182 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 251ec073-b110-42ae-be02-10a6dadd1530-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/251ec073-b110-42ae-be02-10a6dadd1530/35c7450a-d2b0-4108-b808-f39a8fa9e24d/current/log_inprogress_0
2019-06-14 06:35:00,183 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 89a3168d-8062-4463-91cb-30d43dc86706:group-F39A8FA9E24D change Leader from null to 251ec073-b110-42ae-be02-10a6dadd1530 at term 3 for appendEntries, leader elected after 2239ms
2019-06-14 06:35:00,185 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - fac3a304-eb0f-43a8-b08c-55bf33203b66:group-F39A8FA9E24D change Leader from null to 251ec073-b110-42ae-be02-10a6dadd1530 at term 3 for appendEntries, leader elected after 934ms
2019-06-14 06:35:00,200 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 89a3168d-8062-4463-91cb-30d43dc86706:group-F39A8FA9E24D set configuration 0: [fac3a304-eb0f-43a8-b08c-55bf33203b66:0.0.0.0:40691, 251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763, 89a3168d-8062-4463-91cb-30d43dc86706:0.0.0.0:45809], old=null at 0
2019-06-14 06:35:00,201 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 89a3168d-8062-4463-91cb-30d43dc86706-RaftLogWorker: Starting segment from index:0
2019-06-14 06:35:00,239 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 89a3168d-8062-4463-91cb-30d43dc86706-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/89a3168d-8062-4463-91cb-30d43dc86706/35c7450a-d2b0-4108-b808-f39a8fa9e24d/current/log_inprogress_0
2019-06-14 06:35:00,240 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - fac3a304-eb0f-43a8-b08c-55bf33203b66:group-F39A8FA9E24D set configuration 0: [fac3a304-eb0f-43a8-b08c-55bf33203b66:0.0.0.0:40691, 251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763, 89a3168d-8062-4463-91cb-30d43dc86706:0.0.0.0:45809], old=null at 0
2019-06-14 06:35:00,242 INFO  storage.RaftLogWorker (RaftLogWorker.java:truncate(314)) - fac3a304-eb0f-43a8-b08c-55bf33203b66-RaftLogWorker: Truncating segments toTruncate: null
  toDelete: [(0, 0) isOpen? true, length=0, newEndIndex=-1], start index 0
2019-06-14 06:35:00,243 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - fac3a304-eb0f-43a8-b08c-55bf33203b66-RaftLogWorker: Starting segment from index:0
2019-06-14 06:35:00,246 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(533)) - fac3a304-eb0f-43a8-b08c-55bf33203b66-RaftLogWorker: Deleted log file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/fac3a304-eb0f-43a8-b08c-55bf33203b66/35c7450a-d2b0-4108-b808-f39a8fa9e24d/current/log_inprogress_0
2019-06-14 06:35:00,282 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - fac3a304-eb0f-43a8-b08c-55bf33203b66-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/fac3a304-eb0f-43a8-b08c-55bf33203b66/35c7450a-d2b0-4108-b808-f39a8fa9e24d/current/log_inprogress_0
2019-06-14 06:35:01,057 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-DC50D0F7E58D->fac3a304-eb0f-43a8-b08c-55bf33203b66: receive RaftClientReply:client-DC50D0F7E58D->fac3a304-eb0f-43a8-b08c-55bf33203b66@group-F39A8FA9E24D, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server fac3a304-eb0f-43a8-b08c-55bf33203b66 is not the leader (251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763). Request must be sent to leader., logIndex=0, commits[fac3a304-eb0f-43a8-b08c-55bf33203b66:c0, 251ec073-b110-42ae-be02-10a6dadd1530:c0, 89a3168d-8062-4463-91cb-30d43dc86706:c0]
2019-06-14 06:35:01,060 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 06:35:02,071 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-14 06:35:02,076 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-14 06:35:02,082 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-14 06:35:02,082 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-DC50D0F7E58D->251ec073-b110-42ae-be02-10a6dadd1530: receive RaftClientReply:client-DC50D0F7E58D->251ec073-b110-42ae-be02-10a6dadd1530@group-F39A8FA9E24D, cid=6, SUCCESS, logIndex=1, commits[251ec073-b110-42ae-be02-10a6dadd1530:c1, fac3a304-eb0f-43a8-b08c-55bf33203b66:c0, 89a3168d-8062-4463-91cb-30d43dc86706:c0]
2019-06-14 06:35:02,083 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-14 06:35:02,094 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-92E92A2A54D5->fac3a304-eb0f-43a8-b08c-55bf33203b66: receive RaftClientReply:client-92E92A2A54D5->fac3a304-eb0f-43a8-b08c-55bf33203b66@group-F39A8FA9E24D, cid=7, FAILED org.apache.ratis.protocol.NotLeaderException: Server fac3a304-eb0f-43a8-b08c-55bf33203b66 is not the leader (251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763). Request must be sent to leader., logIndex=0, commits[fac3a304-eb0f-43a8-b08c-55bf33203b66:c1, 251ec073-b110-42ae-be02-10a6dadd1530:c1, 89a3168d-8062-4463-91cb-30d43dc86706:c0]
2019-06-14 06:35:02,097 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 2-OrderedRequestStreamObserver2: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 06:35:03,105 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-92E92A2A54D5->89a3168d-8062-4463-91cb-30d43dc86706: receive RaftClientReply:client-92E92A2A54D5->89a3168d-8062-4463-91cb-30d43dc86706@group-F39A8FA9E24D, cid=7, FAILED org.apache.ratis.protocol.NotLeaderException: Server 89a3168d-8062-4463-91cb-30d43dc86706 is not the leader (251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763). Request must be sent to leader., logIndex=0, commits[89a3168d-8062-4463-91cb-30d43dc86706:c2, fac3a304-eb0f-43a8-b08c-55bf33203b66:c2, 251ec073-b110-42ae-be02-10a6dadd1530:c2]
2019-06-14 06:35:03,107 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 06:35:04,114 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-92E92A2A54D5->fac3a304-eb0f-43a8-b08c-55bf33203b66: receive RaftClientReply:client-92E92A2A54D5->fac3a304-eb0f-43a8-b08c-55bf33203b66@group-F39A8FA9E24D, cid=7, FAILED org.apache.ratis.protocol.NotLeaderException: Server fac3a304-eb0f-43a8-b08c-55bf33203b66 is not the leader (251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763). Request must be sent to leader., logIndex=0, commits[fac3a304-eb0f-43a8-b08c-55bf33203b66:c2, 251ec073-b110-42ae-be02-10a6dadd1530:c2, 89a3168d-8062-4463-91cb-30d43dc86706:c2]
2019-06-14 06:35:04,117 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 3-OrderedRequestStreamObserver3: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 06:35:05,125 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-92E92A2A54D5->89a3168d-8062-4463-91cb-30d43dc86706: receive RaftClientReply:client-92E92A2A54D5->89a3168d-8062-4463-91cb-30d43dc86706@group-F39A8FA9E24D, cid=7, FAILED org.apache.ratis.protocol.NotLeaderException: Server 89a3168d-8062-4463-91cb-30d43dc86706 is not the leader (251ec073-b110-42ae-be02-10a6dadd1530:0.0.0.0:42763). Request must be sent to leader., logIndex=0, commits[89a3168d-8062-4463-91cb-30d43dc86706:c2, fac3a304-eb0f-43a8-b08c-55bf33203b66:c2, 251ec073-b110-42ae-be02-10a6dadd1530:c2]
2019-06-14 06:35:05,127 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 2-OrderedRequestStreamObserver2: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 06:35:06,142 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-92E92A2A54D5->251ec073-b110-42ae-be02-10a6dadd1530: receive RaftClientReply:client-92E92A2A54D5->251ec073-b110-42ae-be02-10a6dadd1530@group-F39A8FA9E24D, cid=7, SUCCESS, logIndex=3, commits[251ec073-b110-42ae-be02-10a6dadd1530:c3, fac3a304-eb0f-43a8-b08c-55bf33203b66:c2, 89a3168d-8062-4463-91cb-30d43dc86706:c2]
2019-06-14 06:35:06,144 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - fac3a304-eb0f-43a8-b08c-55bf33203b66: close
2019-06-14 06:35:06,145 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - fac3a304-eb0f-43a8-b08c-55bf33203b66: shutdown group-F39A8FA9E24D
2019-06-14 06:35:06,145 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-F39A8FA9E24D,id=fac3a304-eb0f-43a8-b08c-55bf33203b66
2019-06-14 06:35:06,146 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - fac3a304-eb0f-43a8-b08c-55bf33203b66: shutdown FollowerState
2019-06-14 06:35:06,146 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-fac3a304-eb0f-43a8-b08c-55bf33203b66-group-F39A8FA9E24D: set stopIndex = 3
2019-06-14 06:35:06,146 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:3, i:3)
2019-06-14 06:35:06,146 INFO  impl.FollowerState (FollowerState.java:run(109)) - fac3a304-eb0f-43a8-b08c-55bf33203b66: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 06:35:06,146 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/fac3a304-eb0f-43a8-b08c-55bf33203b66/35c7450a-d2b0-4108-b808-f39a8fa9e24d/sm/snapshot.3_3
2019-06-14 06:35:06,147 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - fac3a304-eb0f-43a8-b08c-55bf33203b66:group-F39A8FA9E24D closes. The last applied log index is 3
2019-06-14 06:35:06,147 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - fac3a304-eb0f-43a8-b08c-55bf33203b66-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 06:35:06,149 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - fac3a304-eb0f-43a8-b08c-55bf33203b66-RaftLogWorker close()
2019-06-14 06:35:06,149 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - fac3a304-eb0f-43a8-b08c-55bf33203b66: shutdown server with port 40691 now
2019-06-14 06:35:06,150 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - fac3a304-eb0f-43a8-b08c-55bf33203b66: shutdown server with port 40691 successfully
2019-06-14 06:35:06,150 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - fac3a304-eb0f-43a8-b08c-55bf33203b66: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 06:35:06,151 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 251ec073-b110-42ae-be02-10a6dadd1530: Failed appendEntries to fac3a304-eb0f-43a8-b08c-55bf33203b66:0.0.0.0:40691: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-14 06:35:06,151 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 251ec073-b110-42ae-be02-10a6dadd1530->fac3a304-eb0f-43a8-b08c-55bf33203b66: nextIndex: updateUnconditionally 5 -> 0
2019-06-14 06:35:06,152 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 89a3168d-8062-4463-91cb-30d43dc86706: close
2019-06-14 06:35:06,153 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 89a3168d-8062-4463-91cb-30d43dc86706: shutdown group-F39A8FA9E24D
2019-06-14 06:35:06,153 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-F39A8FA9E24D,id=89a3168d-8062-4463-91cb-30d43dc86706
2019-06-14 06:35:06,153 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 89a3168d-8062-4463-91cb-30d43dc86706: shutdown FollowerState
2019-06-14 06:35:06,156 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-89a3168d-8062-4463-91cb-30d43dc86706-group-F39A8FA9E24D: set stopIndex = 3
2019-06-14 06:35:06,156 INFO  impl.FollowerState (FollowerState.java:run(109)) - 89a3168d-8062-4463-91cb-30d43dc86706: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 06:35:06,156 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:3, i:3)
2019-06-14 06:35:06,156 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/89a3168d-8062-4463-91cb-30d43dc86706/35c7450a-d2b0-4108-b808-f39a8fa9e24d/sm/snapshot.3_3
2019-06-14 06:35:06,157 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 89a3168d-8062-4463-91cb-30d43dc86706:group-F39A8FA9E24D closes. The last applied log index is 3
2019-06-14 06:35:06,157 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 89a3168d-8062-4463-91cb-30d43dc86706-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 06:35:06,158 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 89a3168d-8062-4463-91cb-30d43dc86706-RaftLogWorker close()
2019-06-14 06:35:06,158 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 89a3168d-8062-4463-91cb-30d43dc86706: shutdown server with port 45809 now
2019-06-14 06:35:06,159 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - 89a3168d-8062-4463-91cb-30d43dc86706: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 06:35:06,159 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 251ec073-b110-42ae-be02-10a6dadd1530: Failed appendEntries to 89a3168d-8062-4463-91cb-30d43dc86706:0.0.0.0:45809: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-14 06:35:06,159 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 89a3168d-8062-4463-91cb-30d43dc86706: shutdown server with port 45809 successfully
2019-06-14 06:35:06,160 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 251ec073-b110-42ae-be02-10a6dadd1530->89a3168d-8062-4463-91cb-30d43dc86706: nextIndex: updateUnconditionally 5 -> 0
2019-06-14 06:35:06,161 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 251ec073-b110-42ae-be02-10a6dadd1530: close
2019-06-14 06:35:06,162 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 251ec073-b110-42ae-be02-10a6dadd1530: shutdown group-F39A8FA9E24D
2019-06-14 06:35:06,162 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-F39A8FA9E24D,id=251ec073-b110-42ae-be02-10a6dadd1530
2019-06-14 06:35:06,162 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 251ec073-b110-42ae-be02-10a6dadd1530: shutdown LeaderState
2019-06-14 06:35:06,162 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(251ec073-b110-42ae-be02-10a6dadd1530 -> fac3a304-eb0f-43a8-b08c-55bf33203b66): Wait interrupted by java.lang.InterruptedException
2019-06-14 06:35:06,162 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 251ec073-b110-42ae-be02-10a6dadd1530-PendingRequests: sendNotLeaderResponses
2019-06-14 06:35:06,162 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(251ec073-b110-42ae-be02-10a6dadd1530 -> 89a3168d-8062-4463-91cb-30d43dc86706): Wait interrupted by java.lang.InterruptedException
2019-06-14 06:35:06,166 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-251ec073-b110-42ae-be02-10a6dadd1530-group-F39A8FA9E24D: set stopIndex = 4
2019-06-14 06:35:06,166 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:3, i:3)
2019-06-14 06:35:06,166 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/251ec073-b110-42ae-be02-10a6dadd1530/35c7450a-d2b0-4108-b808-f39a8fa9e24d/sm/snapshot.3_3
2019-06-14 06:35:06,167 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 251ec073-b110-42ae-be02-10a6dadd1530:group-F39A8FA9E24D closes. The last applied log index is 4
2019-06-14 06:35:06,167 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 251ec073-b110-42ae-be02-10a6dadd1530-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 06:35:06,169 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 251ec073-b110-42ae-be02-10a6dadd1530-RaftLogWorker close()
2019-06-14 06:35:06,170 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 251ec073-b110-42ae-be02-10a6dadd1530: shutdown server with port 42763 now
2019-06-14 06:35:06,171 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 251ec073-b110-42ae-be02-10a6dadd1530: shutdown server with port 42763 successfully
