2019-06-13 12:03:51,472 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:03:51,573 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:03:51,576 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:03:51,590 INFO  util.log (Log.java:initialized(192)) - Logging initialized @810ms
2019-06-13 12:03:51,677 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedBlocks
2019-06-13 12:03:51,677 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedBlocks
2019-06-13 12:03:51,678 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: validCerts
2019-06-13 12:03:51,678 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:validCerts
2019-06-13 12:03:51,678 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: revokedCerts
2019-06-13 12:03:51,678 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:revokedCerts
2019-06-13 12:03:51,690 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-13 12:03:51,690 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-13 12:03:51,691 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-13 12:03:51,766 WARN  server.ServerUtils (ServerUtils.java:sanitizeUserArgs(70)) - ozone.scm.stale.node.interval value = 300000 is larger than max = 100000 based on the key value of ozone.scm.heartbeat.thread.interval, reset to the max value 100000.
2019-06-13 12:03:51,766 WARN  server.ServerUtils (ServerUtils.java:sanitizeUserArgs(70)) - ozone.scm.stale.node.interval value = 300000 is larger than max = 100000 based on the key value of ozone.scm.heartbeat.thread.interval, reset to the max value 100000.
2019-06-13 12:03:51,768 INFO  node.SCMNodeManager (SCMNodeManager.java:<init>(108)) - Entering startup safe mode.
2019-06-13 12:03:51,827 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(125)) - Loading file from sun.misc.CompoundEnumeration@408d971b
2019-06-13 12:03:51,828 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(171)) - Loading network topology layer schema file
2019-06-13 12:03:51,894 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:03:51,921 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:initializePipelineState(126)) - No pipeline exists in current db
2019-06-13 12:03:51,924 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:03:52,110 WARN  events.EventQueue (EventQueue.java:fireEvent(175)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='SafeModeStatus'}
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-13 12:03:52,431 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-13 12:03:52,461 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 40449
2019-06-13 12:03:52,499 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-13 12:03:52,540 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 43155
2019-06-13 12:03:52,547 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-13 12:03:52,548 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 45813
2019-06-13 12:03:52,564 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for scm at: http://0.0.0.0:0
2019-06-13 12:03:52,731 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:03:52,739 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:03:52,747 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:03:52,750 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context scm
2019-06-13 12:03:52,750 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:03:52,750 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:03:52,778 INFO  server.StorageContainerManager (StorageContainerManager.java:start(752)) - StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:45813
2019-06-13 12:03:52,844 WARN  impl.MetricsConfig (MetricsConfig.java:loadFirst(134)) - Cannot locate configuration: tried hadoop-metrics2-storagecontainermanager.properties,hadoop-metrics2.properties
2019-06-13 12:03:52,860 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:startTimer(374)) - Scheduled Metric snapshot period at 10 second(s).
2019-06-13 12:03:52,861 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:start(191)) - StorageContainerManager metrics system started
2019-06-13 12:03:53,097 INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:start(149)) - RPC server for Client  is listening at /0.0.0.0:45813
2019-06-13 12:03:53,098 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-13 12:03:53,099 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 45813: starting
2019-06-13 12:03:53,108 INFO  server.StorageContainerManager (StorageContainerManager.java:start(761)) - ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:43155
2019-06-13 12:03:53,108 INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:start(137)) - RPC server for Block Protocol is listening at /0.0.0.0:43155
2019-06-13 12:03:53,109 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-13 12:03:53,110 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 43155: starting
2019-06-13 12:03:53,120 INFO  server.StorageContainerManager (StorageContainerManager.java:start(765)) - ScmDatanodeProtocl RPC server is listening at /0.0.0.0:40449
2019-06-13 12:03:53,120 INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:start(191)) - RPC server for DataNodes is listening at /0.0.0.0:40449
2019-06-13 12:03:53,121 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-13 12:03:53,121 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 40449: starting
2019-06-13 12:03:53,126 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 38733
2019-06-13 12:03:53,128 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:03:53,164 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@4879dfad{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:03:53,165 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@74eb909f{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-13 12:03:53,203 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@6c345c5f{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/scm/,AVAILABLE}{/scm}
2019-06-13 12:03:53,207 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@362a019c{HTTP/1.1,[http/1.1]}{0.0.0.0:38733}
2019-06-13 12:03:53,207 INFO  server.Server (Server.java:doStart(419)) - Started @2428ms
2019-06-13 12:03:53,208 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of SCM is listening at http://0.0.0.0:38733
2019-06-13 12:03:53,216 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:03:53,221 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:03:53,331 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:03:53,332 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(519)) - OM Service ID is not set. Setting it to the default ID: omServiceIdDefault
2019-06-13 12:03:53,333 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(525)) - OM Node ID is not set. Setting it to the OmStorage's OmID: 0ccdec85-d3d5-4c40-9c3d-82cb62e87b29
2019-06-13 12:03:53,334 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 12:03:53,335 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 12:03:53,335 INFO  om.OzoneManager (OzoneManager.java:loadOMHAConfigs(476)) - Found matching OM address with OMServiceId: null, OMNodeId: null, RPC Address: localhost:0 and Ratis port: 9872
2019-06-13 12:03:53,554 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:03:53,560 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: userTable
2019-06-13 12:03:53,561 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:userTable
2019-06-13 12:03:53,561 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: volumeTable
2019-06-13 12:03:53,561 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:volumeTable
2019-06-13 12:03:53,562 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: bucketTable
2019-06-13 12:03:53,562 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:bucketTable
2019-06-13 12:03:53,562 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: keyTable
2019-06-13 12:03:53,562 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:keyTable
2019-06-13 12:03:53,563 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedTable
2019-06-13 12:03:53,563 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedTable
2019-06-13 12:03:53,563 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: openKeyTable
2019-06-13 12:03:53,563 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:openKeyTable
2019-06-13 12:03:53,564 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3Table
2019-06-13 12:03:53,564 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3Table
2019-06-13 12:03:53,564 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: multipartInfoTable
2019-06-13 12:03:53,564 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:multipartInfoTable
2019-06-13 12:03:53,565 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: dTokenTable
2019-06-13 12:03:53,565 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:dTokenTable
2019-06-13 12:03:53,565 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3SecretTable
2019-06-13 12:03:53,565 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3SecretTable
2019-06-13 12:03:53,566 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: prefixTable
2019-06-13 12:03:53,566 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:prefixTable
2019-06-13 12:03:53,566 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-13 12:03:53,566 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-13 12:03:53,567 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-13 12:03:54,107 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-13 12:03:54,109 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 45805
2019-06-13 12:03:54,141 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:03:54,141 INFO  om.OzoneManager (OzoneManager.java:start(1217)) - OzoneManager RPC server is listening at localhost/127.0.0.1:45805
2019-06-13 12:03:54,142 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - OzoneManager metrics system started (again)
2019-06-13 12:03:54,145 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-13 12:03:54,146 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 45805: starting
2019-06-13 12:03:54,159 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for ozoneManager at: http://0.0.0.0:0
2019-06-13 12:03:54,160 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:03:54,161 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:03:54,163 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:03:54,164 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context ozoneManager
2019-06-13 12:03:54,164 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:03:54,165 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:03:54,166 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 42083
2019-06-13 12:03:54,166 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:03:54,182 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@1a411233{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:03:54,182 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@7c2327fa{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-13 12:03:54,188 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@4565a70a{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/ozoneManager/,AVAILABLE}{/ozoneManager}
2019-06-13 12:03:54,188 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@a0a9fa5{HTTP/1.1,[http/1.1]}{0.0.0.0:42083}
2019-06-13 12:03:54,190 INFO  server.Server (Server.java:doStart(419)) - Started @3410ms
2019-06-13 12:03:54,190 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of OZONEMANAGER is listening at http://0.0.0.0:42083
2019-06-13 12:03:54,350 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:03:54,507 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:03:54,539 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-0/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:03:54,541 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-0/data/containers/hdds to VolumeSet
2019-06-13 12:03:54,544 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3d43fe
2019-06-13 12:03:54,561 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3d43fe
2019-06-13 12:03:54,607 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 41525
2019-06-13 12:03:54,673 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:03:54,683 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 41525 (custom)
2019-06-13 12:03:54,684 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:03:54,686 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:03:54,687 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:03:54,687 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:03:54,833 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-0/data/ratis] (custom)
2019-06-13 12:03:54,840 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 38535
2019-06-13 12:03:54,863 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:03:54,900 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:03:54,902 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:03:54,902 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:03:54,904 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:03:54,905 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:03:54,905 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:03:54,905 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:03:54,906 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 46157
2019-06-13 12:03:54,906 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:03:54,921 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@6fc29daa{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:03:54,921 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@4d62f4c6{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:03:54,958 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@44924587{/,file:///tmp/jetty-0.0.0.0-46157-hddsDatanode-_-any-5873220615071650103.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:03:54,959 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@18460128{HTTP/1.1,[http/1.1]}{0.0.0.0:46157}
2019-06-13 12:03:54,960 INFO  server.Server (Server.java:doStart(419)) - Started @4180ms
2019-06-13 12:03:54,961 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:46157
Jun 13, 2019 12:03:55 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:03:55,964 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@f171912
2019-06-13 12:03:55,969 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:03:55,971 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:03:55,994 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:03:56,000 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-1/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:03:56,001 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-1/data/containers/hdds to VolumeSet
2019-06-13 12:03:56,001 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@469a7575
2019-06-13 12:03:56,006 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@469a7575
2019-06-13 12:03:56,030 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 34301
2019-06-13 12:03:56,031 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:03:56,033 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 34301 (custom)
2019-06-13 12:03:56,033 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:03:56,033 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:03:56,034 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:03:56,034 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:03:56,035 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-1/data/ratis] (custom)
2019-06-13 12:03:56,036 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 41829
2019-06-13 12:03:56,036 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:03:56,044 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:03:56,045 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:03:56,049 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:03:56,051 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:03:56,052 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:03:56,052 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:03:56,053 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:03:56,053 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 40787
2019-06-13 12:03:56,054 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:03:56,056 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@38d80d65{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:03:56,057 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@5a0e0886{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:03:56,091 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@186d8a71{/,file:///tmp/jetty-0.0.0.0-40787-hddsDatanode-_-any-6289421941333088265.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:03:56,096 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@3dc40ab9{HTTP/1.1,[http/1.1]}{0.0.0.0:40787}
2019-06-13 12:03:56,096 INFO  server.Server (Server.java:doStart(419)) - Started @5317ms
2019-06-13 12:03:56,103 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:40787
Jun 13, 2019 12:03:56 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:03:56,169 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-0/meta/datanode.id
2019-06-13 12:03:56,301 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@733e6df7
2019-06-13 12:03:56,305 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:03:56,306 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:03:56,313 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:03:56,319 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-1/meta/datanode.id
2019-06-13 12:03:56,321 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-2/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:03:56,322 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-2/data/containers/hdds to VolumeSet
2019-06-13 12:03:56,322 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@108e9837
2019-06-13 12:03:56,326 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@108e9837
2019-06-13 12:03:56,338 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43419
2019-06-13 12:03:56,339 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:03:56,340 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43419 (custom)
2019-06-13 12:03:56,340 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:03:56,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:03:56,341 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:03:56,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:03:56,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-2/data/ratis] (custom)
2019-06-13 12:03:56,342 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42711
2019-06-13 12:03:56,343 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:03:56,344 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:03:56,345 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:03:56,345 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:03:56,347 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:03:56,347 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:03:56,347 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:03:56,347 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:03:56,348 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 32937
2019-06-13 12:03:56,348 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:03:56,363 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@2ba42204{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:03:56,366 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@5b1efaaf{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:03:56,398 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@611e5819{/,file:///tmp/jetty-0.0.0.0-32937-hddsDatanode-_-any-1304621054334458932.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:03:56,399 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@2567f3fe{HTTP/1.1,[http/1.1]}{0.0.0.0:32937}
2019-06-13 12:03:56,400 INFO  server.Server (Server.java:doStart(419)) - Started @5621ms
2019-06-13 12:03:56,401 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:32937
Jun 13, 2019 12:03:56 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:03:56,548 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@707865bd
2019-06-13 12:03:56,549 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:03:56,550 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:03:56,574 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-3/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:03:56,574 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:03:56,574 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-3/data/containers/hdds to VolumeSet
2019-06-13 12:03:56,574 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@475f5672
2019-06-13 12:03:56,580 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@475f5672
2019-06-13 12:03:56,592 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-2/meta/datanode.id
2019-06-13 12:03:56,598 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 38617
2019-06-13 12:03:56,599 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:03:56,599 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 38617 (custom)
2019-06-13 12:03:56,599 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:03:56,600 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:03:56,600 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:03:56,600 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:03:56,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-3/data/ratis] (custom)
2019-06-13 12:03:56,601 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 35573
2019-06-13 12:03:56,602 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:03:56,603 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:03:56,604 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:03:56,605 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:03:56,607 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:03:56,607 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:03:56,608 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:03:56,608 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:03:56,608 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 42071
2019-06-13 12:03:56,608 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:03:56,626 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@3830f918{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:03:56,630 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@739831a4{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:03:56,659 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@e91af20{/,file:///tmp/jetty-0.0.0.0-42071-hddsDatanode-_-any-8992606268927902747.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:03:56,659 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@6221b13b{HTTP/1.1,[http/1.1]}{0.0.0.0:42071}
2019-06-13 12:03:56,660 INFO  server.Server (Server.java:doStart(419)) - Started @5880ms
2019-06-13 12:03:56,661 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:42071
Jun 13, 2019 12:03:56 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:03:56,804 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@6d69a0d3
2019-06-13 12:03:56,805 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:03:56,805 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:03:56,828 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:03:56,830 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-3/meta/datanode.id
2019-06-13 12:03:56,832 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-4/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:03:56,833 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-4/data/containers/hdds to VolumeSet
2019-06-13 12:03:56,833 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3b088163
2019-06-13 12:03:56,834 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3b088163
2019-06-13 12:03:56,851 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43947
2019-06-13 12:03:56,855 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:03:56,855 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43947 (custom)
2019-06-13 12:03:56,855 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:03:56,856 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:03:56,856 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:03:56,857 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:03:56,857 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-4/data/ratis] (custom)
2019-06-13 12:03:56,858 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42057
2019-06-13 12:03:56,858 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:03:56,860 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:03:56,861 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:03:56,862 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:03:56,863 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:03:56,864 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:03:56,864 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:03:56,866 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:03:56,867 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 38433
2019-06-13 12:03:56,867 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:03:56,882 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@526f6427{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:03:56,883 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@492521c4{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:03:56,912 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@5c3d4f05{/,file:///tmp/jetty-0.0.0.0-38433-hddsDatanode-_-any-7305112136877551116.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:03:56,916 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@5ecb66d0{HTTP/1.1,[http/1.1]}{0.0.0.0:38433}
2019-06-13 12:03:56,916 INFO  server.Server (Server.java:doStart(419)) - Started @6137ms
2019-06-13 12:03:56,917 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:38433
Jun 13, 2019 12:03:56 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:03:57,063 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@ceb7701
2019-06-13 12:03:57,065 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:03:57,066 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:03:57,086 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:03:57,089 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-5/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:03:57,090 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-5/data/containers/hdds to VolumeSet
2019-06-13 12:03:57,090 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@5627cb29
2019-06-13 12:03:57,094 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-4/meta/datanode.id
2019-06-13 12:03:57,095 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@5627cb29
2019-06-13 12:03:57,107 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 39721
2019-06-13 12:03:57,109 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:03:57,109 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 39721 (custom)
2019-06-13 12:03:57,109 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:03:57,110 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:03:57,110 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:03:57,110 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:03:57,110 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-5/data/ratis] (custom)
2019-06-13 12:03:57,111 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 41915
2019-06-13 12:03:57,111 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:03:57,112 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:03:57,113 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:03:57,114 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:03:57,115 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:03:57,116 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:03:57,116 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:03:57,116 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:03:57,117 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 46303
2019-06-13 12:03:57,117 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:03:57,130 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@6b063470{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:03:57,131 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@527937d0{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:03:57,162 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@70be89ec{/,file:///tmp/jetty-0.0.0.0-46303-hddsDatanode-_-any-8669624996362007898.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:03:57,162 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@2aee0704{HTTP/1.1,[http/1.1]}{0.0.0.0:46303}
2019-06-13 12:03:57,166 INFO  server.Server (Server.java:doStart(419)) - Started @6387ms
2019-06-13 12:03:57,167 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:46303
Jun 13, 2019 12:03:57 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:03:57,294 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@159ac15f
2019-06-13 12:03:57,297 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:03:57,298 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:03:57,315 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:03:57,317 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-6/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:03:57,318 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-6/data/containers/hdds to VolumeSet
2019-06-13 12:03:57,318 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@4e48462d
2019-06-13 12:03:57,322 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-5/meta/datanode.id
2019-06-13 12:03:57,326 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@4e48462d
2019-06-13 12:03:57,342 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 46883
2019-06-13 12:03:57,344 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:03:57,345 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 46883 (custom)
2019-06-13 12:03:57,345 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:03:57,345 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:03:57,346 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:03:57,346 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:03:57,346 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-6/data/ratis] (custom)
2019-06-13 12:03:57,347 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 46873
2019-06-13 12:03:57,347 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:03:57,348 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:03:57,349 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:03:57,350 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:03:57,351 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:03:57,352 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:03:57,352 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:03:57,352 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:03:57,353 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 39713
2019-06-13 12:03:57,353 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:03:57,359 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@410fc508{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:03:57,359 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@4f5c30b1{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:03:57,394 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@5c82031b{/,file:///tmp/jetty-0.0.0.0-39713-hddsDatanode-_-any-4635816759433653870.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:03:57,394 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@274fdea6{HTTP/1.1,[http/1.1]}{0.0.0.0:39713}
2019-06-13 12:03:57,394 INFO  server.Server (Server.java:doStart(419)) - Started @6615ms
2019-06-13 12:03:57,395 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:39713
Jun 13, 2019 12:03:57 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:03:57,524 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@60928a61
2019-06-13 12:03:57,526 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 7 DN Heartbeats.
2019-06-13 12:03:57,533 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:03:57,535 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-6/meta/datanode.id
2019-06-13 12:03:58,023 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:03:58,023 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:03:58,024 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 6cef66d5-8cd3-44aa-be07-575ef65ad786 at port 41525
2019-06-13 12:03:58,079 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786: start RPC server
2019-06-13 12:03:58,201 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786: GrpcService started, listening on 0.0.0.0/0.0.0.0:41525
2019-06-13 12:03:58,318 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:03:58,320 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:03:58,320 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 8cecba00-b083-47df-9f5a-b6be1e470733 at port 34301
2019-06-13 12:03:58,343 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 8cecba00-b083-47df-9f5a-b6be1e470733: start RPC server
2019-06-13 12:03:58,345 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 8cecba00-b083-47df-9f5a-b6be1e470733: GrpcService started, listening on 0.0.0.0/0.0.0.0:34301
2019-06-13 12:03:58,526 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 7 DN Heartbeats.
2019-06-13 12:03:58,591 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:03:58,593 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:03:58,593 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 859621b4-b51a-492c-ad6d-3244885c0c07 at port 43419
2019-06-13 12:03:58,621 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 859621b4-b51a-492c-ad6d-3244885c0c07: start RPC server
2019-06-13 12:03:58,622 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 859621b4-b51a-492c-ad6d-3244885c0c07: GrpcService started, listening on 0.0.0.0/0.0.0.0:43419
2019-06-13 12:03:58,845 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:03:58,847 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:03:58,847 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 40e85715-f542-4fe4-a7e5-a8202a6d8f0e at port 38617
2019-06-13 12:03:58,909 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: start RPC server
2019-06-13 12:03:58,911 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: GrpcService started, listening on 0.0.0.0/0.0.0.0:38617
2019-06-13 12:03:59,091 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:03:59,092 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:03:59,092 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 4385f424-31b1-428a-a0ea-2f137423452e at port 43947
2019-06-13 12:03:59,124 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 4385f424-31b1-428a-a0ea-2f137423452e: start RPC server
2019-06-13 12:03:59,126 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 4385f424-31b1-428a-a0ea-2f137423452e: GrpcService started, listening on 0.0.0.0/0.0.0.0:43947
2019-06-13 12:03:59,330 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:03:59,332 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:03:59,332 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis cfa6ee40-d911-4f1c-9330-44c1c1a7e901 at port 39721
2019-06-13 12:03:59,341 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: start RPC server
2019-06-13 12:03:59,343 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: GrpcService started, listening on 0.0.0.0/0.0.0.0:39721
2019-06-13 12:03:59,527 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 7 DN Heartbeats.
2019-06-13 12:03:59,542 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:03:59,544 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:03:59,544 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis cbd040e8-332a-45ed-83fb-6eccf47c1134 at port 46883
2019-06-13 12:03:59,567 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - cbd040e8-332a-45ed-83fb-6eccf47c1134: start RPC server
2019-06-13 12:03:59,570 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - cbd040e8-332a-45ed-83fb-6eccf47c1134: GrpcService started, listening on 0.0.0.0/0.0.0.0:46883
2019-06-13 12:04:00,012 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 6cef66d5-8cd3-44aa-be07-575ef65ad786{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:04:00,020 INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 1 DataNodes registered, 1 required.
2019-06-13 12:04:00,020 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(177)) - ScmSafeModeManager, all rules are successfully validated
2019-06-13 12:04:00,021 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:exitSafeMode(193)) - SCM exiting safe mode.
2019-06-13 12:04:00,337 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 8cecba00-b083-47df-9f5a-b6be1e470733{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:04:00,454 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786: addNew group-5AA01594623B:[6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525] returns group-5AA01594623B:java.util.concurrent.CompletableFuture@1558df2[Not completed]
2019-06-13 12:04:00,462 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786: new RaftServerImpl for group-5AA01594623B:[6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525] with ContainerStateMachine:uninitialized
2019-06-13 12:04:00,463 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:00,464 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:00,464 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:00,470 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:00,476 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786:group-5AA01594623B ConfigurationManager, init=-1: [6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:00,477 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-0/data/ratis] (custom)
2019-06-13 12:04:00,641 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-0/data/ratis/fa242a1e-2f5c-491d-8f3c-5aa01594623b does not exist. Creating ...
2019-06-13 12:04:00,643 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 2 of 7 DN Heartbeats.
2019-06-13 12:04:00,648 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 859621b4-b51a-492c-ad6d-3244885c0c07{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:04:00,650 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-0/data/ratis/fa242a1e-2f5c-491d-8f3c-5aa01594623b/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:00,653 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-0/data/ratis/fa242a1e-2f5c-491d-8f3c-5aa01594623b has been successfully formatted.
2019-06-13 12:04:00,654 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:00,655 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:00,656 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:00,658 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:00,660 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:00,663 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:00,665 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 6cef66d5-8cd3-44aa-be07-575ef65ad786-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-0/data/ratis/fa242a1e-2f5c-491d-8f3c-5aa01594623b
2019-06-13 12:04:00,666 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:00,666 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:00,667 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:00,668 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:00,668 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:00,668 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:00,669 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:00,669 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:00,670 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:00,672 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:00,676 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:00,677 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:00,677 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:00,692 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786: start group-5AA01594623B
2019-06-13 12:04:00,693 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786:group-5AA01594623B changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:00,694 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786: start FollowerState
2019-06-13 12:04:00,696 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-5AA01594623B,id=6cef66d5-8cd3-44aa-be07-575ef65ad786
2019-06-13 12:04:00,742 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: fa242a1e-2f5c-491d-8f3c-5aa01594623b, Nodes: 6cef66d5-8cd3-44aa-be07-575ef65ad786{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:04:00,762 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 8cecba00-b083-47df-9f5a-b6be1e470733: addNew group-C97066A43D2B:[8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301] returns group-C97066A43D2B:java.util.concurrent.CompletableFuture@1e954311[Not completed]
2019-06-13 12:04:00,763 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 8cecba00-b083-47df-9f5a-b6be1e470733: new RaftServerImpl for group-C97066A43D2B:[8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301] with ContainerStateMachine:uninitialized
2019-06-13 12:04:00,764 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:00,764 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:00,764 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:00,764 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:00,764 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 8cecba00-b083-47df-9f5a-b6be1e470733:group-C97066A43D2B ConfigurationManager, init=-1: [8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:00,764 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-1/data/ratis] (custom)
2019-06-13 12:04:00,764 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-1/data/ratis/3bd32146-2159-469d-a7fe-c97066a43d2b does not exist. Creating ...
2019-06-13 12:04:00,768 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-1/data/ratis/3bd32146-2159-469d-a7fe-c97066a43d2b/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:00,771 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-1/data/ratis/3bd32146-2159-469d-a7fe-c97066a43d2b has been successfully formatted.
2019-06-13 12:04:00,772 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:00,773 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:00,773 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:00,774 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:00,774 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:00,774 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:00,774 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 8cecba00-b083-47df-9f5a-b6be1e470733-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-1/data/ratis/3bd32146-2159-469d-a7fe-c97066a43d2b
2019-06-13 12:04:00,775 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:00,775 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:00,775 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:00,775 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:00,775 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:00,775 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:00,775 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:00,775 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:00,775 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:00,776 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:00,776 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:00,776 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:00,776 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:00,777 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 8cecba00-b083-47df-9f5a-b6be1e470733: start group-C97066A43D2B
2019-06-13 12:04:00,777 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8cecba00-b083-47df-9f5a-b6be1e470733:group-C97066A43D2B changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:00,777 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8cecba00-b083-47df-9f5a-b6be1e470733: start FollowerState
2019-06-13 12:04:00,779 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C97066A43D2B,id=8cecba00-b083-47df-9f5a-b6be1e470733
2019-06-13 12:04:00,793 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 3bd32146-2159-469d-a7fe-c97066a43d2b, Nodes: 8cecba00-b083-47df-9f5a-b6be1e470733{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:04:00,808 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 859621b4-b51a-492c-ad6d-3244885c0c07: addNew group-4A43CE0213D2:[859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419] returns group-4A43CE0213D2:java.util.concurrent.CompletableFuture@4594e96[Not completed]
2019-06-13 12:04:00,847 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 40e85715-f542-4fe4-a7e5-a8202a6d8f0e{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:04:00,847 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 859621b4-b51a-492c-ad6d-3244885c0c07: new RaftServerImpl for group-4A43CE0213D2:[859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419] with ContainerStateMachine:uninitialized
2019-06-13 12:04:00,847 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:00,847 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:00,848 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:00,848 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:00,848 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 859621b4-b51a-492c-ad6d-3244885c0c07:group-4A43CE0213D2 ConfigurationManager, init=-1: [859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:00,848 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-2/data/ratis] (custom)
2019-06-13 12:04:00,848 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-2/data/ratis/611ac762-af55-4b31-b91d-4a43ce0213d2 does not exist. Creating ...
2019-06-13 12:04:00,851 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-2/data/ratis/611ac762-af55-4b31-b91d-4a43ce0213d2/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:00,853 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-2/data/ratis/611ac762-af55-4b31-b91d-4a43ce0213d2 has been successfully formatted.
2019-06-13 12:04:00,854 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:00,854 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:00,854 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:00,854 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:00,854 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:00,854 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:00,854 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 859621b4-b51a-492c-ad6d-3244885c0c07-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-2/data/ratis/611ac762-af55-4b31-b91d-4a43ce0213d2
2019-06-13 12:04:00,854 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:00,855 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:00,855 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:00,855 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:00,855 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:00,855 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:00,855 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:00,855 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:00,855 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:00,855 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:00,857 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:00,857 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:00,857 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:00,857 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 859621b4-b51a-492c-ad6d-3244885c0c07: start group-4A43CE0213D2
2019-06-13 12:04:00,857 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 859621b4-b51a-492c-ad6d-3244885c0c07:group-4A43CE0213D2 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:00,857 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 859621b4-b51a-492c-ad6d-3244885c0c07: start FollowerState
2019-06-13 12:04:00,857 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-4A43CE0213D2,id=859621b4-b51a-492c-ad6d-3244885c0c07
2019-06-13 12:04:00,878 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 611ac762-af55-4b31-b91d-4a43ce0213d2, Nodes: 859621b4-b51a-492c-ad6d-3244885c0c07{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:04:00,890 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: addNew group-D77F64A1D32A:[40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617] returns group-D77F64A1D32A:java.util.concurrent.CompletableFuture@6b9a4ba0[Not completed]
2019-06-13 12:04:00,894 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: new RaftServerImpl for group-D77F64A1D32A:[40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617] with ContainerStateMachine:uninitialized
2019-06-13 12:04:00,894 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:00,894 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:00,894 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:00,894 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:00,894 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:group-D77F64A1D32A ConfigurationManager, init=-1: [40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:00,895 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-3/data/ratis] (custom)
2019-06-13 12:04:00,895 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-3/data/ratis/2f151661-de39-4f57-9464-d77f64a1d32a does not exist. Creating ...
2019-06-13 12:04:00,898 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-3/data/ratis/2f151661-de39-4f57-9464-d77f64a1d32a/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:00,901 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-3/data/ratis/2f151661-de39-4f57-9464-d77f64a1d32a has been successfully formatted.
2019-06-13 12:04:00,901 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:00,901 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:00,901 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:00,901 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:00,901 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:00,901 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:00,901 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 40e85715-f542-4fe4-a7e5-a8202a6d8f0e-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-3/data/ratis/2f151661-de39-4f57-9464-d77f64a1d32a
2019-06-13 12:04:00,901 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:00,901 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:00,901 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:00,902 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:00,902 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:00,902 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:00,902 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:00,902 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:00,902 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:00,902 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:00,903 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:00,903 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:00,903 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:00,903 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: start group-D77F64A1D32A
2019-06-13 12:04:00,903 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:group-D77F64A1D32A changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:00,903 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: start FollowerState
2019-06-13 12:04:00,905 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D77F64A1D32A,id=40e85715-f542-4fe4-a7e5-a8202a6d8f0e
2019-06-13 12:04:00,917 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 2f151661-de39-4f57-9464-d77f64a1d32a, Nodes: 40e85715-f542-4fe4-a7e5-a8202a6d8f0e{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:04:00,946 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 859621b4-b51a-492c-ad6d-3244885c0c07: addNew group-20B8C391EFEC:[6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525, 859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419, 8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301] returns group-20B8C391EFEC:java.util.concurrent.CompletableFuture@3b3e0b1a[Not completed]
2019-06-13 12:04:00,950 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 8cecba00-b083-47df-9f5a-b6be1e470733: addNew group-20B8C391EFEC:[6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525, 859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419, 8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301] returns group-20B8C391EFEC:java.util.concurrent.CompletableFuture@3f0198a5[Not completed]
2019-06-13 12:04:00,950 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 8cecba00-b083-47df-9f5a-b6be1e470733: new RaftServerImpl for group-20B8C391EFEC:[6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525, 859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419, 8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301] with ContainerStateMachine:uninitialized
2019-06-13 12:04:00,951 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:00,951 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:00,951 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:00,951 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:00,951 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 8cecba00-b083-47df-9f5a-b6be1e470733:group-20B8C391EFEC ConfigurationManager, init=-1: [6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525, 859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419, 8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:00,951 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-1/data/ratis] (custom)
2019-06-13 12:04:00,951 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-1/data/ratis/65296e8a-15e3-4cd9-83ab-20b8c391efec does not exist. Creating ...
2019-06-13 12:04:00,953 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 859621b4-b51a-492c-ad6d-3244885c0c07: new RaftServerImpl for group-20B8C391EFEC:[6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525, 859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419, 8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301] with ContainerStateMachine:uninitialized
2019-06-13 12:04:00,953 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:00,953 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:00,953 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:00,953 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786: addNew group-20B8C391EFEC:[6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525, 859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419, 8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301] returns group-20B8C391EFEC:java.util.concurrent.CompletableFuture@9e22ef[Not completed]
2019-06-13 12:04:00,953 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:00,953 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 859621b4-b51a-492c-ad6d-3244885c0c07:group-20B8C391EFEC ConfigurationManager, init=-1: [6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525, 859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419, 8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:00,953 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-2/data/ratis] (custom)
2019-06-13 12:04:00,954 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-2/data/ratis/65296e8a-15e3-4cd9-83ab-20b8c391efec does not exist. Creating ...
2019-06-13 12:04:00,953 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786: new RaftServerImpl for group-20B8C391EFEC:[6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525, 859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419, 8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301] with ContainerStateMachine:uninitialized
2019-06-13 12:04:00,954 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:00,954 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:00,954 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:00,954 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:00,955 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786:group-20B8C391EFEC ConfigurationManager, init=-1: [6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525, 859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419, 8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:00,955 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-0/data/ratis] (custom)
2019-06-13 12:04:00,955 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-0/data/ratis/65296e8a-15e3-4cd9-83ab-20b8c391efec does not exist. Creating ...
2019-06-13 12:04:00,954 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-1/data/ratis/65296e8a-15e3-4cd9-83ab-20b8c391efec/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:00,956 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-2/data/ratis/65296e8a-15e3-4cd9-83ab-20b8c391efec/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:00,958 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-1/data/ratis/65296e8a-15e3-4cd9-83ab-20b8c391efec has been successfully formatted.
2019-06-13 12:04:00,973 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:00,974 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:00,974 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:00,974 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:00,974 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:00,974 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:00,974 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 8cecba00-b083-47df-9f5a-b6be1e470733-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-1/data/ratis/65296e8a-15e3-4cd9-83ab-20b8c391efec
2019-06-13 12:04:00,974 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:00,974 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:00,974 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:00,974 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:00,974 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:00,974 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:00,975 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:00,975 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:00,975 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:00,975 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:00,976 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:00,976 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:00,976 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:00,976 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-0/data/ratis/65296e8a-15e3-4cd9-83ab-20b8c391efec/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:00,976 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-2/data/ratis/65296e8a-15e3-4cd9-83ab-20b8c391efec has been successfully formatted.
2019-06-13 12:04:00,976 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 8cecba00-b083-47df-9f5a-b6be1e470733: start group-20B8C391EFEC
2019-06-13 12:04:00,977 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:00,977 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8cecba00-b083-47df-9f5a-b6be1e470733:group-20B8C391EFEC changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:00,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:00,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:00,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:00,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:00,978 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:00,978 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 859621b4-b51a-492c-ad6d-3244885c0c07-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-2/data/ratis/65296e8a-15e3-4cd9-83ab-20b8c391efec
2019-06-13 12:04:00,978 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:00,978 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:00,978 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:00,978 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:00,978 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:00,978 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:00,978 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-0/data/ratis/65296e8a-15e3-4cd9-83ab-20b8c391efec has been successfully formatted.
2019-06-13 12:04:00,979 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8cecba00-b083-47df-9f5a-b6be1e470733: start FollowerState
2019-06-13 12:04:00,978 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:00,979 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:00,979 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:00,979 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:00,979 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:00,980 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:00,980 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:00,980 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:00,980 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:00,980 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:00,980 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 6cef66d5-8cd3-44aa-be07-575ef65ad786-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-0/data/ratis/65296e8a-15e3-4cd9-83ab-20b8c391efec
2019-06-13 12:04:00,980 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:00,980 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:00,980 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:00,981 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:00,981 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:00,981 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:00,981 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:00,981 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:00,981 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:00,981 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:00,981 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:00,982 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:00,982 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 859621b4-b51a-492c-ad6d-3244885c0c07: start group-20B8C391EFEC
2019-06-13 12:04:00,982 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 859621b4-b51a-492c-ad6d-3244885c0c07:group-20B8C391EFEC changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:00,982 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 859621b4-b51a-492c-ad6d-3244885c0c07: start FollowerState
2019-06-13 12:04:00,982 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-20B8C391EFEC,id=859621b4-b51a-492c-ad6d-3244885c0c07
2019-06-13 12:04:00,983 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:00,983 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-20B8C391EFEC,id=8cecba00-b083-47df-9f5a-b6be1e470733
2019-06-13 12:04:00,984 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:00,984 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:00,985 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:00,987 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786: start group-20B8C391EFEC
2019-06-13 12:04:00,987 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786:group-20B8C391EFEC changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:00,987 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786: start FollowerState
2019-06-13 12:04:00,987 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-20B8C391EFEC,id=6cef66d5-8cd3-44aa-be07-575ef65ad786
2019-06-13 12:04:01,007 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 65296e8a-15e3-4cd9-83ab-20b8c391efec, Nodes: 8cecba00-b083-47df-9f5a-b6be1e470733{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}6cef66d5-8cd3-44aa-be07-575ef65ad786{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}859621b4-b51a-492c-ad6d-3244885c0c07{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-13 12:04:01,083 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 4385f424-31b1-428a-a0ea-2f137423452e{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:04:01,094 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 4385f424-31b1-428a-a0ea-2f137423452e: addNew group-369E7644B2E9:[4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947] returns group-369E7644B2E9:java.util.concurrent.CompletableFuture@1a2cfe6e[Not completed]
2019-06-13 12:04:01,096 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 4385f424-31b1-428a-a0ea-2f137423452e: new RaftServerImpl for group-369E7644B2E9:[4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947] with ContainerStateMachine:uninitialized
2019-06-13 12:04:01,096 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:01,096 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:01,096 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:01,096 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:01,097 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-369E7644B2E9 ConfigurationManager, init=-1: [4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:01,097 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-4/data/ratis] (custom)
2019-06-13 12:04:01,097 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-4/data/ratis/d74e3f68-ae12-42f7-8208-369e7644b2e9 does not exist. Creating ...
2019-06-13 12:04:01,101 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-4/data/ratis/d74e3f68-ae12-42f7-8208-369e7644b2e9/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:01,103 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-4/data/ratis/d74e3f68-ae12-42f7-8208-369e7644b2e9 has been successfully formatted.
2019-06-13 12:04:01,103 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:01,103 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:01,103 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:01,103 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:01,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:01,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:01,104 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 4385f424-31b1-428a-a0ea-2f137423452e-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-4/data/ratis/d74e3f68-ae12-42f7-8208-369e7644b2e9
2019-06-13 12:04:01,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:01,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:01,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:01,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:01,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:01,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:01,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:01,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:01,105 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:01,105 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:01,105 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:01,105 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:01,105 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:01,105 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 4385f424-31b1-428a-a0ea-2f137423452e: start group-369E7644B2E9
2019-06-13 12:04:01,105 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-369E7644B2E9 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:01,106 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:01,106 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-369E7644B2E9,id=4385f424-31b1-428a-a0ea-2f137423452e
2019-06-13 12:04:01,114 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: d74e3f68-ae12-42f7-8208-369e7644b2e9, Nodes: 4385f424-31b1-428a-a0ea-2f137423452e{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:04:01,316 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : cfa6ee40-d911-4f1c-9330-44c1c1a7e901{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:04:01,331 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: addNew group-186A2E842470:[cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721] returns group-186A2E842470:java.util.concurrent.CompletableFuture@63c0cd6b[Not completed]
2019-06-13 12:04:01,332 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: new RaftServerImpl for group-186A2E842470:[cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721] with ContainerStateMachine:uninitialized
2019-06-13 12:04:01,332 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:01,332 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:01,332 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:01,332 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:01,332 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901:group-186A2E842470 ConfigurationManager, init=-1: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:01,333 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-5/data/ratis] (custom)
2019-06-13 12:04:01,333 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-5/data/ratis/55dac406-2a8a-4a18-96c5-186a2e842470 does not exist. Creating ...
2019-06-13 12:04:01,337 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-5/data/ratis/55dac406-2a8a-4a18-96c5-186a2e842470/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:01,339 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-5/data/ratis/55dac406-2a8a-4a18-96c5-186a2e842470 has been successfully formatted.
2019-06-13 12:04:01,339 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:01,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:01,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:01,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:01,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:01,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:01,339 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new cfa6ee40-d911-4f1c-9330-44c1c1a7e901-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-5/data/ratis/55dac406-2a8a-4a18-96c5-186a2e842470
2019-06-13 12:04:01,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:01,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:01,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:01,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:01,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:01,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:01,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:01,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:01,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:01,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:01,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:01,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:01,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:01,341 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: start group-186A2E842470
2019-06-13 12:04:01,341 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901:group-186A2E842470 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:01,341 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: start FollowerState
2019-06-13 12:04:01,341 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-186A2E842470,id=cfa6ee40-d911-4f1c-9330-44c1c1a7e901
2019-06-13 12:04:01,348 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 55dac406-2a8a-4a18-96c5-186a2e842470, Nodes: cfa6ee40-d911-4f1c-9330-44c1c1a7e901{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:04:01,366 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 4385f424-31b1-428a-a0ea-2f137423452e: addNew group-BCE6487231AC:[cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617] returns group-BCE6487231AC:java.util.concurrent.CompletableFuture@6170611d[Not completed]
2019-06-13 12:04:01,371 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 4385f424-31b1-428a-a0ea-2f137423452e: new RaftServerImpl for group-BCE6487231AC:[cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617] with ContainerStateMachine:uninitialized
2019-06-13 12:04:01,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:01,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:01,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:01,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:01,372 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC ConfigurationManager, init=-1: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:01,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-4/data/ratis] (custom)
2019-06-13 12:04:01,372 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-4/data/ratis/f1780b47-6fe6-43aa-ae34-bce6487231ac does not exist. Creating ...
2019-06-13 12:04:01,373 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: addNew group-BCE6487231AC:[cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617] returns group-BCE6487231AC:java.util.concurrent.CompletableFuture@654fe9eb[Not completed]
2019-06-13 12:04:01,375 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: addNew group-BCE6487231AC:[cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617] returns group-BCE6487231AC:java.util.concurrent.CompletableFuture@1f0874f7[Not completed]
2019-06-13 12:04:01,375 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: new RaftServerImpl for group-BCE6487231AC:[cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617] with ContainerStateMachine:uninitialized
2019-06-13 12:04:01,375 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:01,375 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:01,376 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:01,376 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:01,376 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901:group-BCE6487231AC ConfigurationManager, init=-1: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:01,376 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-5/data/ratis] (custom)
2019-06-13 12:04:01,376 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-5/data/ratis/f1780b47-6fe6-43aa-ae34-bce6487231ac does not exist. Creating ...
2019-06-13 12:04:01,376 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-4/data/ratis/f1780b47-6fe6-43aa-ae34-bce6487231ac/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:01,378 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: new RaftServerImpl for group-BCE6487231AC:[cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617] with ContainerStateMachine:uninitialized
2019-06-13 12:04:01,378 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:01,378 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:01,378 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:01,378 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-5/data/ratis/f1780b47-6fe6-43aa-ae34-bce6487231ac/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:01,378 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:01,378 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:group-BCE6487231AC ConfigurationManager, init=-1: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:01,379 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-3/data/ratis] (custom)
2019-06-13 12:04:01,379 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-3/data/ratis/f1780b47-6fe6-43aa-ae34-bce6487231ac does not exist. Creating ...
2019-06-13 12:04:01,379 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-4/data/ratis/f1780b47-6fe6-43aa-ae34-bce6487231ac has been successfully formatted.
2019-06-13 12:04:01,379 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:01,380 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:01,380 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:01,380 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:01,380 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:01,380 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:01,380 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 4385f424-31b1-428a-a0ea-2f137423452e-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-4/data/ratis/f1780b47-6fe6-43aa-ae34-bce6487231ac
2019-06-13 12:04:01,380 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:01,380 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:01,381 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:01,381 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:01,381 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:01,381 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:01,381 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-5/data/ratis/f1780b47-6fe6-43aa-ae34-bce6487231ac has been successfully formatted.
2019-06-13 12:04:01,381 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:01,381 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:01,381 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:01,382 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:01,382 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:01,382 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:01,382 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new cfa6ee40-d911-4f1c-9330-44c1c1a7e901-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-5/data/ratis/f1780b47-6fe6-43aa-ae34-bce6487231ac
2019-06-13 12:04:01,382 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:01,382 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:01,382 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:01,382 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:01,382 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:01,382 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:01,383 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:01,383 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:01,383 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:01,383 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:01,383 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:01,383 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:01,384 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:01,384 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: start group-BCE6487231AC
2019-06-13 12:04:01,384 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901:group-BCE6487231AC changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:01,384 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: start FollowerState
2019-06-13 12:04:01,384 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-BCE6487231AC,id=cfa6ee40-d911-4f1c-9330-44c1c1a7e901
2019-06-13 12:04:01,384 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:01,385 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:01,385 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:01,385 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:01,385 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-3/data/ratis/f1780b47-6fe6-43aa-ae34-bce6487231ac/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:01,385 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:01,386 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:01,386 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:01,386 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 4385f424-31b1-428a-a0ea-2f137423452e: start group-BCE6487231AC
2019-06-13 12:04:01,387 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:01,388 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:01,388 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-3/data/ratis/f1780b47-6fe6-43aa-ae34-bce6487231ac has been successfully formatted.
2019-06-13 12:04:01,388 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:01,388 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:01,388 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:01,388 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:01,389 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:01,389 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:01,389 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 40e85715-f542-4fe4-a7e5-a8202a6d8f0e-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-3/data/ratis/f1780b47-6fe6-43aa-ae34-bce6487231ac
2019-06-13 12:04:01,389 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:01,389 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:01,389 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:01,389 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:01,389 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:01,389 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:01,389 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:01,389 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-BCE6487231AC,id=4385f424-31b1-428a-a0ea-2f137423452e
2019-06-13 12:04:01,390 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:01,390 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:01,393 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:01,403 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:01,403 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:01,403 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:01,403 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: start group-BCE6487231AC
2019-06-13 12:04:01,403 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:group-BCE6487231AC changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:01,403 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: start FollowerState
2019-06-13 12:04:01,405 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-BCE6487231AC,id=40e85715-f542-4fe4-a7e5-a8202a6d8f0e
2019-06-13 12:04:01,422 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: f1780b47-6fe6-43aa-ae34-bce6487231ac, Nodes: cfa6ee40-d911-4f1c-9330-44c1c1a7e901{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}40e85715-f542-4fe4-a7e5-a8202a6d8f0e{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}4385f424-31b1-428a-a0ea-2f137423452e{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-13 12:04:01,535 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : cbd040e8-332a-45ed-83fb-6eccf47c1134{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:04:01,549 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - cbd040e8-332a-45ed-83fb-6eccf47c1134: addNew group-07A75213DABF:[cbd040e8-332a-45ed-83fb-6eccf47c1134:192.168.46.58:46883] returns group-07A75213DABF:java.util.concurrent.CompletableFuture@a094085[Not completed]
2019-06-13 12:04:01,551 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - cbd040e8-332a-45ed-83fb-6eccf47c1134: new RaftServerImpl for group-07A75213DABF:[cbd040e8-332a-45ed-83fb-6eccf47c1134:192.168.46.58:46883] with ContainerStateMachine:uninitialized
2019-06-13 12:04:01,551 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:01,551 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:01,551 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:01,551 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:01,551 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - cbd040e8-332a-45ed-83fb-6eccf47c1134:group-07A75213DABF ConfigurationManager, init=-1: [cbd040e8-332a-45ed-83fb-6eccf47c1134:192.168.46.58:46883], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:01,552 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-6/data/ratis] (custom)
2019-06-13 12:04:01,552 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-6/data/ratis/f1ffeb69-68cf-4322-829f-07a75213dabf does not exist. Creating ...
2019-06-13 12:04:01,554 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-6/data/ratis/f1ffeb69-68cf-4322-829f-07a75213dabf/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:01,556 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-6/data/ratis/f1ffeb69-68cf-4322-829f-07a75213dabf has been successfully formatted.
2019-06-13 12:04:01,556 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:01,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:01,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:01,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:01,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:01,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:01,557 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new cbd040e8-332a-45ed-83fb-6eccf47c1134-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-6/data/ratis/f1ffeb69-68cf-4322-829f-07a75213dabf
2019-06-13 12:04:01,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:01,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:01,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:01,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:01,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:01,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:01,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:01,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:01,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:01,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:01,558 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:01,558 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:01,558 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:01,558 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - cbd040e8-332a-45ed-83fb-6eccf47c1134: start group-07A75213DABF
2019-06-13 12:04:01,558 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cbd040e8-332a-45ed-83fb-6eccf47c1134:group-07A75213DABF changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:01,558 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cbd040e8-332a-45ed-83fb-6eccf47c1134: start FollowerState
2019-06-13 12:04:01,558 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-07A75213DABF,id=cbd040e8-332a-45ed-83fb-6eccf47c1134
2019-06-13 12:04:01,564 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: f1ffeb69-68cf-4322-829f-07a75213dabf, Nodes: cbd040e8-332a-45ed-83fb-6eccf47c1134{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:04:01,643 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Cluster is ready. Got 7 of 7 DN Heartbeats.
2019-06-13 12:04:01,819 INFO  impl.FollowerState (FollowerState.java:run(101)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786:group-5AA01594623B changes to CANDIDATE, lastRpcTime:1125, electionTimeout:1124ms
2019-06-13 12:04:01,819 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786: shutdown FollowerState
2019-06-13 12:04:01,819 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786:group-5AA01594623B changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:01,821 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786: start LeaderElection
2019-06-13 12:04:01,829 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786:group-5AA01594623B:LeaderElection1: begin an election at term 1 for -1: [6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525], old=null
2019-06-13 12:04:01,830 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786: shutdown LeaderElection
2019-06-13 12:04:01,831 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786:group-5AA01594623B changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:01,831 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786:group-5AA01594623B change Leader from null to 6cef66d5-8cd3-44aa-be07-575ef65ad786 at term 1 for becomeLeader, leader elected after 1176ms
2019-06-13 12:04:01,835 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:01,835 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:01,837 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:01,838 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:01,844 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786: start LeaderState
2019-06-13 12:04:01,874 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:01,891 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786:group-5AA01594623B set configuration 0: [6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525], old=null at 0
2019-06-13 12:04:01,895 INFO  rpc.RpcClient (RpcClient.java:createVolume(289)) - Creating Volume: watchforcommithandlingtest, with root as owner.
2019-06-13 12:04:01,924 INFO  impl.FollowerState (FollowerState.java:run(101)) - 8cecba00-b083-47df-9f5a-b6be1e470733:group-C97066A43D2B changes to CANDIDATE, lastRpcTime:1146, electionTimeout:1145ms
2019-06-13 12:04:01,926 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 8cecba00-b083-47df-9f5a-b6be1e470733: shutdown FollowerState
2019-06-13 12:04:01,926 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8cecba00-b083-47df-9f5a-b6be1e470733:group-C97066A43D2B changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:01,926 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8cecba00-b083-47df-9f5a-b6be1e470733: start LeaderElection
2019-06-13 12:04:01,936 INFO  rpc.RpcClient (RpcClient.java:createBucket(426)) - Creating Bucket: watchforcommithandlingtest/watchforcommithandlingtest, with Versioning false and Storage Type set to DISK and Encryption set to false 
2019-06-13 12:04:01,937 INFO  impl.FollowerState (FollowerState.java:run(101)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:group-D77F64A1D32A changes to CANDIDATE, lastRpcTime:1034, electionTimeout:1032ms
2019-06-13 12:04:01,938 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: shutdown FollowerState
2019-06-13 12:04:01,938 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:group-D77F64A1D32A changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:01,938 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: start LeaderElection
2019-06-13 12:04:01,939 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 8cecba00-b083-47df-9f5a-b6be1e470733:group-C97066A43D2B:LeaderElection2: begin an election at term 1 for -1: [8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301], old=null
2019-06-13 12:04:01,947 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 8cecba00-b083-47df-9f5a-b6be1e470733: shutdown LeaderElection
2019-06-13 12:04:01,947 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8cecba00-b083-47df-9f5a-b6be1e470733:group-C97066A43D2B changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:01,947 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 8cecba00-b083-47df-9f5a-b6be1e470733:group-C97066A43D2B change Leader from null to 8cecba00-b083-47df-9f5a-b6be1e470733 at term 1 for becomeLeader, leader elected after 1173ms
2019-06-13 12:04:01,949 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:01,949 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:01,949 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:01,949 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:01,950 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8cecba00-b083-47df-9f5a-b6be1e470733: start LeaderState
2019-06-13 12:04:01,950 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 8cecba00-b083-47df-9f5a-b6be1e470733-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:01,951 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:getStorageContainerLocationClient(241)) - Creating StorageContainerLocationProtocol RPC client with address /0.0.0.0:45813
2019-06-13 12:04:01,953 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 8cecba00-b083-47df-9f5a-b6be1e470733:group-C97066A43D2B set configuration 0: [8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301], old=null at 0
2019-06-13 12:04:01,973 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:group-D77F64A1D32A:LeaderElection3: begin an election at term 1 for -1: [40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:01,973 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: shutdown LeaderElection
2019-06-13 12:04:01,974 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:group-D77F64A1D32A changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:01,974 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:group-D77F64A1D32A change Leader from null to 40e85715-f542-4fe4-a7e5-a8202a6d8f0e at term 1 for becomeLeader, leader elected after 1072ms
2019-06-13 12:04:01,981 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:01,981 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:01,981 INFO  impl.FollowerState (FollowerState.java:run(101)) - 859621b4-b51a-492c-ad6d-3244885c0c07:group-4A43CE0213D2 changes to CANDIDATE, lastRpcTime:1124, electionTimeout:1117ms
2019-06-13 12:04:01,981 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 859621b4-b51a-492c-ad6d-3244885c0c07: shutdown FollowerState
2019-06-13 12:04:01,981 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:01,981 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 859621b4-b51a-492c-ad6d-3244885c0c07:group-4A43CE0213D2 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:01,987 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 859621b4-b51a-492c-ad6d-3244885c0c07: start LeaderElection
2019-06-13 12:04:01,982 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:01,988 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: start LeaderState
2019-06-13 12:04:01,988 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:02,008 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:group-D77F64A1D32A set configuration 0: [40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null at 0
2019-06-13 12:04:02,014 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 859621b4-b51a-492c-ad6d-3244885c0c07:group-4A43CE0213D2:LeaderElection4: begin an election at term 1 for -1: [859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419], old=null
2019-06-13 12:04:02,014 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 859621b4-b51a-492c-ad6d-3244885c0c07: shutdown LeaderElection
2019-06-13 12:04:02,014 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 859621b4-b51a-492c-ad6d-3244885c0c07:group-4A43CE0213D2 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:02,015 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 859621b4-b51a-492c-ad6d-3244885c0c07:group-4A43CE0213D2 change Leader from null to 859621b4-b51a-492c-ad6d-3244885c0c07 at term 1 for becomeLeader, leader elected after 1161ms
2019-06-13 12:04:02,016 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:02,017 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:02,017 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:02,017 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:02,017 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 859621b4-b51a-492c-ad6d-3244885c0c07: start LeaderState
2019-06-13 12:04:02,017 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 859621b4-b51a-492c-ad6d-3244885c0c07-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:02,018 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 859621b4-b51a-492c-ad6d-3244885c0c07:group-4A43CE0213D2 set configuration 0: [859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419], old=null at 0
2019-06-13 12:04:02,082 INFO  impl.FollowerState (FollowerState.java:run(101)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786:group-20B8C391EFEC changes to CANDIDATE, lastRpcTime:1094, electionTimeout:1094ms
2019-06-13 12:04:02,082 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786: shutdown FollowerState
2019-06-13 12:04:02,082 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786:group-20B8C391EFEC changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:02,082 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786: start LeaderElection
2019-06-13 12:04:02,112 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786:group-20B8C391EFEC:LeaderElection5: begin an election at term 1 for -1: [6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525, 859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419, 8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301], old=null
2019-06-13 12:04:02,129 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-369E7644B2E9 changes to CANDIDATE, lastRpcTime:1023, electionTimeout:1023ms
2019-06-13 12:04:02,129 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:02,129 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-369E7644B2E9 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:02,129 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:02,172 INFO  impl.FollowerState (FollowerState.java:run(101)) - 859621b4-b51a-492c-ad6d-3244885c0c07:group-20B8C391EFEC changes to CANDIDATE, lastRpcTime:1190, electionTimeout:1190ms
2019-06-13 12:04:02,173 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 859621b4-b51a-492c-ad6d-3244885c0c07: shutdown FollowerState
2019-06-13 12:04:02,173 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 859621b4-b51a-492c-ad6d-3244885c0c07:group-20B8C391EFEC changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:02,173 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 859621b4-b51a-492c-ad6d-3244885c0c07: start LeaderElection
2019-06-13 12:04:02,173 INFO  impl.FollowerState (FollowerState.java:run(101)) - 8cecba00-b083-47df-9f5a-b6be1e470733:group-20B8C391EFEC changes to CANDIDATE, lastRpcTime:1194, electionTimeout:1185ms
2019-06-13 12:04:02,173 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 8cecba00-b083-47df-9f5a-b6be1e470733: shutdown FollowerState
2019-06-13 12:04:02,173 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8cecba00-b083-47df-9f5a-b6be1e470733:group-20B8C391EFEC changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:02,173 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-369E7644B2E9:LeaderElection6: begin an election at term 1 for -1: [4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947], old=null
2019-06-13 12:04:02,173 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:02,173 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-369E7644B2E9 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:02,173 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-369E7644B2E9 change Leader from null to 4385f424-31b1-428a-a0ea-2f137423452e at term 1 for becomeLeader, leader elected after 1070ms
2019-06-13 12:04:02,200 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8cecba00-b083-47df-9f5a-b6be1e470733: start LeaderElection
2019-06-13 12:04:02,200 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:02,219 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:02,219 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:02,219 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:02,219 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderState
2019-06-13 12:04:02,219 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 4385f424-31b1-428a-a0ea-2f137423452e-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:02,225 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 859621b4-b51a-492c-ad6d-3244885c0c07-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-2/data/ratis/611ac762-af55-4b31-b91d-4a43ce0213d2/current/log_inprogress_0
2019-06-13 12:04:02,225 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-369E7644B2E9 set configuration 0: [4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947], old=null at 0
2019-06-13 12:04:02,226 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 8cecba00-b083-47df-9f5a-b6be1e470733-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-1/data/ratis/3bd32146-2159-469d-a7fe-c97066a43d2b/current/log_inprogress_0
2019-06-13 12:04:02,264 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 4385f424-31b1-428a-a0ea-2f137423452e-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-4/data/ratis/d74e3f68-ae12-42f7-8208-369e7644b2e9/current/log_inprogress_0
2019-06-13 12:04:02,264 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 859621b4-b51a-492c-ad6d-3244885c0c07:group-20B8C391EFEC:LeaderElection7: begin an election at term 1 for -1: [6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525, 859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419, 8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301], old=null
2019-06-13 12:04:02,241 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-0/data/ratis/fa242a1e-2f5c-491d-8f3c-5aa01594623b/current/log_inprogress_0
2019-06-13 12:04:02,241 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-3/data/ratis/2f151661-de39-4f57-9464-d77f64a1d32a/current/log_inprogress_0
2019-06-13 12:04:02,273 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 8cecba00-b083-47df-9f5a-b6be1e470733:group-20B8C391EFEC:LeaderElection8: begin an election at term 1 for -1: [6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525, 859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419, 8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301], old=null
2019-06-13 12:04:02,308 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786:group-20B8C391EFEC:LeaderElection5: Election REJECTED; received 2 response(s) [6cef66d5-8cd3-44aa-be07-575ef65ad786->859621b4-b51a-492c-ad6d-3244885c0c07,false-t1, 6cef66d5-8cd3-44aa-be07-575ef65ad786->8cecba00-b083-47df-9f5a-b6be1e470733,false-t1] and 0 exception(s); 6cef66d5-8cd3-44aa-be07-575ef65ad786:t1, leader=null, voted=6cef66d5-8cd3-44aa-be07-575ef65ad786, raftlog=6cef66d5-8cd3-44aa-be07-575ef65ad786-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525, 859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419, 8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301], old=null
2019-06-13 12:04:02,308 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786:group-20B8C391EFEC changes role from CANDIDATE to FOLLOWER at term 1 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:02,308 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786: shutdown LeaderElection
2019-06-13 12:04:02,309 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786: start FollowerState
2019-06-13 12:04:02,340 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 8cecba00-b083-47df-9f5a-b6be1e470733:group-20B8C391EFEC:LeaderElection8: Election REJECTED; received 2 response(s) [8cecba00-b083-47df-9f5a-b6be1e470733->6cef66d5-8cd3-44aa-be07-575ef65ad786,false-t1, 8cecba00-b083-47df-9f5a-b6be1e470733->859621b4-b51a-492c-ad6d-3244885c0c07,false-t1] and 0 exception(s); 8cecba00-b083-47df-9f5a-b6be1e470733:t1, leader=null, voted=8cecba00-b083-47df-9f5a-b6be1e470733, raftlog=8cecba00-b083-47df-9f5a-b6be1e470733-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525, 859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419, 8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301], old=null
2019-06-13 12:04:02,342 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8cecba00-b083-47df-9f5a-b6be1e470733:group-20B8C391EFEC changes role from CANDIDATE to FOLLOWER at term 1 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:02,342 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 8cecba00-b083-47df-9f5a-b6be1e470733: shutdown LeaderElection
2019-06-13 12:04:02,343 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8cecba00-b083-47df-9f5a-b6be1e470733: start FollowerState
2019-06-13 12:04:02,348 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 859621b4-b51a-492c-ad6d-3244885c0c07:group-20B8C391EFEC:LeaderElection7: Election REJECTED; received 2 response(s) [859621b4-b51a-492c-ad6d-3244885c0c07->6cef66d5-8cd3-44aa-be07-575ef65ad786,false-t1, 859621b4-b51a-492c-ad6d-3244885c0c07->8cecba00-b083-47df-9f5a-b6be1e470733,false-t1] and 0 exception(s); 859621b4-b51a-492c-ad6d-3244885c0c07:t1, leader=null, voted=859621b4-b51a-492c-ad6d-3244885c0c07, raftlog=859621b4-b51a-492c-ad6d-3244885c0c07-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525, 859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419, 8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301], old=null
2019-06-13 12:04:02,349 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 859621b4-b51a-492c-ad6d-3244885c0c07:group-20B8C391EFEC changes role from CANDIDATE to FOLLOWER at term 1 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:02,349 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 859621b4-b51a-492c-ad6d-3244885c0c07: shutdown LeaderElection
2019-06-13 12:04:02,349 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 859621b4-b51a-492c-ad6d-3244885c0c07: start FollowerState
2019-06-13 12:04:02,388 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8ED239EB40DA->cfa6ee40-d911-4f1c-9330-44c1c1a7e901: receive RaftClientReply:client-8ED239EB40DA->cfa6ee40-d911-4f1c-9330-44c1c1a7e901@group-BCE6487231AC, cid=13, FAILED org.apache.ratis.protocol.NotLeaderException: Server cfa6ee40-d911-4f1c-9330-44c1c1a7e901 is not the leader (4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947). Request must be sent to leader., logIndex=0, commits[cfa6ee40-d911-4f1c-9330-44c1c1a7e901:c-1]
2019-06-13 12:04:02,396 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:02,490 INFO  impl.FollowerState (FollowerState.java:run(101)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1106, electionTimeout:1106ms
2019-06-13 12:04:02,492 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: shutdown FollowerState
2019-06-13 12:04:02,492 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:02,492 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: start LeaderElection
2019-06-13 12:04:02,497 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901:group-BCE6487231AC:LeaderElection9: begin an election at term 1 for -1: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:02,506 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1118, electionTimeout:1116ms
2019-06-13 12:04:02,506 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:02,506 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:02,506 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:02,515 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:group-BCE6487231AC changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:cfa6ee40-d911-4f1c-9330-44c1c1a7e901
2019-06-13 12:04:02,515 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: shutdown FollowerState
2019-06-13 12:04:02,516 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: start FollowerState
2019-06-13 12:04:02,516 INFO  impl.FollowerState (FollowerState.java:run(109)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:04:02,516 INFO  impl.FollowerState (FollowerState.java:run(101)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901:group-186A2E842470 changes to CANDIDATE, lastRpcTime:1174, electionTimeout:1174ms
2019-06-13 12:04:02,516 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: shutdown FollowerState
2019-06-13 12:04:02,516 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901:group-186A2E842470 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:02,519 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: start LeaderElection
2019-06-13 12:04:02,522 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection10: begin an election at term 1 for -1: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:02,527 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901:group-186A2E842470:LeaderElection11: begin an election at term 1 for -1: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721], old=null
2019-06-13 12:04:02,527 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: shutdown LeaderElection
2019-06-13 12:04:02,528 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901:group-186A2E842470 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:02,528 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901:group-186A2E842470 change Leader from null to cfa6ee40-d911-4f1c-9330-44c1c1a7e901 at term 1 for becomeLeader, leader elected after 1188ms
2019-06-13 12:04:02,529 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901:group-BCE6487231AC:LeaderElection9: Election PASSED; received 1 response(s) [cfa6ee40-d911-4f1c-9330-44c1c1a7e901->40e85715-f542-4fe4-a7e5-a8202a6d8f0e,true-t1] and 0 exception(s); cfa6ee40-d911-4f1c-9330-44c1c1a7e901:t1, leader=null, voted=cfa6ee40-d911-4f1c-9330-44c1c1a7e901, raftlog=cfa6ee40-d911-4f1c-9330-44c1c1a7e901-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:02,529 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: shutdown LeaderElection
2019-06-13 12:04:02,530 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901:group-BCE6487231AC changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:02,530 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901:group-BCE6487231AC change Leader from null to cfa6ee40-d911-4f1c-9330-44c1c1a7e901 at term 1 for becomeLeader, leader elected after 1148ms
2019-06-13 12:04:02,530 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:02,530 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:02,530 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:02,530 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:02,532 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 12:04:02,532 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:02,533 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 12:04:02,537 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 12:04:02,538 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:02,545 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:02,545 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:02,547 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:02,547 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:02,547 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:02,547 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: start LeaderState
2019-06-13 12:04:02,548 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:02,553 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901:group-186A2E842470 set configuration 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721], old=null at 0
2019-06-13 12:04:02,546 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 12:04:02,567 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:02,567 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 12:04:02,567 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 12:04:02,567 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:02,567 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:02,567 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: start LeaderState
2019-06-13 12:04:02,568 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:02,614 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-5/data/ratis/55dac406-2a8a-4a18-96c5-186a2e842470/current/log_inprogress_0
2019-06-13 12:04:02,615 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901:group-BCE6487231AC set configuration 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null at 0
2019-06-13 12:04:02,618 INFO  impl.RaftServerImpl (RaftServerImpl.java:requestVote(738)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901-LEADER: Withhold vote from candidate 4385f424-31b1-428a-a0ea-2f137423452e with term 1. State: leader=cfa6ee40-d911-4f1c-9330-44c1c1a7e901, term=1, lastRpcElapsed=null
2019-06-13 12:04:02,618 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-5/data/ratis/f1780b47-6fe6-43aa-ae34-bce6487231ac/current/log_inprogress_0
2019-06-13 12:04:02,622 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection10: Election REJECTED; received 2 response(s) [4385f424-31b1-428a-a0ea-2f137423452e->cfa6ee40-d911-4f1c-9330-44c1c1a7e901,false-t1, 4385f424-31b1-428a-a0ea-2f137423452e->40e85715-f542-4fe4-a7e5-a8202a6d8f0e,false-t1] and 0 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t1, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:02,622 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 1 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:02,622 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:02,622 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:02,635 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC change Leader from null to cfa6ee40-d911-4f1c-9330-44c1c1a7e901 at term 1 for appendEntries, leader elected after 1255ms
2019-06-13 12:04:02,636 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:group-BCE6487231AC change Leader from null to cfa6ee40-d911-4f1c-9330-44c1c1a7e901 at term 1 for appendEntries, leader elected after 1248ms
2019-06-13 12:04:02,657 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC set configuration 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null at 0
2019-06-13 12:04:02,657 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:group-BCE6487231AC set configuration 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null at 0
2019-06-13 12:04:02,658 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 4385f424-31b1-428a-a0ea-2f137423452e-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:02,658 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:02,698 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 4385f424-31b1-428a-a0ea-2f137423452e-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-4/data/ratis/f1780b47-6fe6-43aa-ae34-bce6487231ac/current/log_inprogress_0
2019-06-13 12:04:02,707 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-3/data/ratis/f1780b47-6fe6-43aa-ae34-bce6487231ac/current/log_inprogress_0
2019-06-13 12:04:02,725 INFO  impl.FollowerState (FollowerState.java:run(101)) - cbd040e8-332a-45ed-83fb-6eccf47c1134:group-07A75213DABF changes to CANDIDATE, lastRpcTime:1166, electionTimeout:1166ms
2019-06-13 12:04:02,725 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - cbd040e8-332a-45ed-83fb-6eccf47c1134: shutdown FollowerState
2019-06-13 12:04:02,725 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cbd040e8-332a-45ed-83fb-6eccf47c1134:group-07A75213DABF changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:02,725 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cbd040e8-332a-45ed-83fb-6eccf47c1134: start LeaderElection
2019-06-13 12:04:02,731 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - cbd040e8-332a-45ed-83fb-6eccf47c1134:group-07A75213DABF:LeaderElection12: begin an election at term 1 for -1: [cbd040e8-332a-45ed-83fb-6eccf47c1134:192.168.46.58:46883], old=null
2019-06-13 12:04:02,731 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - cbd040e8-332a-45ed-83fb-6eccf47c1134: shutdown LeaderElection
2019-06-13 12:04:02,732 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cbd040e8-332a-45ed-83fb-6eccf47c1134:group-07A75213DABF changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:02,732 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - cbd040e8-332a-45ed-83fb-6eccf47c1134:group-07A75213DABF change Leader from null to cbd040e8-332a-45ed-83fb-6eccf47c1134 at term 1 for becomeLeader, leader elected after 1175ms
2019-06-13 12:04:02,733 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:02,733 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:02,733 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:02,733 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:02,733 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cbd040e8-332a-45ed-83fb-6eccf47c1134: start LeaderState
2019-06-13 12:04:02,733 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - cbd040e8-332a-45ed-83fb-6eccf47c1134-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:02,734 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - cbd040e8-332a-45ed-83fb-6eccf47c1134:group-07A75213DABF set configuration 0: [cbd040e8-332a-45ed-83fb-6eccf47c1134:192.168.46.58:46883], old=null at 0
2019-06-13 12:04:02,770 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - cbd040e8-332a-45ed-83fb-6eccf47c1134-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-6/data/ratis/f1ffeb69-68cf-4322-829f-07a75213dabf/current/log_inprogress_0
2019-06-13 12:04:03,312 INFO  impl.FollowerState (FollowerState.java:run(101)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786:group-20B8C391EFEC changes to CANDIDATE, lastRpcTime:1003, electionTimeout:1000ms
2019-06-13 12:04:03,312 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786: shutdown FollowerState
2019-06-13 12:04:03,312 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786:group-20B8C391EFEC changes role from FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2019-06-13 12:04:03,312 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786: start LeaderElection
2019-06-13 12:04:03,321 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786:group-20B8C391EFEC:LeaderElection13: begin an election at term 2 for -1: [6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525, 859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419, 8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301], old=null
2019-06-13 12:04:03,326 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8cecba00-b083-47df-9f5a-b6be1e470733:group-20B8C391EFEC changes role from FOLLOWER to FOLLOWER at term 2 for recognizeCandidate:6cef66d5-8cd3-44aa-be07-575ef65ad786
2019-06-13 12:04:03,326 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 8cecba00-b083-47df-9f5a-b6be1e470733: shutdown FollowerState
2019-06-13 12:04:03,327 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8cecba00-b083-47df-9f5a-b6be1e470733: start FollowerState
2019-06-13 12:04:03,327 INFO  impl.FollowerState (FollowerState.java:run(109)) - 8cecba00-b083-47df-9f5a-b6be1e470733: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:04:03,334 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 859621b4-b51a-492c-ad6d-3244885c0c07:group-20B8C391EFEC changes role from FOLLOWER to FOLLOWER at term 2 for recognizeCandidate:6cef66d5-8cd3-44aa-be07-575ef65ad786
2019-06-13 12:04:03,334 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 859621b4-b51a-492c-ad6d-3244885c0c07: shutdown FollowerState
2019-06-13 12:04:03,334 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 859621b4-b51a-492c-ad6d-3244885c0c07: start FollowerState
2019-06-13 12:04:03,335 INFO  impl.FollowerState (FollowerState.java:run(109)) - 859621b4-b51a-492c-ad6d-3244885c0c07: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:04:03,340 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786:group-20B8C391EFEC:LeaderElection13: Election PASSED; received 1 response(s) [6cef66d5-8cd3-44aa-be07-575ef65ad786->8cecba00-b083-47df-9f5a-b6be1e470733,true-t2] and 0 exception(s); 6cef66d5-8cd3-44aa-be07-575ef65ad786:t2, leader=null, voted=6cef66d5-8cd3-44aa-be07-575ef65ad786, raftlog=6cef66d5-8cd3-44aa-be07-575ef65ad786-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525, 859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419, 8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301], old=null
2019-06-13 12:04:03,341 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786: shutdown LeaderElection
2019-06-13 12:04:03,341 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786:group-20B8C391EFEC changes role from CANDIDATE to LEADER at term 2 for changeToLeader
2019-06-13 12:04:03,341 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786:group-20B8C391EFEC change Leader from null to 6cef66d5-8cd3-44aa-be07-575ef65ad786 at term 2 for becomeLeader, leader elected after 2361ms
2019-06-13 12:04:03,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:03,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:03,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:03,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:03,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 12:04:03,346 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:03,346 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 12:04:03,347 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 12:04:03,347 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:03,347 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:03,347 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 12:04:03,347 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:03,347 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 12:04:03,347 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 12:04:03,347 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:03,347 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:03,347 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786: start LeaderState
2019-06-13 12:04:03,348 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:03,354 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 859621b4-b51a-492c-ad6d-3244885c0c07:group-20B8C391EFEC change Leader from null to 6cef66d5-8cd3-44aa-be07-575ef65ad786 at term 2 for appendEntries, leader elected after 2377ms
2019-06-13 12:04:03,357 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786:group-20B8C391EFEC set configuration 0: [6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525, 859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419, 8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301], old=null at 0
2019-06-13 12:04:03,372 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 8cecba00-b083-47df-9f5a-b6be1e470733:group-20B8C391EFEC change Leader from null to 6cef66d5-8cd3-44aa-be07-575ef65ad786 at term 2 for appendEntries, leader elected after 2398ms
2019-06-13 12:04:03,403 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 859621b4-b51a-492c-ad6d-3244885c0c07:group-20B8C391EFEC set configuration 0: [6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525, 859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419, 8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301], old=null at 0
2019-06-13 12:04:03,403 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 859621b4-b51a-492c-ad6d-3244885c0c07-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:03,405 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 8cecba00-b083-47df-9f5a-b6be1e470733:group-20B8C391EFEC set configuration 0: [6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525, 859621b4-b51a-492c-ad6d-3244885c0c07:192.168.46.58:43419, 8cecba00-b083-47df-9f5a-b6be1e470733:192.168.46.58:34301], old=null at 0
2019-06-13 12:04:03,405 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 8cecba00-b083-47df-9f5a-b6be1e470733-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:03,417 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 6cef66d5-8cd3-44aa-be07-575ef65ad786-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-0/data/ratis/65296e8a-15e3-4cd9-83ab-20b8c391efec/current/log_inprogress_0
2019-06-13 12:04:03,460 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 859621b4-b51a-492c-ad6d-3244885c0c07-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-2/data/ratis/65296e8a-15e3-4cd9-83ab-20b8c391efec/current/log_inprogress_0
2019-06-13 12:04:03,461 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8ED239EB40DA->40e85715-f542-4fe4-a7e5-a8202a6d8f0e: receive RaftClientReply:client-8ED239EB40DA->40e85715-f542-4fe4-a7e5-a8202a6d8f0e@group-BCE6487231AC, cid=13, FAILED org.apache.ratis.protocol.NotLeaderException: Server 40e85715-f542-4fe4-a7e5-a8202a6d8f0e is not the leader (cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721). Request must be sent to leader., logIndex=0, commits[40e85715-f542-4fe4-a7e5-a8202a6d8f0e:c0, cfa6ee40-d911-4f1c-9330-44c1c1a7e901:c0, 4385f424-31b1-428a-a0ea-2f137423452e:c0]
2019-06-13 12:04:03,463 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 8cecba00-b083-47df-9f5a-b6be1e470733-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-1/data/ratis/65296e8a-15e3-4cd9-83ab-20b8c391efec/current/log_inprogress_0
2019-06-13 12:04:03,465 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:04,638 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8ED239EB40DA->cfa6ee40-d911-4f1c-9330-44c1c1a7e901: receive RaftClientReply:client-8ED239EB40DA->cfa6ee40-d911-4f1c-9330-44c1c1a7e901@group-BCE6487231AC, cid=13, SUCCESS, logIndex=1, commits[cfa6ee40-d911-4f1c-9330-44c1c1a7e901:c2, 4385f424-31b1-428a-a0ea-2f137423452e:c0, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:c1]
2019-06-13 12:04:04,680 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8ED239EB40DA->cfa6ee40-d911-4f1c-9330-44c1c1a7e901: receive RaftClientReply:client-8ED239EB40DA->cfa6ee40-d911-4f1c-9330-44c1c1a7e901@group-BCE6487231AC, cid=14, SUCCESS, logIndex=3, commits[cfa6ee40-d911-4f1c-9330-44c1c1a7e901:c3, 4385f424-31b1-428a-a0ea-2f137423452e:c2, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:c1]
2019-06-13 12:04:04,727 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8ED239EB40DA->cfa6ee40-d911-4f1c-9330-44c1c1a7e901: receive RaftClientReply:client-8ED239EB40DA->cfa6ee40-d911-4f1c-9330-44c1c1a7e901@group-BCE6487231AC, cid=15, SUCCESS, logIndex=5, commits[cfa6ee40-d911-4f1c-9330-44c1c1a7e901:c11, 4385f424-31b1-428a-a0ea-2f137423452e:c7, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:c5]
2019-06-13 12:04:04,741 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8ED239EB40DA->cfa6ee40-d911-4f1c-9330-44c1c1a7e901: receive RaftClientReply:client-8ED239EB40DA->cfa6ee40-d911-4f1c-9330-44c1c1a7e901@group-BCE6487231AC, cid=16, SUCCESS, logIndex=6, commits[cfa6ee40-d911-4f1c-9330-44c1c1a7e901:c12, 4385f424-31b1-428a-a0ea-2f137423452e:c7, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:c8]
2019-06-13 12:04:04,746 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8ED239EB40DA->cfa6ee40-d911-4f1c-9330-44c1c1a7e901: receive RaftClientReply:client-8ED239EB40DA->cfa6ee40-d911-4f1c-9330-44c1c1a7e901@group-BCE6487231AC, cid=17, SUCCESS, logIndex=7, commits[cfa6ee40-d911-4f1c-9330-44c1c1a7e901:c12, 4385f424-31b1-428a-a0ea-2f137423452e:c8, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:c8]
2019-06-13 12:04:04,770 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8ED239EB40DA->cfa6ee40-d911-4f1c-9330-44c1c1a7e901: receive RaftClientReply:client-8ED239EB40DA->cfa6ee40-d911-4f1c-9330-44c1c1a7e901@group-BCE6487231AC, cid=18, SUCCESS, logIndex=8, commits[cfa6ee40-d911-4f1c-9330-44c1c1a7e901:c12, 4385f424-31b1-428a-a0ea-2f137423452e:c8, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:c8]
2019-06-13 12:04:04,789 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8ED239EB40DA->cfa6ee40-d911-4f1c-9330-44c1c1a7e901: receive RaftClientReply:client-8ED239EB40DA->cfa6ee40-d911-4f1c-9330-44c1c1a7e901@group-BCE6487231AC, cid=19, SUCCESS, logIndex=13, commits[cfa6ee40-d911-4f1c-9330-44c1c1a7e901:c14, 4385f424-31b1-428a-a0ea-2f137423452e:c13, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:c12]
2019-06-13 12:04:04,804 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8ED239EB40DA->cfa6ee40-d911-4f1c-9330-44c1c1a7e901: receive RaftClientReply:client-8ED239EB40DA->cfa6ee40-d911-4f1c-9330-44c1c1a7e901@group-BCE6487231AC, cid=20, SUCCESS, logIndex=15, commits[cfa6ee40-d911-4f1c-9330-44c1c1a7e901:c15, 4385f424-31b1-428a-a0ea-2f137423452e:c14, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:c14]
2019-06-13 12:04:04,838 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8ED239EB40DA->cfa6ee40-d911-4f1c-9330-44c1c1a7e901: receive RaftClientReply:client-8ED239EB40DA->cfa6ee40-d911-4f1c-9330-44c1c1a7e901@group-BCE6487231AC, cid=21, SUCCESS, logIndex=0, commits[cfa6ee40-d911-4f1c-9330-44c1c1a7e901:c16, 4385f424-31b1-428a-a0ea-2f137423452e:c15, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:c15]
2019-06-13 12:04:04,841 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:04:04,842 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@159ac15f
2019-06-13 12:04:04,842 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:04:04,843 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:04:04,844 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: close
2019-06-13 12:04:04,845 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: shutdown group-BCE6487231AC
2019-06-13 12:04:04,845 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-BCE6487231AC,id=cfa6ee40-d911-4f1c-9330-44c1c1a7e901
2019-06-13 12:04:04,845 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: shutdown LeaderState
2019-06-13 12:04:04,846 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901-PendingRequests: sendNotLeaderResponses
2019-06-13 12:04:04,849 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(cfa6ee40-d911-4f1c-9330-44c1c1a7e901 -> 40e85715-f542-4fe4-a7e5-a8202a6d8f0e): Wait interrupted by java.lang.InterruptedException
2019-06-13 12:04:04,850 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: shutdown group-186A2E842470
2019-06-13 12:04:04,850 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-186A2E842470,id=cfa6ee40-d911-4f1c-9330-44c1c1a7e901
2019-06-13 12:04:04,850 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: shutdown LeaderState
2019-06-13 12:04:04,849 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(cfa6ee40-d911-4f1c-9330-44c1c1a7e901 -> 4385f424-31b1-428a-a0ea-2f137423452e): Wait interrupted by java.lang.InterruptedException
2019-06-13 12:04:04,851 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901-PendingRequests: sendNotLeaderResponses
2019-06-13 12:04:04,853 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: appendEntries completed
2019-06-13 12:04:04,857 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 4385f424-31b1-428a-a0ea-2f137423452e: appendEntries completed
2019-06-13 12:04:04,860 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: follower cfa6ee40-d911-4f1c-9330-44c1c1a7e901->4385f424-31b1-428a-a0ea-2f137423452e(c15,m16,n17, attendVote=true, lastRpcSendTime=60, lastRpcResponseTime=56) response Completed
2019-06-13 12:04:04,860 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: follower cfa6ee40-d911-4f1c-9330-44c1c1a7e901->40e85715-f542-4fe4-a7e5-a8202a6d8f0e(c15,m16,n17, attendVote=true, lastRpcSendTime=60, lastRpcResponseTime=47) response Completed
2019-06-13 12:04:04,862 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:04:04,863 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-cfa6ee40-d911-4f1c-9330-44c1c1a7e901-group-186A2E842470: set stopIndex = 0
2019-06-13 12:04:04,863 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901:group-186A2E842470 closes. The last applied log index is 0
2019-06-13 12:04:04,863 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:15)
2019-06-13 12:04:04,863 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:04,864 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-5/data/ratis/f1780b47-6fe6-43aa-ae34-bce6487231ac/sm/snapshot.1_15
2019-06-13 12:04:04,869 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-cfa6ee40-d911-4f1c-9330-44c1c1a7e901-group-BCE6487231AC: set stopIndex = 16
2019-06-13 12:04:04,872 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901:group-BCE6487231AC closes. The last applied log index is 16
2019-06-13 12:04:04,873 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:04,875 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901->4385f424-31b1-428a-a0ea-2f137423452e: nextIndex: updateUnconditionally 17 -> 0
2019-06-13 12:04:04,878 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901->40e85715-f542-4fe4-a7e5-a8202a6d8f0e: nextIndex: updateUnconditionally 17 -> -1
2019-06-13 12:04:04,882 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901-RaftLogWorker close()
2019-06-13 12:04:04,884 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901-RaftLogWorker close()
2019-06-13 12:04:04,888 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: shutdown server with port 39721 now
2019-06-13 12:04:04,891 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 2-UnorderedRequestStreamObserver2: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:04,895 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - cfa6ee40-d911-4f1c-9330-44c1c1a7e901: shutdown server with port 39721 successfully
2019-06-13 12:04:04,907 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:04:04,917 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:04:04,920 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@70be89ec{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:04:04,924 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@2aee0704{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:04:04,924 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@527937d0{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:04:04,925 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@6b063470{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:04:04,927 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:04:04,927 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@6d69a0d3
2019-06-13 12:04:04,928 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:04:04,928 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:04:04,928 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: close
2019-06-13 12:04:04,929 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: shutdown group-D77F64A1D32A
2019-06-13 12:04:04,929 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D77F64A1D32A,id=40e85715-f542-4fe4-a7e5-a8202a6d8f0e
2019-06-13 12:04:04,929 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: shutdown LeaderState
2019-06-13 12:04:04,930 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e-PendingRequests: sendNotLeaderResponses
2019-06-13 12:04:04,934 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-40e85715-f542-4fe4-a7e5-a8202a6d8f0e-group-D77F64A1D32A: set stopIndex = 0
2019-06-13 12:04:04,934 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:04:04,934 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:group-D77F64A1D32A closes. The last applied log index is 0
2019-06-13 12:04:04,935 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:04,938 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e-RaftLogWorker close()
2019-06-13 12:04:04,942 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: shutdown group-BCE6487231AC
2019-06-13 12:04:04,942 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-BCE6487231AC,id=40e85715-f542-4fe4-a7e5-a8202a6d8f0e
2019-06-13 12:04:04,943 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: shutdown FollowerState
2019-06-13 12:04:04,943 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:15)
2019-06-13 12:04:04,943 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-116b67e6-721e-43d0-9aeb-aef0ab413853/datanode-3/data/ratis/f1780b47-6fe6-43aa-ae34-bce6487231ac/sm/snapshot.1_15
2019-06-13 12:04:04,944 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-40e85715-f542-4fe4-a7e5-a8202a6d8f0e-group-BCE6487231AC: set stopIndex = 15
2019-06-13 12:04:04,944 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:group-BCE6487231AC closes. The last applied log index is 15
2019-06-13 12:04:04,944 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:04,948 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e-RaftLogWorker close()
2019-06-13 12:04:04,950 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: shutdown server with port 38617 now
2019-06-13 12:04:04,951 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: shutdown server with port 38617 successfully
2019-06-13 12:04:04,952 INFO  impl.FollowerState (FollowerState.java:run(109)) - 40e85715-f542-4fe4-a7e5-a8202a6d8f0e: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:04:04,955 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:04:04,967 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:04:04,968 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@e91af20{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:04:04,968 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@6221b13b{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:04:04,968 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@739831a4{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:04:04,969 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@3830f918{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:04:06,001 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1198, electionTimeout:1166ms
2019-06-13 12:04:06,001 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:06,002 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2019-06-13 12:04:06,002 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:06,003 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC change Leader from cfa6ee40-d911-4f1c-9330-44c1c1a7e901 to null at term 1 for initElection
2019-06-13 12:04:06,004 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8ED239EB40DA->4385f424-31b1-428a-a0ea-2f137423452e: receive RaftClientReply:client-8ED239EB40DA->4385f424-31b1-428a-a0ea-2f137423452e@group-BCE6487231AC, cid=22, FAILED org.apache.ratis.protocol.NotLeaderException: Server 4385f424-31b1-428a-a0ea-2f137423452e is not the leader (cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721). Request must be sent to leader., logIndex=0, commits[4385f424-31b1-428a-a0ea-2f137423452e:c15, cfa6ee40-d911-4f1c-9330-44c1c1a7e901:c15, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:c13]
2019-06-13 12:04:06,007 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:06,012 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection14: begin an election at term 2 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:06,018 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection14 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:06,020 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection14 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:06,022 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection14: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t2, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:06,022 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:06,022 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:06,023 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 2 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:06,024 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:06,024 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:07,081 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1056, electionTimeout:1051ms
2019-06-13 12:04:07,082 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:07,082 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2019-06-13 12:04:07,082 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:07,088 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection15: begin an election at term 3 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:07,089 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection15 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:07,093 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection15 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:07,094 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection15: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t3, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:07,094 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:07,095 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:07,096 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 3 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:07,098 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:07,098 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:08,101 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1003, electionTimeout:1000ms
2019-06-13 12:04:08,103 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:08,103 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 3 for changeToCandidate
2019-06-13 12:04:08,103 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:08,113 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection16: begin an election at term 4 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:08,114 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection16 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:08,115 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection16 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:08,117 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection16: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t4, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:08,117 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:08,117 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:08,117 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 4 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:08,118 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:08,118 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:09,273 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1154, electionTimeout:1154ms
2019-06-13 12:04:09,274 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:09,274 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 4 for changeToCandidate
2019-06-13 12:04:09,274 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:09,280 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection17: begin an election at term 5 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:09,281 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection17 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:09,282 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection17 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:09,283 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection17: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t5, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:09,283 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:09,284 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:09,284 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 5 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:09,285 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:09,285 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:10,052 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8ED239EB40DA->4385f424-31b1-428a-a0ea-2f137423452e: receive RaftClientReply:client-8ED239EB40DA->4385f424-31b1-428a-a0ea-2f137423452e@group-BCE6487231AC, cid=22, FAILED org.apache.ratis.protocol.NotLeaderException: Server 4385f424-31b1-428a-a0ea-2f137423452e is not the leader (cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721). Request must be sent to leader., logIndex=0, commits[4385f424-31b1-428a-a0ea-2f137423452e:c15, cfa6ee40-d911-4f1c-9330-44c1c1a7e901:c15, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:c13]
2019-06-13 12:04:10,063 WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(276)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-8ED239EB40DA->4385f424-31b1-428a-a0ea-2f137423452e@group-BCE6487231AC, cid=22, seq=9*, RW, org.apache.hadoop.hdds.scm.XceiverClientRatis$$Lambda$367/1172170412@4974ce18 for 5 attempts with RetryLimited(maxAttempts=5, sleepTime=1000ms) on the pipeline Pipeline[ Id: f1780b47-6fe6-43aa-ae34-bce6487231ac, Nodes: cfa6ee40-d911-4f1c-9330-44c1c1a7e901{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}40e85715-f542-4fe4-a7e5-a8202a6d8f0e{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}4385f424-31b1-428a-a0ea-2f137423452e{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]. The last committed block length is 450, uncommitted data length is 350 retry count 0
2019-06-13 12:04:10,099 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-9C0574E221EE->8cecba00-b083-47df-9f5a-b6be1e470733: receive RaftClientReply:client-9C0574E221EE->8cecba00-b083-47df-9f5a-b6be1e470733@group-20B8C391EFEC, cid=28, FAILED org.apache.ratis.protocol.NotLeaderException: Server 8cecba00-b083-47df-9f5a-b6be1e470733 is not the leader (6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525). Request must be sent to leader., logIndex=0, commits[8cecba00-b083-47df-9f5a-b6be1e470733:c0, 6cef66d5-8cd3-44aa-be07-575ef65ad786:c0, 859621b4-b51a-492c-ad6d-3244885c0c07:c0]
2019-06-13 12:04:10,109 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:10,406 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1121, electionTimeout:1120ms
2019-06-13 12:04:10,408 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:10,408 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 5 for changeToCandidate
2019-06-13 12:04:10,409 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:10,414 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection18: begin an election at term 6 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:10,414 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection18 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:10,416 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection18 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:10,417 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection18: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t6, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:10,417 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:10,417 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:10,417 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 6 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:10,418 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:10,418 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:11,119 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-9C0574E221EE->859621b4-b51a-492c-ad6d-3244885c0c07: receive RaftClientReply:client-9C0574E221EE->859621b4-b51a-492c-ad6d-3244885c0c07@group-20B8C391EFEC, cid=28, FAILED org.apache.ratis.protocol.NotLeaderException: Server 859621b4-b51a-492c-ad6d-3244885c0c07 is not the leader (6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525). Request must be sent to leader., logIndex=0, commits[859621b4-b51a-492c-ad6d-3244885c0c07:c0, 6cef66d5-8cd3-44aa-be07-575ef65ad786:c0, 8cecba00-b083-47df-9f5a-b6be1e470733:c0]
2019-06-13 12:04:11,123 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:11,497 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1079, electionTimeout:1079ms
2019-06-13 12:04:11,501 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:11,501 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 6 for changeToCandidate
2019-06-13 12:04:11,501 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:11,520 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection19: begin an election at term 7 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:11,521 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection19 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:11,523 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection19 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:11,524 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection19: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t7, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:11,524 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:11,524 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:11,525 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 7 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:11,525 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:11,525 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:12,131 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-9C0574E221EE->8cecba00-b083-47df-9f5a-b6be1e470733: receive RaftClientReply:client-9C0574E221EE->8cecba00-b083-47df-9f5a-b6be1e470733@group-20B8C391EFEC, cid=28, FAILED org.apache.ratis.protocol.NotLeaderException: Server 8cecba00-b083-47df-9f5a-b6be1e470733 is not the leader (6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525). Request must be sent to leader., logIndex=0, commits[8cecba00-b083-47df-9f5a-b6be1e470733:c0, 6cef66d5-8cd3-44aa-be07-575ef65ad786:c0, 859621b4-b51a-492c-ad6d-3244885c0c07:c0]
2019-06-13 12:04:12,134 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:12,583 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1058, electionTimeout:1058ms
2019-06-13 12:04:12,585 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:12,585 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 7 for changeToCandidate
2019-06-13 12:04:12,585 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:12,600 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection20: begin an election at term 8 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:12,601 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection20 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:12,602 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection20 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:12,604 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection20: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t8, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:12,604 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:12,604 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:12,604 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 8 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:12,604 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:12,604 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:13,144 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-9C0574E221EE->859621b4-b51a-492c-ad6d-3244885c0c07: receive RaftClientReply:client-9C0574E221EE->859621b4-b51a-492c-ad6d-3244885c0c07@group-20B8C391EFEC, cid=28, FAILED org.apache.ratis.protocol.NotLeaderException: Server 859621b4-b51a-492c-ad6d-3244885c0c07 is not the leader (6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525). Request must be sent to leader., logIndex=0, commits[859621b4-b51a-492c-ad6d-3244885c0c07:c0, 6cef66d5-8cd3-44aa-be07-575ef65ad786:c0, 8cecba00-b083-47df-9f5a-b6be1e470733:c0]
2019-06-13 12:04:13,146 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:13,702 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1097, electionTimeout:1097ms
2019-06-13 12:04:13,703 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:13,703 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 8 for changeToCandidate
2019-06-13 12:04:13,703 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:13,740 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection21: begin an election at term 9 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:13,741 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection21 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:13,743 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection21 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:13,744 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection21: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t9, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:13,744 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:13,744 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:13,745 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 9 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:13,745 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:13,745 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:14,156 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-9C0574E221EE->8cecba00-b083-47df-9f5a-b6be1e470733: receive RaftClientReply:client-9C0574E221EE->8cecba00-b083-47df-9f5a-b6be1e470733@group-20B8C391EFEC, cid=28, FAILED org.apache.ratis.protocol.NotLeaderException: Server 8cecba00-b083-47df-9f5a-b6be1e470733 is not the leader (6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525). Request must be sent to leader., logIndex=0, commits[8cecba00-b083-47df-9f5a-b6be1e470733:c0, 6cef66d5-8cd3-44aa-be07-575ef65ad786:c0, 859621b4-b51a-492c-ad6d-3244885c0c07:c0]
2019-06-13 12:04:14,160 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 2-OrderedRequestStreamObserver2: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:14,769 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1024, electionTimeout:1024ms
2019-06-13 12:04:14,771 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:14,771 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 9 for changeToCandidate
2019-06-13 12:04:14,771 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:14,803 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection22: begin an election at term 10 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:14,804 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection22 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:14,805 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection22 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:14,807 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection22: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t10, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:14,807 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:14,807 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:14,807 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 10 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:14,807 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:14,807 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:15,179 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-9C0574E221EE->859621b4-b51a-492c-ad6d-3244885c0c07: receive RaftClientReply:client-9C0574E221EE->859621b4-b51a-492c-ad6d-3244885c0c07@group-20B8C391EFEC, cid=28, FAILED org.apache.ratis.protocol.NotLeaderException: Server 859621b4-b51a-492c-ad6d-3244885c0c07 is not the leader (6cef66d5-8cd3-44aa-be07-575ef65ad786:192.168.46.58:41525). Request must be sent to leader., logIndex=0, commits[859621b4-b51a-492c-ad6d-3244885c0c07:c0, 6cef66d5-8cd3-44aa-be07-575ef65ad786:c0, 8cecba00-b083-47df-9f5a-b6be1e470733:c0]
2019-06-13 12:04:15,185 WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(276)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-9C0574E221EE->859621b4-b51a-492c-ad6d-3244885c0c07@group-20B8C391EFEC, cid=28, seq=1*, RW, org.apache.hadoop.hdds.scm.XceiverClientRatis$$Lambda$367/1172170412@3953d729 for 5 attempts with RetryLimited(maxAttempts=5, sleepTime=1000ms) on the pipeline Pipeline[ Id: 65296e8a-15e3-4cd9-83ab-20b8c391efec, Nodes: 8cecba00-b083-47df-9f5a-b6be1e470733{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}6cef66d5-8cd3-44aa-be07-575ef65ad786{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}859621b4-b51a-492c-ad6d-3244885c0c07{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]. The last committed block length is 0, uncommitted data length is 400 retry count 0
2019-06-13 12:04:15,188 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 2-OrderedRequestStreamObserver2: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:15,196 WARN  block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(192)) - Pipeline creation failed for type:RATIS factor:THREE. Retrying get pipelines call once.
org.apache.hadoop.hdds.scm.pipeline.InsufficientDatanodesException: Cannot create pipeline of factor 3 using 1 nodes.
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:151)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:57)
	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.createPipeline(SCMPipelineManager.java:149)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:190)
	at org.apache.hadoop.hdds.scm.server.SCMBlockProtocolServer.allocateBlock(SCMBlockProtocolServer.java:172)
	at org.apache.hadoop.ozone.protocolPB.ScmBlockLocationProtocolServerSideTranslatorPB.allocateScmBlock(ScmBlockLocationProtocolServerSideTranslatorPB.java:82)
	at org.apache.hadoop.hdds.protocol.proto.ScmBlockLocationProtocolProtos$ScmBlockLocationProtocolService$2.callBlockingMethod(ScmBlockLocationProtocolProtos.java:7533)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:524)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1025)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:876)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:822)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1730)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2682)
2019-06-13 12:04:15,200 INFO  block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(198)) - Could not find available pipeline of type:RATIS and factor:THREE even after retrying
2019-06-13 12:04:15,200 ERROR block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(222)) - Unable to allocate a block for the size: 800, type: RATIS, factor: THREE
12:04:15.202 [IPC Server handler 0 on 45805] ERROR OMAudit - user=root | ip=127.0.0.1 | op=ALLOCATE_BLOCK {volume=watchforcommithandlingtest, bucket=watchforcommithandlingtest, key=d22d372c-e681-46f3-8c97-4145737cd270, dataSize=0, replicationType=null, replicationFactor=null, keyLocationInfo=null, clientID=102264172841664512} | ret=FAILURE
java.io.IOException: Allocate block failed.
	at org.apache.hadoop.hdds.scm.protocolPB.ScmBlockLocationProtocolClientSideTranslatorPB.allocateBlock(ScmBlockLocationProtocolClientSideTranslatorPB.java:111) ~[hadoop-hdds-common-0.5.0-SNAPSHOT.jar:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_212]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_212]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_212]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_212]
	at org.apache.hadoop.hdds.tracing.TraceAllMethod.invoke(TraceAllMethod.java:66) ~[hadoop-hdds-common-0.5.0-SNAPSHOT.jar:?]
	at com.sun.proxy.$Proxy25.allocateBlock(Unknown Source) ~[?:?]
	at org.apache.hadoop.ozone.om.KeyManagerImpl.allocateBlock(KeyManagerImpl.java:347) ~[hadoop-ozone-ozone-manager-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.om.KeyManagerImpl.allocateBlock(KeyManagerImpl.java:315) ~[hadoop-ozone-ozone-manager-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.om.OzoneManager.allocateBlock(OzoneManager.java:2301) [hadoop-ozone-ozone-manager-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.protocolPB.OzoneManagerRequestHandler.allocateBlock(OzoneManagerRequestHandler.java:755) [hadoop-ozone-ozone-manager-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.protocolPB.OzoneManagerRequestHandler.handle(OzoneManagerRequestHandler.java:249) [hadoop-ozone-ozone-manager-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.protocolPB.OzoneManagerProtocolServerSideTranslatorPB.submitRequestDirectlyToOM(OzoneManagerProtocolServerSideTranslatorPB.java:180) [hadoop-ozone-ozone-manager-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.protocolPB.OzoneManagerProtocolServerSideTranslatorPB.submitRequest(OzoneManagerProtocolServerSideTranslatorPB.java:102) [hadoop-ozone-ozone-manager-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.protocol.proto.OzoneManagerProtocolProtos$OzoneManagerService$2.callBlockingMethod(OzoneManagerProtocolProtos.java) [hadoop-ozone-common-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:524) [hadoop-common-3.2.0.jar:?]
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1025) [hadoop-common-3.2.0.jar:?]
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:876) [hadoop-common-3.2.0.jar:?]
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:822) [hadoop-common-3.2.0.jar:?]
	at java.security.AccessController.doPrivileged(Native Method) [?:1.8.0_212]
	at javax.security.auth.Subject.doAs(Subject.java:422) [?:1.8.0_212]
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1730) [hadoop-common-3.2.0.jar:?]
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2682) [hadoop-common-3.2.0.jar:?]
2019-06-13 12:04:15,212 ERROR io.BlockOutputStreamEntryPool (BlockOutputStreamEntryPool.java:allocateBlockIfNeeded(299)) - Try to allocate more blocks for write failed, already allocated 0 blocks for this write.
INTERNAL_ERROR org.apache.hadoop.ozone.om.exceptions.OMException: Allocate block failed.
	at org.apache.hadoop.ozone.om.protocolPB.OzoneManagerProtocolClientSideTranslatorPB.handleError(OzoneManagerProtocolClientSideTranslatorPB.java:720)
	at org.apache.hadoop.ozone.om.protocolPB.OzoneManagerProtocolClientSideTranslatorPB.allocateBlock(OzoneManagerProtocolClientSideTranslatorPB.java:743)
	at org.apache.hadoop.ozone.client.io.BlockOutputStreamEntryPool.allocateNewBlock(BlockOutputStreamEntryPool.java:248)
	at org.apache.hadoop.ozone.client.io.BlockOutputStreamEntryPool.allocateBlockIfNeeded(BlockOutputStreamEntryPool.java:296)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleWrite(KeyOutputStream.java:201)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleRetry(KeyOutputStream.java:376)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleException(KeyOutputStream.java:325)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleWrite(KeyOutputStream.java:231)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.write(KeyOutputStream.java:193)
	at org.apache.hadoop.ozone.client.io.OzoneOutputStream.write(OzoneOutputStream.java:49)
	at java.io.OutputStream.write(OutputStream.java:75)
	at org.apache.hadoop.ozone.client.rpc.TestWatchForCommit.testWatchForCommitWithKeyWrite(TestWatchForCommit.java:241)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2019-06-13 12:04:15,233 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:15,242 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:15,242 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:15,242 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedBlocks
2019-06-13 12:04:15,242 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedBlocks
2019-06-13 12:04:15,243 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: validCerts
2019-06-13 12:04:15,243 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:validCerts
2019-06-13 12:04:15,243 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: revokedCerts
2019-06-13 12:04:15,243 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:revokedCerts
2019-06-13 12:04:15,243 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-13 12:04:15,243 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-13 12:04:15,243 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-13 12:04:15,288 WARN  server.ServerUtils (ServerUtils.java:sanitizeUserArgs(70)) - ozone.scm.stale.node.interval value = 300000 is larger than max = 100000 based on the key value of ozone.scm.heartbeat.thread.interval, reset to the max value 100000.
2019-06-13 12:04:15,289 WARN  server.ServerUtils (ServerUtils.java:sanitizeUserArgs(70)) - ozone.scm.stale.node.interval value = 300000 is larger than max = 100000 based on the key value of ozone.scm.heartbeat.thread.interval, reset to the max value 100000.
2019-06-13 12:04:15,289 INFO  node.SCMNodeManager (SCMNodeManager.java:<init>(108)) - Entering startup safe mode.
2019-06-13 12:04:15,290 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(125)) - Loading file from sun.misc.CompoundEnumeration@45e7bb79
2019-06-13 12:04:15,290 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(171)) - Loading network topology layer schema file
2019-06-13 12:04:15,293 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:15,308 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:initializePipelineState(126)) - No pipeline exists in current db
2019-06-13 12:04:15,308 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:15,328 WARN  events.EventQueue (EventQueue.java:fireEvent(175)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='SafeModeStatus'}
2019-06-13 12:04:15,329 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-13 12:04:15,330 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 41225
2019-06-13 12:04:15,335 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-13 12:04:15,335 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 43731
2019-06-13 12:04:15,338 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-13 12:04:15,338 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 38343
2019-06-13 12:04:15,342 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for scm at: http://0.0.0.0:0
2019-06-13 12:04:15,343 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:15,344 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:15,345 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:15,348 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context scm
2019-06-13 12:04:15,348 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:15,348 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:15,354 INFO  server.StorageContainerManager (StorageContainerManager.java:start(752)) - StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:38343
2019-06-13 12:04:15,354 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - StorageContainerManager metrics system started (again)
2019-06-13 12:04:15,357 INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:start(149)) - RPC server for Client  is listening at /0.0.0.0:38343
2019-06-13 12:04:15,445 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 38343: starting
2019-06-13 12:04:15,445 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-13 12:04:15,490 INFO  server.StorageContainerManager (StorageContainerManager.java:start(761)) - ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:43731
2019-06-13 12:04:15,490 INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:start(137)) - RPC server for Block Protocol is listening at /0.0.0.0:43731
2019-06-13 12:04:15,501 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-13 12:04:15,517 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 43731: starting
2019-06-13 12:04:15,538 INFO  server.StorageContainerManager (StorageContainerManager.java:start(765)) - ScmDatanodeProtocl RPC server is listening at /0.0.0.0:41225
2019-06-13 12:04:15,538 INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:start(191)) - RPC server for DataNodes is listening at /0.0.0.0:41225
2019-06-13 12:04:15,538 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-13 12:04:15,539 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 41225: starting
2019-06-13 12:04:15,562 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 42185
2019-06-13 12:04:15,562 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:04:15,564 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@3b39e79b{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:04:15,565 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@2f86f9cf{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-13 12:04:15,568 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@3be80ece{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/scm/,AVAILABLE}{/scm}
2019-06-13 12:04:15,570 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@60a01cb{HTTP/1.1,[http/1.1]}{0.0.0.0:42185}
2019-06-13 12:04:15,571 INFO  server.Server (Server.java:doStart(419)) - Started @24791ms
2019-06-13 12:04:15,571 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of SCM is listening at http://0.0.0.0:42185
2019-06-13 12:04:15,579 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:15,580 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:04:15,593 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:15,594 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(519)) - OM Service ID is not set. Setting it to the default ID: omServiceIdDefault
2019-06-13 12:04:15,594 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(525)) - OM Node ID is not set. Setting it to the OmStorage's OmID: 6a5f751e-2a95-429b-befd-c2ee87db9fd0
2019-06-13 12:04:15,594 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 12:04:15,594 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 12:04:15,595 INFO  om.OzoneManager (OzoneManager.java:loadOMHAConfigs(476)) - Found matching OM address with OMServiceId: null, OMNodeId: null, RPC Address: localhost:0 and Ratis port: 9872
2019-06-13 12:04:15,601 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:15,602 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: userTable
2019-06-13 12:04:15,602 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:userTable
2019-06-13 12:04:15,602 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: volumeTable
2019-06-13 12:04:15,602 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:volumeTable
2019-06-13 12:04:15,602 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: bucketTable
2019-06-13 12:04:15,602 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:bucketTable
2019-06-13 12:04:15,602 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: keyTable
2019-06-13 12:04:15,602 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:keyTable
2019-06-13 12:04:15,603 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedTable
2019-06-13 12:04:15,603 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedTable
2019-06-13 12:04:15,603 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: openKeyTable
2019-06-13 12:04:15,603 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:openKeyTable
2019-06-13 12:04:15,603 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3Table
2019-06-13 12:04:15,604 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3Table
2019-06-13 12:04:15,604 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: multipartInfoTable
2019-06-13 12:04:15,604 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:multipartInfoTable
2019-06-13 12:04:15,604 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: dTokenTable
2019-06-13 12:04:15,604 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:dTokenTable
2019-06-13 12:04:15,604 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3SecretTable
2019-06-13 12:04:15,604 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3SecretTable
2019-06-13 12:04:15,605 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: prefixTable
2019-06-13 12:04:15,605 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:prefixTable
2019-06-13 12:04:15,605 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-13 12:04:15,605 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-13 12:04:15,605 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-13 12:04:15,764 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-13 12:04:15,765 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 41479
2019-06-13 12:04:15,780 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:15,781 INFO  om.OzoneManager (OzoneManager.java:start(1217)) - OzoneManager RPC server is listening at localhost/127.0.0.1:41479
2019-06-13 12:04:15,781 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - OzoneManager metrics system started (again)
2019-06-13 12:04:15,785 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 41479: starting
2019-06-13 12:04:15,785 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-13 12:04:15,839 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for ozoneManager at: http://0.0.0.0:0
2019-06-13 12:04:15,840 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:15,841 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:15,842 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:15,842 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context ozoneManager
2019-06-13 12:04:15,842 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:15,842 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:15,843 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 46103
2019-06-13 12:04:15,843 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:04:15,850 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@6e9a10cd{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:04:15,851 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@59b447a4{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-13 12:04:15,854 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@27dbaa33{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/ozoneManager/,AVAILABLE}{/ozoneManager}
2019-06-13 12:04:15,859 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@15d65fcf{HTTP/1.1,[http/1.1]}{0.0.0.0:46103}
2019-06-13 12:04:15,859 INFO  server.Server (Server.java:doStart(419)) - Started @25080ms
2019-06-13 12:04:15,859 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of OZONEMANAGER is listening at http://0.0.0.0:46103
2019-06-13 12:04:15,872 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:04:15,872 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:04:15,885 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-0/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:04:15,885 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-0/data/containers/hdds to VolumeSet
2019-06-13 12:04:15,885 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@16e195cf
2019-06-13 12:04:15,890 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@16e195cf
2019-06-13 12:04:15,903 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 32871
2019-06-13 12:04:15,905 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:04:15,905 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 32871 (custom)
2019-06-13 12:04:15,905 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:04:15,906 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:15,906 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:04:15,906 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:15,906 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-0/data/ratis] (custom)
2019-06-13 12:04:15,906 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 44779
2019-06-13 12:04:15,907 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:04:15,908 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:04:15,908 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:15,909 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:15,910 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:15,910 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:04:15,910 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:15,910 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:15,911 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 38679
2019-06-13 12:04:15,911 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:04:15,914 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@67b5e613{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:04:15,915 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@3095d401{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:04:15,915 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1107, electionTimeout:1107ms
2019-06-13 12:04:15,915 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:15,916 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 10 for changeToCandidate
2019-06-13 12:04:15,916 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:15,933 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection23: begin an election at term 11 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:15,943 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection23 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:15,950 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection23 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:15,962 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection23: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t11, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:15,962 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:15,962 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:15,963 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 11 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:15,963 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:15,963 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:15,968 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@7cca31fc{/,file:///tmp/jetty-0.0.0.0-38679-hddsDatanode-_-any-6375337788161097186.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:04:15,970 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@619c3546{HTTP/1.1,[http/1.1]}{0.0.0.0:38679}
2019-06-13 12:04:15,970 INFO  server.Server (Server.java:doStart(419)) - Started @25191ms
2019-06-13 12:04:15,971 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:38679
Jun 13, 2019 12:04:15 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:04:16,110 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@2bf3ec4
2019-06-13 12:04:16,110 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:04:16,113 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:04:16,134 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-0/meta/datanode.id
2019-06-13 12:04:16,139 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:04:16,140 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-1/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:04:16,140 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-1/data/containers/hdds to VolumeSet
2019-06-13 12:04:16,140 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@625264ed
2019-06-13 12:04:16,146 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@625264ed
2019-06-13 12:04:16,167 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 37471
2019-06-13 12:04:16,167 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:04:16,168 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 37471 (custom)
2019-06-13 12:04:16,168 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:04:16,168 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:16,168 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:04:16,168 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:16,169 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-1/data/ratis] (custom)
2019-06-13 12:04:16,169 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 44443
2019-06-13 12:04:16,169 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:04:16,170 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:04:16,171 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:16,173 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:16,174 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:16,174 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:04:16,174 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:16,174 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:16,175 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 35571
2019-06-13 12:04:16,175 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:04:16,192 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@640a8f93{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:04:16,193 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@74ce7fdf{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:04:16,222 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@1aac0a47{/,file:///tmp/jetty-0.0.0.0-35571-hddsDatanode-_-any-131467924443855610.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:04:16,223 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@190cacaa{HTTP/1.1,[http/1.1]}{0.0.0.0:35571}
2019-06-13 12:04:16,223 INFO  server.Server (Server.java:doStart(419)) - Started @25444ms
2019-06-13 12:04:16,224 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:35571
Jun 13, 2019 12:04:16 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:04:16,367 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@3b65084e
2019-06-13 12:04:16,368 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:04:16,372 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:04:16,383 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:04:16,384 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-1/meta/datanode.id
2019-06-13 12:04:16,405 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-2/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:04:16,406 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-2/data/containers/hdds to VolumeSet
2019-06-13 12:04:16,406 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@5db9f51f
2019-06-13 12:04:16,409 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@5db9f51f
2019-06-13 12:04:16,420 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 40321
2019-06-13 12:04:16,421 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:04:16,421 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 40321 (custom)
2019-06-13 12:04:16,421 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:04:16,421 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:16,422 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:04:16,422 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:16,422 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-2/data/ratis] (custom)
2019-06-13 12:04:16,422 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 40955
2019-06-13 12:04:16,423 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:04:16,424 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:04:16,424 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:16,425 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:16,426 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:16,427 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:04:16,427 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:16,427 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:16,427 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 46759
2019-06-13 12:04:16,427 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:04:16,442 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@1a7d0c9f{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:04:16,443 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@11bdab37{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:04:16,474 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@56f9de3b{/,file:///tmp/jetty-0.0.0.0-46759-hddsDatanode-_-any-1810057697341283972.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:04:16,479 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@6728370a{HTTP/1.1,[http/1.1]}{0.0.0.0:46759}
2019-06-13 12:04:16,479 INFO  server.Server (Server.java:doStart(419)) - Started @25700ms
2019-06-13 12:04:16,481 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:46759
Jun 13, 2019 12:04:16 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:04:16,611 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@1cc93da4
2019-06-13 12:04:16,611 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:04:16,612 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:04:16,632 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:04:16,634 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-2/meta/datanode.id
2019-06-13 12:04:16,634 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-3/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:04:16,634 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-3/data/containers/hdds to VolumeSet
2019-06-13 12:04:16,635 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@69a90b81
2019-06-13 12:04:16,637 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@69a90b81
2019-06-13 12:04:16,653 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 39979
2019-06-13 12:04:16,655 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:04:16,655 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 39979 (custom)
2019-06-13 12:04:16,656 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:04:16,656 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:16,656 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:04:16,656 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:16,657 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-3/data/ratis] (custom)
2019-06-13 12:04:16,657 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 34725
2019-06-13 12:04:16,658 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:04:16,659 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:04:16,660 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:16,660 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:16,661 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:16,662 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:04:16,662 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:16,662 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:16,663 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 44231
2019-06-13 12:04:16,663 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:04:16,674 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@2e40fdbd{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:04:16,675 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@19647566{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:04:16,705 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@3ea84e01{/,file:///tmp/jetty-0.0.0.0-44231-hddsDatanode-_-any-4896940671363091407.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:04:16,708 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@6eb3f4c2{HTTP/1.1,[http/1.1]}{0.0.0.0:44231}
2019-06-13 12:04:16,709 INFO  server.Server (Server.java:doStart(419)) - Started @25929ms
2019-06-13 12:04:16,709 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:44231
Jun 13, 2019 12:04:16 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:04:16,872 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@160c7c42
2019-06-13 12:04:16,872 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:04:16,875 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:04:16,885 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:04:16,886 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-3/meta/datanode.id
2019-06-13 12:04:16,891 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-4/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:04:16,892 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-4/data/containers/hdds to VolumeSet
2019-06-13 12:04:16,892 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@7827d7b
2019-06-13 12:04:16,894 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@7827d7b
2019-06-13 12:04:16,909 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 32845
2019-06-13 12:04:16,910 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:04:16,911 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 32845 (custom)
2019-06-13 12:04:16,911 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:04:16,911 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:16,911 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:04:16,912 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:16,912 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-4/data/ratis] (custom)
2019-06-13 12:04:16,912 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 33219
2019-06-13 12:04:16,913 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:04:16,915 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:04:16,916 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:16,916 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:16,917 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:16,918 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:04:16,918 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:16,918 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:16,918 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 32901
2019-06-13 12:04:16,919 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:04:16,926 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@69c33ea2{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:04:16,927 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@2e3900dc{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:04:16,950 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@40c28b0d{/,file:///tmp/jetty-0.0.0.0-32901-hddsDatanode-_-any-4954316776394316109.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:04:16,950 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@cf984d9{HTTP/1.1,[http/1.1]}{0.0.0.0:32901}
2019-06-13 12:04:16,950 INFO  server.Server (Server.java:doStart(419)) - Started @26171ms
2019-06-13 12:04:16,952 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:32901
Jun 13, 2019 12:04:16 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:04:17,047 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@2444c3df
2019-06-13 12:04:17,049 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:04:17,052 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:04:17,069 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-5/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:04:17,070 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-5/data/containers/hdds to VolumeSet
2019-06-13 12:04:17,070 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@38826984
2019-06-13 12:04:17,073 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:04:17,079 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@38826984
2019-06-13 12:04:17,081 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-4/meta/datanode.id
2019-06-13 12:04:17,093 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 44637
2019-06-13 12:04:17,094 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:04:17,094 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 44637 (custom)
2019-06-13 12:04:17,095 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:04:17,095 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:17,095 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:04:17,095 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:17,095 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-5/data/ratis] (custom)
2019-06-13 12:04:17,096 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 38153
2019-06-13 12:04:17,096 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:04:17,097 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:04:17,098 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:17,101 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:17,102 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:17,104 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:04:17,104 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:17,104 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:17,105 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 34747
2019-06-13 12:04:17,105 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:04:17,126 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@3f1d6a13{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:04:17,128 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@55c46ec1{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:04:17,148 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@1a66be41{/,file:///tmp/jetty-0.0.0.0-34747-hddsDatanode-_-any-3344629910818636974.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:04:17,150 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@7f70e244{HTTP/1.1,[http/1.1]}{0.0.0.0:34747}
2019-06-13 12:04:17,150 INFO  server.Server (Server.java:doStart(419)) - Started @26371ms
2019-06-13 12:04:17,151 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:34747
2019-06-13 12:04:17,154 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1190, electionTimeout:1188ms
2019-06-13 12:04:17,154 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:17,154 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 11 for changeToCandidate
2019-06-13 12:04:17,154 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
Jun 13, 2019 12:04:17 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:04:17,191 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection24: begin an election at term 12 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:17,192 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection24 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:17,196 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection24 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:17,197 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection24: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t12, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:17,197 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:17,198 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:17,198 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 12 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:17,198 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:17,198 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:17,274 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@c1a74d
2019-06-13 12:04:17,276 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:04:17,277 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:04:17,278 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:04:17,282 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-5/meta/datanode.id
2019-06-13 12:04:17,285 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-6/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:04:17,285 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-6/data/containers/hdds to VolumeSet
2019-06-13 12:04:17,285 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@33891646
2019-06-13 12:04:17,289 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@33891646
2019-06-13 12:04:17,303 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 46407
2019-06-13 12:04:17,305 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:04:17,305 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 46407 (custom)
2019-06-13 12:04:17,306 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:04:17,306 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:17,306 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:04:17,306 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:17,307 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-6/data/ratis] (custom)
2019-06-13 12:04:17,307 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 33631
2019-06-13 12:04:17,308 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:04:17,309 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:04:17,310 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:17,310 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:17,311 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:17,311 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:04:17,311 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:17,311 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:17,312 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 37509
2019-06-13 12:04:17,312 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:04:17,326 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@2474df51{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:04:17,326 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@5fb514c2{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:04:17,357 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@18692e80{/,file:///tmp/jetty-0.0.0.0-37509-hddsDatanode-_-any-7837754419288236494.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:04:17,358 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@779b4f9c{HTTP/1.1,[http/1.1]}{0.0.0.0:37509}
2019-06-13 12:04:17,360 INFO  server.Server (Server.java:doStart(419)) - Started @26580ms
2019-06-13 12:04:17,360 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:37509
Jun 13, 2019 12:04:17 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:04:17,452 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@29b5e7db
2019-06-13 12:04:17,453 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 7 DN Heartbeats.
2019-06-13 12:04:17,456 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:04:17,457 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-6/meta/datanode.id
2019-06-13 12:04:18,176 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:04:18,178 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:04:18,179 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 2682a03f-c762-403c-bf4d-e604d8794fd4 at port 32871
2019-06-13 12:04:18,218 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: start RPC server
2019-06-13 12:04:18,219 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: GrpcService started, listening on 0.0.0.0/0.0.0.0:32871
2019-06-13 12:04:18,264 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1066, electionTimeout:1066ms
2019-06-13 12:04:18,264 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:18,265 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 12 for changeToCandidate
2019-06-13 12:04:18,265 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:18,269 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection25: begin an election at term 13 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:18,270 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection25 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:18,272 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection25 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:18,276 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection25: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t13, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:18,276 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:18,276 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:18,276 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 13 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:18,277 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:18,277 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:18,389 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:04:18,397 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:04:18,397 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 8db082f8-c15c-4f53-9c89-7e502012b11b at port 37471
2019-06-13 12:04:18,443 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: start RPC server
2019-06-13 12:04:18,443 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: GrpcService started, listening on 0.0.0.0/0.0.0.0:37471
2019-06-13 12:04:18,456 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 7 DN Heartbeats.
2019-06-13 12:04:18,630 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:04:18,630 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:04:18,630 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 0d7c7125-8653-4c54-8389-e7d3e894c6b9 at port 40321
2019-06-13 12:04:18,634 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: start RPC server
2019-06-13 12:04:18,635 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: GrpcService started, listening on 0.0.0.0/0.0.0.0:40321
2019-06-13 12:04:18,889 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:04:18,889 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:04:18,889 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 997cd3e4-2dc3-465f-9ba2-a60765f1809f at port 39979
2019-06-13 12:04:18,900 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: start RPC server
2019-06-13 12:04:18,903 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: GrpcService started, listening on 0.0.0.0/0.0.0.0:39979
2019-06-13 12:04:19,077 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:04:19,077 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:04:19,077 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 4ecadeec-2c92-46ff-b057-42e40bec0a7d at port 32845
2019-06-13 12:04:19,107 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: start RPC server
2019-06-13 12:04:19,108 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: GrpcService started, listening on 0.0.0.0/0.0.0.0:32845
2019-06-13 12:04:19,281 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:04:19,281 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:04:19,281 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis d35b2b35-132a-43df-be94-eee7b24b01a8 at port 44637
2019-06-13 12:04:19,315 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - d35b2b35-132a-43df-be94-eee7b24b01a8: start RPC server
2019-06-13 12:04:19,318 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - d35b2b35-132a-43df-be94-eee7b24b01a8: GrpcService started, listening on 0.0.0.0/0.0.0.0:44637
2019-06-13 12:04:19,357 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1080, electionTimeout:1080ms
2019-06-13 12:04:19,357 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:19,357 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 13 for changeToCandidate
2019-06-13 12:04:19,357 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:19,362 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection26: begin an election at term 14 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:19,362 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection26 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:19,364 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection26 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:19,366 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection26: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t14, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:19,366 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:19,366 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:19,367 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 14 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:19,367 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:19,367 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:19,456 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 7 DN Heartbeats.
2019-06-13 12:04:19,462 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:04:19,462 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:04:19,462 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis dff10fa6-63b0-417b-b8d5-289bb576cc54 at port 46407
2019-06-13 12:04:19,472 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - dff10fa6-63b0-417b-b8d5-289bb576cc54: start RPC server
2019-06-13 12:04:19,473 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - dff10fa6-63b0-417b-b8d5-289bb576cc54: GrpcService started, listening on 0.0.0.0/0.0.0.0:46407
2019-06-13 12:04:20,138 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 2682a03f-c762-403c-bf4d-e604d8794fd4{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:04:20,145 INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 1 DataNodes registered, 1 required.
2019-06-13 12:04:20,161 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(177)) - ScmSafeModeManager, all rules are successfully validated
2019-06-13 12:04:20,161 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:exitSafeMode(193)) - SCM exiting safe mode.
2019-06-13 12:04:20,181 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: addNew group-1A98D85D1B92:[2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871] returns group-1A98D85D1B92:java.util.concurrent.CompletableFuture@5327bf52[Not completed]
2019-06-13 12:04:20,182 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: new RaftServerImpl for group-1A98D85D1B92:[2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871] with ContainerStateMachine:uninitialized
2019-06-13 12:04:20,182 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:20,182 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:20,183 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:20,183 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:20,183 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 2682a03f-c762-403c-bf4d-e604d8794fd4:group-1A98D85D1B92 ConfigurationManager, init=-1: [2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:20,183 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-0/data/ratis] (custom)
2019-06-13 12:04:20,183 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-0/data/ratis/986e8245-e738-43f5-9c54-1a98d85d1b92 does not exist. Creating ...
2019-06-13 12:04:20,239 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-0/data/ratis/986e8245-e738-43f5-9c54-1a98d85d1b92/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:20,249 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-0/data/ratis/986e8245-e738-43f5-9c54-1a98d85d1b92 has been successfully formatted.
2019-06-13 12:04:20,249 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:20,250 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:20,250 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:20,250 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:20,250 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:20,250 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:20,250 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 2682a03f-c762-403c-bf4d-e604d8794fd4-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-0/data/ratis/986e8245-e738-43f5-9c54-1a98d85d1b92
2019-06-13 12:04:20,250 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:20,250 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:20,250 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:20,250 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:20,250 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:20,251 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:20,251 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:20,251 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:20,251 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:20,251 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:20,251 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:20,251 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:20,252 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:20,252 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: start group-1A98D85D1B92
2019-06-13 12:04:20,252 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2682a03f-c762-403c-bf4d-e604d8794fd4:group-1A98D85D1B92 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:20,252 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: start FollowerState
2019-06-13 12:04:20,253 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-1A98D85D1B92,id=2682a03f-c762-403c-bf4d-e604d8794fd4
2019-06-13 12:04:20,256 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 986e8245-e738-43f5-9c54-1a98d85d1b92, Nodes: 2682a03f-c762-403c-bf4d-e604d8794fd4{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:04:20,384 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 8db082f8-c15c-4f53-9c89-7e502012b11b{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:04:20,397 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: addNew group-8B8B0F1A87B1:[8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471] returns group-8B8B0F1A87B1:java.util.concurrent.CompletableFuture@6450920b[Not completed]
2019-06-13 12:04:20,397 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: new RaftServerImpl for group-8B8B0F1A87B1:[8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471] with ContainerStateMachine:uninitialized
2019-06-13 12:04:20,398 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:20,398 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:20,398 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:20,399 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:20,399 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 8db082f8-c15c-4f53-9c89-7e502012b11b:group-8B8B0F1A87B1 ConfigurationManager, init=-1: [8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:20,399 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-1/data/ratis] (custom)
2019-06-13 12:04:20,399 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-1/data/ratis/99f7df9d-a087-4276-b03e-8b8b0f1a87b1 does not exist. Creating ...
2019-06-13 12:04:20,406 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-1/data/ratis/99f7df9d-a087-4276-b03e-8b8b0f1a87b1/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:20,423 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-1/data/ratis/99f7df9d-a087-4276-b03e-8b8b0f1a87b1 has been successfully formatted.
2019-06-13 12:04:20,423 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:20,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:20,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:20,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:20,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:20,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:20,423 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 8db082f8-c15c-4f53-9c89-7e502012b11b-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-1/data/ratis/99f7df9d-a087-4276-b03e-8b8b0f1a87b1
2019-06-13 12:04:20,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:20,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:20,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:20,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:20,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:20,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:20,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:20,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:20,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:20,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:20,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:20,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:20,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:20,425 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: start group-8B8B0F1A87B1
2019-06-13 12:04:20,425 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8db082f8-c15c-4f53-9c89-7e502012b11b:group-8B8B0F1A87B1 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:20,425 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: start FollowerState
2019-06-13 12:04:20,425 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-8B8B0F1A87B1,id=8db082f8-c15c-4f53-9c89-7e502012b11b
2019-06-13 12:04:20,432 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 99f7df9d-a087-4276-b03e-8b8b0f1a87b1, Nodes: 8db082f8-c15c-4f53-9c89-7e502012b11b{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:04:20,457 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1090, electionTimeout:1084ms
2019-06-13 12:04:20,458 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:20,458 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 14 for changeToCandidate
2019-06-13 12:04:20,458 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:20,460 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 2 of 7 DN Heartbeats.
2019-06-13 12:04:20,465 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection27: begin an election at term 15 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:20,466 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection27 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:20,472 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection27 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:20,504 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection27: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t15, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:20,504 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:20,510 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:20,511 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 15 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:20,511 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:20,511 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:20,627 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 0d7c7125-8653-4c54-8389-e7d3e894c6b9{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:04:20,644 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: addNew group-781B894A3563:[0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321] returns group-781B894A3563:java.util.concurrent.CompletableFuture@19b1ed6e[Not completed]
2019-06-13 12:04:20,645 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: new RaftServerImpl for group-781B894A3563:[0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321] with ContainerStateMachine:uninitialized
2019-06-13 12:04:20,645 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:20,645 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:20,645 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:20,645 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:20,645 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-781B894A3563 ConfigurationManager, init=-1: [0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:20,645 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-2/data/ratis] (custom)
2019-06-13 12:04:20,646 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-2/data/ratis/8e9cb31b-6904-425a-aea8-781b894a3563 does not exist. Creating ...
2019-06-13 12:04:20,676 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-2/data/ratis/8e9cb31b-6904-425a-aea8-781b894a3563/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:20,685 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-2/data/ratis/8e9cb31b-6904-425a-aea8-781b894a3563 has been successfully formatted.
2019-06-13 12:04:20,685 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:20,685 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:20,685 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:20,685 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:20,686 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:20,686 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:20,686 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 0d7c7125-8653-4c54-8389-e7d3e894c6b9-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-2/data/ratis/8e9cb31b-6904-425a-aea8-781b894a3563
2019-06-13 12:04:20,686 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:20,686 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:20,686 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:20,686 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:20,686 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:20,686 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:20,687 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:20,687 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:20,687 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:20,687 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:20,687 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:20,687 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:20,688 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:20,688 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: start group-781B894A3563
2019-06-13 12:04:20,688 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-781B894A3563 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:20,688 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: start FollowerState
2019-06-13 12:04:20,688 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-781B894A3563,id=0d7c7125-8653-4c54-8389-e7d3e894c6b9
2019-06-13 12:04:20,692 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 8e9cb31b-6904-425a-aea8-781b894a3563, Nodes: 0d7c7125-8653-4c54-8389-e7d3e894c6b9{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:04:20,706 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: addNew group-99EA735CF3EA:[8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321, 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871] returns group-99EA735CF3EA:java.util.concurrent.CompletableFuture@780903f2[Not completed]
2019-06-13 12:04:20,707 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: addNew group-99EA735CF3EA:[8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321, 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871] returns group-99EA735CF3EA:java.util.concurrent.CompletableFuture@329c040[Not completed]
2019-06-13 12:04:20,707 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: new RaftServerImpl for group-99EA735CF3EA:[8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321, 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871] with ContainerStateMachine:uninitialized
2019-06-13 12:04:20,708 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:20,708 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:20,708 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:20,708 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:20,708 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 2682a03f-c762-403c-bf4d-e604d8794fd4:group-99EA735CF3EA ConfigurationManager, init=-1: [8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321, 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:20,708 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-0/data/ratis] (custom)
2019-06-13 12:04:20,708 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: addNew group-99EA735CF3EA:[8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321, 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871] returns group-99EA735CF3EA:java.util.concurrent.CompletableFuture@61ff6148[Not completed]
2019-06-13 12:04:20,708 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-0/data/ratis/9231dbd4-1d69-4f33-8ff5-99ea735cf3ea does not exist. Creating ...
2019-06-13 12:04:20,709 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: new RaftServerImpl for group-99EA735CF3EA:[8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321, 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871] with ContainerStateMachine:uninitialized
2019-06-13 12:04:20,709 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:20,709 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:20,709 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:20,709 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: new RaftServerImpl for group-99EA735CF3EA:[8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321, 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871] with ContainerStateMachine:uninitialized
2019-06-13 12:04:20,710 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:20,710 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:20,710 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:20,710 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:20,710 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 8db082f8-c15c-4f53-9c89-7e502012b11b:group-99EA735CF3EA ConfigurationManager, init=-1: [8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321, 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:20,710 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-1/data/ratis] (custom)
2019-06-13 12:04:20,710 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:20,710 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA ConfigurationManager, init=-1: [8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321, 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:20,710 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-2/data/ratis] (custom)
2019-06-13 12:04:20,710 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-2/data/ratis/9231dbd4-1d69-4f33-8ff5-99ea735cf3ea does not exist. Creating ...
2019-06-13 12:04:20,712 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-1/data/ratis/9231dbd4-1d69-4f33-8ff5-99ea735cf3ea does not exist. Creating ...
2019-06-13 12:04:20,712 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-0/data/ratis/9231dbd4-1d69-4f33-8ff5-99ea735cf3ea/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:20,714 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-1/data/ratis/9231dbd4-1d69-4f33-8ff5-99ea735cf3ea/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:20,714 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-2/data/ratis/9231dbd4-1d69-4f33-8ff5-99ea735cf3ea/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:20,716 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-1/data/ratis/9231dbd4-1d69-4f33-8ff5-99ea735cf3ea has been successfully formatted.
2019-06-13 12:04:20,716 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-0/data/ratis/9231dbd4-1d69-4f33-8ff5-99ea735cf3ea has been successfully formatted.
2019-06-13 12:04:20,716 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:20,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:20,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:20,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:20,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:20,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:20,717 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 8db082f8-c15c-4f53-9c89-7e502012b11b-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-1/data/ratis/9231dbd4-1d69-4f33-8ff5-99ea735cf3ea
2019-06-13 12:04:20,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:20,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:20,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:20,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:20,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:20,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:20,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:20,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:20,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:20,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:20,718 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:20,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:20,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:20,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:20,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:20,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:20,718 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 2682a03f-c762-403c-bf4d-e604d8794fd4-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-0/data/ratis/9231dbd4-1d69-4f33-8ff5-99ea735cf3ea
2019-06-13 12:04:20,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:20,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:20,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:20,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:20,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:20,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:20,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:20,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:20,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:20,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:20,718 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-2/data/ratis/9231dbd4-1d69-4f33-8ff5-99ea735cf3ea has been successfully formatted.
2019-06-13 12:04:20,719 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:20,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:20,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:20,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:20,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:20,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:20,720 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 0d7c7125-8653-4c54-8389-e7d3e894c6b9-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-2/data/ratis/9231dbd4-1d69-4f33-8ff5-99ea735cf3ea
2019-06-13 12:04:20,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:20,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:20,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:20,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:20,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:20,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:20,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:20,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:20,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:20,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:20,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:20,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:20,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:20,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:20,722 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: start group-99EA735CF3EA
2019-06-13 12:04:20,722 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2682a03f-c762-403c-bf4d-e604d8794fd4:group-99EA735CF3EA changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:20,722 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: start FollowerState
2019-06-13 12:04:20,724 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:20,724 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: start group-99EA735CF3EA
2019-06-13 12:04:20,724 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8db082f8-c15c-4f53-9c89-7e502012b11b:group-99EA735CF3EA changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:20,724 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: start FollowerState
2019-06-13 12:04:20,724 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-99EA735CF3EA,id=2682a03f-c762-403c-bf4d-e604d8794fd4
2019-06-13 12:04:20,724 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:20,724 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-99EA735CF3EA,id=8db082f8-c15c-4f53-9c89-7e502012b11b
2019-06-13 12:04:20,725 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:20,725 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:20,725 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:20,725 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: start group-99EA735CF3EA
2019-06-13 12:04:20,725 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:20,725 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: start FollowerState
2019-06-13 12:04:20,728 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-99EA735CF3EA,id=0d7c7125-8653-4c54-8389-e7d3e894c6b9
2019-06-13 12:04:20,739 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 9231dbd4-1d69-4f33-8ff5-99ea735cf3ea, Nodes: 2682a03f-c762-403c-bf4d-e604d8794fd4{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}8db082f8-c15c-4f53-9c89-7e502012b11b{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}0d7c7125-8653-4c54-8389-e7d3e894c6b9{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-13 12:04:20,887 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 997cd3e4-2dc3-465f-9ba2-a60765f1809f{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:04:20,894 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: addNew group-3042EA367800:[997cd3e4-2dc3-465f-9ba2-a60765f1809f:192.168.46.58:39979] returns group-3042EA367800:java.util.concurrent.CompletableFuture@28aa0041[Not completed]
2019-06-13 12:04:20,899 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: new RaftServerImpl for group-3042EA367800:[997cd3e4-2dc3-465f-9ba2-a60765f1809f:192.168.46.58:39979] with ContainerStateMachine:uninitialized
2019-06-13 12:04:20,899 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:20,899 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:20,899 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:20,899 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:20,899 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f:group-3042EA367800 ConfigurationManager, init=-1: [997cd3e4-2dc3-465f-9ba2-a60765f1809f:192.168.46.58:39979], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:20,900 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-3/data/ratis] (custom)
2019-06-13 12:04:20,900 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-3/data/ratis/aa6102f9-dd04-4e1c-a6a4-3042ea367800 does not exist. Creating ...
2019-06-13 12:04:20,910 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-3/data/ratis/aa6102f9-dd04-4e1c-a6a4-3042ea367800/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:20,933 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-3/data/ratis/aa6102f9-dd04-4e1c-a6a4-3042ea367800 has been successfully formatted.
2019-06-13 12:04:20,933 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:20,933 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:20,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:20,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:20,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:20,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:20,934 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 997cd3e4-2dc3-465f-9ba2-a60765f1809f-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-3/data/ratis/aa6102f9-dd04-4e1c-a6a4-3042ea367800
2019-06-13 12:04:20,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:20,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:20,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:20,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:20,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:20,935 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:20,935 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:20,935 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:20,935 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:20,935 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:20,935 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:20,935 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:20,937 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:20,938 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: start group-3042EA367800
2019-06-13 12:04:20,938 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f:group-3042EA367800 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:20,938 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: start FollowerState
2019-06-13 12:04:20,952 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-3042EA367800,id=997cd3e4-2dc3-465f-9ba2-a60765f1809f
2019-06-13 12:04:20,968 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: aa6102f9-dd04-4e1c-a6a4-3042ea367800, Nodes: 997cd3e4-2dc3-465f-9ba2-a60765f1809f{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:04:21,075 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 4ecadeec-2c92-46ff-b057-42e40bec0a7d{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:04:21,083 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: addNew group-F14C640D7B93:[4ecadeec-2c92-46ff-b057-42e40bec0a7d:192.168.46.58:32845] returns group-F14C640D7B93:java.util.concurrent.CompletableFuture@66127f67[Not completed]
2019-06-13 12:04:21,084 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: new RaftServerImpl for group-F14C640D7B93:[4ecadeec-2c92-46ff-b057-42e40bec0a7d:192.168.46.58:32845] with ContainerStateMachine:uninitialized
2019-06-13 12:04:21,085 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:21,085 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:21,085 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:21,085 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:21,085 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d:group-F14C640D7B93 ConfigurationManager, init=-1: [4ecadeec-2c92-46ff-b057-42e40bec0a7d:192.168.46.58:32845], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:21,085 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-4/data/ratis] (custom)
2019-06-13 12:04:21,085 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-4/data/ratis/f089181f-fda8-4baf-aa6d-f14c640d7b93 does not exist. Creating ...
2019-06-13 12:04:21,091 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-4/data/ratis/f089181f-fda8-4baf-aa6d-f14c640d7b93/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:21,096 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-4/data/ratis/f089181f-fda8-4baf-aa6d-f14c640d7b93 has been successfully formatted.
2019-06-13 12:04:21,096 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:21,096 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:21,096 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:21,096 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:21,097 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:21,097 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:21,097 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 4ecadeec-2c92-46ff-b057-42e40bec0a7d-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-4/data/ratis/f089181f-fda8-4baf-aa6d-f14c640d7b93
2019-06-13 12:04:21,097 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:21,097 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:21,097 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:21,097 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:21,097 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:21,097 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:21,098 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:21,098 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:21,098 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:21,098 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:21,098 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:21,098 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:21,099 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:21,099 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: start group-F14C640D7B93
2019-06-13 12:04:21,099 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d:group-F14C640D7B93 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:21,099 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: start FollowerState
2019-06-13 12:04:21,099 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-F14C640D7B93,id=4ecadeec-2c92-46ff-b057-42e40bec0a7d
2019-06-13 12:04:21,109 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: f089181f-fda8-4baf-aa6d-f14c640d7b93, Nodes: 4ecadeec-2c92-46ff-b057-42e40bec0a7d{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:04:21,279 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : d35b2b35-132a-43df-be94-eee7b24b01a8{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:04:21,288 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - d35b2b35-132a-43df-be94-eee7b24b01a8: addNew group-F88AA51E54CA:[d35b2b35-132a-43df-be94-eee7b24b01a8:192.168.46.58:44637] returns group-F88AA51E54CA:java.util.concurrent.CompletableFuture@5fb54c55[Not completed]
2019-06-13 12:04:21,288 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - d35b2b35-132a-43df-be94-eee7b24b01a8: new RaftServerImpl for group-F88AA51E54CA:[d35b2b35-132a-43df-be94-eee7b24b01a8:192.168.46.58:44637] with ContainerStateMachine:uninitialized
2019-06-13 12:04:21,288 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:21,289 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:21,289 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:21,289 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:21,289 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - d35b2b35-132a-43df-be94-eee7b24b01a8:group-F88AA51E54CA ConfigurationManager, init=-1: [d35b2b35-132a-43df-be94-eee7b24b01a8:192.168.46.58:44637], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:21,289 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-5/data/ratis] (custom)
2019-06-13 12:04:21,289 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-5/data/ratis/0dee78f5-20fd-4a38-8a6c-f88aa51e54ca does not exist. Creating ...
2019-06-13 12:04:21,297 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-5/data/ratis/0dee78f5-20fd-4a38-8a6c-f88aa51e54ca/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:21,301 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-5/data/ratis/0dee78f5-20fd-4a38-8a6c-f88aa51e54ca has been successfully formatted.
2019-06-13 12:04:21,301 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:21,301 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:21,301 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:21,301 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:21,301 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:21,301 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:21,301 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new d35b2b35-132a-43df-be94-eee7b24b01a8-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-5/data/ratis/0dee78f5-20fd-4a38-8a6c-f88aa51e54ca
2019-06-13 12:04:21,301 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:21,301 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:21,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:21,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:21,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:21,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:21,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:21,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:21,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:21,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:21,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:21,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:21,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:21,303 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - d35b2b35-132a-43df-be94-eee7b24b01a8: start group-F88AA51E54CA
2019-06-13 12:04:21,303 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d35b2b35-132a-43df-be94-eee7b24b01a8:group-F88AA51E54CA changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:21,303 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d35b2b35-132a-43df-be94-eee7b24b01a8: start FollowerState
2019-06-13 12:04:21,305 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-F88AA51E54CA,id=d35b2b35-132a-43df-be94-eee7b24b01a8
2019-06-13 12:04:21,309 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 0dee78f5-20fd-4a38-8a6c-f88aa51e54ca, Nodes: d35b2b35-132a-43df-be94-eee7b24b01a8{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:04:21,323 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - d35b2b35-132a-43df-be94-eee7b24b01a8: addNew group-D2EDF6CA370A:[997cd3e4-2dc3-465f-9ba2-a60765f1809f:192.168.46.58:39979, 4ecadeec-2c92-46ff-b057-42e40bec0a7d:192.168.46.58:32845, d35b2b35-132a-43df-be94-eee7b24b01a8:192.168.46.58:44637] returns group-D2EDF6CA370A:java.util.concurrent.CompletableFuture@51004e70[Not completed]
2019-06-13 12:04:21,323 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: addNew group-D2EDF6CA370A:[997cd3e4-2dc3-465f-9ba2-a60765f1809f:192.168.46.58:39979, 4ecadeec-2c92-46ff-b057-42e40bec0a7d:192.168.46.58:32845, d35b2b35-132a-43df-be94-eee7b24b01a8:192.168.46.58:44637] returns group-D2EDF6CA370A:java.util.concurrent.CompletableFuture@31548843[Not completed]
2019-06-13 12:04:21,323 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: new RaftServerImpl for group-D2EDF6CA370A:[997cd3e4-2dc3-465f-9ba2-a60765f1809f:192.168.46.58:39979, 4ecadeec-2c92-46ff-b057-42e40bec0a7d:192.168.46.58:32845, d35b2b35-132a-43df-be94-eee7b24b01a8:192.168.46.58:44637] with ContainerStateMachine:uninitialized
2019-06-13 12:04:21,324 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:21,324 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:21,324 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:21,324 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:21,324 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f:group-D2EDF6CA370A ConfigurationManager, init=-1: [997cd3e4-2dc3-465f-9ba2-a60765f1809f:192.168.46.58:39979, 4ecadeec-2c92-46ff-b057-42e40bec0a7d:192.168.46.58:32845, d35b2b35-132a-43df-be94-eee7b24b01a8:192.168.46.58:44637], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:21,324 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-3/data/ratis] (custom)
2019-06-13 12:04:21,324 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-3/data/ratis/4a65997a-c69e-4cfc-9785-d2edf6ca370a does not exist. Creating ...
2019-06-13 12:04:21,325 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: addNew group-D2EDF6CA370A:[997cd3e4-2dc3-465f-9ba2-a60765f1809f:192.168.46.58:39979, 4ecadeec-2c92-46ff-b057-42e40bec0a7d:192.168.46.58:32845, d35b2b35-132a-43df-be94-eee7b24b01a8:192.168.46.58:44637] returns group-D2EDF6CA370A:java.util.concurrent.CompletableFuture@4476bdd8[Not completed]
2019-06-13 12:04:21,325 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - d35b2b35-132a-43df-be94-eee7b24b01a8: new RaftServerImpl for group-D2EDF6CA370A:[997cd3e4-2dc3-465f-9ba2-a60765f1809f:192.168.46.58:39979, 4ecadeec-2c92-46ff-b057-42e40bec0a7d:192.168.46.58:32845, d35b2b35-132a-43df-be94-eee7b24b01a8:192.168.46.58:44637] with ContainerStateMachine:uninitialized
2019-06-13 12:04:21,325 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:21,325 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:21,325 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:21,326 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: new RaftServerImpl for group-D2EDF6CA370A:[997cd3e4-2dc3-465f-9ba2-a60765f1809f:192.168.46.58:39979, 4ecadeec-2c92-46ff-b057-42e40bec0a7d:192.168.46.58:32845, d35b2b35-132a-43df-be94-eee7b24b01a8:192.168.46.58:44637] with ContainerStateMachine:uninitialized
2019-06-13 12:04:21,326 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:21,326 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - d35b2b35-132a-43df-be94-eee7b24b01a8:group-D2EDF6CA370A ConfigurationManager, init=-1: [997cd3e4-2dc3-465f-9ba2-a60765f1809f:192.168.46.58:39979, 4ecadeec-2c92-46ff-b057-42e40bec0a7d:192.168.46.58:32845, d35b2b35-132a-43df-be94-eee7b24b01a8:192.168.46.58:44637], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:21,326 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:21,326 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-5/data/ratis] (custom)
2019-06-13 12:04:21,326 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:21,326 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:21,326 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:21,326 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-5/data/ratis/4a65997a-c69e-4cfc-9785-d2edf6ca370a does not exist. Creating ...
2019-06-13 12:04:21,326 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d:group-D2EDF6CA370A ConfigurationManager, init=-1: [997cd3e4-2dc3-465f-9ba2-a60765f1809f:192.168.46.58:39979, 4ecadeec-2c92-46ff-b057-42e40bec0a7d:192.168.46.58:32845, d35b2b35-132a-43df-be94-eee7b24b01a8:192.168.46.58:44637], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:21,326 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-4/data/ratis] (custom)
2019-06-13 12:04:21,327 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-4/data/ratis/4a65997a-c69e-4cfc-9785-d2edf6ca370a does not exist. Creating ...
2019-06-13 12:04:21,330 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-3/data/ratis/4a65997a-c69e-4cfc-9785-d2edf6ca370a/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:21,334 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-4/data/ratis/4a65997a-c69e-4cfc-9785-d2edf6ca370a/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:21,334 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-5/data/ratis/4a65997a-c69e-4cfc-9785-d2edf6ca370a/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:21,334 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-3/data/ratis/4a65997a-c69e-4cfc-9785-d2edf6ca370a has been successfully formatted.
2019-06-13 12:04:21,334 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:21,334 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:21,334 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:21,334 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:21,334 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:21,334 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:21,335 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 997cd3e4-2dc3-465f-9ba2-a60765f1809f-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-3/data/ratis/4a65997a-c69e-4cfc-9785-d2edf6ca370a
2019-06-13 12:04:21,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:21,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:21,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:21,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:21,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:21,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:21,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:21,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:21,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:21,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:21,337 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:21,337 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:21,338 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:21,338 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: start group-D2EDF6CA370A
2019-06-13 12:04:21,338 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f:group-D2EDF6CA370A changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:21,338 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: start FollowerState
2019-06-13 12:04:21,338 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D2EDF6CA370A,id=997cd3e4-2dc3-465f-9ba2-a60765f1809f
2019-06-13 12:04:21,342 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-4/data/ratis/4a65997a-c69e-4cfc-9785-d2edf6ca370a has been successfully formatted.
2019-06-13 12:04:21,342 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:21,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:21,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:21,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:21,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:21,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:21,343 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 4ecadeec-2c92-46ff-b057-42e40bec0a7d-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-4/data/ratis/4a65997a-c69e-4cfc-9785-d2edf6ca370a
2019-06-13 12:04:21,343 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:21,343 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:21,343 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:21,343 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:21,343 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:21,343 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:21,343 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:21,343 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:21,343 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:21,344 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-5/data/ratis/4a65997a-c69e-4cfc-9785-d2edf6ca370a has been successfully formatted.
2019-06-13 12:04:21,344 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:21,344 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:21,344 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:21,344 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:21,344 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:21,344 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:21,344 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new d35b2b35-132a-43df-be94-eee7b24b01a8-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-5/data/ratis/4a65997a-c69e-4cfc-9785-d2edf6ca370a
2019-06-13 12:04:21,344 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:21,344 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:21,344 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:21,344 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:21,344 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:21,344 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:21,345 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:21,345 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:21,345 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:21,345 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:21,344 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:21,345 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:21,345 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:21,346 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:21,346 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - d35b2b35-132a-43df-be94-eee7b24b01a8: start group-D2EDF6CA370A
2019-06-13 12:04:21,346 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d35b2b35-132a-43df-be94-eee7b24b01a8:group-D2EDF6CA370A changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:21,346 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d35b2b35-132a-43df-be94-eee7b24b01a8: start FollowerState
2019-06-13 12:04:21,346 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D2EDF6CA370A,id=d35b2b35-132a-43df-be94-eee7b24b01a8
2019-06-13 12:04:21,346 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:21,346 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:21,348 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:21,348 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: start group-D2EDF6CA370A
2019-06-13 12:04:21,349 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d:group-D2EDF6CA370A changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:21,349 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: start FollowerState
2019-06-13 12:04:21,349 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D2EDF6CA370A,id=4ecadeec-2c92-46ff-b057-42e40bec0a7d
2019-06-13 12:04:21,355 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 4a65997a-c69e-4cfc-9785-d2edf6ca370a, Nodes: 4ecadeec-2c92-46ff-b057-42e40bec0a7d{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}d35b2b35-132a-43df-be94-eee7b24b01a8{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}997cd3e4-2dc3-465f-9ba2-a60765f1809f{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-13 12:04:21,402 INFO  impl.FollowerState (FollowerState.java:run(101)) - 2682a03f-c762-403c-bf4d-e604d8794fd4:group-1A98D85D1B92 changes to CANDIDATE, lastRpcTime:1149, electionTimeout:1149ms
2019-06-13 12:04:21,402 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: shutdown FollowerState
2019-06-13 12:04:21,402 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2682a03f-c762-403c-bf4d-e604d8794fd4:group-1A98D85D1B92 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:21,402 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: start LeaderElection
2019-06-13 12:04:21,429 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 2682a03f-c762-403c-bf4d-e604d8794fd4:group-1A98D85D1B92:LeaderElection28: begin an election at term 1 for -1: [2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871], old=null
2019-06-13 12:04:21,432 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: shutdown LeaderElection
2019-06-13 12:04:21,432 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2682a03f-c762-403c-bf4d-e604d8794fd4:group-1A98D85D1B92 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:21,432 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 2682a03f-c762-403c-bf4d-e604d8794fd4:group-1A98D85D1B92 change Leader from null to 2682a03f-c762-403c-bf4d-e604d8794fd4 at term 1 for becomeLeader, leader elected after 1182ms
2019-06-13 12:04:21,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:21,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:21,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:21,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:21,432 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: start LeaderState
2019-06-13 12:04:21,433 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 2682a03f-c762-403c-bf4d-e604d8794fd4-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:21,433 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 2682a03f-c762-403c-bf4d-e604d8794fd4:group-1A98D85D1B92 set configuration 0: [2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871], old=null at 0
2019-06-13 12:04:21,456 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : dff10fa6-63b0-417b-b8d5-289bb576cc54{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:04:21,460 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Cluster is ready. Got 7 of 7 DN Heartbeats.
2019-06-13 12:04:21,480 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - dff10fa6-63b0-417b-b8d5-289bb576cc54: addNew group-FDD1AE029BC6:[dff10fa6-63b0-417b-b8d5-289bb576cc54:192.168.46.58:46407] returns group-FDD1AE029BC6:java.util.concurrent.CompletableFuture@725b9d71[Not completed]
2019-06-13 12:04:21,480 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - dff10fa6-63b0-417b-b8d5-289bb576cc54: new RaftServerImpl for group-FDD1AE029BC6:[dff10fa6-63b0-417b-b8d5-289bb576cc54:192.168.46.58:46407] with ContainerStateMachine:uninitialized
2019-06-13 12:04:21,481 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:21,481 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:21,481 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:21,481 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:21,481 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - dff10fa6-63b0-417b-b8d5-289bb576cc54:group-FDD1AE029BC6 ConfigurationManager, init=-1: [dff10fa6-63b0-417b-b8d5-289bb576cc54:192.168.46.58:46407], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:21,481 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-6/data/ratis] (custom)
2019-06-13 12:04:21,482 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-6/data/ratis/cb62f106-6f9b-404d-9ec1-fdd1ae029bc6 does not exist. Creating ...
2019-06-13 12:04:21,495 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 2682a03f-c762-403c-bf4d-e604d8794fd4-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-0/data/ratis/986e8245-e738-43f5-9c54-1a98d85d1b92/current/log_inprogress_0
2019-06-13 12:04:21,497 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-6/data/ratis/cb62f106-6f9b-404d-9ec1-fdd1ae029bc6/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:21,504 INFO  rpc.RpcClient (RpcClient.java:createVolume(289)) - Creating Volume: watchforcommithandlingtest, with root as owner.
2019-06-13 12:04:21,514 INFO  impl.FollowerState (FollowerState.java:run(101)) - 8db082f8-c15c-4f53-9c89-7e502012b11b:group-8B8B0F1A87B1 changes to CANDIDATE, lastRpcTime:1089, electionTimeout:1083ms
2019-06-13 12:04:21,514 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: shutdown FollowerState
2019-06-13 12:04:21,514 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8db082f8-c15c-4f53-9c89-7e502012b11b:group-8B8B0F1A87B1 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:21,514 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: start LeaderElection
2019-06-13 12:04:21,517 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-6/data/ratis/cb62f106-6f9b-404d-9ec1-fdd1ae029bc6 has been successfully formatted.
2019-06-13 12:04:21,517 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:21,517 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:21,517 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:21,517 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:21,518 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:21,518 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:21,518 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new dff10fa6-63b0-417b-b8d5-289bb576cc54-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-6/data/ratis/cb62f106-6f9b-404d-9ec1-fdd1ae029bc6
2019-06-13 12:04:21,518 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:21,518 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:21,518 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:21,518 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:21,518 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:21,518 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:21,518 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:21,518 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:21,519 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:21,519 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:21,519 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:21,519 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:21,526 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:21,526 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - dff10fa6-63b0-417b-b8d5-289bb576cc54: start group-FDD1AE029BC6
2019-06-13 12:04:21,526 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - dff10fa6-63b0-417b-b8d5-289bb576cc54:group-FDD1AE029BC6 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:21,526 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - dff10fa6-63b0-417b-b8d5-289bb576cc54: start FollowerState
2019-06-13 12:04:21,528 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-FDD1AE029BC6,id=dff10fa6-63b0-417b-b8d5-289bb576cc54
2019-06-13 12:04:21,542 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 8db082f8-c15c-4f53-9c89-7e502012b11b:group-8B8B0F1A87B1:LeaderElection29: begin an election at term 1 for -1: [8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471], old=null
2019-06-13 12:04:21,542 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: shutdown LeaderElection
2019-06-13 12:04:21,542 INFO  rpc.RpcClient (RpcClient.java:createBucket(426)) - Creating Bucket: watchforcommithandlingtest/watchforcommithandlingtest, with Versioning false and Storage Type set to DISK and Encryption set to false 
2019-06-13 12:04:21,542 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8db082f8-c15c-4f53-9c89-7e502012b11b:group-8B8B0F1A87B1 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:21,542 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 8db082f8-c15c-4f53-9c89-7e502012b11b:group-8B8B0F1A87B1 change Leader from null to 8db082f8-c15c-4f53-9c89-7e502012b11b at term 1 for becomeLeader, leader elected after 1119ms
2019-06-13 12:04:21,542 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:21,542 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:21,543 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:21,543 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:21,543 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: start LeaderState
2019-06-13 12:04:21,543 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 8db082f8-c15c-4f53-9c89-7e502012b11b-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:21,545 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 8db082f8-c15c-4f53-9c89-7e502012b11b:group-8B8B0F1A87B1 set configuration 0: [8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471], old=null at 0
2019-06-13 12:04:21,546 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: cb62f106-6f9b-404d-9ec1-fdd1ae029bc6, Nodes: dff10fa6-63b0-417b-b8d5-289bb576cc54{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:04:21,564 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:getStorageContainerLocationClient(241)) - Creating StorageContainerLocationProtocol RPC client with address /0.0.0.0:38343
2019-06-13 12:04:21,604 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-FA1A639FE6AD->2682a03f-c762-403c-bf4d-e604d8794fd4: receive RaftClientReply:client-FA1A639FE6AD->2682a03f-c762-403c-bf4d-e604d8794fd4@group-99EA735CF3EA, cid=47, FAILED org.apache.ratis.protocol.NotLeaderException: Server 2682a03f-c762-403c-bf4d-e604d8794fd4 is not the leader (0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321). Request must be sent to leader., logIndex=0, commits[2682a03f-c762-403c-bf4d-e604d8794fd4:c-1]
2019-06-13 12:04:21,610 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:21,613 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 8db082f8-c15c-4f53-9c89-7e502012b11b-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-1/data/ratis/99f7df9d-a087-4276-b03e-8b8b0f1a87b1/current/log_inprogress_0
2019-06-13 12:04:21,647 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1135, electionTimeout:1130ms
2019-06-13 12:04:21,647 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:21,647 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 15 for changeToCandidate
2019-06-13 12:04:21,647 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:21,671 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection30: begin an election at term 16 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:21,673 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection30 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:21,676 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection30 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:21,678 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection30: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t16, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:21,678 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:21,678 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:21,678 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 16 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:21,678 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:21,678 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:21,733 INFO  impl.FollowerState (FollowerState.java:run(101)) - 8db082f8-c15c-4f53-9c89-7e502012b11b:group-99EA735CF3EA changes to CANDIDATE, lastRpcTime:1008, electionTimeout:1008ms
2019-06-13 12:04:21,735 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: shutdown FollowerState
2019-06-13 12:04:21,735 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8db082f8-c15c-4f53-9c89-7e502012b11b:group-99EA735CF3EA changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:21,735 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: start LeaderElection
2019-06-13 12:04:21,756 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 8db082f8-c15c-4f53-9c89-7e502012b11b:group-99EA735CF3EA:LeaderElection31: begin an election at term 1 for -1: [8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321, 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871], old=null
2019-06-13 12:04:21,763 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:8db082f8-c15c-4f53-9c89-7e502012b11b
2019-06-13 12:04:21,764 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: shutdown FollowerState
2019-06-13 12:04:21,764 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: start FollowerState
2019-06-13 12:04:21,764 INFO  impl.FollowerState (FollowerState.java:run(109)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:04:21,767 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2682a03f-c762-403c-bf4d-e604d8794fd4:group-99EA735CF3EA changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:8db082f8-c15c-4f53-9c89-7e502012b11b
2019-06-13 12:04:21,767 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: shutdown FollowerState
2019-06-13 12:04:21,767 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: start FollowerState
2019-06-13 12:04:21,768 INFO  impl.FollowerState (FollowerState.java:run(101)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-781B894A3563 changes to CANDIDATE, lastRpcTime:1080, electionTimeout:1080ms
2019-06-13 12:04:21,768 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: shutdown FollowerState
2019-06-13 12:04:21,769 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-781B894A3563 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:21,770 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: start LeaderElection
2019-06-13 12:04:21,770 INFO  impl.FollowerState (FollowerState.java:run(109)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:04:21,780 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 8db082f8-c15c-4f53-9c89-7e502012b11b:group-99EA735CF3EA:LeaderElection31: Election PASSED; received 1 response(s) [8db082f8-c15c-4f53-9c89-7e502012b11b->0d7c7125-8653-4c54-8389-e7d3e894c6b9,true-t1] and 0 exception(s); 8db082f8-c15c-4f53-9c89-7e502012b11b:t1, leader=null, voted=8db082f8-c15c-4f53-9c89-7e502012b11b, raftlog=8db082f8-c15c-4f53-9c89-7e502012b11b-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321, 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871], old=null
2019-06-13 12:04:21,780 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: shutdown LeaderElection
2019-06-13 12:04:21,781 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8db082f8-c15c-4f53-9c89-7e502012b11b:group-99EA735CF3EA changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:21,781 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 8db082f8-c15c-4f53-9c89-7e502012b11b:group-99EA735CF3EA change Leader from null to 8db082f8-c15c-4f53-9c89-7e502012b11b at term 1 for becomeLeader, leader elected after 1064ms
2019-06-13 12:04:21,781 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:21,781 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:21,781 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:21,781 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:21,781 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 12:04:21,781 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:21,784 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 12:04:21,784 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 12:04:21,784 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:21,784 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:21,784 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 12:04:21,784 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:21,784 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 12:04:21,784 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 12:04:21,784 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:21,785 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:21,785 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: start LeaderState
2019-06-13 12:04:21,785 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 8db082f8-c15c-4f53-9c89-7e502012b11b-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:21,785 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 8db082f8-c15c-4f53-9c89-7e502012b11b:group-99EA735CF3EA set configuration 0: [8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321, 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871], old=null at 0
2019-06-13 12:04:21,786 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-781B894A3563:LeaderElection32: begin an election at term 1 for -1: [0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321], old=null
2019-06-13 12:04:21,795 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: shutdown LeaderElection
2019-06-13 12:04:21,795 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-781B894A3563 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:21,795 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-781B894A3563 change Leader from null to 0d7c7125-8653-4c54-8389-e7d3e894c6b9 at term 1 for becomeLeader, leader elected after 1109ms
2019-06-13 12:04:21,795 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:21,795 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:21,795 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:21,796 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:21,796 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: start LeaderState
2019-06-13 12:04:21,796 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:21,796 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 2682a03f-c762-403c-bf4d-e604d8794fd4:group-99EA735CF3EA change Leader from null to 8db082f8-c15c-4f53-9c89-7e502012b11b at term 1 for appendEntries, leader elected after 1078ms
2019-06-13 12:04:21,796 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-781B894A3563 set configuration 0: [0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321], old=null at 0
2019-06-13 12:04:21,798 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA change Leader from null to 8db082f8-c15c-4f53-9c89-7e502012b11b at term 1 for appendEntries, leader elected after 1078ms
2019-06-13 12:04:21,849 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 2682a03f-c762-403c-bf4d-e604d8794fd4:group-99EA735CF3EA set configuration 0: [8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321, 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871], old=null at 0
2019-06-13 12:04:21,849 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 2682a03f-c762-403c-bf4d-e604d8794fd4-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:21,850 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 8db082f8-c15c-4f53-9c89-7e502012b11b-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-1/data/ratis/9231dbd4-1d69-4f33-8ff5-99ea735cf3ea/current/log_inprogress_0
2019-06-13 12:04:21,856 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA set configuration 0: [8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321, 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871], old=null at 0
2019-06-13 12:04:21,856 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:21,878 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-2/data/ratis/8e9cb31b-6904-425a-aea8-781b894a3563/current/log_inprogress_0
2019-06-13 12:04:21,902 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-2/data/ratis/9231dbd4-1d69-4f33-8ff5-99ea735cf3ea/current/log_inprogress_0
2019-06-13 12:04:21,904 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 2682a03f-c762-403c-bf4d-e604d8794fd4-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-0/data/ratis/9231dbd4-1d69-4f33-8ff5-99ea735cf3ea/current/log_inprogress_0
2019-06-13 12:04:22,102 INFO  impl.FollowerState (FollowerState.java:run(101)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f:group-3042EA367800 changes to CANDIDATE, lastRpcTime:1163, electionTimeout:1160ms
2019-06-13 12:04:22,102 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: shutdown FollowerState
2019-06-13 12:04:22,102 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f:group-3042EA367800 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:22,102 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: start LeaderElection
2019-06-13 12:04:22,126 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f:group-3042EA367800:LeaderElection33: begin an election at term 1 for -1: [997cd3e4-2dc3-465f-9ba2-a60765f1809f:192.168.46.58:39979], old=null
2019-06-13 12:04:22,126 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: shutdown LeaderElection
2019-06-13 12:04:22,126 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f:group-3042EA367800 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:22,126 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f:group-3042EA367800 change Leader from null to 997cd3e4-2dc3-465f-9ba2-a60765f1809f at term 1 for becomeLeader, leader elected after 1193ms
2019-06-13 12:04:22,127 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:22,127 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:22,127 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:22,127 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:22,127 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: start LeaderState
2019-06-13 12:04:22,127 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:22,128 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f:group-3042EA367800 set configuration 0: [997cd3e4-2dc3-465f-9ba2-a60765f1809f:192.168.46.58:39979], old=null at 0
2019-06-13 12:04:22,167 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-3/data/ratis/aa6102f9-dd04-4e1c-a6a4-3042ea367800/current/log_inprogress_0
2019-06-13 12:04:22,285 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d:group-F14C640D7B93 changes to CANDIDATE, lastRpcTime:1186, electionTimeout:1186ms
2019-06-13 12:04:22,285 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: shutdown FollowerState
2019-06-13 12:04:22,285 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d:group-F14C640D7B93 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:22,286 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: start LeaderElection
2019-06-13 12:04:22,297 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d:group-F14C640D7B93:LeaderElection34: begin an election at term 1 for -1: [4ecadeec-2c92-46ff-b057-42e40bec0a7d:192.168.46.58:32845], old=null
2019-06-13 12:04:22,297 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: shutdown LeaderElection
2019-06-13 12:04:22,297 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d:group-F14C640D7B93 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:22,297 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d:group-F14C640D7B93 change Leader from null to 4ecadeec-2c92-46ff-b057-42e40bec0a7d at term 1 for becomeLeader, leader elected after 1200ms
2019-06-13 12:04:22,297 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:22,297 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:22,297 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:22,297 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:22,298 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: start LeaderState
2019-06-13 12:04:22,298 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:22,301 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d:group-F14C640D7B93 set configuration 0: [4ecadeec-2c92-46ff-b057-42e40bec0a7d:192.168.46.58:32845], old=null at 0
2019-06-13 12:04:22,345 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-4/data/ratis/f089181f-fda8-4baf-aa6d-f14c640d7b93/current/log_inprogress_0
2019-06-13 12:04:22,354 INFO  impl.FollowerState (FollowerState.java:run(101)) - d35b2b35-132a-43df-be94-eee7b24b01a8:group-F88AA51E54CA changes to CANDIDATE, lastRpcTime:1050, electionTimeout:1049ms
2019-06-13 12:04:22,354 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d35b2b35-132a-43df-be94-eee7b24b01a8: shutdown FollowerState
2019-06-13 12:04:22,354 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d35b2b35-132a-43df-be94-eee7b24b01a8:group-F88AA51E54CA changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:22,354 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d35b2b35-132a-43df-be94-eee7b24b01a8: start LeaderElection
2019-06-13 12:04:22,358 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - d35b2b35-132a-43df-be94-eee7b24b01a8:group-F88AA51E54CA:LeaderElection35: begin an election at term 1 for -1: [d35b2b35-132a-43df-be94-eee7b24b01a8:192.168.46.58:44637], old=null
2019-06-13 12:04:22,358 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - d35b2b35-132a-43df-be94-eee7b24b01a8: shutdown LeaderElection
2019-06-13 12:04:22,358 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d35b2b35-132a-43df-be94-eee7b24b01a8:group-F88AA51E54CA changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:22,358 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - d35b2b35-132a-43df-be94-eee7b24b01a8:group-F88AA51E54CA change Leader from null to d35b2b35-132a-43df-be94-eee7b24b01a8 at term 1 for becomeLeader, leader elected after 1057ms
2019-06-13 12:04:22,358 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:22,358 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:22,358 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:22,359 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:22,359 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d35b2b35-132a-43df-be94-eee7b24b01a8: start LeaderState
2019-06-13 12:04:22,359 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - d35b2b35-132a-43df-be94-eee7b24b01a8-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:22,363 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - d35b2b35-132a-43df-be94-eee7b24b01a8:group-F88AA51E54CA set configuration 0: [d35b2b35-132a-43df-be94-eee7b24b01a8:192.168.46.58:44637], old=null at 0
2019-06-13 12:04:22,378 INFO  impl.FollowerState (FollowerState.java:run(101)) - d35b2b35-132a-43df-be94-eee7b24b01a8:group-D2EDF6CA370A changes to CANDIDATE, lastRpcTime:1032, electionTimeout:1028ms
2019-06-13 12:04:22,379 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d35b2b35-132a-43df-be94-eee7b24b01a8: shutdown FollowerState
2019-06-13 12:04:22,379 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d35b2b35-132a-43df-be94-eee7b24b01a8:group-D2EDF6CA370A changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:22,379 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d35b2b35-132a-43df-be94-eee7b24b01a8: start LeaderElection
2019-06-13 12:04:22,400 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - d35b2b35-132a-43df-be94-eee7b24b01a8-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-5/data/ratis/0dee78f5-20fd-4a38-8a6c-f88aa51e54ca/current/log_inprogress_0
2019-06-13 12:04:22,400 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - d35b2b35-132a-43df-be94-eee7b24b01a8:group-D2EDF6CA370A:LeaderElection36: begin an election at term 1 for -1: [997cd3e4-2dc3-465f-9ba2-a60765f1809f:192.168.46.58:39979, 4ecadeec-2c92-46ff-b057-42e40bec0a7d:192.168.46.58:32845, d35b2b35-132a-43df-be94-eee7b24b01a8:192.168.46.58:44637], old=null
2019-06-13 12:04:22,405 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f:group-D2EDF6CA370A changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:d35b2b35-132a-43df-be94-eee7b24b01a8
2019-06-13 12:04:22,405 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: shutdown FollowerState
2019-06-13 12:04:22,405 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: start FollowerState
2019-06-13 12:04:22,405 INFO  impl.FollowerState (FollowerState.java:run(109)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:04:22,405 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d:group-D2EDF6CA370A changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:d35b2b35-132a-43df-be94-eee7b24b01a8
2019-06-13 12:04:22,405 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: shutdown FollowerState
2019-06-13 12:04:22,405 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: start FollowerState
2019-06-13 12:04:22,406 INFO  impl.FollowerState (FollowerState.java:run(109)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:04:22,409 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - d35b2b35-132a-43df-be94-eee7b24b01a8:group-D2EDF6CA370A:LeaderElection36: Election PASSED; received 1 response(s) [d35b2b35-132a-43df-be94-eee7b24b01a8->4ecadeec-2c92-46ff-b057-42e40bec0a7d,true-t1] and 0 exception(s); d35b2b35-132a-43df-be94-eee7b24b01a8:t1, leader=null, voted=d35b2b35-132a-43df-be94-eee7b24b01a8, raftlog=d35b2b35-132a-43df-be94-eee7b24b01a8-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [997cd3e4-2dc3-465f-9ba2-a60765f1809f:192.168.46.58:39979, 4ecadeec-2c92-46ff-b057-42e40bec0a7d:192.168.46.58:32845, d35b2b35-132a-43df-be94-eee7b24b01a8:192.168.46.58:44637], old=null
2019-06-13 12:04:22,409 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - d35b2b35-132a-43df-be94-eee7b24b01a8: shutdown LeaderElection
2019-06-13 12:04:22,409 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d35b2b35-132a-43df-be94-eee7b24b01a8:group-D2EDF6CA370A changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:22,409 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - d35b2b35-132a-43df-be94-eee7b24b01a8:group-D2EDF6CA370A change Leader from null to d35b2b35-132a-43df-be94-eee7b24b01a8 at term 1 for becomeLeader, leader elected after 1065ms
2019-06-13 12:04:22,409 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:22,410 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:22,410 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:22,410 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:22,410 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 12:04:22,410 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:22,410 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 12:04:22,410 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 12:04:22,410 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:22,411 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:22,411 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 12:04:22,411 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:22,411 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 12:04:22,411 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 12:04:22,411 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:22,411 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:22,411 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d35b2b35-132a-43df-be94-eee7b24b01a8: start LeaderState
2019-06-13 12:04:22,412 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - d35b2b35-132a-43df-be94-eee7b24b01a8-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:22,414 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f:group-D2EDF6CA370A change Leader from null to d35b2b35-132a-43df-be94-eee7b24b01a8 at term 1 for appendEntries, leader elected after 1080ms
2019-06-13 12:04:22,417 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - d35b2b35-132a-43df-be94-eee7b24b01a8:group-D2EDF6CA370A set configuration 0: [997cd3e4-2dc3-465f-9ba2-a60765f1809f:192.168.46.58:39979, 4ecadeec-2c92-46ff-b057-42e40bec0a7d:192.168.46.58:32845, d35b2b35-132a-43df-be94-eee7b24b01a8:192.168.46.58:44637], old=null at 0
2019-06-13 12:04:22,454 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f:group-D2EDF6CA370A set configuration 0: [997cd3e4-2dc3-465f-9ba2-a60765f1809f:192.168.46.58:39979, 4ecadeec-2c92-46ff-b057-42e40bec0a7d:192.168.46.58:32845, d35b2b35-132a-43df-be94-eee7b24b01a8:192.168.46.58:44637], old=null at 0
2019-06-13 12:04:22,454 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - d35b2b35-132a-43df-be94-eee7b24b01a8-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-5/data/ratis/4a65997a-c69e-4cfc-9785-d2edf6ca370a/current/log_inprogress_0
2019-06-13 12:04:22,454 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:22,481 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d:group-D2EDF6CA370A change Leader from null to d35b2b35-132a-43df-be94-eee7b24b01a8 at term 1 for appendEntries, leader elected after 1139ms
2019-06-13 12:04:22,502 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-3/data/ratis/4a65997a-c69e-4cfc-9785-d2edf6ca370a/current/log_inprogress_0
2019-06-13 12:04:22,506 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d:group-D2EDF6CA370A set configuration 0: [997cd3e4-2dc3-465f-9ba2-a60765f1809f:192.168.46.58:39979, 4ecadeec-2c92-46ff-b057-42e40bec0a7d:192.168.46.58:32845, d35b2b35-132a-43df-be94-eee7b24b01a8:192.168.46.58:44637], old=null at 0
2019-06-13 12:04:22,506 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:22,545 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-4/data/ratis/4a65997a-c69e-4cfc-9785-d2edf6ca370a/current/log_inprogress_0
2019-06-13 12:04:22,620 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-FA1A639FE6AD->0d7c7125-8653-4c54-8389-e7d3e894c6b9: receive RaftClientReply:client-FA1A639FE6AD->0d7c7125-8653-4c54-8389-e7d3e894c6b9@group-99EA735CF3EA, cid=47, FAILED org.apache.ratis.protocol.NotLeaderException: Server 0d7c7125-8653-4c54-8389-e7d3e894c6b9 is not the leader (8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471). Request must be sent to leader., logIndex=0, commits[0d7c7125-8653-4c54-8389-e7d3e894c6b9:c0, 8db082f8-c15c-4f53-9c89-7e502012b11b:c0, 2682a03f-c762-403c-bf4d-e604d8794fd4:c-1]
2019-06-13 12:04:22,626 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:22,699 INFO  impl.FollowerState (FollowerState.java:run(101)) - dff10fa6-63b0-417b-b8d5-289bb576cc54:group-FDD1AE029BC6 changes to CANDIDATE, lastRpcTime:1173, electionTimeout:1171ms
2019-06-13 12:04:22,699 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - dff10fa6-63b0-417b-b8d5-289bb576cc54: shutdown FollowerState
2019-06-13 12:04:22,699 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - dff10fa6-63b0-417b-b8d5-289bb576cc54:group-FDD1AE029BC6 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:22,699 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - dff10fa6-63b0-417b-b8d5-289bb576cc54: start LeaderElection
2019-06-13 12:04:22,704 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - dff10fa6-63b0-417b-b8d5-289bb576cc54:group-FDD1AE029BC6:LeaderElection37: begin an election at term 1 for -1: [dff10fa6-63b0-417b-b8d5-289bb576cc54:192.168.46.58:46407], old=null
2019-06-13 12:04:22,704 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - dff10fa6-63b0-417b-b8d5-289bb576cc54: shutdown LeaderElection
2019-06-13 12:04:22,704 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - dff10fa6-63b0-417b-b8d5-289bb576cc54:group-FDD1AE029BC6 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:22,704 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - dff10fa6-63b0-417b-b8d5-289bb576cc54:group-FDD1AE029BC6 change Leader from null to dff10fa6-63b0-417b-b8d5-289bb576cc54 at term 1 for becomeLeader, leader elected after 1186ms
2019-06-13 12:04:22,704 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:22,704 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:22,704 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:22,704 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:22,704 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - dff10fa6-63b0-417b-b8d5-289bb576cc54: start LeaderState
2019-06-13 12:04:22,704 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - dff10fa6-63b0-417b-b8d5-289bb576cc54-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:22,705 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - dff10fa6-63b0-417b-b8d5-289bb576cc54:group-FDD1AE029BC6 set configuration 0: [dff10fa6-63b0-417b-b8d5-289bb576cc54:192.168.46.58:46407], old=null at 0
2019-06-13 12:04:22,741 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - dff10fa6-63b0-417b-b8d5-289bb576cc54-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-6/data/ratis/cb62f106-6f9b-404d-9ec1-fdd1ae029bc6/current/log_inprogress_0
2019-06-13 12:04:22,782 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1103, electionTimeout:1103ms
2019-06-13 12:04:22,782 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:22,782 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 16 for changeToCandidate
2019-06-13 12:04:22,782 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:22,784 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection38: begin an election at term 17 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:22,785 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection38 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:22,788 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection38 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:22,790 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection38: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t17, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:22,790 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:22,790 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:22,790 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 17 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:22,790 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:22,790 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:23,634 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-FA1A639FE6AD->2682a03f-c762-403c-bf4d-e604d8794fd4: receive RaftClientReply:client-FA1A639FE6AD->2682a03f-c762-403c-bf4d-e604d8794fd4@group-99EA735CF3EA, cid=47, FAILED org.apache.ratis.protocol.NotLeaderException: Server 2682a03f-c762-403c-bf4d-e604d8794fd4 is not the leader (8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471). Request must be sent to leader., logIndex=0, commits[2682a03f-c762-403c-bf4d-e604d8794fd4:c0, 8db082f8-c15c-4f53-9c89-7e502012b11b:c0, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:c0]
2019-06-13 12:04:23,639 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:23,843 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1052, electionTimeout:1052ms
2019-06-13 12:04:23,843 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:23,843 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 17 for changeToCandidate
2019-06-13 12:04:23,843 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:23,849 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection39: begin an election at term 18 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:23,852 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection39 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:23,855 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection39 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:23,858 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection39: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t18, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:23,858 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:23,858 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:23,858 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 18 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:23,858 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:23,858 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:24,691 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-FA1A639FE6AD->8db082f8-c15c-4f53-9c89-7e502012b11b: receive RaftClientReply:client-FA1A639FE6AD->8db082f8-c15c-4f53-9c89-7e502012b11b@group-99EA735CF3EA, cid=47, SUCCESS, logIndex=1, commits[8db082f8-c15c-4f53-9c89-7e502012b11b:c2, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:c1, 2682a03f-c762-403c-bf4d-e604d8794fd4:c1]
2019-06-13 12:04:24,695 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:04:24,695 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@2bf3ec4
2019-06-13 12:04:24,695 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:04:24,699 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:04:24,699 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: close
2019-06-13 12:04:24,699 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: shutdown group-1A98D85D1B92
2019-06-13 12:04:24,700 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-1A98D85D1B92,id=2682a03f-c762-403c-bf4d-e604d8794fd4
2019-06-13 12:04:24,700 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: shutdown LeaderState
2019-06-13 12:04:24,700 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 2682a03f-c762-403c-bf4d-e604d8794fd4-PendingRequests: sendNotLeaderResponses
2019-06-13 12:04:24,710 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-2682a03f-c762-403c-bf4d-e604d8794fd4-group-1A98D85D1B92: set stopIndex = 0
2019-06-13 12:04:24,710 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:04:24,710 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 2682a03f-c762-403c-bf4d-e604d8794fd4:group-1A98D85D1B92 closes. The last applied log index is 0
2019-06-13 12:04:24,710 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 2682a03f-c762-403c-bf4d-e604d8794fd4-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:24,714 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 2682a03f-c762-403c-bf4d-e604d8794fd4-RaftLogWorker close()
2019-06-13 12:04:24,718 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: shutdown group-99EA735CF3EA
2019-06-13 12:04:24,719 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-99EA735CF3EA,id=2682a03f-c762-403c-bf4d-e604d8794fd4
2019-06-13 12:04:24,719 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: shutdown FollowerState
2019-06-13 12:04:24,719 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-2682a03f-c762-403c-bf4d-e604d8794fd4-group-99EA735CF3EA: set stopIndex = 1
2019-06-13 12:04:24,719 INFO  impl.FollowerState (FollowerState.java:run(109)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:04:24,719 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:1)
2019-06-13 12:04:24,719 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-0/data/ratis/9231dbd4-1d69-4f33-8ff5-99ea735cf3ea/sm/snapshot.1_1
2019-06-13 12:04:24,719 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 2682a03f-c762-403c-bf4d-e604d8794fd4:group-99EA735CF3EA closes. The last applied log index is 1
2019-06-13 12:04:24,720 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 2682a03f-c762-403c-bf4d-e604d8794fd4-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:24,725 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 2682a03f-c762-403c-bf4d-e604d8794fd4-RaftLogWorker close()
2019-06-13 12:04:24,729 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: shutdown server with port 32871 now
2019-06-13 12:04:24,730 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:24,731 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 2682a03f-c762-403c-bf4d-e604d8794fd4: shutdown server with port 32871 successfully
2019-06-13 12:04:24,731 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: Failed appendEntries to 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-13 12:04:24,733 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 8db082f8-c15c-4f53-9c89-7e502012b11b->2682a03f-c762-403c-bf4d-e604d8794fd4: nextIndex: updateUnconditionally 3 -> 0
2019-06-13 12:04:24,735 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:04:24,756 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:04:24,756 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@7cca31fc{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:04:24,757 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@619c3546{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:04:24,758 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@3095d401{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:04:24,758 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@67b5e613{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:04:24,759 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:04:24,760 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@3b65084e
2019-06-13 12:04:24,760 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:04:24,760 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:04:24,761 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: close
2019-06-13 12:04:24,762 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: shutdown group-8B8B0F1A87B1
2019-06-13 12:04:24,762 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-8B8B0F1A87B1,id=8db082f8-c15c-4f53-9c89-7e502012b11b
2019-06-13 12:04:24,762 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: shutdown LeaderState
2019-06-13 12:04:24,762 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 8db082f8-c15c-4f53-9c89-7e502012b11b-PendingRequests: sendNotLeaderResponses
2019-06-13 12:04:24,765 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-8db082f8-c15c-4f53-9c89-7e502012b11b-group-8B8B0F1A87B1: set stopIndex = 0
2019-06-13 12:04:24,765 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:04:24,777 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 8db082f8-c15c-4f53-9c89-7e502012b11b:group-8B8B0F1A87B1 closes. The last applied log index is 0
2019-06-13 12:04:24,778 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 8db082f8-c15c-4f53-9c89-7e502012b11b-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:24,782 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 8db082f8-c15c-4f53-9c89-7e502012b11b-RaftLogWorker close()
2019-06-13 12:04:24,791 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: shutdown group-99EA735CF3EA
2019-06-13 12:04:24,792 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-99EA735CF3EA,id=8db082f8-c15c-4f53-9c89-7e502012b11b
2019-06-13 12:04:24,792 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: shutdown LeaderState
2019-06-13 12:04:24,792 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 8db082f8-c15c-4f53-9c89-7e502012b11b-PendingRequests: sendNotLeaderResponses
2019-06-13 12:04:24,792 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(8db082f8-c15c-4f53-9c89-7e502012b11b -> 2682a03f-c762-403c-bf4d-e604d8794fd4): Wait interrupted by java.lang.InterruptedException
2019-06-13 12:04:24,792 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(8db082f8-c15c-4f53-9c89-7e502012b11b -> 0d7c7125-8653-4c54-8389-e7d3e894c6b9): Wait interrupted by java.lang.InterruptedException
2019-06-13 12:04:24,795 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: appendEntries completed
2019-06-13 12:04:24,798 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: follower 8db082f8-c15c-4f53-9c89-7e502012b11b->0d7c7125-8653-4c54-8389-e7d3e894c6b9(c1,m2,n3, attendVote=true, lastRpcSendTime=149, lastRpcResponseTime=144) response Completed
2019-06-13 12:04:24,810 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 8db082f8-c15c-4f53-9c89-7e502012b11b->0d7c7125-8653-4c54-8389-e7d3e894c6b9: nextIndex: updateUnconditionally 3 -> 0
2019-06-13 12:04:24,813 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-8db082f8-c15c-4f53-9c89-7e502012b11b-group-99EA735CF3EA: set stopIndex = 2
2019-06-13 12:04:24,813 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-13 12:04:24,813 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-1/data/ratis/9231dbd4-1d69-4f33-8ff5-99ea735cf3ea/sm/snapshot.1_2
2019-06-13 12:04:24,815 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 8db082f8-c15c-4f53-9c89-7e502012b11b:group-99EA735CF3EA closes. The last applied log index is 2
2019-06-13 12:04:24,817 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 8db082f8-c15c-4f53-9c89-7e502012b11b-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:24,826 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 8db082f8-c15c-4f53-9c89-7e502012b11b-RaftLogWorker close()
2019-06-13 12:04:24,830 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: shutdown server with port 37471 now
2019-06-13 12:04:24,833 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 8db082f8-c15c-4f53-9c89-7e502012b11b: shutdown server with port 37471 successfully
2019-06-13 12:04:24,835 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:04:24,858 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:04:24,867 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@1aac0a47{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:04:24,867 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@190cacaa{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:04:24,868 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@74ce7fdf{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:04:24,868 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@640a8f93{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:04:24,950 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1091, electionTimeout:1091ms
2019-06-13 12:04:24,950 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:24,950 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 18 for changeToCandidate
2019-06-13 12:04:24,950 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:24,954 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection40: begin an election at term 19 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:24,957 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection40 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:24,964 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection40 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:24,967 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection40: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t19, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:24,967 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:24,968 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:24,968 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 19 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:24,968 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:24,968 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:25,884 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-FA1A639FE6AD->0d7c7125-8653-4c54-8389-e7d3e894c6b9@group-99EA735CF3EA, cid=48, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-FA1A639FE6AD->0d7c7125-8653-4c54-8389-e7d3e894c6b9@group-99EA735CF3EA, cid=48, FAILED org.apache.ratis.protocol.NotLeaderException: Server 0d7c7125-8653-4c54-8389-e7d3e894c6b9 is not the leader (8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471). Request must be sent to leader., logIndex=0, commits[0d7c7125-8653-4c54-8389-e7d3e894c6b9:c1, 8db082f8-c15c-4f53-9c89-7e502012b11b:c1, 2682a03f-c762-403c-bf4d-e604d8794fd4:c0]
2019-06-13 12:04:25,888 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-FA1A639FE6AD->0d7c7125-8653-4c54-8389-e7d3e894c6b9: receive RaftClientReply:client-FA1A639FE6AD->0d7c7125-8653-4c54-8389-e7d3e894c6b9@group-99EA735CF3EA, cid=48, FAILED org.apache.ratis.protocol.NotLeaderException: Server 0d7c7125-8653-4c54-8389-e7d3e894c6b9 is not the leader (8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471). Request must be sent to leader., logIndex=0, commits[0d7c7125-8653-4c54-8389-e7d3e894c6b9:c1, 8db082f8-c15c-4f53-9c89-7e502012b11b:c1, 2682a03f-c762-403c-bf4d-e604d8794fd4:c0]
2019-06-13 12:04:25,894 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-UnorderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:26,061 INFO  impl.FollowerState (FollowerState.java:run(101)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA changes to CANDIDATE, lastRpcTime:1407, electionTimeout:1094ms
2019-06-13 12:04:26,061 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: shutdown FollowerState
2019-06-13 12:04:26,061 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA changes role from FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2019-06-13 12:04:26,061 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: start LeaderElection
2019-06-13 12:04:26,062 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA change Leader from 8db082f8-c15c-4f53-9c89-7e502012b11b to null at term 1 for initElection
2019-06-13 12:04:26,067 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA:LeaderElection41: begin an election at term 2 for 0: [8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321, 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871], old=null
2019-06-13 12:04:26,069 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA:LeaderElection41 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:37471
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:26,073 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA:LeaderElection41 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:32871
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:26,076 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA:LeaderElection41: Election REJECTED; received 0 response(s) [] and 2 exception(s); 0d7c7125-8653-4c54-8389-e7d3e894c6b9:t2, leader=null, voted=0d7c7125-8653-4c54-8389-e7d3e894c6b9, raftlog=0d7c7125-8653-4c54-8389-e7d3e894c6b9-SegmentedRaftLog:OPENED:c1,f2,i2, conf=0: [8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321, 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871], old=null
2019-06-13 12:04:26,076 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:37471
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:26,077 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:32871
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:26,077 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA changes role from CANDIDATE to FOLLOWER at term 2 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:26,077 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: shutdown LeaderElection
2019-06-13 12:04:26,077 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: start FollowerState
2019-06-13 12:04:26,133 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1165, electionTimeout:1165ms
2019-06-13 12:04:26,133 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:26,133 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 19 for changeToCandidate
2019-06-13 12:04:26,134 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:26,137 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection42: begin an election at term 20 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:26,139 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection42 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:26,143 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection42 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:26,164 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection42: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t20, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:26,165 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:26,165 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:26,165 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 20 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:26,165 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:26,166 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:27,140 INFO  impl.FollowerState (FollowerState.java:run(101)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA changes to CANDIDATE, lastRpcTime:1063, electionTimeout:1063ms
2019-06-13 12:04:27,140 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: shutdown FollowerState
2019-06-13 12:04:27,140 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA changes role from FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2019-06-13 12:04:27,141 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: start LeaderElection
2019-06-13 12:04:27,194 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1027, electionTimeout:1027ms
2019-06-13 12:04:27,194 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:27,194 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 20 for changeToCandidate
2019-06-13 12:04:27,194 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:27,251 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA:LeaderElection43: begin an election at term 3 for 0: [8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321, 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871], old=null
2019-06-13 12:04:27,252 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection44: begin an election at term 21 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:27,252 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA:LeaderElection43 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:37471
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:27,252 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA:LeaderElection43 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:32871
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:27,253 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection44 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:27,253 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA:LeaderElection43: Election REJECTED; received 0 response(s) [] and 2 exception(s); 0d7c7125-8653-4c54-8389-e7d3e894c6b9:t3, leader=null, voted=0d7c7125-8653-4c54-8389-e7d3e894c6b9, raftlog=0d7c7125-8653-4c54-8389-e7d3e894c6b9-SegmentedRaftLog:OPENED:c1,f2,i2, conf=0: [8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321, 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871], old=null
2019-06-13 12:04:27,253 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection44 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:27,253 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:37471
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:27,253 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection44: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t21, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:27,253 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:32871
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:27,254 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:27,254 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA changes role from CANDIDATE to FOLLOWER at term 3 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:27,254 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:27,254 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: shutdown LeaderElection
2019-06-13 12:04:27,254 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 21 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:27,254 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: start FollowerState
2019-06-13 12:04:27,254 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:27,255 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:27,873 WARN  scm.XceiverClientRatis (XceiverClientRatis.java:watchForCommit(260)) - 3 way commit failed 
java.util.concurrent.TimeoutException
	at java.util.concurrent.CompletableFuture.timedGet(CompletableFuture.java:1771)
	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1915)
	at org.apache.hadoop.hdds.scm.XceiverClientRatis.watchForCommit(XceiverClientRatis.java:257)
	at org.apache.hadoop.ozone.client.rpc.TestWatchForCommit.testWatchForCommitWithSmallerTimeoutValue(TestWatchForCommit.java:307)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2019-06-13 12:04:27,877 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-FA1A639FE6AD->0d7c7125-8653-4c54-8389-e7d3e894c6b9@group-99EA735CF3EA, cid=49, seq=0, Watch-MAJORITY_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-FA1A639FE6AD->0d7c7125-8653-4c54-8389-e7d3e894c6b9@group-99EA735CF3EA, cid=49, FAILED org.apache.ratis.protocol.NotLeaderException: Server 0d7c7125-8653-4c54-8389-e7d3e894c6b9 is not the leader (2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871). Request must be sent to leader., logIndex=0, commits[0d7c7125-8653-4c54-8389-e7d3e894c6b9:c1, 8db082f8-c15c-4f53-9c89-7e502012b11b:c1, 2682a03f-c762-403c-bf4d-e604d8794fd4:c0]
2019-06-13 12:04:27,881 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-FA1A639FE6AD->0d7c7125-8653-4c54-8389-e7d3e894c6b9: receive RaftClientReply:client-FA1A639FE6AD->0d7c7125-8653-4c54-8389-e7d3e894c6b9@group-99EA735CF3EA, cid=49, FAILED org.apache.ratis.protocol.NotLeaderException: Server 0d7c7125-8653-4c54-8389-e7d3e894c6b9 is not the leader (2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871). Request must be sent to leader., logIndex=0, commits[0d7c7125-8653-4c54-8389-e7d3e894c6b9:c1, 8db082f8-c15c-4f53-9c89-7e502012b11b:c1, 2682a03f-c762-403c-bf4d-e604d8794fd4:c0]
2019-06-13 12:04:27,887 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 2-UnorderedRequestStreamObserver2: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:28,324 INFO  impl.FollowerState (FollowerState.java:run(101)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA changes to CANDIDATE, lastRpcTime:1069, electionTimeout:1069ms
2019-06-13 12:04:28,324 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: shutdown FollowerState
2019-06-13 12:04:28,324 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA changes role from FOLLOWER to CANDIDATE at term 3 for changeToCandidate
2019-06-13 12:04:28,324 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: start LeaderElection
2019-06-13 12:04:28,332 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA:LeaderElection45: begin an election at term 4 for 0: [8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321, 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871], old=null
2019-06-13 12:04:28,332 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA:LeaderElection45 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:37471
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:28,333 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA:LeaderElection45 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:32871
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:28,333 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1078, electionTimeout:1078ms
2019-06-13 12:04:28,333 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA:LeaderElection45: Election REJECTED; received 0 response(s) [] and 2 exception(s); 0d7c7125-8653-4c54-8389-e7d3e894c6b9:t4, leader=null, voted=0d7c7125-8653-4c54-8389-e7d3e894c6b9, raftlog=0d7c7125-8653-4c54-8389-e7d3e894c6b9-SegmentedRaftLog:OPENED:c1,f2,i2, conf=0: [8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321, 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871], old=null
2019-06-13 12:04:28,333 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:28,333 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:37471
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:28,333 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 21 for changeToCandidate
2019-06-13 12:04:28,333 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:32871
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:28,334 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA changes role from CANDIDATE to FOLLOWER at term 4 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:28,334 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:28,334 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: shutdown LeaderElection
2019-06-13 12:04:28,334 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: start FollowerState
2019-06-13 12:04:28,337 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection46: begin an election at term 22 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:28,338 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection46 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:28,338 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection46 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:28,338 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection46: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t22, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:28,338 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:28,338 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:28,338 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 22 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:28,339 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:28,339 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:29,464 INFO  impl.FollowerState (FollowerState.java:run(101)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA changes to CANDIDATE, lastRpcTime:1129, electionTimeout:1129ms
2019-06-13 12:04:29,464 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: shutdown FollowerState
2019-06-13 12:04:29,464 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA changes role from FOLLOWER to CANDIDATE at term 4 for changeToCandidate
2019-06-13 12:04:29,464 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: start LeaderElection
2019-06-13 12:04:29,472 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA:LeaderElection47: begin an election at term 5 for 0: [8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321, 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871], old=null
2019-06-13 12:04:29,473 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA:LeaderElection47 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:37471
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:29,473 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA:LeaderElection47 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:32871
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:29,474 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA:LeaderElection47: Election REJECTED; received 0 response(s) [] and 2 exception(s); 0d7c7125-8653-4c54-8389-e7d3e894c6b9:t5, leader=null, voted=0d7c7125-8653-4c54-8389-e7d3e894c6b9, raftlog=0d7c7125-8653-4c54-8389-e7d3e894c6b9-SegmentedRaftLog:OPENED:c1,f2,i2, conf=0: [8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321, 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871], old=null
2019-06-13 12:04:29,474 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:37471
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:29,474 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:32871
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:29,474 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA changes role from CANDIDATE to FOLLOWER at term 5 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:29,474 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: shutdown LeaderElection
2019-06-13 12:04:29,474 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: start FollowerState
2019-06-13 12:04:29,532 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1193, electionTimeout:1193ms
2019-06-13 12:04:29,532 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:29,532 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 22 for changeToCandidate
2019-06-13 12:04:29,532 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:29,536 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection48: begin an election at term 23 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:29,537 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection48 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:29,538 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection48 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:29,538 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection48: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t23, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:29,538 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:29,538 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:29,539 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 23 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:29,539 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:29,539 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:29,901 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-FA1A639FE6AD->0d7c7125-8653-4c54-8389-e7d3e894c6b9@group-99EA735CF3EA, cid=49, seq=0, Watch-MAJORITY_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-FA1A639FE6AD->0d7c7125-8653-4c54-8389-e7d3e894c6b9@group-99EA735CF3EA, cid=49, FAILED org.apache.ratis.protocol.NotLeaderException: Server 0d7c7125-8653-4c54-8389-e7d3e894c6b9 is not the leader (8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471). Request must be sent to leader., logIndex=0, commits[0d7c7125-8653-4c54-8389-e7d3e894c6b9:c1, 8db082f8-c15c-4f53-9c89-7e502012b11b:c1, 2682a03f-c762-403c-bf4d-e604d8794fd4:c0]
2019-06-13 12:04:29,905 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-FA1A639FE6AD->0d7c7125-8653-4c54-8389-e7d3e894c6b9: receive RaftClientReply:client-FA1A639FE6AD->0d7c7125-8653-4c54-8389-e7d3e894c6b9@group-99EA735CF3EA, cid=49, FAILED org.apache.ratis.protocol.NotLeaderException: Server 0d7c7125-8653-4c54-8389-e7d3e894c6b9 is not the leader (8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471). Request must be sent to leader., logIndex=0, commits[0d7c7125-8653-4c54-8389-e7d3e894c6b9:c1, 8db082f8-c15c-4f53-9c89-7e502012b11b:c1, 2682a03f-c762-403c-bf4d-e604d8794fd4:c0]
2019-06-13 12:04:29,913 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 3-UnorderedRequestStreamObserver3: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:30,540 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1001, electionTimeout:1001ms
2019-06-13 12:04:30,540 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:30,540 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 23 for changeToCandidate
2019-06-13 12:04:30,540 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:30,547 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection49: begin an election at term 24 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:30,549 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection49 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:30,550 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection49 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:30,550 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection49: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t24, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:30,550 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:30,550 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:30,551 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 24 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:30,551 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:30,551 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:30,613 INFO  impl.FollowerState (FollowerState.java:run(101)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA changes to CANDIDATE, lastRpcTime:1138, electionTimeout:1138ms
2019-06-13 12:04:30,613 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: shutdown FollowerState
2019-06-13 12:04:30,613 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA changes role from FOLLOWER to CANDIDATE at term 5 for changeToCandidate
2019-06-13 12:04:30,613 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: start LeaderElection
2019-06-13 12:04:30,616 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA:LeaderElection50: begin an election at term 6 for 0: [8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321, 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871], old=null
2019-06-13 12:04:30,617 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA:LeaderElection50 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:37471
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:30,617 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA:LeaderElection50 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:32871
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:30,617 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA:LeaderElection50: Election REJECTED; received 0 response(s) [] and 2 exception(s); 0d7c7125-8653-4c54-8389-e7d3e894c6b9:t6, leader=null, voted=0d7c7125-8653-4c54-8389-e7d3e894c6b9, raftlog=0d7c7125-8653-4c54-8389-e7d3e894c6b9-SegmentedRaftLog:OPENED:c1,f2,i2, conf=0: [8db082f8-c15c-4f53-9c89-7e502012b11b:192.168.46.58:37471, 0d7c7125-8653-4c54-8389-e7d3e894c6b9:192.168.46.58:40321, 2682a03f-c762-403c-bf4d-e604d8794fd4:192.168.46.58:32871], old=null
2019-06-13 12:04:30,617 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:37471
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:30,617 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:32871
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:30,617 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA changes role from CANDIDATE to FOLLOWER at term 6 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:30,617 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: shutdown LeaderElection
2019-06-13 12:04:30,618 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: start FollowerState
2019-06-13 12:04:30,878 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:shutdown(321)) - Shutting down the Mini Ozone Cluster
2019-06-13 12:04:30,878 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(336)) - Stopping the Mini Ozone Cluster
2019-06-13 12:04:30,878 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(338)) - Stopping the OzoneManager
2019-06-13 12:04:30,878 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 41479
2019-06-13 12:04:30,896 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service KeyDeletingService
2019-06-13 12:04:30,896 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 41479
2019-06-13 12:04:30,897 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-13 12:04:30,899 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@27dbaa33{/,null,UNAVAILABLE}{/ozoneManager}
2019-06-13 12:04:30,899 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@15d65fcf{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:04:30,900 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@59b447a4{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,UNAVAILABLE}
2019-06-13 12:04:30,900 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@6e9a10cd{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:04:30,902 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(344)) - Stopping the StorageContainerManager
2019-06-13 12:04:30,902 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(789)) - Stopping Replication Manager Service.
2019-06-13 12:04:30,902 INFO  container.ReplicationManager (ReplicationManager.java:stop(191)) - Replication Monitor Thread is not running.
2019-06-13 12:04:30,902 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(796)) - Stopping Lease Manager of the command watchers
2019-06-13 12:04:30,903 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(803)) - Stopping datanode service RPC server
2019-06-13 12:04:30,903 INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(373)) - Stopping the RPC server for DataNodes
2019-06-13 12:04:30,903 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 41225
2019-06-13 12:04:30,907 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 41225
2019-06-13 12:04:30,907 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-13 12:04:30,907 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(811)) - Stopping block service RPC server
2019-06-13 12:04:30,909 INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(145)) - Stopping the RPC server for Block Protocol
2019-06-13 12:04:30,909 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 43731
2019-06-13 12:04:30,912 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 43731
2019-06-13 12:04:30,912 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(818)) - Stopping the StorageContainerLocationProtocol RPC server
2019-06-13 12:04:30,913 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-13 12:04:30,914 INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(157)) - Stopping the RPC server for Client Protocol
2019-06-13 12:04:30,914 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 38343
2019-06-13 12:04:30,921 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 38343
2019-06-13 12:04:30,921 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(825)) - Stopping Storage Container Manager HTTP server.
2019-06-13 12:04:30,925 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-13 12:04:30,926 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@3be80ece{/,null,UNAVAILABLE}{/scm}
2019-06-13 12:04:30,928 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@60a01cb{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:04:30,928 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@2f86f9cf{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,UNAVAILABLE}
2019-06-13 12:04:30,929 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@3b39e79b{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:04:30,929 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(836)) - Stopping Block Manager Service.
2019-06-13 12:04:30,929 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service SCMBlockDeletingService
2019-06-13 12:04:30,930 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service SCMBlockDeletingService
2019-06-13 12:04:30,930 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(858)) - Stopping SCM Event Queue.
2019-06-13 12:04:30,934 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(350)) - Shutting the HddsDatanodes
2019-06-13 12:04:30,934 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:04:30,934 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@1cc93da4
2019-06-13 12:04:30,934 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:04:30,936 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:04:30,936 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: close
2019-06-13 12:04:30,936 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: shutdown group-781B894A3563
2019-06-13 12:04:30,936 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-781B894A3563,id=0d7c7125-8653-4c54-8389-e7d3e894c6b9
2019-06-13 12:04:30,936 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: shutdown LeaderState
2019-06-13 12:04:30,937 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9-PendingRequests: sendNotLeaderResponses
2019-06-13 12:04:30,940 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-0d7c7125-8653-4c54-8389-e7d3e894c6b9-group-781B894A3563: set stopIndex = 0
2019-06-13 12:04:30,941 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:04:30,941 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-781B894A3563 closes. The last applied log index is 0
2019-06-13 12:04:30,941 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:30,944 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9-RaftLogWorker close()
2019-06-13 12:04:30,948 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: shutdown group-99EA735CF3EA
2019-06-13 12:04:30,948 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-99EA735CF3EA,id=0d7c7125-8653-4c54-8389-e7d3e894c6b9
2019-06-13 12:04:30,949 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: shutdown FollowerState
2019-06-13 12:04:30,954 INFO  impl.FollowerState (FollowerState.java:run(109)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:04:30,954 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:1)
2019-06-13 12:04:30,954 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ef86a753-d06c-46bc-9a1e-72091e638a89/datanode-2/data/ratis/9231dbd4-1d69-4f33-8ff5-99ea735cf3ea/sm/snapshot.1_1
2019-06-13 12:04:30,955 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-0d7c7125-8653-4c54-8389-e7d3e894c6b9-group-99EA735CF3EA: set stopIndex = 1
2019-06-13 12:04:30,955 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9:group-99EA735CF3EA closes. The last applied log index is 1
2019-06-13 12:04:30,957 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:30,960 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9-RaftLogWorker close()
2019-06-13 12:04:30,972 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: shutdown server with port 40321 now
2019-06-13 12:04:30,976 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 0d7c7125-8653-4c54-8389-e7d3e894c6b9: shutdown server with port 40321 successfully
2019-06-13 12:04:30,994 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:04:31,010 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:04:31,010 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@56f9de3b{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:04:31,011 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@6728370a{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:04:31,011 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@11bdab37{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:04:31,012 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@1a7d0c9f{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:04:31,012 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:04:31,013 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@160c7c42
2019-06-13 12:04:31,013 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:04:31,013 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:04:31,014 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: close
2019-06-13 12:04:31,014 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: shutdown group-3042EA367800
2019-06-13 12:04:31,014 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-3042EA367800,id=997cd3e4-2dc3-465f-9ba2-a60765f1809f
2019-06-13 12:04:31,014 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: shutdown LeaderState
2019-06-13 12:04:31,015 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f-PendingRequests: sendNotLeaderResponses
2019-06-13 12:04:31,015 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-997cd3e4-2dc3-465f-9ba2-a60765f1809f-group-3042EA367800: set stopIndex = 0
2019-06-13 12:04:31,015 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:04:31,015 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f:group-3042EA367800 closes. The last applied log index is 0
2019-06-13 12:04:31,016 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:31,017 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f-RaftLogWorker close()
2019-06-13 12:04:31,019 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: shutdown group-D2EDF6CA370A
2019-06-13 12:04:31,019 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D2EDF6CA370A,id=997cd3e4-2dc3-465f-9ba2-a60765f1809f
2019-06-13 12:04:31,019 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: shutdown FollowerState
2019-06-13 12:04:31,020 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-997cd3e4-2dc3-465f-9ba2-a60765f1809f-group-D2EDF6CA370A: set stopIndex = 0
2019-06-13 12:04:31,020 INFO  impl.FollowerState (FollowerState.java:run(109)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:04:31,020 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:04:31,020 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f:group-D2EDF6CA370A closes. The last applied log index is 0
2019-06-13 12:04:31,020 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:31,022 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f-RaftLogWorker close()
2019-06-13 12:04:31,023 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: shutdown server with port 39979 now
2019-06-13 12:04:31,024 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:31,024 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 997cd3e4-2dc3-465f-9ba2-a60765f1809f: shutdown server with port 39979 successfully
2019-06-13 12:04:31,024 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - d35b2b35-132a-43df-be94-eee7b24b01a8: Failed appendEntries to 997cd3e4-2dc3-465f-9ba2-a60765f1809f:192.168.46.58:39979: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-13 12:04:31,025 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - d35b2b35-132a-43df-be94-eee7b24b01a8->997cd3e4-2dc3-465f-9ba2-a60765f1809f: nextIndex: updateUnconditionally 1 -> 0
2019-06-13 12:04:31,027 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:04:31,038 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - d35b2b35-132a-43df-be94-eee7b24b01a8: Failed appendEntries to 997cd3e4-2dc3-465f-9ba2-a60765f1809f:192.168.46.58:39979: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:04:31,041 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - d35b2b35-132a-43df-be94-eee7b24b01a8->997cd3e4-2dc3-465f-9ba2-a60765f1809f: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:04:31,047 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:04:31,048 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@3ea84e01{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:04:31,048 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@6eb3f4c2{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:04:31,049 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@19647566{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:04:31,049 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@2e40fdbd{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:04:31,050 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:04:31,050 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@2444c3df
2019-06-13 12:04:31,050 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:04:31,051 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:04:31,051 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: close
2019-06-13 12:04:31,051 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: shutdown group-D2EDF6CA370A
2019-06-13 12:04:31,051 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: shutdown group-F14C640D7B93
2019-06-13 12:04:31,052 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-F14C640D7B93,id=4ecadeec-2c92-46ff-b057-42e40bec0a7d
2019-06-13 12:04:31,052 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: shutdown LeaderState
2019-06-13 12:04:31,052 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d-PendingRequests: sendNotLeaderResponses
2019-06-13 12:04:31,052 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-4ecadeec-2c92-46ff-b057-42e40bec0a7d-group-F14C640D7B93: set stopIndex = 0
2019-06-13 12:04:31,051 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D2EDF6CA370A,id=4ecadeec-2c92-46ff-b057-42e40bec0a7d
2019-06-13 12:04:31,052 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: shutdown FollowerState
2019-06-13 12:04:31,052 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:04:31,053 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:04:31,053 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d:group-F14C640D7B93 closes. The last applied log index is 0
2019-06-13 12:04:31,053 INFO  impl.FollowerState (FollowerState.java:run(109)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:04:31,053 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-4ecadeec-2c92-46ff-b057-42e40bec0a7d-group-D2EDF6CA370A: set stopIndex = 0
2019-06-13 12:04:31,053 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:31,053 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d:group-D2EDF6CA370A closes. The last applied log index is 0
2019-06-13 12:04:31,055 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d-RaftLogWorker close()
2019-06-13 12:04:31,057 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:31,059 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d-RaftLogWorker close()
2019-06-13 12:04:31,061 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: shutdown server with port 32845 now
2019-06-13 12:04:31,062 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: shutdown server with port 32845 successfully
2019-06-13 12:04:31,062 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - d35b2b35-132a-43df-be94-eee7b24b01a8: Failed appendEntries to 4ecadeec-2c92-46ff-b057-42e40bec0a7d:192.168.46.58:32845: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-13 12:04:31,063 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - 4ecadeec-2c92-46ff-b057-42e40bec0a7d: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:31,063 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - d35b2b35-132a-43df-be94-eee7b24b01a8->4ecadeec-2c92-46ff-b057-42e40bec0a7d: nextIndex: updateUnconditionally 1 -> 0
2019-06-13 12:04:31,065 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:04:31,079 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - d35b2b35-132a-43df-be94-eee7b24b01a8: Failed appendEntries to 4ecadeec-2c92-46ff-b057-42e40bec0a7d:192.168.46.58:32845: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:04:31,083 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - d35b2b35-132a-43df-be94-eee7b24b01a8->4ecadeec-2c92-46ff-b057-42e40bec0a7d: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:04:31,085 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:04:31,086 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@40c28b0d{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:04:31,086 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@cf984d9{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:04:31,087 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@2e3900dc{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:04:31,087 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@69c33ea2{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:04:31,088 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:04:31,089 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@c1a74d
2019-06-13 12:04:31,089 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:04:31,089 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:04:31,089 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - d35b2b35-132a-43df-be94-eee7b24b01a8: close
2019-06-13 12:04:31,090 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - d35b2b35-132a-43df-be94-eee7b24b01a8: shutdown group-D2EDF6CA370A
2019-06-13 12:04:31,090 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - d35b2b35-132a-43df-be94-eee7b24b01a8: shutdown group-F88AA51E54CA
2019-06-13 12:04:31,090 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-F88AA51E54CA,id=d35b2b35-132a-43df-be94-eee7b24b01a8
2019-06-13 12:04:31,090 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - d35b2b35-132a-43df-be94-eee7b24b01a8: shutdown LeaderState
2019-06-13 12:04:31,090 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - d35b2b35-132a-43df-be94-eee7b24b01a8-PendingRequests: sendNotLeaderResponses
2019-06-13 12:04:31,090 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-d35b2b35-132a-43df-be94-eee7b24b01a8-group-F88AA51E54CA: set stopIndex = 0
2019-06-13 12:04:31,090 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:04:31,090 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D2EDF6CA370A,id=d35b2b35-132a-43df-be94-eee7b24b01a8
2019-06-13 12:04:31,091 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - d35b2b35-132a-43df-be94-eee7b24b01a8:group-F88AA51E54CA closes. The last applied log index is 0
2019-06-13 12:04:31,091 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - d35b2b35-132a-43df-be94-eee7b24b01a8: shutdown LeaderState
2019-06-13 12:04:31,091 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - d35b2b35-132a-43df-be94-eee7b24b01a8-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:31,091 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(d35b2b35-132a-43df-be94-eee7b24b01a8 -> 997cd3e4-2dc3-465f-9ba2-a60765f1809f): Wait interrupted by java.lang.InterruptedException
2019-06-13 12:04:31,092 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - d35b2b35-132a-43df-be94-eee7b24b01a8-RaftLogWorker close()
2019-06-13 12:04:31,093 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - d35b2b35-132a-43df-be94-eee7b24b01a8-PendingRequests: sendNotLeaderResponses
2019-06-13 12:04:31,093 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(d35b2b35-132a-43df-be94-eee7b24b01a8 -> 4ecadeec-2c92-46ff-b057-42e40bec0a7d): Wait interrupted by java.lang.InterruptedException
2019-06-13 12:04:31,093 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-d35b2b35-132a-43df-be94-eee7b24b01a8-group-D2EDF6CA370A: set stopIndex = 0
2019-06-13 12:04:31,094 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:04:31,095 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - d35b2b35-132a-43df-be94-eee7b24b01a8:group-D2EDF6CA370A closes. The last applied log index is 0
2019-06-13 12:04:31,095 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - d35b2b35-132a-43df-be94-eee7b24b01a8-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:31,097 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - d35b2b35-132a-43df-be94-eee7b24b01a8-RaftLogWorker close()
2019-06-13 12:04:31,099 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - d35b2b35-132a-43df-be94-eee7b24b01a8: shutdown server with port 44637 now
2019-06-13 12:04:31,100 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - d35b2b35-132a-43df-be94-eee7b24b01a8: shutdown server with port 44637 successfully
2019-06-13 12:04:31,102 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:04:31,118 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:04:31,119 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@1a66be41{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:04:31,120 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@7f70e244{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:04:31,122 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@55c46ec1{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:04:31,122 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@3f1d6a13{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:04:31,124 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:04:31,124 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@29b5e7db
2019-06-13 12:04:31,124 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:04:31,125 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:04:31,125 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - dff10fa6-63b0-417b-b8d5-289bb576cc54: close
2019-06-13 12:04:31,125 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - dff10fa6-63b0-417b-b8d5-289bb576cc54: shutdown group-FDD1AE029BC6
2019-06-13 12:04:31,125 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-FDD1AE029BC6,id=dff10fa6-63b0-417b-b8d5-289bb576cc54
2019-06-13 12:04:31,125 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - dff10fa6-63b0-417b-b8d5-289bb576cc54: shutdown LeaderState
2019-06-13 12:04:31,126 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - dff10fa6-63b0-417b-b8d5-289bb576cc54-PendingRequests: sendNotLeaderResponses
2019-06-13 12:04:31,126 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-dff10fa6-63b0-417b-b8d5-289bb576cc54-group-FDD1AE029BC6: set stopIndex = 0
2019-06-13 12:04:31,126 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:04:31,126 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - dff10fa6-63b0-417b-b8d5-289bb576cc54:group-FDD1AE029BC6 closes. The last applied log index is 0
2019-06-13 12:04:31,127 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - dff10fa6-63b0-417b-b8d5-289bb576cc54-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:31,131 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - dff10fa6-63b0-417b-b8d5-289bb576cc54-RaftLogWorker close()
2019-06-13 12:04:31,132 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - dff10fa6-63b0-417b-b8d5-289bb576cc54: shutdown server with port 46407 now
2019-06-13 12:04:31,134 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - dff10fa6-63b0-417b-b8d5-289bb576cc54: shutdown server with port 46407 successfully
2019-06-13 12:04:31,135 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:04:31,147 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:04:31,147 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@18692e80{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:04:31,148 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@779b4f9c{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:04:31,148 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@5fb514c2{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:04:31,148 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@2474df51{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:04:31,179 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:31,186 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:31,186 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:31,187 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedBlocks
2019-06-13 12:04:31,187 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedBlocks
2019-06-13 12:04:31,187 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: validCerts
2019-06-13 12:04:31,187 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:validCerts
2019-06-13 12:04:31,188 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: revokedCerts
2019-06-13 12:04:31,188 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:revokedCerts
2019-06-13 12:04:31,188 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-13 12:04:31,188 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-13 12:04:31,188 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-13 12:04:31,228 WARN  server.ServerUtils (ServerUtils.java:sanitizeUserArgs(70)) - ozone.scm.stale.node.interval value = 300000 is larger than max = 100000 based on the key value of ozone.scm.heartbeat.thread.interval, reset to the max value 100000.
2019-06-13 12:04:31,229 WARN  server.ServerUtils (ServerUtils.java:sanitizeUserArgs(70)) - ozone.scm.stale.node.interval value = 300000 is larger than max = 100000 based on the key value of ozone.scm.heartbeat.thread.interval, reset to the max value 100000.
2019-06-13 12:04:31,229 INFO  node.SCMNodeManager (SCMNodeManager.java:<init>(108)) - Entering startup safe mode.
2019-06-13 12:04:31,230 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(125)) - Loading file from sun.misc.CompoundEnumeration@35ff072c
2019-06-13 12:04:31,230 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(171)) - Loading network topology layer schema file
2019-06-13 12:04:31,233 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:31,246 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:initializePipelineState(126)) - No pipeline exists in current db
2019-06-13 12:04:31,247 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:31,262 WARN  events.EventQueue (EventQueue.java:fireEvent(175)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='SafeModeStatus'}
2019-06-13 12:04:31,263 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-13 12:04:31,263 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 33015
2019-06-13 12:04:31,279 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-13 12:04:31,280 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 43307
2019-06-13 12:04:31,281 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-13 12:04:31,282 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 42723
2019-06-13 12:04:31,285 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for scm at: http://0.0.0.0:0
2019-06-13 12:04:31,287 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:31,287 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:31,289 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:31,289 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context scm
2019-06-13 12:04:31,290 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:31,290 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:31,294 INFO  server.StorageContainerManager (StorageContainerManager.java:start(752)) - StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:42723
2019-06-13 12:04:31,295 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - StorageContainerManager metrics system started (again)
2019-06-13 12:04:31,295 INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:start(149)) - RPC server for Client  is listening at /0.0.0.0:42723
2019-06-13 12:04:31,296 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-13 12:04:31,296 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 42723: starting
2019-06-13 12:04:31,321 INFO  server.StorageContainerManager (StorageContainerManager.java:start(761)) - ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:43307
2019-06-13 12:04:31,322 INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:start(137)) - RPC server for Block Protocol is listening at /0.0.0.0:43307
2019-06-13 12:04:31,322 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-13 12:04:31,327 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 43307: starting
2019-06-13 12:04:31,335 INFO  server.StorageContainerManager (StorageContainerManager.java:start(765)) - ScmDatanodeProtocl RPC server is listening at /0.0.0.0:33015
2019-06-13 12:04:31,335 INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:start(191)) - RPC server for DataNodes is listening at /0.0.0.0:33015
2019-06-13 12:04:31,335 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-13 12:04:31,336 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 33015: starting
2019-06-13 12:04:31,340 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 38775
2019-06-13 12:04:31,340 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:04:31,342 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@50b38342{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:04:31,342 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@408d945b{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-13 12:04:31,347 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@5e360c3b{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/scm/,AVAILABLE}{/scm}
2019-06-13 12:04:31,347 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@24ac6fef{HTTP/1.1,[http/1.1]}{0.0.0.0:38775}
2019-06-13 12:04:31,349 INFO  server.Server (Server.java:doStart(419)) - Started @40569ms
2019-06-13 12:04:31,349 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of SCM is listening at http://0.0.0.0:38775
2019-06-13 12:04:31,351 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:31,351 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:04:31,354 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:31,355 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(519)) - OM Service ID is not set. Setting it to the default ID: omServiceIdDefault
2019-06-13 12:04:31,355 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(525)) - OM Node ID is not set. Setting it to the OmStorage's OmID: d97d19df-8002-43a9-b1cf-e92c52223153
2019-06-13 12:04:31,355 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 12:04:31,355 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 12:04:31,356 INFO  om.OzoneManager (OzoneManager.java:loadOMHAConfigs(476)) - Found matching OM address with OMServiceId: null, OMNodeId: null, RPC Address: localhost:0 and Ratis port: 9872
2019-06-13 12:04:31,362 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:31,362 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: userTable
2019-06-13 12:04:31,362 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:userTable
2019-06-13 12:04:31,362 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: volumeTable
2019-06-13 12:04:31,362 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:volumeTable
2019-06-13 12:04:31,362 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: bucketTable
2019-06-13 12:04:31,362 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:bucketTable
2019-06-13 12:04:31,363 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: keyTable
2019-06-13 12:04:31,363 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:keyTable
2019-06-13 12:04:31,363 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedTable
2019-06-13 12:04:31,363 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedTable
2019-06-13 12:04:31,363 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: openKeyTable
2019-06-13 12:04:31,363 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:openKeyTable
2019-06-13 12:04:31,363 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3Table
2019-06-13 12:04:31,363 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3Table
2019-06-13 12:04:31,364 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: multipartInfoTable
2019-06-13 12:04:31,364 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:multipartInfoTable
2019-06-13 12:04:31,364 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: dTokenTable
2019-06-13 12:04:31,364 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:dTokenTable
2019-06-13 12:04:31,364 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3SecretTable
2019-06-13 12:04:31,364 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3SecretTable
2019-06-13 12:04:31,364 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: prefixTable
2019-06-13 12:04:31,364 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:prefixTable
2019-06-13 12:04:31,364 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-13 12:04:31,365 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-13 12:04:31,365 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-13 12:04:31,524 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-13 12:04:31,524 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 39669
2019-06-13 12:04:31,549 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:31,549 INFO  om.OzoneManager (OzoneManager.java:start(1217)) - OzoneManager RPC server is listening at localhost/127.0.0.1:39669
2019-06-13 12:04:31,549 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - OzoneManager metrics system started (again)
2019-06-13 12:04:31,550 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-13 12:04:31,559 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 39669: starting
2019-06-13 12:04:31,572 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for ozoneManager at: http://0.0.0.0:0
2019-06-13 12:04:31,573 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:31,573 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:31,575 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:31,575 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context ozoneManager
2019-06-13 12:04:31,576 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:31,576 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:31,576 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 42603
2019-06-13 12:04:31,576 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:04:31,579 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@545f0b6{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:04:31,579 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@4888425d{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-13 12:04:31,582 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@4b511e61{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/ozoneManager/,AVAILABLE}{/ozoneManager}
2019-06-13 12:04:31,584 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@74a74070{HTTP/1.1,[http/1.1]}{0.0.0.0:42603}
2019-06-13 12:04:31,584 INFO  server.Server (Server.java:doStart(419)) - Started @40805ms
2019-06-13 12:04:31,584 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of OZONEMANAGER is listening at http://0.0.0.0:42603
2019-06-13 12:04:31,595 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:04:31,596 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:04:31,604 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-0/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:04:31,604 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-0/data/containers/hdds to VolumeSet
2019-06-13 12:04:31,604 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@ab4d2ba
2019-06-13 12:04:31,606 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@ab4d2ba
2019-06-13 12:04:31,617 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 38463
2019-06-13 12:04:31,621 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:04:31,622 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 38463 (custom)
2019-06-13 12:04:31,622 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:04:31,622 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:31,622 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:04:31,623 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:31,623 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-0/data/ratis] (custom)
2019-06-13 12:04:31,623 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42801
2019-06-13 12:04:31,624 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:04:31,625 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:04:31,626 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:31,626 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:31,627 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:31,628 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:04:31,628 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:31,628 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:31,629 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 37681
2019-06-13 12:04:31,629 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:04:31,638 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@73aae7a{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:04:31,638 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@2125535d{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:04:31,647 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1095, electionTimeout:1095ms
2019-06-13 12:04:31,647 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:31,647 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 24 for changeToCandidate
2019-06-13 12:04:31,647 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:31,656 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection51: begin an election at term 25 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:31,658 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection51 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:31,662 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection51 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:31,662 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection51: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t25, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:31,662 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:31,663 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:31,663 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 25 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:31,663 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:31,663 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:31,667 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@57afe44b{/,file:///tmp/jetty-0.0.0.0-37681-hddsDatanode-_-any-3291416758524311594.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:04:31,667 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@18887028{HTTP/1.1,[http/1.1]}{0.0.0.0:37681}
2019-06-13 12:04:31,667 INFO  server.Server (Server.java:doStart(419)) - Started @40888ms
2019-06-13 12:04:31,668 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:37681
Jun 13, 2019 12:04:31 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:04:31,794 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@595184d8
2019-06-13 12:04:31,795 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:04:31,795 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:04:31,811 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-1/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:04:31,812 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-1/data/containers/hdds to VolumeSet
2019-06-13 12:04:31,812 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@15f11bfb
2019-06-13 12:04:31,813 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:04:31,815 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@15f11bfb
2019-06-13 12:04:31,816 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-0/meta/datanode.id
2019-06-13 12:04:31,832 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 41371
2019-06-13 12:04:31,832 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:04:31,833 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 41371 (custom)
2019-06-13 12:04:31,833 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:04:31,833 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:31,833 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:04:31,833 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:31,834 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-1/data/ratis] (custom)
2019-06-13 12:04:31,834 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 46285
2019-06-13 12:04:31,835 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:04:31,836 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:04:31,849 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:31,850 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:31,851 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:31,851 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:04:31,851 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:31,852 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:31,852 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 43023
2019-06-13 12:04:31,852 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:04:31,862 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@74450c9b{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:04:31,862 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@5ad50b02{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:04:31,892 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@701c482e{/,file:///tmp/jetty-0.0.0.0-43023-hddsDatanode-_-any-2404639228748681481.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:04:31,893 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@4738131e{HTTP/1.1,[http/1.1]}{0.0.0.0:43023}
2019-06-13 12:04:31,897 INFO  server.Server (Server.java:doStart(419)) - Started @41118ms
2019-06-13 12:04:31,898 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:43023
Jun 13, 2019 12:04:31 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:04:32,139 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@58ac0823
2019-06-13 12:04:32,141 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:04:32,142 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:04:32,150 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:04:32,159 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-2/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:04:32,159 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-2/data/containers/hdds to VolumeSet
2019-06-13 12:04:32,159 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@55317c63
2019-06-13 12:04:32,162 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-1/meta/datanode.id
2019-06-13 12:04:32,164 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@55317c63
2019-06-13 12:04:32,187 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 35139
2019-06-13 12:04:32,188 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:04:32,188 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 35139 (custom)
2019-06-13 12:04:32,188 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:04:32,188 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:32,189 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:04:32,189 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:32,189 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-2/data/ratis] (custom)
2019-06-13 12:04:32,190 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 43013
2019-06-13 12:04:32,190 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:04:32,191 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:04:32,192 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:32,194 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:32,195 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:32,195 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:04:32,195 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:32,196 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:32,196 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 46701
2019-06-13 12:04:32,196 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:04:32,198 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@7736c41e{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:04:32,201 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@3de383f7{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:04:32,230 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@13f182b9{/,file:///tmp/jetty-0.0.0.0-46701-hddsDatanode-_-any-2615076926204371624.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:04:32,230 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@5ee0cf64{HTTP/1.1,[http/1.1]}{0.0.0.0:46701}
2019-06-13 12:04:32,230 INFO  server.Server (Server.java:doStart(419)) - Started @41451ms
2019-06-13 12:04:32,236 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:46701
Jun 13, 2019 12:04:32 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:04:32,316 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@29ee8174
2019-06-13 12:04:32,317 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:04:32,317 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:04:32,325 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:04:32,338 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-2/meta/datanode.id
2019-06-13 12:04:32,345 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-3/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:04:32,346 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-3/data/containers/hdds to VolumeSet
2019-06-13 12:04:32,346 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@14bf9fd0
2019-06-13 12:04:32,351 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@14bf9fd0
2019-06-13 12:04:32,360 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 44501
2019-06-13 12:04:32,361 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:04:32,362 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 44501 (custom)
2019-06-13 12:04:32,362 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:04:32,362 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:32,362 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:04:32,362 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:32,363 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-3/data/ratis] (custom)
2019-06-13 12:04:32,363 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 38569
2019-06-13 12:04:32,363 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:04:32,364 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:04:32,365 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:32,365 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:32,366 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:32,367 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:04:32,367 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:32,367 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:32,367 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 43883
2019-06-13 12:04:32,367 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:04:32,370 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@3605ab16{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:04:32,371 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@24d0c6a4{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:04:32,391 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@21ba0d33{/,file:///tmp/jetty-0.0.0.0-43883-hddsDatanode-_-any-236146223542250944.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:04:32,391 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@afb7b03{HTTP/1.1,[http/1.1]}{0.0.0.0:43883}
2019-06-13 12:04:32,393 INFO  server.Server (Server.java:doStart(419)) - Started @41614ms
2019-06-13 12:04:32,394 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:43883
Jun 13, 2019 12:04:32 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:04:32,495 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@31a4db4f
2019-06-13 12:04:32,495 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:04:32,496 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:04:32,499 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:04:32,513 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-3/meta/datanode.id
2019-06-13 12:04:32,516 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-4/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:04:32,517 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-4/data/containers/hdds to VolumeSet
2019-06-13 12:04:32,517 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@45753c22
2019-06-13 12:04:32,517 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@45753c22
2019-06-13 12:04:32,543 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 34875
2019-06-13 12:04:32,544 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:04:32,544 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 34875 (custom)
2019-06-13 12:04:32,545 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:04:32,545 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:32,545 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:04:32,545 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:32,546 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-4/data/ratis] (custom)
2019-06-13 12:04:32,546 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 36813
2019-06-13 12:04:32,546 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:04:32,547 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:04:32,548 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:32,549 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:32,550 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:32,550 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:04:32,550 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:32,551 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:32,551 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 46689
2019-06-13 12:04:32,551 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:04:32,562 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@2ae4c424{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:04:32,562 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@237aba92{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:04:32,593 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@35840ecc{/,file:///tmp/jetty-0.0.0.0-46689-hddsDatanode-_-any-858663902062574910.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:04:32,593 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@67fd2e17{HTTP/1.1,[http/1.1]}{0.0.0.0:46689}
2019-06-13 12:04:32,596 INFO  server.Server (Server.java:doStart(419)) - Started @41816ms
2019-06-13 12:04:32,596 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:46689
Jun 13, 2019 12:04:32 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:04:32,705 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@630c3af3
2019-06-13 12:04:32,706 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:04:32,706 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:04:32,710 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:04:32,711 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-4/meta/datanode.id
2019-06-13 12:04:32,721 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-5/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:04:32,721 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-5/data/containers/hdds to VolumeSet
2019-06-13 12:04:32,721 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@cfc4601
2019-06-13 12:04:32,724 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@cfc4601
2019-06-13 12:04:32,739 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 42811
2019-06-13 12:04:32,739 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:04:32,740 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42811 (custom)
2019-06-13 12:04:32,740 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:04:32,740 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:32,740 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:04:32,740 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:32,741 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-5/data/ratis] (custom)
2019-06-13 12:04:32,741 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 43729
2019-06-13 12:04:32,741 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:04:32,744 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:04:32,745 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:32,745 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:32,746 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:32,747 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:04:32,747 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:32,747 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:32,748 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 36081
2019-06-13 12:04:32,748 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:04:32,759 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1096, electionTimeout:1094ms
2019-06-13 12:04:32,759 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:32,759 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 25 for changeToCandidate
2019-06-13 12:04:32,761 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:32,762 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@416c1b0{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:04:32,763 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@60fe75f7{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:04:32,769 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection52: begin an election at term 26 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:32,770 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection52 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:32,770 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection52 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:32,770 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection52: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t26, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:32,771 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:32,771 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:32,771 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 26 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:32,771 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:32,771 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:32,789 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@7120daa6{/,file:///tmp/jetty-0.0.0.0-36081-hddsDatanode-_-any-2714940402372113585.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:04:32,789 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@6cbb6c41{HTTP/1.1,[http/1.1]}{0.0.0.0:36081}
2019-06-13 12:04:32,791 INFO  server.Server (Server.java:doStart(419)) - Started @42012ms
2019-06-13 12:04:32,792 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:36081
Jun 13, 2019 12:04:32 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:04:32,964 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@63c6c5e5
2019-06-13 12:04:32,965 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:04:32,966 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:04:33,015 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:04:33,017 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-6/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:04:33,018 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-6/data/containers/hdds to VolumeSet
2019-06-13 12:04:33,018 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@ea0c99c
2019-06-13 12:04:33,027 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@ea0c99c
2019-06-13 12:04:33,029 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-5/meta/datanode.id
2019-06-13 12:04:33,050 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 35245
2019-06-13 12:04:33,050 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:04:33,051 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 35245 (custom)
2019-06-13 12:04:33,051 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:04:33,051 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:33,051 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:04:33,051 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:33,052 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-6/data/ratis] (custom)
2019-06-13 12:04:33,052 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 43875
2019-06-13 12:04:33,053 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:04:33,062 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:04:33,064 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:33,075 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:33,079 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:33,079 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:04:33,079 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:33,080 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:33,080 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 33343
2019-06-13 12:04:33,080 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:04:33,108 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@1d3e5a05{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:04:33,109 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@52fec840{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:04:33,142 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@5300694d{/,file:///tmp/jetty-0.0.0.0-33343-hddsDatanode-_-any-6501979287194980206.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:04:33,143 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@7320750c{HTTP/1.1,[http/1.1]}{0.0.0.0:33343}
2019-06-13 12:04:33,148 INFO  server.Server (Server.java:doStart(419)) - Started @42368ms
2019-06-13 12:04:33,149 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:33343
Jun 13, 2019 12:04:33 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:04:33,277 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@5357de0e
2019-06-13 12:04:33,278 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 7 DN Heartbeats.
2019-06-13 12:04:33,287 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:04:33,288 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-6/meta/datanode.id
2019-06-13 12:04:33,827 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:04:33,827 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:04:33,827 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 85f94b0e-1bb1-456b-8f06-53fefc76d6f3 at port 38463
2019-06-13 12:04:33,831 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: start RPC server
2019-06-13 12:04:33,831 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: GrpcService started, listening on 0.0.0.0/0.0.0.0:38463
2019-06-13 12:04:33,894 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1123, electionTimeout:1122ms
2019-06-13 12:04:33,894 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:33,894 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 26 for changeToCandidate
2019-06-13 12:04:33,895 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:33,897 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection53: begin an election at term 27 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:33,900 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection53 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:33,900 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection53 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:33,901 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection53: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t27, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:33,901 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:33,901 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:33,901 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 27 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:33,901 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:33,901 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:34,161 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:04:34,162 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:04:34,162 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 9bcfb37b-fbe7-4cb4-9d87-b8763453400a at port 41371
2019-06-13 12:04:34,219 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start RPC server
2019-06-13 12:04:34,222 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: GrpcService started, listening on 0.0.0.0/0.0.0.0:41371
2019-06-13 12:04:34,278 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 7 DN Heartbeats.
2019-06-13 12:04:34,329 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:04:34,329 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:04:34,330 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 7e4483e3-681f-4a91-91b6-3a576bda624f at port 35139
2019-06-13 12:04:34,445 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: start RPC server
2019-06-13 12:04:34,449 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: GrpcService started, listening on 0.0.0.0/0.0.0.0:35139
2019-06-13 12:04:34,502 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:04:34,502 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:04:34,502 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis cf3e3df6-043d-46f8-b31e-9008a3fd3173 at port 44501
2019-06-13 12:04:34,621 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: start RPC server
2019-06-13 12:04:34,623 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: GrpcService started, listening on 0.0.0.0/0.0.0.0:44501
2019-06-13 12:04:34,713 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:04:34,713 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:04:34,713 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis fa2de56a-cf81-4e2b-8786-665d0e809252 at port 34875
2019-06-13 12:04:34,753 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - fa2de56a-cf81-4e2b-8786-665d0e809252: start RPC server
2019-06-13 12:04:34,754 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - fa2de56a-cf81-4e2b-8786-665d0e809252: GrpcService started, listening on 0.0.0.0/0.0.0.0:34875
2019-06-13 12:04:35,016 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:04:35,017 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:04:35,017 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2 at port 42811
2019-06-13 12:04:35,039 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: start RPC server
2019-06-13 12:04:35,039 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: GrpcService started, listening on 0.0.0.0/0.0.0.0:42811
2019-06-13 12:04:35,079 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1177, electionTimeout:1177ms
2019-06-13 12:04:35,079 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:35,079 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 27 for changeToCandidate
2019-06-13 12:04:35,079 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:35,081 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection54: begin an election at term 28 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:35,085 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection54 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:35,086 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection54 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:35,086 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection54: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t28, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:35,086 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:35,087 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:35,093 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 28 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:35,093 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:35,094 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:35,278 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 7 DN Heartbeats.
2019-06-13 12:04:35,291 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:04:35,291 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:04:35,292 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 461b9a11-1c29-4c07-9f76-dd5706a3f9ba at port 35245
2019-06-13 12:04:35,370 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba: start RPC server
2019-06-13 12:04:35,374 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba: GrpcService started, listening on 0.0.0.0/0.0.0.0:35245
2019-06-13 12:04:35,818 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 85f94b0e-1bb1-456b-8f06-53fefc76d6f3{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:04:35,822 INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 1 DataNodes registered, 1 required.
2019-06-13 12:04:35,826 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(177)) - ScmSafeModeManager, all rules are successfully validated
2019-06-13 12:04:35,827 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:exitSafeMode(193)) - SCM exiting safe mode.
2019-06-13 12:04:35,836 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: addNew group-57A882C2BCD4:[85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463] returns group-57A882C2BCD4:java.util.concurrent.CompletableFuture@2edfdd8[Not completed]
2019-06-13 12:04:35,837 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: new RaftServerImpl for group-57A882C2BCD4:[85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463] with ContainerStateMachine:uninitialized
2019-06-13 12:04:35,837 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:35,837 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:35,837 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:35,838 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:35,838 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:group-57A882C2BCD4 ConfigurationManager, init=-1: [85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:35,838 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-0/data/ratis] (custom)
2019-06-13 12:04:35,838 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-0/data/ratis/14892738-f7a6-49ce-93dc-57a882c2bcd4 does not exist. Creating ...
2019-06-13 12:04:35,841 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-0/data/ratis/14892738-f7a6-49ce-93dc-57a882c2bcd4/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:35,843 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-0/data/ratis/14892738-f7a6-49ce-93dc-57a882c2bcd4 has been successfully formatted.
2019-06-13 12:04:35,843 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:35,843 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:35,843 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:35,843 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:35,844 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:35,844 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:35,844 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 85f94b0e-1bb1-456b-8f06-53fefc76d6f3-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-0/data/ratis/14892738-f7a6-49ce-93dc-57a882c2bcd4
2019-06-13 12:04:35,844 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:35,844 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:35,844 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:35,844 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:35,844 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:35,844 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:35,844 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:35,845 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:35,845 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:35,845 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:35,845 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:35,845 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:35,845 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:35,845 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: start group-57A882C2BCD4
2019-06-13 12:04:35,845 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:group-57A882C2BCD4 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:35,846 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: start FollowerState
2019-06-13 12:04:35,849 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-57A882C2BCD4,id=85f94b0e-1bb1-456b-8f06-53fefc76d6f3
2019-06-13 12:04:35,852 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 14892738-f7a6-49ce-93dc-57a882c2bcd4, Nodes: 85f94b0e-1bb1-456b-8f06-53fefc76d6f3{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:04:36,153 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 9bcfb37b-fbe7-4cb4-9d87-b8763453400a{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:04:36,170 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: addNew group-D78BEEA9F006:[9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371] returns group-D78BEEA9F006:java.util.concurrent.CompletableFuture@5d865672[Not completed]
2019-06-13 12:04:36,171 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: new RaftServerImpl for group-D78BEEA9F006:[9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371] with ContainerStateMachine:uninitialized
2019-06-13 12:04:36,171 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:36,171 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:36,171 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:36,171 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:36,171 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D78BEEA9F006 ConfigurationManager, init=-1: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:36,171 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-1/data/ratis] (custom)
2019-06-13 12:04:36,172 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-1/data/ratis/42dcce0b-fc33-47dc-a002-d78beea9f006 does not exist. Creating ...
2019-06-13 12:04:36,174 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-1/data/ratis/42dcce0b-fc33-47dc-a002-d78beea9f006/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:36,177 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-1/data/ratis/42dcce0b-fc33-47dc-a002-d78beea9f006 has been successfully formatted.
2019-06-13 12:04:36,177 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:36,177 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:36,177 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:36,177 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:36,177 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:36,177 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:36,178 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 9bcfb37b-fbe7-4cb4-9d87-b8763453400a-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-1/data/ratis/42dcce0b-fc33-47dc-a002-d78beea9f006
2019-06-13 12:04:36,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:36,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:36,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:36,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:36,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:36,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:36,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:36,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:36,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:36,179 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:36,179 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:36,179 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:36,179 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:36,179 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start group-D78BEEA9F006
2019-06-13 12:04:36,179 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D78BEEA9F006 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:36,179 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start FollowerState
2019-06-13 12:04:36,182 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D78BEEA9F006,id=9bcfb37b-fbe7-4cb4-9d87-b8763453400a
2019-06-13 12:04:36,184 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 42dcce0b-fc33-47dc-a002-d78beea9f006, Nodes: 9bcfb37b-fbe7-4cb4-9d87-b8763453400a{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:04:36,275 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1181, electionTimeout:1178ms
2019-06-13 12:04:36,275 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:36,275 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 28 for changeToCandidate
2019-06-13 12:04:36,275 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:36,278 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection55: begin an election at term 29 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:36,279 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 2 of 7 DN Heartbeats.
2019-06-13 12:04:36,280 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection55 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:36,280 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection55 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:36,281 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection55: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t29, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:36,281 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:36,281 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:36,281 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 29 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:36,281 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:36,281 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:36,327 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 7e4483e3-681f-4a91-91b6-3a576bda624f{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:04:36,335 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: addNew group-7EC93F7AEB63:[7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139] returns group-7EC93F7AEB63:java.util.concurrent.CompletableFuture@35461e9d[Not completed]
2019-06-13 12:04:36,335 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: new RaftServerImpl for group-7EC93F7AEB63:[7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139] with ContainerStateMachine:uninitialized
2019-06-13 12:04:36,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:36,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:36,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:36,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:36,336 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 7e4483e3-681f-4a91-91b6-3a576bda624f:group-7EC93F7AEB63 ConfigurationManager, init=-1: [7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:36,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-2/data/ratis] (custom)
2019-06-13 12:04:36,336 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-2/data/ratis/01deff1d-9d01-45f5-b662-7ec93f7aeb63 does not exist. Creating ...
2019-06-13 12:04:36,338 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-2/data/ratis/01deff1d-9d01-45f5-b662-7ec93f7aeb63/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:36,340 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-2/data/ratis/01deff1d-9d01-45f5-b662-7ec93f7aeb63 has been successfully formatted.
2019-06-13 12:04:36,340 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:36,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:36,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:36,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:36,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:36,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:36,341 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 7e4483e3-681f-4a91-91b6-3a576bda624f-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-2/data/ratis/01deff1d-9d01-45f5-b662-7ec93f7aeb63
2019-06-13 12:04:36,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:36,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:36,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:36,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:36,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:36,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:36,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:36,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:36,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:36,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:36,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:36,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:36,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:36,342 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: start group-7EC93F7AEB63
2019-06-13 12:04:36,342 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7e4483e3-681f-4a91-91b6-3a576bda624f:group-7EC93F7AEB63 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:36,343 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: start FollowerState
2019-06-13 12:04:36,345 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-7EC93F7AEB63,id=7e4483e3-681f-4a91-91b6-3a576bda624f
2019-06-13 12:04:36,354 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 01deff1d-9d01-45f5-b662-7ec93f7aeb63, Nodes: 7e4483e3-681f-4a91-91b6-3a576bda624f{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:04:36,360 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: addNew group-D7C7AD13668C:[9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139] returns group-D7C7AD13668C:java.util.concurrent.CompletableFuture@46cbc39d[Not completed]
2019-06-13 12:04:36,360 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: new RaftServerImpl for group-D7C7AD13668C:[9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139] with ContainerStateMachine:uninitialized
2019-06-13 12:04:36,360 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:36,360 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:36,360 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:36,361 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:36,361 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 7e4483e3-681f-4a91-91b6-3a576bda624f:group-D7C7AD13668C ConfigurationManager, init=-1: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:36,361 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-2/data/ratis] (custom)
2019-06-13 12:04:36,361 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-2/data/ratis/6dc54a08-bc04-423b-989d-d7c7ad13668c does not exist. Creating ...
2019-06-13 12:04:36,362 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: addNew group-D7C7AD13668C:[9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139] returns group-D7C7AD13668C:java.util.concurrent.CompletableFuture@43fc9f2f[Not completed]
2019-06-13 12:04:36,362 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: new RaftServerImpl for group-D7C7AD13668C:[9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139] with ContainerStateMachine:uninitialized
2019-06-13 12:04:36,362 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:36,362 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:36,363 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:36,363 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:36,363 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C ConfigurationManager, init=-1: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:36,363 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-1/data/ratis] (custom)
2019-06-13 12:04:36,363 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-1/data/ratis/6dc54a08-bc04-423b-989d-d7c7ad13668c does not exist. Creating ...
2019-06-13 12:04:36,363 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: new RaftServerImpl for group-D7C7AD13668C:[9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139] with ContainerStateMachine:uninitialized
2019-06-13 12:04:36,364 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:36,364 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:36,364 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:36,364 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:36,364 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:group-D7C7AD13668C ConfigurationManager, init=-1: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:36,364 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-0/data/ratis] (custom)
2019-06-13 12:04:36,364 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-2/data/ratis/6dc54a08-bc04-423b-989d-d7c7ad13668c/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:36,365 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-0/data/ratis/6dc54a08-bc04-423b-989d-d7c7ad13668c does not exist. Creating ...
2019-06-13 12:04:36,365 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-1/data/ratis/6dc54a08-bc04-423b-989d-d7c7ad13668c/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:36,367 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-0/data/ratis/6dc54a08-bc04-423b-989d-d7c7ad13668c/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:36,363 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: addNew group-D7C7AD13668C:[9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139] returns group-D7C7AD13668C:java.util.concurrent.CompletableFuture@bc81fc6[Not completed]
2019-06-13 12:04:36,367 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-2/data/ratis/6dc54a08-bc04-423b-989d-d7c7ad13668c has been successfully formatted.
2019-06-13 12:04:36,368 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:36,368 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:36,369 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-1/data/ratis/6dc54a08-bc04-423b-989d-d7c7ad13668c has been successfully formatted.
2019-06-13 12:04:36,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:36,369 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:36,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:36,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:36,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:36,369 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 7e4483e3-681f-4a91-91b6-3a576bda624f-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-2/data/ratis/6dc54a08-bc04-423b-989d-d7c7ad13668c
2019-06-13 12:04:36,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:36,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:36,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:36,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:36,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:36,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:36,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:36,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:36,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:36,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:36,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:36,370 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-0/data/ratis/6dc54a08-bc04-423b-989d-d7c7ad13668c has been successfully formatted.
2019-06-13 12:04:36,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:36,371 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:36,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:36,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:36,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:36,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:36,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:36,371 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 9bcfb37b-fbe7-4cb4-9d87-b8763453400a-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-1/data/ratis/6dc54a08-bc04-423b-989d-d7c7ad13668c
2019-06-13 12:04:36,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:36,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:36,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:36,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:36,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:36,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:36,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:36,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:36,372 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 85f94b0e-1bb1-456b-8f06-53fefc76d6f3-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-0/data/ratis/6dc54a08-bc04-423b-989d-d7c7ad13668c
2019-06-13 12:04:36,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:36,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:36,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:36,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:36,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:36,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:36,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:36,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:36,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:36,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:36,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:36,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:36,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:36,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:36,374 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:36,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:36,374 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:36,375 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:36,374 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:36,375 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:36,375 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: start group-D7C7AD13668C
2019-06-13 12:04:36,375 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:36,375 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:36,375 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7e4483e3-681f-4a91-91b6-3a576bda624f:group-D7C7AD13668C changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:36,375 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:36,375 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:36,375 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: start FollowerState
2019-06-13 12:04:36,376 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start group-D7C7AD13668C
2019-06-13 12:04:36,376 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:36,376 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: start group-D7C7AD13668C
2019-06-13 12:04:36,376 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D7C7AD13668C,id=7e4483e3-681f-4a91-91b6-3a576bda624f
2019-06-13 12:04:36,376 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start FollowerState
2019-06-13 12:04:36,376 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:group-D7C7AD13668C changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:36,376 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: start FollowerState
2019-06-13 12:04:36,377 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D7C7AD13668C,id=9bcfb37b-fbe7-4cb4-9d87-b8763453400a
2019-06-13 12:04:36,377 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D7C7AD13668C,id=85f94b0e-1bb1-456b-8f06-53fefc76d6f3
2019-06-13 12:04:36,379 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 6dc54a08-bc04-423b-989d-d7c7ad13668c, Nodes: 85f94b0e-1bb1-456b-8f06-53fefc76d6f3{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}7e4483e3-681f-4a91-91b6-3a576bda624f{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}9bcfb37b-fbe7-4cb4-9d87-b8763453400a{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-13 12:04:36,500 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : cf3e3df6-043d-46f8-b31e-9008a3fd3173{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:04:36,508 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: addNew group-5470BB6E7F9E:[cf3e3df6-043d-46f8-b31e-9008a3fd3173:192.168.46.58:44501] returns group-5470BB6E7F9E:java.util.concurrent.CompletableFuture@7d8d4828[Not completed]
2019-06-13 12:04:36,509 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: new RaftServerImpl for group-5470BB6E7F9E:[cf3e3df6-043d-46f8-b31e-9008a3fd3173:192.168.46.58:44501] with ContainerStateMachine:uninitialized
2019-06-13 12:04:36,509 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:36,509 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:36,509 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:36,509 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:36,510 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173:group-5470BB6E7F9E ConfigurationManager, init=-1: [cf3e3df6-043d-46f8-b31e-9008a3fd3173:192.168.46.58:44501], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:36,510 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-3/data/ratis] (custom)
2019-06-13 12:04:36,510 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-3/data/ratis/641cf660-3f18-444a-a161-5470bb6e7f9e does not exist. Creating ...
2019-06-13 12:04:36,512 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-3/data/ratis/641cf660-3f18-444a-a161-5470bb6e7f9e/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:36,515 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-3/data/ratis/641cf660-3f18-444a-a161-5470bb6e7f9e has been successfully formatted.
2019-06-13 12:04:36,515 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:36,515 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:36,515 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:36,515 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:36,515 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:36,515 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:36,515 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new cf3e3df6-043d-46f8-b31e-9008a3fd3173-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-3/data/ratis/641cf660-3f18-444a-a161-5470bb6e7f9e
2019-06-13 12:04:36,516 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:36,516 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:36,516 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:36,516 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:36,516 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:36,516 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:36,516 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:36,516 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:36,516 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:36,517 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:36,517 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:36,517 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:36,517 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:36,517 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: start group-5470BB6E7F9E
2019-06-13 12:04:36,517 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173:group-5470BB6E7F9E changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:36,518 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: start FollowerState
2019-06-13 12:04:36,518 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-5470BB6E7F9E,id=cf3e3df6-043d-46f8-b31e-9008a3fd3173
2019-06-13 12:04:36,529 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 641cf660-3f18-444a-a161-5470bb6e7f9e, Nodes: cf3e3df6-043d-46f8-b31e-9008a3fd3173{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:04:36,712 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : fa2de56a-cf81-4e2b-8786-665d0e809252{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:04:36,720 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - fa2de56a-cf81-4e2b-8786-665d0e809252: addNew group-DEC3C33B97D0:[fa2de56a-cf81-4e2b-8786-665d0e809252:192.168.46.58:34875] returns group-DEC3C33B97D0:java.util.concurrent.CompletableFuture@1ec20c73[Not completed]
2019-06-13 12:04:36,720 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - fa2de56a-cf81-4e2b-8786-665d0e809252: new RaftServerImpl for group-DEC3C33B97D0:[fa2de56a-cf81-4e2b-8786-665d0e809252:192.168.46.58:34875] with ContainerStateMachine:uninitialized
2019-06-13 12:04:36,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:36,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:36,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:36,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:36,721 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - fa2de56a-cf81-4e2b-8786-665d0e809252:group-DEC3C33B97D0 ConfigurationManager, init=-1: [fa2de56a-cf81-4e2b-8786-665d0e809252:192.168.46.58:34875], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:36,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-4/data/ratis] (custom)
2019-06-13 12:04:36,721 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-4/data/ratis/238c4679-c1c5-45c7-b037-dec3c33b97d0 does not exist. Creating ...
2019-06-13 12:04:36,723 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-4/data/ratis/238c4679-c1c5-45c7-b037-dec3c33b97d0/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:36,725 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-4/data/ratis/238c4679-c1c5-45c7-b037-dec3c33b97d0 has been successfully formatted.
2019-06-13 12:04:36,726 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:36,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:36,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:36,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:36,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:36,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:36,726 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new fa2de56a-cf81-4e2b-8786-665d0e809252-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-4/data/ratis/238c4679-c1c5-45c7-b037-dec3c33b97d0
2019-06-13 12:04:36,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:36,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:36,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:36,727 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:36,727 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:36,727 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:36,727 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:36,727 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:36,727 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:36,727 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:36,727 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:36,728 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:36,728 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:36,728 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - fa2de56a-cf81-4e2b-8786-665d0e809252: start group-DEC3C33B97D0
2019-06-13 12:04:36,728 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fa2de56a-cf81-4e2b-8786-665d0e809252:group-DEC3C33B97D0 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:36,728 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fa2de56a-cf81-4e2b-8786-665d0e809252: start FollowerState
2019-06-13 12:04:36,728 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-DEC3C33B97D0,id=fa2de56a-cf81-4e2b-8786-665d0e809252
2019-06-13 12:04:36,730 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 238c4679-c1c5-45c7-b037-dec3c33b97d0, Nodes: fa2de56a-cf81-4e2b-8786-665d0e809252{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:04:37,005 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:04:37,013 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: addNew group-94FAD45BD15A:[090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:192.168.46.58:42811] returns group-94FAD45BD15A:java.util.concurrent.CompletableFuture@5f5efe2c[Not completed]
2019-06-13 12:04:37,014 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: new RaftServerImpl for group-94FAD45BD15A:[090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:192.168.46.58:42811] with ContainerStateMachine:uninitialized
2019-06-13 12:04:37,014 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:37,014 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:37,014 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:37,014 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:37,014 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:group-94FAD45BD15A ConfigurationManager, init=-1: [090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:192.168.46.58:42811], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:37,015 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-5/data/ratis] (custom)
2019-06-13 12:04:37,015 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-5/data/ratis/b13c479d-a2a7-422c-990f-94fad45bd15a does not exist. Creating ...
2019-06-13 12:04:37,017 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-5/data/ratis/b13c479d-a2a7-422c-990f-94fad45bd15a/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:37,019 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-5/data/ratis/b13c479d-a2a7-422c-990f-94fad45bd15a has been successfully formatted.
2019-06-13 12:04:37,019 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:37,019 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:37,019 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:37,019 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:37,019 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:37,019 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:37,020 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-5/data/ratis/b13c479d-a2a7-422c-990f-94fad45bd15a
2019-06-13 12:04:37,020 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:37,020 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:37,020 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:37,020 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:37,020 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:37,020 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:37,020 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:37,020 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:37,020 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:37,021 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:37,021 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:37,021 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:37,021 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:37,021 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: start group-94FAD45BD15A
2019-06-13 12:04:37,021 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:group-94FAD45BD15A changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:37,022 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: start FollowerState
2019-06-13 12:04:37,022 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-94FAD45BD15A,id=090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2
2019-06-13 12:04:37,023 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: b13c479d-a2a7-422c-990f-94fad45bd15a, Nodes: 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:04:37,038 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: addNew group-BE87FA66CE98:[090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:192.168.46.58:42811, cf3e3df6-043d-46f8-b31e-9008a3fd3173:192.168.46.58:44501, fa2de56a-cf81-4e2b-8786-665d0e809252:192.168.46.58:34875] returns group-BE87FA66CE98:java.util.concurrent.CompletableFuture@7cd9dd15[Not completed]
2019-06-13 12:04:37,038 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: addNew group-BE87FA66CE98:[090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:192.168.46.58:42811, cf3e3df6-043d-46f8-b31e-9008a3fd3173:192.168.46.58:44501, fa2de56a-cf81-4e2b-8786-665d0e809252:192.168.46.58:34875] returns group-BE87FA66CE98:java.util.concurrent.CompletableFuture@16f39c06[Not completed]
2019-06-13 12:04:37,039 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: new RaftServerImpl for group-BE87FA66CE98:[090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:192.168.46.58:42811, cf3e3df6-043d-46f8-b31e-9008a3fd3173:192.168.46.58:44501, fa2de56a-cf81-4e2b-8786-665d0e809252:192.168.46.58:34875] with ContainerStateMachine:uninitialized
2019-06-13 12:04:37,039 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:37,039 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:37,039 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:37,039 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:37,039 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173:group-BE87FA66CE98 ConfigurationManager, init=-1: [090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:192.168.46.58:42811, cf3e3df6-043d-46f8-b31e-9008a3fd3173:192.168.46.58:44501, fa2de56a-cf81-4e2b-8786-665d0e809252:192.168.46.58:34875], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:37,039 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-3/data/ratis] (custom)
2019-06-13 12:04:37,040 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-3/data/ratis/9b4907ba-3981-4865-96a4-be87fa66ce98 does not exist. Creating ...
2019-06-13 12:04:37,041 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: new RaftServerImpl for group-BE87FA66CE98:[090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:192.168.46.58:42811, cf3e3df6-043d-46f8-b31e-9008a3fd3173:192.168.46.58:44501, fa2de56a-cf81-4e2b-8786-665d0e809252:192.168.46.58:34875] with ContainerStateMachine:uninitialized
2019-06-13 12:04:37,041 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:37,041 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:37,042 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - fa2de56a-cf81-4e2b-8786-665d0e809252: new RaftServerImpl for group-BE87FA66CE98:[090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:192.168.46.58:42811, cf3e3df6-043d-46f8-b31e-9008a3fd3173:192.168.46.58:44501, fa2de56a-cf81-4e2b-8786-665d0e809252:192.168.46.58:34875] with ContainerStateMachine:uninitialized
2019-06-13 12:04:37,042 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-3/data/ratis/9b4907ba-3981-4865-96a4-be87fa66ce98/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:37,041 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - fa2de56a-cf81-4e2b-8786-665d0e809252: addNew group-BE87FA66CE98:[090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:192.168.46.58:42811, cf3e3df6-043d-46f8-b31e-9008a3fd3173:192.168.46.58:44501, fa2de56a-cf81-4e2b-8786-665d0e809252:192.168.46.58:34875] returns group-BE87FA66CE98:java.util.concurrent.CompletableFuture@5b7b3046[Not completed]
2019-06-13 12:04:37,042 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:37,042 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:37,043 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:37,043 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:37,043 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:37,043 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:37,043 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - fa2de56a-cf81-4e2b-8786-665d0e809252:group-BE87FA66CE98 ConfigurationManager, init=-1: [090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:192.168.46.58:42811, cf3e3df6-043d-46f8-b31e-9008a3fd3173:192.168.46.58:44501, fa2de56a-cf81-4e2b-8786-665d0e809252:192.168.46.58:34875], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:37,044 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-4/data/ratis] (custom)
2019-06-13 12:04:37,044 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-4/data/ratis/9b4907ba-3981-4865-96a4-be87fa66ce98 does not exist. Creating ...
2019-06-13 12:04:37,044 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:group-BE87FA66CE98 ConfigurationManager, init=-1: [090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:192.168.46.58:42811, cf3e3df6-043d-46f8-b31e-9008a3fd3173:192.168.46.58:44501, fa2de56a-cf81-4e2b-8786-665d0e809252:192.168.46.58:34875], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:37,044 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-5/data/ratis] (custom)
2019-06-13 12:04:37,044 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-5/data/ratis/9b4907ba-3981-4865-96a4-be87fa66ce98 does not exist. Creating ...
2019-06-13 12:04:37,044 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-3/data/ratis/9b4907ba-3981-4865-96a4-be87fa66ce98 has been successfully formatted.
2019-06-13 12:04:37,045 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:37,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:37,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:37,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:37,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:37,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:37,045 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new cf3e3df6-043d-46f8-b31e-9008a3fd3173-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-3/data/ratis/9b4907ba-3981-4865-96a4-be87fa66ce98
2019-06-13 12:04:37,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:37,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:37,046 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:37,048 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:37,049 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:37,049 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:37,049 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:37,049 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:37,049 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:37,048 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-5/data/ratis/9b4907ba-3981-4865-96a4-be87fa66ce98/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:37,048 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-4/data/ratis/9b4907ba-3981-4865-96a4-be87fa66ce98/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:37,046 INFO  impl.FollowerState (FollowerState.java:run(101)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:group-57A882C2BCD4 changes to CANDIDATE, lastRpcTime:1200, electionTimeout:1197ms
2019-06-13 12:04:37,049 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: shutdown FollowerState
2019-06-13 12:04:37,049 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:group-57A882C2BCD4 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:37,050 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: start LeaderElection
2019-06-13 12:04:37,049 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:37,054 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:37,054 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:37,054 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:37,054 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-4/data/ratis/9b4907ba-3981-4865-96a4-be87fa66ce98 has been successfully formatted.
2019-06-13 12:04:37,054 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: start group-BE87FA66CE98
2019-06-13 12:04:37,054 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-5/data/ratis/9b4907ba-3981-4865-96a4-be87fa66ce98 has been successfully formatted.
2019-06-13 12:04:37,054 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:37,055 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:37,055 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:37,055 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:37,055 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:37,055 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:37,055 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new fa2de56a-cf81-4e2b-8786-665d0e809252-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-4/data/ratis/9b4907ba-3981-4865-96a4-be87fa66ce98
2019-06-13 12:04:37,055 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:37,055 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:37,055 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:37,055 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:37,056 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:37,056 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:37,056 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:37,056 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:group-57A882C2BCD4:LeaderElection56: begin an election at term 1 for -1: [85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463], old=null
2019-06-13 12:04:37,055 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173:group-BE87FA66CE98 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:37,056 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: shutdown LeaderElection
2019-06-13 12:04:37,056 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:group-57A882C2BCD4 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:37,056 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:group-57A882C2BCD4 change Leader from null to 85f94b0e-1bb1-456b-8f06-53fefc76d6f3 at term 1 for becomeLeader, leader elected after 1212ms
2019-06-13 12:04:37,056 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:37,056 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:37,056 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:37,056 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:37,057 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: start LeaderState
2019-06-13 12:04:37,057 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:37,056 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:37,055 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:37,057 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:37,057 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:group-57A882C2BCD4 set configuration 0: [85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463], old=null at 0
2019-06-13 12:04:37,056 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: start FollowerState
2019-06-13 12:04:37,057 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:37,057 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:37,058 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:37,058 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:37,058 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:37,058 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:37,059 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-5/data/ratis/9b4907ba-3981-4865-96a4-be87fa66ce98
2019-06-13 12:04:37,059 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:37,059 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:37,059 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:37,059 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:37,059 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:37,059 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:37,059 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:37,059 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:37,059 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:37,062 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-BE87FA66CE98,id=cf3e3df6-043d-46f8-b31e-9008a3fd3173
2019-06-13 12:04:37,066 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:37,066 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:37,066 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:37,066 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:37,066 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: start group-BE87FA66CE98
2019-06-13 12:04:37,066 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:group-BE87FA66CE98 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:37,067 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: start FollowerState
2019-06-13 12:04:37,070 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-BE87FA66CE98,id=090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2
2019-06-13 12:04:37,073 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:37,074 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:37,074 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:37,074 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - fa2de56a-cf81-4e2b-8786-665d0e809252: start group-BE87FA66CE98
2019-06-13 12:04:37,074 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fa2de56a-cf81-4e2b-8786-665d0e809252:group-BE87FA66CE98 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:37,074 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fa2de56a-cf81-4e2b-8786-665d0e809252: start FollowerState
2019-06-13 12:04:37,074 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-BE87FA66CE98,id=fa2de56a-cf81-4e2b-8786-665d0e809252
2019-06-13 12:04:37,079 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 9b4907ba-3981-4865-96a4-be87fa66ce98, Nodes: 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}fa2de56a-cf81-4e2b-8786-665d0e809252{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}cf3e3df6-043d-46f8-b31e-9008a3fd3173{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-13 12:04:37,105 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-0/data/ratis/14892738-f7a6-49ce-93dc-57a882c2bcd4/current/log_inprogress_0
2019-06-13 12:04:37,279 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 6 of 7 DN Heartbeats.
2019-06-13 12:04:37,285 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D78BEEA9F006 changes to CANDIDATE, lastRpcTime:1105, electionTimeout:1103ms
2019-06-13 12:04:37,285 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown FollowerState
2019-06-13 12:04:37,285 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D78BEEA9F006 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:37,285 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start LeaderElection
2019-06-13 12:04:37,292 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 461b9a11-1c29-4c07-9f76-dd5706a3f9ba{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:04:37,296 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D78BEEA9F006:LeaderElection57: begin an election at term 1 for -1: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371], old=null
2019-06-13 12:04:37,296 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown LeaderElection
2019-06-13 12:04:37,296 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D78BEEA9F006 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:37,296 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D78BEEA9F006 change Leader from null to 9bcfb37b-fbe7-4cb4-9d87-b8763453400a at term 1 for becomeLeader, leader elected after 1119ms
2019-06-13 12:04:37,296 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:37,296 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:37,297 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:37,297 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:37,297 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start LeaderState
2019-06-13 12:04:37,297 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:37,297 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D78BEEA9F006 set configuration 0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371], old=null at 0
2019-06-13 12:04:37,325 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba: addNew group-435D4B3A4553:[461b9a11-1c29-4c07-9f76-dd5706a3f9ba:192.168.46.58:35245] returns group-435D4B3A4553:java.util.concurrent.CompletableFuture@4b05bb7e[Not completed]
2019-06-13 12:04:37,325 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1043, electionTimeout:1026ms
2019-06-13 12:04:37,325 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:37,325 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 29 for changeToCandidate
2019-06-13 12:04:37,325 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:37,325 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba: new RaftServerImpl for group-435D4B3A4553:[461b9a11-1c29-4c07-9f76-dd5706a3f9ba:192.168.46.58:35245] with ContainerStateMachine:uninitialized
2019-06-13 12:04:37,326 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:04:37,326 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:04:37,326 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:04:37,326 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:37,326 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba:group-435D4B3A4553 ConfigurationManager, init=-1: [461b9a11-1c29-4c07-9f76-dd5706a3f9ba:192.168.46.58:35245], old=null, confs=<EMPTY_MAP>
2019-06-13 12:04:37,326 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-6/data/ratis] (custom)
2019-06-13 12:04:37,327 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-6/data/ratis/508ed550-243b-4637-9c0c-435d4b3a4553 does not exist. Creating ...
2019-06-13 12:04:37,329 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection58: begin an election at term 30 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:37,329 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-6/data/ratis/508ed550-243b-4637-9c0c-435d4b3a4553/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:04:37,331 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection58 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:37,334 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection58 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:37,334 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection58: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t30, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:37,334 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:37,334 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:37,334 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 30 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:37,334 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:37,335 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:37,335 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-6/data/ratis/508ed550-243b-4637-9c0c-435d4b3a4553 has been successfully formatted.
2019-06-13 12:04:37,335 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:04:37,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:04:37,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:04:37,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:37,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:37,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:04:37,336 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 461b9a11-1c29-4c07-9f76-dd5706a3f9ba-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-6/data/ratis/508ed550-243b-4637-9c0c-435d4b3a4553
2019-06-13 12:04:37,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:04:37,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:04:37,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:04:37,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:04:37,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:04:37,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:04:37,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:04:37,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:04:37,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:04:37,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:04:37,337 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:04:37,337 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:04:37,337 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:04:37,337 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba: start group-435D4B3A4553
2019-06-13 12:04:37,337 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba:group-435D4B3A4553 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:04:37,337 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba: start FollowerState
2019-06-13 12:04:37,338 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-435D4B3A4553,id=461b9a11-1c29-4c07-9f76-dd5706a3f9ba
2019-06-13 12:04:37,342 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 508ed550-243b-4637-9c0c-435d4b3a4553, Nodes: 461b9a11-1c29-4c07-9f76-dd5706a3f9ba{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:04:37,350 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-1/data/ratis/42dcce0b-fc33-47dc-a002-d78beea9f006/current/log_inprogress_0
2019-06-13 12:04:37,356 INFO  impl.FollowerState (FollowerState.java:run(101)) - 7e4483e3-681f-4a91-91b6-3a576bda624f:group-7EC93F7AEB63 changes to CANDIDATE, lastRpcTime:1012, electionTimeout:1010ms
2019-06-13 12:04:37,356 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: shutdown FollowerState
2019-06-13 12:04:37,356 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7e4483e3-681f-4a91-91b6-3a576bda624f:group-7EC93F7AEB63 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:37,356 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: start LeaderElection
2019-06-13 12:04:37,365 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 7e4483e3-681f-4a91-91b6-3a576bda624f:group-7EC93F7AEB63:LeaderElection59: begin an election at term 1 for -1: [7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:37,365 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: shutdown LeaderElection
2019-06-13 12:04:37,365 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7e4483e3-681f-4a91-91b6-3a576bda624f:group-7EC93F7AEB63 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:37,365 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 7e4483e3-681f-4a91-91b6-3a576bda624f:group-7EC93F7AEB63 change Leader from null to 7e4483e3-681f-4a91-91b6-3a576bda624f at term 1 for becomeLeader, leader elected after 1024ms
2019-06-13 12:04:37,366 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:37,366 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:37,366 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:37,366 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:37,366 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: start LeaderState
2019-06-13 12:04:37,366 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 7e4483e3-681f-4a91-91b6-3a576bda624f-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:37,366 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 7e4483e3-681f-4a91-91b6-3a576bda624f:group-7EC93F7AEB63 set configuration 0: [7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null at 0
2019-06-13 12:04:37,389 INFO  impl.FollowerState (FollowerState.java:run(101)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:group-D7C7AD13668C changes to CANDIDATE, lastRpcTime:1012, electionTimeout:1011ms
2019-06-13 12:04:37,389 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: shutdown FollowerState
2019-06-13 12:04:37,389 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:group-D7C7AD13668C changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:37,389 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: start LeaderElection
2019-06-13 12:04:37,414 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 7e4483e3-681f-4a91-91b6-3a576bda624f-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-2/data/ratis/01deff1d-9d01-45f5-b662-7ec93f7aeb63/current/log_inprogress_0
2019-06-13 12:04:37,414 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:group-D7C7AD13668C:LeaderElection60: begin an election at term 1 for -1: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:37,425 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7e4483e3-681f-4a91-91b6-3a576bda624f:group-D7C7AD13668C changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:85f94b0e-1bb1-456b-8f06-53fefc76d6f3
2019-06-13 12:04:37,425 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: shutdown FollowerState
2019-06-13 12:04:37,425 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: start FollowerState
2019-06-13 12:04:37,427 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:85f94b0e-1bb1-456b-8f06-53fefc76d6f3
2019-06-13 12:04:37,427 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown FollowerState
2019-06-13 12:04:37,428 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start FollowerState
2019-06-13 12:04:37,428 INFO  impl.FollowerState (FollowerState.java:run(109)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:04:37,429 INFO  impl.FollowerState (FollowerState.java:run(109)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:04:37,431 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:group-D7C7AD13668C:LeaderElection60: Election PASSED; received 1 response(s) [85f94b0e-1bb1-456b-8f06-53fefc76d6f3->9bcfb37b-fbe7-4cb4-9d87-b8763453400a,true-t1] and 0 exception(s); 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:t1, leader=null, voted=85f94b0e-1bb1-456b-8f06-53fefc76d6f3, raftlog=85f94b0e-1bb1-456b-8f06-53fefc76d6f3-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:37,431 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: shutdown LeaderElection
2019-06-13 12:04:37,431 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:group-D7C7AD13668C changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:37,431 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:group-D7C7AD13668C change Leader from null to 85f94b0e-1bb1-456b-8f06-53fefc76d6f3 at term 1 for becomeLeader, leader elected after 1060ms
2019-06-13 12:04:37,431 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:37,431 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:37,431 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:37,431 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:37,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 12:04:37,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:37,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 12:04:37,432 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 12:04:37,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:37,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:37,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 12:04:37,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:37,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 12:04:37,433 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 12:04:37,433 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:37,433 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:37,433 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: start LeaderState
2019-06-13 12:04:37,433 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:37,438 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:group-D7C7AD13668C set configuration 0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null at 0
2019-06-13 12:04:37,439 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C change Leader from null to 85f94b0e-1bb1-456b-8f06-53fefc76d6f3 at term 1 for appendEntries, leader elected after 1070ms
2019-06-13 12:04:37,462 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 7e4483e3-681f-4a91-91b6-3a576bda624f:group-D7C7AD13668C change Leader from null to 85f94b0e-1bb1-456b-8f06-53fefc76d6f3 at term 1 for appendEntries, leader elected after 1093ms
2019-06-13 12:04:37,486 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C set configuration 0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null at 0
2019-06-13 12:04:37,486 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-0/data/ratis/6dc54a08-bc04-423b-989d-d7c7ad13668c/current/log_inprogress_0
2019-06-13 12:04:37,487 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:37,488 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 7e4483e3-681f-4a91-91b6-3a576bda624f:group-D7C7AD13668C set configuration 0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null at 0
2019-06-13 12:04:37,488 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 7e4483e3-681f-4a91-91b6-3a576bda624f-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:37,532 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-1/data/ratis/6dc54a08-bc04-423b-989d-d7c7ad13668c/current/log_inprogress_0
2019-06-13 12:04:37,533 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 7e4483e3-681f-4a91-91b6-3a576bda624f-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-2/data/ratis/6dc54a08-bc04-423b-989d-d7c7ad13668c/current/log_inprogress_0
2019-06-13 12:04:37,712 INFO  impl.FollowerState (FollowerState.java:run(101)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173:group-5470BB6E7F9E changes to CANDIDATE, lastRpcTime:1194, electionTimeout:1194ms
2019-06-13 12:04:37,712 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: shutdown FollowerState
2019-06-13 12:04:37,712 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173:group-5470BB6E7F9E changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:37,712 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: start LeaderElection
2019-06-13 12:04:37,721 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173:group-5470BB6E7F9E:LeaderElection61: begin an election at term 1 for -1: [cf3e3df6-043d-46f8-b31e-9008a3fd3173:192.168.46.58:44501], old=null
2019-06-13 12:04:37,721 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: shutdown LeaderElection
2019-06-13 12:04:37,721 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173:group-5470BB6E7F9E changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:37,721 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173:group-5470BB6E7F9E change Leader from null to cf3e3df6-043d-46f8-b31e-9008a3fd3173 at term 1 for becomeLeader, leader elected after 1206ms
2019-06-13 12:04:37,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:37,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:37,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:37,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:37,722 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: start LeaderState
2019-06-13 12:04:37,722 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:37,725 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173:group-5470BB6E7F9E set configuration 0: [cf3e3df6-043d-46f8-b31e-9008a3fd3173:192.168.46.58:44501], old=null at 0
2019-06-13 12:04:37,757 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-3/data/ratis/641cf660-3f18-444a-a161-5470bb6e7f9e/current/log_inprogress_0
2019-06-13 12:04:37,809 INFO  impl.FollowerState (FollowerState.java:run(101)) - fa2de56a-cf81-4e2b-8786-665d0e809252:group-DEC3C33B97D0 changes to CANDIDATE, lastRpcTime:1081, electionTimeout:1081ms
2019-06-13 12:04:37,809 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - fa2de56a-cf81-4e2b-8786-665d0e809252: shutdown FollowerState
2019-06-13 12:04:37,809 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fa2de56a-cf81-4e2b-8786-665d0e809252:group-DEC3C33B97D0 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:37,810 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fa2de56a-cf81-4e2b-8786-665d0e809252: start LeaderElection
2019-06-13 12:04:37,817 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - fa2de56a-cf81-4e2b-8786-665d0e809252:group-DEC3C33B97D0:LeaderElection62: begin an election at term 1 for -1: [fa2de56a-cf81-4e2b-8786-665d0e809252:192.168.46.58:34875], old=null
2019-06-13 12:04:37,817 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - fa2de56a-cf81-4e2b-8786-665d0e809252: shutdown LeaderElection
2019-06-13 12:04:37,817 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fa2de56a-cf81-4e2b-8786-665d0e809252:group-DEC3C33B97D0 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:37,817 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - fa2de56a-cf81-4e2b-8786-665d0e809252:group-DEC3C33B97D0 change Leader from null to fa2de56a-cf81-4e2b-8786-665d0e809252 at term 1 for becomeLeader, leader elected after 1091ms
2019-06-13 12:04:37,817 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:37,817 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:37,818 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:37,818 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:37,818 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fa2de56a-cf81-4e2b-8786-665d0e809252: start LeaderState
2019-06-13 12:04:37,818 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - fa2de56a-cf81-4e2b-8786-665d0e809252-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:37,818 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - fa2de56a-cf81-4e2b-8786-665d0e809252:group-DEC3C33B97D0 set configuration 0: [fa2de56a-cf81-4e2b-8786-665d0e809252:192.168.46.58:34875], old=null at 0
2019-06-13 12:04:37,858 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - fa2de56a-cf81-4e2b-8786-665d0e809252-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-4/data/ratis/238c4679-c1c5-45c7-b037-dec3c33b97d0/current/log_inprogress_0
2019-06-13 12:04:38,080 INFO  impl.FollowerState (FollowerState.java:run(101)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:group-94FAD45BD15A changes to CANDIDATE, lastRpcTime:1058, electionTimeout:1058ms
2019-06-13 12:04:38,080 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: shutdown FollowerState
2019-06-13 12:04:38,080 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:group-94FAD45BD15A changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:38,080 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: start LeaderElection
2019-06-13 12:04:38,090 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:group-94FAD45BD15A:LeaderElection63: begin an election at term 1 for -1: [090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:192.168.46.58:42811], old=null
2019-06-13 12:04:38,090 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: shutdown LeaderElection
2019-06-13 12:04:38,090 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:group-94FAD45BD15A changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:38,090 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:group-94FAD45BD15A change Leader from null to 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2 at term 1 for becomeLeader, leader elected after 1070ms
2019-06-13 12:04:38,090 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:38,090 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:38,090 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:38,090 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:38,090 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: start LeaderState
2019-06-13 12:04:38,091 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:38,091 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:group-94FAD45BD15A set configuration 0: [090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:192.168.46.58:42811], old=null at 0
2019-06-13 12:04:38,098 INFO  impl.FollowerState (FollowerState.java:run(101)) - fa2de56a-cf81-4e2b-8786-665d0e809252:group-BE87FA66CE98 changes to CANDIDATE, lastRpcTime:1023, electionTimeout:1023ms
2019-06-13 12:04:38,098 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - fa2de56a-cf81-4e2b-8786-665d0e809252: shutdown FollowerState
2019-06-13 12:04:38,098 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fa2de56a-cf81-4e2b-8786-665d0e809252:group-BE87FA66CE98 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:38,098 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fa2de56a-cf81-4e2b-8786-665d0e809252: start LeaderElection
2019-06-13 12:04:38,115 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - fa2de56a-cf81-4e2b-8786-665d0e809252:group-BE87FA66CE98:LeaderElection64: begin an election at term 1 for -1: [090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:192.168.46.58:42811, cf3e3df6-043d-46f8-b31e-9008a3fd3173:192.168.46.58:44501, fa2de56a-cf81-4e2b-8786-665d0e809252:192.168.46.58:34875], old=null
2019-06-13 12:04:38,136 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:group-BE87FA66CE98 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:fa2de56a-cf81-4e2b-8786-665d0e809252
2019-06-13 12:04:38,136 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173:group-BE87FA66CE98 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:fa2de56a-cf81-4e2b-8786-665d0e809252
2019-06-13 12:04:38,137 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: shutdown FollowerState
2019-06-13 12:04:38,137 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: shutdown FollowerState
2019-06-13 12:04:38,137 INFO  impl.FollowerState (FollowerState.java:run(109)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:04:38,137 INFO  impl.FollowerState (FollowerState.java:run(109)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:04:38,137 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: start FollowerState
2019-06-13 12:04:38,137 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: start FollowerState
2019-06-13 12:04:38,139 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-5/data/ratis/b13c479d-a2a7-422c-990f-94fad45bd15a/current/log_inprogress_0
2019-06-13 12:04:38,141 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - fa2de56a-cf81-4e2b-8786-665d0e809252:group-BE87FA66CE98:LeaderElection64: Election PASSED; received 1 response(s) [fa2de56a-cf81-4e2b-8786-665d0e809252->cf3e3df6-043d-46f8-b31e-9008a3fd3173,true-t1] and 0 exception(s); fa2de56a-cf81-4e2b-8786-665d0e809252:t1, leader=null, voted=fa2de56a-cf81-4e2b-8786-665d0e809252, raftlog=fa2de56a-cf81-4e2b-8786-665d0e809252-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:192.168.46.58:42811, cf3e3df6-043d-46f8-b31e-9008a3fd3173:192.168.46.58:44501, fa2de56a-cf81-4e2b-8786-665d0e809252:192.168.46.58:34875], old=null
2019-06-13 12:04:38,141 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - fa2de56a-cf81-4e2b-8786-665d0e809252: shutdown LeaderElection
2019-06-13 12:04:38,141 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fa2de56a-cf81-4e2b-8786-665d0e809252:group-BE87FA66CE98 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:38,141 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - fa2de56a-cf81-4e2b-8786-665d0e809252:group-BE87FA66CE98 change Leader from null to fa2de56a-cf81-4e2b-8786-665d0e809252 at term 1 for becomeLeader, leader elected after 1086ms
2019-06-13 12:04:38,142 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:38,142 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:38,142 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:38,142 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:38,142 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 12:04:38,142 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:38,142 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 12:04:38,142 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 12:04:38,142 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:38,142 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:38,143 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 12:04:38,143 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:38,143 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 12:04:38,143 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 12:04:38,143 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:38,143 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:04:38,143 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fa2de56a-cf81-4e2b-8786-665d0e809252: start LeaderState
2019-06-13 12:04:38,143 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - fa2de56a-cf81-4e2b-8786-665d0e809252-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:38,163 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:group-BE87FA66CE98 change Leader from null to fa2de56a-cf81-4e2b-8786-665d0e809252 at term 1 for appendEntries, leader elected after 1105ms
2019-06-13 12:04:38,164 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - fa2de56a-cf81-4e2b-8786-665d0e809252:group-BE87FA66CE98 set configuration 0: [090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:192.168.46.58:42811, cf3e3df6-043d-46f8-b31e-9008a3fd3173:192.168.46.58:44501, fa2de56a-cf81-4e2b-8786-665d0e809252:192.168.46.58:34875], old=null at 0
2019-06-13 12:04:38,165 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:group-BE87FA66CE98 set configuration 0: [090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:192.168.46.58:42811, cf3e3df6-043d-46f8-b31e-9008a3fd3173:192.168.46.58:44501, fa2de56a-cf81-4e2b-8786-665d0e809252:192.168.46.58:34875], old=null at 0
2019-06-13 12:04:38,166 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:38,166 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173:group-BE87FA66CE98 change Leader from null to fa2de56a-cf81-4e2b-8786-665d0e809252 at term 1 for appendEntries, leader elected after 1120ms
2019-06-13 12:04:38,191 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173:group-BE87FA66CE98 set configuration 0: [090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:192.168.46.58:42811, cf3e3df6-043d-46f8-b31e-9008a3fd3173:192.168.46.58:44501, fa2de56a-cf81-4e2b-8786-665d0e809252:192.168.46.58:34875], old=null at 0
2019-06-13 12:04:38,191 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - fa2de56a-cf81-4e2b-8786-665d0e809252-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-4/data/ratis/9b4907ba-3981-4865-96a4-be87fa66ce98/current/log_inprogress_0
2019-06-13 12:04:38,191 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:38,213 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-5/data/ratis/9b4907ba-3981-4865-96a4-be87fa66ce98/current/log_inprogress_0
2019-06-13 12:04:38,232 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-3/data/ratis/9b4907ba-3981-4865-96a4-be87fa66ce98/current/log_inprogress_0
2019-06-13 12:04:38,279 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Cluster is ready. Got 7 of 7 DN Heartbeats.
2019-06-13 12:04:38,307 INFO  rpc.RpcClient (RpcClient.java:createVolume(289)) - Creating Volume: watchforcommithandlingtest, with root as owner.
2019-06-13 12:04:38,321 INFO  rpc.RpcClient (RpcClient.java:createBucket(426)) - Creating Bucket: watchforcommithandlingtest/watchforcommithandlingtest, with Versioning false and Storage Type set to DISK and Encryption set to false 
2019-06-13 12:04:38,325 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:getStorageContainerLocationClient(241)) - Creating StorageContainerLocationProtocol RPC client with address /0.0.0.0:42723
2019-06-13 12:04:38,388 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-D091D294D82B->85f94b0e-1bb1-456b-8f06-53fefc76d6f3: receive RaftClientReply:client-D091D294D82B->85f94b0e-1bb1-456b-8f06-53fefc76d6f3@group-D7C7AD13668C, cid=63, SUCCESS, logIndex=1, commits[85f94b0e-1bb1-456b-8f06-53fefc76d6f3:c2, 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:c1, 7e4483e3-681f-4a91-91b6-3a576bda624f:c1]
2019-06-13 12:04:38,390 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:04:38,390 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@595184d8
2019-06-13 12:04:38,391 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:04:38,391 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:04:38,391 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: close
2019-06-13 12:04:38,392 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: shutdown group-D7C7AD13668C
2019-06-13 12:04:38,392 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D7C7AD13668C,id=85f94b0e-1bb1-456b-8f06-53fefc76d6f3
2019-06-13 12:04:38,392 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: shutdown LeaderState
2019-06-13 12:04:38,392 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3-PendingRequests: sendNotLeaderResponses
2019-06-13 12:04:38,392 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(85f94b0e-1bb1-456b-8f06-53fefc76d6f3 -> 7e4483e3-681f-4a91-91b6-3a576bda624f): Wait interrupted by java.lang.InterruptedException
2019-06-13 12:04:38,394 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: shutdown group-57A882C2BCD4
2019-06-13 12:04:38,392 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(85f94b0e-1bb1-456b-8f06-53fefc76d6f3 -> 9bcfb37b-fbe7-4cb4-9d87-b8763453400a): Wait interrupted by java.lang.InterruptedException
2019-06-13 12:04:38,394 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-57A882C2BCD4,id=85f94b0e-1bb1-456b-8f06-53fefc76d6f3
2019-06-13 12:04:38,395 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: shutdown LeaderState
2019-06-13 12:04:38,395 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3-PendingRequests: sendNotLeaderResponses
2019-06-13 12:04:38,395 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: appendEntries completed
2019-06-13 12:04:38,395 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: appendEntries completed
2019-06-13 12:04:38,397 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:04:38,397 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-85f94b0e-1bb1-456b-8f06-53fefc76d6f3-group-57A882C2BCD4: set stopIndex = 0
2019-06-13 12:04:38,402 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:group-57A882C2BCD4 closes. The last applied log index is 0
2019-06-13 12:04:38,401 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: follower 85f94b0e-1bb1-456b-8f06-53fefc76d6f3->7e4483e3-681f-4a91-91b6-3a576bda624f(c1,m2,n3, attendVote=true, lastRpcSendTime=53, lastRpcResponseTime=51) response Completed
2019-06-13 12:04:38,402 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3->7e4483e3-681f-4a91-91b6-3a576bda624f: nextIndex: updateUnconditionally 3 -> 0
2019-06-13 12:04:38,401 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: follower 85f94b0e-1bb1-456b-8f06-53fefc76d6f3->9bcfb37b-fbe7-4cb4-9d87-b8763453400a(c1,m2,n3, attendVote=true, lastRpcSendTime=53, lastRpcResponseTime=48) response Completed
2019-06-13 12:04:38,401 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-13 12:04:38,402 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3->9bcfb37b-fbe7-4cb4-9d87-b8763453400a: nextIndex: updateUnconditionally 3 -> 0
2019-06-13 12:04:38,401 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-85f94b0e-1bb1-456b-8f06-53fefc76d6f3-group-D7C7AD13668C: set stopIndex = 2
2019-06-13 12:04:38,402 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-0/data/ratis/6dc54a08-bc04-423b-989d-d7c7ad13668c/sm/snapshot.1_2
2019-06-13 12:04:38,402 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:38,403 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:group-D7C7AD13668C closes. The last applied log index is 2
2019-06-13 12:04:38,404 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:38,414 INFO  impl.FollowerState (FollowerState.java:run(101)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba:group-435D4B3A4553 changes to CANDIDATE, lastRpcTime:1077, electionTimeout:1073ms
2019-06-13 12:04:38,415 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba: shutdown FollowerState
2019-06-13 12:04:38,415 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba:group-435D4B3A4553 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:04:38,415 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba: start LeaderElection
2019-06-13 12:04:38,416 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3-RaftLogWorker close()
2019-06-13 12:04:38,436 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3-RaftLogWorker close()
2019-06-13 12:04:38,440 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: shutdown server with port 38463 now
2019-06-13 12:04:38,440 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba:group-435D4B3A4553:LeaderElection65: begin an election at term 1 for -1: [461b9a11-1c29-4c07-9f76-dd5706a3f9ba:192.168.46.58:35245], old=null
2019-06-13 12:04:38,441 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba: shutdown LeaderElection
2019-06-13 12:04:38,441 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba:group-435D4B3A4553 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:04:38,441 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba:group-435D4B3A4553 change Leader from null to 461b9a11-1c29-4c07-9f76-dd5706a3f9ba at term 1 for becomeLeader, leader elected after 1106ms
2019-06-13 12:04:38,441 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 85f94b0e-1bb1-456b-8f06-53fefc76d6f3: shutdown server with port 38463 successfully
2019-06-13 12:04:38,441 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:04:38,442 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:04:38,444 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:04:38,444 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:04:38,444 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:04:38,445 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba: start LeaderState
2019-06-13 12:04:38,445 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba-RaftLogWorker: Starting segment from index:0
2019-06-13 12:04:38,446 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba:group-435D4B3A4553 set configuration 0: [461b9a11-1c29-4c07-9f76-dd5706a3f9ba:192.168.46.58:35245], old=null at 0
2019-06-13 12:04:38,486 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1151, electionTimeout:1143ms
2019-06-13 12:04:38,486 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:38,489 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:04:38,489 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 30 for changeToCandidate
2019-06-13 12:04:38,489 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:38,495 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@57afe44b{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:04:38,496 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-6/data/ratis/508ed550-243b-4637-9c0c-435d4b3a4553/current/log_inprogress_0
2019-06-13 12:04:38,498 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@18887028{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:04:38,498 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@2125535d{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:04:38,498 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@73aae7a{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:04:38,498 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection66: begin an election at term 31 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:38,502 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:04:38,502 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@29ee8174
2019-06-13 12:04:38,504 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:04:38,504 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:04:38,505 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: close
2019-06-13 12:04:38,505 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: shutdown group-7EC93F7AEB63
2019-06-13 12:04:38,505 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-7EC93F7AEB63,id=7e4483e3-681f-4a91-91b6-3a576bda624f
2019-06-13 12:04:38,505 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: shutdown LeaderState
2019-06-13 12:04:38,506 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 7e4483e3-681f-4a91-91b6-3a576bda624f-PendingRequests: sendNotLeaderResponses
2019-06-13 12:04:38,506 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:04:38,506 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-7e4483e3-681f-4a91-91b6-3a576bda624f-group-7EC93F7AEB63: set stopIndex = 0
2019-06-13 12:04:38,506 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 7e4483e3-681f-4a91-91b6-3a576bda624f:group-7EC93F7AEB63 closes. The last applied log index is 0
2019-06-13 12:04:38,507 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 7e4483e3-681f-4a91-91b6-3a576bda624f-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:38,507 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection66 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:38,520 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection66 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:38,520 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection66: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t31, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:38,520 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:38,520 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:38,521 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 31 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:38,521 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:38,521 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:38,524 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 7e4483e3-681f-4a91-91b6-3a576bda624f-RaftLogWorker close()
2019-06-13 12:04:38,537 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: shutdown group-D7C7AD13668C
2019-06-13 12:04:38,537 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D7C7AD13668C,id=7e4483e3-681f-4a91-91b6-3a576bda624f
2019-06-13 12:04:38,538 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: shutdown FollowerState
2019-06-13 12:04:38,538 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-7e4483e3-681f-4a91-91b6-3a576bda624f-group-D7C7AD13668C: set stopIndex = 1
2019-06-13 12:04:38,540 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:1)
2019-06-13 12:04:38,541 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-2/data/ratis/6dc54a08-bc04-423b-989d-d7c7ad13668c/sm/snapshot.1_1
2019-06-13 12:04:38,541 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 7e4483e3-681f-4a91-91b6-3a576bda624f:group-D7C7AD13668C closes. The last applied log index is 1
2019-06-13 12:04:38,538 INFO  impl.FollowerState (FollowerState.java:run(109)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:04:38,541 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 7e4483e3-681f-4a91-91b6-3a576bda624f-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:38,543 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 7e4483e3-681f-4a91-91b6-3a576bda624f-RaftLogWorker close()
2019-06-13 12:04:38,546 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: shutdown server with port 35139 now
2019-06-13 12:04:38,547 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 7e4483e3-681f-4a91-91b6-3a576bda624f: shutdown server with port 35139 successfully
2019-06-13 12:04:38,548 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:04:38,567 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:04:38,567 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@13f182b9{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:04:38,568 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@5ee0cf64{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:04:38,568 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@3de383f7{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:04:38,568 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@7736c41e{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:04:39,598 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes to CANDIDATE, lastRpcTime:1246, electionTimeout:1112ms
2019-06-13 12:04:39,599 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown FollowerState
2019-06-13 12:04:39,599 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2019-06-13 12:04:39,599 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start LeaderElection
2019-06-13 12:04:39,599 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C change Leader from 85f94b0e-1bb1-456b-8f06-53fefc76d6f3 to null at term 1 for initElection
2019-06-13 12:04:39,603 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-D091D294D82B->9bcfb37b-fbe7-4cb4-9d87-b8763453400a@group-D7C7AD13668C, cid=64, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-D091D294D82B->9bcfb37b-fbe7-4cb4-9d87-b8763453400a@group-D7C7AD13668C, cid=64, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9bcfb37b-fbe7-4cb4-9d87-b8763453400a is not the leader (7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139). Request must be sent to leader., logIndex=0, commits[9bcfb37b-fbe7-4cb4-9d87-b8763453400a:c1, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:c1, 7e4483e3-681f-4a91-91b6-3a576bda624f:c0]
2019-06-13 12:04:39,607 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection67: begin an election at term 2 for 0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:39,608 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-D091D294D82B->9bcfb37b-fbe7-4cb4-9d87-b8763453400a: receive RaftClientReply:client-D091D294D82B->9bcfb37b-fbe7-4cb4-9d87-b8763453400a@group-D7C7AD13668C, cid=64, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9bcfb37b-fbe7-4cb4-9d87-b8763453400a is not the leader (7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139). Request must be sent to leader., logIndex=0, commits[9bcfb37b-fbe7-4cb4-9d87-b8763453400a:c1, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:c1, 7e4483e3-681f-4a91-91b6-3a576bda624f:c0]
2019-06-13 12:04:39,611 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection67 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:39,617 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-UnorderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:39,619 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection67 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:39,619 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection67: Election REJECTED; received 0 response(s) [] and 2 exception(s); 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:t2, leader=null, voted=9bcfb37b-fbe7-4cb4-9d87-b8763453400a, raftlog=9bcfb37b-fbe7-4cb4-9d87-b8763453400a-SegmentedRaftLog:OPENED:c1,f2,i2, conf=0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:39,619 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:39,619 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:39,619 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from CANDIDATE to FOLLOWER at term 2 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:39,619 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown LeaderElection
2019-06-13 12:04:39,619 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start FollowerState
2019-06-13 12:04:39,654 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1133, electionTimeout:1133ms
2019-06-13 12:04:39,654 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:39,654 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 31 for changeToCandidate
2019-06-13 12:04:39,654 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:39,657 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection68: begin an election at term 32 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:39,658 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection68 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:39,658 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection68 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:39,658 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection68: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t32, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:39,658 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:39,659 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:39,659 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 32 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:39,659 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:39,659 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:40,806 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes to CANDIDATE, lastRpcTime:1186, electionTimeout:1186ms
2019-06-13 12:04:40,806 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown FollowerState
2019-06-13 12:04:40,806 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2019-06-13 12:04:40,806 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start LeaderElection
2019-06-13 12:04:40,828 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1169, electionTimeout:1169ms
2019-06-13 12:04:40,828 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:40,829 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 32 for changeToCandidate
2019-06-13 12:04:40,829 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:41,095 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection69: begin an election at term 3 for 0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:41,095 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection70: begin an election at term 33 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:41,096 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection70 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:41,096 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection69 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:41,097 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection69 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:41,096 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection70 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:41,097 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection70: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t33, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:41,097 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:41,098 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:41,098 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 33 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:41,098 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:41,098 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:41,097 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection69: Election REJECTED; received 0 response(s) [] and 2 exception(s); 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:t3, leader=null, voted=9bcfb37b-fbe7-4cb4-9d87-b8763453400a, raftlog=9bcfb37b-fbe7-4cb4-9d87-b8763453400a-SegmentedRaftLog:OPENED:c1,f2,i2, conf=0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:41,098 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:41,098 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:41,101 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from CANDIDATE to FOLLOWER at term 3 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:41,101 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown LeaderElection
2019-06-13 12:04:41,102 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start FollowerState
2019-06-13 12:04:42,196 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1097, electionTimeout:1094ms
2019-06-13 12:04:42,196 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:42,196 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 33 for changeToCandidate
2019-06-13 12:04:42,196 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:42,202 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes to CANDIDATE, lastRpcTime:1100, electionTimeout:1100ms
2019-06-13 12:04:42,202 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown FollowerState
2019-06-13 12:04:42,202 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from FOLLOWER to CANDIDATE at term 3 for changeToCandidate
2019-06-13 12:04:42,202 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start LeaderElection
2019-06-13 12:04:42,258 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection71: begin an election at term 34 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:42,259 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection72: begin an election at term 4 for 0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:42,260 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection71 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:42,260 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection72 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:42,261 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection72 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:42,261 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection72: Election REJECTED; received 0 response(s) [] and 2 exception(s); 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:t4, leader=null, voted=9bcfb37b-fbe7-4cb4-9d87-b8763453400a, raftlog=9bcfb37b-fbe7-4cb4-9d87-b8763453400a-SegmentedRaftLog:OPENED:c1,f2,i2, conf=0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:42,261 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:42,261 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:42,262 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from CANDIDATE to FOLLOWER at term 4 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:42,262 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown LeaderElection
2019-06-13 12:04:42,262 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start FollowerState
2019-06-13 12:04:42,263 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection71 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:42,264 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection71: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t34, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:42,264 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:42,264 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:42,264 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 34 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:42,264 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:42,264 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:42,634 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-D091D294D82B->9bcfb37b-fbe7-4cb4-9d87-b8763453400a@group-D7C7AD13668C, cid=64, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-D091D294D82B->9bcfb37b-fbe7-4cb4-9d87-b8763453400a@group-D7C7AD13668C, cid=64, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9bcfb37b-fbe7-4cb4-9d87-b8763453400a is not the leader (85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463). Request must be sent to leader., logIndex=0, commits[9bcfb37b-fbe7-4cb4-9d87-b8763453400a:c1, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:c1, 7e4483e3-681f-4a91-91b6-3a576bda624f:c0]
2019-06-13 12:04:42,639 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-D091D294D82B->9bcfb37b-fbe7-4cb4-9d87-b8763453400a: receive RaftClientReply:client-D091D294D82B->9bcfb37b-fbe7-4cb4-9d87-b8763453400a@group-D7C7AD13668C, cid=64, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9bcfb37b-fbe7-4cb4-9d87-b8763453400a is not the leader (85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463). Request must be sent to leader., logIndex=0, commits[9bcfb37b-fbe7-4cb4-9d87-b8763453400a:c1, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:c1, 7e4483e3-681f-4a91-91b6-3a576bda624f:c0]
2019-06-13 12:04:42,642 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-UnorderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:43,395 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes to CANDIDATE, lastRpcTime:1132, electionTimeout:1132ms
2019-06-13 12:04:43,395 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown FollowerState
2019-06-13 12:04:43,395 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from FOLLOWER to CANDIDATE at term 4 for changeToCandidate
2019-06-13 12:04:43,395 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start LeaderElection
2019-06-13 12:04:43,422 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1157, electionTimeout:1156ms
2019-06-13 12:04:43,422 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:43,422 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 34 for changeToCandidate
2019-06-13 12:04:43,422 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:43,769 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection73: begin an election at term 5 for 0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:43,770 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection73 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:43,770 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection73 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:43,770 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection73: Election REJECTED; received 0 response(s) [] and 2 exception(s); 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:t5, leader=null, voted=9bcfb37b-fbe7-4cb4-9d87-b8763453400a, raftlog=9bcfb37b-fbe7-4cb4-9d87-b8763453400a-SegmentedRaftLog:OPENED:c1,f2,i2, conf=0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:43,770 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:43,771 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:43,771 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from CANDIDATE to FOLLOWER at term 5 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:43,771 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown LeaderElection
2019-06-13 12:04:43,771 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start FollowerState
2019-06-13 12:04:43,783 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection74: begin an election at term 35 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:43,784 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection74 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:43,784 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection74 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:43,784 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection74: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t35, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:43,785 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:43,785 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:43,785 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 35 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:43,785 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:43,785 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:44,654 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-D091D294D82B->9bcfb37b-fbe7-4cb4-9d87-b8763453400a@group-D7C7AD13668C, cid=64, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-D091D294D82B->9bcfb37b-fbe7-4cb4-9d87-b8763453400a@group-D7C7AD13668C, cid=64, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9bcfb37b-fbe7-4cb4-9d87-b8763453400a is not the leader (7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139). Request must be sent to leader., logIndex=0, commits[9bcfb37b-fbe7-4cb4-9d87-b8763453400a:c1, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:c1, 7e4483e3-681f-4a91-91b6-3a576bda624f:c0]
2019-06-13 12:04:44,659 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-D091D294D82B->9bcfb37b-fbe7-4cb4-9d87-b8763453400a: receive RaftClientReply:client-D091D294D82B->9bcfb37b-fbe7-4cb4-9d87-b8763453400a@group-D7C7AD13668C, cid=64, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9bcfb37b-fbe7-4cb4-9d87-b8763453400a is not the leader (7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139). Request must be sent to leader., logIndex=0, commits[9bcfb37b-fbe7-4cb4-9d87-b8763453400a:c1, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:c1, 7e4483e3-681f-4a91-91b6-3a576bda624f:c0]
2019-06-13 12:04:44,662 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 2-UnorderedRequestStreamObserver2: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:44,833 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1048, electionTimeout:1048ms
2019-06-13 12:04:44,834 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:44,834 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 35 for changeToCandidate
2019-06-13 12:04:44,834 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:44,837 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection75: begin an election at term 36 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:44,839 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection75 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:44,842 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection75 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:44,842 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection75: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t36, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:44,842 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:44,842 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:44,842 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 36 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:44,842 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:44,843 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:44,946 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes to CANDIDATE, lastRpcTime:1175, electionTimeout:1175ms
2019-06-13 12:04:44,946 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown FollowerState
2019-06-13 12:04:44,946 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from FOLLOWER to CANDIDATE at term 5 for changeToCandidate
2019-06-13 12:04:44,947 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start LeaderElection
2019-06-13 12:04:44,950 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection76: begin an election at term 6 for 0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:44,950 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection76 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:44,951 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection76 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:44,951 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection76: Election REJECTED; received 0 response(s) [] and 2 exception(s); 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:t6, leader=null, voted=9bcfb37b-fbe7-4cb4-9d87-b8763453400a, raftlog=9bcfb37b-fbe7-4cb4-9d87-b8763453400a-SegmentedRaftLog:OPENED:c1,f2,i2, conf=0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:44,951 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:44,952 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:44,953 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from CANDIDATE to FOLLOWER at term 6 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:44,953 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown LeaderElection
2019-06-13 12:04:44,953 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start FollowerState
2019-06-13 12:04:45,984 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1140, electionTimeout:1138ms
2019-06-13 12:04:45,984 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:45,984 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 36 for changeToCandidate
2019-06-13 12:04:45,984 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:45,988 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection77: begin an election at term 37 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:45,989 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection77 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:45,990 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection77 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:45,990 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection77: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t37, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:45,990 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:45,990 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:45,990 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 37 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:45,990 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:45,990 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:46,120 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes to CANDIDATE, lastRpcTime:1166, electionTimeout:1166ms
2019-06-13 12:04:46,120 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown FollowerState
2019-06-13 12:04:46,120 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from FOLLOWER to CANDIDATE at term 6 for changeToCandidate
2019-06-13 12:04:46,120 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start LeaderElection
2019-06-13 12:04:46,123 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection78: begin an election at term 7 for 0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:46,124 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection78 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:46,124 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection78 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:46,124 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection78: Election REJECTED; received 0 response(s) [] and 2 exception(s); 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:t7, leader=null, voted=9bcfb37b-fbe7-4cb4-9d87-b8763453400a, raftlog=9bcfb37b-fbe7-4cb4-9d87-b8763453400a-SegmentedRaftLog:OPENED:c1,f2,i2, conf=0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:46,125 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:46,125 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:46,125 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from CANDIDATE to FOLLOWER at term 7 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:46,125 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown LeaderElection
2019-06-13 12:04:46,125 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start FollowerState
2019-06-13 12:04:46,689 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-D091D294D82B->9bcfb37b-fbe7-4cb4-9d87-b8763453400a@group-D7C7AD13668C, cid=64, seq=0, Watch-ALL_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-D091D294D82B->9bcfb37b-fbe7-4cb4-9d87-b8763453400a@group-D7C7AD13668C, cid=64, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9bcfb37b-fbe7-4cb4-9d87-b8763453400a is not the leader (7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139). Request must be sent to leader., logIndex=0, commits[9bcfb37b-fbe7-4cb4-9d87-b8763453400a:c1, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:c1, 7e4483e3-681f-4a91-91b6-3a576bda624f:c0]
2019-06-13 12:04:46,694 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-D091D294D82B->9bcfb37b-fbe7-4cb4-9d87-b8763453400a: receive RaftClientReply:client-D091D294D82B->9bcfb37b-fbe7-4cb4-9d87-b8763453400a@group-D7C7AD13668C, cid=64, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9bcfb37b-fbe7-4cb4-9d87-b8763453400a is not the leader (7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139). Request must be sent to leader., logIndex=0, commits[9bcfb37b-fbe7-4cb4-9d87-b8763453400a:c1, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:c1, 7e4483e3-681f-4a91-91b6-3a576bda624f:c0]
2019-06-13 12:04:46,704 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 3-UnorderedRequestStreamObserver3: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:47,085 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1094, electionTimeout:1091ms
2019-06-13 12:04:47,085 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:47,085 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 37 for changeToCandidate
2019-06-13 12:04:47,085 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:47,088 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection79: begin an election at term 38 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:47,089 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection79 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:47,089 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection79 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:47,089 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection79: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t38, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:47,090 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:47,090 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:47,090 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 38 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:47,090 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:47,090 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:47,130 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes to CANDIDATE, lastRpcTime:1005, electionTimeout:1001ms
2019-06-13 12:04:47,131 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown FollowerState
2019-06-13 12:04:47,131 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from FOLLOWER to CANDIDATE at term 7 for changeToCandidate
2019-06-13 12:04:47,131 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start LeaderElection
2019-06-13 12:04:47,133 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection80: begin an election at term 8 for 0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:47,134 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection80 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:47,134 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection80 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:47,134 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection80: Election REJECTED; received 0 response(s) [] and 2 exception(s); 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:t8, leader=null, voted=9bcfb37b-fbe7-4cb4-9d87-b8763453400a, raftlog=9bcfb37b-fbe7-4cb4-9d87-b8763453400a-SegmentedRaftLog:OPENED:c1,f2,i2, conf=0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:47,134 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:47,135 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:47,135 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from CANDIDATE to FOLLOWER at term 8 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:47,135 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown LeaderElection
2019-06-13 12:04:47,135 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start FollowerState
2019-06-13 12:04:48,241 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes to CANDIDATE, lastRpcTime:1106, electionTimeout:1106ms
2019-06-13 12:04:48,241 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown FollowerState
2019-06-13 12:04:48,241 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from FOLLOWER to CANDIDATE at term 8 for changeToCandidate
2019-06-13 12:04:48,242 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start LeaderElection
2019-06-13 12:04:48,244 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection81: begin an election at term 9 for 0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:48,245 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection81 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:48,245 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection81 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:48,245 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection81: Election REJECTED; received 0 response(s) [] and 2 exception(s); 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:t9, leader=null, voted=9bcfb37b-fbe7-4cb4-9d87-b8763453400a, raftlog=9bcfb37b-fbe7-4cb4-9d87-b8763453400a-SegmentedRaftLog:OPENED:c1,f2,i2, conf=0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:48,246 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:48,246 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:48,246 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from CANDIDATE to FOLLOWER at term 9 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:48,246 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown LeaderElection
2019-06-13 12:04:48,246 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start FollowerState
2019-06-13 12:04:48,255 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1165, electionTimeout:1165ms
2019-06-13 12:04:48,255 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:48,255 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 38 for changeToCandidate
2019-06-13 12:04:48,255 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:48,259 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection82: begin an election at term 39 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:48,259 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection82 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:48,259 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection82 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:48,260 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection82: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t39, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:48,260 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:48,260 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:48,260 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 39 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:48,260 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:48,260 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:48,718 WARN  scm.XceiverClientRatis (XceiverClientRatis.java:watchForCommit(260)) - 3 way commit failed 
java.util.concurrent.ExecutionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-D091D294D82B->85f94b0e-1bb1-456b-8f06-53fefc76d6f3@group-D7C7AD13668C, cid=64, seq=0, Watch-ALL_COMMITTED(2), null for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms)
	at java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:357)
	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1915)
	at org.apache.hadoop.hdds.scm.XceiverClientRatis.watchForCommit(XceiverClientRatis.java:257)
	at org.apache.hadoop.ozone.client.rpc.TestWatchForCommit.testWatchForCommitForRetryfailure(TestWatchForCommit.java:347)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-D091D294D82B->85f94b0e-1bb1-456b-8f06-53fefc76d6f3@group-D7C7AD13668C, cid=64, seq=0, Watch-ALL_COMMITTED(2), null for 10 attempts with RetryLimited(maxAttempts=10, sleepTime=1000ms)
	at org.apache.ratis.client.impl.RaftClientImpl.newRaftRetryFailureException(RaftClientImpl.java:383)
	at org.apache.ratis.client.impl.UnorderedAsync.lambda$sendRequestWithRetry$4(UnorderedAsync.java:83)
	at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:760)
	at java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:736)
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:442)
	at java.lang.Thread.run(Thread.java:748)
2019-06-13 12:04:49,422 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1161, electionTimeout:1161ms
2019-06-13 12:04:49,422 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:49,422 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 39 for changeToCandidate
2019-06-13 12:04:49,422 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:49,424 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection83: begin an election at term 40 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:49,425 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection83 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:49,426 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection83 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:49,426 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection83: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t40, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:49,426 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:49,426 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:49,426 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 40 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:49,427 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:49,427 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:49,441 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes to CANDIDATE, lastRpcTime:1195, electionTimeout:1195ms
2019-06-13 12:04:49,441 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown FollowerState
2019-06-13 12:04:49,441 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from FOLLOWER to CANDIDATE at term 9 for changeToCandidate
2019-06-13 12:04:49,442 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start LeaderElection
2019-06-13 12:04:49,444 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection84: begin an election at term 10 for 0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:49,445 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection84 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:49,446 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection84 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:49,447 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection84: Election REJECTED; received 0 response(s) [] and 2 exception(s); 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:t10, leader=null, voted=9bcfb37b-fbe7-4cb4-9d87-b8763453400a, raftlog=9bcfb37b-fbe7-4cb4-9d87-b8763453400a-SegmentedRaftLog:OPENED:c1,f2,i2, conf=0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:49,447 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:49,448 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:49,448 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from CANDIDATE to FOLLOWER at term 10 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:49,448 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown LeaderElection
2019-06-13 12:04:49,448 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start FollowerState
2019-06-13 12:04:49,727 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-D091D294D82B->9bcfb37b-fbe7-4cb4-9d87-b8763453400a@group-D7C7AD13668C, cid=65, seq=0, Watch-MAJORITY_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-D091D294D82B->9bcfb37b-fbe7-4cb4-9d87-b8763453400a@group-D7C7AD13668C, cid=65, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9bcfb37b-fbe7-4cb4-9d87-b8763453400a is not the leader (7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139). Request must be sent to leader., logIndex=0, commits[9bcfb37b-fbe7-4cb4-9d87-b8763453400a:c1, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:c1, 7e4483e3-681f-4a91-91b6-3a576bda624f:c0]
2019-06-13 12:04:49,733 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-D091D294D82B->9bcfb37b-fbe7-4cb4-9d87-b8763453400a: receive RaftClientReply:client-D091D294D82B->9bcfb37b-fbe7-4cb4-9d87-b8763453400a@group-D7C7AD13668C, cid=65, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9bcfb37b-fbe7-4cb4-9d87-b8763453400a is not the leader (7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139). Request must be sent to leader., logIndex=0, commits[9bcfb37b-fbe7-4cb4-9d87-b8763453400a:c1, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:c1, 7e4483e3-681f-4a91-91b6-3a576bda624f:c0]
2019-06-13 12:04:49,737 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 4-UnorderedRequestStreamObserver4: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:50,509 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1081, electionTimeout:1079ms
2019-06-13 12:04:50,509 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:50,509 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 40 for changeToCandidate
2019-06-13 12:04:50,509 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:50,512 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection85: begin an election at term 41 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:50,513 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection85 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:50,513 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection85 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:50,513 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection85: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t41, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:50,513 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:50,514 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:50,514 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 41 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:50,514 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:50,514 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:50,544 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes to CANDIDATE, lastRpcTime:1096, electionTimeout:1096ms
2019-06-13 12:04:50,544 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown FollowerState
2019-06-13 12:04:50,544 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from FOLLOWER to CANDIDATE at term 10 for changeToCandidate
2019-06-13 12:04:50,545 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start LeaderElection
2019-06-13 12:04:50,547 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection86: begin an election at term 11 for 0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:50,548 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection86 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:50,548 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection86 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:50,548 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection86: Election REJECTED; received 0 response(s) [] and 2 exception(s); 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:t11, leader=null, voted=9bcfb37b-fbe7-4cb4-9d87-b8763453400a, raftlog=9bcfb37b-fbe7-4cb4-9d87-b8763453400a-SegmentedRaftLog:OPENED:c1,f2,i2, conf=0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:50,548 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:50,549 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:50,549 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from CANDIDATE to FOLLOWER at term 11 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:50,549 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown LeaderElection
2019-06-13 12:04:50,549 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start FollowerState
2019-06-13 12:04:51,551 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1037, electionTimeout:1035ms
2019-06-13 12:04:51,552 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:51,552 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 41 for changeToCandidate
2019-06-13 12:04:51,552 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:51,556 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection87: begin an election at term 42 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:51,556 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection87 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:51,557 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection87 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:51,557 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection87: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t42, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:51,557 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:51,557 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:51,557 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 42 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:51,557 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:51,557 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:51,674 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes to CANDIDATE, lastRpcTime:1124, electionTimeout:1124ms
2019-06-13 12:04:51,674 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown FollowerState
2019-06-13 12:04:51,674 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from FOLLOWER to CANDIDATE at term 11 for changeToCandidate
2019-06-13 12:04:51,674 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start LeaderElection
2019-06-13 12:04:51,676 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection88: begin an election at term 12 for 0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:51,677 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection88 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:51,677 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection88 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:51,678 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection88: Election REJECTED; received 0 response(s) [] and 2 exception(s); 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:t12, leader=null, voted=9bcfb37b-fbe7-4cb4-9d87-b8763453400a, raftlog=9bcfb37b-fbe7-4cb4-9d87-b8763453400a-SegmentedRaftLog:OPENED:c1,f2,i2, conf=0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:51,678 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:51,678 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:51,678 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from CANDIDATE to FOLLOWER at term 12 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:51,678 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown LeaderElection
2019-06-13 12:04:51,678 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start FollowerState
2019-06-13 12:04:52,648 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1090, electionTimeout:1090ms
2019-06-13 12:04:52,648 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:52,648 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 42 for changeToCandidate
2019-06-13 12:04:52,648 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:52,653 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection89: begin an election at term 43 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:52,654 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection89 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:52,654 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection89 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:52,654 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection89: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t43, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:52,654 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:52,654 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:52,654 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 43 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:52,654 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:52,654 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:52,779 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes to CANDIDATE, lastRpcTime:1100, electionTimeout:1097ms
2019-06-13 12:04:52,779 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown FollowerState
2019-06-13 12:04:52,779 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from FOLLOWER to CANDIDATE at term 12 for changeToCandidate
2019-06-13 12:04:52,779 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start LeaderElection
2019-06-13 12:04:52,782 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection90: begin an election at term 13 for 0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:52,783 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection90 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:52,783 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection90 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:52,783 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection90: Election REJECTED; received 0 response(s) [] and 2 exception(s); 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:t13, leader=null, voted=9bcfb37b-fbe7-4cb4-9d87-b8763453400a, raftlog=9bcfb37b-fbe7-4cb4-9d87-b8763453400a-SegmentedRaftLog:OPENED:c1,f2,i2, conf=0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:52,783 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:52,783 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:52,783 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from CANDIDATE to FOLLOWER at term 13 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:52,783 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown LeaderElection
2019-06-13 12:04:52,783 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start FollowerState
2019-06-13 12:04:53,800 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes to CANDIDATE, lastRpcTime:1016, electionTimeout:1016ms
2019-06-13 12:04:53,800 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown FollowerState
2019-06-13 12:04:53,800 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from FOLLOWER to CANDIDATE at term 13 for changeToCandidate
2019-06-13 12:04:53,800 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start LeaderElection
2019-06-13 12:04:53,804 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection91: begin an election at term 14 for 0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:53,805 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection91 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:53,805 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection91 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:53,805 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection91: Election REJECTED; received 0 response(s) [] and 2 exception(s); 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:t14, leader=null, voted=9bcfb37b-fbe7-4cb4-9d87-b8763453400a, raftlog=9bcfb37b-fbe7-4cb4-9d87-b8763453400a-SegmentedRaftLog:OPENED:c1,f2,i2, conf=0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:53,805 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:53,805 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:53,805 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from CANDIDATE to FOLLOWER at term 14 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:53,805 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown LeaderElection
2019-06-13 12:04:53,806 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start FollowerState
2019-06-13 12:04:53,846 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1191, electionTimeout:1191ms
2019-06-13 12:04:53,846 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:53,846 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 43 for changeToCandidate
2019-06-13 12:04:53,846 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:53,849 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection92: begin an election at term 44 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:53,850 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection92 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:53,850 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection92 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:53,850 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection92: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t44, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:53,850 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:53,850 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:53,851 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 44 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:53,851 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:53,851 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:54,947 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1096, electionTimeout:1096ms
2019-06-13 12:04:54,947 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:54,947 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 44 for changeToCandidate
2019-06-13 12:04:54,947 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:54,950 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection93: begin an election at term 45 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:54,955 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection93 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:54,959 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection93 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:54,959 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection93: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t45, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:54,959 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:54,960 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:54,960 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 45 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:54,960 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes to CANDIDATE, lastRpcTime:1154, electionTimeout:1152ms
2019-06-13 12:04:54,960 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown FollowerState
2019-06-13 12:04:54,960 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from FOLLOWER to CANDIDATE at term 14 for changeToCandidate
2019-06-13 12:04:54,960 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start LeaderElection
2019-06-13 12:04:54,960 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:54,963 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:54,967 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection94: begin an election at term 15 for 0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:54,971 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection94 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:54,976 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection94 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:54,976 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection94: Election REJECTED; received 0 response(s) [] and 2 exception(s); 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:t15, leader=null, voted=9bcfb37b-fbe7-4cb4-9d87-b8763453400a, raftlog=9bcfb37b-fbe7-4cb4-9d87-b8763453400a-SegmentedRaftLog:OPENED:c1,f2,i2, conf=0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:54,976 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:54,976 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:54,977 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from CANDIDATE to FOLLOWER at term 15 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:54,977 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown LeaderElection
2019-06-13 12:04:54,977 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start FollowerState
2019-06-13 12:04:55,793 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-D091D294D82B->9bcfb37b-fbe7-4cb4-9d87-b8763453400a@group-D7C7AD13668C, cid=65, seq=0, Watch-MAJORITY_COMMITTED(2), Message:<EMPTY>, reply=RaftClientReply:client-D091D294D82B->9bcfb37b-fbe7-4cb4-9d87-b8763453400a@group-D7C7AD13668C, cid=65, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9bcfb37b-fbe7-4cb4-9d87-b8763453400a is not the leader (85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463). Request must be sent to leader., logIndex=0, commits[9bcfb37b-fbe7-4cb4-9d87-b8763453400a:c1, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:c1, 7e4483e3-681f-4a91-91b6-3a576bda624f:c0]
2019-06-13 12:04:55,796 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-D091D294D82B->9bcfb37b-fbe7-4cb4-9d87-b8763453400a: receive RaftClientReply:client-D091D294D82B->9bcfb37b-fbe7-4cb4-9d87-b8763453400a@group-D7C7AD13668C, cid=65, FAILED org.apache.ratis.protocol.NotLeaderException: Server 9bcfb37b-fbe7-4cb4-9d87-b8763453400a is not the leader (85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463). Request must be sent to leader., logIndex=0, commits[9bcfb37b-fbe7-4cb4-9d87-b8763453400a:c1, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:c1, 7e4483e3-681f-4a91-91b6-3a576bda624f:c0]
2019-06-13 12:04:55,798 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 5-UnorderedRequestStreamObserver5: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:56,103 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1140, electionTimeout:1138ms
2019-06-13 12:04:56,103 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:56,103 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 45 for changeToCandidate
2019-06-13 12:04:56,103 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:56,147 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes to CANDIDATE, lastRpcTime:1170, electionTimeout:1166ms
2019-06-13 12:04:56,148 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown FollowerState
2019-06-13 12:04:56,148 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from FOLLOWER to CANDIDATE at term 15 for changeToCandidate
2019-06-13 12:04:56,148 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start LeaderElection
2019-06-13 12:04:56,258 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection95: begin an election at term 46 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:56,258 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection96: begin an election at term 16 for 0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:56,258 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection95 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:56,259 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection95 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:56,259 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection95: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t46, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:56,259 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:56,260 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:56,260 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 46 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:56,260 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:56,260 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:56,261 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection96 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:56,262 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection96 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:56,262 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection96: Election REJECTED; received 0 response(s) [] and 2 exception(s); 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:t16, leader=null, voted=9bcfb37b-fbe7-4cb4-9d87-b8763453400a, raftlog=9bcfb37b-fbe7-4cb4-9d87-b8763453400a-SegmentedRaftLog:OPENED:c1,f2,i2, conf=0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:56,262 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:56,262 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:56,262 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from CANDIDATE to FOLLOWER at term 16 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:56,262 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown LeaderElection
2019-06-13 12:04:56,262 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start FollowerState
2019-06-13 12:04:57,358 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1097, electionTimeout:1097ms
2019-06-13 12:04:57,358 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:57,358 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 46 for changeToCandidate
2019-06-13 12:04:57,358 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:57,457 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes to CANDIDATE, lastRpcTime:1194, electionTimeout:1194ms
2019-06-13 12:04:57,457 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown FollowerState
2019-06-13 12:04:57,457 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from FOLLOWER to CANDIDATE at term 16 for changeToCandidate
2019-06-13 12:04:57,457 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start LeaderElection
2019-06-13 12:04:57,480 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection97: begin an election at term 47 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:57,480 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection97 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:57,480 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection98: begin an election at term 17 for 0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:57,481 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection98 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:57,481 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection98 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:57,482 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection97 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:57,482 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection98: Election REJECTED; received 0 response(s) [] and 2 exception(s); 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:t17, leader=null, voted=9bcfb37b-fbe7-4cb4-9d87-b8763453400a, raftlog=9bcfb37b-fbe7-4cb4-9d87-b8763453400a-SegmentedRaftLog:OPENED:c1,f2,i2, conf=0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:57,482 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection97: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t47, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:57,482 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:57,482 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:57,482 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:57,482 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:57,483 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 47 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:57,483 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:57,483 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from CANDIDATE to FOLLOWER at term 17 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:57,483 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:57,483 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown LeaderElection
2019-06-13 12:04:57,483 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start FollowerState
2019-06-13 12:04:58,534 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes to CANDIDATE, lastRpcTime:1051, electionTimeout:1051ms
2019-06-13 12:04:58,534 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown FollowerState
2019-06-13 12:04:58,534 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from FOLLOWER to CANDIDATE at term 17 for changeToCandidate
2019-06-13 12:04:58,535 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start LeaderElection
2019-06-13 12:04:58,537 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection99: begin an election at term 18 for 0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:58,538 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection99 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:58,538 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection99 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:58,538 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C:LeaderElection99: Election REJECTED; received 0 response(s) [] and 2 exception(s); 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:t18, leader=null, voted=9bcfb37b-fbe7-4cb4-9d87-b8763453400a, raftlog=9bcfb37b-fbe7-4cb4-9d87-b8763453400a-SegmentedRaftLog:OPENED:c1,f2,i2, conf=0: [9bcfb37b-fbe7-4cb4-9d87-b8763453400a:192.168.46.58:41371, 85f94b0e-1bb1-456b-8f06-53fefc76d6f3:192.168.46.58:38463, 7e4483e3-681f-4a91-91b6-3a576bda624f:192.168.46.58:35139], old=null
2019-06-13 12:04:58,539 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38463
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:58,539 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:35139
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:58,539 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C changes role from CANDIDATE to FOLLOWER at term 18 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:58,539 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown LeaderElection
2019-06-13 12:04:58,539 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: start FollowerState
2019-06-13 12:04:58,566 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1083, electionTimeout:1083ms
2019-06-13 12:04:58,566 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:58,566 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 47 for changeToCandidate
2019-06-13 12:04:58,566 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:58,568 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection100: begin an election at term 48 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:58,569 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection100 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:58,569 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection100 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:58,569 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection100: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t48, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:58,569 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:58,570 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:58,570 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 48 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:58,570 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:58,570 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:58,814 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:shutdown(321)) - Shutting down the Mini Ozone Cluster
2019-06-13 12:04:58,815 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(336)) - Stopping the Mini Ozone Cluster
2019-06-13 12:04:58,815 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(338)) - Stopping the OzoneManager
2019-06-13 12:04:58,815 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 39669
2019-06-13 12:04:58,832 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service KeyDeletingService
2019-06-13 12:04:58,832 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-13 12:04:58,833 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 39669
2019-06-13 12:04:58,836 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@4b511e61{/,null,UNAVAILABLE}{/ozoneManager}
2019-06-13 12:04:58,836 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@74a74070{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:04:58,836 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@4888425d{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,UNAVAILABLE}
2019-06-13 12:04:58,837 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@545f0b6{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:04:58,838 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(344)) - Stopping the StorageContainerManager
2019-06-13 12:04:58,838 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(789)) - Stopping Replication Manager Service.
2019-06-13 12:04:58,838 INFO  container.ReplicationManager (ReplicationManager.java:stop(191)) - Replication Monitor Thread is not running.
2019-06-13 12:04:58,838 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(796)) - Stopping Lease Manager of the command watchers
2019-06-13 12:04:58,838 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(803)) - Stopping datanode service RPC server
2019-06-13 12:04:58,838 INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(373)) - Stopping the RPC server for DataNodes
2019-06-13 12:04:58,839 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 33015
2019-06-13 12:04:58,841 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 33015
2019-06-13 12:04:58,841 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-13 12:04:58,841 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(811)) - Stopping block service RPC server
2019-06-13 12:04:58,843 INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(145)) - Stopping the RPC server for Block Protocol
2019-06-13 12:04:58,843 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 43307
2019-06-13 12:04:58,846 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 43307
2019-06-13 12:04:58,846 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(818)) - Stopping the StorageContainerLocationProtocol RPC server
2019-06-13 12:04:58,847 INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(157)) - Stopping the RPC server for Client Protocol
2019-06-13 12:04:58,847 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-13 12:04:58,848 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 42723
2019-06-13 12:04:58,853 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(825)) - Stopping Storage Container Manager HTTP server.
2019-06-13 12:04:58,853 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 42723
2019-06-13 12:04:58,854 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@5e360c3b{/,null,UNAVAILABLE}{/scm}
2019-06-13 12:04:58,855 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-13 12:04:58,859 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@24ac6fef{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:04:58,859 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@408d945b{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,UNAVAILABLE}
2019-06-13 12:04:58,859 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@50b38342{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:04:58,860 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(836)) - Stopping Block Manager Service.
2019-06-13 12:04:58,860 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service SCMBlockDeletingService
2019-06-13 12:04:58,861 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service SCMBlockDeletingService
2019-06-13 12:04:58,862 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(858)) - Stopping SCM Event Queue.
2019-06-13 12:04:58,865 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(350)) - Shutting the HddsDatanodes
2019-06-13 12:04:58,865 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:04:58,865 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@58ac0823
2019-06-13 12:04:58,866 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:04:58,866 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:04:58,866 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: close
2019-06-13 12:04:58,867 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown group-D7C7AD13668C
2019-06-13 12:04:58,867 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D7C7AD13668C,id=9bcfb37b-fbe7-4cb4-9d87-b8763453400a
2019-06-13 12:04:58,867 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown FollowerState
2019-06-13 12:04:58,867 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown group-D78BEEA9F006
2019-06-13 12:04:58,867 INFO  impl.FollowerState (FollowerState.java:run(109)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:04:58,867 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:1)
2019-06-13 12:04:58,868 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4cb6a8d1-76ab-4157-80df-828ac4613ca9/datanode-1/data/ratis/6dc54a08-bc04-423b-989d-d7c7ad13668c/sm/snapshot.1_1
2019-06-13 12:04:58,867 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D78BEEA9F006,id=9bcfb37b-fbe7-4cb4-9d87-b8763453400a
2019-06-13 12:04:58,868 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown LeaderState
2019-06-13 12:04:58,868 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a-PendingRequests: sendNotLeaderResponses
2019-06-13 12:04:58,868 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-9bcfb37b-fbe7-4cb4-9d87-b8763453400a-group-D78BEEA9F006: set stopIndex = 0
2019-06-13 12:04:58,868 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:04:58,868 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-9bcfb37b-fbe7-4cb4-9d87-b8763453400a-group-D7C7AD13668C: set stopIndex = 1
2019-06-13 12:04:58,869 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D7C7AD13668C closes. The last applied log index is 1
2019-06-13 12:04:58,869 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a:group-D78BEEA9F006 closes. The last applied log index is 0
2019-06-13 12:04:58,869 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:58,869 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:58,872 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a-RaftLogWorker close()
2019-06-13 12:04:58,872 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a-RaftLogWorker close()
2019-06-13 12:04:58,881 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown server with port 41371 now
2019-06-13 12:04:58,882 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 9bcfb37b-fbe7-4cb4-9d87-b8763453400a: shutdown server with port 41371 successfully
2019-06-13 12:04:58,887 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:04:58,897 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:04:58,898 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@701c482e{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:04:58,900 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@4738131e{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:04:58,900 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@5ad50b02{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:04:58,900 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@74450c9b{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:04:58,901 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:04:58,901 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@31a4db4f
2019-06-13 12:04:58,902 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:04:58,902 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:04:58,902 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: close
2019-06-13 12:04:58,903 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: shutdown group-BE87FA66CE98
2019-06-13 12:04:58,903 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-BE87FA66CE98,id=cf3e3df6-043d-46f8-b31e-9008a3fd3173
2019-06-13 12:04:58,903 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: shutdown FollowerState
2019-06-13 12:04:58,903 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-cf3e3df6-043d-46f8-b31e-9008a3fd3173-group-BE87FA66CE98: set stopIndex = 0
2019-06-13 12:04:58,903 INFO  impl.FollowerState (FollowerState.java:run(109)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:04:58,903 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:04:58,903 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173:group-BE87FA66CE98 closes. The last applied log index is 0
2019-06-13 12:04:58,904 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:58,905 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173-RaftLogWorker close()
2019-06-13 12:04:58,907 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: shutdown group-5470BB6E7F9E
2019-06-13 12:04:58,907 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-5470BB6E7F9E,id=cf3e3df6-043d-46f8-b31e-9008a3fd3173
2019-06-13 12:04:58,907 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: shutdown LeaderState
2019-06-13 12:04:58,907 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173-PendingRequests: sendNotLeaderResponses
2019-06-13 12:04:58,907 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-cf3e3df6-043d-46f8-b31e-9008a3fd3173-group-5470BB6E7F9E: set stopIndex = 0
2019-06-13 12:04:58,907 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:04:58,908 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173:group-5470BB6E7F9E closes. The last applied log index is 0
2019-06-13 12:04:58,908 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:58,909 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173-RaftLogWorker close()
2019-06-13 12:04:58,911 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: shutdown server with port 44501 now
2019-06-13 12:04:58,911 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:04:58,911 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - cf3e3df6-043d-46f8-b31e-9008a3fd3173: shutdown server with port 44501 successfully
2019-06-13 12:04:58,912 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - fa2de56a-cf81-4e2b-8786-665d0e809252: Failed appendEntries to cf3e3df6-043d-46f8-b31e-9008a3fd3173:192.168.46.58:44501: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-13 12:04:58,912 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fa2de56a-cf81-4e2b-8786-665d0e809252->cf3e3df6-043d-46f8-b31e-9008a3fd3173: nextIndex: updateUnconditionally 1 -> 0
2019-06-13 12:04:58,912 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:04:58,924 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:04:58,924 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@21ba0d33{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:04:58,924 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@afb7b03{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:04:58,925 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@24d0c6a4{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:04:58,925 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@3605ab16{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:04:58,927 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:04:58,927 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@630c3af3
2019-06-13 12:04:58,927 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:04:58,928 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:04:58,928 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - fa2de56a-cf81-4e2b-8786-665d0e809252: close
2019-06-13 12:04:58,928 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - fa2de56a-cf81-4e2b-8786-665d0e809252: shutdown group-DEC3C33B97D0
2019-06-13 12:04:58,928 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-DEC3C33B97D0,id=fa2de56a-cf81-4e2b-8786-665d0e809252
2019-06-13 12:04:58,929 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - fa2de56a-cf81-4e2b-8786-665d0e809252: shutdown LeaderState
2019-06-13 12:04:58,929 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - fa2de56a-cf81-4e2b-8786-665d0e809252-PendingRequests: sendNotLeaderResponses
2019-06-13 12:04:58,929 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-fa2de56a-cf81-4e2b-8786-665d0e809252-group-DEC3C33B97D0: set stopIndex = 0
2019-06-13 12:04:58,929 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:04:58,929 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - fa2de56a-cf81-4e2b-8786-665d0e809252:group-DEC3C33B97D0 closes. The last applied log index is 0
2019-06-13 12:04:58,930 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - fa2de56a-cf81-4e2b-8786-665d0e809252-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:58,931 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - fa2de56a-cf81-4e2b-8786-665d0e809252-RaftLogWorker close()
2019-06-13 12:04:58,933 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - fa2de56a-cf81-4e2b-8786-665d0e809252: shutdown group-BE87FA66CE98
2019-06-13 12:04:58,933 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-BE87FA66CE98,id=fa2de56a-cf81-4e2b-8786-665d0e809252
2019-06-13 12:04:58,933 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - fa2de56a-cf81-4e2b-8786-665d0e809252: shutdown LeaderState
2019-06-13 12:04:58,933 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - fa2de56a-cf81-4e2b-8786-665d0e809252-PendingRequests: sendNotLeaderResponses
2019-06-13 12:04:58,933 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(fa2de56a-cf81-4e2b-8786-665d0e809252 -> 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2): Wait interrupted by java.lang.InterruptedException
2019-06-13 12:04:58,934 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-fa2de56a-cf81-4e2b-8786-665d0e809252-group-BE87FA66CE98: set stopIndex = 0
2019-06-13 12:04:58,933 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(fa2de56a-cf81-4e2b-8786-665d0e809252 -> cf3e3df6-043d-46f8-b31e-9008a3fd3173): Wait interrupted by java.lang.InterruptedException
2019-06-13 12:04:58,934 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: appendEntries completed
2019-06-13 12:04:58,934 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:04:58,934 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - fa2de56a-cf81-4e2b-8786-665d0e809252:group-BE87FA66CE98 closes. The last applied log index is 0
2019-06-13 12:04:58,934 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - fa2de56a-cf81-4e2b-8786-665d0e809252-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:58,934 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - fa2de56a-cf81-4e2b-8786-665d0e809252: follower fa2de56a-cf81-4e2b-8786-665d0e809252->090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2(c0,m0,n1, attendVote=true, lastRpcSendTime=149, lastRpcResponseTime=149) response Completed
2019-06-13 12:04:58,935 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fa2de56a-cf81-4e2b-8786-665d0e809252->090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: nextIndex: updateUnconditionally 1 -> -1
2019-06-13 12:04:58,936 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - fa2de56a-cf81-4e2b-8786-665d0e809252-RaftLogWorker close()
2019-06-13 12:04:58,938 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - fa2de56a-cf81-4e2b-8786-665d0e809252: shutdown server with port 34875 now
2019-06-13 12:04:58,939 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - fa2de56a-cf81-4e2b-8786-665d0e809252: shutdown server with port 34875 successfully
2019-06-13 12:04:58,940 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:04:58,951 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:04:58,951 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@35840ecc{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:04:58,952 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@67fd2e17{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:04:58,952 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@237aba92{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:04:58,952 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@2ae4c424{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:04:58,952 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:04:58,953 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@63c6c5e5
2019-06-13 12:04:58,953 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:04:58,953 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:04:58,953 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: close
2019-06-13 12:04:58,953 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: shutdown group-BE87FA66CE98
2019-06-13 12:04:58,954 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-BE87FA66CE98,id=090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2
2019-06-13 12:04:58,954 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: shutdown FollowerState
2019-06-13 12:04:58,954 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2-group-BE87FA66CE98: set stopIndex = 0
2019-06-13 12:04:58,954 INFO  impl.FollowerState (FollowerState.java:run(109)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:04:58,954 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:04:58,954 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:group-BE87FA66CE98 closes. The last applied log index is 0
2019-06-13 12:04:58,954 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:58,956 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2-RaftLogWorker close()
2019-06-13 12:04:58,958 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: shutdown group-94FAD45BD15A
2019-06-13 12:04:58,959 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-94FAD45BD15A,id=090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2
2019-06-13 12:04:58,959 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: shutdown LeaderState
2019-06-13 12:04:58,959 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2-PendingRequests: sendNotLeaderResponses
2019-06-13 12:04:58,959 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2-group-94FAD45BD15A: set stopIndex = 0
2019-06-13 12:04:58,959 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:04:58,960 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2:group-94FAD45BD15A closes. The last applied log index is 0
2019-06-13 12:04:58,960 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:58,961 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2-RaftLogWorker close()
2019-06-13 12:04:58,963 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: shutdown server with port 42811 now
2019-06-13 12:04:58,963 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 090a1ea0-1be1-4205-b3c8-d1be6cdb0ec2: shutdown server with port 42811 successfully
2019-06-13 12:04:58,965 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:04:58,979 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:04:58,980 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@7120daa6{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:04:58,980 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@6cbb6c41{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:04:58,980 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@60fe75f7{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:04:58,980 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@416c1b0{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:04:58,981 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:04:58,981 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@5357de0e
2019-06-13 12:04:58,982 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:04:58,982 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:04:58,982 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba: close
2019-06-13 12:04:58,983 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba: shutdown group-435D4B3A4553
2019-06-13 12:04:58,983 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-435D4B3A4553,id=461b9a11-1c29-4c07-9f76-dd5706a3f9ba
2019-06-13 12:04:58,983 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba: shutdown LeaderState
2019-06-13 12:04:58,983 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba-PendingRequests: sendNotLeaderResponses
2019-06-13 12:04:58,984 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-461b9a11-1c29-4c07-9f76-dd5706a3f9ba-group-435D4B3A4553: set stopIndex = 0
2019-06-13 12:04:58,984 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:04:58,984 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba:group-435D4B3A4553 closes. The last applied log index is 0
2019-06-13 12:04:58,984 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:04:58,985 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba-RaftLogWorker close()
2019-06-13 12:04:58,987 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba: shutdown server with port 35245 now
2019-06-13 12:04:58,988 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 461b9a11-1c29-4c07-9f76-dd5706a3f9ba: shutdown server with port 35245 successfully
2019-06-13 12:04:58,989 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:04:58,998 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:04:58,998 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@5300694d{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:04:58,999 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@7320750c{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:04:58,999 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@52fec840{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:04:58,999 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@1d3e5a05{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:04:59,018 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:59,022 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:59,023 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:59,023 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedBlocks
2019-06-13 12:04:59,023 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedBlocks
2019-06-13 12:04:59,023 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: validCerts
2019-06-13 12:04:59,024 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:validCerts
2019-06-13 12:04:59,024 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: revokedCerts
2019-06-13 12:04:59,024 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:revokedCerts
2019-06-13 12:04:59,024 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-13 12:04:59,024 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-13 12:04:59,024 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-13 12:04:59,067 INFO  node.SCMNodeManager (SCMNodeManager.java:<init>(108)) - Entering startup safe mode.
2019-06-13 12:04:59,067 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(125)) - Loading file from sun.misc.CompoundEnumeration@3dad8bde
2019-06-13 12:04:59,068 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(171)) - Loading network topology layer schema file
2019-06-13 12:04:59,070 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:59,082 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:initializePipelineState(126)) - No pipeline exists in current db
2019-06-13 12:04:59,082 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:59,096 WARN  events.EventQueue (EventQueue.java:fireEvent(175)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='SafeModeStatus'}
2019-06-13 12:04:59,097 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-13 12:04:59,098 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 39367
2019-06-13 12:04:59,100 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-13 12:04:59,101 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 37459
2019-06-13 12:04:59,104 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-13 12:04:59,105 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 33335
2019-06-13 12:04:59,107 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for scm at: http://0.0.0.0:0
2019-06-13 12:04:59,108 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:59,109 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:59,110 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:59,110 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context scm
2019-06-13 12:04:59,110 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:59,110 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:59,113 INFO  server.StorageContainerManager (StorageContainerManager.java:start(752)) - StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:33335
2019-06-13 12:04:59,113 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - StorageContainerManager metrics system started (again)
2019-06-13 12:04:59,113 INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:start(149)) - RPC server for Client  is listening at /0.0.0.0:33335
2019-06-13 12:04:59,113 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-13 12:04:59,113 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 33335: starting
2019-06-13 12:04:59,119 INFO  server.StorageContainerManager (StorageContainerManager.java:start(761)) - ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:37459
2019-06-13 12:04:59,119 INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:start(137)) - RPC server for Block Protocol is listening at /0.0.0.0:37459
2019-06-13 12:04:59,119 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-13 12:04:59,119 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 37459: starting
2019-06-13 12:04:59,130 INFO  server.StorageContainerManager (StorageContainerManager.java:start(765)) - ScmDatanodeProtocl RPC server is listening at /0.0.0.0:39367
2019-06-13 12:04:59,130 INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:start(191)) - RPC server for DataNodes is listening at /0.0.0.0:39367
2019-06-13 12:04:59,130 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-13 12:04:59,132 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 39367: starting
2019-06-13 12:04:59,135 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 37507
2019-06-13 12:04:59,135 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:04:59,136 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@2fe38b73{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:04:59,136 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@7aef8000{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-13 12:04:59,139 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@2acbe46d{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/scm/,AVAILABLE}{/scm}
2019-06-13 12:04:59,139 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@6c6b00f1{HTTP/1.1,[http/1.1]}{0.0.0.0:37507}
2019-06-13 12:04:59,140 INFO  server.Server (Server.java:doStart(419)) - Started @68361ms
2019-06-13 12:04:59,141 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of SCM is listening at http://0.0.0.0:37507
2019-06-13 12:04:59,142 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:59,142 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:04:59,145 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:59,145 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(519)) - OM Service ID is not set. Setting it to the default ID: omServiceIdDefault
2019-06-13 12:04:59,145 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(525)) - OM Node ID is not set. Setting it to the OmStorage's OmID: 3058f4d5-4c3e-4848-9dfd-098507a8df04
2019-06-13 12:04:59,145 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 12:04:59,145 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 12:04:59,145 INFO  om.OzoneManager (OzoneManager.java:loadOMHAConfigs(476)) - Found matching OM address with OMServiceId: null, OMNodeId: null, RPC Address: localhost:0 and Ratis port: 9872
2019-06-13 12:04:59,152 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:59,152 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: userTable
2019-06-13 12:04:59,152 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:userTable
2019-06-13 12:04:59,152 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: volumeTable
2019-06-13 12:04:59,152 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:volumeTable
2019-06-13 12:04:59,152 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: bucketTable
2019-06-13 12:04:59,153 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:bucketTable
2019-06-13 12:04:59,153 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: keyTable
2019-06-13 12:04:59,153 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:keyTable
2019-06-13 12:04:59,153 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedTable
2019-06-13 12:04:59,153 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedTable
2019-06-13 12:04:59,153 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: openKeyTable
2019-06-13 12:04:59,153 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:openKeyTable
2019-06-13 12:04:59,153 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3Table
2019-06-13 12:04:59,154 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3Table
2019-06-13 12:04:59,154 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: multipartInfoTable
2019-06-13 12:04:59,154 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:multipartInfoTable
2019-06-13 12:04:59,154 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: dTokenTable
2019-06-13 12:04:59,154 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:dTokenTable
2019-06-13 12:04:59,154 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3SecretTable
2019-06-13 12:04:59,154 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3SecretTable
2019-06-13 12:04:59,154 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: prefixTable
2019-06-13 12:04:59,154 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:prefixTable
2019-06-13 12:04:59,155 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-13 12:04:59,155 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-13 12:04:59,155 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-13 12:04:59,289 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-13 12:04:59,290 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 44353
2019-06-13 12:04:59,305 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:04:59,306 INFO  om.OzoneManager (OzoneManager.java:start(1217)) - OzoneManager RPC server is listening at localhost/127.0.0.1:44353
2019-06-13 12:04:59,306 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - OzoneManager metrics system started (again)
2019-06-13 12:04:59,306 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-13 12:04:59,308 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 44353: starting
2019-06-13 12:04:59,312 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for ozoneManager at: http://0.0.0.0:0
2019-06-13 12:04:59,313 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:59,313 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:59,314 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:59,315 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context ozoneManager
2019-06-13 12:04:59,315 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:59,315 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:59,315 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 36197
2019-06-13 12:04:59,315 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:04:59,319 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@210e2f2f{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:04:59,320 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@43dddfdd{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-13 12:04:59,322 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@544300a6{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/ozoneManager/,AVAILABLE}{/ozoneManager}
2019-06-13 12:04:59,322 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@4c12f54a{HTTP/1.1,[http/1.1]}{0.0.0.0:36197}
2019-06-13 12:04:59,323 INFO  server.Server (Server.java:doStart(419)) - Started @68544ms
2019-06-13 12:04:59,324 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of OZONEMANAGER is listening at http://0.0.0.0:36197
2019-06-13 12:04:59,334 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:04:59,334 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:04:59,340 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-0/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:04:59,340 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-0/data/containers/hdds to VolumeSet
2019-06-13 12:04:59,340 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@77972964
2019-06-13 12:04:59,341 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@77972964
2019-06-13 12:04:59,350 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 44547
2019-06-13 12:04:59,352 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:04:59,352 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 44547 (custom)
2019-06-13 12:04:59,352 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:04:59,352 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:59,353 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:04:59,353 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:59,353 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-0/data/ratis] (custom)
2019-06-13 12:04:59,353 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42619
2019-06-13 12:04:59,353 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:04:59,354 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:04:59,355 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:59,355 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:59,356 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:59,356 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:04:59,356 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:59,356 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:59,357 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 34965
2019-06-13 12:04:59,357 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:04:59,358 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@201b52f7{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:04:59,359 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@57806346{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:04:59,382 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@18fa5af6{/,file:///tmp/jetty-0.0.0.0-34965-hddsDatanode-_-any-3800995561282747227.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:04:59,382 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@7fdabb3b{HTTP/1.1,[http/1.1]}{0.0.0.0:34965}
2019-06-13 12:04:59,384 INFO  server.Server (Server.java:doStart(419)) - Started @68605ms
2019-06-13 12:04:59,385 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:34965
Jun 13, 2019 12:04:59 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:04:59,465 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@2d2afc39
2019-06-13 12:04:59,466 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:04:59,466 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:04:59,466 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:04:59,467 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-0/meta/datanode.id
2019-06-13 12:04:59,471 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-1/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:04:59,472 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-1/data/containers/hdds to VolumeSet
2019-06-13 12:04:59,472 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@bc88295
2019-06-13 12:04:59,472 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@bc88295
2019-06-13 12:04:59,481 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 42079
2019-06-13 12:04:59,483 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:04:59,483 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42079 (custom)
2019-06-13 12:04:59,483 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:04:59,483 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:59,483 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:04:59,483 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:59,484 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-1/data/ratis] (custom)
2019-06-13 12:04:59,484 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 44223
2019-06-13 12:04:59,484 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:04:59,485 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:04:59,485 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:59,486 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:59,486 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:59,487 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:04:59,487 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:59,487 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:59,487 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 37683
2019-06-13 12:04:59,487 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:04:59,488 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@556944cd{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:04:59,489 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@7e017f47{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:04:59,508 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@7962c1d5{/,file:///tmp/jetty-0.0.0.0-37683-hddsDatanode-_-any-6126582618396450184.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:04:59,508 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@56226064{HTTP/1.1,[http/1.1]}{0.0.0.0:37683}
2019-06-13 12:04:59,510 INFO  server.Server (Server.java:doStart(419)) - Started @68730ms
2019-06-13 12:04:59,510 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:37683
Jun 13, 2019 12:04:59 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:04:59,570 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1000, electionTimeout:1000ms
2019-06-13 12:04:59,570 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:04:59,570 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 48 for changeToCandidate
2019-06-13 12:04:59,570 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:04:59,574 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection101: begin an election at term 49 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:59,577 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection101 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:59,578 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection101 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:59,578 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection101: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t49, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:04:59,578 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:59,578 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:04:59,579 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 49 for DISCOVERED_A_NEW_TERM
2019-06-13 12:04:59,579 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:04:59,579 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:04:59,587 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@2bed5828
2019-06-13 12:04:59,587 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:04:59,589 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:04:59,593 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:04:59,596 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-1/meta/datanode.id
2019-06-13 12:04:59,599 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-2/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:04:59,599 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-2/data/containers/hdds to VolumeSet
2019-06-13 12:04:59,599 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@29c76d75
2019-06-13 12:04:59,601 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@29c76d75
2019-06-13 12:04:59,611 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 45211
2019-06-13 12:04:59,611 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:04:59,612 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 45211 (custom)
2019-06-13 12:04:59,612 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:04:59,612 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:59,612 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:04:59,612 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:59,612 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-2/data/ratis] (custom)
2019-06-13 12:04:59,613 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 46671
2019-06-13 12:04:59,613 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:04:59,614 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:04:59,614 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:59,615 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:59,615 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:59,616 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:04:59,616 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:59,616 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:59,616 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 36481
2019-06-13 12:04:59,617 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:04:59,623 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@19542115{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:04:59,623 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@1e4b70c6{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:04:59,642 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@17a5ae7b{/,file:///tmp/jetty-0.0.0.0-36481-hddsDatanode-_-any-3315665275226656295.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:04:59,642 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@7e4dddee{HTTP/1.1,[http/1.1]}{0.0.0.0:36481}
2019-06-13 12:04:59,644 INFO  server.Server (Server.java:doStart(419)) - Started @68865ms
2019-06-13 12:04:59,645 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:36481
Jun 13, 2019 12:04:59 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:04:59,764 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@4280b20b
2019-06-13 12:04:59,765 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:04:59,765 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:04:59,769 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:04:59,771 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-2/meta/datanode.id
2019-06-13 12:04:59,776 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-3/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:04:59,776 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-3/data/containers/hdds to VolumeSet
2019-06-13 12:04:59,776 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@70dd79f7
2019-06-13 12:04:59,776 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@70dd79f7
2019-06-13 12:04:59,801 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 42801
2019-06-13 12:04:59,802 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:04:59,802 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42801 (custom)
2019-06-13 12:04:59,803 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:04:59,803 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:59,803 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:04:59,803 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:59,804 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-3/data/ratis] (custom)
2019-06-13 12:04:59,806 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 41461
2019-06-13 12:04:59,806 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:04:59,807 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:04:59,809 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:59,809 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:59,811 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:59,811 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:04:59,811 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:59,811 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:59,812 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 33221
2019-06-13 12:04:59,812 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:04:59,824 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@34cb1310{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:04:59,825 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@41a3c6f5{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:04:59,859 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@29ce33e9{/,file:///tmp/jetty-0.0.0.0-33221-hddsDatanode-_-any-6067945769421809555.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:04:59,859 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@1f86f7da{HTTP/1.1,[http/1.1]}{0.0.0.0:33221}
2019-06-13 12:04:59,861 INFO  server.Server (Server.java:doStart(419)) - Started @69082ms
2019-06-13 12:04:59,862 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:33221
Jun 13, 2019 12:04:59 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:04:59,956 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@522f74a1
2019-06-13 12:04:59,956 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:04:59,957 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:04:59,957 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:04:59,958 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-3/meta/datanode.id
2019-06-13 12:04:59,967 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-4/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:04:59,968 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-4/data/containers/hdds to VolumeSet
2019-06-13 12:04:59,968 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@6c167296
2019-06-13 12:04:59,971 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@6c167296
2019-06-13 12:04:59,980 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 34739
2019-06-13 12:04:59,982 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:04:59,983 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 34739 (custom)
2019-06-13 12:04:59,983 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:04:59,983 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:04:59,983 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:04:59,984 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:04:59,984 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-4/data/ratis] (custom)
2019-06-13 12:04:59,984 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 38559
2019-06-13 12:04:59,985 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:04:59,986 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:04:59,987 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:04:59,989 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:04:59,990 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:04:59,991 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:04:59,991 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:04:59,991 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:04:59,992 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 44369
2019-06-13 12:04:59,992 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:05:00,003 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@63b2418e{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:05:00,004 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@789f5552{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:05:00,031 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@504b4a97{/,file:///tmp/jetty-0.0.0.0-44369-hddsDatanode-_-any-8907495833642386231.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:05:00,032 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@4964d801{HTTP/1.1,[http/1.1]}{0.0.0.0:44369}
2019-06-13 12:05:00,032 INFO  server.Server (Server.java:doStart(419)) - Started @69253ms
2019-06-13 12:05:00,033 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:44369
Jun 13, 2019 12:05:00 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:05:00,156 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@4f571c0e
2019-06-13 12:05:00,157 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:05:00,157 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:05:00,167 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:05:00,171 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-5/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:05:00,171 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-5/data/containers/hdds to VolumeSet
2019-06-13 12:05:00,172 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@677274e7
2019-06-13 12:05:00,172 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-4/meta/datanode.id
2019-06-13 12:05:00,173 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@677274e7
2019-06-13 12:05:00,189 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 45131
2019-06-13 12:05:00,191 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:05:00,191 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 45131 (custom)
2019-06-13 12:05:00,192 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:05:00,192 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:00,192 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:05:00,192 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:00,192 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-5/data/ratis] (custom)
2019-06-13 12:05:00,193 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 39797
2019-06-13 12:05:00,193 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:05:00,194 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:05:00,195 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:05:00,195 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:05:00,196 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:05:00,196 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:05:00,196 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:05:00,196 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:05:00,197 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 36965
2019-06-13 12:05:00,197 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:05:00,198 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@9d7a853{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:05:00,198 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@4dc16fc9{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:05:00,227 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@1ce45e18{/,file:///tmp/jetty-0.0.0.0-36965-hddsDatanode-_-any-7473408831816473313.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:05:00,227 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@25762f04{HTTP/1.1,[http/1.1]}{0.0.0.0:36965}
2019-06-13 12:05:00,229 INFO  server.Server (Server.java:doStart(419)) - Started @69450ms
2019-06-13 12:05:00,230 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:36965
Jun 13, 2019 12:05:00 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:05:00,322 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@28532753
2019-06-13 12:05:00,322 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:05:00,322 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:05:00,322 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:05:00,323 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-5/meta/datanode.id
2019-06-13 12:05:00,331 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-6/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:05:00,331 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-6/data/containers/hdds to VolumeSet
2019-06-13 12:05:00,331 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3792fed8
2019-06-13 12:05:00,332 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3792fed8
2019-06-13 12:05:00,342 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 34089
2019-06-13 12:05:00,344 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:05:00,345 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 34089 (custom)
2019-06-13 12:05:00,345 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:05:00,345 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:00,345 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:05:00,345 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:00,345 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-6/data/ratis] (custom)
2019-06-13 12:05:00,346 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 46791
2019-06-13 12:05:00,346 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:05:00,347 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:05:00,347 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:05:00,348 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:05:00,349 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:05:00,349 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:05:00,349 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:05:00,349 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:05:00,350 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 45431
2019-06-13 12:05:00,350 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:05:00,351 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@5cfa9e8a{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:05:00,351 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@22942eff{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:05:00,370 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@1315befe{/,file:///tmp/jetty-0.0.0.0-45431-hddsDatanode-_-any-2236155818210567619.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:05:00,371 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@45649467{HTTP/1.1,[http/1.1]}{0.0.0.0:45431}
2019-06-13 12:05:00,373 INFO  server.Server (Server.java:doStart(419)) - Started @69593ms
2019-06-13 12:05:00,373 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:45431
Jun 13, 2019 12:05:00 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:05:00,483 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@5d10e2b6
2019-06-13 12:05:00,483 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 7 DN Heartbeats.
2019-06-13 12:05:00,484 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:05:00,486 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-6/meta/datanode.id
2019-06-13 12:05:00,598 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1019, electionTimeout:1019ms
2019-06-13 12:05:00,598 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:00,598 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 49 for changeToCandidate
2019-06-13 12:05:00,598 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:00,602 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection102: begin an election at term 50 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:00,603 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection102 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:00,604 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection102 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:00,604 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection102: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t50, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:00,604 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:00,604 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:00,604 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 50 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:00,604 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:00,605 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:01,477 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:05:01,477 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:05:01,477 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis d01635f5-389c-48c6-a556-065a2d6335ba at port 44547
2019-06-13 12:05:01,481 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - d01635f5-389c-48c6-a556-065a2d6335ba: start RPC server
2019-06-13 12:05:01,481 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - d01635f5-389c-48c6-a556-065a2d6335ba: GrpcService started, listening on 0.0.0.0/0.0.0.0:44547
2019-06-13 12:05:01,483 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 7 DN Heartbeats.
2019-06-13 12:05:01,598 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:05:01,598 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:05:01,599 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis d01a31f5-1eb9-47dd-9402-63bda0089b40 at port 42079
2019-06-13 12:05:01,617 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: start RPC server
2019-06-13 12:05:01,618 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: GrpcService started, listening on 0.0.0.0/0.0.0.0:42079
2019-06-13 12:05:01,643 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1038, electionTimeout:1038ms
2019-06-13 12:05:01,643 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:01,643 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 50 for changeToCandidate
2019-06-13 12:05:01,643 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:01,645 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection103: begin an election at term 51 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:01,646 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection103 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:01,646 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection103 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:01,646 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection103: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t51, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:01,647 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:01,647 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:01,647 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 51 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:01,647 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:01,647 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:01,773 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:05:01,773 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:05:01,773 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 49edf94f-9740-442b-93cb-b253ac905c5f at port 45211
2019-06-13 12:05:01,776 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 49edf94f-9740-442b-93cb-b253ac905c5f: start RPC server
2019-06-13 12:05:01,777 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 49edf94f-9740-442b-93cb-b253ac905c5f: GrpcService started, listening on 0.0.0.0/0.0.0.0:45211
2019-06-13 12:05:01,960 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:05:01,960 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:05:01,960 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis a3559885-b627-40a4-995a-788826c25b83 at port 42801
2019-06-13 12:05:01,963 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - a3559885-b627-40a4-995a-788826c25b83: start RPC server
2019-06-13 12:05:01,963 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - a3559885-b627-40a4-995a-788826c25b83: GrpcService started, listening on 0.0.0.0/0.0.0.0:42801
2019-06-13 12:05:02,169 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:05:02,169 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:05:02,169 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 79d0af09-eb9d-4ec5-a596-8aa5678795cf at port 34739
2019-06-13 12:05:02,172 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: start RPC server
2019-06-13 12:05:02,172 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: GrpcService started, listening on 0.0.0.0/0.0.0.0:34739
2019-06-13 12:05:02,325 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:05:02,325 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:05:02,325 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 04ad0f60-151d-437d-975f-daff3152c06e at port 45131
2019-06-13 12:05:02,328 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 04ad0f60-151d-437d-975f-daff3152c06e: start RPC server
2019-06-13 12:05:02,329 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 04ad0f60-151d-437d-975f-daff3152c06e: GrpcService started, listening on 0.0.0.0/0.0.0.0:45131
2019-06-13 12:05:02,484 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 7 DN Heartbeats.
2019-06-13 12:05:02,487 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:05:02,487 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:05:02,487 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis a9b1ce52-6f1c-41fa-8800-acc98e2db595 at port 34089
2019-06-13 12:05:02,491 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595: start RPC server
2019-06-13 12:05:02,491 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595: GrpcService started, listening on 0.0.0.0/0.0.0.0:34089
2019-06-13 12:05:02,827 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1180, electionTimeout:1180ms
2019-06-13 12:05:02,827 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:02,828 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 51 for changeToCandidate
2019-06-13 12:05:02,828 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:02,830 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection104: begin an election at term 52 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:02,830 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection104 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:02,831 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection104 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:02,831 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection104: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t52, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:02,831 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:02,831 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:02,831 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 52 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:02,831 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:02,831 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:03,470 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : d01635f5-389c-48c6-a556-065a2d6335ba{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:05:03,473 INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 1 DataNodes registered, 1 required.
2019-06-13 12:05:03,475 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(177)) - ScmSafeModeManager, all rules are successfully validated
2019-06-13 12:05:03,476 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:exitSafeMode(193)) - SCM exiting safe mode.
2019-06-13 12:05:03,481 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - d01635f5-389c-48c6-a556-065a2d6335ba: addNew group-F21E39A6AB07:[d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547] returns group-F21E39A6AB07:java.util.concurrent.CompletableFuture@37831886[Not completed]
2019-06-13 12:05:03,481 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - d01635f5-389c-48c6-a556-065a2d6335ba: new RaftServerImpl for group-F21E39A6AB07:[d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547] with ContainerStateMachine:uninitialized
2019-06-13 12:05:03,481 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:03,481 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:03,481 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:03,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:03,482 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - d01635f5-389c-48c6-a556-065a2d6335ba:group-F21E39A6AB07 ConfigurationManager, init=-1: [d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:03,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-0/data/ratis] (custom)
2019-06-13 12:05:03,482 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-0/data/ratis/39002594-c4bc-4d70-bc13-f21e39a6ab07 does not exist. Creating ...
2019-06-13 12:05:03,484 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 1 of 7 DN Heartbeats.
2019-06-13 12:05:03,484 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-0/data/ratis/39002594-c4bc-4d70-bc13-f21e39a6ab07/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:03,486 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-0/data/ratis/39002594-c4bc-4d70-bc13-f21e39a6ab07 has been successfully formatted.
2019-06-13 12:05:03,486 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:03,486 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:03,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:03,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:03,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:03,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:03,487 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new d01635f5-389c-48c6-a556-065a2d6335ba-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-0/data/ratis/39002594-c4bc-4d70-bc13-f21e39a6ab07
2019-06-13 12:05:03,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:03,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:03,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:03,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:03,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:03,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:03,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:03,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:03,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:03,488 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:03,488 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:03,488 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:03,488 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:03,488 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - d01635f5-389c-48c6-a556-065a2d6335ba: start group-F21E39A6AB07
2019-06-13 12:05:03,488 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d01635f5-389c-48c6-a556-065a2d6335ba:group-F21E39A6AB07 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:03,488 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d01635f5-389c-48c6-a556-065a2d6335ba: start FollowerState
2019-06-13 12:05:03,488 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-F21E39A6AB07,id=d01635f5-389c-48c6-a556-065a2d6335ba
2019-06-13 12:05:03,490 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 39002594-c4bc-4d70-bc13-f21e39a6ab07, Nodes: d01635f5-389c-48c6-a556-065a2d6335ba{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:05:03,595 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : d01a31f5-1eb9-47dd-9402-63bda0089b40{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:05:03,600 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: addNew group-3F4884D22ACB:[d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079] returns group-3F4884D22ACB:java.util.concurrent.CompletableFuture@261058a4[Not completed]
2019-06-13 12:05:03,601 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: new RaftServerImpl for group-3F4884D22ACB:[d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079] with ContainerStateMachine:uninitialized
2019-06-13 12:05:03,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:03,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:03,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:03,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:03,601 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - d01a31f5-1eb9-47dd-9402-63bda0089b40:group-3F4884D22ACB ConfigurationManager, init=-1: [d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:03,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-1/data/ratis] (custom)
2019-06-13 12:05:03,602 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-1/data/ratis/f590c83b-07a0-4fe8-b3f9-3f4884d22acb does not exist. Creating ...
2019-06-13 12:05:03,604 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-1/data/ratis/f590c83b-07a0-4fe8-b3f9-3f4884d22acb/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:03,605 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-1/data/ratis/f590c83b-07a0-4fe8-b3f9-3f4884d22acb has been successfully formatted.
2019-06-13 12:05:03,606 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:03,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:03,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:03,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:03,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:03,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:03,606 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new d01a31f5-1eb9-47dd-9402-63bda0089b40-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-1/data/ratis/f590c83b-07a0-4fe8-b3f9-3f4884d22acb
2019-06-13 12:05:03,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:03,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:03,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:03,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:03,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:03,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:03,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:03,607 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:03,607 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:03,607 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:03,607 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:03,607 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:03,607 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:03,607 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: start group-3F4884D22ACB
2019-06-13 12:05:03,607 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d01a31f5-1eb9-47dd-9402-63bda0089b40:group-3F4884D22ACB changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:03,608 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: start FollowerState
2019-06-13 12:05:03,608 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-3F4884D22ACB,id=d01a31f5-1eb9-47dd-9402-63bda0089b40
2019-06-13 12:05:03,609 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: f590c83b-07a0-4fe8-b3f9-3f4884d22acb, Nodes: d01a31f5-1eb9-47dd-9402-63bda0089b40{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:05:03,771 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 49edf94f-9740-442b-93cb-b253ac905c5f{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:05:03,779 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 49edf94f-9740-442b-93cb-b253ac905c5f: addNew group-90DA6E597016:[49edf94f-9740-442b-93cb-b253ac905c5f:192.168.46.58:45211] returns group-90DA6E597016:java.util.concurrent.CompletableFuture@45688096[Not completed]
2019-06-13 12:05:03,780 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 49edf94f-9740-442b-93cb-b253ac905c5f: new RaftServerImpl for group-90DA6E597016:[49edf94f-9740-442b-93cb-b253ac905c5f:192.168.46.58:45211] with ContainerStateMachine:uninitialized
2019-06-13 12:05:03,780 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:03,780 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:03,780 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:03,780 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:03,780 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 49edf94f-9740-442b-93cb-b253ac905c5f:group-90DA6E597016 ConfigurationManager, init=-1: [49edf94f-9740-442b-93cb-b253ac905c5f:192.168.46.58:45211], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:03,780 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-2/data/ratis] (custom)
2019-06-13 12:05:03,780 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-2/data/ratis/669fe6a8-f1a2-41e5-b5f4-90da6e597016 does not exist. Creating ...
2019-06-13 12:05:03,782 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-2/data/ratis/669fe6a8-f1a2-41e5-b5f4-90da6e597016/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:03,784 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-2/data/ratis/669fe6a8-f1a2-41e5-b5f4-90da6e597016 has been successfully formatted.
2019-06-13 12:05:03,784 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:03,784 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:03,784 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:03,784 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:03,784 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:03,784 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:03,784 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 49edf94f-9740-442b-93cb-b253ac905c5f-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-2/data/ratis/669fe6a8-f1a2-41e5-b5f4-90da6e597016
2019-06-13 12:05:03,784 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:03,785 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:03,785 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:03,785 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:03,785 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:03,785 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:03,785 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:03,785 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:03,785 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:03,785 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:03,785 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:03,785 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:03,785 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:03,786 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 49edf94f-9740-442b-93cb-b253ac905c5f: start group-90DA6E597016
2019-06-13 12:05:03,786 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 49edf94f-9740-442b-93cb-b253ac905c5f:group-90DA6E597016 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:03,786 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 49edf94f-9740-442b-93cb-b253ac905c5f: start FollowerState
2019-06-13 12:05:03,786 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-90DA6E597016,id=49edf94f-9740-442b-93cb-b253ac905c5f
2019-06-13 12:05:03,788 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 669fe6a8-f1a2-41e5-b5f4-90da6e597016, Nodes: 49edf94f-9740-442b-93cb-b253ac905c5f{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:05:03,796 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - d01635f5-389c-48c6-a556-065a2d6335ba: addNew group-C0F55F198779:[49edf94f-9740-442b-93cb-b253ac905c5f:192.168.46.58:45211, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079] returns group-C0F55F198779:java.util.concurrent.CompletableFuture@29b7ac7f[Not completed]
2019-06-13 12:05:03,796 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - d01635f5-389c-48c6-a556-065a2d6335ba: new RaftServerImpl for group-C0F55F198779:[49edf94f-9740-442b-93cb-b253ac905c5f:192.168.46.58:45211, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079] with ContainerStateMachine:uninitialized
2019-06-13 12:05:03,796 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:03,796 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:03,796 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:03,796 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:03,796 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - d01635f5-389c-48c6-a556-065a2d6335ba:group-C0F55F198779 ConfigurationManager, init=-1: [49edf94f-9740-442b-93cb-b253ac905c5f:192.168.46.58:45211, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:03,797 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-0/data/ratis] (custom)
2019-06-13 12:05:03,797 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-0/data/ratis/33db2c15-0441-4188-b761-c0f55f198779 does not exist. Creating ...
2019-06-13 12:05:03,797 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: addNew group-C0F55F198779:[49edf94f-9740-442b-93cb-b253ac905c5f:192.168.46.58:45211, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079] returns group-C0F55F198779:java.util.concurrent.CompletableFuture@20ecafa[Not completed]
2019-06-13 12:05:03,798 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 49edf94f-9740-442b-93cb-b253ac905c5f: addNew group-C0F55F198779:[49edf94f-9740-442b-93cb-b253ac905c5f:192.168.46.58:45211, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079] returns group-C0F55F198779:java.util.concurrent.CompletableFuture@3f24b63a[Not completed]
2019-06-13 12:05:03,798 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 49edf94f-9740-442b-93cb-b253ac905c5f: new RaftServerImpl for group-C0F55F198779:[49edf94f-9740-442b-93cb-b253ac905c5f:192.168.46.58:45211, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079] with ContainerStateMachine:uninitialized
2019-06-13 12:05:03,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:03,798 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: new RaftServerImpl for group-C0F55F198779:[49edf94f-9740-442b-93cb-b253ac905c5f:192.168.46.58:45211, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079] with ContainerStateMachine:uninitialized
2019-06-13 12:05:03,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:03,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:03,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:03,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:03,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:03,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:03,799 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 49edf94f-9740-442b-93cb-b253ac905c5f:group-C0F55F198779 ConfigurationManager, init=-1: [49edf94f-9740-442b-93cb-b253ac905c5f:192.168.46.58:45211, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:03,799 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-0/data/ratis/33db2c15-0441-4188-b761-c0f55f198779/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:03,799 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:03,799 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-2/data/ratis] (custom)
2019-06-13 12:05:03,799 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - d01a31f5-1eb9-47dd-9402-63bda0089b40:group-C0F55F198779 ConfigurationManager, init=-1: [49edf94f-9740-442b-93cb-b253ac905c5f:192.168.46.58:45211, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:03,799 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-1/data/ratis] (custom)
2019-06-13 12:05:03,799 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-2/data/ratis/33db2c15-0441-4188-b761-c0f55f198779 does not exist. Creating ...
2019-06-13 12:05:03,800 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-1/data/ratis/33db2c15-0441-4188-b761-c0f55f198779 does not exist. Creating ...
2019-06-13 12:05:03,801 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-0/data/ratis/33db2c15-0441-4188-b761-c0f55f198779 has been successfully formatted.
2019-06-13 12:05:03,801 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:03,801 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:03,801 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:03,801 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:03,801 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:03,801 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:03,801 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new d01635f5-389c-48c6-a556-065a2d6335ba-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-0/data/ratis/33db2c15-0441-4188-b761-c0f55f198779
2019-06-13 12:05:03,802 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:03,802 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:03,802 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:03,802 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:03,802 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:03,802 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:03,802 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:03,802 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:03,802 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:03,802 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:03,803 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:03,803 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-2/data/ratis/33db2c15-0441-4188-b761-c0f55f198779/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:03,803 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-1/data/ratis/33db2c15-0441-4188-b761-c0f55f198779/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:03,803 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:03,803 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:03,803 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - d01635f5-389c-48c6-a556-065a2d6335ba: start group-C0F55F198779
2019-06-13 12:05:03,803 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d01635f5-389c-48c6-a556-065a2d6335ba:group-C0F55F198779 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:03,803 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d01635f5-389c-48c6-a556-065a2d6335ba: start FollowerState
2019-06-13 12:05:03,803 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C0F55F198779,id=d01635f5-389c-48c6-a556-065a2d6335ba
2019-06-13 12:05:03,805 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-2/data/ratis/33db2c15-0441-4188-b761-c0f55f198779 has been successfully formatted.
2019-06-13 12:05:03,805 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-1/data/ratis/33db2c15-0441-4188-b761-c0f55f198779 has been successfully formatted.
2019-06-13 12:05:03,805 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:03,805 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:03,805 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:03,805 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:03,805 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:03,805 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:03,805 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:03,805 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:03,805 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:03,805 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:03,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:03,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:03,806 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 49edf94f-9740-442b-93cb-b253ac905c5f-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-2/data/ratis/33db2c15-0441-4188-b761-c0f55f198779
2019-06-13 12:05:03,806 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new d01a31f5-1eb9-47dd-9402-63bda0089b40-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-1/data/ratis/33db2c15-0441-4188-b761-c0f55f198779
2019-06-13 12:05:03,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:03,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:03,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:03,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:03,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:03,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:03,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:03,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:03,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:03,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:03,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:03,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:03,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:03,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:03,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:03,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:03,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:03,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:03,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:03,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:03,809 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:03,810 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:03,810 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:03,810 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:03,810 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 49edf94f-9740-442b-93cb-b253ac905c5f: start group-C0F55F198779
2019-06-13 12:05:03,810 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:03,810 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 49edf94f-9740-442b-93cb-b253ac905c5f:group-C0F55F198779 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:03,810 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:03,810 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 49edf94f-9740-442b-93cb-b253ac905c5f: start FollowerState
2019-06-13 12:05:03,810 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: start group-C0F55F198779
2019-06-13 12:05:03,810 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d01a31f5-1eb9-47dd-9402-63bda0089b40:group-C0F55F198779 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:03,810 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: start FollowerState
2019-06-13 12:05:03,810 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C0F55F198779,id=49edf94f-9740-442b-93cb-b253ac905c5f
2019-06-13 12:05:03,811 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C0F55F198779,id=d01a31f5-1eb9-47dd-9402-63bda0089b40
2019-06-13 12:05:03,816 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 33db2c15-0441-4188-b761-c0f55f198779, Nodes: d01635f5-389c-48c6-a556-065a2d6335ba{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}d01a31f5-1eb9-47dd-9402-63bda0089b40{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}49edf94f-9740-442b-93cb-b253ac905c5f{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-13 12:05:03,958 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : a3559885-b627-40a4-995a-788826c25b83{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:05:03,967 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - a3559885-b627-40a4-995a-788826c25b83: addNew group-FF15286E6511:[a3559885-b627-40a4-995a-788826c25b83:192.168.46.58:42801] returns group-FF15286E6511:java.util.concurrent.CompletableFuture@29753ba[Not completed]
2019-06-13 12:05:03,967 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - a3559885-b627-40a4-995a-788826c25b83: new RaftServerImpl for group-FF15286E6511:[a3559885-b627-40a4-995a-788826c25b83:192.168.46.58:42801] with ContainerStateMachine:uninitialized
2019-06-13 12:05:03,967 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:03,967 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:03,967 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:03,967 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:03,967 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - a3559885-b627-40a4-995a-788826c25b83:group-FF15286E6511 ConfigurationManager, init=-1: [a3559885-b627-40a4-995a-788826c25b83:192.168.46.58:42801], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:03,967 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-3/data/ratis] (custom)
2019-06-13 12:05:03,968 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-3/data/ratis/6da6b8ea-1c71-4a8f-97cc-ff15286e6511 does not exist. Creating ...
2019-06-13 12:05:03,970 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-3/data/ratis/6da6b8ea-1c71-4a8f-97cc-ff15286e6511/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:03,972 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-3/data/ratis/6da6b8ea-1c71-4a8f-97cc-ff15286e6511 has been successfully formatted.
2019-06-13 12:05:03,972 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:03,972 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:03,972 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:03,972 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:03,972 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:03,972 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:03,972 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new a3559885-b627-40a4-995a-788826c25b83-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-3/data/ratis/6da6b8ea-1c71-4a8f-97cc-ff15286e6511
2019-06-13 12:05:03,972 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:03,972 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:03,972 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:03,972 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:03,973 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:03,973 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:03,973 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:03,973 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:03,973 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:03,973 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:03,974 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:03,974 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:03,974 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:03,974 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - a3559885-b627-40a4-995a-788826c25b83: start group-FF15286E6511
2019-06-13 12:05:03,974 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a3559885-b627-40a4-995a-788826c25b83:group-FF15286E6511 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:03,974 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a3559885-b627-40a4-995a-788826c25b83: start FollowerState
2019-06-13 12:05:03,974 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-FF15286E6511,id=a3559885-b627-40a4-995a-788826c25b83
2019-06-13 12:05:03,975 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1144, electionTimeout:1144ms
2019-06-13 12:05:03,975 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:03,976 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 52 for changeToCandidate
2019-06-13 12:05:03,981 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:03,984 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection105: begin an election at term 53 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:03,984 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 6da6b8ea-1c71-4a8f-97cc-ff15286e6511, Nodes: a3559885-b627-40a4-995a-788826c25b83{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:05:04,001 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection105 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:04,002 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection105 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:04,002 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection105: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t53, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:04,002 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:04,002 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:04,002 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 53 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:04,002 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:04,003 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:04,167 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 79d0af09-eb9d-4ec5-a596-8aa5678795cf{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:05:04,174 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: addNew group-055DDB342211:[79d0af09-eb9d-4ec5-a596-8aa5678795cf:192.168.46.58:34739] returns group-055DDB342211:java.util.concurrent.CompletableFuture@41be7519[Not completed]
2019-06-13 12:05:04,175 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: new RaftServerImpl for group-055DDB342211:[79d0af09-eb9d-4ec5-a596-8aa5678795cf:192.168.46.58:34739] with ContainerStateMachine:uninitialized
2019-06-13 12:05:04,175 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:04,175 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:04,175 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:04,175 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:04,176 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf:group-055DDB342211 ConfigurationManager, init=-1: [79d0af09-eb9d-4ec5-a596-8aa5678795cf:192.168.46.58:34739], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:04,176 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-4/data/ratis] (custom)
2019-06-13 12:05:04,176 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-4/data/ratis/16f46a9d-68a8-416d-8dc7-055ddb342211 does not exist. Creating ...
2019-06-13 12:05:04,178 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-4/data/ratis/16f46a9d-68a8-416d-8dc7-055ddb342211/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:04,181 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-4/data/ratis/16f46a9d-68a8-416d-8dc7-055ddb342211 has been successfully formatted.
2019-06-13 12:05:04,181 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:04,181 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:04,181 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:04,181 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:04,181 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:04,181 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:04,181 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 79d0af09-eb9d-4ec5-a596-8aa5678795cf-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-4/data/ratis/16f46a9d-68a8-416d-8dc7-055ddb342211
2019-06-13 12:05:04,181 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:04,181 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:04,181 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:04,182 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:04,182 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:04,182 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:04,182 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:04,182 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:04,182 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:04,182 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:04,182 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:04,182 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:04,182 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:04,183 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: start group-055DDB342211
2019-06-13 12:05:04,183 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf:group-055DDB342211 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:04,183 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: start FollowerState
2019-06-13 12:05:04,183 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-055DDB342211,id=79d0af09-eb9d-4ec5-a596-8aa5678795cf
2019-06-13 12:05:04,184 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 16f46a9d-68a8-416d-8dc7-055ddb342211, Nodes: 79d0af09-eb9d-4ec5-a596-8aa5678795cf{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:05:04,324 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 04ad0f60-151d-437d-975f-daff3152c06e{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:05:04,333 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 04ad0f60-151d-437d-975f-daff3152c06e: addNew group-1418C516015C:[04ad0f60-151d-437d-975f-daff3152c06e:192.168.46.58:45131] returns group-1418C516015C:java.util.concurrent.CompletableFuture@1450f2c5[Not completed]
2019-06-13 12:05:04,333 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 04ad0f60-151d-437d-975f-daff3152c06e: new RaftServerImpl for group-1418C516015C:[04ad0f60-151d-437d-975f-daff3152c06e:192.168.46.58:45131] with ContainerStateMachine:uninitialized
2019-06-13 12:05:04,333 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:04,333 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:04,334 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:04,334 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:04,334 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 04ad0f60-151d-437d-975f-daff3152c06e:group-1418C516015C ConfigurationManager, init=-1: [04ad0f60-151d-437d-975f-daff3152c06e:192.168.46.58:45131], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:04,334 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-5/data/ratis] (custom)
2019-06-13 12:05:04,334 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-5/data/ratis/df1dce33-c1e0-43ed-bfeb-1418c516015c does not exist. Creating ...
2019-06-13 12:05:04,336 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-5/data/ratis/df1dce33-c1e0-43ed-bfeb-1418c516015c/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:04,338 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-5/data/ratis/df1dce33-c1e0-43ed-bfeb-1418c516015c has been successfully formatted.
2019-06-13 12:05:04,339 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:04,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:04,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:04,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:04,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:04,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:04,339 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 04ad0f60-151d-437d-975f-daff3152c06e-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-5/data/ratis/df1dce33-c1e0-43ed-bfeb-1418c516015c
2019-06-13 12:05:04,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:04,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:04,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:04,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:04,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:04,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:04,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:04,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:04,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:04,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:04,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:04,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:04,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:04,340 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 04ad0f60-151d-437d-975f-daff3152c06e: start group-1418C516015C
2019-06-13 12:05:04,340 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 04ad0f60-151d-437d-975f-daff3152c06e:group-1418C516015C changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:04,340 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 04ad0f60-151d-437d-975f-daff3152c06e: start FollowerState
2019-06-13 12:05:04,341 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-1418C516015C,id=04ad0f60-151d-437d-975f-daff3152c06e
2019-06-13 12:05:04,342 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: df1dce33-c1e0-43ed-bfeb-1418c516015c, Nodes: 04ad0f60-151d-437d-975f-daff3152c06e{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:05:04,360 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - a3559885-b627-40a4-995a-788826c25b83: addNew group-A7F567635895:[04ad0f60-151d-437d-975f-daff3152c06e:192.168.46.58:45131, 79d0af09-eb9d-4ec5-a596-8aa5678795cf:192.168.46.58:34739, a3559885-b627-40a4-995a-788826c25b83:192.168.46.58:42801] returns group-A7F567635895:java.util.concurrent.CompletableFuture@39342674[Not completed]
2019-06-13 12:05:04,360 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - a3559885-b627-40a4-995a-788826c25b83: new RaftServerImpl for group-A7F567635895:[04ad0f60-151d-437d-975f-daff3152c06e:192.168.46.58:45131, 79d0af09-eb9d-4ec5-a596-8aa5678795cf:192.168.46.58:34739, a3559885-b627-40a4-995a-788826c25b83:192.168.46.58:42801] with ContainerStateMachine:uninitialized
2019-06-13 12:05:04,360 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: addNew group-A7F567635895:[04ad0f60-151d-437d-975f-daff3152c06e:192.168.46.58:45131, 79d0af09-eb9d-4ec5-a596-8aa5678795cf:192.168.46.58:34739, a3559885-b627-40a4-995a-788826c25b83:192.168.46.58:42801] returns group-A7F567635895:java.util.concurrent.CompletableFuture@7bfdb602[Not completed]
2019-06-13 12:05:04,360 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:04,361 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:04,361 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:04,361 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:04,361 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - a3559885-b627-40a4-995a-788826c25b83:group-A7F567635895 ConfigurationManager, init=-1: [04ad0f60-151d-437d-975f-daff3152c06e:192.168.46.58:45131, 79d0af09-eb9d-4ec5-a596-8aa5678795cf:192.168.46.58:34739, a3559885-b627-40a4-995a-788826c25b83:192.168.46.58:42801], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:04,361 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-3/data/ratis] (custom)
2019-06-13 12:05:04,362 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-3/data/ratis/429a954f-d42b-46ab-9daa-a7f567635895 does not exist. Creating ...
2019-06-13 12:05:04,361 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: new RaftServerImpl for group-A7F567635895:[04ad0f60-151d-437d-975f-daff3152c06e:192.168.46.58:45131, 79d0af09-eb9d-4ec5-a596-8aa5678795cf:192.168.46.58:34739, a3559885-b627-40a4-995a-788826c25b83:192.168.46.58:42801] with ContainerStateMachine:uninitialized
2019-06-13 12:05:04,362 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:04,362 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:04,362 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:04,362 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:04,362 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf:group-A7F567635895 ConfigurationManager, init=-1: [04ad0f60-151d-437d-975f-daff3152c06e:192.168.46.58:45131, 79d0af09-eb9d-4ec5-a596-8aa5678795cf:192.168.46.58:34739, a3559885-b627-40a4-995a-788826c25b83:192.168.46.58:42801], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:04,363 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-4/data/ratis] (custom)
2019-06-13 12:05:04,363 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-4/data/ratis/429a954f-d42b-46ab-9daa-a7f567635895 does not exist. Creating ...
2019-06-13 12:05:04,362 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 04ad0f60-151d-437d-975f-daff3152c06e: addNew group-A7F567635895:[04ad0f60-151d-437d-975f-daff3152c06e:192.168.46.58:45131, 79d0af09-eb9d-4ec5-a596-8aa5678795cf:192.168.46.58:34739, a3559885-b627-40a4-995a-788826c25b83:192.168.46.58:42801] returns group-A7F567635895:java.util.concurrent.CompletableFuture@68a8b562[Not completed]
2019-06-13 12:05:04,363 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 04ad0f60-151d-437d-975f-daff3152c06e: new RaftServerImpl for group-A7F567635895:[04ad0f60-151d-437d-975f-daff3152c06e:192.168.46.58:45131, 79d0af09-eb9d-4ec5-a596-8aa5678795cf:192.168.46.58:34739, a3559885-b627-40a4-995a-788826c25b83:192.168.46.58:42801] with ContainerStateMachine:uninitialized
2019-06-13 12:05:04,363 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:04,363 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:04,363 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:04,364 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:04,364 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 04ad0f60-151d-437d-975f-daff3152c06e:group-A7F567635895 ConfigurationManager, init=-1: [04ad0f60-151d-437d-975f-daff3152c06e:192.168.46.58:45131, 79d0af09-eb9d-4ec5-a596-8aa5678795cf:192.168.46.58:34739, a3559885-b627-40a4-995a-788826c25b83:192.168.46.58:42801], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:04,364 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-5/data/ratis] (custom)
2019-06-13 12:05:04,364 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-5/data/ratis/429a954f-d42b-46ab-9daa-a7f567635895 does not exist. Creating ...
2019-06-13 12:05:04,365 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-3/data/ratis/429a954f-d42b-46ab-9daa-a7f567635895/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:04,365 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-4/data/ratis/429a954f-d42b-46ab-9daa-a7f567635895/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:04,366 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-5/data/ratis/429a954f-d42b-46ab-9daa-a7f567635895/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:04,368 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-4/data/ratis/429a954f-d42b-46ab-9daa-a7f567635895 has been successfully formatted.
2019-06-13 12:05:04,368 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-3/data/ratis/429a954f-d42b-46ab-9daa-a7f567635895 has been successfully formatted.
2019-06-13 12:05:04,368 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:04,368 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:04,368 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:04,368 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:04,368 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:04,368 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:04,368 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 79d0af09-eb9d-4ec5-a596-8aa5678795cf-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-4/data/ratis/429a954f-d42b-46ab-9daa-a7f567635895
2019-06-13 12:05:04,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:04,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:04,369 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:04,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:04,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:04,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:04,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:04,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:04,369 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-5/data/ratis/429a954f-d42b-46ab-9daa-a7f567635895 has been successfully formatted.
2019-06-13 12:05:04,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:04,369 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:04,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:04,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:04,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:04,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:04,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:04,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:04,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:04,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:04,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:04,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:04,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:04,370 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 04ad0f60-151d-437d-975f-daff3152c06e-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-5/data/ratis/429a954f-d42b-46ab-9daa-a7f567635895
2019-06-13 12:05:04,370 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new a3559885-b627-40a4-995a-788826c25b83-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-3/data/ratis/429a954f-d42b-46ab-9daa-a7f567635895
2019-06-13 12:05:04,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:04,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:04,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:04,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:04,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:04,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:04,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:04,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:04,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:04,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:04,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:04,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:04,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:04,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:04,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:04,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:04,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:04,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:04,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:04,372 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: start group-A7F567635895
2019-06-13 12:05:04,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:04,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:04,372 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf:group-A7F567635895 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:04,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:04,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:04,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:04,372 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: start FollowerState
2019-06-13 12:05:04,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:04,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:04,372 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - a3559885-b627-40a4-995a-788826c25b83: start group-A7F567635895
2019-06-13 12:05:04,372 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-A7F567635895,id=79d0af09-eb9d-4ec5-a596-8aa5678795cf
2019-06-13 12:05:04,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:04,373 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a3559885-b627-40a4-995a-788826c25b83:group-A7F567635895 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:04,373 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a3559885-b627-40a4-995a-788826c25b83: start FollowerState
2019-06-13 12:05:04,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:04,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:04,373 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-A7F567635895,id=a3559885-b627-40a4-995a-788826c25b83
2019-06-13 12:05:04,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:04,373 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 04ad0f60-151d-437d-975f-daff3152c06e: start group-A7F567635895
2019-06-13 12:05:04,373 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 04ad0f60-151d-437d-975f-daff3152c06e:group-A7F567635895 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:04,374 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 04ad0f60-151d-437d-975f-daff3152c06e: start FollowerState
2019-06-13 12:05:04,374 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-A7F567635895,id=04ad0f60-151d-437d-975f-daff3152c06e
2019-06-13 12:05:04,379 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 429a954f-d42b-46ab-9daa-a7f567635895, Nodes: a3559885-b627-40a4-995a-788826c25b83{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}04ad0f60-151d-437d-975f-daff3152c06e{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}79d0af09-eb9d-4ec5-a596-8aa5678795cf{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-13 12:05:04,484 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 6 of 7 DN Heartbeats.
2019-06-13 12:05:04,484 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : a9b1ce52-6f1c-41fa-8800-acc98e2db595{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:05:04,490 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595: addNew group-A640C4CC1883:[a9b1ce52-6f1c-41fa-8800-acc98e2db595:192.168.46.58:34089] returns group-A640C4CC1883:java.util.concurrent.CompletableFuture@73e8982c[Not completed]
2019-06-13 12:05:04,491 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595: new RaftServerImpl for group-A640C4CC1883:[a9b1ce52-6f1c-41fa-8800-acc98e2db595:192.168.46.58:34089] with ContainerStateMachine:uninitialized
2019-06-13 12:05:04,491 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:04,491 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:04,491 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:04,491 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:04,491 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595:group-A640C4CC1883 ConfigurationManager, init=-1: [a9b1ce52-6f1c-41fa-8800-acc98e2db595:192.168.46.58:34089], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:04,491 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-6/data/ratis] (custom)
2019-06-13 12:05:04,491 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-6/data/ratis/996a5d59-799b-488b-a43c-a640c4cc1883 does not exist. Creating ...
2019-06-13 12:05:04,493 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-6/data/ratis/996a5d59-799b-488b-a43c-a640c4cc1883/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:04,495 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-6/data/ratis/996a5d59-799b-488b-a43c-a640c4cc1883 has been successfully formatted.
2019-06-13 12:05:04,495 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:04,495 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:04,496 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:04,496 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:04,496 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:04,496 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:04,496 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new a9b1ce52-6f1c-41fa-8800-acc98e2db595-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-6/data/ratis/996a5d59-799b-488b-a43c-a640c4cc1883
2019-06-13 12:05:04,496 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:04,496 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:04,496 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:04,496 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:04,496 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:04,496 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:04,496 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:04,496 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:04,496 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:04,496 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:04,497 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:04,497 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:04,497 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:04,497 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595: start group-A640C4CC1883
2019-06-13 12:05:04,497 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595:group-A640C4CC1883 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:04,497 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595: start FollowerState
2019-06-13 12:05:04,498 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-A640C4CC1883,id=a9b1ce52-6f1c-41fa-8800-acc98e2db595
2019-06-13 12:05:04,499 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 996a5d59-799b-488b-a43c-a640c4cc1883, Nodes: a9b1ce52-6f1c-41fa-8800-acc98e2db595{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:05:04,677 INFO  impl.FollowerState (FollowerState.java:run(101)) - d01a31f5-1eb9-47dd-9402-63bda0089b40:group-3F4884D22ACB changes to CANDIDATE, lastRpcTime:1069, electionTimeout:1069ms
2019-06-13 12:05:04,677 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: shutdown FollowerState
2019-06-13 12:05:04,677 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d01a31f5-1eb9-47dd-9402-63bda0089b40:group-3F4884D22ACB changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:04,677 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: start LeaderElection
2019-06-13 12:05:04,681 INFO  impl.FollowerState (FollowerState.java:run(101)) - d01635f5-389c-48c6-a556-065a2d6335ba:group-F21E39A6AB07 changes to CANDIDATE, lastRpcTime:1193, electionTimeout:1193ms
2019-06-13 12:05:04,682 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d01635f5-389c-48c6-a556-065a2d6335ba: shutdown FollowerState
2019-06-13 12:05:04,682 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d01635f5-389c-48c6-a556-065a2d6335ba:group-F21E39A6AB07 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:04,682 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d01635f5-389c-48c6-a556-065a2d6335ba: start LeaderElection
2019-06-13 12:05:04,685 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - d01a31f5-1eb9-47dd-9402-63bda0089b40:group-3F4884D22ACB:LeaderElection106: begin an election at term 1 for -1: [d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079], old=null
2019-06-13 12:05:04,685 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: shutdown LeaderElection
2019-06-13 12:05:04,685 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d01a31f5-1eb9-47dd-9402-63bda0089b40:group-3F4884D22ACB changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:04,686 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - d01a31f5-1eb9-47dd-9402-63bda0089b40:group-3F4884D22ACB change Leader from null to d01a31f5-1eb9-47dd-9402-63bda0089b40 at term 1 for becomeLeader, leader elected after 1079ms
2019-06-13 12:05:04,686 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:04,686 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:04,686 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:04,686 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:04,686 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: start LeaderState
2019-06-13 12:05:04,686 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - d01a31f5-1eb9-47dd-9402-63bda0089b40-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:04,687 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - d01a31f5-1eb9-47dd-9402-63bda0089b40:group-3F4884D22ACB set configuration 0: [d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079], old=null at 0
2019-06-13 12:05:04,687 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - d01635f5-389c-48c6-a556-065a2d6335ba:group-F21E39A6AB07:LeaderElection107: begin an election at term 1 for -1: [d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547], old=null
2019-06-13 12:05:04,687 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - d01635f5-389c-48c6-a556-065a2d6335ba: shutdown LeaderElection
2019-06-13 12:05:04,687 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d01635f5-389c-48c6-a556-065a2d6335ba:group-F21E39A6AB07 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:04,687 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - d01635f5-389c-48c6-a556-065a2d6335ba:group-F21E39A6AB07 change Leader from null to d01635f5-389c-48c6-a556-065a2d6335ba at term 1 for becomeLeader, leader elected after 1200ms
2019-06-13 12:05:04,687 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:04,688 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:04,688 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:04,688 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:04,688 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d01635f5-389c-48c6-a556-065a2d6335ba: start LeaderState
2019-06-13 12:05:04,688 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - d01635f5-389c-48c6-a556-065a2d6335ba-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:04,690 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - d01635f5-389c-48c6-a556-065a2d6335ba:group-F21E39A6AB07 set configuration 0: [d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547], old=null at 0
2019-06-13 12:05:04,734 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - d01635f5-389c-48c6-a556-065a2d6335ba-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-0/data/ratis/39002594-c4bc-4d70-bc13-f21e39a6ab07/current/log_inprogress_0
2019-06-13 12:05:04,734 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - d01a31f5-1eb9-47dd-9402-63bda0089b40-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-1/data/ratis/f590c83b-07a0-4fe8-b3f9-3f4884d22acb/current/log_inprogress_0
2019-06-13 12:05:04,796 INFO  impl.FollowerState (FollowerState.java:run(101)) - 49edf94f-9740-442b-93cb-b253ac905c5f:group-90DA6E597016 changes to CANDIDATE, lastRpcTime:1010, electionTimeout:1010ms
2019-06-13 12:05:04,797 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 49edf94f-9740-442b-93cb-b253ac905c5f: shutdown FollowerState
2019-06-13 12:05:04,797 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 49edf94f-9740-442b-93cb-b253ac905c5f:group-90DA6E597016 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:04,797 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 49edf94f-9740-442b-93cb-b253ac905c5f: start LeaderElection
2019-06-13 12:05:04,804 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 49edf94f-9740-442b-93cb-b253ac905c5f:group-90DA6E597016:LeaderElection108: begin an election at term 1 for -1: [49edf94f-9740-442b-93cb-b253ac905c5f:192.168.46.58:45211], old=null
2019-06-13 12:05:04,804 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 49edf94f-9740-442b-93cb-b253ac905c5f: shutdown LeaderElection
2019-06-13 12:05:04,804 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 49edf94f-9740-442b-93cb-b253ac905c5f:group-90DA6E597016 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:04,804 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 49edf94f-9740-442b-93cb-b253ac905c5f:group-90DA6E597016 change Leader from null to 49edf94f-9740-442b-93cb-b253ac905c5f at term 1 for becomeLeader, leader elected after 1020ms
2019-06-13 12:05:04,804 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:04,804 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:04,805 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:04,805 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:04,805 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 49edf94f-9740-442b-93cb-b253ac905c5f: start LeaderState
2019-06-13 12:05:04,805 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 49edf94f-9740-442b-93cb-b253ac905c5f-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:04,810 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 49edf94f-9740-442b-93cb-b253ac905c5f:group-90DA6E597016 set configuration 0: [49edf94f-9740-442b-93cb-b253ac905c5f:192.168.46.58:45211], old=null at 0
2019-06-13 12:05:04,851 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 49edf94f-9740-442b-93cb-b253ac905c5f-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-2/data/ratis/669fe6a8-f1a2-41e5-b5f4-90da6e597016/current/log_inprogress_0
2019-06-13 12:05:04,869 INFO  impl.FollowerState (FollowerState.java:run(101)) - d01a31f5-1eb9-47dd-9402-63bda0089b40:group-C0F55F198779 changes to CANDIDATE, lastRpcTime:1058, electionTimeout:1058ms
2019-06-13 12:05:04,869 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: shutdown FollowerState
2019-06-13 12:05:04,869 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d01a31f5-1eb9-47dd-9402-63bda0089b40:group-C0F55F198779 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:04,869 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: start LeaderElection
2019-06-13 12:05:04,876 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - d01a31f5-1eb9-47dd-9402-63bda0089b40:group-C0F55F198779:LeaderElection109: begin an election at term 1 for -1: [49edf94f-9740-442b-93cb-b253ac905c5f:192.168.46.58:45211, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079], old=null
2019-06-13 12:05:04,886 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 49edf94f-9740-442b-93cb-b253ac905c5f:group-C0F55F198779 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:d01a31f5-1eb9-47dd-9402-63bda0089b40
2019-06-13 12:05:04,886 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 49edf94f-9740-442b-93cb-b253ac905c5f: shutdown FollowerState
2019-06-13 12:05:04,886 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 49edf94f-9740-442b-93cb-b253ac905c5f: start FollowerState
2019-06-13 12:05:04,886 INFO  impl.FollowerState (FollowerState.java:run(109)) - 49edf94f-9740-442b-93cb-b253ac905c5f: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:04,892 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d01635f5-389c-48c6-a556-065a2d6335ba:group-C0F55F198779 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:d01a31f5-1eb9-47dd-9402-63bda0089b40
2019-06-13 12:05:04,892 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d01635f5-389c-48c6-a556-065a2d6335ba: shutdown FollowerState
2019-06-13 12:05:04,892 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d01635f5-389c-48c6-a556-065a2d6335ba: start FollowerState
2019-06-13 12:05:04,892 INFO  impl.FollowerState (FollowerState.java:run(109)) - d01635f5-389c-48c6-a556-065a2d6335ba: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:04,895 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - d01a31f5-1eb9-47dd-9402-63bda0089b40:group-C0F55F198779:LeaderElection109: Election PASSED; received 1 response(s) [d01a31f5-1eb9-47dd-9402-63bda0089b40->49edf94f-9740-442b-93cb-b253ac905c5f,true-t1] and 0 exception(s); d01a31f5-1eb9-47dd-9402-63bda0089b40:t1, leader=null, voted=d01a31f5-1eb9-47dd-9402-63bda0089b40, raftlog=d01a31f5-1eb9-47dd-9402-63bda0089b40-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [49edf94f-9740-442b-93cb-b253ac905c5f:192.168.46.58:45211, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079], old=null
2019-06-13 12:05:04,895 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: shutdown LeaderElection
2019-06-13 12:05:04,895 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d01a31f5-1eb9-47dd-9402-63bda0089b40:group-C0F55F198779 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:04,895 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - d01a31f5-1eb9-47dd-9402-63bda0089b40:group-C0F55F198779 change Leader from null to d01a31f5-1eb9-47dd-9402-63bda0089b40 at term 1 for becomeLeader, leader elected after 1090ms
2019-06-13 12:05:04,895 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:04,895 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:04,896 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:04,896 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:04,896 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 12:05:04,896 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:04,896 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 12:05:04,896 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 12:05:04,896 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:04,896 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:04,896 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 12:05:04,896 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:04,897 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 12:05:04,897 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 12:05:04,897 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:04,897 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:04,897 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: start LeaderState
2019-06-13 12:05:04,897 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - d01a31f5-1eb9-47dd-9402-63bda0089b40-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:04,901 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - d01a31f5-1eb9-47dd-9402-63bda0089b40:group-C0F55F198779 set configuration 0: [49edf94f-9740-442b-93cb-b253ac905c5f:192.168.46.58:45211, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079], old=null at 0
2019-06-13 12:05:04,903 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 49edf94f-9740-442b-93cb-b253ac905c5f:group-C0F55F198779 change Leader from null to d01a31f5-1eb9-47dd-9402-63bda0089b40 at term 1 for appendEntries, leader elected after 1098ms
2019-06-13 12:05:04,907 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - d01635f5-389c-48c6-a556-065a2d6335ba:group-C0F55F198779 change Leader from null to d01a31f5-1eb9-47dd-9402-63bda0089b40 at term 1 for appendEntries, leader elected after 1106ms
2019-06-13 12:05:04,940 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 49edf94f-9740-442b-93cb-b253ac905c5f:group-C0F55F198779 set configuration 0: [49edf94f-9740-442b-93cb-b253ac905c5f:192.168.46.58:45211, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079], old=null at 0
2019-06-13 12:05:04,940 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 49edf94f-9740-442b-93cb-b253ac905c5f-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:04,960 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - d01635f5-389c-48c6-a556-065a2d6335ba:group-C0F55F198779 set configuration 0: [49edf94f-9740-442b-93cb-b253ac905c5f:192.168.46.58:45211, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079], old=null at 0
2019-06-13 12:05:04,960 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - d01635f5-389c-48c6-a556-065a2d6335ba-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:04,967 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - d01a31f5-1eb9-47dd-9402-63bda0089b40-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-1/data/ratis/33db2c15-0441-4188-b761-c0f55f198779/current/log_inprogress_0
2019-06-13 12:05:04,991 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 49edf94f-9740-442b-93cb-b253ac905c5f-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-2/data/ratis/33db2c15-0441-4188-b761-c0f55f198779/current/log_inprogress_0
2019-06-13 12:05:05,000 INFO  impl.FollowerState (FollowerState.java:run(101)) - a3559885-b627-40a4-995a-788826c25b83:group-FF15286E6511 changes to CANDIDATE, lastRpcTime:1026, electionTimeout:1023ms
2019-06-13 12:05:05,001 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a3559885-b627-40a4-995a-788826c25b83: shutdown FollowerState
2019-06-13 12:05:05,001 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a3559885-b627-40a4-995a-788826c25b83:group-FF15286E6511 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:05,001 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a3559885-b627-40a4-995a-788826c25b83: start LeaderElection
2019-06-13 12:05:05,014 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - d01635f5-389c-48c6-a556-065a2d6335ba-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-0/data/ratis/33db2c15-0441-4188-b761-c0f55f198779/current/log_inprogress_0
2019-06-13 12:05:05,014 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - a3559885-b627-40a4-995a-788826c25b83:group-FF15286E6511:LeaderElection110: begin an election at term 1 for -1: [a3559885-b627-40a4-995a-788826c25b83:192.168.46.58:42801], old=null
2019-06-13 12:05:05,014 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - a3559885-b627-40a4-995a-788826c25b83: shutdown LeaderElection
2019-06-13 12:05:05,014 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a3559885-b627-40a4-995a-788826c25b83:group-FF15286E6511 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:05,014 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - a3559885-b627-40a4-995a-788826c25b83:group-FF15286E6511 change Leader from null to a3559885-b627-40a4-995a-788826c25b83 at term 1 for becomeLeader, leader elected after 1042ms
2019-06-13 12:05:05,015 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:05,015 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:05,015 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:05,015 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:05,015 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a3559885-b627-40a4-995a-788826c25b83: start LeaderState
2019-06-13 12:05:05,015 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - a3559885-b627-40a4-995a-788826c25b83-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:05,018 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - a3559885-b627-40a4-995a-788826c25b83:group-FF15286E6511 set configuration 0: [a3559885-b627-40a4-995a-788826c25b83:192.168.46.58:42801], old=null at 0
2019-06-13 12:05:05,064 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - a3559885-b627-40a4-995a-788826c25b83-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-3/data/ratis/6da6b8ea-1c71-4a8f-97cc-ff15286e6511/current/log_inprogress_0
2019-06-13 12:05:05,163 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1160, electionTimeout:1160ms
2019-06-13 12:05:05,163 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:05,164 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 53 for changeToCandidate
2019-06-13 12:05:05,164 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:05,166 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection111: begin an election at term 54 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:05,167 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection111 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:05,167 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection111 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:05,167 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection111: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t54, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:05,168 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:05,168 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:05,168 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 54 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:05,168 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:05,168 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:05,341 INFO  impl.FollowerState (FollowerState.java:run(101)) - 04ad0f60-151d-437d-975f-daff3152c06e:group-1418C516015C changes to CANDIDATE, lastRpcTime:1000, electionTimeout:1000ms
2019-06-13 12:05:05,341 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 04ad0f60-151d-437d-975f-daff3152c06e: shutdown FollowerState
2019-06-13 12:05:05,341 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 04ad0f60-151d-437d-975f-daff3152c06e:group-1418C516015C changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:05,341 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 04ad0f60-151d-437d-975f-daff3152c06e: start LeaderElection
2019-06-13 12:05:05,348 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 04ad0f60-151d-437d-975f-daff3152c06e:group-1418C516015C:LeaderElection112: begin an election at term 1 for -1: [04ad0f60-151d-437d-975f-daff3152c06e:192.168.46.58:45131], old=null
2019-06-13 12:05:05,348 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 04ad0f60-151d-437d-975f-daff3152c06e: shutdown LeaderElection
2019-06-13 12:05:05,348 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 04ad0f60-151d-437d-975f-daff3152c06e:group-1418C516015C changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:05,349 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 04ad0f60-151d-437d-975f-daff3152c06e:group-1418C516015C change Leader from null to 04ad0f60-151d-437d-975f-daff3152c06e at term 1 for becomeLeader, leader elected after 1009ms
2019-06-13 12:05:05,349 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:05,349 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:05,349 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:05,349 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:05,349 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 04ad0f60-151d-437d-975f-daff3152c06e: start LeaderState
2019-06-13 12:05:05,349 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 04ad0f60-151d-437d-975f-daff3152c06e-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:05,352 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 04ad0f60-151d-437d-975f-daff3152c06e:group-1418C516015C set configuration 0: [04ad0f60-151d-437d-975f-daff3152c06e:192.168.46.58:45131], old=null at 0
2019-06-13 12:05:05,371 INFO  impl.FollowerState (FollowerState.java:run(101)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf:group-055DDB342211 changes to CANDIDATE, lastRpcTime:1188, electionTimeout:1188ms
2019-06-13 12:05:05,371 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: shutdown FollowerState
2019-06-13 12:05:05,371 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf:group-055DDB342211 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:05,371 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: start LeaderElection
2019-06-13 12:05:05,396 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 04ad0f60-151d-437d-975f-daff3152c06e-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-5/data/ratis/df1dce33-c1e0-43ed-bfeb-1418c516015c/current/log_inprogress_0
2019-06-13 12:05:05,396 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf:group-055DDB342211:LeaderElection113: begin an election at term 1 for -1: [79d0af09-eb9d-4ec5-a596-8aa5678795cf:192.168.46.58:34739], old=null
2019-06-13 12:05:05,396 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: shutdown LeaderElection
2019-06-13 12:05:05,396 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf:group-055DDB342211 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:05,396 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf:group-055DDB342211 change Leader from null to 79d0af09-eb9d-4ec5-a596-8aa5678795cf at term 1 for becomeLeader, leader elected after 1214ms
2019-06-13 12:05:05,396 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:05,396 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:05,396 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:05,396 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:05,396 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: start LeaderState
2019-06-13 12:05:05,396 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:05,397 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf:group-055DDB342211 set configuration 0: [79d0af09-eb9d-4ec5-a596-8aa5678795cf:192.168.46.58:34739], old=null at 0
2019-06-13 12:05:05,423 INFO  impl.FollowerState (FollowerState.java:run(101)) - 04ad0f60-151d-437d-975f-daff3152c06e:group-A7F567635895 changes to CANDIDATE, lastRpcTime:1048, electionTimeout:1048ms
2019-06-13 12:05:05,423 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 04ad0f60-151d-437d-975f-daff3152c06e: shutdown FollowerState
2019-06-13 12:05:05,423 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 04ad0f60-151d-437d-975f-daff3152c06e:group-A7F567635895 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:05,423 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 04ad0f60-151d-437d-975f-daff3152c06e: start LeaderElection
2019-06-13 12:05:05,436 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-4/data/ratis/16f46a9d-68a8-416d-8dc7-055ddb342211/current/log_inprogress_0
2019-06-13 12:05:05,436 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 04ad0f60-151d-437d-975f-daff3152c06e:group-A7F567635895:LeaderElection114: begin an election at term 1 for -1: [04ad0f60-151d-437d-975f-daff3152c06e:192.168.46.58:45131, 79d0af09-eb9d-4ec5-a596-8aa5678795cf:192.168.46.58:34739, a3559885-b627-40a4-995a-788826c25b83:192.168.46.58:42801], old=null
2019-06-13 12:05:05,447 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a3559885-b627-40a4-995a-788826c25b83:group-A7F567635895 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:04ad0f60-151d-437d-975f-daff3152c06e
2019-06-13 12:05:05,447 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a3559885-b627-40a4-995a-788826c25b83: shutdown FollowerState
2019-06-13 12:05:05,447 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a3559885-b627-40a4-995a-788826c25b83: start FollowerState
2019-06-13 12:05:05,447 INFO  impl.FollowerState (FollowerState.java:run(109)) - a3559885-b627-40a4-995a-788826c25b83: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:05,451 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf:group-A7F567635895 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:04ad0f60-151d-437d-975f-daff3152c06e
2019-06-13 12:05:05,451 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: shutdown FollowerState
2019-06-13 12:05:05,451 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: start FollowerState
2019-06-13 12:05:05,451 INFO  impl.FollowerState (FollowerState.java:run(109)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:05,454 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 04ad0f60-151d-437d-975f-daff3152c06e:group-A7F567635895:LeaderElection114: Election PASSED; received 1 response(s) [04ad0f60-151d-437d-975f-daff3152c06e->79d0af09-eb9d-4ec5-a596-8aa5678795cf,true-t1] and 0 exception(s); 04ad0f60-151d-437d-975f-daff3152c06e:t1, leader=null, voted=04ad0f60-151d-437d-975f-daff3152c06e, raftlog=04ad0f60-151d-437d-975f-daff3152c06e-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [04ad0f60-151d-437d-975f-daff3152c06e:192.168.46.58:45131, 79d0af09-eb9d-4ec5-a596-8aa5678795cf:192.168.46.58:34739, a3559885-b627-40a4-995a-788826c25b83:192.168.46.58:42801], old=null
2019-06-13 12:05:05,454 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 04ad0f60-151d-437d-975f-daff3152c06e: shutdown LeaderElection
2019-06-13 12:05:05,454 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 04ad0f60-151d-437d-975f-daff3152c06e:group-A7F567635895 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:05,454 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 04ad0f60-151d-437d-975f-daff3152c06e:group-A7F567635895 change Leader from null to 04ad0f60-151d-437d-975f-daff3152c06e at term 1 for becomeLeader, leader elected after 1084ms
2019-06-13 12:05:05,454 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:05,454 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:05,454 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:05,454 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:05,454 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 12:05:05,454 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:05,454 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 12:05:05,454 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 12:05:05,455 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:05,455 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:05,455 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 12:05:05,455 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:05,455 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 12:05:05,455 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 12:05:05,455 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:05,455 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:05,455 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 04ad0f60-151d-437d-975f-daff3152c06e: start LeaderState
2019-06-13 12:05:05,455 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 04ad0f60-151d-437d-975f-daff3152c06e-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:05,457 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 04ad0f60-151d-437d-975f-daff3152c06e:group-A7F567635895 set configuration 0: [04ad0f60-151d-437d-975f-daff3152c06e:192.168.46.58:45131, 79d0af09-eb9d-4ec5-a596-8aa5678795cf:192.168.46.58:34739, a3559885-b627-40a4-995a-788826c25b83:192.168.46.58:42801], old=null at 0
2019-06-13 12:05:05,458 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf:group-A7F567635895 change Leader from null to 04ad0f60-151d-437d-975f-daff3152c06e at term 1 for appendEntries, leader elected after 1090ms
2019-06-13 12:05:05,458 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - a3559885-b627-40a4-995a-788826c25b83:group-A7F567635895 change Leader from null to 04ad0f60-151d-437d-975f-daff3152c06e at term 1 for appendEntries, leader elected after 1089ms
2019-06-13 12:05:05,460 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf:group-A7F567635895 set configuration 0: [04ad0f60-151d-437d-975f-daff3152c06e:192.168.46.58:45131, 79d0af09-eb9d-4ec5-a596-8aa5678795cf:192.168.46.58:34739, a3559885-b627-40a4-995a-788826c25b83:192.168.46.58:42801], old=null at 0
2019-06-13 12:05:05,460 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:05,460 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - a3559885-b627-40a4-995a-788826c25b83:group-A7F567635895 set configuration 0: [04ad0f60-151d-437d-975f-daff3152c06e:192.168.46.58:45131, 79d0af09-eb9d-4ec5-a596-8aa5678795cf:192.168.46.58:34739, a3559885-b627-40a4-995a-788826c25b83:192.168.46.58:42801], old=null at 0
2019-06-13 12:05:05,461 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - a3559885-b627-40a4-995a-788826c25b83-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:05,484 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Cluster is ready. Got 7 of 7 DN Heartbeats.
2019-06-13 12:05:05,527 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-4/data/ratis/429a954f-d42b-46ab-9daa-a7f567635895/current/log_inprogress_0
2019-06-13 12:05:05,528 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 04ad0f60-151d-437d-975f-daff3152c06e-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-5/data/ratis/429a954f-d42b-46ab-9daa-a7f567635895/current/log_inprogress_0
2019-06-13 12:05:05,532 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - a3559885-b627-40a4-995a-788826c25b83-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-3/data/ratis/429a954f-d42b-46ab-9daa-a7f567635895/current/log_inprogress_0
2019-06-13 12:05:05,547 INFO  rpc.RpcClient (RpcClient.java:createVolume(289)) - Creating Volume: watchforcommithandlingtest, with root as owner.
2019-06-13 12:05:05,558 INFO  rpc.RpcClient (RpcClient.java:createBucket(426)) - Creating Bucket: watchforcommithandlingtest/watchforcommithandlingtest, with Versioning false and Storage Type set to DISK and Encryption set to false 
2019-06-13 12:05:05,562 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:getStorageContainerLocationClient(241)) - Creating StorageContainerLocationProtocol RPC client with address /0.0.0.0:33335
2019-06-13 12:05:05,572 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AEEE0137E638->d01635f5-389c-48c6-a556-065a2d6335ba: receive RaftClientReply:client-AEEE0137E638->d01635f5-389c-48c6-a556-065a2d6335ba@group-C0F55F198779, cid=79, FAILED org.apache.ratis.protocol.NotLeaderException: Server d01635f5-389c-48c6-a556-065a2d6335ba is not the leader (d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079). Request must be sent to leader., logIndex=0, commits[d01635f5-389c-48c6-a556-065a2d6335ba:c0, 49edf94f-9740-442b-93cb-b253ac905c5f:c-1, d01a31f5-1eb9-47dd-9402-63bda0089b40:c0]
2019-06-13 12:05:05,575 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:05:05,595 INFO  impl.FollowerState (FollowerState.java:run(101)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595:group-A640C4CC1883 changes to CANDIDATE, lastRpcTime:1097, electionTimeout:1097ms
2019-06-13 12:05:05,595 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595: shutdown FollowerState
2019-06-13 12:05:05,595 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595:group-A640C4CC1883 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:05,595 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595: start LeaderElection
2019-06-13 12:05:05,600 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595:group-A640C4CC1883:LeaderElection115: begin an election at term 1 for -1: [a9b1ce52-6f1c-41fa-8800-acc98e2db595:192.168.46.58:34089], old=null
2019-06-13 12:05:05,600 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595: shutdown LeaderElection
2019-06-13 12:05:05,600 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595:group-A640C4CC1883 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:05,601 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595:group-A640C4CC1883 change Leader from null to a9b1ce52-6f1c-41fa-8800-acc98e2db595 at term 1 for becomeLeader, leader elected after 1105ms
2019-06-13 12:05:05,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:05,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:05,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:05,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:05,601 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595: start LeaderState
2019-06-13 12:05:05,601 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:05,601 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595:group-A640C4CC1883 set configuration 0: [a9b1ce52-6f1c-41fa-8800-acc98e2db595:192.168.46.58:34089], old=null at 0
2019-06-13 12:05:05,636 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-6/data/ratis/996a5d59-799b-488b-a43c-a640c4cc1883/current/log_inprogress_0
2019-06-13 12:05:06,345 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1176, electionTimeout:1176ms
2019-06-13 12:05:06,345 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:06,345 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 54 for changeToCandidate
2019-06-13 12:05:06,345 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:06,348 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection116: begin an election at term 55 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:06,348 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection116 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:06,348 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection116 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:06,349 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection116: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t55, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:06,349 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:06,349 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:06,349 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 55 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:06,349 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:06,349 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:06,583 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AEEE0137E638->49edf94f-9740-442b-93cb-b253ac905c5f: receive RaftClientReply:client-AEEE0137E638->49edf94f-9740-442b-93cb-b253ac905c5f@group-C0F55F198779, cid=79, FAILED org.apache.ratis.protocol.NotLeaderException: Server 49edf94f-9740-442b-93cb-b253ac905c5f is not the leader (d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079). Request must be sent to leader., logIndex=0, commits[49edf94f-9740-442b-93cb-b253ac905c5f:c0, d01635f5-389c-48c6-a556-065a2d6335ba:c0, d01a31f5-1eb9-47dd-9402-63bda0089b40:c0]
2019-06-13 12:05:06,584 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:05:07,474 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1124, electionTimeout:1124ms
2019-06-13 12:05:07,474 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:07,474 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 55 for changeToCandidate
2019-06-13 12:05:07,474 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:07,477 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection117: begin an election at term 56 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:07,478 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection117 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:07,478 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection117 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:07,478 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection117: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t56, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:07,478 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:07,478 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:07,478 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 56 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:07,479 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:07,479 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:07,618 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AEEE0137E638->d01a31f5-1eb9-47dd-9402-63bda0089b40: receive RaftClientReply:client-AEEE0137E638->d01a31f5-1eb9-47dd-9402-63bda0089b40@group-C0F55F198779, cid=79, SUCCESS, logIndex=1, commits[d01a31f5-1eb9-47dd-9402-63bda0089b40:c2, 49edf94f-9740-442b-93cb-b253ac905c5f:c1, d01635f5-389c-48c6-a556-065a2d6335ba:c1]
2019-06-13 12:05:07,621 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: 33db2c15-0441-4188-b761-c0f55f198779, Nodes: d01635f5-389c-48c6-a556-065a2d6335ba{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}d01a31f5-1eb9-47dd-9402-63bda0089b40{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}49edf94f-9740-442b-93cb-b253ac905c5f{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-13 12:05:07,624 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 33db2c15-0441-4188-b761-c0f55f198779, Nodes: d01635f5-389c-48c6-a556-065a2d6335ba{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}d01a31f5-1eb9-47dd-9402-63bda0089b40{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}49edf94f-9740-442b-93cb-b253ac905c5f{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] moved to CLOSED state
2019-06-13 12:05:07,629 INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #1
2019-06-13 12:05:07,633 INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - d01635f5-389c-48c6-a556-065a2d6335ba: remove FOLLOWER group-C0F55F198779 d01635f5-389c-48c6-a556-065a2d6335ba:t1, leader=d01a31f5-1eb9-47dd-9402-63bda0089b40, voted=d01a31f5-1eb9-47dd-9402-63bda0089b40, raftlog=d01635f5-389c-48c6-a556-065a2d6335ba-SegmentedRaftLog:OPENED:c1,f2,i2, conf=0: [49edf94f-9740-442b-93cb-b253ac905c5f:192.168.46.58:45211, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079], old=null RUNNING
2019-06-13 12:05:07,636 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - d01635f5-389c-48c6-a556-065a2d6335ba: shutdown group-C0F55F198779
2019-06-13 12:05:07,636 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C0F55F198779,id=d01635f5-389c-48c6-a556-065a2d6335ba
2019-06-13 12:05:07,636 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d01635f5-389c-48c6-a556-065a2d6335ba: shutdown FollowerState
2019-06-13 12:05:07,637 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-d01635f5-389c-48c6-a556-065a2d6335ba-group-C0F55F198779: set stopIndex = 1
2019-06-13 12:05:07,637 INFO  impl.FollowerState (FollowerState.java:run(109)) - d01635f5-389c-48c6-a556-065a2d6335ba: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:07,637 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:1)
2019-06-13 12:05:07,637 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-0/data/ratis/33db2c15-0441-4188-b761-c0f55f198779/sm/snapshot.1_1
2019-06-13 12:05:07,637 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - d01635f5-389c-48c6-a556-065a2d6335ba:group-C0F55F198779 closes. The last applied log index is 1
2019-06-13 12:05:07,637 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - d01635f5-389c-48c6-a556-065a2d6335ba-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:07,643 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - d01635f5-389c-48c6-a556-065a2d6335ba-RaftLogWorker close()
2019-06-13 12:05:07,664 INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: remove   LEADER group-C0F55F198779 d01a31f5-1eb9-47dd-9402-63bda0089b40:t1, leader=d01a31f5-1eb9-47dd-9402-63bda0089b40, voted=d01a31f5-1eb9-47dd-9402-63bda0089b40, raftlog=d01a31f5-1eb9-47dd-9402-63bda0089b40-SegmentedRaftLog:OPENED:c2,f2,i2, conf=0: [49edf94f-9740-442b-93cb-b253ac905c5f:192.168.46.58:45211, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079], old=null RUNNING
2019-06-13 12:05:07,664 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: shutdown group-C0F55F198779
2019-06-13 12:05:07,664 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C0F55F198779,id=d01a31f5-1eb9-47dd-9402-63bda0089b40
2019-06-13 12:05:07,664 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: shutdown LeaderState
2019-06-13 12:05:07,665 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - d01a31f5-1eb9-47dd-9402-63bda0089b40-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:07,665 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(d01a31f5-1eb9-47dd-9402-63bda0089b40 -> d01635f5-389c-48c6-a556-065a2d6335ba): Wait interrupted by java.lang.InterruptedException
2019-06-13 12:05:07,665 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(d01a31f5-1eb9-47dd-9402-63bda0089b40 -> 49edf94f-9740-442b-93cb-b253ac905c5f): Wait interrupted by java.lang.InterruptedException
2019-06-13 12:05:07,667 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - d01635f5-389c-48c6-a556-065a2d6335ba: appendEntries completed
2019-06-13 12:05:07,667 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 49edf94f-9740-442b-93cb-b253ac905c5f: appendEntries completed
2019-06-13 12:05:07,671 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-13 12:05:07,671 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-1/data/ratis/33db2c15-0441-4188-b761-c0f55f198779/sm/snapshot.1_2
2019-06-13 12:05:07,671 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: follower d01a31f5-1eb9-47dd-9402-63bda0089b40->d01635f5-389c-48c6-a556-065a2d6335ba(c1,m2,n3, attendVote=true, lastRpcSendTime=83, lastRpcResponseTime=82) response Completed
2019-06-13 12:05:07,671 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-d01a31f5-1eb9-47dd-9402-63bda0089b40-group-C0F55F198779: set stopIndex = 2
2019-06-13 12:05:07,671 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - d01a31f5-1eb9-47dd-9402-63bda0089b40->d01635f5-389c-48c6-a556-065a2d6335ba: nextIndex: updateUnconditionally 3 -> 0
2019-06-13 12:05:07,672 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - d01a31f5-1eb9-47dd-9402-63bda0089b40:group-C0F55F198779 closes. The last applied log index is 2
2019-06-13 12:05:07,672 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - d01a31f5-1eb9-47dd-9402-63bda0089b40-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:07,672 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: follower d01a31f5-1eb9-47dd-9402-63bda0089b40->49edf94f-9740-442b-93cb-b253ac905c5f(c1,m2,n3, attendVote=true, lastRpcSendTime=84, lastRpcResponseTime=83) response Completed
2019-06-13 12:05:07,672 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - d01a31f5-1eb9-47dd-9402-63bda0089b40->49edf94f-9740-442b-93cb-b253ac905c5f: nextIndex: updateUnconditionally 3 -> -1
2019-06-13 12:05:07,679 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - d01a31f5-1eb9-47dd-9402-63bda0089b40-RaftLogWorker close()
2019-06-13 12:05:07,686 INFO  impl.RaftServerProxy (RaftServerProxy.java:remove(95)) - 49edf94f-9740-442b-93cb-b253ac905c5f: remove FOLLOWER group-C0F55F198779 49edf94f-9740-442b-93cb-b253ac905c5f:t1, leader=d01a31f5-1eb9-47dd-9402-63bda0089b40, voted=d01a31f5-1eb9-47dd-9402-63bda0089b40, raftlog=49edf94f-9740-442b-93cb-b253ac905c5f-SegmentedRaftLog:OPENED:c1,f2,i2, conf=0: [49edf94f-9740-442b-93cb-b253ac905c5f:192.168.46.58:45211, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079], old=null RUNNING
2019-06-13 12:05:07,686 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 49edf94f-9740-442b-93cb-b253ac905c5f: shutdown group-C0F55F198779
2019-06-13 12:05:07,686 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C0F55F198779,id=49edf94f-9740-442b-93cb-b253ac905c5f
2019-06-13 12:05:07,686 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 49edf94f-9740-442b-93cb-b253ac905c5f: shutdown FollowerState
2019-06-13 12:05:07,687 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-49edf94f-9740-442b-93cb-b253ac905c5f-group-C0F55F198779: set stopIndex = 1
2019-06-13 12:05:07,687 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:1)
2019-06-13 12:05:07,687 INFO  impl.FollowerState (FollowerState.java:run(109)) - 49edf94f-9740-442b-93cb-b253ac905c5f: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:07,687 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-2/data/ratis/33db2c15-0441-4188-b761-c0f55f198779/sm/snapshot.1_1
2019-06-13 12:05:07,687 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 49edf94f-9740-442b-93cb-b253ac905c5f:group-C0F55F198779 closes. The last applied log index is 1
2019-06-13 12:05:07,687 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 49edf94f-9740-442b-93cb-b253ac905c5f-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:07,689 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 49edf94f-9740-442b-93cb-b253ac905c5f-RaftLogWorker close()
2019-06-13 12:05:07,692 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:removePipeline(108)) - Pipeline Pipeline[ Id: 33db2c15-0441-4188-b761-c0f55f198779, Nodes: d01635f5-389c-48c6-a556-065a2d6335ba{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}d01a31f5-1eb9-47dd-9402-63bda0089b40{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}49edf94f-9740-442b-93cb-b253ac905c5f{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] removed from db
2019-06-13 12:05:07,695 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getPipelineIds(588)) - pipeline id PipelineID=39002594-c4bc-4d70-bc13-f21e39a6ab07
2019-06-13 12:05:07,695 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getPipelineIds(588)) - pipeline id PipelineID=f590c83b-07a0-4fe8-b3f9-3f4884d22acb
2019-06-13 12:05:07,695 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:getPipelineIds(588)) - pipeline id PipelineID=669fe6a8-f1a2-41e5-b5f4-90da6e597016
2019-06-13 12:05:07,702 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595: addNew group-83991802C8FD:[a9b1ce52-6f1c-41fa-8800-acc98e2db595:192.168.46.58:34089, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079] returns group-83991802C8FD:java.util.concurrent.CompletableFuture@5c508f94[Not completed]
2019-06-13 12:05:07,706 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595: new RaftServerImpl for group-83991802C8FD:[a9b1ce52-6f1c-41fa-8800-acc98e2db595:192.168.46.58:34089, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079] with ContainerStateMachine:uninitialized
2019-06-13 12:05:07,706 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:07,706 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:07,706 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:07,706 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:07,706 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595:group-83991802C8FD ConfigurationManager, init=-1: [a9b1ce52-6f1c-41fa-8800-acc98e2db595:192.168.46.58:34089, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:07,706 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - d01635f5-389c-48c6-a556-065a2d6335ba: addNew group-83991802C8FD:[a9b1ce52-6f1c-41fa-8800-acc98e2db595:192.168.46.58:34089, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079] returns group-83991802C8FD:java.util.concurrent.CompletableFuture@65543183[Not completed]
2019-06-13 12:05:07,706 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-6/data/ratis] (custom)
2019-06-13 12:05:07,707 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-6/data/ratis/41371cae-42ea-4196-aded-83991802c8fd does not exist. Creating ...
2019-06-13 12:05:07,707 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - d01635f5-389c-48c6-a556-065a2d6335ba: new RaftServerImpl for group-83991802C8FD:[a9b1ce52-6f1c-41fa-8800-acc98e2db595:192.168.46.58:34089, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079] with ContainerStateMachine:uninitialized
2019-06-13 12:05:07,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:07,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:07,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:07,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:07,707 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - d01635f5-389c-48c6-a556-065a2d6335ba:group-83991802C8FD ConfigurationManager, init=-1: [a9b1ce52-6f1c-41fa-8800-acc98e2db595:192.168.46.58:34089, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:07,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-0/data/ratis] (custom)
2019-06-13 12:05:07,709 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-0/data/ratis/41371cae-42ea-4196-aded-83991802c8fd does not exist. Creating ...
2019-06-13 12:05:07,709 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-6/data/ratis/41371cae-42ea-4196-aded-83991802c8fd/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:07,710 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: addNew group-83991802C8FD:[a9b1ce52-6f1c-41fa-8800-acc98e2db595:192.168.46.58:34089, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079] returns group-83991802C8FD:java.util.concurrent.CompletableFuture@73dff409[Not completed]
2019-06-13 12:05:07,710 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: new RaftServerImpl for group-83991802C8FD:[a9b1ce52-6f1c-41fa-8800-acc98e2db595:192.168.46.58:34089, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079] with ContainerStateMachine:uninitialized
2019-06-13 12:05:07,711 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:07,711 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:07,711 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:07,711 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:07,711 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - d01a31f5-1eb9-47dd-9402-63bda0089b40:group-83991802C8FD ConfigurationManager, init=-1: [a9b1ce52-6f1c-41fa-8800-acc98e2db595:192.168.46.58:34089, d01635f5-389c-48c6-a556-065a2d6335ba:192.168.46.58:44547, d01a31f5-1eb9-47dd-9402-63bda0089b40:192.168.46.58:42079], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:07,711 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-1/data/ratis] (custom)
2019-06-13 12:05:07,711 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-1/data/ratis/41371cae-42ea-4196-aded-83991802c8fd does not exist. Creating ...
2019-06-13 12:05:07,711 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-0/data/ratis/41371cae-42ea-4196-aded-83991802c8fd/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:07,712 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-6/data/ratis/41371cae-42ea-4196-aded-83991802c8fd has been successfully formatted.
2019-06-13 12:05:07,712 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:07,712 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:07,713 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:07,713 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:07,713 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:07,713 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:07,713 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new a9b1ce52-6f1c-41fa-8800-acc98e2db595-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-6/data/ratis/41371cae-42ea-4196-aded-83991802c8fd
2019-06-13 12:05:07,713 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:07,713 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:07,713 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:07,713 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:07,713 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:07,713 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:07,713 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:07,713 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:07,713 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-1/data/ratis/41371cae-42ea-4196-aded-83991802c8fd/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:07,714 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:07,714 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:07,713 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-0/data/ratis/41371cae-42ea-4196-aded-83991802c8fd has been successfully formatted.
2019-06-13 12:05:07,714 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:07,714 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:07,714 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:07,714 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:07,715 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:07,715 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:07,715 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new d01635f5-389c-48c6-a556-065a2d6335ba-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-0/data/ratis/41371cae-42ea-4196-aded-83991802c8fd
2019-06-13 12:05:07,715 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:07,715 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:07,715 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:07,715 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:07,715 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:07,715 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:07,715 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:07,715 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:07,716 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:07,717 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-1/data/ratis/41371cae-42ea-4196-aded-83991802c8fd has been successfully formatted.
2019-06-13 12:05:07,717 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:07,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:07,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:07,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:07,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:07,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:07,718 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new d01a31f5-1eb9-47dd-9402-63bda0089b40-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-005d9f01-e0ab-4a4d-8930-4195d5458d3b/datanode-1/data/ratis/41371cae-42ea-4196-aded-83991802c8fd
2019-06-13 12:05:07,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:07,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:07,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:07,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:07,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:07,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:07,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:07,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:07,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:07,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:07,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:07,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:07,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:07,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:07,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:07,722 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595: start group-83991802C8FD
2019-06-13 12:05:07,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:07,722 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595:group-83991802C8FD changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:07,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:07,722 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595: start FollowerState
2019-06-13 12:05:07,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:07,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:07,723 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-83991802C8FD,id=a9b1ce52-6f1c-41fa-8800-acc98e2db595
2019-06-13 12:05:07,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:07,723 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: start group-83991802C8FD
2019-06-13 12:05:07,723 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d01a31f5-1eb9-47dd-9402-63bda0089b40:group-83991802C8FD changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:07,723 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: start FollowerState
2019-06-13 12:05:07,723 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - d01635f5-389c-48c6-a556-065a2d6335ba: start group-83991802C8FD
2019-06-13 12:05:07,723 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d01635f5-389c-48c6-a556-065a2d6335ba:group-83991802C8FD changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:07,723 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-83991802C8FD,id=d01a31f5-1eb9-47dd-9402-63bda0089b40
2019-06-13 12:05:07,724 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d01635f5-389c-48c6-a556-065a2d6335ba: start FollowerState
2019-06-13 12:05:07,724 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-83991802C8FD,id=d01635f5-389c-48c6-a556-065a2d6335ba
2019-06-13 12:05:07,727 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 41371cae-42ea-4196-aded-83991802c8fd, Nodes: a9b1ce52-6f1c-41fa-8800-acc98e2db595{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}d01635f5-389c-48c6-a556-065a2d6335ba{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}d01a31f5-1eb9-47dd-9402-63bda0089b40{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-13 12:05:07,733 WARN  scm.XceiverClientRatis (XceiverClientRatis.java:watchForCommit(260)) - 3 way commit failed 
java.util.concurrent.ExecutionException: org.apache.ratis.protocol.GroupMismatchException: d01a31f5-1eb9-47dd-9402-63bda0089b40: group-C0F55F198779 not found.
	at java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:357)
	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1915)
	at org.apache.hadoop.hdds.scm.XceiverClientRatis.watchForCommit(XceiverClientRatis.java:257)
	at org.apache.hadoop.ozone.client.rpc.TestWatchForCommit.testWatchForCommitForGroupMismatchException(TestWatchForCommit.java:481)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
Caused by: org.apache.ratis.protocol.GroupMismatchException: d01a31f5-1eb9-47dd-9402-63bda0089b40: group-C0F55F198779 not found.
	at org.apache.ratis.server.impl.RaftServerProxy$ImplMap.get(RaftServerProxy.java:122)
	at org.apache.ratis.server.impl.RaftServerProxy.getImplFuture(RaftServerProxy.java:269)
	at org.apache.ratis.server.impl.RaftServerProxy.submitRequest(RaftServerProxy.java:327)
	at org.apache.ratis.server.impl.RaftServerProxy.submitClientRequestAsync(RaftServerProxy.java:333)
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:206)
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$UnorderedRequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:262)
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.onNext(GrpcClientProtocolService.java:226)
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.onNext(GrpcClientProtocolService.java:154)
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:248)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:263)
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:686)
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2019-06-13 12:05:07,734 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:shutdown(321)) - Shutting down the Mini Ozone Cluster
2019-06-13 12:05:07,734 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(336)) - Stopping the Mini Ozone Cluster
2019-06-13 12:05:07,734 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(338)) - Stopping the OzoneManager
2019-06-13 12:05:07,734 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 44353
2019-06-13 12:05:07,739 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 44353
2019-06-13 12:05:07,740 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service KeyDeletingService
2019-06-13 12:05:07,740 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-13 12:05:07,744 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@544300a6{/,null,UNAVAILABLE}{/ozoneManager}
2019-06-13 12:05:07,752 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@4c12f54a{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:07,752 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@43dddfdd{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,UNAVAILABLE}
2019-06-13 12:05:07,753 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@210e2f2f{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:07,754 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(344)) - Stopping the StorageContainerManager
2019-06-13 12:05:07,754 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(789)) - Stopping Replication Manager Service.
2019-06-13 12:05:07,754 INFO  container.ReplicationManager (ReplicationManager.java:stop(191)) - Replication Monitor Thread is not running.
2019-06-13 12:05:07,755 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(796)) - Stopping Lease Manager of the command watchers
2019-06-13 12:05:07,755 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(803)) - Stopping datanode service RPC server
2019-06-13 12:05:07,755 INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(373)) - Stopping the RPC server for DataNodes
2019-06-13 12:05:07,755 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 39367
2019-06-13 12:05:07,758 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 39367
2019-06-13 12:05:07,758 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-13 12:05:07,758 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(811)) - Stopping block service RPC server
2019-06-13 12:05:07,759 INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(145)) - Stopping the RPC server for Block Protocol
2019-06-13 12:05:07,761 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 37459
2019-06-13 12:05:07,763 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 37459
2019-06-13 12:05:07,763 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-13 12:05:07,763 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(818)) - Stopping the StorageContainerLocationProtocol RPC server
2019-06-13 12:05:07,763 INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(157)) - Stopping the RPC server for Client Protocol
2019-06-13 12:05:07,763 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 33335
2019-06-13 12:05:07,768 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 33335
2019-06-13 12:05:07,768 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(825)) - Stopping Storage Container Manager HTTP server.
2019-06-13 12:05:07,770 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-13 12:05:07,772 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@2acbe46d{/,null,UNAVAILABLE}{/scm}
2019-06-13 12:05:07,772 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@6c6b00f1{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:07,772 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@7aef8000{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,UNAVAILABLE}
2019-06-13 12:05:07,772 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@2fe38b73{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:07,773 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(836)) - Stopping Block Manager Service.
2019-06-13 12:05:07,773 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service SCMBlockDeletingService
2019-06-13 12:05:07,773 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service SCMBlockDeletingService
2019-06-13 12:05:07,774 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(858)) - Stopping SCM Event Queue.
2019-06-13 12:05:07,784 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(350)) - Shutting the HddsDatanodes
2019-06-13 12:05:07,784 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:05:07,784 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@2d2afc39
2019-06-13 12:05:07,784 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:05:07,784 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:05:07,785 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - d01635f5-389c-48c6-a556-065a2d6335ba: close
2019-06-13 12:05:07,785 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - d01635f5-389c-48c6-a556-065a2d6335ba: shutdown group-F21E39A6AB07
2019-06-13 12:05:07,785 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - d01635f5-389c-48c6-a556-065a2d6335ba: shutdown group-83991802C8FD
2019-06-13 12:05:07,785 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-F21E39A6AB07,id=d01635f5-389c-48c6-a556-065a2d6335ba
2019-06-13 12:05:07,785 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - d01635f5-389c-48c6-a556-065a2d6335ba: shutdown LeaderState
2019-06-13 12:05:07,785 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-83991802C8FD,id=d01635f5-389c-48c6-a556-065a2d6335ba
2019-06-13 12:05:07,785 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d01635f5-389c-48c6-a556-065a2d6335ba: shutdown FollowerState
2019-06-13 12:05:07,785 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - d01635f5-389c-48c6-a556-065a2d6335ba-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:07,786 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:07,786 INFO  impl.FollowerState (FollowerState.java:run(109)) - d01635f5-389c-48c6-a556-065a2d6335ba: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:07,786 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-d01635f5-389c-48c6-a556-065a2d6335ba-group-83991802C8FD: set stopIndex = -1
2019-06-13 12:05:07,786 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - d01635f5-389c-48c6-a556-065a2d6335ba:group-83991802C8FD closes. The last applied log index is -1
2019-06-13 12:05:07,786 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - d01635f5-389c-48c6-a556-065a2d6335ba-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:07,788 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - d01635f5-389c-48c6-a556-065a2d6335ba-RaftLogWorker close()
2019-06-13 12:05:07,792 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-d01635f5-389c-48c6-a556-065a2d6335ba-group-F21E39A6AB07: set stopIndex = 0
2019-06-13 12:05:07,792 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:07,792 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - d01635f5-389c-48c6-a556-065a2d6335ba:group-F21E39A6AB07 closes. The last applied log index is 0
2019-06-13 12:05:07,792 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - d01635f5-389c-48c6-a556-065a2d6335ba-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:07,794 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - d01635f5-389c-48c6-a556-065a2d6335ba-RaftLogWorker close()
2019-06-13 12:05:07,796 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - d01635f5-389c-48c6-a556-065a2d6335ba: shutdown server with port 44547 now
2019-06-13 12:05:07,797 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - d01635f5-389c-48c6-a556-065a2d6335ba: shutdown server with port 44547 successfully
2019-06-13 12:05:07,798 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:07,817 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:05:07,818 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@18fa5af6{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:05:07,818 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@7fdabb3b{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:07,818 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@57806346{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:05:07,818 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@201b52f7{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:07,819 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:05:07,819 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@2bed5828
2019-06-13 12:05:07,820 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:05:07,820 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:05:07,820 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: close
2019-06-13 12:05:07,820 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: shutdown group-3F4884D22ACB
2019-06-13 12:05:07,820 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-3F4884D22ACB,id=d01a31f5-1eb9-47dd-9402-63bda0089b40
2019-06-13 12:05:07,821 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: shutdown LeaderState
2019-06-13 12:05:07,821 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - d01a31f5-1eb9-47dd-9402-63bda0089b40-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:07,821 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-d01a31f5-1eb9-47dd-9402-63bda0089b40-group-3F4884D22ACB: set stopIndex = 0
2019-06-13 12:05:07,821 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:07,821 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - d01a31f5-1eb9-47dd-9402-63bda0089b40:group-3F4884D22ACB closes. The last applied log index is 0
2019-06-13 12:05:07,821 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - d01a31f5-1eb9-47dd-9402-63bda0089b40-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:07,823 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - d01a31f5-1eb9-47dd-9402-63bda0089b40-RaftLogWorker close()
2019-06-13 12:05:07,825 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: shutdown group-83991802C8FD
2019-06-13 12:05:07,825 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-83991802C8FD,id=d01a31f5-1eb9-47dd-9402-63bda0089b40
2019-06-13 12:05:07,825 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: shutdown FollowerState
2019-06-13 12:05:07,825 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-d01a31f5-1eb9-47dd-9402-63bda0089b40-group-83991802C8FD: set stopIndex = -1
2019-06-13 12:05:07,825 INFO  impl.FollowerState (FollowerState.java:run(109)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:07,825 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:07,825 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - d01a31f5-1eb9-47dd-9402-63bda0089b40:group-83991802C8FD closes. The last applied log index is -1
2019-06-13 12:05:07,826 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - d01a31f5-1eb9-47dd-9402-63bda0089b40-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:07,826 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - d01a31f5-1eb9-47dd-9402-63bda0089b40-RaftLogWorker close()
2019-06-13 12:05:07,829 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: shutdown server with port 42079 now
2019-06-13 12:05:07,832 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - d01a31f5-1eb9-47dd-9402-63bda0089b40: shutdown server with port 42079 successfully
2019-06-13 12:05:07,833 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:07,845 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:05:07,846 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@7962c1d5{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:05:07,846 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@56226064{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:07,846 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@7e017f47{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:05:07,846 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@556944cd{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:07,850 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:05:07,850 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@4280b20b
2019-06-13 12:05:07,850 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:05:07,850 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:05:07,851 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 49edf94f-9740-442b-93cb-b253ac905c5f: close
2019-06-13 12:05:07,851 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 49edf94f-9740-442b-93cb-b253ac905c5f: shutdown group-90DA6E597016
2019-06-13 12:05:07,851 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-90DA6E597016,id=49edf94f-9740-442b-93cb-b253ac905c5f
2019-06-13 12:05:07,851 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 49edf94f-9740-442b-93cb-b253ac905c5f: shutdown LeaderState
2019-06-13 12:05:07,851 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 49edf94f-9740-442b-93cb-b253ac905c5f-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:07,855 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-49edf94f-9740-442b-93cb-b253ac905c5f-group-90DA6E597016: set stopIndex = 0
2019-06-13 12:05:07,855 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:07,855 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 49edf94f-9740-442b-93cb-b253ac905c5f:group-90DA6E597016 closes. The last applied log index is 0
2019-06-13 12:05:07,855 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 49edf94f-9740-442b-93cb-b253ac905c5f-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:07,858 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 49edf94f-9740-442b-93cb-b253ac905c5f-RaftLogWorker close()
2019-06-13 12:05:07,859 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 49edf94f-9740-442b-93cb-b253ac905c5f: shutdown server with port 45211 now
2019-06-13 12:05:07,860 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 49edf94f-9740-442b-93cb-b253ac905c5f: shutdown server with port 45211 successfully
2019-06-13 12:05:07,861 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:07,875 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:05:07,876 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@17a5ae7b{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:05:07,876 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@7e4dddee{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:07,876 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@1e4b70c6{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:05:07,877 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@19542115{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:07,877 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:05:07,878 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@522f74a1
2019-06-13 12:05:07,878 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:05:07,878 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:05:07,878 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - a3559885-b627-40a4-995a-788826c25b83: close
2019-06-13 12:05:07,878 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - a3559885-b627-40a4-995a-788826c25b83: shutdown group-FF15286E6511
2019-06-13 12:05:07,878 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - a3559885-b627-40a4-995a-788826c25b83: shutdown group-A7F567635895
2019-06-13 12:05:07,878 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-FF15286E6511,id=a3559885-b627-40a4-995a-788826c25b83
2019-06-13 12:05:07,878 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-A7F567635895,id=a3559885-b627-40a4-995a-788826c25b83
2019-06-13 12:05:07,879 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - a3559885-b627-40a4-995a-788826c25b83: shutdown LeaderState
2019-06-13 12:05:07,879 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a3559885-b627-40a4-995a-788826c25b83: shutdown FollowerState
2019-06-13 12:05:07,879 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - a3559885-b627-40a4-995a-788826c25b83-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:07,879 INFO  impl.FollowerState (FollowerState.java:run(109)) - a3559885-b627-40a4-995a-788826c25b83: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:07,879 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:07,879 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-a3559885-b627-40a4-995a-788826c25b83-group-A7F567635895: set stopIndex = 0
2019-06-13 12:05:07,879 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-a3559885-b627-40a4-995a-788826c25b83-group-FF15286E6511: set stopIndex = 0
2019-06-13 12:05:07,879 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:07,880 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - a3559885-b627-40a4-995a-788826c25b83:group-FF15286E6511 closes. The last applied log index is 0
2019-06-13 12:05:07,879 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - a3559885-b627-40a4-995a-788826c25b83:group-A7F567635895 closes. The last applied log index is 0
2019-06-13 12:05:07,880 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - a3559885-b627-40a4-995a-788826c25b83-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:07,880 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - a3559885-b627-40a4-995a-788826c25b83-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:07,882 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - a3559885-b627-40a4-995a-788826c25b83-RaftLogWorker close()
2019-06-13 12:05:07,882 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - a3559885-b627-40a4-995a-788826c25b83-RaftLogWorker close()
2019-06-13 12:05:07,885 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - a3559885-b627-40a4-995a-788826c25b83: shutdown server with port 42801 now
2019-06-13 12:05:07,885 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - a3559885-b627-40a4-995a-788826c25b83: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:05:07,886 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 04ad0f60-151d-437d-975f-daff3152c06e: Failed appendEntries to a3559885-b627-40a4-995a-788826c25b83:192.168.46.58:42801: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-13 12:05:07,886 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 04ad0f60-151d-437d-975f-daff3152c06e->a3559885-b627-40a4-995a-788826c25b83: nextIndex: updateUnconditionally 1 -> 0
2019-06-13 12:05:07,886 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - a3559885-b627-40a4-995a-788826c25b83: shutdown server with port 42801 successfully
2019-06-13 12:05:07,887 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:07,898 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:05:07,899 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@29ce33e9{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:05:07,899 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@1f86f7da{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:07,899 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@41a3c6f5{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:05:07,899 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@34cb1310{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:07,900 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:05:07,900 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@4f571c0e
2019-06-13 12:05:07,900 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:05:07,900 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:05:07,901 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: close
2019-06-13 12:05:07,901 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: shutdown group-055DDB342211
2019-06-13 12:05:07,901 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: shutdown group-A7F567635895
2019-06-13 12:05:07,901 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-055DDB342211,id=79d0af09-eb9d-4ec5-a596-8aa5678795cf
2019-06-13 12:05:07,901 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-A7F567635895,id=79d0af09-eb9d-4ec5-a596-8aa5678795cf
2019-06-13 12:05:07,901 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: shutdown LeaderState
2019-06-13 12:05:07,901 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: shutdown FollowerState
2019-06-13 12:05:07,901 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:07,901 INFO  impl.FollowerState (FollowerState.java:run(109)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:07,902 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:07,901 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:07,901 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-79d0af09-eb9d-4ec5-a596-8aa5678795cf-group-A7F567635895: set stopIndex = 0
2019-06-13 12:05:07,902 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-79d0af09-eb9d-4ec5-a596-8aa5678795cf-group-055DDB342211: set stopIndex = 0
2019-06-13 12:05:07,902 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf:group-A7F567635895 closes. The last applied log index is 0
2019-06-13 12:05:07,902 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf:group-055DDB342211 closes. The last applied log index is 0
2019-06-13 12:05:07,902 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:07,904 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:07,904 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf-RaftLogWorker close()
2019-06-13 12:05:07,905 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf-RaftLogWorker close()
2019-06-13 12:05:07,908 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: shutdown server with port 34739 now
2019-06-13 12:05:07,910 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:05:07,910 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 79d0af09-eb9d-4ec5-a596-8aa5678795cf: shutdown server with port 34739 successfully
2019-06-13 12:05:07,910 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 04ad0f60-151d-437d-975f-daff3152c06e: Failed appendEntries to 79d0af09-eb9d-4ec5-a596-8aa5678795cf:192.168.46.58:34739: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-13 12:05:07,910 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 04ad0f60-151d-437d-975f-daff3152c06e->79d0af09-eb9d-4ec5-a596-8aa5678795cf: nextIndex: updateUnconditionally 1 -> 0
2019-06-13 12:05:07,913 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:07,923 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:05:07,924 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@504b4a97{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:05:07,924 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@4964d801{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:07,924 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@789f5552{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:05:07,924 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@63b2418e{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:07,925 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:05:07,925 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@28532753
2019-06-13 12:05:07,925 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:05:07,925 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:05:07,925 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 04ad0f60-151d-437d-975f-daff3152c06e: close
2019-06-13 12:05:07,926 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 04ad0f60-151d-437d-975f-daff3152c06e: shutdown group-1418C516015C
2019-06-13 12:05:07,926 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-1418C516015C,id=04ad0f60-151d-437d-975f-daff3152c06e
2019-06-13 12:05:07,926 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 04ad0f60-151d-437d-975f-daff3152c06e: shutdown LeaderState
2019-06-13 12:05:07,926 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 04ad0f60-151d-437d-975f-daff3152c06e-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:07,926 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-04ad0f60-151d-437d-975f-daff3152c06e-group-1418C516015C: set stopIndex = 0
2019-06-13 12:05:07,926 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:07,926 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 04ad0f60-151d-437d-975f-daff3152c06e:group-1418C516015C closes. The last applied log index is 0
2019-06-13 12:05:07,927 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 04ad0f60-151d-437d-975f-daff3152c06e-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:07,928 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 04ad0f60-151d-437d-975f-daff3152c06e-RaftLogWorker close()
2019-06-13 12:05:07,929 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 04ad0f60-151d-437d-975f-daff3152c06e: shutdown group-A7F567635895
2019-06-13 12:05:07,930 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-A7F567635895,id=04ad0f60-151d-437d-975f-daff3152c06e
2019-06-13 12:05:07,930 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 04ad0f60-151d-437d-975f-daff3152c06e: shutdown LeaderState
2019-06-13 12:05:07,930 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 04ad0f60-151d-437d-975f-daff3152c06e-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:07,930 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(04ad0f60-151d-437d-975f-daff3152c06e -> 79d0af09-eb9d-4ec5-a596-8aa5678795cf): Wait interrupted by java.lang.InterruptedException
2019-06-13 12:05:07,930 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(04ad0f60-151d-437d-975f-daff3152c06e -> a3559885-b627-40a4-995a-788826c25b83): Wait interrupted by java.lang.InterruptedException
2019-06-13 12:05:07,930 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:07,930 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-04ad0f60-151d-437d-975f-daff3152c06e-group-A7F567635895: set stopIndex = 0
2019-06-13 12:05:07,930 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 04ad0f60-151d-437d-975f-daff3152c06e:group-A7F567635895 closes. The last applied log index is 0
2019-06-13 12:05:07,931 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 04ad0f60-151d-437d-975f-daff3152c06e-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:07,932 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 04ad0f60-151d-437d-975f-daff3152c06e-RaftLogWorker close()
2019-06-13 12:05:07,933 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 04ad0f60-151d-437d-975f-daff3152c06e: shutdown server with port 45131 now
2019-06-13 12:05:07,935 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 04ad0f60-151d-437d-975f-daff3152c06e: shutdown server with port 45131 successfully
2019-06-13 12:05:07,936 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:07,954 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:05:07,955 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@1ce45e18{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:05:07,955 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@25762f04{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:07,955 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@4dc16fc9{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:05:07,955 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@9d7a853{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:07,956 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:05:07,956 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@5d10e2b6
2019-06-13 12:05:07,956 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:05:07,958 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:05:07,958 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595: close
2019-06-13 12:05:07,959 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595: shutdown group-A640C4CC1883
2019-06-13 12:05:07,959 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595: shutdown group-83991802C8FD
2019-06-13 12:05:07,959 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-A640C4CC1883,id=a9b1ce52-6f1c-41fa-8800-acc98e2db595
2019-06-13 12:05:07,959 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-83991802C8FD,id=a9b1ce52-6f1c-41fa-8800-acc98e2db595
2019-06-13 12:05:07,959 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595: shutdown LeaderState
2019-06-13 12:05:07,959 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595: shutdown FollowerState
2019-06-13 12:05:07,959 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:07,959 INFO  impl.FollowerState (FollowerState.java:run(109)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:07,959 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-a9b1ce52-6f1c-41fa-8800-acc98e2db595-group-A640C4CC1883: set stopIndex = 0
2019-06-13 12:05:07,959 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:07,959 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-a9b1ce52-6f1c-41fa-8800-acc98e2db595-group-83991802C8FD: set stopIndex = -1
2019-06-13 12:05:07,959 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:07,960 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595:group-83991802C8FD closes. The last applied log index is -1
2019-06-13 12:05:07,960 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595:group-A640C4CC1883 closes. The last applied log index is 0
2019-06-13 12:05:07,960 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:07,960 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:07,960 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595-RaftLogWorker close()
2019-06-13 12:05:07,963 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595-RaftLogWorker close()
2019-06-13 12:05:07,964 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595: shutdown server with port 34089 now
2019-06-13 12:05:07,965 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - a9b1ce52-6f1c-41fa-8800-acc98e2db595: shutdown server with port 34089 successfully
2019-06-13 12:05:07,966 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:07,977 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:05:07,977 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@1315befe{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:05:07,978 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@45649467{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:07,978 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@22942eff{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:05:07,978 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@5cfa9e8a{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:07,996 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:05:07,999 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:05:08,000 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:05:08,000 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedBlocks
2019-06-13 12:05:08,000 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedBlocks
2019-06-13 12:05:08,000 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: validCerts
2019-06-13 12:05:08,000 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:validCerts
2019-06-13 12:05:08,000 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: revokedCerts
2019-06-13 12:05:08,000 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:revokedCerts
2019-06-13 12:05:08,001 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-13 12:05:08,001 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-13 12:05:08,001 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-13 12:05:08,039 WARN  server.ServerUtils (ServerUtils.java:sanitizeUserArgs(70)) - ozone.scm.stale.node.interval value = 300000 is larger than max = 100000 based on the key value of ozone.scm.heartbeat.thread.interval, reset to the max value 100000.
2019-06-13 12:05:08,039 WARN  server.ServerUtils (ServerUtils.java:sanitizeUserArgs(70)) - ozone.scm.stale.node.interval value = 300000 is larger than max = 100000 based on the key value of ozone.scm.heartbeat.thread.interval, reset to the max value 100000.
2019-06-13 12:05:08,040 INFO  node.SCMNodeManager (SCMNodeManager.java:<init>(108)) - Entering startup safe mode.
2019-06-13 12:05:08,040 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(125)) - Loading file from sun.misc.CompoundEnumeration@1a4c6e74
2019-06-13 12:05:08,040 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(171)) - Loading network topology layer schema file
2019-06-13 12:05:08,042 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:05:08,056 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:initializePipelineState(126)) - No pipeline exists in current db
2019-06-13 12:05:08,056 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:05:08,069 WARN  events.EventQueue (EventQueue.java:fireEvent(175)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='SafeModeStatus'}
2019-06-13 12:05:08,069 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-13 12:05:08,070 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 32965
2019-06-13 12:05:08,072 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-13 12:05:08,072 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 39973
2019-06-13 12:05:08,075 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-13 12:05:08,075 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 44851
2019-06-13 12:05:08,106 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for scm at: http://0.0.0.0:0
2019-06-13 12:05:08,107 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:05:08,107 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:05:08,108 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:05:08,108 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context scm
2019-06-13 12:05:08,109 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:05:08,109 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:05:08,112 INFO  server.StorageContainerManager (StorageContainerManager.java:start(752)) - StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:44851
2019-06-13 12:05:08,112 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - StorageContainerManager metrics system started (again)
2019-06-13 12:05:08,112 INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:start(149)) - RPC server for Client  is listening at /0.0.0.0:44851
2019-06-13 12:05:08,113 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 44851: starting
2019-06-13 12:05:08,113 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-13 12:05:08,123 INFO  server.StorageContainerManager (StorageContainerManager.java:start(761)) - ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:39973
2019-06-13 12:05:08,123 INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:start(137)) - RPC server for Block Protocol is listening at /0.0.0.0:39973
2019-06-13 12:05:08,124 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-13 12:05:08,124 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 39973: starting
2019-06-13 12:05:08,128 INFO  server.StorageContainerManager (StorageContainerManager.java:start(765)) - ScmDatanodeProtocl RPC server is listening at /0.0.0.0:32965
2019-06-13 12:05:08,128 INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:start(191)) - RPC server for DataNodes is listening at /0.0.0.0:32965
2019-06-13 12:05:08,128 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-13 12:05:08,128 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 32965: starting
2019-06-13 12:05:08,133 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 36967
2019-06-13 12:05:08,133 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:05:08,134 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@2cf97875{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:05:08,134 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@72fa021{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-13 12:05:08,136 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@5d94c50e{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/scm/,AVAILABLE}{/scm}
2019-06-13 12:05:08,137 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@135f160e{HTTP/1.1,[http/1.1]}{0.0.0.0:36967}
2019-06-13 12:05:08,138 INFO  server.Server (Server.java:doStart(419)) - Started @77359ms
2019-06-13 12:05:08,139 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of SCM is listening at http://0.0.0.0:36967
2019-06-13 12:05:08,140 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:05:08,140 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:05:08,143 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:05:08,143 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(519)) - OM Service ID is not set. Setting it to the default ID: omServiceIdDefault
2019-06-13 12:05:08,143 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(525)) - OM Node ID is not set. Setting it to the OmStorage's OmID: 3d12629c-5f2f-40f6-ab50-091667cd8d1c
2019-06-13 12:05:08,143 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 12:05:08,143 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 12:05:08,144 INFO  om.OzoneManager (OzoneManager.java:loadOMHAConfigs(476)) - Found matching OM address with OMServiceId: null, OMNodeId: null, RPC Address: localhost:0 and Ratis port: 9872
2019-06-13 12:05:08,150 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:05:08,151 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: userTable
2019-06-13 12:05:08,151 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:userTable
2019-06-13 12:05:08,151 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: volumeTable
2019-06-13 12:05:08,151 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:volumeTable
2019-06-13 12:05:08,151 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: bucketTable
2019-06-13 12:05:08,151 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:bucketTable
2019-06-13 12:05:08,152 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: keyTable
2019-06-13 12:05:08,152 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:keyTable
2019-06-13 12:05:08,152 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedTable
2019-06-13 12:05:08,152 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedTable
2019-06-13 12:05:08,152 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: openKeyTable
2019-06-13 12:05:08,152 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:openKeyTable
2019-06-13 12:05:08,152 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3Table
2019-06-13 12:05:08,152 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3Table
2019-06-13 12:05:08,152 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: multipartInfoTable
2019-06-13 12:05:08,153 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:multipartInfoTable
2019-06-13 12:05:08,153 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: dTokenTable
2019-06-13 12:05:08,153 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:dTokenTable
2019-06-13 12:05:08,153 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3SecretTable
2019-06-13 12:05:08,153 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3SecretTable
2019-06-13 12:05:08,153 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: prefixTable
2019-06-13 12:05:08,153 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:prefixTable
2019-06-13 12:05:08,153 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-13 12:05:08,154 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-13 12:05:08,154 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-13 12:05:08,275 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-13 12:05:08,276 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 46083
2019-06-13 12:05:08,286 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:05:08,287 INFO  om.OzoneManager (OzoneManager.java:start(1217)) - OzoneManager RPC server is listening at localhost/127.0.0.1:46083
2019-06-13 12:05:08,287 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - OzoneManager metrics system started (again)
2019-06-13 12:05:08,292 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-13 12:05:08,292 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 46083: starting
2019-06-13 12:05:08,296 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for ozoneManager at: http://0.0.0.0:0
2019-06-13 12:05:08,297 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:05:08,297 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:05:08,298 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:05:08,298 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context ozoneManager
2019-06-13 12:05:08,298 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:05:08,299 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:05:08,299 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 34291
2019-06-13 12:05:08,299 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:05:08,302 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@2703785e{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:05:08,303 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@5a2297d7{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-13 12:05:08,305 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@5c7b504{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/ozoneManager/,AVAILABLE}{/ozoneManager}
2019-06-13 12:05:08,305 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@772589ed{HTTP/1.1,[http/1.1]}{0.0.0.0:34291}
2019-06-13 12:05:08,307 INFO  server.Server (Server.java:doStart(419)) - Started @77527ms
2019-06-13 12:05:08,307 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of OZONEMANAGER is listening at http://0.0.0.0:34291
2019-06-13 12:05:08,314 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:05:08,314 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:05:08,320 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-0/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:05:08,320 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-0/data/containers/hdds to VolumeSet
2019-06-13 12:05:08,320 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@7364073b
2019-06-13 12:05:08,321 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@7364073b
2019-06-13 12:05:08,331 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 36749
2019-06-13 12:05:08,332 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:05:08,332 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 36749 (custom)
2019-06-13 12:05:08,332 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:05:08,332 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:08,333 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:05:08,333 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:08,333 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-0/data/ratis] (custom)
2019-06-13 12:05:08,334 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 41181
2019-06-13 12:05:08,334 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:05:08,337 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:05:08,338 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:05:08,343 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:05:08,344 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:05:08,344 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:05:08,344 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:05:08,344 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:05:08,345 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 46877
2019-06-13 12:05:08,345 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:05:08,346 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@4b74a4d{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:05:08,346 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@49c72fb7{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:05:08,365 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@67b1c3af{/,file:///tmp/jetty-0.0.0.0-46877-hddsDatanode-_-any-2700768300282152606.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:05:08,365 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@2e243122{HTTP/1.1,[http/1.1]}{0.0.0.0:46877}
2019-06-13 12:05:08,367 INFO  server.Server (Server.java:doStart(419)) - Started @77588ms
2019-06-13 12:05:08,368 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:46877
Jun 13, 2019 12:05:08 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:05:08,494 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@d0538b3
2019-06-13 12:05:08,496 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:05:08,497 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:05:08,516 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-1/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:05:08,516 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-1/data/containers/hdds to VolumeSet
2019-06-13 12:05:08,516 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@714a4ba2
2019-06-13 12:05:08,541 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@714a4ba2
2019-06-13 12:05:08,551 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:05:08,555 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-0/meta/datanode.id
2019-06-13 12:05:08,570 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 34659
2019-06-13 12:05:08,572 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:05:08,573 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 34659 (custom)
2019-06-13 12:05:08,573 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:05:08,573 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:08,573 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:05:08,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:08,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-1/data/ratis] (custom)
2019-06-13 12:05:08,574 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 45969
2019-06-13 12:05:08,575 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:05:08,575 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:05:08,576 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:05:08,577 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:05:08,578 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:05:08,578 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:05:08,578 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:05:08,578 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:05:08,578 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 39823
2019-06-13 12:05:08,579 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:05:08,580 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@31c29db1{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:05:08,580 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@2279e7c7{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:05:08,602 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@5e781b4f{/,file:///tmp/jetty-0.0.0.0-39823-hddsDatanode-_-any-4958879108281740176.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:05:08,602 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@1b89debc{HTTP/1.1,[http/1.1]}{0.0.0.0:39823}
2019-06-13 12:05:08,604 INFO  server.Server (Server.java:doStart(419)) - Started @77825ms
2019-06-13 12:05:08,604 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:39823
Jun 13, 2019 12:05:08 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:05:08,674 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1195, electionTimeout:1195ms
2019-06-13 12:05:08,674 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:08,674 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 56 for changeToCandidate
2019-06-13 12:05:08,676 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:08,678 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@3d6c7152
2019-06-13 12:05:08,679 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:05:08,679 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:05:08,680 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:05:08,682 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-1/meta/datanode.id
2019-06-13 12:05:08,682 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection118: begin an election at term 57 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:08,685 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection118 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:08,686 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection118 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:08,686 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection118: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t57, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:08,686 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:08,686 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:08,686 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 57 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:08,686 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:08,686 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:08,689 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-2/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:05:08,689 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-2/data/containers/hdds to VolumeSet
2019-06-13 12:05:08,689 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@579cfcc4
2019-06-13 12:05:08,689 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@579cfcc4
2019-06-13 12:05:08,698 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 38359
2019-06-13 12:05:08,700 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:05:08,700 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 38359 (custom)
2019-06-13 12:05:08,701 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:05:08,701 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:08,701 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:05:08,701 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:08,701 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-2/data/ratis] (custom)
2019-06-13 12:05:08,702 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 41735
2019-06-13 12:05:08,702 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:05:08,705 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:05:08,706 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:05:08,706 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:05:08,707 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:05:08,707 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:05:08,707 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:05:08,707 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:05:08,708 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 39239
2019-06-13 12:05:08,708 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:05:08,709 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@45e49d3d{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:05:08,709 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@4615bc00{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:05:08,728 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@30a99b85{/,file:///tmp/jetty-0.0.0.0-39239-hddsDatanode-_-any-6944853901127096499.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:05:08,729 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@386d41cb{HTTP/1.1,[http/1.1]}{0.0.0.0:39239}
2019-06-13 12:05:08,730 INFO  server.Server (Server.java:doStart(419)) - Started @77951ms
2019-06-13 12:05:08,732 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:39239
Jun 13, 2019 12:05:08 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:05:08,808 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@10acfe30
2019-06-13 12:05:08,808 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:05:08,809 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:05:08,819 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-3/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:05:08,819 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-3/data/containers/hdds to VolumeSet
2019-06-13 12:05:08,819 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1ead6e20
2019-06-13 12:05:08,819 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:05:08,830 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1ead6e20
2019-06-13 12:05:08,834 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-2/meta/datanode.id
2019-06-13 12:05:08,837 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 46669
2019-06-13 12:05:08,838 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:05:08,838 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 46669 (custom)
2019-06-13 12:05:08,838 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:05:08,838 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:08,838 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:05:08,838 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:08,839 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-3/data/ratis] (custom)
2019-06-13 12:05:08,839 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 39981
2019-06-13 12:05:08,839 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:05:08,840 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:05:08,841 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:05:08,841 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:05:08,842 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:05:08,842 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:05:08,844 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:05:08,844 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:05:08,845 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 37579
2019-06-13 12:05:08,845 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:05:08,846 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@257e8c43{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:05:08,846 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@298cfe89{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:05:08,865 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@6fe55fcf{/,file:///tmp/jetty-0.0.0.0-37579-hddsDatanode-_-any-2602691716498930042.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:05:08,865 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@4d1f6e1c{HTTP/1.1,[http/1.1]}{0.0.0.0:37579}
2019-06-13 12:05:08,867 INFO  server.Server (Server.java:doStart(419)) - Started @78088ms
2019-06-13 12:05:08,868 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:37579
Jun 13, 2019 12:05:08 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:05:08,940 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@75937998
2019-06-13 12:05:08,941 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:05:08,941 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:05:08,948 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:05:08,949 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-3/meta/datanode.id
2019-06-13 12:05:08,951 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-4/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:05:08,951 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-4/data/containers/hdds to VolumeSet
2019-06-13 12:05:08,952 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@62d72091
2019-06-13 12:05:08,952 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@62d72091
2019-06-13 12:05:08,964 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 42309
2019-06-13 12:05:08,966 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:05:08,966 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42309 (custom)
2019-06-13 12:05:08,967 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:05:08,967 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:08,967 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:05:08,967 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:08,968 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-4/data/ratis] (custom)
2019-06-13 12:05:08,968 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 41773
2019-06-13 12:05:08,968 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:05:08,969 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:05:08,970 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:05:08,970 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:05:08,971 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:05:08,971 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:05:08,972 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:05:08,972 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:05:08,972 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 46155
2019-06-13 12:05:08,972 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:05:08,973 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@5c7c22ce{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:05:08,977 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@328b2c2a{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:05:08,997 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@36d7e8d2{/,file:///tmp/jetty-0.0.0.0-46155-hddsDatanode-_-any-5157443582361329107.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:05:08,997 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@715ea64a{HTTP/1.1,[http/1.1]}{0.0.0.0:46155}
2019-06-13 12:05:09,000 INFO  server.Server (Server.java:doStart(419)) - Started @78221ms
2019-06-13 12:05:09,002 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:46155
Jun 13, 2019 12:05:09 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:05:09,075 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@6108c962
2019-06-13 12:05:09,075 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:05:09,075 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:05:09,109 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:05:09,113 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-4/meta/datanode.id
2019-06-13 12:05:09,117 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-5/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:05:09,118 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-5/data/containers/hdds to VolumeSet
2019-06-13 12:05:09,118 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@452ea8f0
2019-06-13 12:05:09,118 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@452ea8f0
2019-06-13 12:05:09,129 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43553
2019-06-13 12:05:09,131 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:05:09,131 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43553 (custom)
2019-06-13 12:05:09,131 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:05:09,131 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:09,132 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:05:09,132 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:09,132 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-5/data/ratis] (custom)
2019-06-13 12:05:09,132 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 34749
2019-06-13 12:05:09,132 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:05:09,134 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:05:09,134 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:05:09,135 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:05:09,135 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:05:09,136 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:05:09,136 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:05:09,136 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:05:09,136 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 42607
2019-06-13 12:05:09,136 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:05:09,137 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@dcf64d2{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:05:09,138 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@7959fbe3{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:05:09,157 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@3582077c{/,file:///tmp/jetty-0.0.0.0-42607-hddsDatanode-_-any-7840806726078825467.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:05:09,157 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@5d00241b{HTTP/1.1,[http/1.1]}{0.0.0.0:42607}
2019-06-13 12:05:09,159 INFO  server.Server (Server.java:doStart(419)) - Started @78380ms
2019-06-13 12:05:09,159 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:42607
Jun 13, 2019 12:05:09 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:05:09,229 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@7b1a9ab3
2019-06-13 12:05:09,232 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:05:09,233 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:05:09,236 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:05:09,236 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-5/meta/datanode.id
2019-06-13 12:05:09,242 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-6/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:05:09,242 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-6/data/containers/hdds to VolumeSet
2019-06-13 12:05:09,242 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1651bd68
2019-06-13 12:05:09,243 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1651bd68
2019-06-13 12:05:09,253 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 32879
2019-06-13 12:05:09,255 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:05:09,255 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 32879 (custom)
2019-06-13 12:05:09,255 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:05:09,255 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:09,255 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:05:09,255 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:09,256 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-6/data/ratis] (custom)
2019-06-13 12:05:09,256 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 37199
2019-06-13 12:05:09,256 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:05:09,257 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:05:09,258 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:05:09,258 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:05:09,259 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:05:09,260 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:05:09,260 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:05:09,260 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:05:09,260 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 45505
2019-06-13 12:05:09,260 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:05:09,261 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@6d43c881{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:05:09,262 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@513cd96f{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:05:09,281 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@4ab1693b{/,file:///tmp/jetty-0.0.0.0-45505-hddsDatanode-_-any-4575265437293411401.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:05:09,281 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@35e0d91e{HTTP/1.1,[http/1.1]}{0.0.0.0:45505}
2019-06-13 12:05:09,283 INFO  server.Server (Server.java:doStart(419)) - Started @78504ms
2019-06-13 12:05:09,284 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:45505
Jun 13, 2019 12:05:09 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:05:09,362 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@5d04adc1
2019-06-13 12:05:09,362 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 7 DN Heartbeats.
2019-06-13 12:05:09,363 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:05:09,364 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-6/meta/datanode.id
2019-06-13 12:05:09,881 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1194, electionTimeout:1192ms
2019-06-13 12:05:09,881 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:09,881 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 57 for changeToCandidate
2019-06-13 12:05:09,881 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:09,884 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection119: begin an election at term 58 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:09,885 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection119 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:09,885 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection119 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:09,886 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection119: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t58, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:09,886 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:09,886 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:09,886 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 58 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:09,886 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:09,886 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:10,046 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-13 12:05:10,247 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-13 12:05:10,347 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-13 12:05:10,364 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 7 DN Heartbeats.
2019-06-13 12:05:10,548 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-13 12:05:10,549 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:05:10,549 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:05:10,549 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis f348b87a-528e-40e1-af0e-47d468ee337a at port 36749
2019-06-13 12:05:10,558 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - f348b87a-528e-40e1-af0e-47d468ee337a: start RPC server
2019-06-13 12:05:10,558 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - f348b87a-528e-40e1-af0e-47d468ee337a: GrpcService started, listening on 0.0.0.0/0.0.0.0:36749
2019-06-13 12:05:10,648 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-13 12:05:10,648 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-13 12:05:10,648 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-13 12:05:10,684 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:05:10,684 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:05:10,685 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis a2f33826-4d19-41fa-b015-7309f7215935 at port 34659
2019-06-13 12:05:10,687 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - a2f33826-4d19-41fa-b015-7309f7215935: start RPC server
2019-06-13 12:05:10,688 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - a2f33826-4d19-41fa-b015-7309f7215935: GrpcService started, listening on 0.0.0.0/0.0.0.0:34659
2019-06-13 12:05:10,822 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:05:10,822 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:05:10,822 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis fb0a39bd-7985-46b0-9937-fc701c95099c at port 38359
2019-06-13 12:05:10,825 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - fb0a39bd-7985-46b0-9937-fc701c95099c: start RPC server
2019-06-13 12:05:10,825 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - fb0a39bd-7985-46b0-9937-fc701c95099c: GrpcService started, listening on 0.0.0.0/0.0.0.0:38359
2019-06-13 12:05:10,944 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1058, electionTimeout:1058ms
2019-06-13 12:05:10,944 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:10,945 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 58 for changeToCandidate
2019-06-13 12:05:10,945 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:10,947 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection120: begin an election at term 59 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:10,948 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection120 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:10,948 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection120 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:10,948 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection120: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t59, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:10,948 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:10,948 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:10,949 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 59 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:10,949 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:10,949 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:10,950 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:05:10,950 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:05:10,950 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 6dce76ac-1a96-470d-902e-e4604ad0c946 at port 46669
2019-06-13 12:05:10,953 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: start RPC server
2019-06-13 12:05:10,953 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: GrpcService started, listening on 0.0.0.0/0.0.0.0:46669
2019-06-13 12:05:11,111 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:05:11,111 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:05:11,111 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34 at port 42309
2019-06-13 12:05:11,114 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: start RPC server
2019-06-13 12:05:11,115 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: GrpcService started, listening on 0.0.0.0/0.0.0.0:42309
2019-06-13 12:05:11,238 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:05:11,238 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:05:11,238 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis c1978e83-ba4c-4ece-a10d-e6b51f00e572 at port 43553
2019-06-13 12:05:11,242 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: start RPC server
2019-06-13 12:05:11,242 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: GrpcService started, listening on 0.0.0.0/0.0.0.0:43553
2019-06-13 12:05:11,365 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 7 DN Heartbeats.
2019-06-13 12:05:11,365 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:05:11,366 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:05:11,366 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 8c2f491c-bec6-4ecd-8b98-9ad532234c41 at port 32879
2019-06-13 12:05:11,375 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41: start RPC server
2019-06-13 12:05:11,376 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41: GrpcService started, listening on 0.0.0.0/0.0.0.0:32879
2019-06-13 12:05:11,995 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1046, electionTimeout:1046ms
2019-06-13 12:05:11,996 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:11,996 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 59 for changeToCandidate
2019-06-13 12:05:11,996 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:11,998 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection121: begin an election at term 60 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:11,999 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection121 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:11,999 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection121 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:11,999 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection121: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t60, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:11,999 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:11,999 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:11,999 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 60 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:11,999 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:12,000 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:12,365 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 7 DN Heartbeats.
2019-06-13 12:05:12,542 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : f348b87a-528e-40e1-af0e-47d468ee337a{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:05:12,546 INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 1 DataNodes registered, 1 required.
2019-06-13 12:05:12,549 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(177)) - ScmSafeModeManager, all rules are successfully validated
2019-06-13 12:05:12,549 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:exitSafeMode(193)) - SCM exiting safe mode.
Jun 13, 2019 12:05:12 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=891, target=192.168.46.58:45211} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupRemove(RaftClientImpl.java:280)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineUtils.destroyPipeline(RatisPipelineUtils.java:97)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineUtils.destroyPipeline(RatisPipelineUtils.java:64)
	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:378)
	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.finalizeAndDestroyPipeline(SCMPipelineManager.java:318)
	at org.apache.hadoop.ozone.container.ContainerTestHelper.waitForPipelineClose(ContainerTestHelper.java:799)
	at org.apache.hadoop.ozone.client.rpc.TestWatchForCommit.testWatchForCommitForGroupMismatchException(TestWatchForCommit.java:478)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 13, 2019 12:05:12 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=886, target=192.168.46.58:42079} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupRemove(RaftClientImpl.java:280)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineUtils.destroyPipeline(RatisPipelineUtils.java:97)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineUtils.destroyPipeline(RatisPipelineUtils.java:64)
	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:378)
	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.finalizeAndDestroyPipeline(SCMPipelineManager.java:318)
	at org.apache.hadoop.ozone.container.ContainerTestHelper.waitForPipelineClose(ContainerTestHelper.java:799)
	at org.apache.hadoop.ozone.client.rpc.TestWatchForCommit.testWatchForCommitForGroupMismatchException(TestWatchForCommit.java:478)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 13, 2019 12:05:12 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=881, target=192.168.46.58:44547} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupRemove(RaftClientImpl.java:280)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineUtils.destroyPipeline(RatisPipelineUtils.java:97)
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineUtils.destroyPipeline(RatisPipelineUtils.java:64)
	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.destroyPipeline(SCMPipelineManager.java:378)
	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.finalizeAndDestroyPipeline(SCMPipelineManager.java:318)
	at org.apache.hadoop.ozone.container.ContainerTestHelper.waitForPipelineClose(ContainerTestHelper.java:799)
	at org.apache.hadoop.ozone.client.rpc.TestWatchForCommit.testWatchForCommitForGroupMismatchException(TestWatchForCommit.java:478)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-13 12:05:12,567 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - f348b87a-528e-40e1-af0e-47d468ee337a: addNew group-55CE701C89EF:[f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749] returns group-55CE701C89EF:java.util.concurrent.CompletableFuture@2bb41a5b[Not completed]
2019-06-13 12:05:12,567 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - f348b87a-528e-40e1-af0e-47d468ee337a: new RaftServerImpl for group-55CE701C89EF:[f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749] with ContainerStateMachine:uninitialized
2019-06-13 12:05:12,568 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:12,568 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:12,568 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:12,568 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:12,568 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - f348b87a-528e-40e1-af0e-47d468ee337a:group-55CE701C89EF ConfigurationManager, init=-1: [f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:12,568 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-0/data/ratis] (custom)
2019-06-13 12:05:12,568 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-0/data/ratis/892c1fce-3f41-4872-8667-55ce701c89ef does not exist. Creating ...
2019-06-13 12:05:12,571 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-0/data/ratis/892c1fce-3f41-4872-8667-55ce701c89ef/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:12,573 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-0/data/ratis/892c1fce-3f41-4872-8667-55ce701c89ef has been successfully formatted.
2019-06-13 12:05:12,573 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:12,573 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:12,573 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:12,573 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:12,573 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:12,573 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:12,573 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new f348b87a-528e-40e1-af0e-47d468ee337a-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-0/data/ratis/892c1fce-3f41-4872-8667-55ce701c89ef
2019-06-13 12:05:12,573 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:12,573 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:12,573 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:12,573 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:12,573 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:12,573 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:12,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:12,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:12,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:12,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:12,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:12,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:12,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:12,574 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - f348b87a-528e-40e1-af0e-47d468ee337a: start group-55CE701C89EF
2019-06-13 12:05:12,574 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f348b87a-528e-40e1-af0e-47d468ee337a:group-55CE701C89EF changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:12,574 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f348b87a-528e-40e1-af0e-47d468ee337a: start FollowerState
2019-06-13 12:05:12,575 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-55CE701C89EF,id=f348b87a-528e-40e1-af0e-47d468ee337a
2019-06-13 12:05:12,576 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 892c1fce-3f41-4872-8667-55ce701c89ef, Nodes: f348b87a-528e-40e1-af0e-47d468ee337a{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:05:12,681 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : a2f33826-4d19-41fa-b015-7309f7215935{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:05:12,686 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - a2f33826-4d19-41fa-b015-7309f7215935: addNew group-140A59CDD123:[a2f33826-4d19-41fa-b015-7309f7215935:192.168.46.58:34659] returns group-140A59CDD123:java.util.concurrent.CompletableFuture@52305389[Not completed]
2019-06-13 12:05:12,686 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - a2f33826-4d19-41fa-b015-7309f7215935: new RaftServerImpl for group-140A59CDD123:[a2f33826-4d19-41fa-b015-7309f7215935:192.168.46.58:34659] with ContainerStateMachine:uninitialized
2019-06-13 12:05:12,686 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:12,686 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:12,686 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:12,687 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:12,687 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - a2f33826-4d19-41fa-b015-7309f7215935:group-140A59CDD123 ConfigurationManager, init=-1: [a2f33826-4d19-41fa-b015-7309f7215935:192.168.46.58:34659], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:12,687 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-1/data/ratis] (custom)
2019-06-13 12:05:12,687 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-1/data/ratis/6acba34f-5de7-48b8-b914-140a59cdd123 does not exist. Creating ...
2019-06-13 12:05:12,690 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-1/data/ratis/6acba34f-5de7-48b8-b914-140a59cdd123/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:12,692 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-1/data/ratis/6acba34f-5de7-48b8-b914-140a59cdd123 has been successfully formatted.
2019-06-13 12:05:12,692 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:12,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:12,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:12,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:12,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:12,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:12,692 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new a2f33826-4d19-41fa-b015-7309f7215935-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-1/data/ratis/6acba34f-5de7-48b8-b914-140a59cdd123
2019-06-13 12:05:12,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:12,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:12,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:12,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:12,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:12,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:12,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:12,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:12,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:12,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:12,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:12,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:12,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:12,693 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - a2f33826-4d19-41fa-b015-7309f7215935: start group-140A59CDD123
2019-06-13 12:05:12,693 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a2f33826-4d19-41fa-b015-7309f7215935:group-140A59CDD123 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:12,693 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a2f33826-4d19-41fa-b015-7309f7215935: start FollowerState
2019-06-13 12:05:12,694 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-140A59CDD123,id=a2f33826-4d19-41fa-b015-7309f7215935
2019-06-13 12:05:12,695 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 6acba34f-5de7-48b8-b914-140a59cdd123, Nodes: a2f33826-4d19-41fa-b015-7309f7215935{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:05:12,820 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : fb0a39bd-7985-46b0-9937-fc701c95099c{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:05:12,828 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - fb0a39bd-7985-46b0-9937-fc701c95099c: addNew group-A99D0EFDACE8:[fb0a39bd-7985-46b0-9937-fc701c95099c:192.168.46.58:38359] returns group-A99D0EFDACE8:java.util.concurrent.CompletableFuture@4b715f53[Not completed]
2019-06-13 12:05:12,829 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - fb0a39bd-7985-46b0-9937-fc701c95099c: new RaftServerImpl for group-A99D0EFDACE8:[fb0a39bd-7985-46b0-9937-fc701c95099c:192.168.46.58:38359] with ContainerStateMachine:uninitialized
2019-06-13 12:05:12,829 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:12,829 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:12,829 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:12,829 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:12,829 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - fb0a39bd-7985-46b0-9937-fc701c95099c:group-A99D0EFDACE8 ConfigurationManager, init=-1: [fb0a39bd-7985-46b0-9937-fc701c95099c:192.168.46.58:38359], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:12,829 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-2/data/ratis] (custom)
2019-06-13 12:05:12,830 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-2/data/ratis/c5c3e088-04de-4c78-80c1-a99d0efdace8 does not exist. Creating ...
2019-06-13 12:05:12,832 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-2/data/ratis/c5c3e088-04de-4c78-80c1-a99d0efdace8/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:12,834 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-2/data/ratis/c5c3e088-04de-4c78-80c1-a99d0efdace8 has been successfully formatted.
2019-06-13 12:05:12,834 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:12,834 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:12,834 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:12,834 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:12,834 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:12,834 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:12,834 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new fb0a39bd-7985-46b0-9937-fc701c95099c-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-2/data/ratis/c5c3e088-04de-4c78-80c1-a99d0efdace8
2019-06-13 12:05:12,834 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:12,834 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:12,834 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:12,835 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:12,835 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:12,835 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:12,835 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:12,835 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:12,835 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:12,835 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:12,835 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:12,835 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:12,835 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:12,835 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - fb0a39bd-7985-46b0-9937-fc701c95099c: start group-A99D0EFDACE8
2019-06-13 12:05:12,836 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fb0a39bd-7985-46b0-9937-fc701c95099c:group-A99D0EFDACE8 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:12,836 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fb0a39bd-7985-46b0-9937-fc701c95099c: start FollowerState
2019-06-13 12:05:12,836 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-A99D0EFDACE8,id=fb0a39bd-7985-46b0-9937-fc701c95099c
2019-06-13 12:05:12,837 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: c5c3e088-04de-4c78-80c1-a99d0efdace8, Nodes: fb0a39bd-7985-46b0-9937-fc701c95099c{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:05:12,850 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - fb0a39bd-7985-46b0-9937-fc701c95099c: addNew group-42896EF8769D:[fb0a39bd-7985-46b0-9937-fc701c95099c:192.168.46.58:38359, f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749, a2f33826-4d19-41fa-b015-7309f7215935:192.168.46.58:34659] returns group-42896EF8769D:java.util.concurrent.CompletableFuture@52a3f9d9[Not completed]
2019-06-13 12:05:12,850 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - a2f33826-4d19-41fa-b015-7309f7215935: addNew group-42896EF8769D:[fb0a39bd-7985-46b0-9937-fc701c95099c:192.168.46.58:38359, f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749, a2f33826-4d19-41fa-b015-7309f7215935:192.168.46.58:34659] returns group-42896EF8769D:java.util.concurrent.CompletableFuture@743f891c[Not completed]
2019-06-13 12:05:12,851 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - fb0a39bd-7985-46b0-9937-fc701c95099c: new RaftServerImpl for group-42896EF8769D:[fb0a39bd-7985-46b0-9937-fc701c95099c:192.168.46.58:38359, f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749, a2f33826-4d19-41fa-b015-7309f7215935:192.168.46.58:34659] with ContainerStateMachine:uninitialized
2019-06-13 12:05:12,851 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:12,851 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - a2f33826-4d19-41fa-b015-7309f7215935: new RaftServerImpl for group-42896EF8769D:[fb0a39bd-7985-46b0-9937-fc701c95099c:192.168.46.58:38359, f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749, a2f33826-4d19-41fa-b015-7309f7215935:192.168.46.58:34659] with ContainerStateMachine:uninitialized
2019-06-13 12:05:12,851 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:12,851 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:12,851 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:12,851 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:12,851 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - a2f33826-4d19-41fa-b015-7309f7215935:group-42896EF8769D ConfigurationManager, init=-1: [fb0a39bd-7985-46b0-9937-fc701c95099c:192.168.46.58:38359, f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749, a2f33826-4d19-41fa-b015-7309f7215935:192.168.46.58:34659], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:12,852 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-1/data/ratis] (custom)
2019-06-13 12:05:12,852 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-1/data/ratis/3b02ab92-9cb2-4ebc-8230-42896ef8769d does not exist. Creating ...
2019-06-13 12:05:12,852 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - f348b87a-528e-40e1-af0e-47d468ee337a: addNew group-42896EF8769D:[fb0a39bd-7985-46b0-9937-fc701c95099c:192.168.46.58:38359, f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749, a2f33826-4d19-41fa-b015-7309f7215935:192.168.46.58:34659] returns group-42896EF8769D:java.util.concurrent.CompletableFuture@75e0d72[Not completed]
2019-06-13 12:05:12,852 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - f348b87a-528e-40e1-af0e-47d468ee337a: new RaftServerImpl for group-42896EF8769D:[fb0a39bd-7985-46b0-9937-fc701c95099c:192.168.46.58:38359, f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749, a2f33826-4d19-41fa-b015-7309f7215935:192.168.46.58:34659] with ContainerStateMachine:uninitialized
2019-06-13 12:05:12,853 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:12,853 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:12,853 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:12,853 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:12,853 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - f348b87a-528e-40e1-af0e-47d468ee337a:group-42896EF8769D ConfigurationManager, init=-1: [fb0a39bd-7985-46b0-9937-fc701c95099c:192.168.46.58:38359, f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749, a2f33826-4d19-41fa-b015-7309f7215935:192.168.46.58:34659], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:12,853 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-0/data/ratis] (custom)
2019-06-13 12:05:12,853 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-0/data/ratis/3b02ab92-9cb2-4ebc-8230-42896ef8769d does not exist. Creating ...
2019-06-13 12:05:12,851 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:12,853 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:12,854 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:12,854 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - fb0a39bd-7985-46b0-9937-fc701c95099c:group-42896EF8769D ConfigurationManager, init=-1: [fb0a39bd-7985-46b0-9937-fc701c95099c:192.168.46.58:38359, f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749, a2f33826-4d19-41fa-b015-7309f7215935:192.168.46.58:34659], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:12,854 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-2/data/ratis] (custom)
2019-06-13 12:05:12,854 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-2/data/ratis/3b02ab92-9cb2-4ebc-8230-42896ef8769d does not exist. Creating ...
2019-06-13 12:05:12,855 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-1/data/ratis/3b02ab92-9cb2-4ebc-8230-42896ef8769d/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:12,855 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-0/data/ratis/3b02ab92-9cb2-4ebc-8230-42896ef8769d/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:12,856 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-2/data/ratis/3b02ab92-9cb2-4ebc-8230-42896ef8769d/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:12,858 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-0/data/ratis/3b02ab92-9cb2-4ebc-8230-42896ef8769d has been successfully formatted.
2019-06-13 12:05:12,858 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-1/data/ratis/3b02ab92-9cb2-4ebc-8230-42896ef8769d has been successfully formatted.
2019-06-13 12:05:12,858 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:12,858 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:12,858 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:12,858 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:12,858 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:12,858 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:12,858 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new f348b87a-528e-40e1-af0e-47d468ee337a-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-0/data/ratis/3b02ab92-9cb2-4ebc-8230-42896ef8769d
2019-06-13 12:05:12,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:12,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:12,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:12,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:12,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:12,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:12,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:12,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:12,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:12,859 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:12,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:12,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:12,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:12,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:12,860 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-2/data/ratis/3b02ab92-9cb2-4ebc-8230-42896ef8769d has been successfully formatted.
2019-06-13 12:05:12,860 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:12,860 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:12,860 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:12,860 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:12,860 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:12,860 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:12,860 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - f348b87a-528e-40e1-af0e-47d468ee337a: start group-42896EF8769D
2019-06-13 12:05:12,860 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:12,860 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f348b87a-528e-40e1-af0e-47d468ee337a:group-42896EF8769D changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:12,860 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new a2f33826-4d19-41fa-b015-7309f7215935-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-1/data/ratis/3b02ab92-9cb2-4ebc-8230-42896ef8769d
2019-06-13 12:05:12,860 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f348b87a-528e-40e1-af0e-47d468ee337a: start FollowerState
2019-06-13 12:05:12,860 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:12,861 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:12,869 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-42896EF8769D,id=f348b87a-528e-40e1-af0e-47d468ee337a
2019-06-13 12:05:12,860 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:12,869 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:12,869 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:12,877 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:12,877 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new fb0a39bd-7985-46b0-9937-fc701c95099c-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-2/data/ratis/3b02ab92-9cb2-4ebc-8230-42896ef8769d
2019-06-13 12:05:12,877 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:12,878 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:12,878 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:12,878 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:12,878 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:12,878 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:12,878 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:12,878 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:12,878 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:12,878 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:12,877 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:12,878 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:12,879 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:12,879 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:12,879 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:12,879 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:12,879 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:12,880 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:12,880 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:12,880 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:12,881 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:12,881 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:12,881 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:12,881 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - a2f33826-4d19-41fa-b015-7309f7215935: start group-42896EF8769D
2019-06-13 12:05:12,881 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a2f33826-4d19-41fa-b015-7309f7215935:group-42896EF8769D changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:12,881 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a2f33826-4d19-41fa-b015-7309f7215935: start FollowerState
2019-06-13 12:05:12,881 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:12,881 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - fb0a39bd-7985-46b0-9937-fc701c95099c: start group-42896EF8769D
2019-06-13 12:05:12,881 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-42896EF8769D,id=a2f33826-4d19-41fa-b015-7309f7215935
2019-06-13 12:05:12,881 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fb0a39bd-7985-46b0-9937-fc701c95099c:group-42896EF8769D changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:12,881 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fb0a39bd-7985-46b0-9937-fc701c95099c: start FollowerState
2019-06-13 12:05:12,882 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-42896EF8769D,id=fb0a39bd-7985-46b0-9937-fc701c95099c
2019-06-13 12:05:12,884 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 3b02ab92-9cb2-4ebc-8230-42896ef8769d, Nodes: f348b87a-528e-40e1-af0e-47d468ee337a{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}fb0a39bd-7985-46b0-9937-fc701c95099c{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}a2f33826-4d19-41fa-b015-7309f7215935{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-13 12:05:12,949 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 6dce76ac-1a96-470d-902e-e4604ad0c946{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:05:12,954 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: addNew group-CCE69423C015:[6dce76ac-1a96-470d-902e-e4604ad0c946:192.168.46.58:46669] returns group-CCE69423C015:java.util.concurrent.CompletableFuture@328c0696[Not completed]
2019-06-13 12:05:12,954 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: new RaftServerImpl for group-CCE69423C015:[6dce76ac-1a96-470d-902e-e4604ad0c946:192.168.46.58:46669] with ContainerStateMachine:uninitialized
2019-06-13 12:05:12,954 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:12,954 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:12,954 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:12,954 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:12,954 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 6dce76ac-1a96-470d-902e-e4604ad0c946:group-CCE69423C015 ConfigurationManager, init=-1: [6dce76ac-1a96-470d-902e-e4604ad0c946:192.168.46.58:46669], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:12,955 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-3/data/ratis] (custom)
2019-06-13 12:05:12,955 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-3/data/ratis/fe3d60e5-afbc-489f-969a-cce69423c015 does not exist. Creating ...
2019-06-13 12:05:12,957 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-3/data/ratis/fe3d60e5-afbc-489f-969a-cce69423c015/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:12,959 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-3/data/ratis/fe3d60e5-afbc-489f-969a-cce69423c015 has been successfully formatted.
2019-06-13 12:05:12,959 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:12,959 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:12,959 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:12,959 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:12,959 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:12,959 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:12,959 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 6dce76ac-1a96-470d-902e-e4604ad0c946-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-3/data/ratis/fe3d60e5-afbc-489f-969a-cce69423c015
2019-06-13 12:05:12,959 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:12,960 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:12,960 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:12,960 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:12,960 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:12,960 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:12,960 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:12,960 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:12,960 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:12,960 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:12,960 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:12,960 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:12,960 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:12,960 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: start group-CCE69423C015
2019-06-13 12:05:12,960 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6dce76ac-1a96-470d-902e-e4604ad0c946:group-CCE69423C015 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:12,961 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: start FollowerState
2019-06-13 12:05:12,961 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-CCE69423C015,id=6dce76ac-1a96-470d-902e-e4604ad0c946
2019-06-13 12:05:12,962 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: fe3d60e5-afbc-489f-969a-cce69423c015, Nodes: 6dce76ac-1a96-470d-902e-e4604ad0c946{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:05:13,007 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1007, electionTimeout:1007ms
2019-06-13 12:05:13,007 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:13,007 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 60 for changeToCandidate
2019-06-13 12:05:13,007 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:13,009 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection122: begin an election at term 61 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:13,010 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection122 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:13,010 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection122 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:13,010 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection122: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t61, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:13,010 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:13,011 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:13,011 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 61 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:13,011 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:13,011 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:13,110 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:05:13,117 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: addNew group-6C7464E27C52:[4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:192.168.46.58:42309] returns group-6C7464E27C52:java.util.concurrent.CompletableFuture@64284a06[Not completed]
2019-06-13 12:05:13,117 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: new RaftServerImpl for group-6C7464E27C52:[4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:192.168.46.58:42309] with ContainerStateMachine:uninitialized
2019-06-13 12:05:13,117 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:13,117 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:13,118 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:13,118 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:13,118 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:group-6C7464E27C52 ConfigurationManager, init=-1: [4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:192.168.46.58:42309], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:13,118 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-4/data/ratis] (custom)
2019-06-13 12:05:13,118 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-4/data/ratis/e0cab5c3-08e3-407e-84a8-6c7464e27c52 does not exist. Creating ...
2019-06-13 12:05:13,120 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-4/data/ratis/e0cab5c3-08e3-407e-84a8-6c7464e27c52/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:13,122 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-4/data/ratis/e0cab5c3-08e3-407e-84a8-6c7464e27c52 has been successfully formatted.
2019-06-13 12:05:13,123 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:13,123 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:13,123 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:13,123 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:13,123 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:13,123 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:13,123 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-4/data/ratis/e0cab5c3-08e3-407e-84a8-6c7464e27c52
2019-06-13 12:05:13,123 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:13,123 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:13,123 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:13,123 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:13,123 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:13,123 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:13,123 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:13,124 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:13,124 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:13,124 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:13,124 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:13,124 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:13,124 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:13,124 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: start group-6C7464E27C52
2019-06-13 12:05:13,124 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:group-6C7464E27C52 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:13,124 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: start FollowerState
2019-06-13 12:05:13,125 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-6C7464E27C52,id=4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34
2019-06-13 12:05:13,126 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: e0cab5c3-08e3-407e-84a8-6c7464e27c52, Nodes: 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:05:13,236 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : c1978e83-ba4c-4ece-a10d-e6b51f00e572{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:05:13,243 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: addNew group-C7840250724D:[c1978e83-ba4c-4ece-a10d-e6b51f00e572:192.168.46.58:43553] returns group-C7840250724D:java.util.concurrent.CompletableFuture@51deb52a[Not completed]
2019-06-13 12:05:13,244 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: new RaftServerImpl for group-C7840250724D:[c1978e83-ba4c-4ece-a10d-e6b51f00e572:192.168.46.58:43553] with ContainerStateMachine:uninitialized
2019-06-13 12:05:13,244 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:13,244 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:13,244 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:13,244 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:13,244 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572:group-C7840250724D ConfigurationManager, init=-1: [c1978e83-ba4c-4ece-a10d-e6b51f00e572:192.168.46.58:43553], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:13,244 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-5/data/ratis] (custom)
2019-06-13 12:05:13,244 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-5/data/ratis/a623e775-1d3e-451c-befa-c7840250724d does not exist. Creating ...
2019-06-13 12:05:13,247 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-5/data/ratis/a623e775-1d3e-451c-befa-c7840250724d/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:13,249 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-5/data/ratis/a623e775-1d3e-451c-befa-c7840250724d has been successfully formatted.
2019-06-13 12:05:13,249 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:13,249 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:13,249 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:13,249 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:13,249 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:13,249 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:13,249 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new c1978e83-ba4c-4ece-a10d-e6b51f00e572-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-5/data/ratis/a623e775-1d3e-451c-befa-c7840250724d
2019-06-13 12:05:13,249 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:13,249 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:13,249 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:13,250 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:13,250 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:13,250 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:13,250 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:13,250 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:13,250 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:13,250 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:13,251 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:13,251 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:13,251 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:13,251 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: start group-C7840250724D
2019-06-13 12:05:13,251 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572:group-C7840250724D changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:13,251 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: start FollowerState
2019-06-13 12:05:13,252 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C7840250724D,id=c1978e83-ba4c-4ece-a10d-e6b51f00e572
2019-06-13 12:05:13,253 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: a623e775-1d3e-451c-befa-c7840250724d, Nodes: c1978e83-ba4c-4ece-a10d-e6b51f00e572{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:05:13,262 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: addNew group-49786FBEBE2E:[6dce76ac-1a96-470d-902e-e4604ad0c946:192.168.46.58:46669, c1978e83-ba4c-4ece-a10d-e6b51f00e572:192.168.46.58:43553, 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:192.168.46.58:42309] returns group-49786FBEBE2E:java.util.concurrent.CompletableFuture@3878bfd0[Not completed]
2019-06-13 12:05:13,263 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: addNew group-49786FBEBE2E:[6dce76ac-1a96-470d-902e-e4604ad0c946:192.168.46.58:46669, c1978e83-ba4c-4ece-a10d-e6b51f00e572:192.168.46.58:43553, 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:192.168.46.58:42309] returns group-49786FBEBE2E:java.util.concurrent.CompletableFuture@3c50b390[Not completed]
2019-06-13 12:05:13,263 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: addNew group-49786FBEBE2E:[6dce76ac-1a96-470d-902e-e4604ad0c946:192.168.46.58:46669, c1978e83-ba4c-4ece-a10d-e6b51f00e572:192.168.46.58:43553, 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:192.168.46.58:42309] returns group-49786FBEBE2E:java.util.concurrent.CompletableFuture@1b0de1af[Not completed]
2019-06-13 12:05:13,263 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: new RaftServerImpl for group-49786FBEBE2E:[6dce76ac-1a96-470d-902e-e4604ad0c946:192.168.46.58:46669, c1978e83-ba4c-4ece-a10d-e6b51f00e572:192.168.46.58:43553, 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:192.168.46.58:42309] with ContainerStateMachine:uninitialized
2019-06-13 12:05:13,263 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:13,263 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:13,263 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: new RaftServerImpl for group-49786FBEBE2E:[6dce76ac-1a96-470d-902e-e4604ad0c946:192.168.46.58:46669, c1978e83-ba4c-4ece-a10d-e6b51f00e572:192.168.46.58:43553, 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:192.168.46.58:42309] with ContainerStateMachine:uninitialized
2019-06-13 12:05:13,263 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:13,263 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:13,263 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:13,263 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:13,263 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:group-49786FBEBE2E ConfigurationManager, init=-1: [6dce76ac-1a96-470d-902e-e4604ad0c946:192.168.46.58:46669, c1978e83-ba4c-4ece-a10d-e6b51f00e572:192.168.46.58:43553, 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:192.168.46.58:42309], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:13,263 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:13,264 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-4/data/ratis] (custom)
2019-06-13 12:05:13,264 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:13,264 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 6dce76ac-1a96-470d-902e-e4604ad0c946:group-49786FBEBE2E ConfigurationManager, init=-1: [6dce76ac-1a96-470d-902e-e4604ad0c946:192.168.46.58:46669, c1978e83-ba4c-4ece-a10d-e6b51f00e572:192.168.46.58:43553, 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:192.168.46.58:42309], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:13,264 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-3/data/ratis] (custom)
2019-06-13 12:05:13,264 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-3/data/ratis/4f7f025f-6433-48f5-bf69-49786fbebe2e does not exist. Creating ...
2019-06-13 12:05:13,264 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-4/data/ratis/4f7f025f-6433-48f5-bf69-49786fbebe2e does not exist. Creating ...
2019-06-13 12:05:13,264 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: new RaftServerImpl for group-49786FBEBE2E:[6dce76ac-1a96-470d-902e-e4604ad0c946:192.168.46.58:46669, c1978e83-ba4c-4ece-a10d-e6b51f00e572:192.168.46.58:43553, 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:192.168.46.58:42309] with ContainerStateMachine:uninitialized
2019-06-13 12:05:13,265 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:13,265 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:13,265 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:13,265 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:13,265 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572:group-49786FBEBE2E ConfigurationManager, init=-1: [6dce76ac-1a96-470d-902e-e4604ad0c946:192.168.46.58:46669, c1978e83-ba4c-4ece-a10d-e6b51f00e572:192.168.46.58:43553, 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:192.168.46.58:42309], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:13,265 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-5/data/ratis] (custom)
2019-06-13 12:05:13,266 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-5/data/ratis/4f7f025f-6433-48f5-bf69-49786fbebe2e does not exist. Creating ...
2019-06-13 12:05:13,266 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-4/data/ratis/4f7f025f-6433-48f5-bf69-49786fbebe2e/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:13,266 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-3/data/ratis/4f7f025f-6433-48f5-bf69-49786fbebe2e/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:13,267 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-5/data/ratis/4f7f025f-6433-48f5-bf69-49786fbebe2e/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:13,269 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-3/data/ratis/4f7f025f-6433-48f5-bf69-49786fbebe2e has been successfully formatted.
2019-06-13 12:05:13,269 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-4/data/ratis/4f7f025f-6433-48f5-bf69-49786fbebe2e has been successfully formatted.
2019-06-13 12:05:13,269 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:13,269 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:13,269 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:13,269 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:13,269 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:13,269 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:13,269 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:13,269 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:13,270 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:13,270 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:13,270 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:13,270 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:13,270 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 6dce76ac-1a96-470d-902e-e4604ad0c946-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-3/data/ratis/4f7f025f-6433-48f5-bf69-49786fbebe2e
2019-06-13 12:05:13,270 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-4/data/ratis/4f7f025f-6433-48f5-bf69-49786fbebe2e
2019-06-13 12:05:13,270 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:13,270 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:13,270 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:13,270 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-5/data/ratis/4f7f025f-6433-48f5-bf69-49786fbebe2e has been successfully formatted.
2019-06-13 12:05:13,270 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:13,270 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:13,270 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:13,270 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:13,270 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:13,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:13,270 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:13,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:13,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:13,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:13,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:13,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:13,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:13,271 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new c1978e83-ba4c-4ece-a10d-e6b51f00e572-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-5/data/ratis/4f7f025f-6433-48f5-bf69-49786fbebe2e
2019-06-13 12:05:13,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:13,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:13,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:13,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:13,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:13,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:13,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:13,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:13,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:13,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:13,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:13,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:13,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:13,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:13,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:13,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:13,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:13,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:13,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:13,273 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:13,273 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:13,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:13,273 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:13,273 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:13,273 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:13,273 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:13,273 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: start group-49786FBEBE2E
2019-06-13 12:05:13,273 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:13,273 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:13,273 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: start group-49786FBEBE2E
2019-06-13 12:05:13,273 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6dce76ac-1a96-470d-902e-e4604ad0c946:group-49786FBEBE2E changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:13,273 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572:group-49786FBEBE2E changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:13,273 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:13,274 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: start FollowerState
2019-06-13 12:05:13,273 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: start FollowerState
2019-06-13 12:05:13,274 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: start group-49786FBEBE2E
2019-06-13 12:05:13,274 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:group-49786FBEBE2E changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:13,274 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-49786FBEBE2E,id=c1978e83-ba4c-4ece-a10d-e6b51f00e572
2019-06-13 12:05:13,274 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: start FollowerState
2019-06-13 12:05:13,274 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-49786FBEBE2E,id=6dce76ac-1a96-470d-902e-e4604ad0c946
2019-06-13 12:05:13,276 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-49786FBEBE2E,id=4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34
2019-06-13 12:05:13,283 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 4f7f025f-6433-48f5-bf69-49786fbebe2e, Nodes: 6dce76ac-1a96-470d-902e-e4604ad0c946{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}c1978e83-ba4c-4ece-a10d-e6b51f00e572{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-13 12:05:13,364 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 8c2f491c-bec6-4ecd-8b98-9ad532234c41{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:05:13,365 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Cluster is ready. Got 7 of 7 DN Heartbeats.
2019-06-13 12:05:13,370 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41: addNew group-B3342E96A79F:[8c2f491c-bec6-4ecd-8b98-9ad532234c41:192.168.46.58:32879] returns group-B3342E96A79F:java.util.concurrent.CompletableFuture@67fec6cb[Not completed]
2019-06-13 12:05:13,370 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41: new RaftServerImpl for group-B3342E96A79F:[8c2f491c-bec6-4ecd-8b98-9ad532234c41:192.168.46.58:32879] with ContainerStateMachine:uninitialized
2019-06-13 12:05:13,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:13,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:13,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:13,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:13,370 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41:group-B3342E96A79F ConfigurationManager, init=-1: [8c2f491c-bec6-4ecd-8b98-9ad532234c41:192.168.46.58:32879], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:13,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-6/data/ratis] (custom)
2019-06-13 12:05:13,371 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-6/data/ratis/2de855bb-8d7b-416a-81c4-b3342e96a79f does not exist. Creating ...
2019-06-13 12:05:13,384 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-6/data/ratis/2de855bb-8d7b-416a-81c4-b3342e96a79f/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:13,387 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-6/data/ratis/2de855bb-8d7b-416a-81c4-b3342e96a79f has been successfully formatted.
2019-06-13 12:05:13,388 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:13,388 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:13,390 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:13,392 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:13,392 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:13,392 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:13,392 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 8c2f491c-bec6-4ecd-8b98-9ad532234c41-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-6/data/ratis/2de855bb-8d7b-416a-81c4-b3342e96a79f
2019-06-13 12:05:13,393 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:13,395 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:13,397 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:13,397 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:13,397 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:13,397 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:13,397 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:13,397 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:13,399 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:13,401 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:13,402 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:13,402 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:13,402 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:13,402 INFO  rpc.RpcClient (RpcClient.java:createVolume(289)) - Creating Volume: watchforcommithandlingtest, with root as owner.
2019-06-13 12:05:13,402 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41: start group-B3342E96A79F
2019-06-13 12:05:13,402 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41:group-B3342E96A79F changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:13,403 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41: start FollowerState
2019-06-13 12:05:13,403 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-B3342E96A79F,id=8c2f491c-bec6-4ecd-8b98-9ad532234c41
2019-06-13 12:05:13,414 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 2de855bb-8d7b-416a-81c4-b3342e96a79f, Nodes: 8c2f491c-bec6-4ecd-8b98-9ad532234c41{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:05:13,415 INFO  rpc.RpcClient (RpcClient.java:createBucket(426)) - Creating Bucket: watchforcommithandlingtest/watchforcommithandlingtest, with Versioning false and Storage Type set to DISK and Encryption set to false 
2019-06-13 12:05:13,418 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:getStorageContainerLocationClient(241)) - Creating StorageContainerLocationProtocol RPC client with address /0.0.0.0:44851
2019-06-13 12:05:13,435 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F501F45E6D68->f348b87a-528e-40e1-af0e-47d468ee337a: receive RaftClientReply:client-F501F45E6D68->f348b87a-528e-40e1-af0e-47d468ee337a@group-42896EF8769D, cid=100, FAILED org.apache.ratis.protocol.NotLeaderException: Server f348b87a-528e-40e1-af0e-47d468ee337a is not the leader (a2f33826-4d19-41fa-b015-7309f7215935:192.168.46.58:34659). Request must be sent to leader., logIndex=0, commits[f348b87a-528e-40e1-af0e-47d468ee337a:c-1]
2019-06-13 12:05:13,438 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:05:13,710 INFO  impl.FollowerState (FollowerState.java:run(101)) - f348b87a-528e-40e1-af0e-47d468ee337a:group-55CE701C89EF changes to CANDIDATE, lastRpcTime:1135, electionTimeout:1135ms
2019-06-13 12:05:13,710 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - f348b87a-528e-40e1-af0e-47d468ee337a: shutdown FollowerState
2019-06-13 12:05:13,710 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f348b87a-528e-40e1-af0e-47d468ee337a:group-55CE701C89EF changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:13,710 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f348b87a-528e-40e1-af0e-47d468ee337a: start LeaderElection
2019-06-13 12:05:13,716 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - f348b87a-528e-40e1-af0e-47d468ee337a:group-55CE701C89EF:LeaderElection123: begin an election at term 1 for -1: [f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749], old=null
2019-06-13 12:05:13,716 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - f348b87a-528e-40e1-af0e-47d468ee337a: shutdown LeaderElection
2019-06-13 12:05:13,716 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f348b87a-528e-40e1-af0e-47d468ee337a:group-55CE701C89EF changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:13,716 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - f348b87a-528e-40e1-af0e-47d468ee337a:group-55CE701C89EF change Leader from null to f348b87a-528e-40e1-af0e-47d468ee337a at term 1 for becomeLeader, leader elected after 1143ms
2019-06-13 12:05:13,716 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:13,716 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:13,716 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:13,716 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:13,716 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f348b87a-528e-40e1-af0e-47d468ee337a: start LeaderState
2019-06-13 12:05:13,716 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - f348b87a-528e-40e1-af0e-47d468ee337a-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:13,717 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - f348b87a-528e-40e1-af0e-47d468ee337a:group-55CE701C89EF set configuration 0: [f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749], old=null at 0
2019-06-13 12:05:13,752 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - f348b87a-528e-40e1-af0e-47d468ee337a-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-0/data/ratis/892c1fce-3f41-4872-8667-55ce701c89ef/current/log_inprogress_0
2019-06-13 12:05:13,810 INFO  impl.FollowerState (FollowerState.java:run(101)) - a2f33826-4d19-41fa-b015-7309f7215935:group-140A59CDD123 changes to CANDIDATE, lastRpcTime:1116, electionTimeout:1116ms
2019-06-13 12:05:13,810 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a2f33826-4d19-41fa-b015-7309f7215935: shutdown FollowerState
2019-06-13 12:05:13,810 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a2f33826-4d19-41fa-b015-7309f7215935:group-140A59CDD123 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:13,810 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a2f33826-4d19-41fa-b015-7309f7215935: start LeaderElection
2019-06-13 12:05:13,816 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - a2f33826-4d19-41fa-b015-7309f7215935:group-140A59CDD123:LeaderElection124: begin an election at term 1 for -1: [a2f33826-4d19-41fa-b015-7309f7215935:192.168.46.58:34659], old=null
2019-06-13 12:05:13,816 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - a2f33826-4d19-41fa-b015-7309f7215935: shutdown LeaderElection
2019-06-13 12:05:13,816 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a2f33826-4d19-41fa-b015-7309f7215935:group-140A59CDD123 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:13,816 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - a2f33826-4d19-41fa-b015-7309f7215935:group-140A59CDD123 change Leader from null to a2f33826-4d19-41fa-b015-7309f7215935 at term 1 for becomeLeader, leader elected after 1124ms
2019-06-13 12:05:13,816 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:13,816 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:13,816 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:13,816 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:13,816 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a2f33826-4d19-41fa-b015-7309f7215935: start LeaderState
2019-06-13 12:05:13,816 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - a2f33826-4d19-41fa-b015-7309f7215935-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:13,817 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - a2f33826-4d19-41fa-b015-7309f7215935:group-140A59CDD123 set configuration 0: [a2f33826-4d19-41fa-b015-7309f7215935:192.168.46.58:34659], old=null at 0
2019-06-13 12:05:13,852 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - a2f33826-4d19-41fa-b015-7309f7215935-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-1/data/ratis/6acba34f-5de7-48b8-b914-140a59cdd123/current/log_inprogress_0
2019-06-13 12:05:13,886 INFO  impl.FollowerState (FollowerState.java:run(101)) - fb0a39bd-7985-46b0-9937-fc701c95099c:group-A99D0EFDACE8 changes to CANDIDATE, lastRpcTime:1050, electionTimeout:1050ms
2019-06-13 12:05:13,886 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - fb0a39bd-7985-46b0-9937-fc701c95099c: shutdown FollowerState
2019-06-13 12:05:13,886 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fb0a39bd-7985-46b0-9937-fc701c95099c:group-A99D0EFDACE8 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:13,886 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fb0a39bd-7985-46b0-9937-fc701c95099c: start LeaderElection
2019-06-13 12:05:13,892 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - fb0a39bd-7985-46b0-9937-fc701c95099c:group-A99D0EFDACE8:LeaderElection125: begin an election at term 1 for -1: [fb0a39bd-7985-46b0-9937-fc701c95099c:192.168.46.58:38359], old=null
2019-06-13 12:05:13,892 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - fb0a39bd-7985-46b0-9937-fc701c95099c: shutdown LeaderElection
2019-06-13 12:05:13,892 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fb0a39bd-7985-46b0-9937-fc701c95099c:group-A99D0EFDACE8 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:13,892 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - fb0a39bd-7985-46b0-9937-fc701c95099c:group-A99D0EFDACE8 change Leader from null to fb0a39bd-7985-46b0-9937-fc701c95099c at term 1 for becomeLeader, leader elected after 1057ms
2019-06-13 12:05:13,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:13,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:13,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:13,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:13,892 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fb0a39bd-7985-46b0-9937-fc701c95099c: start LeaderState
2019-06-13 12:05:13,892 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - fb0a39bd-7985-46b0-9937-fc701c95099c-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:13,893 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - fb0a39bd-7985-46b0-9937-fc701c95099c:group-A99D0EFDACE8 set configuration 0: [fb0a39bd-7985-46b0-9937-fc701c95099c:192.168.46.58:38359], old=null at 0
2019-06-13 12:05:13,912 INFO  impl.FollowerState (FollowerState.java:run(101)) - fb0a39bd-7985-46b0-9937-fc701c95099c:group-42896EF8769D changes to CANDIDATE, lastRpcTime:1030, electionTimeout:1030ms
2019-06-13 12:05:13,912 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - fb0a39bd-7985-46b0-9937-fc701c95099c: shutdown FollowerState
2019-06-13 12:05:13,912 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fb0a39bd-7985-46b0-9937-fc701c95099c:group-42896EF8769D changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:13,912 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fb0a39bd-7985-46b0-9937-fc701c95099c: start LeaderElection
2019-06-13 12:05:13,931 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - fb0a39bd-7985-46b0-9937-fc701c95099c-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-2/data/ratis/c5c3e088-04de-4c78-80c1-a99d0efdace8/current/log_inprogress_0
2019-06-13 12:05:13,931 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - fb0a39bd-7985-46b0-9937-fc701c95099c:group-42896EF8769D:LeaderElection126: begin an election at term 1 for -1: [fb0a39bd-7985-46b0-9937-fc701c95099c:192.168.46.58:38359, f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749, a2f33826-4d19-41fa-b015-7309f7215935:192.168.46.58:34659], old=null
2019-06-13 12:05:13,937 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f348b87a-528e-40e1-af0e-47d468ee337a:group-42896EF8769D changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:fb0a39bd-7985-46b0-9937-fc701c95099c
2019-06-13 12:05:13,937 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - f348b87a-528e-40e1-af0e-47d468ee337a: shutdown FollowerState
2019-06-13 12:05:13,937 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f348b87a-528e-40e1-af0e-47d468ee337a: start FollowerState
2019-06-13 12:05:13,937 INFO  impl.FollowerState (FollowerState.java:run(109)) - f348b87a-528e-40e1-af0e-47d468ee337a: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:13,941 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a2f33826-4d19-41fa-b015-7309f7215935:group-42896EF8769D changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:fb0a39bd-7985-46b0-9937-fc701c95099c
2019-06-13 12:05:13,941 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a2f33826-4d19-41fa-b015-7309f7215935: shutdown FollowerState
2019-06-13 12:05:13,941 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a2f33826-4d19-41fa-b015-7309f7215935: start FollowerState
2019-06-13 12:05:13,941 INFO  impl.FollowerState (FollowerState.java:run(109)) - a2f33826-4d19-41fa-b015-7309f7215935: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:13,943 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - fb0a39bd-7985-46b0-9937-fc701c95099c:group-42896EF8769D:LeaderElection126: Election PASSED; received 1 response(s) [fb0a39bd-7985-46b0-9937-fc701c95099c->a2f33826-4d19-41fa-b015-7309f7215935,true-t1] and 0 exception(s); fb0a39bd-7985-46b0-9937-fc701c95099c:t1, leader=null, voted=fb0a39bd-7985-46b0-9937-fc701c95099c, raftlog=fb0a39bd-7985-46b0-9937-fc701c95099c-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [fb0a39bd-7985-46b0-9937-fc701c95099c:192.168.46.58:38359, f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749, a2f33826-4d19-41fa-b015-7309f7215935:192.168.46.58:34659], old=null
2019-06-13 12:05:13,943 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - fb0a39bd-7985-46b0-9937-fc701c95099c: shutdown LeaderElection
2019-06-13 12:05:13,943 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fb0a39bd-7985-46b0-9937-fc701c95099c:group-42896EF8769D changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:13,943 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - fb0a39bd-7985-46b0-9937-fc701c95099c:group-42896EF8769D change Leader from null to fb0a39bd-7985-46b0-9937-fc701c95099c at term 1 for becomeLeader, leader elected after 1083ms
2019-06-13 12:05:13,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:13,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:13,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:13,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:13,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 12:05:13,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:13,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 12:05:13,944 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 12:05:13,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:13,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:13,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 12:05:13,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:13,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 12:05:13,944 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 12:05:13,945 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:13,945 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:13,945 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fb0a39bd-7985-46b0-9937-fc701c95099c: start LeaderState
2019-06-13 12:05:13,945 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - fb0a39bd-7985-46b0-9937-fc701c95099c-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:13,947 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - fb0a39bd-7985-46b0-9937-fc701c95099c:group-42896EF8769D set configuration 0: [fb0a39bd-7985-46b0-9937-fc701c95099c:192.168.46.58:38359, f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749, a2f33826-4d19-41fa-b015-7309f7215935:192.168.46.58:34659], old=null at 0
2019-06-13 12:05:13,947 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - f348b87a-528e-40e1-af0e-47d468ee337a:group-42896EF8769D change Leader from null to fb0a39bd-7985-46b0-9937-fc701c95099c at term 1 for appendEntries, leader elected after 1089ms
2019-06-13 12:05:13,950 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - a2f33826-4d19-41fa-b015-7309f7215935:group-42896EF8769D change Leader from null to fb0a39bd-7985-46b0-9937-fc701c95099c at term 1 for appendEntries, leader elected after 1090ms
2019-06-13 12:05:13,951 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - f348b87a-528e-40e1-af0e-47d468ee337a:group-42896EF8769D set configuration 0: [fb0a39bd-7985-46b0-9937-fc701c95099c:192.168.46.58:38359, f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749, a2f33826-4d19-41fa-b015-7309f7215935:192.168.46.58:34659], old=null at 0
2019-06-13 12:05:13,951 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - f348b87a-528e-40e1-af0e-47d468ee337a-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:13,953 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - a2f33826-4d19-41fa-b015-7309f7215935:group-42896EF8769D set configuration 0: [fb0a39bd-7985-46b0-9937-fc701c95099c:192.168.46.58:38359, f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749, a2f33826-4d19-41fa-b015-7309f7215935:192.168.46.58:34659], old=null at 0
2019-06-13 12:05:13,953 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - a2f33826-4d19-41fa-b015-7309f7215935-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:13,991 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - a2f33826-4d19-41fa-b015-7309f7215935-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-1/data/ratis/3b02ab92-9cb2-4ebc-8230-42896ef8769d/current/log_inprogress_0
2019-06-13 12:05:13,995 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - fb0a39bd-7985-46b0-9937-fc701c95099c-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-2/data/ratis/3b02ab92-9cb2-4ebc-8230-42896ef8769d/current/log_inprogress_0
2019-06-13 12:05:13,998 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - f348b87a-528e-40e1-af0e-47d468ee337a-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-0/data/ratis/3b02ab92-9cb2-4ebc-8230-42896ef8769d/current/log_inprogress_0
2019-06-13 12:05:14,012 INFO  impl.FollowerState (FollowerState.java:run(101)) - 6dce76ac-1a96-470d-902e-e4604ad0c946:group-CCE69423C015 changes to CANDIDATE, lastRpcTime:1051, electionTimeout:1051ms
2019-06-13 12:05:14,012 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: shutdown FollowerState
2019-06-13 12:05:14,012 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6dce76ac-1a96-470d-902e-e4604ad0c946:group-CCE69423C015 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:14,012 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: start LeaderElection
2019-06-13 12:05:14,022 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1011, electionTimeout:1011ms
2019-06-13 12:05:14,022 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:14,022 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 61 for changeToCandidate
2019-06-13 12:05:14,022 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:14,024 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 6dce76ac-1a96-470d-902e-e4604ad0c946:group-CCE69423C015:LeaderElection127: begin an election at term 1 for -1: [6dce76ac-1a96-470d-902e-e4604ad0c946:192.168.46.58:46669], old=null
2019-06-13 12:05:14,024 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection128: begin an election at term 62 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:14,024 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: shutdown LeaderElection
2019-06-13 12:05:14,024 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6dce76ac-1a96-470d-902e-e4604ad0c946:group-CCE69423C015 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:14,024 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 6dce76ac-1a96-470d-902e-e4604ad0c946:group-CCE69423C015 change Leader from null to 6dce76ac-1a96-470d-902e-e4604ad0c946 at term 1 for becomeLeader, leader elected after 1065ms
2019-06-13 12:05:14,024 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:14,024 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:14,025 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:14,025 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:14,025 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: start LeaderState
2019-06-13 12:05:14,025 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 6dce76ac-1a96-470d-902e-e4604ad0c946-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:14,025 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 6dce76ac-1a96-470d-902e-e4604ad0c946:group-CCE69423C015 set configuration 0: [6dce76ac-1a96-470d-902e-e4604ad0c946:192.168.46.58:46669], old=null at 0
2019-06-13 12:05:14,025 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection128 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:14,045 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection128 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:14,045 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection128: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t62, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:14,046 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:14,046 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:14,046 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 62 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:14,046 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:14,046 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:14,063 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 6dce76ac-1a96-470d-902e-e4604ad0c946-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-3/data/ratis/fe3d60e5-afbc-489f-969a-cce69423c015/current/log_inprogress_0
2019-06-13 12:05:14,150 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:group-6C7464E27C52 changes to CANDIDATE, lastRpcTime:1025, electionTimeout:1025ms
2019-06-13 12:05:14,150 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: shutdown FollowerState
2019-06-13 12:05:14,150 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:group-6C7464E27C52 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:14,150 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: start LeaderElection
2019-06-13 12:05:14,152 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:group-6C7464E27C52:LeaderElection129: begin an election at term 1 for -1: [4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:192.168.46.58:42309], old=null
2019-06-13 12:05:14,152 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: shutdown LeaderElection
2019-06-13 12:05:14,152 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:group-6C7464E27C52 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:14,152 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:group-6C7464E27C52 change Leader from null to 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34 at term 1 for becomeLeader, leader elected after 1029ms
2019-06-13 12:05:14,152 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:14,152 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:14,152 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:14,152 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:14,152 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: start LeaderState
2019-06-13 12:05:14,153 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:14,153 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:group-6C7464E27C52 set configuration 0: [4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:192.168.46.58:42309], old=null at 0
2019-06-13 12:05:14,191 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-4/data/ratis/e0cab5c3-08e3-407e-84a8-6c7464e27c52/current/log_inprogress_0
2019-06-13 12:05:14,306 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:group-49786FBEBE2E changes to CANDIDATE, lastRpcTime:1031, electionTimeout:1029ms
2019-06-13 12:05:14,306 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: shutdown FollowerState
2019-06-13 12:05:14,306 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:group-49786FBEBE2E changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:14,306 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: start LeaderElection
2019-06-13 12:05:14,308 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:group-49786FBEBE2E:LeaderElection130: begin an election at term 1 for -1: [6dce76ac-1a96-470d-902e-e4604ad0c946:192.168.46.58:46669, c1978e83-ba4c-4ece-a10d-e6b51f00e572:192.168.46.58:43553, 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:192.168.46.58:42309], old=null
2019-06-13 12:05:14,315 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572:group-49786FBEBE2E changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34
2019-06-13 12:05:14,315 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6dce76ac-1a96-470d-902e-e4604ad0c946:group-49786FBEBE2E changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34
2019-06-13 12:05:14,315 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: shutdown FollowerState
2019-06-13 12:05:14,315 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: shutdown FollowerState
2019-06-13 12:05:14,315 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: start FollowerState
2019-06-13 12:05:14,315 INFO  impl.FollowerState (FollowerState.java:run(109)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:14,315 INFO  impl.FollowerState (FollowerState.java:run(109)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:14,315 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: start FollowerState
2019-06-13 12:05:14,318 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:group-49786FBEBE2E:LeaderElection130: Election PASSED; received 1 response(s) [4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34->6dce76ac-1a96-470d-902e-e4604ad0c946,true-t1] and 0 exception(s); 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:t1, leader=null, voted=4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34, raftlog=4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [6dce76ac-1a96-470d-902e-e4604ad0c946:192.168.46.58:46669, c1978e83-ba4c-4ece-a10d-e6b51f00e572:192.168.46.58:43553, 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:192.168.46.58:42309], old=null
2019-06-13 12:05:14,318 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: shutdown LeaderElection
2019-06-13 12:05:14,318 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:group-49786FBEBE2E changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:14,318 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:group-49786FBEBE2E change Leader from null to 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34 at term 1 for becomeLeader, leader elected after 1049ms
2019-06-13 12:05:14,318 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:14,318 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:14,319 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:14,319 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:14,319 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 12:05:14,319 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:14,319 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 12:05:14,319 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 12:05:14,319 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:14,319 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:14,319 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 12:05:14,319 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:14,319 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 12:05:14,319 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 12:05:14,319 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:14,320 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:14,320 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: start LeaderState
2019-06-13 12:05:14,320 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:14,322 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:group-49786FBEBE2E set configuration 0: [6dce76ac-1a96-470d-902e-e4604ad0c946:192.168.46.58:46669, c1978e83-ba4c-4ece-a10d-e6b51f00e572:192.168.46.58:43553, 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:192.168.46.58:42309], old=null at 0
2019-06-13 12:05:14,340 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572:group-49786FBEBE2E change Leader from null to 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34 at term 1 for appendEntries, leader elected after 1070ms
2019-06-13 12:05:14,341 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 6dce76ac-1a96-470d-902e-e4604ad0c946:group-49786FBEBE2E change Leader from null to 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34 at term 1 for appendEntries, leader elected after 1072ms
2019-06-13 12:05:14,368 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572:group-49786FBEBE2E set configuration 0: [6dce76ac-1a96-470d-902e-e4604ad0c946:192.168.46.58:46669, c1978e83-ba4c-4ece-a10d-e6b51f00e572:192.168.46.58:43553, 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:192.168.46.58:42309], old=null at 0
2019-06-13 12:05:14,368 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:14,387 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 6dce76ac-1a96-470d-902e-e4604ad0c946:group-49786FBEBE2E set configuration 0: [6dce76ac-1a96-470d-902e-e4604ad0c946:192.168.46.58:46669, c1978e83-ba4c-4ece-a10d-e6b51f00e572:192.168.46.58:43553, 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:192.168.46.58:42309], old=null at 0
2019-06-13 12:05:14,388 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 6dce76ac-1a96-470d-902e-e4604ad0c946-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:14,390 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-4/data/ratis/4f7f025f-6433-48f5-bf69-49786fbebe2e/current/log_inprogress_0
2019-06-13 12:05:14,412 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-5/data/ratis/4f7f025f-6433-48f5-bf69-49786fbebe2e/current/log_inprogress_0
2019-06-13 12:05:14,415 INFO  impl.FollowerState (FollowerState.java:run(101)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572:group-C7840250724D changes to CANDIDATE, lastRpcTime:1163, electionTimeout:1163ms
2019-06-13 12:05:14,415 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: shutdown FollowerState
2019-06-13 12:05:14,415 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572:group-C7840250724D changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:14,415 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: start LeaderElection
2019-06-13 12:05:14,417 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572:group-C7840250724D:LeaderElection131: begin an election at term 1 for -1: [c1978e83-ba4c-4ece-a10d-e6b51f00e572:192.168.46.58:43553], old=null
2019-06-13 12:05:14,417 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: shutdown LeaderElection
2019-06-13 12:05:14,417 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572:group-C7840250724D changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:14,417 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572:group-C7840250724D change Leader from null to c1978e83-ba4c-4ece-a10d-e6b51f00e572 at term 1 for becomeLeader, leader elected after 1168ms
2019-06-13 12:05:14,417 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:14,417 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:14,417 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:14,418 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:14,418 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: start LeaderState
2019-06-13 12:05:14,418 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:14,421 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572:group-C7840250724D set configuration 0: [c1978e83-ba4c-4ece-a10d-e6b51f00e572:192.168.46.58:43553], old=null at 0
2019-06-13 12:05:14,440 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 6dce76ac-1a96-470d-902e-e4604ad0c946-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-3/data/ratis/4f7f025f-6433-48f5-bf69-49786fbebe2e/current/log_inprogress_0
2019-06-13 12:05:14,463 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-5/data/ratis/a623e775-1d3e-451c-befa-c7840250724d/current/log_inprogress_0
2019-06-13 12:05:14,499 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F501F45E6D68->fb0a39bd-7985-46b0-9937-fc701c95099c: receive RaftClientReply:client-F501F45E6D68->fb0a39bd-7985-46b0-9937-fc701c95099c@group-42896EF8769D, cid=100, SUCCESS, logIndex=1, commits[fb0a39bd-7985-46b0-9937-fc701c95099c:c2, f348b87a-528e-40e1-af0e-47d468ee337a:c1, a2f33826-4d19-41fa-b015-7309f7215935:c1]
2019-06-13 12:05:14,499 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:05:14,500 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@d0538b3
2019-06-13 12:05:14,500 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:05:14,501 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:05:14,501 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - f348b87a-528e-40e1-af0e-47d468ee337a: close
2019-06-13 12:05:14,501 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - f348b87a-528e-40e1-af0e-47d468ee337a: shutdown group-42896EF8769D
2019-06-13 12:05:14,502 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-42896EF8769D,id=f348b87a-528e-40e1-af0e-47d468ee337a
2019-06-13 12:05:14,502 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - f348b87a-528e-40e1-af0e-47d468ee337a: shutdown FollowerState
2019-06-13 12:05:14,502 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-f348b87a-528e-40e1-af0e-47d468ee337a-group-42896EF8769D: set stopIndex = 1
2019-06-13 12:05:14,502 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:1)
2019-06-13 12:05:14,502 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-0/data/ratis/3b02ab92-9cb2-4ebc-8230-42896ef8769d/sm/snapshot.1_1
2019-06-13 12:05:14,502 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - f348b87a-528e-40e1-af0e-47d468ee337a: shutdown group-55CE701C89EF
2019-06-13 12:05:14,503 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-55CE701C89EF,id=f348b87a-528e-40e1-af0e-47d468ee337a
2019-06-13 12:05:14,503 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - f348b87a-528e-40e1-af0e-47d468ee337a: shutdown LeaderState
2019-06-13 12:05:14,502 INFO  impl.FollowerState (FollowerState.java:run(109)) - f348b87a-528e-40e1-af0e-47d468ee337a: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:14,503 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - f348b87a-528e-40e1-af0e-47d468ee337a-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:14,504 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - f348b87a-528e-40e1-af0e-47d468ee337a:group-42896EF8769D closes. The last applied log index is 1
2019-06-13 12:05:14,507 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - f348b87a-528e-40e1-af0e-47d468ee337a-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:14,512 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-f348b87a-528e-40e1-af0e-47d468ee337a-group-55CE701C89EF: set stopIndex = 0
2019-06-13 12:05:14,512 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - f348b87a-528e-40e1-af0e-47d468ee337a-RaftLogWorker close()
2019-06-13 12:05:14,512 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:14,516 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - f348b87a-528e-40e1-af0e-47d468ee337a:group-55CE701C89EF closes. The last applied log index is 0
2019-06-13 12:05:14,516 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - f348b87a-528e-40e1-af0e-47d468ee337a-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:14,520 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - f348b87a-528e-40e1-af0e-47d468ee337a-RaftLogWorker close()
2019-06-13 12:05:14,524 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - f348b87a-528e-40e1-af0e-47d468ee337a: shutdown server with port 36749 now
2019-06-13 12:05:14,524 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - f348b87a-528e-40e1-af0e-47d468ee337a: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:05:14,525 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - f348b87a-528e-40e1-af0e-47d468ee337a: shutdown server with port 36749 successfully
2019-06-13 12:05:14,525 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - fb0a39bd-7985-46b0-9937-fc701c95099c: Failed appendEntries to f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-13 12:05:14,525 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fb0a39bd-7985-46b0-9937-fc701c95099c->f348b87a-528e-40e1-af0e-47d468ee337a: nextIndex: updateUnconditionally 3 -> 0
2019-06-13 12:05:14,528 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:14,539 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:05:14,540 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@67b1c3af{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:05:14,540 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@2e243122{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:14,540 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@49c72fb7{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:05:14,541 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@4b74a4d{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:14,548 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - fb0a39bd-7985-46b0-9937-fc701c95099c: Failed appendEntries to f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:14,548 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fb0a39bd-7985-46b0-9937-fc701c95099c->f348b87a-528e-40e1-af0e-47d468ee337a: nextIndex: updateUnconditionally 1 -> 0
2019-06-13 12:05:14,554 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - fb0a39bd-7985-46b0-9937-fc701c95099c: Failed appendEntries to f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:14,555 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fb0a39bd-7985-46b0-9937-fc701c95099c->f348b87a-528e-40e1-af0e-47d468ee337a: nextIndex: updateUnconditionally 1 -> 0
2019-06-13 12:05:14,557 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - fb0a39bd-7985-46b0-9937-fc701c95099c: Failed appendEntries to f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:14,558 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fb0a39bd-7985-46b0-9937-fc701c95099c->f348b87a-528e-40e1-af0e-47d468ee337a: nextIndex: updateUnconditionally 1 -> 0
2019-06-13 12:05:14,565 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 1 is closed with bcsId 0.
2019-06-13 12:05:14,570 INFO  impl.FollowerState (FollowerState.java:run(101)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41:group-B3342E96A79F changes to CANDIDATE, lastRpcTime:1166, electionTimeout:1164ms
2019-06-13 12:05:14,570 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41: shutdown FollowerState
2019-06-13 12:05:14,570 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41:group-B3342E96A79F changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:14,570 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41: start LeaderElection
2019-06-13 12:05:14,570 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F501F45E6D68->fb0a39bd-7985-46b0-9937-fc701c95099c: receive RaftClientReply:client-F501F45E6D68->fb0a39bd-7985-46b0-9937-fc701c95099c@group-42896EF8769D, cid=101, SUCCESS, logIndex=3, commits[fb0a39bd-7985-46b0-9937-fc701c95099c:c4, f348b87a-528e-40e1-af0e-47d468ee337a:c1, a2f33826-4d19-41fa-b015-7309f7215935:c3]
2019-06-13 12:05:14,574 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41:group-B3342E96A79F:LeaderElection132: begin an election at term 1 for -1: [8c2f491c-bec6-4ecd-8b98-9ad532234c41:192.168.46.58:32879], old=null
2019-06-13 12:05:14,574 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41: shutdown LeaderElection
2019-06-13 12:05:14,574 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41:group-B3342E96A79F changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:14,574 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41:group-B3342E96A79F change Leader from null to 8c2f491c-bec6-4ecd-8b98-9ad532234c41 at term 1 for becomeLeader, leader elected after 1186ms
2019-06-13 12:05:14,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:14,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:14,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:14,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:14,576 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 1 is closed with bcsId 0.
2019-06-13 12:05:14,578 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41: start LeaderState
2019-06-13 12:05:14,579 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:14,581 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41:group-B3342E96A79F set configuration 0: [8c2f491c-bec6-4ecd-8b98-9ad532234c41:192.168.46.58:32879], old=null at 0
2019-06-13 12:05:14,616 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-6/data/ratis/2de855bb-8d7b-416a-81c4-b3342e96a79f/current/log_inprogress_0
2019-06-13 12:05:15,058 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - fb0a39bd-7985-46b0-9937-fc701c95099c: Failed appendEntries to f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:15,058 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fb0a39bd-7985-46b0-9937-fc701c95099c->f348b87a-528e-40e1-af0e-47d468ee337a: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:15,100 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1054, electionTimeout:1054ms
2019-06-13 12:05:15,100 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:15,100 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 62 for changeToCandidate
2019-06-13 12:05:15,101 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:15,103 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection133: begin an election at term 63 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:15,104 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection133 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:15,104 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection133 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:15,104 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection133: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t63, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:15,104 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:15,104 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:15,104 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 63 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:15,104 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:15,104 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:15,558 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - fb0a39bd-7985-46b0-9937-fc701c95099c: Failed appendEntries to f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:15,559 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fb0a39bd-7985-46b0-9937-fc701c95099c->f348b87a-528e-40e1-af0e-47d468ee337a: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:16,059 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - fb0a39bd-7985-46b0-9937-fc701c95099c: Failed appendEntries to f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:16,059 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fb0a39bd-7985-46b0-9937-fc701c95099c->f348b87a-528e-40e1-af0e-47d468ee337a: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:16,244 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1139, electionTimeout:1139ms
2019-06-13 12:05:16,244 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:16,244 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 63 for changeToCandidate
2019-06-13 12:05:16,244 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:16,247 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection134: begin an election at term 64 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:16,247 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection134 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:16,247 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection134 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:16,248 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection134: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t64, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:16,248 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:16,248 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:16,248 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 64 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:16,248 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:16,248 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:16,559 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - fb0a39bd-7985-46b0-9937-fc701c95099c: Failed appendEntries to f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:16,560 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fb0a39bd-7985-46b0-9937-fc701c95099c->f348b87a-528e-40e1-af0e-47d468ee337a: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:17,060 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - fb0a39bd-7985-46b0-9937-fc701c95099c: Failed appendEntries to f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:17,060 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fb0a39bd-7985-46b0-9937-fc701c95099c->f348b87a-528e-40e1-af0e-47d468ee337a: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:17,285 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1037, electionTimeout:1037ms
2019-06-13 12:05:17,285 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:17,285 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 64 for changeToCandidate
2019-06-13 12:05:17,286 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:17,288 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection135: begin an election at term 65 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:17,288 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection135 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:17,288 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection135 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:17,289 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection135: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t65, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:17,289 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:17,289 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:17,289 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 65 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:17,289 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:17,289 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:17,560 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - fb0a39bd-7985-46b0-9937-fc701c95099c: Failed appendEntries to f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:17,561 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fb0a39bd-7985-46b0-9937-fc701c95099c->f348b87a-528e-40e1-af0e-47d468ee337a: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:17,574 WARN  scm.XceiverClientRatis (XceiverClientRatis.java:watchForCommit(260)) - 3 way commit failed 
java.util.concurrent.TimeoutException
	at java.util.concurrent.CompletableFuture.timedGet(CompletableFuture.java:1771)
	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1915)
	at org.apache.hadoop.hdds.scm.XceiverClientRatis.watchForCommit(XceiverClientRatis.java:257)
	at org.apache.hadoop.ozone.client.rpc.TestWatchForCommit.test2WayCommitForTimeoutException(TestWatchForCommit.java:433)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2019-06-13 12:05:18,060 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - fb0a39bd-7985-46b0-9937-fc701c95099c: Failed appendEntries to f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:18,061 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fb0a39bd-7985-46b0-9937-fc701c95099c->f348b87a-528e-40e1-af0e-47d468ee337a: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:18,458 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1169, electionTimeout:1169ms
2019-06-13 12:05:18,458 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:18,458 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 65 for changeToCandidate
2019-06-13 12:05:18,459 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:18,461 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection136: begin an election at term 66 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:18,462 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection136 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:18,462 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection136 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:18,462 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection136: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t66, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:18,462 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:18,462 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:18,462 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 66 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:18,462 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:18,463 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:18,561 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - fb0a39bd-7985-46b0-9937-fc701c95099c: Failed appendEntries to f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:18,561 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fb0a39bd-7985-46b0-9937-fc701c95099c->f348b87a-528e-40e1-af0e-47d468ee337a: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:18,584 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-F501F45E6D68->a2f33826-4d19-41fa-b015-7309f7215935@group-42896EF8769D, cid=102, seq=0, Watch-ALL_COMMITTED(3), Message:<EMPTY>, reply=RaftClientReply:client-F501F45E6D68->a2f33826-4d19-41fa-b015-7309f7215935@group-42896EF8769D, cid=102, FAILED org.apache.ratis.protocol.NotLeaderException: Server a2f33826-4d19-41fa-b015-7309f7215935 is not the leader (fb0a39bd-7985-46b0-9937-fc701c95099c:192.168.46.58:38359). Request must be sent to leader., logIndex=0, commits[a2f33826-4d19-41fa-b015-7309f7215935:c4, fb0a39bd-7985-46b0-9937-fc701c95099c:c4, f348b87a-528e-40e1-af0e-47d468ee337a:c1]
2019-06-13 12:05:18,591 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F501F45E6D68->a2f33826-4d19-41fa-b015-7309f7215935: receive RaftClientReply:client-F501F45E6D68->a2f33826-4d19-41fa-b015-7309f7215935@group-42896EF8769D, cid=102, FAILED org.apache.ratis.protocol.NotLeaderException: Server a2f33826-4d19-41fa-b015-7309f7215935 is not the leader (fb0a39bd-7985-46b0-9937-fc701c95099c:192.168.46.58:38359). Request must be sent to leader., logIndex=0, commits[a2f33826-4d19-41fa-b015-7309f7215935:c4, fb0a39bd-7985-46b0-9937-fc701c95099c:c4, f348b87a-528e-40e1-af0e-47d468ee337a:c1]
2019-06-13 12:05:18,591 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-F501F45E6D68->a2f33826-4d19-41fa-b015-7309f7215935@group-42896EF8769D, cid=103, seq=0, Watch-MAJORITY_COMMITTED(3), Message:<EMPTY>, reply=RaftClientReply:client-F501F45E6D68->a2f33826-4d19-41fa-b015-7309f7215935@group-42896EF8769D, cid=103, FAILED org.apache.ratis.protocol.NotLeaderException: Server a2f33826-4d19-41fa-b015-7309f7215935 is not the leader (fb0a39bd-7985-46b0-9937-fc701c95099c:192.168.46.58:38359). Request must be sent to leader., logIndex=0, commits[a2f33826-4d19-41fa-b015-7309f7215935:c4, fb0a39bd-7985-46b0-9937-fc701c95099c:c4, f348b87a-528e-40e1-af0e-47d468ee337a:c1]
2019-06-13 12:05:18,594 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-UnorderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:05:19,061 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - fb0a39bd-7985-46b0-9937-fc701c95099c: Failed appendEntries to f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:19,062 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fb0a39bd-7985-46b0-9937-fc701c95099c->f348b87a-528e-40e1-af0e-47d468ee337a: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:19,562 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - fb0a39bd-7985-46b0-9937-fc701c95099c: Failed appendEntries to f348b87a-528e-40e1-af0e-47d468ee337a:192.168.46.58:36749: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:19,562 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fb0a39bd-7985-46b0-9937-fc701c95099c->f348b87a-528e-40e1-af0e-47d468ee337a: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:19,589 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1126, electionTimeout:1126ms
2019-06-13 12:05:19,589 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:19,589 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 66 for changeToCandidate
2019-06-13 12:05:19,589 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:19,600 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F501F45E6D68->fb0a39bd-7985-46b0-9937-fc701c95099c: receive RaftClientReply:client-F501F45E6D68->fb0a39bd-7985-46b0-9937-fc701c95099c@group-42896EF8769D, cid=103, SUCCESS, logIndex=0, commits[fb0a39bd-7985-46b0-9937-fc701c95099c:c4, f348b87a-528e-40e1-af0e-47d468ee337a:c1, a2f33826-4d19-41fa-b015-7309f7215935:c4]
2019-06-13 12:05:19,602 INFO  scm.XceiverClientRatis (XceiverClientRatis.java:lambda$watchForCommit$7(278)) - Could not commit 3 to all the nodes. Server f348b87a-528e-40e1-af0e-47d468ee337a has failed. Committed by majority.
2019-06-13 12:05:19,602 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:shutdown(321)) - Shutting down the Mini Ozone Cluster
2019-06-13 12:05:19,602 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(336)) - Stopping the Mini Ozone Cluster
2019-06-13 12:05:19,602 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(338)) - Stopping the OzoneManager
2019-06-13 12:05:19,602 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 46083
2019-06-13 12:05:19,607 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 46083
2019-06-13 12:05:19,607 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service KeyDeletingService
2019-06-13 12:05:19,608 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-13 12:05:19,731 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@5c7b504{/,null,UNAVAILABLE}{/ozoneManager}
2019-06-13 12:05:19,732 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@772589ed{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:19,732 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection137: begin an election at term 67 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:19,732 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@5a2297d7{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,UNAVAILABLE}
2019-06-13 12:05:19,732 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@2703785e{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:19,732 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection137 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:19,733 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection137 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:19,733 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection137: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t67, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:19,733 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:19,733 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:19,734 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 67 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:19,734 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:19,734 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:19,734 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(344)) - Stopping the StorageContainerManager
2019-06-13 12:05:19,734 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(789)) - Stopping Replication Manager Service.
2019-06-13 12:05:19,734 INFO  container.ReplicationManager (ReplicationManager.java:stop(191)) - Replication Monitor Thread is not running.
2019-06-13 12:05:19,734 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(796)) - Stopping Lease Manager of the command watchers
2019-06-13 12:05:19,734 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(803)) - Stopping datanode service RPC server
2019-06-13 12:05:19,734 INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(373)) - Stopping the RPC server for DataNodes
2019-06-13 12:05:19,735 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 32965
2019-06-13 12:05:19,738 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 32965
2019-06-13 12:05:19,738 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-13 12:05:19,738 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(811)) - Stopping block service RPC server
2019-06-13 12:05:19,740 INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(145)) - Stopping the RPC server for Block Protocol
2019-06-13 12:05:19,740 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 39973
2019-06-13 12:05:19,743 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 39973
2019-06-13 12:05:19,743 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-13 12:05:19,743 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(818)) - Stopping the StorageContainerLocationProtocol RPC server
2019-06-13 12:05:19,745 INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(157)) - Stopping the RPC server for Client Protocol
2019-06-13 12:05:19,745 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 44851
2019-06-13 12:05:19,748 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 44851
2019-06-13 12:05:19,748 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-13 12:05:19,760 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(825)) - Stopping Storage Container Manager HTTP server.
2019-06-13 12:05:19,760 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@5d94c50e{/,null,UNAVAILABLE}{/scm}
2019-06-13 12:05:19,761 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@135f160e{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:19,761 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@72fa021{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,UNAVAILABLE}
2019-06-13 12:05:19,761 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@2cf97875{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:19,762 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(836)) - Stopping Block Manager Service.
2019-06-13 12:05:19,762 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service SCMBlockDeletingService
2019-06-13 12:05:19,762 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service SCMBlockDeletingService
2019-06-13 12:05:19,763 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(858)) - Stopping SCM Event Queue.
2019-06-13 12:05:19,768 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(350)) - Shutting the HddsDatanodes
2019-06-13 12:05:19,768 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:05:19,768 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@3d6c7152
2019-06-13 12:05:19,769 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:05:19,769 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:05:19,769 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - a2f33826-4d19-41fa-b015-7309f7215935: close
2019-06-13 12:05:19,769 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - a2f33826-4d19-41fa-b015-7309f7215935: shutdown group-42896EF8769D
2019-06-13 12:05:19,769 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - a2f33826-4d19-41fa-b015-7309f7215935: shutdown group-140A59CDD123
2019-06-13 12:05:19,769 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-42896EF8769D,id=a2f33826-4d19-41fa-b015-7309f7215935
2019-06-13 12:05:19,769 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-140A59CDD123,id=a2f33826-4d19-41fa-b015-7309f7215935
2019-06-13 12:05:19,770 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a2f33826-4d19-41fa-b015-7309f7215935: shutdown FollowerState
2019-06-13 12:05:19,770 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - a2f33826-4d19-41fa-b015-7309f7215935: shutdown LeaderState
2019-06-13 12:05:19,770 INFO  impl.FollowerState (FollowerState.java:run(109)) - a2f33826-4d19-41fa-b015-7309f7215935: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:19,770 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - a2f33826-4d19-41fa-b015-7309f7215935-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:19,770 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-a2f33826-4d19-41fa-b015-7309f7215935-group-42896EF8769D: set stopIndex = 4
2019-06-13 12:05:19,770 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-13 12:05:19,770 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-a2f33826-4d19-41fa-b015-7309f7215935-group-140A59CDD123: set stopIndex = 0
2019-06-13 12:05:19,770 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:19,771 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-1/data/ratis/3b02ab92-9cb2-4ebc-8230-42896ef8769d/sm/snapshot.1_3
2019-06-13 12:05:19,771 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - a2f33826-4d19-41fa-b015-7309f7215935:group-140A59CDD123 closes. The last applied log index is 0
2019-06-13 12:05:19,771 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - a2f33826-4d19-41fa-b015-7309f7215935:group-42896EF8769D closes. The last applied log index is 4
2019-06-13 12:05:19,771 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - a2f33826-4d19-41fa-b015-7309f7215935-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:19,771 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - a2f33826-4d19-41fa-b015-7309f7215935-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:19,777 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - a2f33826-4d19-41fa-b015-7309f7215935-RaftLogWorker close()
2019-06-13 12:05:19,777 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - a2f33826-4d19-41fa-b015-7309f7215935-RaftLogWorker close()
2019-06-13 12:05:19,790 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - a2f33826-4d19-41fa-b015-7309f7215935: shutdown server with port 34659 now
2019-06-13 12:05:19,791 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - a2f33826-4d19-41fa-b015-7309f7215935: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:05:19,791 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - a2f33826-4d19-41fa-b015-7309f7215935: shutdown server with port 34659 successfully
2019-06-13 12:05:19,791 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - fb0a39bd-7985-46b0-9937-fc701c95099c: Failed appendEntries to a2f33826-4d19-41fa-b015-7309f7215935:192.168.46.58:34659: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-13 12:05:19,791 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fb0a39bd-7985-46b0-9937-fc701c95099c->a2f33826-4d19-41fa-b015-7309f7215935: nextIndex: updateUnconditionally 5 -> 0
2019-06-13 12:05:19,794 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:19,819 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:05:19,820 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@5e781b4f{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:05:19,821 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@1b89debc{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:19,821 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@2279e7c7{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:05:19,821 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@31c29db1{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:19,822 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:05:19,822 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@10acfe30
2019-06-13 12:05:19,822 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:05:19,822 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:05:19,823 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - fb0a39bd-7985-46b0-9937-fc701c95099c: close
2019-06-13 12:05:19,823 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - fb0a39bd-7985-46b0-9937-fc701c95099c: shutdown group-42896EF8769D
2019-06-13 12:05:19,823 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-42896EF8769D,id=fb0a39bd-7985-46b0-9937-fc701c95099c
2019-06-13 12:05:19,823 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - fb0a39bd-7985-46b0-9937-fc701c95099c: shutdown LeaderState
2019-06-13 12:05:19,824 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - fb0a39bd-7985-46b0-9937-fc701c95099c-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:19,824 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(fb0a39bd-7985-46b0-9937-fc701c95099c -> a2f33826-4d19-41fa-b015-7309f7215935): Wait interrupted by java.lang.InterruptedException
2019-06-13 12:05:19,824 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(fb0a39bd-7985-46b0-9937-fc701c95099c -> f348b87a-528e-40e1-af0e-47d468ee337a): Wait interrupted by java.lang.InterruptedException
2019-06-13 12:05:19,834 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-F501F45E6D68->fb0a39bd-7985-46b0-9937-fc701c95099c@group-42896EF8769D, cid=102, seq=0, Watch-ALL_COMMITTED(3), Message:<EMPTY>, reply=RaftClientReply:client-F501F45E6D68->fb0a39bd-7985-46b0-9937-fc701c95099c@group-42896EF8769D, cid=102, FAILED org.apache.ratis.protocol.NotLeaderException: Server fb0a39bd-7985-46b0-9937-fc701c95099c is not the leader (null). Request must be sent to leader., logIndex=0, commits[fb0a39bd-7985-46b0-9937-fc701c95099c:c4]
2019-06-13 12:05:19,837 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-fb0a39bd-7985-46b0-9937-fc701c95099c-group-42896EF8769D: set stopIndex = 4
2019-06-13 12:05:19,837 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-13 12:05:19,837 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-ed228aa3-0786-41b5-a0ef-002dcfbf3717/datanode-2/data/ratis/3b02ab92-9cb2-4ebc-8230-42896ef8769d/sm/snapshot.1_4
2019-06-13 12:05:19,837 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - fb0a39bd-7985-46b0-9937-fc701c95099c:group-42896EF8769D closes. The last applied log index is 4
2019-06-13 12:05:19,838 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - fb0a39bd-7985-46b0-9937-fc701c95099c-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:19,837 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-F501F45E6D68->fb0a39bd-7985-46b0-9937-fc701c95099c@group-42896EF8769D, cid=102, seq=0, Watch-ALL_COMMITTED(3), Message:<EMPTY>, reply=RaftClientReply:client-F501F45E6D68->fb0a39bd-7985-46b0-9937-fc701c95099c@group-42896EF8769D, cid=102, FAILED org.apache.ratis.protocol.NotLeaderException: Server fb0a39bd-7985-46b0-9937-fc701c95099c is not the leader (null). Request must be sent to leader., logIndex=0, commits[fb0a39bd-7985-46b0-9937-fc701c95099c:c4]
2019-06-13 12:05:19,841 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - fb0a39bd-7985-46b0-9937-fc701c95099c-RaftLogWorker close()
2019-06-13 12:05:19,847 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - fb0a39bd-7985-46b0-9937-fc701c95099c: shutdown group-A99D0EFDACE8
2019-06-13 12:05:19,847 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-A99D0EFDACE8,id=fb0a39bd-7985-46b0-9937-fc701c95099c
2019-06-13 12:05:19,856 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - fb0a39bd-7985-46b0-9937-fc701c95099c: shutdown LeaderState
2019-06-13 12:05:19,856 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F501F45E6D68->fb0a39bd-7985-46b0-9937-fc701c95099c: receive RaftClientReply:client-F501F45E6D68->fb0a39bd-7985-46b0-9937-fc701c95099c@group-42896EF8769D, cid=102, FAILED org.apache.ratis.protocol.NotLeaderException: Server fb0a39bd-7985-46b0-9937-fc701c95099c is not the leader (null). Request must be sent to leader., logIndex=0, commits[fb0a39bd-7985-46b0-9937-fc701c95099c:c4]
2019-06-13 12:05:19,856 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - fb0a39bd-7985-46b0-9937-fc701c95099c-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:19,858 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-fb0a39bd-7985-46b0-9937-fc701c95099c-group-A99D0EFDACE8: set stopIndex = 0
2019-06-13 12:05:19,860 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 2-UnorderedRequestStreamObserver2: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:05:19,858 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:19,866 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - fb0a39bd-7985-46b0-9937-fc701c95099c:group-A99D0EFDACE8 closes. The last applied log index is 0
2019-06-13 12:05:19,866 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - fb0a39bd-7985-46b0-9937-fc701c95099c-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:19,870 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - fb0a39bd-7985-46b0-9937-fc701c95099c-RaftLogWorker close()
2019-06-13 12:05:19,872 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - fb0a39bd-7985-46b0-9937-fc701c95099c: shutdown server with port 38359 now
2019-06-13 12:05:19,873 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - fb0a39bd-7985-46b0-9937-fc701c95099c: shutdown server with port 38359 successfully
2019-06-13 12:05:19,874 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:19,891 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:05:19,892 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@30a99b85{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:05:19,892 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@386d41cb{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:19,893 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@4615bc00{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:05:19,893 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@45e49d3d{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:19,894 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:05:19,894 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@75937998
2019-06-13 12:05:19,894 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:05:19,894 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:05:19,894 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: close
2019-06-13 12:05:19,895 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: shutdown group-CCE69423C015
2019-06-13 12:05:19,895 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-CCE69423C015,id=6dce76ac-1a96-470d-902e-e4604ad0c946
2019-06-13 12:05:19,895 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: shutdown LeaderState
2019-06-13 12:05:19,895 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 6dce76ac-1a96-470d-902e-e4604ad0c946-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:19,896 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:19,896 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-6dce76ac-1a96-470d-902e-e4604ad0c946-group-CCE69423C015: set stopIndex = 0
2019-06-13 12:05:19,896 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 6dce76ac-1a96-470d-902e-e4604ad0c946:group-CCE69423C015 closes. The last applied log index is 0
2019-06-13 12:05:19,896 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 6dce76ac-1a96-470d-902e-e4604ad0c946-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:19,912 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 6dce76ac-1a96-470d-902e-e4604ad0c946-RaftLogWorker close()
2019-06-13 12:05:19,916 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: shutdown group-49786FBEBE2E
2019-06-13 12:05:19,916 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-49786FBEBE2E,id=6dce76ac-1a96-470d-902e-e4604ad0c946
2019-06-13 12:05:19,916 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: shutdown FollowerState
2019-06-13 12:05:19,918 INFO  impl.FollowerState (FollowerState.java:run(109)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:19,918 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-6dce76ac-1a96-470d-902e-e4604ad0c946-group-49786FBEBE2E: set stopIndex = 0
2019-06-13 12:05:19,919 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:19,919 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 6dce76ac-1a96-470d-902e-e4604ad0c946:group-49786FBEBE2E closes. The last applied log index is 0
2019-06-13 12:05:19,919 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 6dce76ac-1a96-470d-902e-e4604ad0c946-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:19,921 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 6dce76ac-1a96-470d-902e-e4604ad0c946-RaftLogWorker close()
2019-06-13 12:05:19,924 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: shutdown server with port 46669 now
2019-06-13 12:05:19,924 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:05:19,924 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 6dce76ac-1a96-470d-902e-e4604ad0c946: shutdown server with port 46669 successfully
2019-06-13 12:05:19,925 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: Failed appendEntries to 6dce76ac-1a96-470d-902e-e4604ad0c946:192.168.46.58:46669: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-13 12:05:19,925 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34->6dce76ac-1a96-470d-902e-e4604ad0c946: nextIndex: updateUnconditionally 1 -> 0
2019-06-13 12:05:19,926 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:19,953 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:05:19,953 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@6fe55fcf{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:05:19,954 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@4d1f6e1c{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:19,954 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@298cfe89{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:05:19,954 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@257e8c43{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:19,956 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:05:19,956 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@6108c962
2019-06-13 12:05:19,957 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:05:19,957 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:05:19,957 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: Failed appendEntries to 6dce76ac-1a96-470d-902e-e4604ad0c946:192.168.46.58:46669: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:19,958 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34->6dce76ac-1a96-470d-902e-e4604ad0c946: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:19,958 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: close
2019-06-13 12:05:19,958 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: shutdown group-49786FBEBE2E
2019-06-13 12:05:19,958 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: shutdown group-6C7464E27C52
2019-06-13 12:05:19,959 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-6C7464E27C52,id=4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34
2019-06-13 12:05:19,959 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: shutdown LeaderState
2019-06-13 12:05:19,959 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:19,959 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34-group-6C7464E27C52: set stopIndex = 0
2019-06-13 12:05:19,959 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-49786FBEBE2E,id=4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34
2019-06-13 12:05:19,959 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:19,959 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: shutdown LeaderState
2019-06-13 12:05:19,959 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:group-6C7464E27C52 closes. The last applied log index is 0
2019-06-13 12:05:19,959 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:19,959 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34 -> 6dce76ac-1a96-470d-902e-e4604ad0c946): Wait interrupted by java.lang.InterruptedException
2019-06-13 12:05:19,959 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34 -> c1978e83-ba4c-4ece-a10d-e6b51f00e572): Wait interrupted by java.lang.InterruptedException
2019-06-13 12:05:19,960 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:19,960 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: appendEntries completed
2019-06-13 12:05:19,960 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34-group-49786FBEBE2E: set stopIndex = 0
2019-06-13 12:05:19,960 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34:group-49786FBEBE2E closes. The last applied log index is 0
2019-06-13 12:05:19,960 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:19,960 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: follower 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34->c1978e83-ba4c-4ece-a10d-e6b51f00e572(c0,m0,n1, attendVote=true, lastRpcSendTime=35, lastRpcResponseTime=34) response Completed
2019-06-13 12:05:19,967 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:19,967 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34->c1978e83-ba4c-4ece-a10d-e6b51f00e572: nextIndex: updateUnconditionally 1 -> -1
2019-06-13 12:05:19,966 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34-RaftLogWorker close()
2019-06-13 12:05:19,967 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34-RaftLogWorker close()
2019-06-13 12:05:19,967 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: shutdown server with port 42309 now
2019-06-13 12:05:19,969 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 4bd64fbe-0fc2-4402-a9d6-ccfa15eaea34: shutdown server with port 42309 successfully
2019-06-13 12:05:19,971 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:19,985 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:05:19,986 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@36d7e8d2{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:05:19,987 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@715ea64a{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:19,987 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@328b2c2a{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:05:19,987 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@5c7c22ce{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:19,988 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:05:19,988 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@7b1a9ab3
2019-06-13 12:05:19,988 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:05:19,989 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:05:19,989 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: close
2019-06-13 12:05:19,989 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: shutdown group-C7840250724D
2019-06-13 12:05:19,989 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C7840250724D,id=c1978e83-ba4c-4ece-a10d-e6b51f00e572
2019-06-13 12:05:19,989 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: shutdown LeaderState
2019-06-13 12:05:19,989 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:19,990 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-c1978e83-ba4c-4ece-a10d-e6b51f00e572-group-C7840250724D: set stopIndex = 0
2019-06-13 12:05:19,990 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:19,990 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572:group-C7840250724D closes. The last applied log index is 0
2019-06-13 12:05:19,990 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:19,990 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572-RaftLogWorker close()
2019-06-13 12:05:19,990 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: shutdown group-49786FBEBE2E
2019-06-13 12:05:19,991 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-49786FBEBE2E,id=c1978e83-ba4c-4ece-a10d-e6b51f00e572
2019-06-13 12:05:19,991 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: shutdown FollowerState
2019-06-13 12:05:19,991 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-c1978e83-ba4c-4ece-a10d-e6b51f00e572-group-49786FBEBE2E: set stopIndex = 0
2019-06-13 12:05:19,991 INFO  impl.FollowerState (FollowerState.java:run(109)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:19,991 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:19,991 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572:group-49786FBEBE2E closes. The last applied log index is 0
2019-06-13 12:05:19,991 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:19,992 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572-RaftLogWorker close()
2019-06-13 12:05:19,992 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: shutdown server with port 43553 now
2019-06-13 12:05:19,992 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - c1978e83-ba4c-4ece-a10d-e6b51f00e572: shutdown server with port 43553 successfully
2019-06-13 12:05:19,993 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:20,086 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:05:20,089 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@3582077c{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:05:20,093 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@5d00241b{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:20,094 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@7959fbe3{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:05:20,097 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@dcf64d2{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:20,109 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:05:20,109 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@5d04adc1
2019-06-13 12:05:20,109 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:05:20,110 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41: close
2019-06-13 12:05:20,110 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41: shutdown group-B3342E96A79F
2019-06-13 12:05:20,110 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-B3342E96A79F,id=8c2f491c-bec6-4ecd-8b98-9ad532234c41
2019-06-13 12:05:20,111 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41: shutdown LeaderState
2019-06-13 12:05:20,111 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:20,111 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:05:20,111 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-8c2f491c-bec6-4ecd-8b98-9ad532234c41-group-B3342E96A79F: set stopIndex = 0
2019-06-13 12:05:20,111 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:20,111 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41:group-B3342E96A79F closes. The last applied log index is 0
2019-06-13 12:05:20,112 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:20,112 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41-RaftLogWorker close()
2019-06-13 12:05:20,112 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41: shutdown server with port 32879 now
2019-06-13 12:05:20,118 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 8c2f491c-bec6-4ecd-8b98-9ad532234c41: shutdown server with port 32879 successfully
2019-06-13 12:05:20,118 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:20,146 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:05:20,153 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@4ab1693b{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:05:20,154 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@35e0d91e{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:20,154 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@513cd96f{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:05:20,154 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@6d43c881{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:20,171 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:05:20,175 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:05:20,175 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:05:20,176 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedBlocks
2019-06-13 12:05:20,176 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedBlocks
2019-06-13 12:05:20,176 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: validCerts
2019-06-13 12:05:20,176 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:validCerts
2019-06-13 12:05:20,176 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: revokedCerts
2019-06-13 12:05:20,176 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:revokedCerts
2019-06-13 12:05:20,176 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-13 12:05:20,177 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-13 12:05:20,177 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-13 12:05:20,213 WARN  server.ServerUtils (ServerUtils.java:sanitizeUserArgs(70)) - ozone.scm.stale.node.interval value = 300000 is larger than max = 100000 based on the key value of ozone.scm.heartbeat.thread.interval, reset to the max value 100000.
2019-06-13 12:05:20,213 WARN  server.ServerUtils (ServerUtils.java:sanitizeUserArgs(70)) - ozone.scm.stale.node.interval value = 300000 is larger than max = 100000 based on the key value of ozone.scm.heartbeat.thread.interval, reset to the max value 100000.
2019-06-13 12:05:20,213 INFO  node.SCMNodeManager (SCMNodeManager.java:<init>(108)) - Entering startup safe mode.
2019-06-13 12:05:20,214 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(125)) - Loading file from sun.misc.CompoundEnumeration@6d810e94
2019-06-13 12:05:20,214 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(171)) - Loading network topology layer schema file
2019-06-13 12:05:20,216 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:05:20,228 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:initializePipelineState(126)) - No pipeline exists in current db
2019-06-13 12:05:20,228 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:05:20,240 WARN  events.EventQueue (EventQueue.java:fireEvent(175)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='SafeModeStatus'}
2019-06-13 12:05:20,241 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-13 12:05:20,241 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 42657
2019-06-13 12:05:20,245 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-13 12:05:20,245 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 35793
2019-06-13 12:05:20,248 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-13 12:05:20,248 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 43137
2019-06-13 12:05:20,251 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for scm at: http://0.0.0.0:0
2019-06-13 12:05:20,252 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:05:20,252 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:05:20,253 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:05:20,253 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context scm
2019-06-13 12:05:20,253 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:05:20,254 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:05:20,256 INFO  server.StorageContainerManager (StorageContainerManager.java:start(752)) - StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:43137
2019-06-13 12:05:20,256 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - StorageContainerManager metrics system started (again)
2019-06-13 12:05:20,256 INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:start(149)) - RPC server for Client  is listening at /0.0.0.0:43137
2019-06-13 12:05:20,257 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-13 12:05:20,260 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 43137: starting
2019-06-13 12:05:20,267 INFO  server.StorageContainerManager (StorageContainerManager.java:start(761)) - ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:35793
2019-06-13 12:05:20,268 INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:start(137)) - RPC server for Block Protocol is listening at /0.0.0.0:35793
2019-06-13 12:05:20,268 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-13 12:05:20,268 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 35793: starting
2019-06-13 12:05:20,271 INFO  server.StorageContainerManager (StorageContainerManager.java:start(765)) - ScmDatanodeProtocl RPC server is listening at /0.0.0.0:42657
2019-06-13 12:05:20,271 INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:start(191)) - RPC server for DataNodes is listening at /0.0.0.0:42657
2019-06-13 12:05:20,272 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-13 12:05:20,273 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 42657: starting
2019-06-13 12:05:20,275 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 46773
2019-06-13 12:05:20,276 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:05:20,276 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@64dc0a5f{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:05:20,277 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@537fb7bf{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-13 12:05:20,279 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@8eda949{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/scm/,AVAILABLE}{/scm}
2019-06-13 12:05:20,279 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@273c4b3{HTTP/1.1,[http/1.1]}{0.0.0.0:46773}
2019-06-13 12:05:20,284 INFO  server.Server (Server.java:doStart(419)) - Started @89505ms
2019-06-13 12:05:20,313 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of SCM is listening at http://0.0.0.0:46773
2019-06-13 12:05:20,313 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:05:20,314 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:05:20,316 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:05:20,317 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(519)) - OM Service ID is not set. Setting it to the default ID: omServiceIdDefault
2019-06-13 12:05:20,317 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(525)) - OM Node ID is not set. Setting it to the OmStorage's OmID: 026bb980-cd32-49ef-a70e-2b400641fcc4
2019-06-13 12:05:20,317 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 12:05:20,317 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 12:05:20,317 INFO  om.OzoneManager (OzoneManager.java:loadOMHAConfigs(476)) - Found matching OM address with OMServiceId: null, OMNodeId: null, RPC Address: localhost:0 and Ratis port: 9872
2019-06-13 12:05:20,339 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:05:20,340 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: userTable
2019-06-13 12:05:20,340 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:userTable
2019-06-13 12:05:20,340 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: volumeTable
2019-06-13 12:05:20,340 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:volumeTable
2019-06-13 12:05:20,341 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: bucketTable
2019-06-13 12:05:20,341 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:bucketTable
2019-06-13 12:05:20,341 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: keyTable
2019-06-13 12:05:20,341 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:keyTable
2019-06-13 12:05:20,341 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedTable
2019-06-13 12:05:20,341 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedTable
2019-06-13 12:05:20,342 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: openKeyTable
2019-06-13 12:05:20,342 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:openKeyTable
2019-06-13 12:05:20,342 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3Table
2019-06-13 12:05:20,342 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3Table
2019-06-13 12:05:20,342 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: multipartInfoTable
2019-06-13 12:05:20,343 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:multipartInfoTable
2019-06-13 12:05:20,343 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: dTokenTable
2019-06-13 12:05:20,343 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:dTokenTable
2019-06-13 12:05:20,343 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3SecretTable
2019-06-13 12:05:20,343 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3SecretTable
2019-06-13 12:05:20,343 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: prefixTable
2019-06-13 12:05:20,344 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:prefixTable
2019-06-13 12:05:20,344 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-13 12:05:20,344 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-13 12:05:20,344 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-13 12:05:20,477 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-13 12:05:20,478 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 33861
2019-06-13 12:05:20,498 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-13 12:05:20,498 INFO  om.OzoneManager (OzoneManager.java:start(1217)) - OzoneManager RPC server is listening at localhost/127.0.0.1:33861
2019-06-13 12:05:20,499 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - OzoneManager metrics system started (again)
2019-06-13 12:05:20,499 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-13 12:05:20,504 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 33861: starting
2019-06-13 12:05:20,518 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for ozoneManager at: http://0.0.0.0:0
2019-06-13 12:05:20,526 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:05:20,526 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:05:20,528 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:05:20,528 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context ozoneManager
2019-06-13 12:05:20,528 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:05:20,528 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:05:20,529 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 34877
2019-06-13 12:05:20,529 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:05:20,530 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@4c131823{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:05:20,531 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@68fb6c1e{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-13 12:05:20,533 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@2fedaa2e{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/ozoneManager/,AVAILABLE}{/ozoneManager}
2019-06-13 12:05:20,533 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@4203190{HTTP/1.1,[http/1.1]}{0.0.0.0:34877}
2019-06-13 12:05:20,535 INFO  server.Server (Server.java:doStart(419)) - Started @89756ms
2019-06-13 12:05:20,536 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of OZONEMANAGER is listening at http://0.0.0.0:34877
2019-06-13 12:05:20,546 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:05:20,546 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:05:20,554 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-0/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:05:20,554 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-0/data/containers/hdds to VolumeSet
2019-06-13 12:05:20,554 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@4adb2b87
2019-06-13 12:05:20,556 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@4adb2b87
2019-06-13 12:05:20,564 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 38057
2019-06-13 12:05:20,566 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:05:20,566 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 38057 (custom)
2019-06-13 12:05:20,567 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:05:20,567 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:20,567 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:05:20,567 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:20,567 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-0/data/ratis] (custom)
2019-06-13 12:05:20,568 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42039
2019-06-13 12:05:20,568 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:05:20,569 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:05:20,570 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:05:20,570 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:05:20,571 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:05:20,571 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:05:20,572 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:05:20,572 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:05:20,572 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 42933
2019-06-13 12:05:20,572 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:05:20,582 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@1aa7d66e{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:05:20,582 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@189f2184{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:05:20,608 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@1676e501{/,file:///tmp/jetty-0.0.0.0-42933-hddsDatanode-_-any-5341175128256881958.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:05:20,608 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@1ed763aa{HTTP/1.1,[http/1.1]}{0.0.0.0:42933}
2019-06-13 12:05:20,610 INFO  server.Server (Server.java:doStart(419)) - Started @89831ms
2019-06-13 12:05:20,611 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:42933
Jun 13, 2019 12:05:20 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:05:20,682 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@943d0c2
2019-06-13 12:05:20,683 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:05:20,683 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:05:20,686 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:05:20,689 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-0/meta/datanode.id
2019-06-13 12:05:20,692 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-1/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:05:20,692 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-1/data/containers/hdds to VolumeSet
2019-06-13 12:05:20,692 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@ae49f31
2019-06-13 12:05:20,694 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@ae49f31
2019-06-13 12:05:20,701 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43863
2019-06-13 12:05:20,703 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:05:20,704 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43863 (custom)
2019-06-13 12:05:20,704 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:05:20,704 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:20,704 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:05:20,704 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:20,705 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-1/data/ratis] (custom)
2019-06-13 12:05:20,705 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 46329
2019-06-13 12:05:20,705 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:05:20,706 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:05:20,708 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:05:20,708 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:05:20,709 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:05:20,709 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:05:20,710 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:05:20,710 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:05:20,710 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 37885
2019-06-13 12:05:20,710 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:05:20,714 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@218e28d9{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:05:20,716 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@28ec92c9{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:05:20,735 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@4e09c3b0{/,file:///tmp/jetty-0.0.0.0-37885-hddsDatanode-_-any-5723612348880789166.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:05:20,735 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@64f34c91{HTTP/1.1,[http/1.1]}{0.0.0.0:37885}
2019-06-13 12:05:20,737 INFO  server.Server (Server.java:doStart(419)) - Started @89958ms
2019-06-13 12:05:20,737 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:37885
Jun 13, 2019 12:05:20 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:05:20,806 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@495cac83
2019-06-13 12:05:20,807 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:05:20,807 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:05:20,810 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:05:20,815 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-2/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:05:20,815 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-1/meta/datanode.id
2019-06-13 12:05:20,815 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-2/data/containers/hdds to VolumeSet
2019-06-13 12:05:20,815 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1469015e
2019-06-13 12:05:20,815 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1469015e
2019-06-13 12:05:20,824 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43923
2019-06-13 12:05:20,826 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:05:20,827 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43923 (custom)
2019-06-13 12:05:20,827 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:05:20,827 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:20,827 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:05:20,827 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:20,827 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-2/data/ratis] (custom)
2019-06-13 12:05:20,828 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 43365
2019-06-13 12:05:20,828 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:05:20,829 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:05:20,830 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:05:20,830 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:05:20,831 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:05:20,831 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:05:20,832 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:05:20,832 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:05:20,832 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 44625
2019-06-13 12:05:20,832 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:05:20,833 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@56ed9270{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:05:20,833 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@6affa355{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:05:20,853 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@1e250539{/,file:///tmp/jetty-0.0.0.0-44625-hddsDatanode-_-any-4981139111336828257.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:05:20,853 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@5860e4c3{HTTP/1.1,[http/1.1]}{0.0.0.0:44625}
2019-06-13 12:05:20,855 INFO  server.Server (Server.java:doStart(419)) - Started @90076ms
2019-06-13 12:05:20,855 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:44625
Jun 13, 2019 12:05:20 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:05:20,893 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1159, electionTimeout:1159ms
2019-06-13 12:05:20,893 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:20,893 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 67 for changeToCandidate
2019-06-13 12:05:20,893 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:20,897 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection138: begin an election at term 68 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:20,897 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection138 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:20,898 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection138 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:20,898 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection138: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t68, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:20,898 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:20,898 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:20,898 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 68 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:20,898 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:20,899 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:20,927 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@6ca6cc1c
2019-06-13 12:05:20,928 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:05:20,928 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:05:20,928 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:05:20,929 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-2/meta/datanode.id
2019-06-13 12:05:20,934 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-3/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:05:20,934 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-3/data/containers/hdds to VolumeSet
2019-06-13 12:05:20,934 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@45295bed
2019-06-13 12:05:20,935 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@45295bed
2019-06-13 12:05:20,945 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43303
2019-06-13 12:05:20,947 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:05:20,947 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43303 (custom)
2019-06-13 12:05:20,947 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:05:20,947 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:20,947 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:05:20,947 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:20,948 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-3/data/ratis] (custom)
2019-06-13 12:05:20,948 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 38525
2019-06-13 12:05:20,948 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:05:20,949 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:05:20,950 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:05:20,950 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:05:20,951 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:05:20,951 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:05:20,951 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:05:20,951 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:05:20,952 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 38363
2019-06-13 12:05:20,952 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:05:20,953 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@1d2b49b2{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:05:20,953 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@d6d88b1{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:05:20,977 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@ab5e63{/,file:///tmp/jetty-0.0.0.0-38363-hddsDatanode-_-any-5913779429385688742.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:05:20,977 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@6a434cdd{HTTP/1.1,[http/1.1]}{0.0.0.0:38363}
2019-06-13 12:05:20,979 INFO  server.Server (Server.java:doStart(419)) - Started @90200ms
2019-06-13 12:05:20,980 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:38363
Jun 13, 2019 12:05:20 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:05:21,102 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@3c380db5
2019-06-13 12:05:21,103 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:05:21,103 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:05:21,108 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:05:21,109 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-3/meta/datanode.id
2019-06-13 12:05:21,121 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-4/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:05:21,122 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-4/data/containers/hdds to VolumeSet
2019-06-13 12:05:21,122 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@68226b59
2019-06-13 12:05:21,122 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@68226b59
2019-06-13 12:05:21,131 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 36861
2019-06-13 12:05:21,133 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:05:21,133 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 36861 (custom)
2019-06-13 12:05:21,133 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:05:21,133 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:21,134 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:05:21,134 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:21,134 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-4/data/ratis] (custom)
2019-06-13 12:05:21,134 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 46851
2019-06-13 12:05:21,135 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:05:21,135 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:05:21,136 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:05:21,137 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:05:21,138 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:05:21,138 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:05:21,138 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:05:21,138 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:05:21,139 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 45001
2019-06-13 12:05:21,139 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:05:21,139 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@18bd3135{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:05:21,140 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@6000ca67{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:05:21,159 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@4b20b431{/,file:///tmp/jetty-0.0.0.0-45001-hddsDatanode-_-any-1777160686018209136.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:05:21,159 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@46875fae{HTTP/1.1,[http/1.1]}{0.0.0.0:45001}
2019-06-13 12:05:21,161 INFO  server.Server (Server.java:doStart(419)) - Started @90382ms
2019-06-13 12:05:21,162 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:45001
Jun 13, 2019 12:05:21 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:05:21,232 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@15db4dc
2019-06-13 12:05:21,232 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:05:21,233 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:05:21,233 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:05:21,235 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-4/meta/datanode.id
2019-06-13 12:05:21,245 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-5/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:05:21,246 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-5/data/containers/hdds to VolumeSet
2019-06-13 12:05:21,246 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@fbb585e
2019-06-13 12:05:21,246 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@fbb585e
2019-06-13 12:05:21,257 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 37335
2019-06-13 12:05:21,259 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:05:21,259 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 37335 (custom)
2019-06-13 12:05:21,259 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:05:21,259 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:21,259 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:05:21,259 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:21,260 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-5/data/ratis] (custom)
2019-06-13 12:05:21,260 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 44237
2019-06-13 12:05:21,260 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:05:21,261 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:05:21,262 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:05:21,263 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:05:21,264 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:05:21,264 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:05:21,264 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:05:21,264 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:05:21,265 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 43813
2019-06-13 12:05:21,265 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:05:21,274 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@37ddb835{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:05:21,274 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@67f8586f{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:05:21,294 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@75edfe9a{/,file:///tmp/jetty-0.0.0.0-43813-hddsDatanode-_-any-277898378368518196.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:05:21,294 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@468d1fcc{HTTP/1.1,[http/1.1]}{0.0.0.0:43813}
2019-06-13 12:05:21,296 INFO  server.Server (Server.java:doStart(419)) - Started @90517ms
2019-06-13 12:05:21,297 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:43813
Jun 13, 2019 12:05:21 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:05:21,386 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@3c251258
2019-06-13 12:05:21,386 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-13 12:05:21,386 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-nffxw-186015654 ip:192.168.46.58
2019-06-13 12:05:21,387 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:05:21,388 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-5/meta/datanode.id
2019-06-13 12:05:21,398 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-6/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 12:05:21,398 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-6/data/containers/hdds to VolumeSet
2019-06-13 12:05:21,398 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@4420f4d4
2019-06-13 12:05:21,399 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@4420f4d4
2019-06-13 12:05:21,407 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 38467
2019-06-13 12:05:21,409 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 12:05:21,410 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 38467 (custom)
2019-06-13 12:05:21,410 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 12:05:21,410 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:21,410 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 12:05:21,410 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:21,410 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-6/data/ratis] (custom)
2019-06-13 12:05:21,411 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 33133
2019-06-13 12:05:21,411 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-13 12:05:21,412 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-13 12:05:21,412 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-13 12:05:21,413 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-13 12:05:21,413 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-13 12:05:21,414 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-13 12:05:21,414 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-13 12:05:21,414 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-13 12:05:21,414 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 38003
2019-06-13 12:05:21,414 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-13 12:05:21,415 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@76737130{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-13 12:05:21,416 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@6f2a13c7{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-13 12:05:21,435 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@34ccce55{/,file:///tmp/jetty-0.0.0.0-38003-hddsDatanode-_-any-5500838835865536049.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-13 12:05:21,435 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@7668edd7{HTTP/1.1,[http/1.1]}{0.0.0.0:38003}
2019-06-13 12:05:21,437 INFO  server.Server (Server.java:doStart(419)) - Started @90658ms
2019-06-13 12:05:21,438 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:38003
Jun 13, 2019 12:05:21 PM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-13 12:05:21,515 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@8d56ddd
2019-06-13 12:05:21,515 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 7 DN Heartbeats.
2019-06-13 12:05:21,516 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-13 12:05:21,517 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-6/meta/datanode.id
2019-06-13 12:05:21,901 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1002, electionTimeout:1002ms
2019-06-13 12:05:21,901 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:21,901 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 68 for changeToCandidate
2019-06-13 12:05:21,901 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:21,905 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection139: begin an election at term 69 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:21,905 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection139 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:21,906 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection139 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:21,906 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection139: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t69, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:21,906 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:21,906 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:21,906 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 69 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:21,906 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:21,906 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:22,516 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 7 DN Heartbeats.
2019-06-13 12:05:22,697 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:05:22,697 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:05:22,698 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61 at port 38057
2019-06-13 12:05:22,701 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: start RPC server
2019-06-13 12:05:22,701 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: GrpcService started, listening on 0.0.0.0/0.0.0.0:38057
2019-06-13 12:05:22,814 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:05:22,814 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:05:22,814 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 55566cff-d44d-47a7-b1c0-6ce92a96f3a6 at port 43863
2019-06-13 12:05:22,817 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: start RPC server
2019-06-13 12:05:22,818 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: GrpcService started, listening on 0.0.0.0/0.0.0.0:43863
2019-06-13 12:05:22,930 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:05:22,931 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:05:22,931 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 48f36a94-371b-4174-8c44-5029e9e379a6 at port 43923
2019-06-13 12:05:22,934 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 48f36a94-371b-4174-8c44-5029e9e379a6: start RPC server
2019-06-13 12:05:22,934 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 48f36a94-371b-4174-8c44-5029e9e379a6: GrpcService started, listening on 0.0.0.0/0.0.0.0:43923
2019-06-13 12:05:23,067 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1161, electionTimeout:1161ms
2019-06-13 12:05:23,068 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:23,068 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 69 for changeToCandidate
2019-06-13 12:05:23,068 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:23,070 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection140: begin an election at term 70 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:23,071 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection140 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:23,071 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection140 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:23,071 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection140: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t70, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:23,071 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:23,071 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:23,071 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 70 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:23,071 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:23,071 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:23,110 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:05:23,110 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:05:23,110 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 88174b5b-fd1f-4cea-9b56-69296f3acc88 at port 43303
2019-06-13 12:05:23,114 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: start RPC server
2019-06-13 12:05:23,114 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: GrpcService started, listening on 0.0.0.0/0.0.0.0:43303
2019-06-13 12:05:23,236 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:05:23,236 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:05:23,236 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 3a90ff6a-d0a9-4724-8345-0dec5ca47bac at port 36861
2019-06-13 12:05:23,239 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: start RPC server
2019-06-13 12:05:23,239 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: GrpcService started, listening on 0.0.0.0/0.0.0.0:36861
2019-06-13 12:05:23,389 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:05:23,389 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:05:23,389 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 248dcd6e-823e-4191-89f9-052df67b349c at port 37335
2019-06-13 12:05:23,393 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 248dcd6e-823e-4191-89f9-052df67b349c: start RPC server
2019-06-13 12:05:23,393 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 248dcd6e-823e-4191-89f9-052df67b349c: GrpcService started, listening on 0.0.0.0/0.0.0.0:37335
2019-06-13 12:05:23,516 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 7 DN Heartbeats.
2019-06-13 12:05:23,519 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 12:05:23,519 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 12:05:23,519 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 249b284e-4f6e-49ae-a42c-bd46086d3184 at port 38467
2019-06-13 12:05:23,522 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 249b284e-4f6e-49ae-a42c-bd46086d3184: start RPC server
2019-06-13 12:05:23,522 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 249b284e-4f6e-49ae-a42c-bd46086d3184: GrpcService started, listening on 0.0.0.0/0.0.0.0:38467
2019-06-13 12:05:24,136 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1064, electionTimeout:1064ms
2019-06-13 12:05:24,136 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:24,136 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 70 for changeToCandidate
2019-06-13 12:05:24,136 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:24,139 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection141: begin an election at term 71 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:24,139 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection141 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:24,139 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection141 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:24,140 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection141: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t71, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:24,140 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:24,140 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:24,140 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 71 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:24,140 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:24,140 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:24,516 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 7 DN Heartbeats.
2019-06-13 12:05:24,690 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:05:24,694 INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 1 DataNodes registered, 1 required.
2019-06-13 12:05:24,696 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(177)) - ScmSafeModeManager, all rules are successfully validated
2019-06-13 12:05:24,706 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:exitSafeMode(193)) - SCM exiting safe mode.
2019-06-13 12:05:24,711 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: addNew group-DEC35D8CD16F:[b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:192.168.46.58:38057] returns group-DEC35D8CD16F:java.util.concurrent.CompletableFuture@5c375292[Not completed]
2019-06-13 12:05:24,711 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: new RaftServerImpl for group-DEC35D8CD16F:[b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:192.168.46.58:38057] with ContainerStateMachine:uninitialized
2019-06-13 12:05:24,711 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:24,711 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:24,711 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:24,711 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:24,711 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:group-DEC35D8CD16F ConfigurationManager, init=-1: [b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:192.168.46.58:38057], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:24,711 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-0/data/ratis] (custom)
2019-06-13 12:05:24,712 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-0/data/ratis/43ef6c20-3c8c-400a-9027-dec35d8cd16f does not exist. Creating ...
2019-06-13 12:05:24,714 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-0/data/ratis/43ef6c20-3c8c-400a-9027-dec35d8cd16f/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:24,716 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-0/data/ratis/43ef6c20-3c8c-400a-9027-dec35d8cd16f has been successfully formatted.
2019-06-13 12:05:24,716 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:24,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:24,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:24,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:24,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:24,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:24,717 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-0/data/ratis/43ef6c20-3c8c-400a-9027-dec35d8cd16f
2019-06-13 12:05:24,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:24,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:24,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:24,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:24,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:24,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:24,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:24,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:24,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:24,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:24,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:24,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:24,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:24,718 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: start group-DEC35D8CD16F
2019-06-13 12:05:24,718 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:group-DEC35D8CD16F changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:24,718 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: start FollowerState
2019-06-13 12:05:24,718 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-DEC35D8CD16F,id=b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61
2019-06-13 12:05:24,720 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 43ef6c20-3c8c-400a-9027-dec35d8cd16f, Nodes: b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:05:24,811 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 55566cff-d44d-47a7-b1c0-6ce92a96f3a6{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:05:24,818 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: addNew group-5C785342D8EF:[55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863] returns group-5C785342D8EF:java.util.concurrent.CompletableFuture@4a8e021f[Not completed]
2019-06-13 12:05:24,823 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: new RaftServerImpl for group-5C785342D8EF:[55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863] with ContainerStateMachine:uninitialized
2019-06-13 12:05:24,823 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:24,823 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:24,823 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:24,823 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:24,823 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:group-5C785342D8EF ConfigurationManager, init=-1: [55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:24,823 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-1/data/ratis] (custom)
2019-06-13 12:05:24,824 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-1/data/ratis/b4d5eb45-e1c0-4307-a173-5c785342d8ef does not exist. Creating ...
2019-06-13 12:05:24,826 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-1/data/ratis/b4d5eb45-e1c0-4307-a173-5c785342d8ef/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:24,829 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-1/data/ratis/b4d5eb45-e1c0-4307-a173-5c785342d8ef has been successfully formatted.
2019-06-13 12:05:24,829 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:24,829 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:24,829 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:24,829 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:24,829 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:24,829 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:24,829 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 55566cff-d44d-47a7-b1c0-6ce92a96f3a6-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-1/data/ratis/b4d5eb45-e1c0-4307-a173-5c785342d8ef
2019-06-13 12:05:24,829 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:24,829 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:24,829 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:24,829 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:24,830 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:24,830 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:24,830 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:24,830 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:24,830 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:24,830 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:24,833 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:24,833 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:24,834 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:24,834 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: start group-5C785342D8EF
2019-06-13 12:05:24,834 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:group-5C785342D8EF changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:24,834 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: start FollowerState
2019-06-13 12:05:24,834 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-5C785342D8EF,id=55566cff-d44d-47a7-b1c0-6ce92a96f3a6
2019-06-13 12:05:24,842 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: b4d5eb45-e1c0-4307-a173-5c785342d8ef, Nodes: 55566cff-d44d-47a7-b1c0-6ce92a96f3a6{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:05:24,929 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 48f36a94-371b-4174-8c44-5029e9e379a6{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:05:24,937 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 48f36a94-371b-4174-8c44-5029e9e379a6: addNew group-298DB830AEE2:[48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923] returns group-298DB830AEE2:java.util.concurrent.CompletableFuture@4662f281[Not completed]
2019-06-13 12:05:24,937 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 48f36a94-371b-4174-8c44-5029e9e379a6: new RaftServerImpl for group-298DB830AEE2:[48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923] with ContainerStateMachine:uninitialized
2019-06-13 12:05:24,937 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:24,937 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:24,937 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:24,937 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:24,938 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 48f36a94-371b-4174-8c44-5029e9e379a6:group-298DB830AEE2 ConfigurationManager, init=-1: [48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:24,938 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-2/data/ratis] (custom)
2019-06-13 12:05:24,938 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-2/data/ratis/78316cb9-1052-4aeb-91d9-298db830aee2 does not exist. Creating ...
2019-06-13 12:05:24,941 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-2/data/ratis/78316cb9-1052-4aeb-91d9-298db830aee2/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:24,943 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-2/data/ratis/78316cb9-1052-4aeb-91d9-298db830aee2 has been successfully formatted.
2019-06-13 12:05:24,943 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:24,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:24,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:24,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:24,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:24,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:24,944 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 48f36a94-371b-4174-8c44-5029e9e379a6-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-2/data/ratis/78316cb9-1052-4aeb-91d9-298db830aee2
2019-06-13 12:05:24,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:24,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:24,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:24,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:24,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:24,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:24,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:24,945 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:24,945 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:24,945 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:24,945 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:24,945 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:24,945 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:24,945 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 48f36a94-371b-4174-8c44-5029e9e379a6: start group-298DB830AEE2
2019-06-13 12:05:24,945 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 48f36a94-371b-4174-8c44-5029e9e379a6:group-298DB830AEE2 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:24,946 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 48f36a94-371b-4174-8c44-5029e9e379a6: start FollowerState
2019-06-13 12:05:24,946 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-298DB830AEE2,id=48f36a94-371b-4174-8c44-5029e9e379a6
2019-06-13 12:05:24,952 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 78316cb9-1052-4aeb-91d9-298db830aee2, Nodes: 48f36a94-371b-4174-8c44-5029e9e379a6{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:05:25,014 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 48f36a94-371b-4174-8c44-5029e9e379a6: addNew group-D00CC5095A50:[48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923, 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863, b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:192.168.46.58:38057] returns group-D00CC5095A50:java.util.concurrent.CompletableFuture@3ce1e1ce[Not completed]
2019-06-13 12:05:25,014 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: addNew group-D00CC5095A50:[48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923, 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863, b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:192.168.46.58:38057] returns group-D00CC5095A50:java.util.concurrent.CompletableFuture@2f52af1c[Not completed]
2019-06-13 12:05:25,017 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 48f36a94-371b-4174-8c44-5029e9e379a6: new RaftServerImpl for group-D00CC5095A50:[48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923, 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863, b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:192.168.46.58:38057] with ContainerStateMachine:uninitialized
2019-06-13 12:05:25,017 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:25,018 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:25,018 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:25,018 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:25,018 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: new RaftServerImpl for group-D00CC5095A50:[48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923, 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863, b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:192.168.46.58:38057] with ContainerStateMachine:uninitialized
2019-06-13 12:05:25,018 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 48f36a94-371b-4174-8c44-5029e9e379a6:group-D00CC5095A50 ConfigurationManager, init=-1: [48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923, 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863, b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:192.168.46.58:38057], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:25,018 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-2/data/ratis] (custom)
2019-06-13 12:05:25,018 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-2/data/ratis/321ab366-c2b2-4716-9801-d00cc5095a50 does not exist. Creating ...
2019-06-13 12:05:25,018 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:25,019 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:25,019 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:25,019 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:25,019 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:group-D00CC5095A50 ConfigurationManager, init=-1: [48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923, 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863, b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:192.168.46.58:38057], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:25,019 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-1/data/ratis] (custom)
2019-06-13 12:05:25,019 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-1/data/ratis/321ab366-c2b2-4716-9801-d00cc5095a50 does not exist. Creating ...
2019-06-13 12:05:25,018 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: new RaftServerImpl for group-D00CC5095A50:[48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923, 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863, b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:192.168.46.58:38057] with ContainerStateMachine:uninitialized
2019-06-13 12:05:25,020 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:25,020 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:25,020 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:25,020 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:25,020 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:group-D00CC5095A50 ConfigurationManager, init=-1: [48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923, 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863, b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:192.168.46.58:38057], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:25,020 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-0/data/ratis] (custom)
2019-06-13 12:05:25,018 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: addNew group-D00CC5095A50:[48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923, 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863, b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:192.168.46.58:38057] returns group-D00CC5095A50:java.util.concurrent.CompletableFuture@62dacb9a[Not completed]
2019-06-13 12:05:25,020 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-0/data/ratis/321ab366-c2b2-4716-9801-d00cc5095a50 does not exist. Creating ...
2019-06-13 12:05:25,021 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-2/data/ratis/321ab366-c2b2-4716-9801-d00cc5095a50/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:25,024 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-1/data/ratis/321ab366-c2b2-4716-9801-d00cc5095a50/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:25,024 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-0/data/ratis/321ab366-c2b2-4716-9801-d00cc5095a50/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:25,026 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-1/data/ratis/321ab366-c2b2-4716-9801-d00cc5095a50 has been successfully formatted.
2019-06-13 12:05:25,026 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-2/data/ratis/321ab366-c2b2-4716-9801-d00cc5095a50 has been successfully formatted.
2019-06-13 12:05:25,026 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:25,026 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:25,027 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:25,027 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:25,027 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:25,027 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:25,027 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:25,027 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 48f36a94-371b-4174-8c44-5029e9e379a6-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-2/data/ratis/321ab366-c2b2-4716-9801-d00cc5095a50
2019-06-13 12:05:25,027 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:25,027 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:25,027 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:25,027 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:25,027 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:25,027 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:25,028 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:25,028 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:25,028 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:25,028 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:25,026 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-0/data/ratis/321ab366-c2b2-4716-9801-d00cc5095a50 has been successfully formatted.
2019-06-13 12:05:25,028 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:25,028 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:25,028 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:25,029 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:25,029 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:25,029 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:25,029 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-0/data/ratis/321ab366-c2b2-4716-9801-d00cc5095a50
2019-06-13 12:05:25,029 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:25,029 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:25,029 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:25,029 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:25,029 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:25,029 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:25,029 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:25,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:25,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:25,026 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:25,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:25,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:25,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:25,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:25,030 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 55566cff-d44d-47a7-b1c0-6ce92a96f3a6-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-1/data/ratis/321ab366-c2b2-4716-9801-d00cc5095a50
2019-06-13 12:05:25,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:25,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:25,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:25,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:25,031 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:25,031 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:25,031 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:25,031 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:25,031 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:25,031 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:25,031 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:25,031 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:25,031 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:25,032 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:25,032 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:25,032 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:25,032 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: start group-D00CC5095A50
2019-06-13 12:05:25,032 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:group-D00CC5095A50 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:25,032 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: start FollowerState
2019-06-13 12:05:25,032 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:25,032 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:25,033 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:25,033 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D00CC5095A50,id=b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61
2019-06-13 12:05:25,033 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:25,033 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 48f36a94-371b-4174-8c44-5029e9e379a6: start group-D00CC5095A50
2019-06-13 12:05:25,033 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 48f36a94-371b-4174-8c44-5029e9e379a6:group-D00CC5095A50 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:25,033 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: start group-D00CC5095A50
2019-06-13 12:05:25,033 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:group-D00CC5095A50 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:25,033 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 48f36a94-371b-4174-8c44-5029e9e379a6: start FollowerState
2019-06-13 12:05:25,033 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: start FollowerState
2019-06-13 12:05:25,047 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D00CC5095A50,id=55566cff-d44d-47a7-b1c0-6ce92a96f3a6
2019-06-13 12:05:25,049 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D00CC5095A50,id=48f36a94-371b-4174-8c44-5029e9e379a6
2019-06-13 12:05:25,058 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 321ab366-c2b2-4716-9801-d00cc5095a50, Nodes: 48f36a94-371b-4174-8c44-5029e9e379a6{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}55566cff-d44d-47a7-b1c0-6ce92a96f3a6{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-13 12:05:25,109 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 88174b5b-fd1f-4cea-9b56-69296f3acc88{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:05:25,116 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: addNew group-25516534BD90:[88174b5b-fd1f-4cea-9b56-69296f3acc88:192.168.46.58:43303] returns group-25516534BD90:java.util.concurrent.CompletableFuture@18b4032b[Not completed]
2019-06-13 12:05:25,116 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: new RaftServerImpl for group-25516534BD90:[88174b5b-fd1f-4cea-9b56-69296f3acc88:192.168.46.58:43303] with ContainerStateMachine:uninitialized
2019-06-13 12:05:25,116 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:25,116 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:25,116 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:25,116 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:25,116 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88:group-25516534BD90 ConfigurationManager, init=-1: [88174b5b-fd1f-4cea-9b56-69296f3acc88:192.168.46.58:43303], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:25,116 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-3/data/ratis] (custom)
2019-06-13 12:05:25,117 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-3/data/ratis/31b90607-0d4c-4b25-92ce-25516534bd90 does not exist. Creating ...
2019-06-13 12:05:25,119 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-3/data/ratis/31b90607-0d4c-4b25-92ce-25516534bd90/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:25,121 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-3/data/ratis/31b90607-0d4c-4b25-92ce-25516534bd90 has been successfully formatted.
2019-06-13 12:05:25,121 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:25,121 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:25,121 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:25,121 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:25,121 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:25,121 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:25,121 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 88174b5b-fd1f-4cea-9b56-69296f3acc88-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-3/data/ratis/31b90607-0d4c-4b25-92ce-25516534bd90
2019-06-13 12:05:25,121 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:25,122 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:25,122 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:25,122 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:25,122 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:25,122 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:25,122 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:25,122 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:25,122 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:25,122 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:25,122 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:25,122 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:25,122 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:25,123 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: start group-25516534BD90
2019-06-13 12:05:25,123 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88:group-25516534BD90 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:25,123 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: start FollowerState
2019-06-13 12:05:25,123 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-25516534BD90,id=88174b5b-fd1f-4cea-9b56-69296f3acc88
2019-06-13 12:05:25,124 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 31b90607-0d4c-4b25-92ce-25516534bd90, Nodes: 88174b5b-fd1f-4cea-9b56-69296f3acc88{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:05:25,197 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1057, electionTimeout:1057ms
2019-06-13 12:05:25,197 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:25,197 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 71 for changeToCandidate
2019-06-13 12:05:25,197 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:25,200 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection142: begin an election at term 72 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:25,200 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection142 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:25,201 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection142 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:25,201 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection142: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t72, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:25,201 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:25,201 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:25,201 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 72 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:25,201 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:25,201 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:25,233 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 3a90ff6a-d0a9-4724-8345-0dec5ca47bac{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:05:25,239 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: addNew group-8CC7247B1F04:[3a90ff6a-d0a9-4724-8345-0dec5ca47bac:192.168.46.58:36861] returns group-8CC7247B1F04:java.util.concurrent.CompletableFuture@32487b85[Not completed]
2019-06-13 12:05:25,240 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: new RaftServerImpl for group-8CC7247B1F04:[3a90ff6a-d0a9-4724-8345-0dec5ca47bac:192.168.46.58:36861] with ContainerStateMachine:uninitialized
2019-06-13 12:05:25,240 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:25,240 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:25,240 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:25,240 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:25,240 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:group-8CC7247B1F04 ConfigurationManager, init=-1: [3a90ff6a-d0a9-4724-8345-0dec5ca47bac:192.168.46.58:36861], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:25,240 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-4/data/ratis] (custom)
2019-06-13 12:05:25,240 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-4/data/ratis/dee2146a-c698-42b5-8150-8cc7247b1f04 does not exist. Creating ...
2019-06-13 12:05:25,242 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-4/data/ratis/dee2146a-c698-42b5-8150-8cc7247b1f04/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:25,244 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-4/data/ratis/dee2146a-c698-42b5-8150-8cc7247b1f04 has been successfully formatted.
2019-06-13 12:05:25,244 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:25,244 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:25,244 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:25,244 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:25,245 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:25,245 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:25,245 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 3a90ff6a-d0a9-4724-8345-0dec5ca47bac-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-4/data/ratis/dee2146a-c698-42b5-8150-8cc7247b1f04
2019-06-13 12:05:25,245 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:25,245 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:25,245 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:25,245 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:25,245 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:25,245 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:25,245 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:25,245 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:25,245 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:25,245 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:25,246 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:25,246 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:25,246 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:25,246 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: start group-8CC7247B1F04
2019-06-13 12:05:25,246 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:group-8CC7247B1F04 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:25,246 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: start FollowerState
2019-06-13 12:05:25,246 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-8CC7247B1F04,id=3a90ff6a-d0a9-4724-8345-0dec5ca47bac
2019-06-13 12:05:25,250 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: dee2146a-c698-42b5-8150-8cc7247b1f04, Nodes: 3a90ff6a-d0a9-4724-8345-0dec5ca47bac{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:05:25,388 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 248dcd6e-823e-4191-89f9-052df67b349c{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:05:25,402 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 248dcd6e-823e-4191-89f9-052df67b349c: addNew group-8689413AF23C:[248dcd6e-823e-4191-89f9-052df67b349c:192.168.46.58:37335] returns group-8689413AF23C:java.util.concurrent.CompletableFuture@43d5cedd[Not completed]
2019-06-13 12:05:25,402 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 248dcd6e-823e-4191-89f9-052df67b349c: new RaftServerImpl for group-8689413AF23C:[248dcd6e-823e-4191-89f9-052df67b349c:192.168.46.58:37335] with ContainerStateMachine:uninitialized
2019-06-13 12:05:25,402 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:25,402 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:25,402 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:25,402 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:25,402 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 248dcd6e-823e-4191-89f9-052df67b349c:group-8689413AF23C ConfigurationManager, init=-1: [248dcd6e-823e-4191-89f9-052df67b349c:192.168.46.58:37335], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:25,403 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-5/data/ratis] (custom)
2019-06-13 12:05:25,403 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-5/data/ratis/be266fff-34e8-4441-9a24-8689413af23c does not exist. Creating ...
2019-06-13 12:05:25,405 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-5/data/ratis/be266fff-34e8-4441-9a24-8689413af23c/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:25,406 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-5/data/ratis/be266fff-34e8-4441-9a24-8689413af23c has been successfully formatted.
2019-06-13 12:05:25,407 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:25,407 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:25,407 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:25,407 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:25,407 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:25,407 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:25,407 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 248dcd6e-823e-4191-89f9-052df67b349c-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-5/data/ratis/be266fff-34e8-4441-9a24-8689413af23c
2019-06-13 12:05:25,407 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:25,407 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:25,407 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:25,407 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:25,407 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:25,407 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:25,407 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:25,408 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:25,408 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:25,408 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:25,408 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:25,408 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:25,408 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:25,408 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 248dcd6e-823e-4191-89f9-052df67b349c: start group-8689413AF23C
2019-06-13 12:05:25,408 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 248dcd6e-823e-4191-89f9-052df67b349c:group-8689413AF23C changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:25,408 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 248dcd6e-823e-4191-89f9-052df67b349c: start FollowerState
2019-06-13 12:05:25,409 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-8689413AF23C,id=248dcd6e-823e-4191-89f9-052df67b349c
2019-06-13 12:05:25,411 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: be266fff-34e8-4441-9a24-8689413af23c, Nodes: 248dcd6e-823e-4191-89f9-052df67b349c{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:05:25,422 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: addNew group-365436E4D925:[88174b5b-fd1f-4cea-9b56-69296f3acc88:192.168.46.58:43303, 248dcd6e-823e-4191-89f9-052df67b349c:192.168.46.58:37335, 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:192.168.46.58:36861] returns group-365436E4D925:java.util.concurrent.CompletableFuture@49130035[Not completed]
2019-06-13 12:05:25,422 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: new RaftServerImpl for group-365436E4D925:[88174b5b-fd1f-4cea-9b56-69296f3acc88:192.168.46.58:43303, 248dcd6e-823e-4191-89f9-052df67b349c:192.168.46.58:37335, 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:192.168.46.58:36861] with ContainerStateMachine:uninitialized
2019-06-13 12:05:25,422 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:25,422 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:25,422 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:25,422 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:25,423 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88:group-365436E4D925 ConfigurationManager, init=-1: [88174b5b-fd1f-4cea-9b56-69296f3acc88:192.168.46.58:43303, 248dcd6e-823e-4191-89f9-052df67b349c:192.168.46.58:37335, 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:192.168.46.58:36861], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:25,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-3/data/ratis] (custom)
2019-06-13 12:05:25,423 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-3/data/ratis/979d935f-f9c6-4c6d-8f36-365436e4d925 does not exist. Creating ...
2019-06-13 12:05:25,423 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: addNew group-365436E4D925:[88174b5b-fd1f-4cea-9b56-69296f3acc88:192.168.46.58:43303, 248dcd6e-823e-4191-89f9-052df67b349c:192.168.46.58:37335, 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:192.168.46.58:36861] returns group-365436E4D925:java.util.concurrent.CompletableFuture@5456ece0[Not completed]
2019-06-13 12:05:25,423 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: new RaftServerImpl for group-365436E4D925:[88174b5b-fd1f-4cea-9b56-69296f3acc88:192.168.46.58:43303, 248dcd6e-823e-4191-89f9-052df67b349c:192.168.46.58:37335, 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:192.168.46.58:36861] with ContainerStateMachine:uninitialized
2019-06-13 12:05:25,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:25,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:25,426 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 248dcd6e-823e-4191-89f9-052df67b349c: addNew group-365436E4D925:[88174b5b-fd1f-4cea-9b56-69296f3acc88:192.168.46.58:43303, 248dcd6e-823e-4191-89f9-052df67b349c:192.168.46.58:37335, 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:192.168.46.58:36861] returns group-365436E4D925:java.util.concurrent.CompletableFuture@567fad6f[Not completed]
2019-06-13 12:05:25,426 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-3/data/ratis/979d935f-f9c6-4c6d-8f36-365436e4d925/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:25,426 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:25,427 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 248dcd6e-823e-4191-89f9-052df67b349c: new RaftServerImpl for group-365436E4D925:[88174b5b-fd1f-4cea-9b56-69296f3acc88:192.168.46.58:43303, 248dcd6e-823e-4191-89f9-052df67b349c:192.168.46.58:37335, 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:192.168.46.58:36861] with ContainerStateMachine:uninitialized
2019-06-13 12:05:25,427 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:25,427 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:25,427 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:group-365436E4D925 ConfigurationManager, init=-1: [88174b5b-fd1f-4cea-9b56-69296f3acc88:192.168.46.58:43303, 248dcd6e-823e-4191-89f9-052df67b349c:192.168.46.58:37335, 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:192.168.46.58:36861], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:25,427 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:25,427 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-4/data/ratis] (custom)
2019-06-13 12:05:25,427 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:25,427 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:25,427 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-4/data/ratis/979d935f-f9c6-4c6d-8f36-365436e4d925 does not exist. Creating ...
2019-06-13 12:05:25,427 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 248dcd6e-823e-4191-89f9-052df67b349c:group-365436E4D925 ConfigurationManager, init=-1: [88174b5b-fd1f-4cea-9b56-69296f3acc88:192.168.46.58:43303, 248dcd6e-823e-4191-89f9-052df67b349c:192.168.46.58:37335, 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:192.168.46.58:36861], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:25,428 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-5/data/ratis] (custom)
2019-06-13 12:05:25,428 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-5/data/ratis/979d935f-f9c6-4c6d-8f36-365436e4d925 does not exist. Creating ...
2019-06-13 12:05:25,429 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-3/data/ratis/979d935f-f9c6-4c6d-8f36-365436e4d925 has been successfully formatted.
2019-06-13 12:05:25,429 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:25,429 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:25,429 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:25,429 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:25,429 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:25,429 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:25,429 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 88174b5b-fd1f-4cea-9b56-69296f3acc88-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-3/data/ratis/979d935f-f9c6-4c6d-8f36-365436e4d925
2019-06-13 12:05:25,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:25,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:25,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:25,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:25,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:25,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:25,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:25,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:25,430 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-5/data/ratis/979d935f-f9c6-4c6d-8f36-365436e4d925/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:25,430 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-4/data/ratis/979d935f-f9c6-4c6d-8f36-365436e4d925/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:25,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:25,433 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-5/data/ratis/979d935f-f9c6-4c6d-8f36-365436e4d925 has been successfully formatted.
2019-06-13 12:05:25,433 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:25,433 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-4/data/ratis/979d935f-f9c6-4c6d-8f36-365436e4d925 has been successfully formatted.
2019-06-13 12:05:25,433 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:25,433 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:25,433 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:25,433 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:25,433 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:25,433 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:25,433 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:25,433 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:25,434 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 3a90ff6a-d0a9-4724-8345-0dec5ca47bac-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-4/data/ratis/979d935f-f9c6-4c6d-8f36-365436e4d925
2019-06-13 12:05:25,433 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:25,434 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:25,434 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:25,434 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:25,434 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:25,434 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:25,434 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:25,434 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:25,434 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: start group-365436E4D925
2019-06-13 12:05:25,434 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:25,434 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88:group-365436E4D925 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:25,434 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:25,434 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: start FollowerState
2019-06-13 12:05:25,434 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:25,434 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:25,435 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:25,435 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-365436E4D925,id=88174b5b-fd1f-4cea-9b56-69296f3acc88
2019-06-13 12:05:25,435 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:25,435 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:25,435 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:25,435 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:25,435 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 248dcd6e-823e-4191-89f9-052df67b349c-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-5/data/ratis/979d935f-f9c6-4c6d-8f36-365436e4d925
2019-06-13 12:05:25,435 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:25,435 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:25,435 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:25,436 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:25,436 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:25,436 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:25,436 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:25,437 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:25,437 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:25,440 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:25,440 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:25,440 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:25,440 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:25,440 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:25,440 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:25,440 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: start group-365436E4D925
2019-06-13 12:05:25,440 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:group-365436E4D925 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:25,440 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:25,441 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: start FollowerState
2019-06-13 12:05:25,441 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 248dcd6e-823e-4191-89f9-052df67b349c: start group-365436E4D925
2019-06-13 12:05:25,441 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 248dcd6e-823e-4191-89f9-052df67b349c:group-365436E4D925 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:25,441 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 248dcd6e-823e-4191-89f9-052df67b349c: start FollowerState
2019-06-13 12:05:25,451 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-365436E4D925,id=3a90ff6a-d0a9-4724-8345-0dec5ca47bac
2019-06-13 12:05:25,452 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-365436E4D925,id=248dcd6e-823e-4191-89f9-052df67b349c
2019-06-13 12:05:25,462 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 979d935f-f9c6-4c6d-8f36-365436e4d925, Nodes: 88174b5b-fd1f-4cea-9b56-69296f3acc88{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}3a90ff6a-d0a9-4724-8345-0dec5ca47bac{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}248dcd6e-823e-4191-89f9-052df67b349c{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-13 12:05:25,516 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 249b284e-4f6e-49ae-a42c-bd46086d3184{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}
2019-06-13 12:05:25,516 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Cluster is ready. Got 7 of 7 DN Heartbeats.
2019-06-13 12:05:25,529 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 249b284e-4f6e-49ae-a42c-bd46086d3184: addNew group-C9077D0202A9:[249b284e-4f6e-49ae-a42c-bd46086d3184:192.168.46.58:38467] returns group-C9077D0202A9:java.util.concurrent.CompletableFuture@42ba3d5a[Not completed]
2019-06-13 12:05:25,534 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 249b284e-4f6e-49ae-a42c-bd46086d3184: new RaftServerImpl for group-C9077D0202A9:[249b284e-4f6e-49ae-a42c-bd46086d3184:192.168.46.58:38467] with ContainerStateMachine:uninitialized
2019-06-13 12:05:25,534 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 12:05:25,534 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 12:05:25,534 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 12:05:25,534 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:25,546 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 249b284e-4f6e-49ae-a42c-bd46086d3184:group-C9077D0202A9 ConfigurationManager, init=-1: [249b284e-4f6e-49ae-a42c-bd46086d3184:192.168.46.58:38467], old=null, confs=<EMPTY_MAP>
2019-06-13 12:05:25,547 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-6/data/ratis] (custom)
2019-06-13 12:05:25,547 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-6/data/ratis/fb2d82af-052a-40a2-bbe3-c9077d0202a9 does not exist. Creating ...
2019-06-13 12:05:25,554 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-6/data/ratis/fb2d82af-052a-40a2-bbe3-c9077d0202a9/in_use.lock acquired by nodename 6420@ozone-nffxw-186015654
2019-06-13 12:05:25,560 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-6/data/ratis/fb2d82af-052a-40a2-bbe3-c9077d0202a9 has been successfully formatted.
2019-06-13 12:05:25,561 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 12:05:25,561 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 12:05:25,561 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 12:05:25,561 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:25,561 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:25,561 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 12:05:25,561 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 249b284e-4f6e-49ae-a42c-bd46086d3184-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-6/data/ratis/fb2d82af-052a-40a2-bbe3-c9077d0202a9
2019-06-13 12:05:25,561 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 12:05:25,561 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 12:05:25,561 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 12:05:25,561 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 12:05:25,561 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 12:05:25,561 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 12:05:25,561 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 12:05:25,561 INFO  rpc.RpcClient (RpcClient.java:createVolume(289)) - Creating Volume: watchforcommithandlingtest, with root as owner.
2019-06-13 12:05:25,562 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 12:05:25,562 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 12:05:25,562 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 12:05:25,562 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 12:05:25,562 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 12:05:25,572 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 12:05:25,572 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 249b284e-4f6e-49ae-a42c-bd46086d3184: start group-C9077D0202A9
2019-06-13 12:05:25,572 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 249b284e-4f6e-49ae-a42c-bd46086d3184:group-C9077D0202A9 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 12:05:25,572 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 249b284e-4f6e-49ae-a42c-bd46086d3184: start FollowerState
2019-06-13 12:05:25,572 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C9077D0202A9,id=249b284e-4f6e-49ae-a42c-bd46086d3184
2019-06-13 12:05:25,580 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: fb2d82af-052a-40a2-bbe3-c9077d0202a9, Nodes: 249b284e-4f6e-49ae-a42c-bd46086d3184{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:05:25,584 INFO  rpc.RpcClient (RpcClient.java:createBucket(426)) - Creating Bucket: watchforcommithandlingtest/watchforcommithandlingtest, with Versioning false and Storage Type set to DISK and Encryption set to false 
2019-06-13 12:05:25,588 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:getStorageContainerLocationClient(241)) - Creating StorageContainerLocationProtocol RPC client with address /0.0.0.0:43137
2019-06-13 12:05:25,599 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-969CE6B78952->48f36a94-371b-4174-8c44-5029e9e379a6: receive RaftClientReply:client-969CE6B78952->48f36a94-371b-4174-8c44-5029e9e379a6@group-D00CC5095A50, cid=117, FAILED org.apache.ratis.protocol.NotLeaderException: Server 48f36a94-371b-4174-8c44-5029e9e379a6 is not the leader (b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:192.168.46.58:38057). Request must be sent to leader., logIndex=0, commits[48f36a94-371b-4174-8c44-5029e9e379a6:c-1]
2019-06-13 12:05:25,601 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:05:25,876 INFO  impl.FollowerState (FollowerState.java:run(101)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:group-5C785342D8EF changes to CANDIDATE, lastRpcTime:1042, electionTimeout:1042ms
2019-06-13 12:05:25,876 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: shutdown FollowerState
2019-06-13 12:05:25,876 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:group-5C785342D8EF changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:25,876 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: start LeaderElection
2019-06-13 12:05:25,883 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:group-5C785342D8EF:LeaderElection143: begin an election at term 1 for -1: [55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863], old=null
2019-06-13 12:05:25,883 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: shutdown LeaderElection
2019-06-13 12:05:25,883 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:group-5C785342D8EF changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:25,883 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:group-5C785342D8EF change Leader from null to 55566cff-d44d-47a7-b1c0-6ce92a96f3a6 at term 1 for becomeLeader, leader elected after 1054ms
2019-06-13 12:05:25,883 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:25,883 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:25,883 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:25,883 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:25,884 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: start LeaderState
2019-06-13 12:05:25,884 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:25,884 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:group-5C785342D8EF set configuration 0: [55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863], old=null at 0
2019-06-13 12:05:25,904 INFO  impl.FollowerState (FollowerState.java:run(101)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:group-DEC35D8CD16F changes to CANDIDATE, lastRpcTime:1186, electionTimeout:1181ms
2019-06-13 12:05:25,904 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: shutdown FollowerState
2019-06-13 12:05:25,905 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:group-DEC35D8CD16F changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:25,905 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: start LeaderElection
2019-06-13 12:05:25,926 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-1/data/ratis/b4d5eb45-e1c0-4307-a173-5c785342d8ef/current/log_inprogress_0
2019-06-13 12:05:25,926 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:group-DEC35D8CD16F:LeaderElection144: begin an election at term 1 for -1: [b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:192.168.46.58:38057], old=null
2019-06-13 12:05:25,927 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: shutdown LeaderElection
2019-06-13 12:05:25,927 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:group-DEC35D8CD16F changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:25,927 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:group-DEC35D8CD16F change Leader from null to b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61 at term 1 for becomeLeader, leader elected after 1210ms
2019-06-13 12:05:25,927 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:25,927 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:25,927 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:25,927 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:25,927 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: start LeaderState
2019-06-13 12:05:25,927 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:25,928 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:group-DEC35D8CD16F set configuration 0: [b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:192.168.46.58:38057], old=null at 0
2019-06-13 12:05:25,963 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-0/data/ratis/43ef6c20-3c8c-400a-9027-dec35d8cd16f/current/log_inprogress_0
2019-06-13 12:05:26,013 INFO  impl.FollowerState (FollowerState.java:run(101)) - 48f36a94-371b-4174-8c44-5029e9e379a6:group-298DB830AEE2 changes to CANDIDATE, lastRpcTime:1067, electionTimeout:1067ms
2019-06-13 12:05:26,014 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 48f36a94-371b-4174-8c44-5029e9e379a6: shutdown FollowerState
2019-06-13 12:05:26,014 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 48f36a94-371b-4174-8c44-5029e9e379a6:group-298DB830AEE2 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:26,014 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 48f36a94-371b-4174-8c44-5029e9e379a6: start LeaderElection
2019-06-13 12:05:26,020 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 48f36a94-371b-4174-8c44-5029e9e379a6:group-298DB830AEE2:LeaderElection145: begin an election at term 1 for -1: [48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923], old=null
2019-06-13 12:05:26,020 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 48f36a94-371b-4174-8c44-5029e9e379a6: shutdown LeaderElection
2019-06-13 12:05:26,020 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 48f36a94-371b-4174-8c44-5029e9e379a6:group-298DB830AEE2 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:26,020 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 48f36a94-371b-4174-8c44-5029e9e379a6:group-298DB830AEE2 change Leader from null to 48f36a94-371b-4174-8c44-5029e9e379a6 at term 1 for becomeLeader, leader elected after 1076ms
2019-06-13 12:05:26,020 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:26,020 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:26,021 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:26,021 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:26,021 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 48f36a94-371b-4174-8c44-5029e9e379a6: start LeaderState
2019-06-13 12:05:26,021 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 48f36a94-371b-4174-8c44-5029e9e379a6-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:26,021 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 48f36a94-371b-4174-8c44-5029e9e379a6:group-298DB830AEE2 set configuration 0: [48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923], old=null at 0
2019-06-13 12:05:26,056 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 48f36a94-371b-4174-8c44-5029e9e379a6-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-2/data/ratis/78316cb9-1052-4aeb-91d9-298db830aee2/current/log_inprogress_0
2019-06-13 12:05:26,101 INFO  impl.FollowerState (FollowerState.java:run(101)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:group-D00CC5095A50 changes to CANDIDATE, lastRpcTime:1068, electionTimeout:1052ms
2019-06-13 12:05:26,102 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: shutdown FollowerState
2019-06-13 12:05:26,102 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:group-D00CC5095A50 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:26,102 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: start LeaderElection
2019-06-13 12:05:26,107 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:group-D00CC5095A50:LeaderElection146: begin an election at term 1 for -1: [48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923, 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863, b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:192.168.46.58:38057], old=null
2019-06-13 12:05:26,115 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:group-D00CC5095A50 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:55566cff-d44d-47a7-b1c0-6ce92a96f3a6
2019-06-13 12:05:26,116 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: shutdown FollowerState
2019-06-13 12:05:26,116 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 48f36a94-371b-4174-8c44-5029e9e379a6:group-D00CC5095A50 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:55566cff-d44d-47a7-b1c0-6ce92a96f3a6
2019-06-13 12:05:26,116 INFO  impl.FollowerState (FollowerState.java:run(109)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:26,116 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: start FollowerState
2019-06-13 12:05:26,116 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 48f36a94-371b-4174-8c44-5029e9e379a6: shutdown FollowerState
2019-06-13 12:05:26,116 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 48f36a94-371b-4174-8c44-5029e9e379a6: start FollowerState
2019-06-13 12:05:26,116 INFO  impl.FollowerState (FollowerState.java:run(109)) - 48f36a94-371b-4174-8c44-5029e9e379a6: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:26,119 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:group-D00CC5095A50:LeaderElection146: Election PASSED; received 1 response(s) [55566cff-d44d-47a7-b1c0-6ce92a96f3a6->b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61,true-t1] and 0 exception(s); 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:t1, leader=null, voted=55566cff-d44d-47a7-b1c0-6ce92a96f3a6, raftlog=55566cff-d44d-47a7-b1c0-6ce92a96f3a6-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923, 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863, b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:192.168.46.58:38057], old=null
2019-06-13 12:05:26,119 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: shutdown LeaderElection
2019-06-13 12:05:26,119 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:group-D00CC5095A50 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:26,119 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:group-D00CC5095A50 change Leader from null to 55566cff-d44d-47a7-b1c0-6ce92a96f3a6 at term 1 for becomeLeader, leader elected after 1092ms
2019-06-13 12:05:26,119 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:26,119 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:26,119 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:26,119 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:26,119 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 12:05:26,119 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:26,119 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 12:05:26,120 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 12:05:26,120 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:26,120 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:26,120 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 12:05:26,120 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:26,120 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 12:05:26,120 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 12:05:26,120 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:26,120 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:26,120 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: start LeaderState
2019-06-13 12:05:26,120 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:26,121 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:group-D00CC5095A50 set configuration 0: [48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923, 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863, b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:192.168.46.58:38057], old=null at 0
2019-06-13 12:05:26,122 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 48f36a94-371b-4174-8c44-5029e9e379a6:group-D00CC5095A50 change Leader from null to 55566cff-d44d-47a7-b1c0-6ce92a96f3a6 at term 1 for appendEntries, leader elected after 1095ms
2019-06-13 12:05:26,122 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:group-D00CC5095A50 change Leader from null to 55566cff-d44d-47a7-b1c0-6ce92a96f3a6 at term 1 for appendEntries, leader elected after 1093ms
2019-06-13 12:05:26,126 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 48f36a94-371b-4174-8c44-5029e9e379a6:group-D00CC5095A50 set configuration 0: [48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923, 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863, b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:192.168.46.58:38057], old=null at 0
2019-06-13 12:05:26,126 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 48f36a94-371b-4174-8c44-5029e9e379a6-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:26,127 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:group-D00CC5095A50 set configuration 0: [48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923, 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863, b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:192.168.46.58:38057], old=null at 0
2019-06-13 12:05:26,127 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:26,164 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-1/data/ratis/321ab366-c2b2-4716-9801-d00cc5095a50/current/log_inprogress_0
2019-06-13 12:05:26,166 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 48f36a94-371b-4174-8c44-5029e9e379a6-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-2/data/ratis/321ab366-c2b2-4716-9801-d00cc5095a50/current/log_inprogress_0
2019-06-13 12:05:26,172 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-0/data/ratis/321ab366-c2b2-4716-9801-d00cc5095a50/current/log_inprogress_0
2019-06-13 12:05:26,194 INFO  impl.FollowerState (FollowerState.java:run(101)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88:group-25516534BD90 changes to CANDIDATE, lastRpcTime:1071, electionTimeout:1071ms
2019-06-13 12:05:26,194 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: shutdown FollowerState
2019-06-13 12:05:26,194 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88:group-25516534BD90 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:26,194 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: start LeaderElection
2019-06-13 12:05:26,200 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88:group-25516534BD90:LeaderElection147: begin an election at term 1 for -1: [88174b5b-fd1f-4cea-9b56-69296f3acc88:192.168.46.58:43303], old=null
2019-06-13 12:05:26,200 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: shutdown LeaderElection
2019-06-13 12:05:26,200 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88:group-25516534BD90 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:26,200 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88:group-25516534BD90 change Leader from null to 88174b5b-fd1f-4cea-9b56-69296f3acc88 at term 1 for becomeLeader, leader elected after 1079ms
2019-06-13 12:05:26,200 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:26,200 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:26,200 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:26,200 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:26,201 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: start LeaderState
2019-06-13 12:05:26,201 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:26,201 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88:group-25516534BD90 set configuration 0: [88174b5b-fd1f-4cea-9b56-69296f3acc88:192.168.46.58:43303], old=null at 0
2019-06-13 12:05:26,236 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-3/data/ratis/31b90607-0d4c-4b25-92ce-25516534bd90/current/log_inprogress_0
2019-06-13 12:05:26,252 INFO  impl.FollowerState (FollowerState.java:run(101)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:group-8CC7247B1F04 changes to CANDIDATE, lastRpcTime:1006, electionTimeout:1006ms
2019-06-13 12:05:26,252 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: shutdown FollowerState
2019-06-13 12:05:26,252 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:group-8CC7247B1F04 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:26,252 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: start LeaderElection
2019-06-13 12:05:26,258 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:group-8CC7247B1F04:LeaderElection148: begin an election at term 1 for -1: [3a90ff6a-d0a9-4724-8345-0dec5ca47bac:192.168.46.58:36861], old=null
2019-06-13 12:05:26,258 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: shutdown LeaderElection
2019-06-13 12:05:26,258 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:group-8CC7247B1F04 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:26,258 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:group-8CC7247B1F04 change Leader from null to 3a90ff6a-d0a9-4724-8345-0dec5ca47bac at term 1 for becomeLeader, leader elected after 1013ms
2019-06-13 12:05:26,258 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:26,258 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:26,259 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:26,259 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:26,259 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: start LeaderState
2019-06-13 12:05:26,259 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:26,259 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:group-8CC7247B1F04 set configuration 0: [3a90ff6a-d0a9-4724-8345-0dec5ca47bac:192.168.46.58:36861], old=null at 0
2019-06-13 12:05:26,295 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-4/data/ratis/dee2146a-c698-42b5-8150-8cc7247b1f04/current/log_inprogress_0
2019-06-13 12:05:26,327 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1126, electionTimeout:1126ms
2019-06-13 12:05:26,327 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:26,328 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 72 for changeToCandidate
2019-06-13 12:05:26,328 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:26,330 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection149: begin an election at term 73 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:26,330 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection149 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:26,331 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection149 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:26,331 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection149: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t73, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:26,331 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:26,331 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:26,331 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 73 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:26,332 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:26,332 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:26,455 INFO  impl.FollowerState (FollowerState.java:run(101)) - 248dcd6e-823e-4191-89f9-052df67b349c:group-8689413AF23C changes to CANDIDATE, lastRpcTime:1046, electionTimeout:1046ms
2019-06-13 12:05:26,455 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 248dcd6e-823e-4191-89f9-052df67b349c: shutdown FollowerState
2019-06-13 12:05:26,455 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 248dcd6e-823e-4191-89f9-052df67b349c:group-8689413AF23C changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:26,455 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 248dcd6e-823e-4191-89f9-052df67b349c: start LeaderElection
2019-06-13 12:05:26,461 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 248dcd6e-823e-4191-89f9-052df67b349c:group-8689413AF23C:LeaderElection150: begin an election at term 1 for -1: [248dcd6e-823e-4191-89f9-052df67b349c:192.168.46.58:37335], old=null
2019-06-13 12:05:26,461 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 248dcd6e-823e-4191-89f9-052df67b349c: shutdown LeaderElection
2019-06-13 12:05:26,461 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 248dcd6e-823e-4191-89f9-052df67b349c:group-8689413AF23C changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:26,461 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 248dcd6e-823e-4191-89f9-052df67b349c:group-8689413AF23C change Leader from null to 248dcd6e-823e-4191-89f9-052df67b349c at term 1 for becomeLeader, leader elected after 1054ms
2019-06-13 12:05:26,461 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:26,461 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:26,461 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:26,461 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:26,461 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 248dcd6e-823e-4191-89f9-052df67b349c: start LeaderState
2019-06-13 12:05:26,461 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 248dcd6e-823e-4191-89f9-052df67b349c-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:26,462 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 248dcd6e-823e-4191-89f9-052df67b349c:group-8689413AF23C set configuration 0: [248dcd6e-823e-4191-89f9-052df67b349c:192.168.46.58:37335], old=null at 0
2019-06-13 12:05:26,497 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 248dcd6e-823e-4191-89f9-052df67b349c-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-5/data/ratis/be266fff-34e8-4441-9a24-8689413af23c/current/log_inprogress_0
2019-06-13 12:05:26,560 INFO  impl.FollowerState (FollowerState.java:run(101)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88:group-365436E4D925 changes to CANDIDATE, lastRpcTime:1125, electionTimeout:1125ms
2019-06-13 12:05:26,560 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: shutdown FollowerState
2019-06-13 12:05:26,560 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88:group-365436E4D925 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:26,560 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: start LeaderElection
2019-06-13 12:05:26,566 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88:group-365436E4D925:LeaderElection151: begin an election at term 1 for -1: [88174b5b-fd1f-4cea-9b56-69296f3acc88:192.168.46.58:43303, 248dcd6e-823e-4191-89f9-052df67b349c:192.168.46.58:37335, 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:192.168.46.58:36861], old=null
2019-06-13 12:05:26,574 INFO  impl.FollowerState (FollowerState.java:run(101)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:group-365436E4D925 changes to CANDIDATE, lastRpcTime:1133, electionTimeout:1131ms
2019-06-13 12:05:26,574 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: shutdown FollowerState
2019-06-13 12:05:26,574 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:group-365436E4D925 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:26,575 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: start LeaderElection
2019-06-13 12:05:26,575 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 248dcd6e-823e-4191-89f9-052df67b349c:group-365436E4D925 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:88174b5b-fd1f-4cea-9b56-69296f3acc88
2019-06-13 12:05:26,575 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 248dcd6e-823e-4191-89f9-052df67b349c: shutdown FollowerState
2019-06-13 12:05:26,575 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 248dcd6e-823e-4191-89f9-052df67b349c: start FollowerState
2019-06-13 12:05:26,575 INFO  impl.FollowerState (FollowerState.java:run(109)) - 248dcd6e-823e-4191-89f9-052df67b349c: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:26,578 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88:group-365436E4D925:LeaderElection151: Election PASSED; received 1 response(s) [88174b5b-fd1f-4cea-9b56-69296f3acc88->248dcd6e-823e-4191-89f9-052df67b349c,true-t1] and 0 exception(s); 88174b5b-fd1f-4cea-9b56-69296f3acc88:t1, leader=null, voted=88174b5b-fd1f-4cea-9b56-69296f3acc88, raftlog=88174b5b-fd1f-4cea-9b56-69296f3acc88-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [88174b5b-fd1f-4cea-9b56-69296f3acc88:192.168.46.58:43303, 248dcd6e-823e-4191-89f9-052df67b349c:192.168.46.58:37335, 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:192.168.46.58:36861], old=null
2019-06-13 12:05:26,578 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: shutdown LeaderElection
2019-06-13 12:05:26,578 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88:group-365436E4D925 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:26,578 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88:group-365436E4D925 change Leader from null to 88174b5b-fd1f-4cea-9b56-69296f3acc88 at term 1 for becomeLeader, leader elected after 1148ms
2019-06-13 12:05:26,578 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:26,578 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:26,578 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:26,578 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:26,578 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 12:05:26,579 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:26,579 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 12:05:26,579 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 12:05:26,579 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:26,579 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:26,579 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 12:05:26,579 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 12:05:26,579 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 12:05:26,580 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 12:05:26,580 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 12:05:26,580 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 12:05:26,580 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: start LeaderState
2019-06-13 12:05:26,580 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:26,582 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 248dcd6e-823e-4191-89f9-052df67b349c:group-365436E4D925 change Leader from null to 88174b5b-fd1f-4cea-9b56-69296f3acc88 at term 1 for appendEntries, leader elected after 1148ms
2019-06-13 12:05:26,585 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88:group-365436E4D925 set configuration 0: [88174b5b-fd1f-4cea-9b56-69296f3acc88:192.168.46.58:43303, 248dcd6e-823e-4191-89f9-052df67b349c:192.168.46.58:37335, 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:192.168.46.58:36861], old=null at 0
2019-06-13 12:05:26,602 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 248dcd6e-823e-4191-89f9-052df67b349c:group-365436E4D925 set configuration 0: [88174b5b-fd1f-4cea-9b56-69296f3acc88:192.168.46.58:43303, 248dcd6e-823e-4191-89f9-052df67b349c:192.168.46.58:37335, 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:192.168.46.58:36861], old=null at 0
2019-06-13 12:05:26,602 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 248dcd6e-823e-4191-89f9-052df67b349c-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:26,602 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:group-365436E4D925:LeaderElection152: begin an election at term 1 for -1: [88174b5b-fd1f-4cea-9b56-69296f3acc88:192.168.46.58:43303, 248dcd6e-823e-4191-89f9-052df67b349c:192.168.46.58:37335, 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:192.168.46.58:36861], old=null
2019-06-13 12:05:26,603 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:group-365436E4D925 changes role from CANDIDATE to FOLLOWER at term 1 for appendEntries
2019-06-13 12:05:26,603 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: shutdown LeaderElection
2019-06-13 12:05:26,604 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: start FollowerState
2019-06-13 12:05:26,618 INFO  impl.RaftServerImpl (RaftServerImpl.java:requestVote(738)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88-LEADER: Withhold vote from candidate 3a90ff6a-d0a9-4724-8345-0dec5ca47bac with term 1. State: leader=88174b5b-fd1f-4cea-9b56-69296f3acc88, term=1, lastRpcElapsed=null
2019-06-13 12:05:26,623 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:group-365436E4D925 change Leader from null to 88174b5b-fd1f-4cea-9b56-69296f3acc88 at term 1 for appendEntries, leader elected after 1189ms
2019-06-13 12:05:26,624 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:group-365436E4D925:LeaderElection152: Election REJECTED; received 0 response(s) [] and 0 exception(s); 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:t1, leader=88174b5b-fd1f-4cea-9b56-69296f3acc88, voted=3a90ff6a-d0a9-4724-8345-0dec5ca47bac, raftlog=3a90ff6a-d0a9-4724-8345-0dec5ca47bac-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [88174b5b-fd1f-4cea-9b56-69296f3acc88:192.168.46.58:43303, 248dcd6e-823e-4191-89f9-052df67b349c:192.168.46.58:37335, 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:192.168.46.58:36861], old=null
2019-06-13 12:05:26,625 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:group-365436E4D925 set configuration 0: [88174b5b-fd1f-4cea-9b56-69296f3acc88:192.168.46.58:43303, 248dcd6e-823e-4191-89f9-052df67b349c:192.168.46.58:37335, 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:192.168.46.58:36861], old=null at 0
2019-06-13 12:05:26,625 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:26,639 INFO  impl.RaftServerImpl (RaftServerImpl.java:requestVote(738)) - 248dcd6e-823e-4191-89f9-052df67b349c-FOLLOWER: Withhold vote from candidate 3a90ff6a-d0a9-4724-8345-0dec5ca47bac with term 1. State: leader=88174b5b-fd1f-4cea-9b56-69296f3acc88, term=1, lastRpcElapsed=37ms
2019-06-13 12:05:26,640 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-3/data/ratis/979d935f-f9c6-4c6d-8f36-365436e4d925/current/log_inprogress_0
2019-06-13 12:05:26,686 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 248dcd6e-823e-4191-89f9-052df67b349c-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-5/data/ratis/979d935f-f9c6-4c6d-8f36-365436e4d925/current/log_inprogress_0
2019-06-13 12:05:26,690 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-4/data/ratis/979d935f-f9c6-4c6d-8f36-365436e4d925/current/log_inprogress_0
2019-06-13 12:05:26,694 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-969CE6B78952->55566cff-d44d-47a7-b1c0-6ce92a96f3a6: receive RaftClientReply:client-969CE6B78952->55566cff-d44d-47a7-b1c0-6ce92a96f3a6@group-D00CC5095A50, cid=117, SUCCESS, logIndex=1, commits[55566cff-d44d-47a7-b1c0-6ce92a96f3a6:c2, 48f36a94-371b-4174-8c44-5029e9e379a6:c1, b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:c1]
2019-06-13 12:05:26,694 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:05:26,695 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@6ca6cc1c
2019-06-13 12:05:26,695 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:05:26,695 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:05:26,695 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 48f36a94-371b-4174-8c44-5029e9e379a6: close
2019-06-13 12:05:26,696 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 48f36a94-371b-4174-8c44-5029e9e379a6: shutdown group-298DB830AEE2
2019-06-13 12:05:26,696 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 48f36a94-371b-4174-8c44-5029e9e379a6: shutdown group-D00CC5095A50
2019-06-13 12:05:26,696 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-298DB830AEE2,id=48f36a94-371b-4174-8c44-5029e9e379a6
2019-06-13 12:05:26,696 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 48f36a94-371b-4174-8c44-5029e9e379a6: shutdown LeaderState
2019-06-13 12:05:26,696 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 48f36a94-371b-4174-8c44-5029e9e379a6-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:26,696 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D00CC5095A50,id=48f36a94-371b-4174-8c44-5029e9e379a6
2019-06-13 12:05:26,699 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 48f36a94-371b-4174-8c44-5029e9e379a6: shutdown FollowerState
2019-06-13 12:05:26,699 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-48f36a94-371b-4174-8c44-5029e9e379a6-group-D00CC5095A50: set stopIndex = 1
2019-06-13 12:05:26,699 INFO  impl.FollowerState (FollowerState.java:run(109)) - 48f36a94-371b-4174-8c44-5029e9e379a6: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:26,699 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:1)
2019-06-13 12:05:26,701 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-2/data/ratis/321ab366-c2b2-4716-9801-d00cc5095a50/sm/snapshot.1_1
2019-06-13 12:05:26,701 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:26,701 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-48f36a94-371b-4174-8c44-5029e9e379a6-group-298DB830AEE2: set stopIndex = 0
2019-06-13 12:05:26,701 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 48f36a94-371b-4174-8c44-5029e9e379a6:group-D00CC5095A50 closes. The last applied log index is 1
2019-06-13 12:05:26,702 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 48f36a94-371b-4174-8c44-5029e9e379a6:group-298DB830AEE2 closes. The last applied log index is 0
2019-06-13 12:05:26,702 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 48f36a94-371b-4174-8c44-5029e9e379a6-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:26,702 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 48f36a94-371b-4174-8c44-5029e9e379a6-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:26,704 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 48f36a94-371b-4174-8c44-5029e9e379a6-RaftLogWorker close()
2019-06-13 12:05:26,706 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 48f36a94-371b-4174-8c44-5029e9e379a6-RaftLogWorker close()
2019-06-13 12:05:26,710 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 48f36a94-371b-4174-8c44-5029e9e379a6: shutdown server with port 43923 now
2019-06-13 12:05:26,710 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - 48f36a94-371b-4174-8c44-5029e9e379a6: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:05:26,710 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 48f36a94-371b-4174-8c44-5029e9e379a6: shutdown server with port 43923 successfully
2019-06-13 12:05:26,711 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-13 12:05:26,711 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 3 -> 0
2019-06-13 12:05:26,712 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:26,723 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:05:26,723 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@1e250539{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:05:26,724 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@5860e4c3{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:26,724 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@6affa355{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:05:26,724 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@56ed9270{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:26,728 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:26,729 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 1 -> 0
2019-06-13 12:05:26,730 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:26,730 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 1 -> 0
2019-06-13 12:05:26,735 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:26,735 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 1 -> 0
2019-06-13 12:05:26,742 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 1 is closed with bcsId 0.
2019-06-13 12:05:26,751 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-969CE6B78952->55566cff-d44d-47a7-b1c0-6ce92a96f3a6: receive RaftClientReply:client-969CE6B78952->55566cff-d44d-47a7-b1c0-6ce92a96f3a6@group-D00CC5095A50, cid=118, SUCCESS, logIndex=3, commits[55566cff-d44d-47a7-b1c0-6ce92a96f3a6:c4, 48f36a94-371b-4174-8c44-5029e9e379a6:c1, b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:c3]
2019-06-13 12:05:26,755 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 1 is closed with bcsId 0.
2019-06-13 12:05:26,767 INFO  impl.FollowerState (FollowerState.java:run(101)) - 249b284e-4f6e-49ae-a42c-bd46086d3184:group-C9077D0202A9 changes to CANDIDATE, lastRpcTime:1195, electionTimeout:1195ms
2019-06-13 12:05:26,767 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 249b284e-4f6e-49ae-a42c-bd46086d3184: shutdown FollowerState
2019-06-13 12:05:26,767 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 249b284e-4f6e-49ae-a42c-bd46086d3184:group-C9077D0202A9 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 12:05:26,767 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 249b284e-4f6e-49ae-a42c-bd46086d3184: start LeaderElection
2019-06-13 12:05:26,783 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 249b284e-4f6e-49ae-a42c-bd46086d3184:group-C9077D0202A9:LeaderElection153: begin an election at term 1 for -1: [249b284e-4f6e-49ae-a42c-bd46086d3184:192.168.46.58:38467], old=null
2019-06-13 12:05:26,783 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 249b284e-4f6e-49ae-a42c-bd46086d3184: shutdown LeaderElection
2019-06-13 12:05:26,783 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 249b284e-4f6e-49ae-a42c-bd46086d3184:group-C9077D0202A9 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 12:05:26,784 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 249b284e-4f6e-49ae-a42c-bd46086d3184:group-C9077D0202A9 change Leader from null to 249b284e-4f6e-49ae-a42c-bd46086d3184 at term 1 for becomeLeader, leader elected after 1222ms
2019-06-13 12:05:26,784 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 12:05:26,784 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 12:05:26,784 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 12:05:26,784 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 12:05:26,784 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 249b284e-4f6e-49ae-a42c-bd46086d3184: start LeaderState
2019-06-13 12:05:26,784 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 249b284e-4f6e-49ae-a42c-bd46086d3184-RaftLogWorker: Starting segment from index:0
2019-06-13 12:05:26,785 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 249b284e-4f6e-49ae-a42c-bd46086d3184:group-C9077D0202A9 set configuration 0: [249b284e-4f6e-49ae-a42c-bd46086d3184:192.168.46.58:38467], old=null at 0
2019-06-13 12:05:26,819 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 249b284e-4f6e-49ae-a42c-bd46086d3184-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-6/data/ratis/fb2d82af-052a-40a2-bbe3-c9077d0202a9/current/log_inprogress_0
2019-06-13 12:05:27,245 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:27,245 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:27,502 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1170, electionTimeout:1170ms
2019-06-13 12:05:27,502 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:27,502 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 73 for changeToCandidate
2019-06-13 12:05:27,502 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:27,505 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection154: begin an election at term 74 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:27,505 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection154 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:27,505 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection154 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:27,506 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection154: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t74, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:27,506 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:27,506 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:27,506 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 74 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:27,506 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:27,506 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:27,736 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:27,736 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:28,236 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:28,236 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:28,641 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1135, electionTimeout:1135ms
2019-06-13 12:05:28,641 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:28,641 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 74 for changeToCandidate
2019-06-13 12:05:28,641 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:28,644 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection155: begin an election at term 75 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:28,644 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection155 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:28,645 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection155 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:28,645 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection155: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t75, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:28,645 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:28,645 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:28,645 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 75 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:28,645 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:28,645 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:28,737 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:28,737 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:29,237 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:29,237 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:29,721 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1075, electionTimeout:1075ms
2019-06-13 12:05:29,721 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:29,721 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 75 for changeToCandidate
2019-06-13 12:05:29,721 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:29,723 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection156: begin an election at term 76 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:29,723 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection156 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:29,724 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection156 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:29,724 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection156: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t76, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:29,724 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:29,724 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:29,724 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 76 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:29,724 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:29,724 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:29,737 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:29,738 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:30,238 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:30,238 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:30,738 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:30,738 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:30,889 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1165, electionTimeout:1165ms
2019-06-13 12:05:30,890 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:30,890 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 76 for changeToCandidate
2019-06-13 12:05:30,890 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:30,892 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection157: begin an election at term 77 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:30,893 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection157 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:30,893 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection157 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:30,893 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection157: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t77, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:30,893 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:30,893 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:30,893 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 77 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:30,893 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:30,893 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:31,239 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:31,239 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:31,739 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:31,739 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:31,768 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-969CE6B78952->b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61@group-D00CC5095A50, cid=119, seq=0, Watch-ALL_COMMITTED(3), Message:<EMPTY>, reply=RaftClientReply:client-969CE6B78952->b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61@group-D00CC5095A50, cid=119, FAILED org.apache.ratis.protocol.NotLeaderException: Server b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61 is not the leader (55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863). Request must be sent to leader., logIndex=0, commits[b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:c4, 48f36a94-371b-4174-8c44-5029e9e379a6:c1, 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:c4]
2019-06-13 12:05:31,772 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-969CE6B78952->b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: receive RaftClientReply:client-969CE6B78952->b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61@group-D00CC5095A50, cid=119, FAILED org.apache.ratis.protocol.NotLeaderException: Server b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61 is not the leader (55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863). Request must be sent to leader., logIndex=0, commits[b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:c4, 48f36a94-371b-4174-8c44-5029e9e379a6:c1, 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:c4]
2019-06-13 12:05:31,777 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-UnorderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:05:32,036 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1142, electionTimeout:1142ms
2019-06-13 12:05:32,036 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:32,036 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 77 for changeToCandidate
2019-06-13 12:05:32,036 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:32,038 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection158: begin an election at term 78 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:32,039 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection158 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:32,039 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection158 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:32,039 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection158: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t78, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:32,039 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:32,040 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:32,040 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 78 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:32,040 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:32,040 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:32,239 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:32,240 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:32,740 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:32,740 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:33,081 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1041, electionTimeout:1041ms
2019-06-13 12:05:33,081 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:33,081 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 78 for changeToCandidate
2019-06-13 12:05:33,081 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:33,084 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection159: begin an election at term 79 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:33,084 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection159 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:33,085 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection159 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:33,085 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection159: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t79, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:33,085 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:33,085 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:33,085 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 79 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:33,085 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:33,085 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:33,240 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:33,240 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:33,741 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:33,741 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:34,210 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1125, electionTimeout:1125ms
2019-06-13 12:05:34,210 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:34,211 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 79 for changeToCandidate
2019-06-13 12:05:34,211 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:34,213 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection160: begin an election at term 80 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:34,214 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection160 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:34,214 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection160 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:34,214 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection160: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t80, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:34,214 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:34,214 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:34,214 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 80 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:34,214 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:34,214 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:34,241 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:34,241 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:34,742 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:34,742 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:35,242 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:35,242 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:35,371 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1156, electionTimeout:1156ms
2019-06-13 12:05:35,371 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:35,371 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 80 for changeToCandidate
2019-06-13 12:05:35,371 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:35,373 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection161: begin an election at term 81 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:35,374 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection161 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:35,374 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection161 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:35,375 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection161: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t81, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:35,375 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:35,375 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:35,375 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 81 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:35,375 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:35,375 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:35,742 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:35,743 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:36,243 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:36,243 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:36,505 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1129, electionTimeout:1129ms
2019-06-13 12:05:36,505 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:36,505 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 81 for changeToCandidate
2019-06-13 12:05:36,505 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:36,507 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection162: begin an election at term 82 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:36,508 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection162 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:36,508 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection162 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:36,508 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection162: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t82, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:36,508 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:36,508 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:36,508 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 82 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:36,508 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:36,509 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:36,743 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:36,743 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:36,785 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-969CE6B78952->b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61@group-D00CC5095A50, cid=119, seq=0, Watch-ALL_COMMITTED(3), Message:<EMPTY>, reply=RaftClientReply:client-969CE6B78952->b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61@group-D00CC5095A50, cid=119, FAILED org.apache.ratis.protocol.NotLeaderException: Server b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61 is not the leader (55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863). Request must be sent to leader., logIndex=0, commits[b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:c4, 48f36a94-371b-4174-8c44-5029e9e379a6:c1, 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:c4]
2019-06-13 12:05:36,792 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-969CE6B78952->b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: receive RaftClientReply:client-969CE6B78952->b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61@group-D00CC5095A50, cid=119, FAILED org.apache.ratis.protocol.NotLeaderException: Server b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61 is not the leader (55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863). Request must be sent to leader., logIndex=0, commits[b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:c4, 48f36a94-371b-4174-8c44-5029e9e379a6:c1, 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:c4]
2019-06-13 12:05:36,794 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-UnorderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:05:37,243 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:37,244 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:37,649 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1140, electionTimeout:1140ms
2019-06-13 12:05:37,649 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:37,649 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 82 for changeToCandidate
2019-06-13 12:05:37,649 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:37,652 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection163: begin an election at term 83 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:37,652 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection163 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:37,652 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection163 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:37,653 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection163: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t83, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:37,653 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:37,653 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:37,653 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 83 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:37,653 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:37,653 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:37,676 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-969CE6B78952->55566cff-d44d-47a7-b1c0-6ce92a96f3a6@group-D00CC5095A50, cid=119, seq=0, Watch-ALL_COMMITTED(3), Message:<EMPTY>, reply=RaftClientReply:client-969CE6B78952->55566cff-d44d-47a7-b1c0-6ce92a96f3a6@group-D00CC5095A50, cid=119, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 119 and log index 3 is not yet replicated to ALL_COMMITTED, logIndex=3, commits[55566cff-d44d-47a7-b1c0-6ce92a96f3a6:c4, 48f36a94-371b-4174-8c44-5029e9e379a6:c1, b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:c4]
2019-06-13 12:05:37,744 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:37,744 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:38,244 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:38,244 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:38,704 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1051, electionTimeout:1051ms
2019-06-13 12:05:38,704 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:38,705 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 83 for changeToCandidate
2019-06-13 12:05:38,705 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:38,707 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection164: begin an election at term 84 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:38,708 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection164 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:38,708 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection164 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:38,708 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection164: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t84, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:38,708 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:38,709 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:38,709 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 84 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:38,709 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:38,709 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:38,745 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:38,745 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:39,245 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:39,245 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:39,746 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:39,746 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:39,905 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1196, electionTimeout:1196ms
2019-06-13 12:05:39,905 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:39,905 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 84 for changeToCandidate
2019-06-13 12:05:39,905 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:39,908 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection165: begin an election at term 85 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:39,909 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection165 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:39,909 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection165 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:39,909 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection165: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t85, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:39,909 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:39,909 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:39,909 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 85 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:39,910 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:39,910 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:40,246 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:40,246 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:40,746 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:40,746 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:41,087 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1177, electionTimeout:1177ms
2019-06-13 12:05:41,087 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:41,087 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 85 for changeToCandidate
2019-06-13 12:05:41,087 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:41,089 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection166: begin an election at term 86 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:41,090 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection166 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:41,090 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection166 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:41,090 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection166: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t86, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:41,090 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:41,091 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:41,091 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 86 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:41,091 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:41,091 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:41,247 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:41,247 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:41,747 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:41,747 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:42,186 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1095, electionTimeout:1095ms
2019-06-13 12:05:42,186 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:42,186 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 86 for changeToCandidate
2019-06-13 12:05:42,186 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:42,189 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection167: begin an election at term 87 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:42,189 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection167 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:42,189 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection167 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:42,189 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection167: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t87, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:42,190 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:42,190 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:42,190 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 87 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:42,190 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:42,190 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:42,247 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:42,247 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:42,748 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:42,748 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:43,248 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:43,249 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:43,355 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1165, electionTimeout:1165ms
2019-06-13 12:05:43,355 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:43,355 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 87 for changeToCandidate
2019-06-13 12:05:43,355 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:43,358 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection168: begin an election at term 88 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:43,358 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection168 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:43,358 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection168 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:43,359 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection168: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t88, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:43,359 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:43,359 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:43,359 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 88 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:43,359 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:43,359 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:43,674 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-969CE6B78952->55566cff-d44d-47a7-b1c0-6ce92a96f3a6@group-D00CC5095A50, cid=119, seq=0, Watch-ALL_COMMITTED(3), Message:<EMPTY>, reply=RaftClientReply:client-969CE6B78952->55566cff-d44d-47a7-b1c0-6ce92a96f3a6@group-D00CC5095A50, cid=119, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 119 and log index 3 is not yet replicated to ALL_COMMITTED, logIndex=3, commits[55566cff-d44d-47a7-b1c0-6ce92a96f3a6:c4, 48f36a94-371b-4174-8c44-5029e9e379a6:c1, b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:c4]
2019-06-13 12:05:43,749 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:43,749 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:44,249 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:44,250 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:44,422 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1063, electionTimeout:1063ms
2019-06-13 12:05:44,422 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:44,422 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 88 for changeToCandidate
2019-06-13 12:05:44,422 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:44,425 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection169: begin an election at term 89 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:44,425 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection169 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:44,425 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection169 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:44,426 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection169: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t89, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:44,426 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:44,426 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:44,426 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 89 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:44,426 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:44,426 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:44,616 INFO  node.StaleNodeHandler (StaleNodeHandler.java:onMessage(58)) - Datanode cfa6ee40-d911-4f1c-9330-44c1c1a7e901{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null} moved to stale state. Finalizing its pipelines [PipelineID=55dac406-2a8a-4a18-96c5-186a2e842470, PipelineID=f1780b47-6fe6-43aa-ae34-bce6487231ac]
2019-06-13 12:05:44,616 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: 55dac406-2a8a-4a18-96c5-186a2e842470, Nodes: cfa6ee40-d911-4f1c-9330-44c1c1a7e901{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:05:44,616 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 55dac406-2a8a-4a18-96c5-186a2e842470, Nodes: cfa6ee40-d911-4f1c-9330-44c1c1a7e901{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-06-13 12:05:44,617 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: f1780b47-6fe6-43aa-ae34-bce6487231ac, Nodes: cfa6ee40-d911-4f1c-9330-44c1c1a7e901{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}40e85715-f542-4fe4-a7e5-a8202a6d8f0e{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}4385f424-31b1-428a-a0ea-2f137423452e{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-13 12:05:44,617 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: f1780b47-6fe6-43aa-ae34-bce6487231ac, Nodes: cfa6ee40-d911-4f1c-9330-44c1c1a7e901{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}40e85715-f542-4fe4-a7e5-a8202a6d8f0e{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}4385f424-31b1-428a-a0ea-2f137423452e{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] moved to CLOSED state
2019-06-13 12:05:44,617 INFO  node.StaleNodeHandler (StaleNodeHandler.java:onMessage(58)) - Datanode 40e85715-f542-4fe4-a7e5-a8202a6d8f0e{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null} moved to stale state. Finalizing its pipelines [PipelineID=2f151661-de39-4f57-9464-d77f64a1d32a, PipelineID=f1780b47-6fe6-43aa-ae34-bce6487231ac]
2019-06-13 12:05:44,618 INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #1
2019-06-13 12:05:44,618 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: 2f151661-de39-4f57-9464-d77f64a1d32a, Nodes: 40e85715-f542-4fe4-a7e5-a8202a6d8f0e{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-13 12:05:44,618 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 2f151661-de39-4f57-9464-d77f64a1d32a, Nodes: 40e85715-f542-4fe4-a7e5-a8202a6d8f0e{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-06-13 12:05:44,618 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: f1780b47-6fe6-43aa-ae34-bce6487231ac, Nodes: cfa6ee40-d911-4f1c-9330-44c1c1a7e901{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}40e85715-f542-4fe4-a7e5-a8202a6d8f0e{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}4385f424-31b1-428a-a0ea-2f137423452e{ip: 192.168.46.58, host: ozone-nffxw-186015654, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
2019-06-13 12:05:44,750 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:44,750 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:45,250 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:45,251 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:45,500 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1074, electionTimeout:1074ms
2019-06-13 12:05:45,500 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:45,500 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 89 for changeToCandidate
2019-06-13 12:05:45,500 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:45,503 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection170: begin an election at term 90 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:45,503 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection170 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:45,504 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection170 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:45,504 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection170: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t90, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:45,504 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:45,504 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:45,504 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 90 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:45,504 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:45,504 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:45,751 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:45,751 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:46,251 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:46,252 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:46,661 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1156, electionTimeout:1156ms
2019-06-13 12:05:46,661 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:46,661 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 90 for changeToCandidate
2019-06-13 12:05:46,661 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:46,664 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection171: begin an election at term 91 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:46,665 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection171 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:46,666 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection171 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:46,666 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection171: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t91, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:46,666 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:46,666 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:46,666 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 91 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:46,666 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:46,666 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:46,752 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:46,752 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:46,752 WARN  scm.XceiverClientRatis (XceiverClientRatis.java:watchForCommit(260)) - 3 way commit failed 
java.util.concurrent.TimeoutException
	at java.util.concurrent.CompletableFuture.timedGet(CompletableFuture.java:1771)
	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1915)
	at org.apache.hadoop.hdds.scm.XceiverClientRatis.watchForCommit(XceiverClientRatis.java:257)
	at org.apache.hadoop.ozone.client.rpc.TestWatchForCommit.test2WayCommitForRetryfailure(TestWatchForCommit.java:389)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2019-06-13 12:05:46,754 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-969CE6B78952->b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61@group-D00CC5095A50, cid=120, seq=0, Watch-MAJORITY_COMMITTED(3), Message:<EMPTY>, reply=RaftClientReply:client-969CE6B78952->b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61@group-D00CC5095A50, cid=120, FAILED org.apache.ratis.protocol.NotLeaderException: Server b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61 is not the leader (55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863). Request must be sent to leader., logIndex=0, commits[b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:c4, 48f36a94-371b-4174-8c44-5029e9e379a6:c1, 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:c4]
2019-06-13 12:05:46,759 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-969CE6B78952->b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: receive RaftClientReply:client-969CE6B78952->b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61@group-D00CC5095A50, cid=120, FAILED org.apache.ratis.protocol.NotLeaderException: Server b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61 is not the leader (55566cff-d44d-47a7-b1c0-6ce92a96f3a6:192.168.46.58:43863). Request must be sent to leader., logIndex=0, commits[b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:c4, 48f36a94-371b-4174-8c44-5029e9e379a6:c1, 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:c4]
2019-06-13 12:05:46,762 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 2-UnorderedRequestStreamObserver2: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:05:47,252 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:47,252 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:47,752 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to 48f36a94-371b-4174-8c44-5029e9e379a6:192.168.46.58:43923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-13 12:05:47,753 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->48f36a94-371b-4174-8c44-5029e9e379a6: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 12:05:47,782 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-969CE6B78952->55566cff-d44d-47a7-b1c0-6ce92a96f3a6: receive RaftClientReply:client-969CE6B78952->55566cff-d44d-47a7-b1c0-6ce92a96f3a6@group-D00CC5095A50, cid=120, SUCCESS, logIndex=0, commits[55566cff-d44d-47a7-b1c0-6ce92a96f3a6:c4, 48f36a94-371b-4174-8c44-5029e9e379a6:c1, b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:c4]
2019-06-13 12:05:47,782 INFO  scm.XceiverClientRatis (XceiverClientRatis.java:lambda$watchForCommit$7(278)) - Could not commit 3 to all the nodes. Server 48f36a94-371b-4174-8c44-5029e9e379a6 has failed. Committed by majority.
2019-06-13 12:05:47,782 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:shutdown(321)) - Shutting down the Mini Ozone Cluster
2019-06-13 12:05:47,783 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(336)) - Stopping the Mini Ozone Cluster
2019-06-13 12:05:47,783 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(338)) - Stopping the OzoneManager
2019-06-13 12:05:47,783 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 33861
2019-06-13 12:05:47,785 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 33861
2019-06-13 12:05:47,790 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service KeyDeletingService
2019-06-13 12:05:47,790 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-13 12:05:47,792 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@2fedaa2e{/,null,UNAVAILABLE}{/ozoneManager}
2019-06-13 12:05:47,793 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@4203190{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:47,793 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@68fb6c1e{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,UNAVAILABLE}
2019-06-13 12:05:47,793 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@4c131823{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:47,795 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(344)) - Stopping the StorageContainerManager
2019-06-13 12:05:47,795 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(789)) - Stopping Replication Manager Service.
2019-06-13 12:05:47,795 INFO  container.ReplicationManager (ReplicationManager.java:stop(191)) - Replication Monitor Thread is not running.
2019-06-13 12:05:47,795 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(796)) - Stopping Lease Manager of the command watchers
2019-06-13 12:05:47,795 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(803)) - Stopping datanode service RPC server
2019-06-13 12:05:47,795 INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(373)) - Stopping the RPC server for DataNodes
2019-06-13 12:05:47,795 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 42657
2019-06-13 12:05:47,796 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-13 12:05:47,796 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(811)) - Stopping block service RPC server
2019-06-13 12:05:47,796 INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(145)) - Stopping the RPC server for Block Protocol
2019-06-13 12:05:47,796 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 35793
2019-06-13 12:05:47,798 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 42657
2019-06-13 12:05:47,803 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 35793
2019-06-13 12:05:47,803 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(818)) - Stopping the StorageContainerLocationProtocol RPC server
2019-06-13 12:05:47,805 INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(157)) - Stopping the RPC server for Client Protocol
2019-06-13 12:05:47,803 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-13 12:05:47,806 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 43137
2019-06-13 12:05:47,808 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 43137
2019-06-13 12:05:47,809 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-13 12:05:47,816 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(825)) - Stopping Storage Container Manager HTTP server.
2019-06-13 12:05:47,818 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@8eda949{/,null,UNAVAILABLE}{/scm}
2019-06-13 12:05:47,820 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@273c4b3{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:47,820 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@537fb7bf{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,UNAVAILABLE}
2019-06-13 12:05:47,820 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@64dc0a5f{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:47,821 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(836)) - Stopping Block Manager Service.
2019-06-13 12:05:47,821 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service SCMBlockDeletingService
2019-06-13 12:05:47,821 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service SCMBlockDeletingService
2019-06-13 12:05:47,821 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(858)) - Stopping SCM Event Queue.
2019-06-13 12:05:47,822 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(350)) - Shutting the HddsDatanodes
2019-06-13 12:05:47,823 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:05:47,823 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@943d0c2
2019-06-13 12:05:47,823 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:05:47,823 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:05:47,823 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: close
2019-06-13 12:05:47,823 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: shutdown group-D00CC5095A50
2019-06-13 12:05:47,824 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D00CC5095A50,id=b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61
2019-06-13 12:05:47,824 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: shutdown FollowerState
2019-06-13 12:05:47,824 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61-group-D00CC5095A50: set stopIndex = 4
2019-06-13 12:05:47,824 INFO  impl.FollowerState (FollowerState.java:run(109)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:47,824 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-13 12:05:47,824 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-0/data/ratis/321ab366-c2b2-4716-9801-d00cc5095a50/sm/snapshot.1_3
2019-06-13 12:05:47,825 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:group-D00CC5095A50 closes. The last applied log index is 4
2019-06-13 12:05:47,825 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:47,827 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61-RaftLogWorker close()
2019-06-13 12:05:47,829 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: shutdown group-DEC35D8CD16F
2019-06-13 12:05:47,829 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-DEC35D8CD16F,id=b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61
2019-06-13 12:05:47,829 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: shutdown LeaderState
2019-06-13 12:05:47,829 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:47,829 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61-group-DEC35D8CD16F: set stopIndex = 0
2019-06-13 12:05:47,829 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:47,830 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:group-DEC35D8CD16F closes. The last applied log index is 0
2019-06-13 12:05:47,830 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:47,832 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61-RaftLogWorker close()
2019-06-13 12:05:47,834 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: shutdown server with port 38057 now
2019-06-13 12:05:47,834 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:05:47,834 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: shutdown server with port 38057 successfully
2019-06-13 12:05:47,834 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: Failed appendEntries to b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61:192.168.46.58:38057: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-13 12:05:47,835 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6->b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61: nextIndex: updateUnconditionally 5 -> 0
2019-06-13 12:05:47,835 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:47,836 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes to CANDIDATE, lastRpcTime:1169, electionTimeout:1169ms
2019-06-13 12:05:47,836 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown FollowerState
2019-06-13 12:05:47,836 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from FOLLOWER to CANDIDATE at term 91 for changeToCandidate
2019-06-13 12:05:47,836 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start LeaderElection
2019-06-13 12:05:47,842 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection172: begin an election at term 92 for 0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:47,845 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection172 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:47,847 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:05:47,847 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection172 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:47,847 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC:LeaderElection172: Election REJECTED; received 0 response(s) [] and 2 exception(s); 4385f424-31b1-428a-a0ea-2f137423452e:t92, leader=null, voted=4385f424-31b1-428a-a0ea-2f137423452e, raftlog=4385f424-31b1-428a-a0ea-2f137423452e-SegmentedRaftLog:OPENED:c15,f16,i16, conf=0: [cfa6ee40-d911-4f1c-9330-44c1c1a7e901:192.168.46.58:39721, 4385f424-31b1-428a-a0ea-2f137423452e:192.168.46.58:43947, 40e85715-f542-4fe4-a7e5-a8202a6d8f0e:192.168.46.58:38617], old=null
2019-06-13 12:05:47,847 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:39721
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:47,847 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.58:38617
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-13 12:05:47,847 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@1676e501{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:05:47,848 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4385f424-31b1-428a-a0ea-2f137423452e:group-BCE6487231AC changes role from CANDIDATE to FOLLOWER at term 92 for DISCOVERED_A_NEW_TERM
2019-06-13 12:05:47,848 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4385f424-31b1-428a-a0ea-2f137423452e: shutdown LeaderElection
2019-06-13 12:05:47,848 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4385f424-31b1-428a-a0ea-2f137423452e: start FollowerState
2019-06-13 12:05:47,848 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@1ed763aa{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:47,848 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@189f2184{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:05:47,848 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@1aa7d66e{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:47,849 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:05:47,849 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@495cac83
2019-06-13 12:05:47,849 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:05:47,849 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:05:47,849 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: close
2019-06-13 12:05:47,850 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: shutdown group-5C785342D8EF
2019-06-13 12:05:47,850 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-5C785342D8EF,id=55566cff-d44d-47a7-b1c0-6ce92a96f3a6
2019-06-13 12:05:47,850 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: shutdown LeaderState
2019-06-13 12:05:47,850 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:47,850 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-55566cff-d44d-47a7-b1c0-6ce92a96f3a6-group-5C785342D8EF: set stopIndex = 0
2019-06-13 12:05:47,850 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:47,850 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: shutdown group-D00CC5095A50
2019-06-13 12:05:47,850 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:group-5C785342D8EF closes. The last applied log index is 0
2019-06-13 12:05:47,850 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D00CC5095A50,id=55566cff-d44d-47a7-b1c0-6ce92a96f3a6
2019-06-13 12:05:47,851 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:47,851 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: shutdown LeaderState
2019-06-13 12:05:47,852 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6-RaftLogWorker close()
2019-06-13 12:05:47,853 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(55566cff-d44d-47a7-b1c0-6ce92a96f3a6 -> b4e51d0a-160e-4b99-8b90-2fe4fd4e1d61): Wait interrupted by java.lang.InterruptedException
2019-06-13 12:05:47,853 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(55566cff-d44d-47a7-b1c0-6ce92a96f3a6 -> 48f36a94-371b-4174-8c44-5029e9e379a6): Wait interrupted by java.lang.InterruptedException
2019-06-13 12:05:47,853 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:47,857 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-969CE6B78952->55566cff-d44d-47a7-b1c0-6ce92a96f3a6@group-D00CC5095A50, cid=119, seq=0, Watch-ALL_COMMITTED(3), Message:<EMPTY>, reply=RaftClientReply:client-969CE6B78952->55566cff-d44d-47a7-b1c0-6ce92a96f3a6@group-D00CC5095A50, cid=119, FAILED org.apache.ratis.protocol.NotLeaderException: Server 55566cff-d44d-47a7-b1c0-6ce92a96f3a6 is not the leader (null). Request must be sent to leader., logIndex=0, commits[55566cff-d44d-47a7-b1c0-6ce92a96f3a6:c4]
2019-06-13 12:05:47,857 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-55566cff-d44d-47a7-b1c0-6ce92a96f3a6-group-D00CC5095A50: set stopIndex = 4
2019-06-13 12:05:47,857 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-969CE6B78952->55566cff-d44d-47a7-b1c0-6ce92a96f3a6@group-D00CC5095A50, cid=119, seq=0, Watch-ALL_COMMITTED(3), Message:<EMPTY>, reply=RaftClientReply:client-969CE6B78952->55566cff-d44d-47a7-b1c0-6ce92a96f3a6@group-D00CC5095A50, cid=119, FAILED org.apache.ratis.protocol.NotLeaderException: Server 55566cff-d44d-47a7-b1c0-6ce92a96f3a6 is not the leader (null). Request must be sent to leader., logIndex=0, commits[55566cff-d44d-47a7-b1c0-6ce92a96f3a6:c4]
2019-06-13 12:05:47,857 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-969CE6B78952->55566cff-d44d-47a7-b1c0-6ce92a96f3a6@group-D00CC5095A50, cid=119, seq=0, Watch-ALL_COMMITTED(3), Message:<EMPTY>, reply=RaftClientReply:client-969CE6B78952->55566cff-d44d-47a7-b1c0-6ce92a96f3a6@group-D00CC5095A50, cid=119, FAILED org.apache.ratis.protocol.NotLeaderException: Server 55566cff-d44d-47a7-b1c0-6ce92a96f3a6 is not the leader (null). Request must be sent to leader., logIndex=0, commits[55566cff-d44d-47a7-b1c0-6ce92a96f3a6:c4]
2019-06-13 12:05:47,857 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-13 12:05:47,857 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-91fdca9e-b12a-4e08-a7a5-68ae031781d0/datanode-1/data/ratis/321ab366-c2b2-4716-9801-d00cc5095a50/sm/snapshot.1_4
2019-06-13 12:05:47,857 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6:group-D00CC5095A50 closes. The last applied log index is 4
2019-06-13 12:05:47,857 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:47,859 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6-RaftLogWorker close()
2019-06-13 12:05:47,861 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-969CE6B78952->55566cff-d44d-47a7-b1c0-6ce92a96f3a6: receive RaftClientReply:client-969CE6B78952->55566cff-d44d-47a7-b1c0-6ce92a96f3a6@group-D00CC5095A50, cid=119, FAILED org.apache.ratis.protocol.NotLeaderException: Server 55566cff-d44d-47a7-b1c0-6ce92a96f3a6 is not the leader (null). Request must be sent to leader., logIndex=0, commits[55566cff-d44d-47a7-b1c0-6ce92a96f3a6:c4]
2019-06-13 12:05:47,865 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: shutdown server with port 43863 now
2019-06-13 12:05:47,866 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 55566cff-d44d-47a7-b1c0-6ce92a96f3a6: shutdown server with port 43863 successfully
2019-06-13 12:05:47,866 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 5-UnorderedRequestStreamObserver5: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 12:05:47,867 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:47,882 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:05:47,882 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@4e09c3b0{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:05:47,882 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@64f34c91{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:47,882 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@28ec92c9{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:05:47,883 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@218e28d9{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:47,883 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:05:47,883 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@3c380db5
2019-06-13 12:05:47,884 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:05:47,884 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:05:47,884 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: close
2019-06-13 12:05:47,884 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: shutdown group-365436E4D925
2019-06-13 12:05:47,884 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-365436E4D925,id=88174b5b-fd1f-4cea-9b56-69296f3acc88
2019-06-13 12:05:47,884 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: shutdown LeaderState
2019-06-13 12:05:47,885 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:47,885 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(88174b5b-fd1f-4cea-9b56-69296f3acc88 -> 3a90ff6a-d0a9-4724-8345-0dec5ca47bac): Wait interrupted by java.lang.InterruptedException
2019-06-13 12:05:47,885 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(88174b5b-fd1f-4cea-9b56-69296f3acc88 -> 248dcd6e-823e-4191-89f9-052df67b349c): Wait interrupted by java.lang.InterruptedException
2019-06-13 12:05:47,885 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:47,885 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-88174b5b-fd1f-4cea-9b56-69296f3acc88-group-365436E4D925: set stopIndex = 0
2019-06-13 12:05:47,885 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: appendEntries completed
2019-06-13 12:05:47,885 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 248dcd6e-823e-4191-89f9-052df67b349c: appendEntries completed
2019-06-13 12:05:47,885 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88:group-365436E4D925 closes. The last applied log index is 0
2019-06-13 12:05:47,886 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: follower 88174b5b-fd1f-4cea-9b56-69296f3acc88->3a90ff6a-d0a9-4724-8345-0dec5ca47bac(c0,m0,n1, attendVote=true, lastRpcSendTime=147, lastRpcResponseTime=147) response Completed
2019-06-13 12:05:47,886 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: follower 88174b5b-fd1f-4cea-9b56-69296f3acc88->248dcd6e-823e-4191-89f9-052df67b349c(c0,m0,n1, attendVote=true, lastRpcSendTime=148, lastRpcResponseTime=147) response Completed
2019-06-13 12:05:47,886 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88->248dcd6e-823e-4191-89f9-052df67b349c: nextIndex: updateUnconditionally 1 -> -1
2019-06-13 12:05:47,886 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:47,886 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88->3a90ff6a-d0a9-4724-8345-0dec5ca47bac: nextIndex: updateUnconditionally 1 -> -1
2019-06-13 12:05:47,888 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88-RaftLogWorker close()
2019-06-13 12:05:47,890 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: shutdown group-25516534BD90
2019-06-13 12:05:47,890 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-25516534BD90,id=88174b5b-fd1f-4cea-9b56-69296f3acc88
2019-06-13 12:05:47,890 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: shutdown LeaderState
2019-06-13 12:05:47,890 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:47,891 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-88174b5b-fd1f-4cea-9b56-69296f3acc88-group-25516534BD90: set stopIndex = 0
2019-06-13 12:05:47,891 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:47,891 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88:group-25516534BD90 closes. The last applied log index is 0
2019-06-13 12:05:47,891 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:47,893 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88-RaftLogWorker close()
2019-06-13 12:05:47,895 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: shutdown server with port 43303 now
2019-06-13 12:05:47,895 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 88174b5b-fd1f-4cea-9b56-69296f3acc88: shutdown server with port 43303 successfully
2019-06-13 12:05:47,896 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:47,906 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:05:47,906 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@ab5e63{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:05:47,907 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@6a434cdd{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:47,907 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@d6d88b1{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:05:47,907 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@1d2b49b2{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:47,908 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:05:47,908 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@15db4dc
2019-06-13 12:05:47,908 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:05:47,908 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:05:47,908 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: close
2019-06-13 12:05:47,908 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: shutdown group-365436E4D925
2019-06-13 12:05:47,908 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-365436E4D925,id=3a90ff6a-d0a9-4724-8345-0dec5ca47bac
2019-06-13 12:05:47,909 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: shutdown FollowerState
2019-06-13 12:05:47,909 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-3a90ff6a-d0a9-4724-8345-0dec5ca47bac-group-365436E4D925: set stopIndex = 0
2019-06-13 12:05:47,909 INFO  impl.FollowerState (FollowerState.java:run(109)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:47,909 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:47,909 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:group-365436E4D925 closes. The last applied log index is 0
2019-06-13 12:05:47,909 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:47,911 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac-RaftLogWorker close()
2019-06-13 12:05:47,912 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: shutdown group-8CC7247B1F04
2019-06-13 12:05:47,913 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-8CC7247B1F04,id=3a90ff6a-d0a9-4724-8345-0dec5ca47bac
2019-06-13 12:05:47,913 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: shutdown LeaderState
2019-06-13 12:05:47,913 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:47,913 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-3a90ff6a-d0a9-4724-8345-0dec5ca47bac-group-8CC7247B1F04: set stopIndex = 0
2019-06-13 12:05:47,913 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:47,913 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac:group-8CC7247B1F04 closes. The last applied log index is 0
2019-06-13 12:05:47,914 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:47,915 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac-RaftLogWorker close()
2019-06-13 12:05:47,917 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: shutdown server with port 36861 now
2019-06-13 12:05:47,917 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 3a90ff6a-d0a9-4724-8345-0dec5ca47bac: shutdown server with port 36861 successfully
2019-06-13 12:05:47,918 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:47,930 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:05:47,931 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@4b20b431{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:05:47,931 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@46875fae{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:47,932 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@6000ca67{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:05:47,932 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@18bd3135{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:47,932 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:05:47,932 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@3c251258
2019-06-13 12:05:47,933 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:05:47,933 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:05:47,933 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 248dcd6e-823e-4191-89f9-052df67b349c: close
2019-06-13 12:05:47,933 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 248dcd6e-823e-4191-89f9-052df67b349c: shutdown group-365436E4D925
2019-06-13 12:05:47,933 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-365436E4D925,id=248dcd6e-823e-4191-89f9-052df67b349c
2019-06-13 12:05:47,933 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 248dcd6e-823e-4191-89f9-052df67b349c: shutdown FollowerState
2019-06-13 12:05:47,933 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-248dcd6e-823e-4191-89f9-052df67b349c-group-365436E4D925: set stopIndex = 0
2019-06-13 12:05:47,933 INFO  impl.FollowerState (FollowerState.java:run(109)) - 248dcd6e-823e-4191-89f9-052df67b349c: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 12:05:47,933 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:47,934 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 248dcd6e-823e-4191-89f9-052df67b349c:group-365436E4D925 closes. The last applied log index is 0
2019-06-13 12:05:47,934 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 248dcd6e-823e-4191-89f9-052df67b349c-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:47,935 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 248dcd6e-823e-4191-89f9-052df67b349c-RaftLogWorker close()
2019-06-13 12:05:47,937 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 248dcd6e-823e-4191-89f9-052df67b349c: shutdown group-8689413AF23C
2019-06-13 12:05:47,937 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-8689413AF23C,id=248dcd6e-823e-4191-89f9-052df67b349c
2019-06-13 12:05:47,937 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 248dcd6e-823e-4191-89f9-052df67b349c: shutdown LeaderState
2019-06-13 12:05:47,937 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 248dcd6e-823e-4191-89f9-052df67b349c-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:47,937 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-248dcd6e-823e-4191-89f9-052df67b349c-group-8689413AF23C: set stopIndex = 0
2019-06-13 12:05:47,937 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:47,938 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 248dcd6e-823e-4191-89f9-052df67b349c:group-8689413AF23C closes. The last applied log index is 0
2019-06-13 12:05:47,938 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 248dcd6e-823e-4191-89f9-052df67b349c-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:47,939 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 248dcd6e-823e-4191-89f9-052df67b349c-RaftLogWorker close()
2019-06-13 12:05:47,941 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 248dcd6e-823e-4191-89f9-052df67b349c: shutdown server with port 37335 now
2019-06-13 12:05:47,941 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 248dcd6e-823e-4191-89f9-052df67b349c: shutdown server with port 37335 successfully
2019-06-13 12:05:47,942 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:47,951 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:05:47,951 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@75edfe9a{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:05:47,952 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@468d1fcc{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:47,952 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@67f8586f{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:05:47,952 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@37ddb835{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:47,952 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-13 12:05:47,953 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@8d56ddd
2019-06-13 12:05:47,953 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-13 12:05:47,953 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 12:05:47,953 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 249b284e-4f6e-49ae-a42c-bd46086d3184: close
2019-06-13 12:05:47,953 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 249b284e-4f6e-49ae-a42c-bd46086d3184: shutdown group-C9077D0202A9
2019-06-13 12:05:47,953 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C9077D0202A9,id=249b284e-4f6e-49ae-a42c-bd46086d3184
2019-06-13 12:05:47,954 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 249b284e-4f6e-49ae-a42c-bd46086d3184: shutdown LeaderState
2019-06-13 12:05:47,954 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 249b284e-4f6e-49ae-a42c-bd46086d3184-PendingRequests: sendNotLeaderResponses
2019-06-13 12:05:47,954 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-249b284e-4f6e-49ae-a42c-bd46086d3184-group-C9077D0202A9: set stopIndex = 0
2019-06-13 12:05:47,954 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-13 12:05:47,954 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 249b284e-4f6e-49ae-a42c-bd46086d3184:group-C9077D0202A9 closes. The last applied log index is 0
2019-06-13 12:05:47,954 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 249b284e-4f6e-49ae-a42c-bd46086d3184-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 12:05:47,956 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 249b284e-4f6e-49ae-a42c-bd46086d3184-RaftLogWorker close()
2019-06-13 12:05:47,957 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 249b284e-4f6e-49ae-a42c-bd46086d3184: shutdown server with port 38467 now
2019-06-13 12:05:47,958 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 249b284e-4f6e-49ae-a42c-bd46086d3184: shutdown server with port 38467 successfully
2019-06-13 12:05:47,959 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:47,968 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-13 12:05:47,969 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@34ccce55{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-13 12:05:47,969 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@7668edd7{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-13 12:05:47,969 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@6f2a13c7{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-13 12:05:47,970 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@76737130{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-13 12:05:48,001 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:48,006 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:48,006 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:48,006 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 12:05:48,006 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
