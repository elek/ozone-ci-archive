2019-06-14 13:02:17,545 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-14 13:02:17,626 INFO  ozone.RatisTestHelper (RatisTestHelper.java:initRatisConf(109)) - dfs.container.ratis.rpc.type = GRPC
2019-06-14 13:02:17,687 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 13:02:17,696 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 44399 (custom)
2019-06-14 13:02:17,696 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 13:02:17,699 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 13:02:17,700 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 13:02:17,700 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 13:02:17,745 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1a7a7e6c-54eb-4ade-9938-2fcb0bae3765] (custom)
2019-06-14 13:02:17,750 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765 at port 44399
2019-06-14 13:02:17,795 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765: start RPC server
2019-06-14 13:02:17,797 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765: GrpcService started, listening on 0.0.0.0/0.0.0.0:44399
2019-06-14 13:02:17,879 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765: addNew group-CAE67BC9F04F:[1a7a7e6c-54eb-4ade-9938-2fcb0bae3765:0.0.0.0:44399] returns group-CAE67BC9F04F:java.util.concurrent.CompletableFuture@76585b7f[Not completed]
2019-06-14 13:02:17,886 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765: new RaftServerImpl for group-CAE67BC9F04F:[1a7a7e6c-54eb-4ade-9938-2fcb0bae3765:0.0.0.0:44399] with ContainerStateMachine:uninitialized
2019-06-14 13:02:17,887 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 13:02:17,887 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 13:02:17,889 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 13:02:17,889 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 13:02:17,895 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765:group-CAE67BC9F04F ConfigurationManager, init=-1: [1a7a7e6c-54eb-4ade-9938-2fcb0bae3765:0.0.0.0:44399], old=null, confs=<EMPTY_MAP>
2019-06-14 13:02:17,895 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1a7a7e6c-54eb-4ade-9938-2fcb0bae3765] (custom)
2019-06-14 13:02:17,901 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1a7a7e6c-54eb-4ade-9938-2fcb0bae3765/e10488aa-e821-4510-b68e-cae67bc9f04f does not exist. Creating ...
2019-06-14 13:02:17,914 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1a7a7e6c-54eb-4ade-9938-2fcb0bae3765/e10488aa-e821-4510-b68e-cae67bc9f04f/in_use.lock acquired by nodename 31068@ozone-8z6qt-916494304
2019-06-14 13:02:17,921 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1a7a7e6c-54eb-4ade-9938-2fcb0bae3765/e10488aa-e821-4510-b68e-cae67bc9f04f has been successfully formatted.
2019-06-14 13:02:17,923 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 13:02:17,923 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 13:02:17,925 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 13:02:17,926 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 13:02:17,929 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 13:02:17,932 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 13:02:17,934 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1a7a7e6c-54eb-4ade-9938-2fcb0bae3765/e10488aa-e821-4510-b68e-cae67bc9f04f
2019-06-14 13:02:17,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 13:02:17,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 13:02:17,936 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 13:02:17,936 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 13:02:17,936 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 13:02:17,937 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 13:02:17,938 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 13:02:17,938 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 13:02:17,938 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 13:02:17,941 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 13:02:17,949 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 13:02:17,949 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 13:02:17,950 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 13:02:17,962 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765: start group-CAE67BC9F04F
2019-06-14 13:02:17,963 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765:group-CAE67BC9F04F changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 13:02:17,964 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765: start FollowerState
2019-06-14 13:02:18,007 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-CAE67BC9F04F,id=1a7a7e6c-54eb-4ade-9938-2fcb0bae3765
2019-06-14 13:02:18,075 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-99EE19F7540B->1a7a7e6c-54eb-4ade-9938-2fcb0bae3765: receive RaftClientReply:client-99EE19F7540B->1a7a7e6c-54eb-4ade-9938-2fcb0bae3765@group-CAE67BC9F04F, cid=1, FAILED org.apache.ratis.protocol.NotLeaderException: Server 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765 is not the leader (null). Request must be sent to leader., logIndex=0, commits[1a7a7e6c-54eb-4ade-9938-2fcb0bae3765:c-1]
2019-06-14 13:02:19,083 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-99EE19F7540B->1a7a7e6c-54eb-4ade-9938-2fcb0bae3765: receive RaftClientReply:client-99EE19F7540B->1a7a7e6c-54eb-4ade-9938-2fcb0bae3765@group-CAE67BC9F04F, cid=1, FAILED org.apache.ratis.protocol.NotLeaderException: Server 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765 is not the leader (null). Request must be sent to leader., logIndex=0, commits[1a7a7e6c-54eb-4ade-9938-2fcb0bae3765:c-1]
2019-06-14 13:02:19,164 INFO  impl.FollowerState (FollowerState.java:run(101)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765:group-CAE67BC9F04F changes to CANDIDATE, lastRpcTime:1200, electionTimeout:1200ms
2019-06-14 13:02:19,164 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765: shutdown FollowerState
2019-06-14 13:02:19,165 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765:group-CAE67BC9F04F changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 13:02:19,166 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765: start LeaderElection
2019-06-14 13:02:19,169 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765:group-CAE67BC9F04F:LeaderElection1: begin an election at term 1 for -1: [1a7a7e6c-54eb-4ade-9938-2fcb0bae3765:0.0.0.0:44399], old=null
2019-06-14 13:02:19,170 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765: shutdown LeaderElection
2019-06-14 13:02:19,171 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765:group-CAE67BC9F04F changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 13:02:19,171 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765:group-CAE67BC9F04F change Leader from null to 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765 at term 1 for becomeLeader, leader elected after 1247ms
2019-06-14 13:02:19,175 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 13:02:19,176 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 13:02:19,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 13:02:19,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 13:02:19,184 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765: start LeaderState
2019-06-14 13:02:19,196 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765-RaftLogWorker: Starting segment from index:0
2019-06-14 13:02:19,203 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765:group-CAE67BC9F04F set configuration 0: [1a7a7e6c-54eb-4ade-9938-2fcb0bae3765:0.0.0.0:44399], old=null at 0
2019-06-14 13:02:19,322 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1a7a7e6c-54eb-4ade-9938-2fcb0bae3765/e10488aa-e821-4510-b68e-cae67bc9f04f/current/log_inprogress_0
2019-06-14 13:02:20,099 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-14 13:02:20,103 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-99EE19F7540B->1a7a7e6c-54eb-4ade-9938-2fcb0bae3765: receive RaftClientReply:client-99EE19F7540B->1a7a7e6c-54eb-4ade-9938-2fcb0bae3765@group-CAE67BC9F04F, cid=1, SUCCESS, logIndex=1, commits[1a7a7e6c-54eb-4ade-9938-2fcb0bae3765:c2]
2019-06-14 13:02:20,105 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-14 13:02:20,119 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-BA74FB5E700C->1a7a7e6c-54eb-4ade-9938-2fcb0bae3765: receive RaftClientReply:client-BA74FB5E700C->1a7a7e6c-54eb-4ade-9938-2fcb0bae3765@group-CAE67BC9F04F, cid=2, SUCCESS, logIndex=3, commits[1a7a7e6c-54eb-4ade-9938-2fcb0bae3765:c3]
2019-06-14 13:02:20,122 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765: close
2019-06-14 13:02:20,123 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765: shutdown group-CAE67BC9F04F
2019-06-14 13:02:20,124 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-CAE67BC9F04F,id=1a7a7e6c-54eb-4ade-9938-2fcb0bae3765
2019-06-14 13:02:20,124 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765: shutdown LeaderState
2019-06-14 13:02:20,124 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 13:02:20,125 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765-PendingRequests: sendNotLeaderResponses
2019-06-14 13:02:20,125 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 13:02:20,127 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-1a7a7e6c-54eb-4ade-9938-2fcb0bae3765-group-CAE67BC9F04F: set stopIndex = 4
2019-06-14 13:02:20,127 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-14 13:02:20,127 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1a7a7e6c-54eb-4ade-9938-2fcb0bae3765/e10488aa-e821-4510-b68e-cae67bc9f04f/sm/snapshot.1_3
2019-06-14 13:02:20,135 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765:group-CAE67BC9F04F closes. The last applied log index is 4
2019-06-14 13:02:20,136 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 13:02:20,137 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765-RaftLogWorker close()
2019-06-14 13:02:20,137 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765: shutdown server with port 44399 now
2019-06-14 13:02:20,139 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 1a7a7e6c-54eb-4ade-9938-2fcb0bae3765: shutdown server with port 44399 successfully
2019-06-14 13:02:20,160 INFO  ozone.RatisTestHelper (RatisTestHelper.java:initRatisConf(109)) - dfs.container.ratis.rpc.type = GRPC
2019-06-14 13:02:20,162 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 13:02:20,164 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 41783 (custom)
2019-06-14 13:02:20,165 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 13:02:20,165 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 13:02:20,165 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 13:02:20,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 13:02:20,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d1c2f7bb-f54e-47c9-b23d-67406c27fe04] (custom)
2019-06-14 13:02:20,167 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis d1c2f7bb-f54e-47c9-b23d-67406c27fe04 at port 41783
2019-06-14 13:02:20,183 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04: start RPC server
2019-06-14 13:02:20,184 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04: GrpcService started, listening on 0.0.0.0/0.0.0.0:41783
Jun 14, 2019 1:02:20 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=17, target=0.0.0.0:44399} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:130)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 14, 2019 1:02:20 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=9, target=0.0.0.0:33393} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connectToDatanode(XceiverClientGrpc.java:163)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connect(XceiverClientGrpc.java:120)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:227)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServer(TestSecureContainerServer.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-14 13:02:20,214 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04: addNew group-C9D7C5512378:[d1c2f7bb-f54e-47c9-b23d-67406c27fe04:0.0.0.0:41783, 0084ef29-047b-4c10-a3b3-59ea352dafb8:0.0.0.0:36477, 8d565c00-7d2c-4f59-8814-272de98e8af9:0.0.0.0:36531] returns group-C9D7C5512378:java.util.concurrent.CompletableFuture@647f763f[Not completed]
2019-06-14 13:02:20,215 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04: new RaftServerImpl for group-C9D7C5512378:[d1c2f7bb-f54e-47c9-b23d-67406c27fe04:0.0.0.0:41783, 0084ef29-047b-4c10-a3b3-59ea352dafb8:0.0.0.0:36477, 8d565c00-7d2c-4f59-8814-272de98e8af9:0.0.0.0:36531] with ContainerStateMachine:uninitialized
2019-06-14 13:02:20,215 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 13:02:20,215 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 13:02:20,215 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 13:02:20,215 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 13:02:20,215 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04:group-C9D7C5512378 ConfigurationManager, init=-1: [d1c2f7bb-f54e-47c9-b23d-67406c27fe04:0.0.0.0:41783, 0084ef29-047b-4c10-a3b3-59ea352dafb8:0.0.0.0:36477, 8d565c00-7d2c-4f59-8814-272de98e8af9:0.0.0.0:36531], old=null, confs=<EMPTY_MAP>
2019-06-14 13:02:20,216 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d1c2f7bb-f54e-47c9-b23d-67406c27fe04] (custom)
2019-06-14 13:02:20,216 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d1c2f7bb-f54e-47c9-b23d-67406c27fe04/d773cc71-8272-4259-a589-c9d7c5512378 does not exist. Creating ...
2019-06-14 13:02:20,218 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d1c2f7bb-f54e-47c9-b23d-67406c27fe04/d773cc71-8272-4259-a589-c9d7c5512378/in_use.lock acquired by nodename 31068@ozone-8z6qt-916494304
2019-06-14 13:02:20,220 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d1c2f7bb-f54e-47c9-b23d-67406c27fe04/d773cc71-8272-4259-a589-c9d7c5512378 has been successfully formatted.
2019-06-14 13:02:20,220 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 13:02:20,220 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 13:02:20,221 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 13:02:20,221 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 13:02:20,221 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 13:02:20,221 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 13:02:20,221 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new d1c2f7bb-f54e-47c9-b23d-67406c27fe04-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d1c2f7bb-f54e-47c9-b23d-67406c27fe04/d773cc71-8272-4259-a589-c9d7c5512378
2019-06-14 13:02:20,221 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 13:02:20,221 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 13:02:20,221 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 13:02:20,221 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 13:02:20,222 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 13:02:20,222 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 13:02:20,222 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 13:02:20,222 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 13:02:20,222 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 13:02:20,222 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 13:02:20,223 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 13:02:20,223 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 13:02:20,223 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 13:02:20,223 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04: start group-C9D7C5512378
2019-06-14 13:02:20,223 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04:group-C9D7C5512378 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 13:02:20,224 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04: start FollowerState
2019-06-14 13:02:20,224 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C9D7C5512378,id=d1c2f7bb-f54e-47c9-b23d-67406c27fe04
2019-06-14 13:02:20,229 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 13:02:20,229 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 36531 (custom)
2019-06-14 13:02:20,229 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 13:02:20,230 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 13:02:20,230 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 13:02:20,230 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 13:02:20,231 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/8d565c00-7d2c-4f59-8814-272de98e8af9] (custom)
2019-06-14 13:02:20,231 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 8d565c00-7d2c-4f59-8814-272de98e8af9 at port 36531
2019-06-14 13:02:20,238 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 8d565c00-7d2c-4f59-8814-272de98e8af9: start RPC server
2019-06-14 13:02:20,239 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 8d565c00-7d2c-4f59-8814-272de98e8af9: GrpcService started, listening on 0.0.0.0/0.0.0.0:36531
2019-06-14 13:02:20,260 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 8d565c00-7d2c-4f59-8814-272de98e8af9: addNew group-C9D7C5512378:[d1c2f7bb-f54e-47c9-b23d-67406c27fe04:0.0.0.0:41783, 0084ef29-047b-4c10-a3b3-59ea352dafb8:0.0.0.0:36477, 8d565c00-7d2c-4f59-8814-272de98e8af9:0.0.0.0:36531] returns group-C9D7C5512378:java.util.concurrent.CompletableFuture@1016d740[Not completed]
2019-06-14 13:02:20,260 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 8d565c00-7d2c-4f59-8814-272de98e8af9: new RaftServerImpl for group-C9D7C5512378:[d1c2f7bb-f54e-47c9-b23d-67406c27fe04:0.0.0.0:41783, 0084ef29-047b-4c10-a3b3-59ea352dafb8:0.0.0.0:36477, 8d565c00-7d2c-4f59-8814-272de98e8af9:0.0.0.0:36531] with ContainerStateMachine:uninitialized
2019-06-14 13:02:20,260 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 13:02:20,261 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 13:02:20,261 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 13:02:20,261 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 13:02:20,261 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 8d565c00-7d2c-4f59-8814-272de98e8af9:group-C9D7C5512378 ConfigurationManager, init=-1: [d1c2f7bb-f54e-47c9-b23d-67406c27fe04:0.0.0.0:41783, 0084ef29-047b-4c10-a3b3-59ea352dafb8:0.0.0.0:36477, 8d565c00-7d2c-4f59-8814-272de98e8af9:0.0.0.0:36531], old=null, confs=<EMPTY_MAP>
2019-06-14 13:02:20,261 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/8d565c00-7d2c-4f59-8814-272de98e8af9] (custom)
2019-06-14 13:02:20,261 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/8d565c00-7d2c-4f59-8814-272de98e8af9/d773cc71-8272-4259-a589-c9d7c5512378 does not exist. Creating ...
2019-06-14 13:02:20,263 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/8d565c00-7d2c-4f59-8814-272de98e8af9/d773cc71-8272-4259-a589-c9d7c5512378/in_use.lock acquired by nodename 31068@ozone-8z6qt-916494304
2019-06-14 13:02:20,266 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/8d565c00-7d2c-4f59-8814-272de98e8af9/d773cc71-8272-4259-a589-c9d7c5512378 has been successfully formatted.
2019-06-14 13:02:20,266 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 13:02:20,266 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 13:02:20,266 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 13:02:20,266 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 13:02:20,266 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 13:02:20,267 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 13:02:20,267 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 8d565c00-7d2c-4f59-8814-272de98e8af9-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/8d565c00-7d2c-4f59-8814-272de98e8af9/d773cc71-8272-4259-a589-c9d7c5512378
2019-06-14 13:02:20,267 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 13:02:20,267 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 13:02:20,267 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 13:02:20,267 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 13:02:20,267 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 13:02:20,268 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 13:02:20,268 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 13:02:20,268 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 13:02:20,268 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 13:02:20,268 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 13:02:20,269 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 13:02:20,269 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 13:02:20,269 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 13:02:20,269 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 8d565c00-7d2c-4f59-8814-272de98e8af9: start group-C9D7C5512378
2019-06-14 13:02:20,269 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8d565c00-7d2c-4f59-8814-272de98e8af9:group-C9D7C5512378 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 13:02:20,270 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8d565c00-7d2c-4f59-8814-272de98e8af9: start FollowerState
2019-06-14 13:02:20,270 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C9D7C5512378,id=8d565c00-7d2c-4f59-8814-272de98e8af9
2019-06-14 13:02:20,278 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 13:02:20,278 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 36477 (custom)
2019-06-14 13:02:20,279 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 13:02:20,279 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 13:02:20,279 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 13:02:20,279 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 13:02:20,279 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/0084ef29-047b-4c10-a3b3-59ea352dafb8] (custom)
2019-06-14 13:02:20,280 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 0084ef29-047b-4c10-a3b3-59ea352dafb8 at port 36477
2019-06-14 13:02:20,286 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8: start RPC server
2019-06-14 13:02:20,287 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8: GrpcService started, listening on 0.0.0.0/0.0.0.0:36477
2019-06-14 13:02:20,303 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8: addNew group-C9D7C5512378:[d1c2f7bb-f54e-47c9-b23d-67406c27fe04:0.0.0.0:41783, 0084ef29-047b-4c10-a3b3-59ea352dafb8:0.0.0.0:36477, 8d565c00-7d2c-4f59-8814-272de98e8af9:0.0.0.0:36531] returns group-C9D7C5512378:java.util.concurrent.CompletableFuture@41520b9b[Not completed]
2019-06-14 13:02:20,303 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8: new RaftServerImpl for group-C9D7C5512378:[d1c2f7bb-f54e-47c9-b23d-67406c27fe04:0.0.0.0:41783, 0084ef29-047b-4c10-a3b3-59ea352dafb8:0.0.0.0:36477, 8d565c00-7d2c-4f59-8814-272de98e8af9:0.0.0.0:36531] with ContainerStateMachine:uninitialized
2019-06-14 13:02:20,304 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 13:02:20,304 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 13:02:20,304 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 13:02:20,304 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 13:02:20,304 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8:group-C9D7C5512378 ConfigurationManager, init=-1: [d1c2f7bb-f54e-47c9-b23d-67406c27fe04:0.0.0.0:41783, 0084ef29-047b-4c10-a3b3-59ea352dafb8:0.0.0.0:36477, 8d565c00-7d2c-4f59-8814-272de98e8af9:0.0.0.0:36531], old=null, confs=<EMPTY_MAP>
2019-06-14 13:02:20,305 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/0084ef29-047b-4c10-a3b3-59ea352dafb8] (custom)
2019-06-14 13:02:20,305 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/0084ef29-047b-4c10-a3b3-59ea352dafb8/d773cc71-8272-4259-a589-c9d7c5512378 does not exist. Creating ...
2019-06-14 13:02:20,307 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/0084ef29-047b-4c10-a3b3-59ea352dafb8/d773cc71-8272-4259-a589-c9d7c5512378/in_use.lock acquired by nodename 31068@ozone-8z6qt-916494304
2019-06-14 13:02:20,309 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/0084ef29-047b-4c10-a3b3-59ea352dafb8/d773cc71-8272-4259-a589-c9d7c5512378 has been successfully formatted.
2019-06-14 13:02:20,309 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 13:02:20,309 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 13:02:20,309 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 13:02:20,309 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 13:02:20,309 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 13:02:20,309 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 13:02:20,309 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 0084ef29-047b-4c10-a3b3-59ea352dafb8-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/0084ef29-047b-4c10-a3b3-59ea352dafb8/d773cc71-8272-4259-a589-c9d7c5512378
2019-06-14 13:02:20,310 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 13:02:20,310 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 13:02:20,310 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 13:02:20,310 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 13:02:20,310 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 13:02:20,310 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 13:02:20,310 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 13:02:20,310 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 13:02:20,310 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 13:02:20,310 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 13:02:20,311 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 13:02:20,311 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 13:02:20,311 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 13:02:20,311 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8: start group-C9D7C5512378
2019-06-14 13:02:20,312 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8:group-C9D7C5512378 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 13:02:20,312 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8: start FollowerState
2019-06-14 13:02:20,312 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C9D7C5512378,id=0084ef29-047b-4c10-a3b3-59ea352dafb8
2019-06-14 13:02:20,324 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-ABCBBE99B3E3->d1c2f7bb-f54e-47c9-b23d-67406c27fe04: receive RaftClientReply:client-ABCBBE99B3E3->d1c2f7bb-f54e-47c9-b23d-67406c27fe04@group-C9D7C5512378, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server d1c2f7bb-f54e-47c9-b23d-67406c27fe04 is not the leader (0084ef29-047b-4c10-a3b3-59ea352dafb8:0.0.0.0:36477). Request must be sent to leader., logIndex=0, commits[d1c2f7bb-f54e-47c9-b23d-67406c27fe04:c-1]
2019-06-14 13:02:20,325 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 13:02:21,281 INFO  impl.FollowerState (FollowerState.java:run(101)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04:group-C9D7C5512378 changes to CANDIDATE, lastRpcTime:1057, electionTimeout:1057ms
2019-06-14 13:02:21,282 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04: shutdown FollowerState
2019-06-14 13:02:21,282 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04:group-C9D7C5512378 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 13:02:21,282 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04: start LeaderElection
2019-06-14 13:02:21,285 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04:group-C9D7C5512378:LeaderElection2: begin an election at term 1 for -1: [d1c2f7bb-f54e-47c9-b23d-67406c27fe04:0.0.0.0:41783, 0084ef29-047b-4c10-a3b3-59ea352dafb8:0.0.0.0:36477, 8d565c00-7d2c-4f59-8814-272de98e8af9:0.0.0.0:36531], old=null
2019-06-14 13:02:21,301 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8d565c00-7d2c-4f59-8814-272de98e8af9:group-C9D7C5512378 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:d1c2f7bb-f54e-47c9-b23d-67406c27fe04
2019-06-14 13:02:21,301 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8:group-C9D7C5512378 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:d1c2f7bb-f54e-47c9-b23d-67406c27fe04
2019-06-14 13:02:21,302 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 8d565c00-7d2c-4f59-8814-272de98e8af9: shutdown FollowerState
2019-06-14 13:02:21,302 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8: shutdown FollowerState
2019-06-14 13:02:21,302 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8: start FollowerState
2019-06-14 13:02:21,302 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8d565c00-7d2c-4f59-8814-272de98e8af9: start FollowerState
2019-06-14 13:02:21,302 INFO  impl.FollowerState (FollowerState.java:run(109)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 13:02:21,302 INFO  impl.FollowerState (FollowerState.java:run(109)) - 8d565c00-7d2c-4f59-8814-272de98e8af9: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 13:02:21,310 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04:group-C9D7C5512378:LeaderElection2: Election PASSED; received 1 response(s) [d1c2f7bb-f54e-47c9-b23d-67406c27fe04->0084ef29-047b-4c10-a3b3-59ea352dafb8,true-t1] and 0 exception(s); d1c2f7bb-f54e-47c9-b23d-67406c27fe04:t1, leader=null, voted=d1c2f7bb-f54e-47c9-b23d-67406c27fe04, raftlog=d1c2f7bb-f54e-47c9-b23d-67406c27fe04-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [d1c2f7bb-f54e-47c9-b23d-67406c27fe04:0.0.0.0:41783, 0084ef29-047b-4c10-a3b3-59ea352dafb8:0.0.0.0:36477, 8d565c00-7d2c-4f59-8814-272de98e8af9:0.0.0.0:36531], old=null
2019-06-14 13:02:21,311 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04: shutdown LeaderElection
2019-06-14 13:02:21,311 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04:group-C9D7C5512378 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 13:02:21,311 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04:group-C9D7C5512378 change Leader from null to d1c2f7bb-f54e-47c9-b23d-67406c27fe04 at term 1 for becomeLeader, leader elected after 1090ms
2019-06-14 13:02:21,311 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 13:02:21,311 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 13:02:21,311 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 13:02:21,312 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 13:02:21,314 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 13:02:21,314 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 13:02:21,314 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
Jun 14, 2019 1:02:21 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=43, target=0.0.0.0:36531} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:131)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 14, 2019 1:02:21 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=51, target=0.0.0.0:36477} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:131)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 14, 2019 1:02:21 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=35, target=0.0.0.0:41783} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:131)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-14 13:02:21,375 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 13:02:21,375 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 13:02:21,375 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 13:02:21,375 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 13:02:21,376 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 13:02:21,376 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 13:02:21,376 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 13:02:21,376 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 13:02:21,377 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 13:02:21,377 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04: start LeaderState
2019-06-14 13:02:21,377 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04-RaftLogWorker: Starting segment from index:0
2019-06-14 13:02:21,403 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04:group-C9D7C5512378 set configuration 0: [d1c2f7bb-f54e-47c9-b23d-67406c27fe04:0.0.0.0:41783, 0084ef29-047b-4c10-a3b3-59ea352dafb8:0.0.0.0:36477, 8d565c00-7d2c-4f59-8814-272de98e8af9:0.0.0.0:36531], old=null at 0
2019-06-14 13:02:21,416 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-ABCBBE99B3E3->8d565c00-7d2c-4f59-8814-272de98e8af9: receive RaftClientReply:client-ABCBBE99B3E3->8d565c00-7d2c-4f59-8814-272de98e8af9@group-C9D7C5512378, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server 8d565c00-7d2c-4f59-8814-272de98e8af9 is not the leader (d1c2f7bb-f54e-47c9-b23d-67406c27fe04:0.0.0.0:41783). Request must be sent to leader., logIndex=0, commits[8d565c00-7d2c-4f59-8814-272de98e8af9:c-1]
2019-06-14 13:02:21,416 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d1c2f7bb-f54e-47c9-b23d-67406c27fe04/d773cc71-8272-4259-a589-c9d7c5512378/current/log_inprogress_0
2019-06-14 13:02:21,418 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8:group-C9D7C5512378 change Leader from null to d1c2f7bb-f54e-47c9-b23d-67406c27fe04 at term 1 for appendEntries, leader elected after 1109ms
2019-06-14 13:02:21,420 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 8d565c00-7d2c-4f59-8814-272de98e8af9:group-C9D7C5512378 change Leader from null to d1c2f7bb-f54e-47c9-b23d-67406c27fe04 at term 1 for appendEntries, leader elected after 1152ms
2019-06-14 13:02:21,420 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 13:02:21,434 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8:group-C9D7C5512378 set configuration 0: [d1c2f7bb-f54e-47c9-b23d-67406c27fe04:0.0.0.0:41783, 0084ef29-047b-4c10-a3b3-59ea352dafb8:0.0.0.0:36477, 8d565c00-7d2c-4f59-8814-272de98e8af9:0.0.0.0:36531], old=null at 0
2019-06-14 13:02:21,435 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 8d565c00-7d2c-4f59-8814-272de98e8af9:group-C9D7C5512378 set configuration 0: [d1c2f7bb-f54e-47c9-b23d-67406c27fe04:0.0.0.0:41783, 0084ef29-047b-4c10-a3b3-59ea352dafb8:0.0.0.0:36477, 8d565c00-7d2c-4f59-8814-272de98e8af9:0.0.0.0:36531], old=null at 0
2019-06-14 13:02:21,435 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8-RaftLogWorker: Starting segment from index:0
2019-06-14 13:02:21,435 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 8d565c00-7d2c-4f59-8814-272de98e8af9-RaftLogWorker: Starting segment from index:0
2019-06-14 13:02:21,471 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/0084ef29-047b-4c10-a3b3-59ea352dafb8/d773cc71-8272-4259-a589-c9d7c5512378/current/log_inprogress_0
2019-06-14 13:02:21,487 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 8d565c00-7d2c-4f59-8814-272de98e8af9-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/8d565c00-7d2c-4f59-8814-272de98e8af9/d773cc71-8272-4259-a589-c9d7c5512378/current/log_inprogress_0
2019-06-14 13:02:22,428 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-ABCBBE99B3E3->0084ef29-047b-4c10-a3b3-59ea352dafb8: receive RaftClientReply:client-ABCBBE99B3E3->0084ef29-047b-4c10-a3b3-59ea352dafb8@group-C9D7C5512378, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server 0084ef29-047b-4c10-a3b3-59ea352dafb8 is not the leader (d1c2f7bb-f54e-47c9-b23d-67406c27fe04:0.0.0.0:41783). Request must be sent to leader., logIndex=0, commits[0084ef29-047b-4c10-a3b3-59ea352dafb8:c0, d1c2f7bb-f54e-47c9-b23d-67406c27fe04:c0, 8d565c00-7d2c-4f59-8814-272de98e8af9:c0]
2019-06-14 13:02:22,429 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 13:02:23,438 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-14 13:02:23,446 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-ABCBBE99B3E3->d1c2f7bb-f54e-47c9-b23d-67406c27fe04: receive RaftClientReply:client-ABCBBE99B3E3->d1c2f7bb-f54e-47c9-b23d-67406c27fe04@group-C9D7C5512378, cid=6, SUCCESS, logIndex=1, commits[d1c2f7bb-f54e-47c9-b23d-67406c27fe04:c1, 0084ef29-047b-4c10-a3b3-59ea352dafb8:c0, 8d565c00-7d2c-4f59-8814-272de98e8af9:c0]
2019-06-14 13:02:23,447 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-14 13:02:23,447 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-14 13:02:23,447 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-14 13:02:23,466 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AEF815A4574F->d1c2f7bb-f54e-47c9-b23d-67406c27fe04: receive RaftClientReply:client-AEF815A4574F->d1c2f7bb-f54e-47c9-b23d-67406c27fe04@group-C9D7C5512378, cid=7, SUCCESS, logIndex=3, commits[d1c2f7bb-f54e-47c9-b23d-67406c27fe04:c3, 0084ef29-047b-4c10-a3b3-59ea352dafb8:c2, 8d565c00-7d2c-4f59-8814-272de98e8af9:c2]
2019-06-14 13:02:23,478 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04: close
2019-06-14 13:02:23,478 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04: shutdown group-C9D7C5512378
2019-06-14 13:02:23,478 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C9D7C5512378,id=d1c2f7bb-f54e-47c9-b23d-67406c27fe04
2019-06-14 13:02:23,479 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04: shutdown LeaderState
2019-06-14 13:02:23,479 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04-PendingRequests: sendNotLeaderResponses
2019-06-14 13:02:23,479 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(d1c2f7bb-f54e-47c9-b23d-67406c27fe04 -> 8d565c00-7d2c-4f59-8814-272de98e8af9): Wait interrupted by java.lang.InterruptedException
2019-06-14 13:02:23,480 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(d1c2f7bb-f54e-47c9-b23d-67406c27fe04 -> 0084ef29-047b-4c10-a3b3-59ea352dafb8): Wait interrupted by java.lang.InterruptedException
2019-06-14 13:02:23,482 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 8d565c00-7d2c-4f59-8814-272de98e8af9: appendEntries completed
2019-06-14 13:02:23,482 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-d1c2f7bb-f54e-47c9-b23d-67406c27fe04-group-C9D7C5512378: set stopIndex = 4
2019-06-14 13:02:23,486 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-14 13:02:23,486 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d1c2f7bb-f54e-47c9-b23d-67406c27fe04/d773cc71-8272-4259-a589-c9d7c5512378/sm/snapshot.1_3
2019-06-14 13:02:23,486 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04:group-C9D7C5512378 closes. The last applied log index is 4
2019-06-14 13:02:23,487 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8: appendEntries completed
2019-06-14 13:02:23,487 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 13:02:23,488 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04-RaftLogWorker close()
2019-06-14 13:02:23,489 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04: shutdown server with port 41783 now
2019-06-14 13:02:23,490 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04: follower d1c2f7bb-f54e-47c9-b23d-67406c27fe04->0084ef29-047b-4c10-a3b3-59ea352dafb8(c3,m4,n5, attendVote=true, lastRpcSendTime=26, lastRpcResponseTime=18) response Completed
2019-06-14 13:02:23,490 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04: follower d1c2f7bb-f54e-47c9-b23d-67406c27fe04->8d565c00-7d2c-4f59-8814-272de98e8af9(c3,m4,n5, attendVote=true, lastRpcSendTime=26, lastRpcResponseTime=19) response Completed
2019-06-14 13:02:23,491 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04: shutdown server with port 41783 successfully
2019-06-14 13:02:23,493 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04->0084ef29-047b-4c10-a3b3-59ea352dafb8: nextIndex: updateUnconditionally 5 -> -1
2019-06-14 13:02:23,494 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 8d565c00-7d2c-4f59-8814-272de98e8af9: close
2019-06-14 13:02:23,496 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 8d565c00-7d2c-4f59-8814-272de98e8af9: shutdown group-C9D7C5512378
2019-06-14 13:02:23,497 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C9D7C5512378,id=8d565c00-7d2c-4f59-8814-272de98e8af9
2019-06-14 13:02:23,497 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 8d565c00-7d2c-4f59-8814-272de98e8af9: shutdown FollowerState
2019-06-14 13:02:23,497 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-8d565c00-7d2c-4f59-8814-272de98e8af9-group-C9D7C5512378: set stopIndex = 3
2019-06-14 13:02:23,498 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-14 13:02:23,499 INFO  impl.FollowerState (FollowerState.java:run(109)) - 8d565c00-7d2c-4f59-8814-272de98e8af9: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 13:02:23,498 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - d1c2f7bb-f54e-47c9-b23d-67406c27fe04->8d565c00-7d2c-4f59-8814-272de98e8af9: nextIndex: updateUnconditionally 5 -> -1
2019-06-14 13:02:23,500 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/8d565c00-7d2c-4f59-8814-272de98e8af9/d773cc71-8272-4259-a589-c9d7c5512378/sm/snapshot.1_3
2019-06-14 13:02:23,500 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 8d565c00-7d2c-4f59-8814-272de98e8af9:group-C9D7C5512378 closes. The last applied log index is 3
2019-06-14 13:02:23,501 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 8d565c00-7d2c-4f59-8814-272de98e8af9-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 13:02:23,501 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 8d565c00-7d2c-4f59-8814-272de98e8af9-RaftLogWorker close()
2019-06-14 13:02:23,502 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 8d565c00-7d2c-4f59-8814-272de98e8af9: shutdown server with port 36531 now
2019-06-14 13:02:23,502 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 8d565c00-7d2c-4f59-8814-272de98e8af9: shutdown server with port 36531 successfully
2019-06-14 13:02:23,504 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8: close
2019-06-14 13:02:23,505 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8: shutdown group-C9D7C5512378
2019-06-14 13:02:23,506 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C9D7C5512378,id=0084ef29-047b-4c10-a3b3-59ea352dafb8
2019-06-14 13:02:23,506 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8: shutdown FollowerState
2019-06-14 13:02:23,507 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-0084ef29-047b-4c10-a3b3-59ea352dafb8-group-C9D7C5512378: set stopIndex = 3
2019-06-14 13:02:23,507 INFO  impl.FollowerState (FollowerState.java:run(109)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 13:02:23,507 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-14 13:02:23,507 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/0084ef29-047b-4c10-a3b3-59ea352dafb8/d773cc71-8272-4259-a589-c9d7c5512378/sm/snapshot.1_3
2019-06-14 13:02:23,507 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8:group-C9D7C5512378 closes. The last applied log index is 3
2019-06-14 13:02:23,508 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 13:02:23,508 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8-RaftLogWorker close()
2019-06-14 13:02:23,509 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8: shutdown server with port 36477 now
2019-06-14 13:02:23,510 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 0084ef29-047b-4c10-a3b3-59ea352dafb8: shutdown server with port 36477 successfully
