2019-06-13 14:21:49,206 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler52501f1c-2781-49bb-927d-1e00e6328468/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 14:21:49,210 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler52501f1c-2781-49bb-927d-1e00e6328468/hdds to VolumeSet
2019-06-13 14:21:49,220 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-13 14:21:49,255 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-13 14:21:49,677 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 34551
2019-06-13 14:21:50,180 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 14:21:50,204 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 14:21:50,214 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 34551 (custom)
2019-06-13 14:21:50,215 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 14:21:50,217 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 14:21:50,217 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 14:21:50,218 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 14:21:50,350 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler52501f1c-2781-49bb-927d-1e00e6328468/ratis] (custom)
2019-06-13 14:21:50,359 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 46235
2019-06-13 14:21:50,377 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 14:21:50,377 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 14:21:50,378 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis f16d17e9-0a87-41ac-a698-672e57b5de49 at port 34551
2019-06-13 14:21:50,389 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - f16d17e9-0a87-41ac-a698-672e57b5de49: start RPC server
2019-06-13 14:21:50,505 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - f16d17e9-0a87-41ac-a698-672e57b5de49: GrpcService started, listening on 0.0.0.0/0.0.0.0:34551
2019-06-13 14:21:50,765 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - f16d17e9-0a87-41ac-a698-672e57b5de49: addNew group-C4A0EC1234D7:[f16d17e9-0a87-41ac-a698-672e57b5de49:127.0.0.1:34551] returns group-C4A0EC1234D7:java.util.concurrent.CompletableFuture@54bce65a[Not completed]
2019-06-13 14:21:50,798 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - f16d17e9-0a87-41ac-a698-672e57b5de49: new RaftServerImpl for group-C4A0EC1234D7:[f16d17e9-0a87-41ac-a698-672e57b5de49:127.0.0.1:34551] with ContainerStateMachine:uninitialized
2019-06-13 14:21:50,799 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 14:21:50,800 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 14:21:50,800 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 14:21:50,801 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 14:21:50,806 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - f16d17e9-0a87-41ac-a698-672e57b5de49:group-C4A0EC1234D7 ConfigurationManager, init=-1: [f16d17e9-0a87-41ac-a698-672e57b5de49:127.0.0.1:34551], old=null, confs=<EMPTY_MAP>
2019-06-13 14:21:50,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler52501f1c-2781-49bb-927d-1e00e6328468/ratis] (custom)
2019-06-13 14:21:50,813 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler52501f1c-2781-49bb-927d-1e00e6328468/ratis/2240fdb1-34e2-47f7-a124-c4a0ec1234d7 does not exist. Creating ...
2019-06-13 14:21:50,822 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler52501f1c-2781-49bb-927d-1e00e6328468/ratis/2240fdb1-34e2-47f7-a124-c4a0ec1234d7/in_use.lock acquired by nodename 4195@ozone-dd8dj-1664167589
2019-06-13 14:21:50,830 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler52501f1c-2781-49bb-927d-1e00e6328468/ratis/2240fdb1-34e2-47f7-a124-c4a0ec1234d7 has been successfully formatted.
2019-06-13 14:21:50,832 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 14:21:50,832 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 14:21:50,834 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 14:21:50,835 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 14:21:50,838 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 14:21:50,841 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 14:21:50,843 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new f16d17e9-0a87-41ac-a698-672e57b5de49-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler52501f1c-2781-49bb-927d-1e00e6328468/ratis/2240fdb1-34e2-47f7-a124-c4a0ec1234d7
2019-06-13 14:21:50,843 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 14:21:50,844 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 14:21:50,845 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 14:21:50,846 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 14:21:50,846 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 14:21:50,847 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 14:21:50,847 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 14:21:50,847 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 14:21:50,848 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 14:21:50,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 14:21:50,854 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 14:21:50,854 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 14:21:50,855 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 14:21:50,940 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - f16d17e9-0a87-41ac-a698-672e57b5de49: start group-C4A0EC1234D7
2019-06-13 14:21:50,941 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f16d17e9-0a87-41ac-a698-672e57b5de49:group-C4A0EC1234D7 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 14:21:50,942 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f16d17e9-0a87-41ac-a698-672e57b5de49: start FollowerState
2019-06-13 14:21:50,944 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C4A0EC1234D7,id=f16d17e9-0a87-41ac-a698-672e57b5de49
2019-06-13 14:21:52,102 INFO  impl.FollowerState (FollowerState.java:run(101)) - f16d17e9-0a87-41ac-a698-672e57b5de49:group-C4A0EC1234D7 changes to CANDIDATE, lastRpcTime:1159, electionTimeout:1159ms
2019-06-13 14:21:52,102 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - f16d17e9-0a87-41ac-a698-672e57b5de49: shutdown FollowerState
2019-06-13 14:21:52,102 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f16d17e9-0a87-41ac-a698-672e57b5de49:group-C4A0EC1234D7 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 14:21:52,104 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f16d17e9-0a87-41ac-a698-672e57b5de49: start LeaderElection
2019-06-13 14:21:52,107 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - f16d17e9-0a87-41ac-a698-672e57b5de49:group-C4A0EC1234D7:LeaderElection1: begin an election at term 1 for -1: [f16d17e9-0a87-41ac-a698-672e57b5de49:127.0.0.1:34551], old=null
2019-06-13 14:21:52,108 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - f16d17e9-0a87-41ac-a698-672e57b5de49: shutdown LeaderElection
2019-06-13 14:21:52,108 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f16d17e9-0a87-41ac-a698-672e57b5de49:group-C4A0EC1234D7 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 14:21:52,108 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - f16d17e9-0a87-41ac-a698-672e57b5de49:group-C4A0EC1234D7 change Leader from null to f16d17e9-0a87-41ac-a698-672e57b5de49 at term 1 for becomeLeader, leader elected after 1276ms
2019-06-13 14:21:52,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 14:21:52,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 14:21:52,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 14:21:52,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 14:21:52,123 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f16d17e9-0a87-41ac-a698-672e57b5de49: start LeaderState
2019-06-13 14:21:52,134 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - f16d17e9-0a87-41ac-a698-672e57b5de49-RaftLogWorker: Starting segment from index:0
2019-06-13 14:21:52,141 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - f16d17e9-0a87-41ac-a698-672e57b5de49:group-C4A0EC1234D7 set configuration 0: [f16d17e9-0a87-41ac-a698-672e57b5de49:127.0.0.1:34551], old=null at 0
2019-06-13 14:21:52,264 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - f16d17e9-0a87-41ac-a698-672e57b5de49-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler52501f1c-2781-49bb-927d-1e00e6328468/ratis/2240fdb1-34e2-47f7-a124-c4a0ec1234d7/current/log_inprogress_0
2019-06-13 14:21:53,149 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-13 14:21:53,203 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 3942527983563241531 is closed with bcsId 0.
2019-06-13 14:21:53,203 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 14:21:53,204 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - f16d17e9-0a87-41ac-a698-672e57b5de49: close
2019-06-13 14:21:53,205 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - f16d17e9-0a87-41ac-a698-672e57b5de49: shutdown group-C4A0EC1234D7
2019-06-13 14:21:53,206 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C4A0EC1234D7,id=f16d17e9-0a87-41ac-a698-672e57b5de49
2019-06-13 14:21:53,206 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - f16d17e9-0a87-41ac-a698-672e57b5de49: shutdown LeaderState
2019-06-13 14:21:53,206 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - f16d17e9-0a87-41ac-a698-672e57b5de49-PendingRequests: sendNotLeaderResponses
2019-06-13 14:21:53,208 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-f16d17e9-0a87-41ac-a698-672e57b5de49-group-C4A0EC1234D7: set stopIndex = 4
2019-06-13 14:21:53,208 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-13 14:21:53,209 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler52501f1c-2781-49bb-927d-1e00e6328468/ratis/2240fdb1-34e2-47f7-a124-c4a0ec1234d7/sm/snapshot.1_4
2019-06-13 14:21:53,214 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - f16d17e9-0a87-41ac-a698-672e57b5de49:group-C4A0EC1234D7 closes. The last applied log index is 4
2019-06-13 14:21:53,215 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - f16d17e9-0a87-41ac-a698-672e57b5de49-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 14:21:53,216 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - f16d17e9-0a87-41ac-a698-672e57b5de49-RaftLogWorker close()
2019-06-13 14:21:53,217 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - f16d17e9-0a87-41ac-a698-672e57b5de49: shutdown server with port 34551 now
2019-06-13 14:21:53,220 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - f16d17e9-0a87-41ac-a698-672e57b5de49: shutdown server with port 34551 successfully
2019-06-13 14:21:53,228 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 14:21:53,258 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c057379-bc97-43d8-9da2-e454d76cca0e/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 14:21:53,258 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c057379-bc97-43d8-9da2-e454d76cca0e/hdds to VolumeSet
2019-06-13 14:21:53,258 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@47547132
2019-06-13 14:21:53,259 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@47547132
2019-06-13 14:21:53,274 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 33455
2019-06-13 14:21:53,275 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 14:21:53,276 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 14:21:53,276 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 33455 (custom)
2019-06-13 14:21:53,276 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 14:21:53,276 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 14:21:53,277 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 14:21:53,277 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 14:21:53,278 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c057379-bc97-43d8-9da2-e454d76cca0e/ratis] (custom)
2019-06-13 14:21:53,278 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 32921
2019-06-13 14:21:53,279 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 14:21:53,279 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 14:21:53,279 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis e873cec7-db1b-4e15-bcff-360747ffc58d at port 33455
2019-06-13 14:21:53,290 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - e873cec7-db1b-4e15-bcff-360747ffc58d: start RPC server
2019-06-13 14:21:53,291 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - e873cec7-db1b-4e15-bcff-360747ffc58d: GrpcService started, listening on 0.0.0.0/0.0.0.0:33455
2019-06-13 14:21:53,301 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e873cec7-db1b-4e15-bcff-360747ffc58d: addNew group-4F34E2C03D4A:[e873cec7-db1b-4e15-bcff-360747ffc58d:127.0.0.1:33455] returns group-4F34E2C03D4A:java.util.concurrent.CompletableFuture@5db2bfa0[Not completed]
2019-06-13 14:21:53,302 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - e873cec7-db1b-4e15-bcff-360747ffc58d: new RaftServerImpl for group-4F34E2C03D4A:[e873cec7-db1b-4e15-bcff-360747ffc58d:127.0.0.1:33455] with ContainerStateMachine:uninitialized
2019-06-13 14:21:53,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 14:21:53,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 14:21:53,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 14:21:53,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 14:21:53,302 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - e873cec7-db1b-4e15-bcff-360747ffc58d:group-4F34E2C03D4A ConfigurationManager, init=-1: [e873cec7-db1b-4e15-bcff-360747ffc58d:127.0.0.1:33455], old=null, confs=<EMPTY_MAP>
2019-06-13 14:21:53,303 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c057379-bc97-43d8-9da2-e454d76cca0e/ratis] (custom)
2019-06-13 14:21:53,303 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c057379-bc97-43d8-9da2-e454d76cca0e/ratis/0db5d272-32a5-4537-a070-4f34e2c03d4a does not exist. Creating ...
2019-06-13 14:21:53,305 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c057379-bc97-43d8-9da2-e454d76cca0e/ratis/0db5d272-32a5-4537-a070-4f34e2c03d4a/in_use.lock acquired by nodename 4195@ozone-dd8dj-1664167589
2019-06-13 14:21:53,307 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c057379-bc97-43d8-9da2-e454d76cca0e/ratis/0db5d272-32a5-4537-a070-4f34e2c03d4a has been successfully formatted.
2019-06-13 14:21:53,307 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 14:21:53,308 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 14:21:53,308 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 14:21:53,308 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 14:21:53,308 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 14:21:53,308 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 14:21:53,308 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new e873cec7-db1b-4e15-bcff-360747ffc58d-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c057379-bc97-43d8-9da2-e454d76cca0e/ratis/0db5d272-32a5-4537-a070-4f34e2c03d4a
2019-06-13 14:21:53,308 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 14:21:53,308 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 14:21:53,308 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 14:21:53,309 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 14:21:53,309 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 14:21:53,309 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 14:21:53,309 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 14:21:53,309 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 14:21:53,309 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 14:21:53,310 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 14:21:53,313 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 14:21:53,314 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 14:21:53,314 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 14:21:53,314 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - e873cec7-db1b-4e15-bcff-360747ffc58d: start group-4F34E2C03D4A
2019-06-13 14:21:53,314 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - e873cec7-db1b-4e15-bcff-360747ffc58d:group-4F34E2C03D4A changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 14:21:53,314 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e873cec7-db1b-4e15-bcff-360747ffc58d: start FollowerState
2019-06-13 14:21:53,318 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-4F34E2C03D4A,id=e873cec7-db1b-4e15-bcff-360747ffc58d
2019-06-13 14:21:54,367 INFO  impl.FollowerState (FollowerState.java:run(101)) - e873cec7-db1b-4e15-bcff-360747ffc58d:group-4F34E2C03D4A changes to CANDIDATE, lastRpcTime:1052, electionTimeout:1049ms
2019-06-13 14:21:54,367 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e873cec7-db1b-4e15-bcff-360747ffc58d: shutdown FollowerState
2019-06-13 14:21:54,367 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - e873cec7-db1b-4e15-bcff-360747ffc58d:group-4F34E2C03D4A changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 14:21:54,367 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e873cec7-db1b-4e15-bcff-360747ffc58d: start LeaderElection
2019-06-13 14:21:54,370 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - e873cec7-db1b-4e15-bcff-360747ffc58d:group-4F34E2C03D4A:LeaderElection2: begin an election at term 1 for -1: [e873cec7-db1b-4e15-bcff-360747ffc58d:127.0.0.1:33455], old=null
2019-06-13 14:21:54,370 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e873cec7-db1b-4e15-bcff-360747ffc58d: shutdown LeaderElection
2019-06-13 14:21:54,370 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - e873cec7-db1b-4e15-bcff-360747ffc58d:group-4F34E2C03D4A changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 14:21:54,370 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - e873cec7-db1b-4e15-bcff-360747ffc58d:group-4F34E2C03D4A change Leader from null to e873cec7-db1b-4e15-bcff-360747ffc58d at term 1 for becomeLeader, leader elected after 1062ms
2019-06-13 14:21:54,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 14:21:54,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 14:21:54,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 14:21:54,371 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 14:21:54,371 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e873cec7-db1b-4e15-bcff-360747ffc58d: start LeaderState
2019-06-13 14:21:54,371 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - e873cec7-db1b-4e15-bcff-360747ffc58d-RaftLogWorker: Starting segment from index:0
2019-06-13 14:21:54,372 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - e873cec7-db1b-4e15-bcff-360747ffc58d:group-4F34E2C03D4A set configuration 0: [e873cec7-db1b-4e15-bcff-360747ffc58d:127.0.0.1:33455], old=null at 0
2019-06-13 14:21:54,407 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - e873cec7-db1b-4e15-bcff-360747ffc58d-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c057379-bc97-43d8-9da2-e454d76cca0e/ratis/0db5d272-32a5-4537-a070-4f34e2c03d4a/current/log_inprogress_0
2019-06-13 14:21:55,344 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 14:21:55,345 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - e873cec7-db1b-4e15-bcff-360747ffc58d: close
2019-06-13 14:21:55,345 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - e873cec7-db1b-4e15-bcff-360747ffc58d: shutdown group-4F34E2C03D4A
2019-06-13 14:21:55,346 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-4F34E2C03D4A,id=e873cec7-db1b-4e15-bcff-360747ffc58d
2019-06-13 14:21:55,346 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e873cec7-db1b-4e15-bcff-360747ffc58d: shutdown LeaderState
2019-06-13 14:21:55,346 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - e873cec7-db1b-4e15-bcff-360747ffc58d-PendingRequests: sendNotLeaderResponses
2019-06-13 14:21:55,347 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-e873cec7-db1b-4e15-bcff-360747ffc58d-group-4F34E2C03D4A: set stopIndex = 2
2019-06-13 14:21:55,347 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-13 14:21:55,347 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c057379-bc97-43d8-9da2-e454d76cca0e/ratis/0db5d272-32a5-4537-a070-4f34e2c03d4a/sm/snapshot.1_2
2019-06-13 14:21:55,348 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - e873cec7-db1b-4e15-bcff-360747ffc58d:group-4F34E2C03D4A closes. The last applied log index is 2
2019-06-13 14:21:55,349 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - e873cec7-db1b-4e15-bcff-360747ffc58d-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 14:21:55,349 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - e873cec7-db1b-4e15-bcff-360747ffc58d-RaftLogWorker close()
2019-06-13 14:21:55,350 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - e873cec7-db1b-4e15-bcff-360747ffc58d: shutdown server with port 33455 now
2019-06-13 14:21:55,351 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - e873cec7-db1b-4e15-bcff-360747ffc58d: shutdown server with port 33455 successfully
2019-06-13 14:21:55,357 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 14:21:55,390 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3e90c5c5-f420-49ee-8a29-4dc7b1b74a4f/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 14:21:55,390 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3e90c5c5-f420-49ee-8a29-4dc7b1b74a4f/hdds to VolumeSet
2019-06-13 14:21:55,391 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1bd0b0e5
2019-06-13 14:21:55,391 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1bd0b0e5
2019-06-13 14:21:55,403 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43641
2019-06-13 14:21:55,404 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 14:21:55,405 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 14:21:55,405 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43641 (custom)
2019-06-13 14:21:55,405 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 14:21:55,406 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 14:21:55,406 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 14:21:55,406 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 14:21:55,407 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3e90c5c5-f420-49ee-8a29-4dc7b1b74a4f/ratis] (custom)
2019-06-13 14:21:55,407 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 41503
2019-06-13 14:21:55,407 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 14:21:55,408 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 14:21:55,408 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 2ba6c6c8-49f8-41d9-adc1-09472253e9c9 at port 43641
2019-06-13 14:21:55,413 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9: start RPC server
2019-06-13 14:21:55,414 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9: GrpcService started, listening on 0.0.0.0/0.0.0.0:43641
2019-06-13 14:21:55,423 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9: addNew group-FD8E95D1120C:[2ba6c6c8-49f8-41d9-adc1-09472253e9c9:127.0.0.1:43641] returns group-FD8E95D1120C:java.util.concurrent.CompletableFuture@4641fabf[Not completed]
2019-06-13 14:21:55,424 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9: new RaftServerImpl for group-FD8E95D1120C:[2ba6c6c8-49f8-41d9-adc1-09472253e9c9:127.0.0.1:43641] with ContainerStateMachine:uninitialized
2019-06-13 14:21:55,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 14:21:55,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 14:21:55,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 14:21:55,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 14:21:55,424 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9:group-FD8E95D1120C ConfigurationManager, init=-1: [2ba6c6c8-49f8-41d9-adc1-09472253e9c9:127.0.0.1:43641], old=null, confs=<EMPTY_MAP>
2019-06-13 14:21:55,425 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3e90c5c5-f420-49ee-8a29-4dc7b1b74a4f/ratis] (custom)
2019-06-13 14:21:55,425 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3e90c5c5-f420-49ee-8a29-4dc7b1b74a4f/ratis/1f5d3029-10a7-4422-8f13-fd8e95d1120c does not exist. Creating ...
2019-06-13 14:21:55,428 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3e90c5c5-f420-49ee-8a29-4dc7b1b74a4f/ratis/1f5d3029-10a7-4422-8f13-fd8e95d1120c/in_use.lock acquired by nodename 4195@ozone-dd8dj-1664167589
2019-06-13 14:21:55,430 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3e90c5c5-f420-49ee-8a29-4dc7b1b74a4f/ratis/1f5d3029-10a7-4422-8f13-fd8e95d1120c has been successfully formatted.
2019-06-13 14:21:55,430 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 14:21:55,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 14:21:55,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 14:21:55,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 14:21:55,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 14:21:55,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 14:21:55,431 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 2ba6c6c8-49f8-41d9-adc1-09472253e9c9-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3e90c5c5-f420-49ee-8a29-4dc7b1b74a4f/ratis/1f5d3029-10a7-4422-8f13-fd8e95d1120c
2019-06-13 14:21:55,431 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 14:21:55,431 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 14:21:55,431 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 14:21:55,431 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 14:21:55,431 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 14:21:55,431 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 14:21:55,431 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 14:21:55,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 14:21:55,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 14:21:55,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 14:21:55,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 14:21:55,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 14:21:55,433 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 14:21:55,433 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9: start group-FD8E95D1120C
2019-06-13 14:21:55,433 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9:group-FD8E95D1120C changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 14:21:55,433 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9: start FollowerState
2019-06-13 14:21:55,433 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-FD8E95D1120C,id=2ba6c6c8-49f8-41d9-adc1-09472253e9c9
2019-06-13 14:21:56,463 INFO  impl.FollowerState (FollowerState.java:run(101)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9:group-FD8E95D1120C changes to CANDIDATE, lastRpcTime:1030, electionTimeout:1030ms
2019-06-13 14:21:56,463 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9: shutdown FollowerState
2019-06-13 14:21:56,463 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9:group-FD8E95D1120C changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 14:21:56,464 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9: start LeaderElection
2019-06-13 14:21:56,467 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9:group-FD8E95D1120C:LeaderElection3: begin an election at term 1 for -1: [2ba6c6c8-49f8-41d9-adc1-09472253e9c9:127.0.0.1:43641], old=null
2019-06-13 14:21:56,467 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9: shutdown LeaderElection
2019-06-13 14:21:56,467 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9:group-FD8E95D1120C changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 14:21:56,467 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9:group-FD8E95D1120C change Leader from null to 2ba6c6c8-49f8-41d9-adc1-09472253e9c9 at term 1 for becomeLeader, leader elected after 1037ms
2019-06-13 14:21:56,467 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 14:21:56,468 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 14:21:56,468 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 14:21:56,468 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 14:21:56,468 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9: start LeaderState
2019-06-13 14:21:56,468 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9-RaftLogWorker: Starting segment from index:0
2019-06-13 14:21:56,474 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9:group-FD8E95D1120C set configuration 0: [2ba6c6c8-49f8-41d9-adc1-09472253e9c9:127.0.0.1:43641], old=null at 0
2019-06-13 14:21:56,505 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3e90c5c5-f420-49ee-8a29-4dc7b1b74a4f/ratis/1f5d3029-10a7-4422-8f13-fd8e95d1120c/current/log_inprogress_0
2019-06-13 14:21:57,474 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 1754359661889167355 is closed with bcsId 0.
2019-06-13 14:21:57,475 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 14:21:57,475 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9: close
2019-06-13 14:21:57,475 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9: shutdown group-FD8E95D1120C
2019-06-13 14:21:57,476 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-FD8E95D1120C,id=2ba6c6c8-49f8-41d9-adc1-09472253e9c9
2019-06-13 14:21:57,476 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9: shutdown LeaderState
2019-06-13 14:21:57,476 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9-PendingRequests: sendNotLeaderResponses
2019-06-13 14:21:57,477 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-2ba6c6c8-49f8-41d9-adc1-09472253e9c9-group-FD8E95D1120C: set stopIndex = 2
2019-06-13 14:21:57,477 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-13 14:21:57,477 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3e90c5c5-f420-49ee-8a29-4dc7b1b74a4f/ratis/1f5d3029-10a7-4422-8f13-fd8e95d1120c/sm/snapshot.1_2
2019-06-13 14:21:57,478 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9:group-FD8E95D1120C closes. The last applied log index is 2
2019-06-13 14:21:57,478 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 14:21:57,479 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9-RaftLogWorker close()
2019-06-13 14:21:57,479 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9: shutdown server with port 43641 now
2019-06-13 14:21:57,481 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 2ba6c6c8-49f8-41d9-adc1-09472253e9c9: shutdown server with port 43641 successfully
2019-06-13 14:21:57,498 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 14:21:57,530 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera70b3c2f-ba1e-428c-aac2-8403765bd485/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 14:21:57,530 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera70b3c2f-ba1e-428c-aac2-8403765bd485/hdds to VolumeSet
2019-06-13 14:21:57,530 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3971f0fe
2019-06-13 14:21:57,531 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3971f0fe
2019-06-13 14:21:57,547 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 41515
2019-06-13 14:21:57,547 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 14:21:57,548 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 14:21:57,548 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 41515 (custom)
2019-06-13 14:21:57,549 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 14:21:57,549 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 14:21:57,549 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 14:21:57,550 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 14:21:57,550 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera70b3c2f-ba1e-428c-aac2-8403765bd485/ratis] (custom)
2019-06-13 14:21:57,551 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 37121
2019-06-13 14:21:57,551 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 14:21:57,551 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 14:21:57,551 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 84032dfb-adbb-4de5-a59e-de750076d145 at port 41515
2019-06-13 14:21:57,576 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 84032dfb-adbb-4de5-a59e-de750076d145: start RPC server
2019-06-13 14:21:57,577 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 84032dfb-adbb-4de5-a59e-de750076d145: GrpcService started, listening on 0.0.0.0/0.0.0.0:41515
Jun 13, 2019 2:21:57 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:43641} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 13, 2019 2:21:57 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:33455} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-13 14:21:57,595 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 84032dfb-adbb-4de5-a59e-de750076d145: addNew group-B0407A182CE0:[84032dfb-adbb-4de5-a59e-de750076d145:127.0.0.1:41515] returns group-B0407A182CE0:java.util.concurrent.CompletableFuture@138bc13e[Not completed]
2019-06-13 14:21:57,595 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 84032dfb-adbb-4de5-a59e-de750076d145: new RaftServerImpl for group-B0407A182CE0:[84032dfb-adbb-4de5-a59e-de750076d145:127.0.0.1:41515] with ContainerStateMachine:uninitialized
2019-06-13 14:21:57,598 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 14:21:57,598 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 14:21:57,598 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 14:21:57,598 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 14:21:57,598 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 84032dfb-adbb-4de5-a59e-de750076d145:group-B0407A182CE0 ConfigurationManager, init=-1: [84032dfb-adbb-4de5-a59e-de750076d145:127.0.0.1:41515], old=null, confs=<EMPTY_MAP>
2019-06-13 14:21:57,598 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera70b3c2f-ba1e-428c-aac2-8403765bd485/ratis] (custom)
2019-06-13 14:21:57,598 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera70b3c2f-ba1e-428c-aac2-8403765bd485/ratis/c4b421e5-6f67-4d29-878d-b0407a182ce0 does not exist. Creating ...
2019-06-13 14:21:57,601 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera70b3c2f-ba1e-428c-aac2-8403765bd485/ratis/c4b421e5-6f67-4d29-878d-b0407a182ce0/in_use.lock acquired by nodename 4195@ozone-dd8dj-1664167589
2019-06-13 14:21:57,603 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera70b3c2f-ba1e-428c-aac2-8403765bd485/ratis/c4b421e5-6f67-4d29-878d-b0407a182ce0 has been successfully formatted.
2019-06-13 14:21:57,603 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 14:21:57,603 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 14:21:57,603 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 14:21:57,604 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 14:21:57,604 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 14:21:57,604 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 14:21:57,604 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 84032dfb-adbb-4de5-a59e-de750076d145-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera70b3c2f-ba1e-428c-aac2-8403765bd485/ratis/c4b421e5-6f67-4d29-878d-b0407a182ce0
2019-06-13 14:21:57,604 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 14:21:57,604 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 14:21:57,604 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 14:21:57,604 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 14:21:57,604 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 14:21:57,604 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 14:21:57,604 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 14:21:57,605 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 14:21:57,605 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 14:21:57,605 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 14:21:57,605 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 14:21:57,605 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 14:21:57,605 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 14:21:57,605 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 84032dfb-adbb-4de5-a59e-de750076d145: start group-B0407A182CE0
2019-06-13 14:21:57,605 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 84032dfb-adbb-4de5-a59e-de750076d145:group-B0407A182CE0 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 14:21:57,606 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 84032dfb-adbb-4de5-a59e-de750076d145: start FollowerState
2019-06-13 14:21:57,606 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-B0407A182CE0,id=84032dfb-adbb-4de5-a59e-de750076d145
2019-06-13 14:21:58,729 INFO  impl.FollowerState (FollowerState.java:run(101)) - 84032dfb-adbb-4de5-a59e-de750076d145:group-B0407A182CE0 changes to CANDIDATE, lastRpcTime:1123, electionTimeout:1123ms
2019-06-13 14:21:58,729 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 84032dfb-adbb-4de5-a59e-de750076d145: shutdown FollowerState
2019-06-13 14:21:58,729 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 84032dfb-adbb-4de5-a59e-de750076d145:group-B0407A182CE0 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 14:21:58,729 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 84032dfb-adbb-4de5-a59e-de750076d145: start LeaderElection
2019-06-13 14:21:58,732 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 84032dfb-adbb-4de5-a59e-de750076d145:group-B0407A182CE0:LeaderElection4: begin an election at term 1 for -1: [84032dfb-adbb-4de5-a59e-de750076d145:127.0.0.1:41515], old=null
2019-06-13 14:21:58,733 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 84032dfb-adbb-4de5-a59e-de750076d145: shutdown LeaderElection
2019-06-13 14:21:58,733 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 84032dfb-adbb-4de5-a59e-de750076d145:group-B0407A182CE0 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 14:21:58,733 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 84032dfb-adbb-4de5-a59e-de750076d145:group-B0407A182CE0 change Leader from null to 84032dfb-adbb-4de5-a59e-de750076d145 at term 1 for becomeLeader, leader elected after 1129ms
2019-06-13 14:21:58,733 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 14:21:58,733 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 14:21:58,733 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 14:21:58,733 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 14:21:58,733 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 84032dfb-adbb-4de5-a59e-de750076d145: start LeaderState
2019-06-13 14:21:58,734 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 84032dfb-adbb-4de5-a59e-de750076d145-RaftLogWorker: Starting segment from index:0
2019-06-13 14:21:58,735 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 84032dfb-adbb-4de5-a59e-de750076d145:group-B0407A182CE0 set configuration 0: [84032dfb-adbb-4de5-a59e-de750076d145:127.0.0.1:41515], old=null at 0
2019-06-13 14:21:58,771 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 84032dfb-adbb-4de5-a59e-de750076d145-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera70b3c2f-ba1e-428c-aac2-8403765bd485/ratis/c4b421e5-6f67-4d29-878d-b0407a182ce0/current/log_inprogress_0
2019-06-13 14:21:59,647 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 6350537095353752498 is closed with bcsId 0.
2019-06-13 14:21:59,647 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 14:21:59,648 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 84032dfb-adbb-4de5-a59e-de750076d145: close
2019-06-13 14:21:59,648 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 84032dfb-adbb-4de5-a59e-de750076d145: shutdown group-B0407A182CE0
2019-06-13 14:21:59,648 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-B0407A182CE0,id=84032dfb-adbb-4de5-a59e-de750076d145
2019-06-13 14:21:59,648 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 84032dfb-adbb-4de5-a59e-de750076d145: shutdown LeaderState
2019-06-13 14:21:59,649 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 84032dfb-adbb-4de5-a59e-de750076d145-PendingRequests: sendNotLeaderResponses
2019-06-13 14:21:59,649 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-84032dfb-adbb-4de5-a59e-de750076d145-group-B0407A182CE0: set stopIndex = 2
2019-06-13 14:21:59,649 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-13 14:21:59,650 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera70b3c2f-ba1e-428c-aac2-8403765bd485/ratis/c4b421e5-6f67-4d29-878d-b0407a182ce0/sm/snapshot.1_2
2019-06-13 14:21:59,650 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 84032dfb-adbb-4de5-a59e-de750076d145:group-B0407A182CE0 closes. The last applied log index is 2
2019-06-13 14:21:59,650 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 84032dfb-adbb-4de5-a59e-de750076d145-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 14:21:59,651 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 84032dfb-adbb-4de5-a59e-de750076d145-RaftLogWorker close()
2019-06-13 14:21:59,652 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 84032dfb-adbb-4de5-a59e-de750076d145: shutdown server with port 41515 now
2019-06-13 14:21:59,654 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 84032dfb-adbb-4de5-a59e-de750076d145: shutdown server with port 41515 successfully
2019-06-13 14:21:59,655 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 14:21:59,683 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c08df6d-1c2c-4b6e-9437-8c8a34adf0c2/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 14:21:59,683 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c08df6d-1c2c-4b6e-9437-8c8a34adf0c2/hdds to VolumeSet
2019-06-13 14:21:59,683 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@4fad6218
2019-06-13 14:21:59,684 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@4fad6218
2019-06-13 14:21:59,691 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 41035
2019-06-13 14:21:59,692 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 14:21:59,692 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 14:21:59,692 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 41035 (custom)
2019-06-13 14:21:59,692 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 14:21:59,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 14:21:59,693 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 14:21:59,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 14:21:59,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c08df6d-1c2c-4b6e-9437-8c8a34adf0c2/ratis] (custom)
2019-06-13 14:21:59,694 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 39823
2019-06-13 14:21:59,694 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 14:21:59,694 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 14:21:59,694 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 7dbd7331-511e-4eac-986f-eacfc9efdcfb at port 41035
2019-06-13 14:21:59,703 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb: start RPC server
2019-06-13 14:21:59,704 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb: GrpcService started, listening on 0.0.0.0/0.0.0.0:41035
2019-06-13 14:21:59,712 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb: addNew group-3EDB07430267:[7dbd7331-511e-4eac-986f-eacfc9efdcfb:127.0.0.1:41035] returns group-3EDB07430267:java.util.concurrent.CompletableFuture@24347952[Not completed]
2019-06-13 14:21:59,712 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb: new RaftServerImpl for group-3EDB07430267:[7dbd7331-511e-4eac-986f-eacfc9efdcfb:127.0.0.1:41035] with ContainerStateMachine:uninitialized
2019-06-13 14:21:59,712 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 14:21:59,713 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 14:21:59,713 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 14:21:59,713 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 14:21:59,713 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb:group-3EDB07430267 ConfigurationManager, init=-1: [7dbd7331-511e-4eac-986f-eacfc9efdcfb:127.0.0.1:41035], old=null, confs=<EMPTY_MAP>
2019-06-13 14:21:59,713 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c08df6d-1c2c-4b6e-9437-8c8a34adf0c2/ratis] (custom)
2019-06-13 14:21:59,713 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c08df6d-1c2c-4b6e-9437-8c8a34adf0c2/ratis/aa5f89b1-5567-44c1-ae5a-3edb07430267 does not exist. Creating ...
2019-06-13 14:21:59,716 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c08df6d-1c2c-4b6e-9437-8c8a34adf0c2/ratis/aa5f89b1-5567-44c1-ae5a-3edb07430267/in_use.lock acquired by nodename 4195@ozone-dd8dj-1664167589
2019-06-13 14:21:59,719 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c08df6d-1c2c-4b6e-9437-8c8a34adf0c2/ratis/aa5f89b1-5567-44c1-ae5a-3edb07430267 has been successfully formatted.
2019-06-13 14:21:59,719 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 14:21:59,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 14:21:59,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 14:21:59,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 14:21:59,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 14:21:59,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 14:21:59,719 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 7dbd7331-511e-4eac-986f-eacfc9efdcfb-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c08df6d-1c2c-4b6e-9437-8c8a34adf0c2/ratis/aa5f89b1-5567-44c1-ae5a-3edb07430267
2019-06-13 14:21:59,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 14:21:59,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 14:21:59,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 14:21:59,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 14:21:59,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 14:21:59,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 14:21:59,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 14:21:59,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 14:21:59,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 14:21:59,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 14:21:59,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 14:21:59,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 14:21:59,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 14:21:59,721 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb: start group-3EDB07430267
2019-06-13 14:21:59,721 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb:group-3EDB07430267 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 14:21:59,721 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb: start FollowerState
2019-06-13 14:21:59,721 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-3EDB07430267,id=7dbd7331-511e-4eac-986f-eacfc9efdcfb
2019-06-13 14:22:00,869 INFO  impl.FollowerState (FollowerState.java:run(101)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb:group-3EDB07430267 changes to CANDIDATE, lastRpcTime:1148, electionTimeout:1148ms
2019-06-13 14:22:00,870 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb: shutdown FollowerState
2019-06-13 14:22:00,870 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb:group-3EDB07430267 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 14:22:00,870 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb: start LeaderElection
2019-06-13 14:22:00,876 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb:group-3EDB07430267:LeaderElection5: begin an election at term 1 for -1: [7dbd7331-511e-4eac-986f-eacfc9efdcfb:127.0.0.1:41035], old=null
2019-06-13 14:22:00,876 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb: shutdown LeaderElection
2019-06-13 14:22:00,876 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb:group-3EDB07430267 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 14:22:00,876 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb:group-3EDB07430267 change Leader from null to 7dbd7331-511e-4eac-986f-eacfc9efdcfb at term 1 for becomeLeader, leader elected after 1157ms
2019-06-13 14:22:00,876 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 14:22:00,877 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 14:22:00,877 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 14:22:00,877 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 14:22:00,877 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb: start LeaderState
2019-06-13 14:22:00,877 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb-RaftLogWorker: Starting segment from index:0
2019-06-13 14:22:00,885 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb:group-3EDB07430267 set configuration 0: [7dbd7331-511e-4eac-986f-eacfc9efdcfb:127.0.0.1:41035], old=null at 0
2019-06-13 14:22:00,917 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c08df6d-1c2c-4b6e-9437-8c8a34adf0c2/ratis/aa5f89b1-5567-44c1-ae5a-3edb07430267/current/log_inprogress_0
2019-06-13 14:22:01,818 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 2129361678690523083 is closed with bcsId 0.
2019-06-13 14:22:01,819 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 14:22:01,819 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb: close
2019-06-13 14:22:01,819 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb: shutdown group-3EDB07430267
2019-06-13 14:22:01,820 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-3EDB07430267,id=7dbd7331-511e-4eac-986f-eacfc9efdcfb
2019-06-13 14:22:01,820 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb: shutdown LeaderState
2019-06-13 14:22:01,820 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb-PendingRequests: sendNotLeaderResponses
2019-06-13 14:22:01,821 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-7dbd7331-511e-4eac-986f-eacfc9efdcfb-group-3EDB07430267: set stopIndex = 4
2019-06-13 14:22:01,821 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-13 14:22:01,821 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c08df6d-1c2c-4b6e-9437-8c8a34adf0c2/ratis/aa5f89b1-5567-44c1-ae5a-3edb07430267/sm/snapshot.1_4
2019-06-13 14:22:01,822 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb:group-3EDB07430267 closes. The last applied log index is 4
2019-06-13 14:22:01,822 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 14:22:01,822 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb-RaftLogWorker close()
2019-06-13 14:22:01,823 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb: shutdown server with port 41035 now
2019-06-13 14:22:01,828 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 7dbd7331-511e-4eac-986f-eacfc9efdcfb: shutdown server with port 41035 successfully
2019-06-13 14:22:01,830 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
