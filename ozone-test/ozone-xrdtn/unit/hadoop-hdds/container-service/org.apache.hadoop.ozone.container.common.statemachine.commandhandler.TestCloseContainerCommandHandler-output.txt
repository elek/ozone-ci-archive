2019-06-14 08:41:45,206 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler08d54c5b-8684-4c75-a919-3d018a37f414/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 08:41:45,211 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler08d54c5b-8684-4c75-a919-3d018a37f414/hdds to VolumeSet
2019-06-14 08:41:45,224 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-14 08:41:45,253 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-14 08:41:45,626 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43669
2019-06-14 08:41:46,009 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 08:41:46,034 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 08:41:46,044 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43669 (custom)
2019-06-14 08:41:46,045 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 08:41:46,047 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 08:41:46,048 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 08:41:46,049 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 08:41:46,211 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler08d54c5b-8684-4c75-a919-3d018a37f414/ratis] (custom)
2019-06-14 08:41:46,223 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 39875
2019-06-14 08:41:46,248 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 08:41:46,248 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 08:41:46,249 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 3c27e9c2-5ed7-4914-bec1-6b5372a73df5 at port 43669
2019-06-14 08:41:46,261 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5: start RPC server
2019-06-14 08:41:46,414 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5: GrpcService started, listening on 0.0.0.0/0.0.0.0:43669
2019-06-14 08:41:46,724 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5: addNew group-F9E7A3C916D2:[3c27e9c2-5ed7-4914-bec1-6b5372a73df5:127.0.0.1:43669] returns group-F9E7A3C916D2:java.util.concurrent.CompletableFuture@3fc33b87[Not completed]
2019-06-14 08:41:46,753 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5: new RaftServerImpl for group-F9E7A3C916D2:[3c27e9c2-5ed7-4914-bec1-6b5372a73df5:127.0.0.1:43669] with ContainerStateMachine:uninitialized
2019-06-14 08:41:46,754 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 08:41:46,754 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 08:41:46,755 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 08:41:46,755 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 08:41:46,760 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5:group-F9E7A3C916D2 ConfigurationManager, init=-1: [3c27e9c2-5ed7-4914-bec1-6b5372a73df5:127.0.0.1:43669], old=null, confs=<EMPTY_MAP>
2019-06-14 08:41:46,760 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler08d54c5b-8684-4c75-a919-3d018a37f414/ratis] (custom)
2019-06-14 08:41:46,767 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler08d54c5b-8684-4c75-a919-3d018a37f414/ratis/0d87b924-7830-4ade-a0db-f9e7a3c916d2 does not exist. Creating ...
2019-06-14 08:41:46,775 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler08d54c5b-8684-4c75-a919-3d018a37f414/ratis/0d87b924-7830-4ade-a0db-f9e7a3c916d2/in_use.lock acquired by nodename 4182@ozone-xrdtn-1509355863
2019-06-14 08:41:46,782 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler08d54c5b-8684-4c75-a919-3d018a37f414/ratis/0d87b924-7830-4ade-a0db-f9e7a3c916d2 has been successfully formatted.
2019-06-14 08:41:46,784 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 08:41:46,784 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 08:41:46,786 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 08:41:46,788 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 08:41:46,791 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 08:41:46,794 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 08:41:46,796 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 3c27e9c2-5ed7-4914-bec1-6b5372a73df5-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler08d54c5b-8684-4c75-a919-3d018a37f414/ratis/0d87b924-7830-4ade-a0db-f9e7a3c916d2
2019-06-14 08:41:46,796 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 08:41:46,797 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 08:41:46,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 08:41:46,799 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 08:41:46,799 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 08:41:46,799 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 08:41:46,800 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 08:41:46,800 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 08:41:46,800 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 08:41:46,802 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 08:41:46,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 08:41:46,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 08:41:46,808 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 08:41:46,892 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5: start group-F9E7A3C916D2
2019-06-14 08:41:46,894 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5:group-F9E7A3C916D2 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 08:41:46,895 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5: start FollowerState
2019-06-14 08:41:46,897 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-F9E7A3C916D2,id=3c27e9c2-5ed7-4914-bec1-6b5372a73df5
2019-06-14 08:41:48,038 INFO  impl.FollowerState (FollowerState.java:run(101)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5:group-F9E7A3C916D2 changes to CANDIDATE, lastRpcTime:1142, electionTimeout:1142ms
2019-06-14 08:41:48,038 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5: shutdown FollowerState
2019-06-14 08:41:48,038 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5:group-F9E7A3C916D2 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 08:41:48,040 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5: start LeaderElection
2019-06-14 08:41:48,043 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5:group-F9E7A3C916D2:LeaderElection1: begin an election at term 1 for -1: [3c27e9c2-5ed7-4914-bec1-6b5372a73df5:127.0.0.1:43669], old=null
2019-06-14 08:41:48,044 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5: shutdown LeaderElection
2019-06-14 08:41:48,044 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5:group-F9E7A3C916D2 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 08:41:48,045 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5:group-F9E7A3C916D2 change Leader from null to 3c27e9c2-5ed7-4914-bec1-6b5372a73df5 at term 1 for becomeLeader, leader elected after 1260ms
2019-06-14 08:41:48,048 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 08:41:48,048 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 08:41:48,050 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 08:41:48,050 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 08:41:48,057 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5: start LeaderState
2019-06-14 08:41:48,069 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5-RaftLogWorker: Starting segment from index:0
2019-06-14 08:41:48,076 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5:group-F9E7A3C916D2 set configuration 0: [3c27e9c2-5ed7-4914-bec1-6b5372a73df5:127.0.0.1:43669], old=null at 0
2019-06-14 08:41:48,208 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler08d54c5b-8684-4c75-a919-3d018a37f414/ratis/0d87b924-7830-4ade-a0db-f9e7a3c916d2/current/log_inprogress_0
2019-06-14 08:41:49,166 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-14 08:41:49,244 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 1421164490178361921 is closed with bcsId 0.
2019-06-14 08:41:49,244 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 08:41:49,245 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5: close
2019-06-14 08:41:49,246 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5: shutdown group-F9E7A3C916D2
2019-06-14 08:41:49,247 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-F9E7A3C916D2,id=3c27e9c2-5ed7-4914-bec1-6b5372a73df5
2019-06-14 08:41:49,247 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5: shutdown LeaderState
2019-06-14 08:41:49,248 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5-PendingRequests: sendNotLeaderResponses
2019-06-14 08:41:49,250 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-3c27e9c2-5ed7-4914-bec1-6b5372a73df5-group-F9E7A3C916D2: set stopIndex = 4
2019-06-14 08:41:49,250 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-14 08:41:49,250 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler08d54c5b-8684-4c75-a919-3d018a37f414/ratis/0d87b924-7830-4ade-a0db-f9e7a3c916d2/sm/snapshot.1_4
2019-06-14 08:41:49,257 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5:group-F9E7A3C916D2 closes. The last applied log index is 4
2019-06-14 08:41:49,258 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 08:41:49,259 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5-RaftLogWorker close()
2019-06-14 08:41:49,260 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5: shutdown server with port 43669 now
2019-06-14 08:41:49,264 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 3c27e9c2-5ed7-4914-bec1-6b5372a73df5: shutdown server with port 43669 successfully
2019-06-14 08:41:49,272 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 08:41:49,309 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler906064b8-2905-4b3f-aa8d-449c254ccec1/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 08:41:49,310 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler906064b8-2905-4b3f-aa8d-449c254ccec1/hdds to VolumeSet
2019-06-14 08:41:49,310 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@21a66d45
2019-06-14 08:41:49,311 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@21a66d45
2019-06-14 08:41:49,325 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43059
2019-06-14 08:41:49,325 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 08:41:49,326 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 08:41:49,326 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43059 (custom)
2019-06-14 08:41:49,326 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 08:41:49,327 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 08:41:49,327 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 08:41:49,327 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 08:41:49,328 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler906064b8-2905-4b3f-aa8d-449c254ccec1/ratis] (custom)
2019-06-14 08:41:49,328 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 39729
2019-06-14 08:41:49,329 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 08:41:49,329 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 08:41:49,329 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 577857d2-6a9c-45e9-af79-cda0e853ec82 at port 43059
2019-06-14 08:41:49,402 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 577857d2-6a9c-45e9-af79-cda0e853ec82: start RPC server
2019-06-14 08:41:49,404 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 577857d2-6a9c-45e9-af79-cda0e853ec82: GrpcService started, listening on 0.0.0.0/0.0.0.0:43059
2019-06-14 08:41:49,417 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 577857d2-6a9c-45e9-af79-cda0e853ec82: addNew group-20886657AEF1:[577857d2-6a9c-45e9-af79-cda0e853ec82:127.0.0.1:43059] returns group-20886657AEF1:java.util.concurrent.CompletableFuture@259934e6[Not completed]
2019-06-14 08:41:49,422 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 577857d2-6a9c-45e9-af79-cda0e853ec82: new RaftServerImpl for group-20886657AEF1:[577857d2-6a9c-45e9-af79-cda0e853ec82:127.0.0.1:43059] with ContainerStateMachine:uninitialized
2019-06-14 08:41:49,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 08:41:49,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 08:41:49,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 08:41:49,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 08:41:49,424 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 577857d2-6a9c-45e9-af79-cda0e853ec82:group-20886657AEF1 ConfigurationManager, init=-1: [577857d2-6a9c-45e9-af79-cda0e853ec82:127.0.0.1:43059], old=null, confs=<EMPTY_MAP>
2019-06-14 08:41:49,425 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler906064b8-2905-4b3f-aa8d-449c254ccec1/ratis] (custom)
2019-06-14 08:41:49,425 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler906064b8-2905-4b3f-aa8d-449c254ccec1/ratis/fc8c49f7-a615-40e5-83ab-20886657aef1 does not exist. Creating ...
2019-06-14 08:41:49,428 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler906064b8-2905-4b3f-aa8d-449c254ccec1/ratis/fc8c49f7-a615-40e5-83ab-20886657aef1/in_use.lock acquired by nodename 4182@ozone-xrdtn-1509355863
2019-06-14 08:41:49,430 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler906064b8-2905-4b3f-aa8d-449c254ccec1/ratis/fc8c49f7-a615-40e5-83ab-20886657aef1 has been successfully formatted.
2019-06-14 08:41:49,430 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 08:41:49,431 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 08:41:49,431 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 08:41:49,431 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 08:41:49,431 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 08:41:49,431 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 08:41:49,431 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 577857d2-6a9c-45e9-af79-cda0e853ec82-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler906064b8-2905-4b3f-aa8d-449c254ccec1/ratis/fc8c49f7-a615-40e5-83ab-20886657aef1
2019-06-14 08:41:49,431 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 08:41:49,431 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 08:41:49,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 08:41:49,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 08:41:49,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 08:41:49,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 08:41:49,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 08:41:49,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 08:41:49,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 08:41:49,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 08:41:49,433 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 08:41:49,433 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 08:41:49,433 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 08:41:49,433 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 577857d2-6a9c-45e9-af79-cda0e853ec82: start group-20886657AEF1
2019-06-14 08:41:49,433 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 577857d2-6a9c-45e9-af79-cda0e853ec82:group-20886657AEF1 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 08:41:49,433 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 577857d2-6a9c-45e9-af79-cda0e853ec82: start FollowerState
2019-06-14 08:41:49,434 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-20886657AEF1,id=577857d2-6a9c-45e9-af79-cda0e853ec82
2019-06-14 08:41:50,585 INFO  impl.FollowerState (FollowerState.java:run(101)) - 577857d2-6a9c-45e9-af79-cda0e853ec82:group-20886657AEF1 changes to CANDIDATE, lastRpcTime:1151, electionTimeout:1151ms
2019-06-14 08:41:50,585 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 577857d2-6a9c-45e9-af79-cda0e853ec82: shutdown FollowerState
2019-06-14 08:41:50,585 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 577857d2-6a9c-45e9-af79-cda0e853ec82:group-20886657AEF1 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 08:41:50,586 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 577857d2-6a9c-45e9-af79-cda0e853ec82: start LeaderElection
2019-06-14 08:41:50,588 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 577857d2-6a9c-45e9-af79-cda0e853ec82:group-20886657AEF1:LeaderElection2: begin an election at term 1 for -1: [577857d2-6a9c-45e9-af79-cda0e853ec82:127.0.0.1:43059], old=null
2019-06-14 08:41:50,589 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 577857d2-6a9c-45e9-af79-cda0e853ec82: shutdown LeaderElection
2019-06-14 08:41:50,589 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 577857d2-6a9c-45e9-af79-cda0e853ec82:group-20886657AEF1 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 08:41:50,589 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 577857d2-6a9c-45e9-af79-cda0e853ec82:group-20886657AEF1 change Leader from null to 577857d2-6a9c-45e9-af79-cda0e853ec82 at term 1 for becomeLeader, leader elected after 1158ms
2019-06-14 08:41:50,589 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 08:41:50,589 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 08:41:50,589 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 08:41:50,589 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 08:41:50,590 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 577857d2-6a9c-45e9-af79-cda0e853ec82: start LeaderState
2019-06-14 08:41:50,590 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 577857d2-6a9c-45e9-af79-cda0e853ec82-RaftLogWorker: Starting segment from index:0
2019-06-14 08:41:50,590 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 577857d2-6a9c-45e9-af79-cda0e853ec82:group-20886657AEF1 set configuration 0: [577857d2-6a9c-45e9-af79-cda0e853ec82:127.0.0.1:43059], old=null at 0
2019-06-14 08:41:50,626 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 577857d2-6a9c-45e9-af79-cda0e853ec82-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler906064b8-2905-4b3f-aa8d-449c254ccec1/ratis/fc8c49f7-a615-40e5-83ab-20886657aef1/current/log_inprogress_0
2019-06-14 08:41:51,468 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 08:41:51,469 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 577857d2-6a9c-45e9-af79-cda0e853ec82: close
2019-06-14 08:41:51,470 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 577857d2-6a9c-45e9-af79-cda0e853ec82: shutdown group-20886657AEF1
2019-06-14 08:41:51,470 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-20886657AEF1,id=577857d2-6a9c-45e9-af79-cda0e853ec82
2019-06-14 08:41:51,470 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 577857d2-6a9c-45e9-af79-cda0e853ec82: shutdown LeaderState
2019-06-14 08:41:51,471 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 577857d2-6a9c-45e9-af79-cda0e853ec82-PendingRequests: sendNotLeaderResponses
2019-06-14 08:41:51,471 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-577857d2-6a9c-45e9-af79-cda0e853ec82-group-20886657AEF1: set stopIndex = 2
2019-06-14 08:41:51,471 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-14 08:41:51,472 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler906064b8-2905-4b3f-aa8d-449c254ccec1/ratis/fc8c49f7-a615-40e5-83ab-20886657aef1/sm/snapshot.1_2
2019-06-14 08:41:51,472 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 577857d2-6a9c-45e9-af79-cda0e853ec82:group-20886657AEF1 closes. The last applied log index is 2
2019-06-14 08:41:51,473 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 577857d2-6a9c-45e9-af79-cda0e853ec82-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 08:41:51,473 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 577857d2-6a9c-45e9-af79-cda0e853ec82-RaftLogWorker close()
2019-06-14 08:41:51,474 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 577857d2-6a9c-45e9-af79-cda0e853ec82: shutdown server with port 43059 now
2019-06-14 08:41:51,475 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 577857d2-6a9c-45e9-af79-cda0e853ec82: shutdown server with port 43059 successfully
2019-06-14 08:41:51,477 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 08:41:51,502 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6537151-45cd-485c-ab7a-9057e85b8ee1/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 08:41:51,502 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6537151-45cd-485c-ab7a-9057e85b8ee1/hdds to VolumeSet
2019-06-14 08:41:51,503 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@692fd26
2019-06-14 08:41:51,503 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@692fd26
2019-06-14 08:41:51,517 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 37907
2019-06-14 08:41:51,518 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 08:41:51,519 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 08:41:51,519 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 37907 (custom)
2019-06-14 08:41:51,519 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 08:41:51,520 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 08:41:51,520 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 08:41:51,520 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 08:41:51,521 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6537151-45cd-485c-ab7a-9057e85b8ee1/ratis] (custom)
2019-06-14 08:41:51,521 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 43487
2019-06-14 08:41:51,522 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 08:41:51,522 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 08:41:51,522 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 4ed832ce-7b24-416c-85f3-2a64a2639781 at port 37907
2019-06-14 08:41:51,538 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 4ed832ce-7b24-416c-85f3-2a64a2639781: start RPC server
2019-06-14 08:41:51,539 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 4ed832ce-7b24-416c-85f3-2a64a2639781: GrpcService started, listening on 0.0.0.0/0.0.0.0:37907
2019-06-14 08:41:51,549 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 4ed832ce-7b24-416c-85f3-2a64a2639781: addNew group-88F99B0AE85B:[4ed832ce-7b24-416c-85f3-2a64a2639781:127.0.0.1:37907] returns group-88F99B0AE85B:java.util.concurrent.CompletableFuture@6cc9a80d[Not completed]
2019-06-14 08:41:51,549 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 4ed832ce-7b24-416c-85f3-2a64a2639781: new RaftServerImpl for group-88F99B0AE85B:[4ed832ce-7b24-416c-85f3-2a64a2639781:127.0.0.1:37907] with ContainerStateMachine:uninitialized
2019-06-14 08:41:51,550 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 08:41:51,550 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 08:41:51,550 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 08:41:51,550 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 08:41:51,550 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 4ed832ce-7b24-416c-85f3-2a64a2639781:group-88F99B0AE85B ConfigurationManager, init=-1: [4ed832ce-7b24-416c-85f3-2a64a2639781:127.0.0.1:37907], old=null, confs=<EMPTY_MAP>
2019-06-14 08:41:51,551 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6537151-45cd-485c-ab7a-9057e85b8ee1/ratis] (custom)
2019-06-14 08:41:51,551 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6537151-45cd-485c-ab7a-9057e85b8ee1/ratis/216af29b-1969-4300-be16-88f99b0ae85b does not exist. Creating ...
2019-06-14 08:41:51,554 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6537151-45cd-485c-ab7a-9057e85b8ee1/ratis/216af29b-1969-4300-be16-88f99b0ae85b/in_use.lock acquired by nodename 4182@ozone-xrdtn-1509355863
2019-06-14 08:41:51,556 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6537151-45cd-485c-ab7a-9057e85b8ee1/ratis/216af29b-1969-4300-be16-88f99b0ae85b has been successfully formatted.
2019-06-14 08:41:51,556 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 08:41:51,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 08:41:51,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 08:41:51,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 08:41:51,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 08:41:51,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 08:41:51,557 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 4ed832ce-7b24-416c-85f3-2a64a2639781-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6537151-45cd-485c-ab7a-9057e85b8ee1/ratis/216af29b-1969-4300-be16-88f99b0ae85b
2019-06-14 08:41:51,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 08:41:51,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 08:41:51,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 08:41:51,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 08:41:51,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 08:41:51,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 08:41:51,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 08:41:51,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 08:41:51,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 08:41:51,558 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 08:41:51,558 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 08:41:51,558 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 08:41:51,558 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 08:41:51,558 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 4ed832ce-7b24-416c-85f3-2a64a2639781: start group-88F99B0AE85B
2019-06-14 08:41:51,559 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4ed832ce-7b24-416c-85f3-2a64a2639781:group-88F99B0AE85B changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 08:41:51,559 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4ed832ce-7b24-416c-85f3-2a64a2639781: start FollowerState
2019-06-14 08:41:51,559 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-88F99B0AE85B,id=4ed832ce-7b24-416c-85f3-2a64a2639781
2019-06-14 08:41:52,713 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4ed832ce-7b24-416c-85f3-2a64a2639781:group-88F99B0AE85B changes to CANDIDATE, lastRpcTime:1154, electionTimeout:1154ms
2019-06-14 08:41:52,713 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4ed832ce-7b24-416c-85f3-2a64a2639781: shutdown FollowerState
2019-06-14 08:41:52,713 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4ed832ce-7b24-416c-85f3-2a64a2639781:group-88F99B0AE85B changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 08:41:52,713 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4ed832ce-7b24-416c-85f3-2a64a2639781: start LeaderElection
2019-06-14 08:41:52,716 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4ed832ce-7b24-416c-85f3-2a64a2639781:group-88F99B0AE85B:LeaderElection3: begin an election at term 1 for -1: [4ed832ce-7b24-416c-85f3-2a64a2639781:127.0.0.1:37907], old=null
2019-06-14 08:41:52,716 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4ed832ce-7b24-416c-85f3-2a64a2639781: shutdown LeaderElection
2019-06-14 08:41:52,717 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4ed832ce-7b24-416c-85f3-2a64a2639781:group-88F99B0AE85B changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 08:41:52,717 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 4ed832ce-7b24-416c-85f3-2a64a2639781:group-88F99B0AE85B change Leader from null to 4ed832ce-7b24-416c-85f3-2a64a2639781 at term 1 for becomeLeader, leader elected after 1160ms
2019-06-14 08:41:52,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 08:41:52,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 08:41:52,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 08:41:52,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 08:41:52,718 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4ed832ce-7b24-416c-85f3-2a64a2639781: start LeaderState
2019-06-14 08:41:52,718 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 4ed832ce-7b24-416c-85f3-2a64a2639781-RaftLogWorker: Starting segment from index:0
2019-06-14 08:41:52,718 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 4ed832ce-7b24-416c-85f3-2a64a2639781:group-88F99B0AE85B set configuration 0: [4ed832ce-7b24-416c-85f3-2a64a2639781:127.0.0.1:37907], old=null at 0
2019-06-14 08:41:52,754 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 4ed832ce-7b24-416c-85f3-2a64a2639781-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6537151-45cd-485c-ab7a-9057e85b8ee1/ratis/216af29b-1969-4300-be16-88f99b0ae85b/current/log_inprogress_0
2019-06-14 08:41:53,606 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 3890168296865849553 is closed with bcsId 0.
2019-06-14 08:41:53,606 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 08:41:53,607 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 4ed832ce-7b24-416c-85f3-2a64a2639781: close
2019-06-14 08:41:53,607 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 4ed832ce-7b24-416c-85f3-2a64a2639781: shutdown group-88F99B0AE85B
2019-06-14 08:41:53,607 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-88F99B0AE85B,id=4ed832ce-7b24-416c-85f3-2a64a2639781
2019-06-14 08:41:53,608 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 4ed832ce-7b24-416c-85f3-2a64a2639781: shutdown LeaderState
2019-06-14 08:41:53,608 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 4ed832ce-7b24-416c-85f3-2a64a2639781-PendingRequests: sendNotLeaderResponses
2019-06-14 08:41:53,609 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-14 08:41:53,609 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6537151-45cd-485c-ab7a-9057e85b8ee1/ratis/216af29b-1969-4300-be16-88f99b0ae85b/sm/snapshot.1_2
2019-06-14 08:41:53,610 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-4ed832ce-7b24-416c-85f3-2a64a2639781-group-88F99B0AE85B: set stopIndex = 2
2019-06-14 08:41:53,610 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 4ed832ce-7b24-416c-85f3-2a64a2639781:group-88F99B0AE85B closes. The last applied log index is 2
2019-06-14 08:41:53,611 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 4ed832ce-7b24-416c-85f3-2a64a2639781-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 08:41:53,611 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 4ed832ce-7b24-416c-85f3-2a64a2639781-RaftLogWorker close()
2019-06-14 08:41:53,613 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 4ed832ce-7b24-416c-85f3-2a64a2639781: shutdown server with port 37907 now
2019-06-14 08:41:53,615 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 4ed832ce-7b24-416c-85f3-2a64a2639781: shutdown server with port 37907 successfully
2019-06-14 08:41:53,627 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 08:41:53,652 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerde439a5e-e49f-41bf-953e-8ba33e34fb50/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 08:41:53,653 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerde439a5e-e49f-41bf-953e-8ba33e34fb50/hdds to VolumeSet
2019-06-14 08:41:53,653 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@e1e2e5e
2019-06-14 08:41:53,653 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@e1e2e5e
2019-06-14 08:41:53,661 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 36049
2019-06-14 08:41:53,663 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 08:41:53,663 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 08:41:53,663 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 36049 (custom)
2019-06-14 08:41:53,664 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 08:41:53,664 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 08:41:53,664 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 08:41:53,664 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 08:41:53,665 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerde439a5e-e49f-41bf-953e-8ba33e34fb50/ratis] (custom)
2019-06-14 08:41:53,665 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 37271
2019-06-14 08:41:53,666 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 08:41:53,666 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 08:41:53,666 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 0a996855-e7f0-4bb2-8776-ac21da2ddce3 at port 36049
2019-06-14 08:41:53,681 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3: start RPC server
2019-06-14 08:41:53,682 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3: GrpcService started, listening on 0.0.0.0/0.0.0.0:36049
Jun 14, 2019 8:41:53 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:37907} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 14, 2019 8:41:53 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:43059} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-14 08:41:53,699 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3: addNew group-33962B37F36B:[0a996855-e7f0-4bb2-8776-ac21da2ddce3:127.0.0.1:36049] returns group-33962B37F36B:java.util.concurrent.CompletableFuture@20e72520[Not completed]
2019-06-14 08:41:53,699 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3: new RaftServerImpl for group-33962B37F36B:[0a996855-e7f0-4bb2-8776-ac21da2ddce3:127.0.0.1:36049] with ContainerStateMachine:uninitialized
2019-06-14 08:41:53,700 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 08:41:53,700 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 08:41:53,700 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 08:41:53,700 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 08:41:53,700 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3:group-33962B37F36B ConfigurationManager, init=-1: [0a996855-e7f0-4bb2-8776-ac21da2ddce3:127.0.0.1:36049], old=null, confs=<EMPTY_MAP>
2019-06-14 08:41:53,700 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerde439a5e-e49f-41bf-953e-8ba33e34fb50/ratis] (custom)
2019-06-14 08:41:53,700 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerde439a5e-e49f-41bf-953e-8ba33e34fb50/ratis/56da4db8-9b60-46b1-bcd6-33962b37f36b does not exist. Creating ...
2019-06-14 08:41:53,703 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerde439a5e-e49f-41bf-953e-8ba33e34fb50/ratis/56da4db8-9b60-46b1-bcd6-33962b37f36b/in_use.lock acquired by nodename 4182@ozone-xrdtn-1509355863
2019-06-14 08:41:53,705 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerde439a5e-e49f-41bf-953e-8ba33e34fb50/ratis/56da4db8-9b60-46b1-bcd6-33962b37f36b has been successfully formatted.
2019-06-14 08:41:53,705 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 08:41:53,705 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 08:41:53,705 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 08:41:53,705 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 08:41:53,705 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 08:41:53,706 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 08:41:53,706 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 0a996855-e7f0-4bb2-8776-ac21da2ddce3-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerde439a5e-e49f-41bf-953e-8ba33e34fb50/ratis/56da4db8-9b60-46b1-bcd6-33962b37f36b
2019-06-14 08:41:53,706 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 08:41:53,706 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 08:41:53,706 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 08:41:53,706 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 08:41:53,706 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 08:41:53,706 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 08:41:53,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 08:41:53,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 08:41:53,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 08:41:53,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 08:41:53,708 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 08:41:53,708 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 08:41:53,708 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 08:41:53,708 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3: start group-33962B37F36B
2019-06-14 08:41:53,708 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3:group-33962B37F36B changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 08:41:53,708 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3: start FollowerState
2019-06-14 08:41:53,709 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-33962B37F36B,id=0a996855-e7f0-4bb2-8776-ac21da2ddce3
2019-06-14 08:41:54,735 INFO  impl.FollowerState (FollowerState.java:run(101)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3:group-33962B37F36B changes to CANDIDATE, lastRpcTime:1027, electionTimeout:1027ms
2019-06-14 08:41:54,736 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3: shutdown FollowerState
2019-06-14 08:41:54,736 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3:group-33962B37F36B changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 08:41:54,736 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3: start LeaderElection
2019-06-14 08:41:54,739 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3:group-33962B37F36B:LeaderElection4: begin an election at term 1 for -1: [0a996855-e7f0-4bb2-8776-ac21da2ddce3:127.0.0.1:36049], old=null
2019-06-14 08:41:54,739 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3: shutdown LeaderElection
2019-06-14 08:41:54,739 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3:group-33962B37F36B changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 08:41:54,739 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3:group-33962B37F36B change Leader from null to 0a996855-e7f0-4bb2-8776-ac21da2ddce3 at term 1 for becomeLeader, leader elected after 1034ms
2019-06-14 08:41:54,739 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 08:41:54,739 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 08:41:54,740 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 08:41:54,740 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 08:41:54,740 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3: start LeaderState
2019-06-14 08:41:54,740 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3-RaftLogWorker: Starting segment from index:0
2019-06-14 08:41:54,741 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3:group-33962B37F36B set configuration 0: [0a996855-e7f0-4bb2-8776-ac21da2ddce3:127.0.0.1:36049], old=null at 0
2019-06-14 08:41:54,777 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerde439a5e-e49f-41bf-953e-8ba33e34fb50/ratis/56da4db8-9b60-46b1-bcd6-33962b37f36b/current/log_inprogress_0
2019-06-14 08:41:55,745 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 8744199470907782689 is closed with bcsId 0.
2019-06-14 08:41:55,746 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 08:41:55,746 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3: close
2019-06-14 08:41:55,746 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3: shutdown group-33962B37F36B
2019-06-14 08:41:55,747 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-33962B37F36B,id=0a996855-e7f0-4bb2-8776-ac21da2ddce3
2019-06-14 08:41:55,747 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3: shutdown LeaderState
2019-06-14 08:41:55,747 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3-PendingRequests: sendNotLeaderResponses
2019-06-14 08:41:55,748 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-0a996855-e7f0-4bb2-8776-ac21da2ddce3-group-33962B37F36B: set stopIndex = 2
2019-06-14 08:41:55,748 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-14 08:41:55,748 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerde439a5e-e49f-41bf-953e-8ba33e34fb50/ratis/56da4db8-9b60-46b1-bcd6-33962b37f36b/sm/snapshot.1_2
2019-06-14 08:41:55,749 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3:group-33962B37F36B closes. The last applied log index is 2
2019-06-14 08:41:55,749 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 08:41:55,750 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3-RaftLogWorker close()
2019-06-14 08:41:55,750 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3: shutdown server with port 36049 now
2019-06-14 08:41:55,752 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 0a996855-e7f0-4bb2-8776-ac21da2ddce3: shutdown server with port 36049 successfully
2019-06-14 08:41:55,753 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 08:41:55,773 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera87cfea7-7796-4785-b546-4bd20d0fa9e6/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 08:41:55,773 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera87cfea7-7796-4785-b546-4bd20d0fa9e6/hdds to VolumeSet
2019-06-14 08:41:55,773 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@367b22e5
2019-06-14 08:41:55,773 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@367b22e5
2019-06-14 08:41:55,781 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 34167
2019-06-14 08:41:55,783 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 08:41:55,783 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 08:41:55,784 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 34167 (custom)
2019-06-14 08:41:55,784 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 08:41:55,784 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 08:41:55,784 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 08:41:55,785 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 08:41:55,785 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera87cfea7-7796-4785-b546-4bd20d0fa9e6/ratis] (custom)
2019-06-14 08:41:55,785 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 43261
2019-06-14 08:41:55,786 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 08:41:55,786 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 08:41:55,786 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2 at port 34167
2019-06-14 08:41:55,802 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2: start RPC server
2019-06-14 08:41:55,803 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2: GrpcService started, listening on 0.0.0.0/0.0.0.0:34167
2019-06-14 08:41:55,812 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2: addNew group-8F28DFE39B4F:[edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2:127.0.0.1:34167] returns group-8F28DFE39B4F:java.util.concurrent.CompletableFuture@a76b152[Not completed]
2019-06-14 08:41:55,812 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2: new RaftServerImpl for group-8F28DFE39B4F:[edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2:127.0.0.1:34167] with ContainerStateMachine:uninitialized
2019-06-14 08:41:55,813 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 08:41:55,813 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 08:41:55,813 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 08:41:55,813 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 08:41:55,813 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2:group-8F28DFE39B4F ConfigurationManager, init=-1: [edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2:127.0.0.1:34167], old=null, confs=<EMPTY_MAP>
2019-06-14 08:41:55,813 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera87cfea7-7796-4785-b546-4bd20d0fa9e6/ratis] (custom)
2019-06-14 08:41:55,814 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera87cfea7-7796-4785-b546-4bd20d0fa9e6/ratis/2098364d-132b-4645-bc3f-8f28dfe39b4f does not exist. Creating ...
2019-06-14 08:41:55,816 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera87cfea7-7796-4785-b546-4bd20d0fa9e6/ratis/2098364d-132b-4645-bc3f-8f28dfe39b4f/in_use.lock acquired by nodename 4182@ozone-xrdtn-1509355863
2019-06-14 08:41:55,818 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera87cfea7-7796-4785-b546-4bd20d0fa9e6/ratis/2098364d-132b-4645-bc3f-8f28dfe39b4f has been successfully formatted.
2019-06-14 08:41:55,818 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 08:41:55,818 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 08:41:55,819 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 08:41:55,819 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 08:41:55,819 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 08:41:55,819 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 08:41:55,819 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera87cfea7-7796-4785-b546-4bd20d0fa9e6/ratis/2098364d-132b-4645-bc3f-8f28dfe39b4f
2019-06-14 08:41:55,819 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 08:41:55,819 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 08:41:55,819 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 08:41:55,820 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 08:41:55,820 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 08:41:55,820 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 08:41:55,820 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 08:41:55,820 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 08:41:55,820 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 08:41:55,820 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 08:41:55,821 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 08:41:55,821 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 08:41:55,821 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 08:41:55,821 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2: start group-8F28DFE39B4F
2019-06-14 08:41:55,821 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2:group-8F28DFE39B4F changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 08:41:55,821 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2: start FollowerState
2019-06-14 08:41:55,824 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-8F28DFE39B4F,id=edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2
2019-06-14 08:41:56,885 INFO  impl.FollowerState (FollowerState.java:run(101)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2:group-8F28DFE39B4F changes to CANDIDATE, lastRpcTime:1063, electionTimeout:1061ms
2019-06-14 08:41:56,885 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2: shutdown FollowerState
2019-06-14 08:41:56,885 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2:group-8F28DFE39B4F changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 08:41:56,885 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2: start LeaderElection
2019-06-14 08:41:56,889 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2:group-8F28DFE39B4F:LeaderElection5: begin an election at term 1 for -1: [edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2:127.0.0.1:34167], old=null
2019-06-14 08:41:56,889 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2: shutdown LeaderElection
2019-06-14 08:41:56,889 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2:group-8F28DFE39B4F changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 08:41:56,889 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2:group-8F28DFE39B4F change Leader from null to edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2 at term 1 for becomeLeader, leader elected after 1070ms
2019-06-14 08:41:56,889 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 08:41:56,889 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 08:41:56,889 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 08:41:56,890 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 08:41:56,890 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2: start LeaderState
2019-06-14 08:41:56,890 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2-RaftLogWorker: Starting segment from index:0
2019-06-14 08:41:56,892 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2:group-8F28DFE39B4F set configuration 0: [edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2:127.0.0.1:34167], old=null at 0
2019-06-14 08:41:56,926 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera87cfea7-7796-4785-b546-4bd20d0fa9e6/ratis/2098364d-132b-4645-bc3f-8f28dfe39b4f/current/log_inprogress_0
2019-06-14 08:41:57,862 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 3440831022041120799 is closed with bcsId 0.
2019-06-14 08:41:57,862 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 08:41:57,863 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2: close
2019-06-14 08:41:57,863 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2: shutdown group-8F28DFE39B4F
2019-06-14 08:41:57,863 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-8F28DFE39B4F,id=edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2
2019-06-14 08:41:57,863 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2: shutdown LeaderState
2019-06-14 08:41:57,864 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2-PendingRequests: sendNotLeaderResponses
2019-06-14 08:41:57,865 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2-group-8F28DFE39B4F: set stopIndex = 4
2019-06-14 08:41:57,865 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-14 08:41:57,865 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera87cfea7-7796-4785-b546-4bd20d0fa9e6/ratis/2098364d-132b-4645-bc3f-8f28dfe39b4f/sm/snapshot.1_4
2019-06-14 08:41:57,865 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2:group-8F28DFE39B4F closes. The last applied log index is 4
2019-06-14 08:41:57,866 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 08:41:57,866 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2-RaftLogWorker close()
2019-06-14 08:41:57,867 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2: shutdown server with port 34167 now
2019-06-14 08:41:57,868 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - edf2ae67-7bc4-4440-959b-e8ca9d2bcbe2: shutdown server with port 34167 successfully
2019-06-14 08:41:57,869 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
