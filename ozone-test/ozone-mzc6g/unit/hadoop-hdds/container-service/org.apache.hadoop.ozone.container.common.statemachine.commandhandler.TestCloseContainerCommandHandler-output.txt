2019-06-13 21:54:58,808 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3cfdb523-510b-4da4-9eec-84445f4faf83/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 21:54:58,814 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3cfdb523-510b-4da4-9eec-84445f4faf83/hdds to VolumeSet
2019-06-13 21:54:58,831 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-13 21:54:58,873 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-13 21:54:59,649 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 45125
2019-06-13 21:55:00,544 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 21:55:00,576 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 21:55:00,588 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 45125 (custom)
2019-06-13 21:55:00,589 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 21:55:00,591 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 21:55:00,592 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 21:55:00,593 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 21:55:00,766 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3cfdb523-510b-4da4-9eec-84445f4faf83/ratis] (custom)
2019-06-13 21:55:00,783 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 33249
2019-06-13 21:55:00,816 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 21:55:00,816 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 21:55:00,819 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis fbba5219-5bcb-4d9f-86c4-10953cfa1fbf at port 45125
2019-06-13 21:55:00,981 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf: start RPC server
2019-06-13 21:55:01,276 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf: GrpcService started, listening on 0.0.0.0/0.0.0.0:45125
2019-06-13 21:55:01,910 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf: addNew group-D03204F93519:[fbba5219-5bcb-4d9f-86c4-10953cfa1fbf:127.0.0.1:45125] returns group-D03204F93519:java.util.concurrent.CompletableFuture@4c86d7f0[Not completed]
2019-06-13 21:55:01,954 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf: new RaftServerImpl for group-D03204F93519:[fbba5219-5bcb-4d9f-86c4-10953cfa1fbf:127.0.0.1:45125] with ContainerStateMachine:uninitialized
2019-06-13 21:55:01,955 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 21:55:01,956 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 21:55:01,956 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 21:55:01,957 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 21:55:01,963 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf:group-D03204F93519 ConfigurationManager, init=-1: [fbba5219-5bcb-4d9f-86c4-10953cfa1fbf:127.0.0.1:45125], old=null, confs=<EMPTY_MAP>
2019-06-13 21:55:01,963 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3cfdb523-510b-4da4-9eec-84445f4faf83/ratis] (custom)
2019-06-13 21:55:01,977 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3cfdb523-510b-4da4-9eec-84445f4faf83/ratis/40074ff2-3a84-4af3-a819-d03204f93519 does not exist. Creating ...
2019-06-13 21:55:01,989 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3cfdb523-510b-4da4-9eec-84445f4faf83/ratis/40074ff2-3a84-4af3-a819-d03204f93519/in_use.lock acquired by nodename 4219@ozone-mzc6g-525209162
2019-06-13 21:55:01,999 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3cfdb523-510b-4da4-9eec-84445f4faf83/ratis/40074ff2-3a84-4af3-a819-d03204f93519 has been successfully formatted.
2019-06-13 21:55:02,003 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 21:55:02,006 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 21:55:02,009 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 21:55:02,015 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 21:55:02,019 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 21:55:02,024 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 21:55:02,027 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new fbba5219-5bcb-4d9f-86c4-10953cfa1fbf-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3cfdb523-510b-4da4-9eec-84445f4faf83/ratis/40074ff2-3a84-4af3-a819-d03204f93519
2019-06-13 21:55:02,029 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 21:55:02,029 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 21:55:02,031 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 21:55:02,032 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 21:55:02,033 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 21:55:02,033 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 21:55:02,034 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 21:55:02,035 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 21:55:02,036 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 21:55:02,038 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 21:55:02,059 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 21:55:02,060 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 21:55:02,061 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 21:55:02,177 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf: start group-D03204F93519
2019-06-13 21:55:02,178 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf:group-D03204F93519 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 21:55:02,180 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf: start FollowerState
2019-06-13 21:55:02,183 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D03204F93519,id=fbba5219-5bcb-4d9f-86c4-10953cfa1fbf
2019-06-13 21:55:03,334 INFO  impl.FollowerState (FollowerState.java:run(101)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf:group-D03204F93519 changes to CANDIDATE, lastRpcTime:1154, electionTimeout:1148ms
2019-06-13 21:55:03,334 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf: shutdown FollowerState
2019-06-13 21:55:03,335 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf:group-D03204F93519 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 21:55:03,338 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf: start LeaderElection
2019-06-13 21:55:03,344 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf:group-D03204F93519:LeaderElection1: begin an election at term 1 for -1: [fbba5219-5bcb-4d9f-86c4-10953cfa1fbf:127.0.0.1:45125], old=null
2019-06-13 21:55:03,346 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf: shutdown LeaderElection
2019-06-13 21:55:03,349 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf:group-D03204F93519 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 21:55:03,349 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf:group-D03204F93519 change Leader from null to fbba5219-5bcb-4d9f-86c4-10953cfa1fbf at term 1 for becomeLeader, leader elected after 1342ms
2019-06-13 21:55:03,361 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 21:55:03,361 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 21:55:03,364 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 21:55:03,365 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 21:55:03,386 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf: start LeaderState
2019-06-13 21:55:03,408 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf-RaftLogWorker: Starting segment from index:0
2019-06-13 21:55:03,450 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf:group-D03204F93519 set configuration 0: [fbba5219-5bcb-4d9f-86c4-10953cfa1fbf:127.0.0.1:45125], old=null at 0
2019-06-13 21:55:03,650 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3cfdb523-510b-4da4-9eec-84445f4faf83/ratis/40074ff2-3a84-4af3-a819-d03204f93519/current/log_inprogress_0
2019-06-13 21:55:04,563 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-13 21:55:04,677 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 2156480042315700836 is closed with bcsId 0.
2019-06-13 21:55:04,680 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 21:55:04,681 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf: close
2019-06-13 21:55:04,683 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf: shutdown group-D03204F93519
2019-06-13 21:55:04,684 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D03204F93519,id=fbba5219-5bcb-4d9f-86c4-10953cfa1fbf
2019-06-13 21:55:04,684 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf: shutdown LeaderState
2019-06-13 21:55:04,685 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf-PendingRequests: sendNotLeaderResponses
2019-06-13 21:55:04,689 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-fbba5219-5bcb-4d9f-86c4-10953cfa1fbf-group-D03204F93519: set stopIndex = 4
2019-06-13 21:55:04,689 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-13 21:55:04,690 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3cfdb523-510b-4da4-9eec-84445f4faf83/ratis/40074ff2-3a84-4af3-a819-d03204f93519/sm/snapshot.1_4
2019-06-13 21:55:04,711 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf:group-D03204F93519 closes. The last applied log index is 4
2019-06-13 21:55:04,712 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 21:55:04,714 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf-RaftLogWorker close()
2019-06-13 21:55:04,715 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf: shutdown server with port 45125 now
2019-06-13 21:55:04,725 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - fbba5219-5bcb-4d9f-86c4-10953cfa1fbf: shutdown server with port 45125 successfully
2019-06-13 21:55:04,758 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 21:55:04,857 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2c3d9ec3-5ce4-450d-820c-1df4d7c5c44e/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 21:55:04,858 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2c3d9ec3-5ce4-450d-820c-1df4d7c5c44e/hdds to VolumeSet
2019-06-13 21:55:04,858 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@2a9bc08f
2019-06-13 21:55:04,861 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@2a9bc08f
2019-06-13 21:55:04,902 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 37377
2019-06-13 21:55:04,903 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 21:55:04,904 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 21:55:04,904 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 37377 (custom)
2019-06-13 21:55:04,904 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 21:55:04,905 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 21:55:04,905 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 21:55:04,905 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 21:55:04,906 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2c3d9ec3-5ce4-450d-820c-1df4d7c5c44e/ratis] (custom)
2019-06-13 21:55:04,907 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 33465
2019-06-13 21:55:04,907 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 21:55:04,907 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 21:55:04,907 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 1b49564d-1359-4770-9e11-c3de7a920a62 at port 37377
2019-06-13 21:55:04,967 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 1b49564d-1359-4770-9e11-c3de7a920a62: start RPC server
2019-06-13 21:55:04,968 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 1b49564d-1359-4770-9e11-c3de7a920a62: GrpcService started, listening on 0.0.0.0/0.0.0.0:37377
2019-06-13 21:55:05,014 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 1b49564d-1359-4770-9e11-c3de7a920a62: addNew group-598F9D4FDC13:[1b49564d-1359-4770-9e11-c3de7a920a62:127.0.0.1:37377] returns group-598F9D4FDC13:java.util.concurrent.CompletableFuture@63943486[Not completed]
2019-06-13 21:55:05,015 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 1b49564d-1359-4770-9e11-c3de7a920a62: new RaftServerImpl for group-598F9D4FDC13:[1b49564d-1359-4770-9e11-c3de7a920a62:127.0.0.1:37377] with ContainerStateMachine:uninitialized
2019-06-13 21:55:05,017 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 21:55:05,018 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 21:55:05,018 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 21:55:05,018 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 21:55:05,018 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 1b49564d-1359-4770-9e11-c3de7a920a62:group-598F9D4FDC13 ConfigurationManager, init=-1: [1b49564d-1359-4770-9e11-c3de7a920a62:127.0.0.1:37377], old=null, confs=<EMPTY_MAP>
2019-06-13 21:55:05,018 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2c3d9ec3-5ce4-450d-820c-1df4d7c5c44e/ratis] (custom)
2019-06-13 21:55:05,019 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2c3d9ec3-5ce4-450d-820c-1df4d7c5c44e/ratis/1e7ebd06-e381-4084-a188-598f9d4fdc13 does not exist. Creating ...
2019-06-13 21:55:05,025 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2c3d9ec3-5ce4-450d-820c-1df4d7c5c44e/ratis/1e7ebd06-e381-4084-a188-598f9d4fdc13/in_use.lock acquired by nodename 4219@ozone-mzc6g-525209162
2019-06-13 21:55:05,027 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2c3d9ec3-5ce4-450d-820c-1df4d7c5c44e/ratis/1e7ebd06-e381-4084-a188-598f9d4fdc13 has been successfully formatted.
2019-06-13 21:55:05,028 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 21:55:05,028 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 21:55:05,028 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 21:55:05,029 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 21:55:05,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 21:55:05,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 21:55:05,030 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 1b49564d-1359-4770-9e11-c3de7a920a62-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2c3d9ec3-5ce4-450d-820c-1df4d7c5c44e/ratis/1e7ebd06-e381-4084-a188-598f9d4fdc13
2019-06-13 21:55:05,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 21:55:05,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 21:55:05,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 21:55:05,031 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 21:55:05,036 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 21:55:05,037 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 21:55:05,037 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 21:55:05,037 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 21:55:05,037 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 21:55:05,038 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 21:55:05,039 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 21:55:05,040 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 21:55:05,040 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 21:55:05,040 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 1b49564d-1359-4770-9e11-c3de7a920a62: start group-598F9D4FDC13
2019-06-13 21:55:05,040 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1b49564d-1359-4770-9e11-c3de7a920a62:group-598F9D4FDC13 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 21:55:05,040 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1b49564d-1359-4770-9e11-c3de7a920a62: start FollowerState
2019-06-13 21:55:05,041 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-598F9D4FDC13,id=1b49564d-1359-4770-9e11-c3de7a920a62
2019-06-13 21:55:06,139 INFO  impl.FollowerState (FollowerState.java:run(101)) - 1b49564d-1359-4770-9e11-c3de7a920a62:group-598F9D4FDC13 changes to CANDIDATE, lastRpcTime:1098, electionTimeout:1098ms
2019-06-13 21:55:06,139 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 1b49564d-1359-4770-9e11-c3de7a920a62: shutdown FollowerState
2019-06-13 21:55:06,139 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1b49564d-1359-4770-9e11-c3de7a920a62:group-598F9D4FDC13 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 21:55:06,139 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1b49564d-1359-4770-9e11-c3de7a920a62: start LeaderElection
2019-06-13 21:55:06,152 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 1b49564d-1359-4770-9e11-c3de7a920a62:group-598F9D4FDC13:LeaderElection2: begin an election at term 1 for -1: [1b49564d-1359-4770-9e11-c3de7a920a62:127.0.0.1:37377], old=null
2019-06-13 21:55:06,152 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 1b49564d-1359-4770-9e11-c3de7a920a62: shutdown LeaderElection
2019-06-13 21:55:06,154 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1b49564d-1359-4770-9e11-c3de7a920a62:group-598F9D4FDC13 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 21:55:06,158 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 1b49564d-1359-4770-9e11-c3de7a920a62:group-598F9D4FDC13 change Leader from null to 1b49564d-1359-4770-9e11-c3de7a920a62 at term 1 for becomeLeader, leader elected after 1129ms
2019-06-13 21:55:06,158 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 21:55:06,158 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 21:55:06,159 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 21:55:06,159 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 21:55:06,164 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1b49564d-1359-4770-9e11-c3de7a920a62: start LeaderState
2019-06-13 21:55:06,164 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 1b49564d-1359-4770-9e11-c3de7a920a62-RaftLogWorker: Starting segment from index:0
2019-06-13 21:55:06,184 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 1b49564d-1359-4770-9e11-c3de7a920a62:group-598F9D4FDC13 set configuration 0: [1b49564d-1359-4770-9e11-c3de7a920a62:127.0.0.1:37377], old=null at 0
2019-06-13 21:55:06,213 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 1b49564d-1359-4770-9e11-c3de7a920a62-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2c3d9ec3-5ce4-450d-820c-1df4d7c5c44e/ratis/1e7ebd06-e381-4084-a188-598f9d4fdc13/current/log_inprogress_0
2019-06-13 21:55:07,133 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 21:55:07,137 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 1b49564d-1359-4770-9e11-c3de7a920a62: close
2019-06-13 21:55:07,137 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 1b49564d-1359-4770-9e11-c3de7a920a62: shutdown group-598F9D4FDC13
2019-06-13 21:55:07,138 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-598F9D4FDC13,id=1b49564d-1359-4770-9e11-c3de7a920a62
2019-06-13 21:55:07,138 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 1b49564d-1359-4770-9e11-c3de7a920a62: shutdown LeaderState
2019-06-13 21:55:07,138 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 1b49564d-1359-4770-9e11-c3de7a920a62-PendingRequests: sendNotLeaderResponses
2019-06-13 21:55:07,154 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-13 21:55:07,154 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2c3d9ec3-5ce4-450d-820c-1df4d7c5c44e/ratis/1e7ebd06-e381-4084-a188-598f9d4fdc13/sm/snapshot.1_2
2019-06-13 21:55:07,154 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-1b49564d-1359-4770-9e11-c3de7a920a62-group-598F9D4FDC13: set stopIndex = 2
2019-06-13 21:55:07,155 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 1b49564d-1359-4770-9e11-c3de7a920a62:group-598F9D4FDC13 closes. The last applied log index is 2
2019-06-13 21:55:07,156 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 1b49564d-1359-4770-9e11-c3de7a920a62-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 21:55:07,156 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 1b49564d-1359-4770-9e11-c3de7a920a62-RaftLogWorker close()
2019-06-13 21:55:07,162 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 1b49564d-1359-4770-9e11-c3de7a920a62: shutdown server with port 37377 now
2019-06-13 21:55:07,164 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 1b49564d-1359-4770-9e11-c3de7a920a62: shutdown server with port 37377 successfully
2019-06-13 21:55:07,182 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 21:55:07,213 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera26e6d4c-8bfb-4195-8fb2-99e296938656/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 21:55:07,214 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera26e6d4c-8bfb-4195-8fb2-99e296938656/hdds to VolumeSet
2019-06-13 21:55:07,214 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@7d0614f
2019-06-13 21:55:07,216 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@7d0614f
2019-06-13 21:55:07,241 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 34629
2019-06-13 21:55:07,242 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 21:55:07,243 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 21:55:07,245 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 34629 (custom)
2019-06-13 21:55:07,245 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 21:55:07,246 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 21:55:07,246 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 21:55:07,248 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 21:55:07,249 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera26e6d4c-8bfb-4195-8fb2-99e296938656/ratis] (custom)
2019-06-13 21:55:07,249 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 35515
2019-06-13 21:55:07,250 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 21:55:07,250 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 21:55:07,250 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 9f2bb600-3465-426a-a7d6-5e1fa42ce551 at port 34629
2019-06-13 21:55:07,263 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551: start RPC server
2019-06-13 21:55:07,265 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551: GrpcService started, listening on 0.0.0.0/0.0.0.0:34629
2019-06-13 21:55:07,280 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551: addNew group-EA2FCF0045D9:[9f2bb600-3465-426a-a7d6-5e1fa42ce551:127.0.0.1:34629] returns group-EA2FCF0045D9:java.util.concurrent.CompletableFuture@7b2e836f[Not completed]
2019-06-13 21:55:07,287 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551: new RaftServerImpl for group-EA2FCF0045D9:[9f2bb600-3465-426a-a7d6-5e1fa42ce551:127.0.0.1:34629] with ContainerStateMachine:uninitialized
2019-06-13 21:55:07,288 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 21:55:07,288 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 21:55:07,288 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 21:55:07,288 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 21:55:07,288 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551:group-EA2FCF0045D9 ConfigurationManager, init=-1: [9f2bb600-3465-426a-a7d6-5e1fa42ce551:127.0.0.1:34629], old=null, confs=<EMPTY_MAP>
2019-06-13 21:55:07,289 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera26e6d4c-8bfb-4195-8fb2-99e296938656/ratis] (custom)
2019-06-13 21:55:07,289 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera26e6d4c-8bfb-4195-8fb2-99e296938656/ratis/ea04fc20-49de-4706-a585-ea2fcf0045d9 does not exist. Creating ...
2019-06-13 21:55:07,292 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera26e6d4c-8bfb-4195-8fb2-99e296938656/ratis/ea04fc20-49de-4706-a585-ea2fcf0045d9/in_use.lock acquired by nodename 4219@ozone-mzc6g-525209162
2019-06-13 21:55:07,295 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera26e6d4c-8bfb-4195-8fb2-99e296938656/ratis/ea04fc20-49de-4706-a585-ea2fcf0045d9 has been successfully formatted.
2019-06-13 21:55:07,295 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 21:55:07,297 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 21:55:07,298 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 21:55:07,298 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 21:55:07,298 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 21:55:07,298 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 21:55:07,298 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 9f2bb600-3465-426a-a7d6-5e1fa42ce551-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera26e6d4c-8bfb-4195-8fb2-99e296938656/ratis/ea04fc20-49de-4706-a585-ea2fcf0045d9
2019-06-13 21:55:07,298 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 21:55:07,299 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 21:55:07,299 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 21:55:07,299 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 21:55:07,299 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 21:55:07,299 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 21:55:07,300 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 21:55:07,300 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 21:55:07,300 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 21:55:07,301 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 21:55:07,310 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 21:55:07,310 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 21:55:07,311 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 21:55:07,311 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551: start group-EA2FCF0045D9
2019-06-13 21:55:07,311 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551:group-EA2FCF0045D9 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 21:55:07,311 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551: start FollowerState
2019-06-13 21:55:07,312 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-EA2FCF0045D9,id=9f2bb600-3465-426a-a7d6-5e1fa42ce551
2019-06-13 21:55:08,318 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551:group-EA2FCF0045D9 changes to CANDIDATE, lastRpcTime:1006, electionTimeout:1006ms
2019-06-13 21:55:08,318 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551: shutdown FollowerState
2019-06-13 21:55:08,318 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551:group-EA2FCF0045D9 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 21:55:08,318 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551: start LeaderElection
2019-06-13 21:55:08,326 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551:group-EA2FCF0045D9:LeaderElection3: begin an election at term 1 for -1: [9f2bb600-3465-426a-a7d6-5e1fa42ce551:127.0.0.1:34629], old=null
2019-06-13 21:55:08,326 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551: shutdown LeaderElection
2019-06-13 21:55:08,326 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551:group-EA2FCF0045D9 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 21:55:08,327 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551:group-EA2FCF0045D9 change Leader from null to 9f2bb600-3465-426a-a7d6-5e1fa42ce551 at term 1 for becomeLeader, leader elected after 1029ms
2019-06-13 21:55:08,327 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 21:55:08,327 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 21:55:08,327 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 21:55:08,327 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 21:55:08,327 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551: start LeaderState
2019-06-13 21:55:08,328 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551-RaftLogWorker: Starting segment from index:0
2019-06-13 21:55:08,329 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551:group-EA2FCF0045D9 set configuration 0: [9f2bb600-3465-426a-a7d6-5e1fa42ce551:127.0.0.1:34629], old=null at 0
2019-06-13 21:55:08,385 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera26e6d4c-8bfb-4195-8fb2-99e296938656/ratis/ea04fc20-49de-4706-a585-ea2fcf0045d9/current/log_inprogress_0
2019-06-13 21:55:09,398 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 668998824382084418 is closed with bcsId 0.
2019-06-13 21:55:09,402 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 21:55:09,403 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551: close
2019-06-13 21:55:09,403 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551: shutdown group-EA2FCF0045D9
2019-06-13 21:55:09,403 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-EA2FCF0045D9,id=9f2bb600-3465-426a-a7d6-5e1fa42ce551
2019-06-13 21:55:09,404 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551: shutdown LeaderState
2019-06-13 21:55:09,404 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551-PendingRequests: sendNotLeaderResponses
2019-06-13 21:55:09,405 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-9f2bb600-3465-426a-a7d6-5e1fa42ce551-group-EA2FCF0045D9: set stopIndex = 2
2019-06-13 21:55:09,405 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-13 21:55:09,410 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera26e6d4c-8bfb-4195-8fb2-99e296938656/ratis/ea04fc20-49de-4706-a585-ea2fcf0045d9/sm/snapshot.1_2
2019-06-13 21:55:09,411 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551:group-EA2FCF0045D9 closes. The last applied log index is 2
2019-06-13 21:55:09,413 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 21:55:09,424 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551-RaftLogWorker close()
2019-06-13 21:55:09,439 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551: shutdown server with port 34629 now
2019-06-13 21:55:09,442 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 9f2bb600-3465-426a-a7d6-5e1fa42ce551: shutdown server with port 34629 successfully
2019-06-13 21:55:09,465 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 21:55:09,545 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfcd4db55-33a8-496c-a44a-b66afc7203c5/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 21:55:09,545 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfcd4db55-33a8-496c-a44a-b66afc7203c5/hdds to VolumeSet
2019-06-13 21:55:09,545 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3b95d13c
2019-06-13 21:55:09,553 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3b95d13c
2019-06-13 21:55:09,581 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 35691
2019-06-13 21:55:09,583 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 21:55:09,600 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 21:55:09,601 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 35691 (custom)
2019-06-13 21:55:09,601 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 21:55:09,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 21:55:09,602 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 21:55:09,602 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 21:55:09,603 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfcd4db55-33a8-496c-a44a-b66afc7203c5/ratis] (custom)
2019-06-13 21:55:09,605 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 41409
2019-06-13 21:55:09,608 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 21:55:09,608 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 21:55:09,608 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis c38578f6-362c-4d77-9323-b32f4d8e0bae at port 35691
2019-06-13 21:55:09,617 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - c38578f6-362c-4d77-9323-b32f4d8e0bae: start RPC server
2019-06-13 21:55:09,622 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - c38578f6-362c-4d77-9323-b32f4d8e0bae: GrpcService started, listening on 0.0.0.0/0.0.0.0:35691
Jun 13, 2019 9:55:09 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:37377} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 13, 2019 9:55:09 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:34629} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-13 21:55:09,653 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - c38578f6-362c-4d77-9323-b32f4d8e0bae: addNew group-FD80C1596D53:[c38578f6-362c-4d77-9323-b32f4d8e0bae:127.0.0.1:35691] returns group-FD80C1596D53:java.util.concurrent.CompletableFuture@532798de[Not completed]
2019-06-13 21:55:09,657 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - c38578f6-362c-4d77-9323-b32f4d8e0bae: new RaftServerImpl for group-FD80C1596D53:[c38578f6-362c-4d77-9323-b32f4d8e0bae:127.0.0.1:35691] with ContainerStateMachine:uninitialized
2019-06-13 21:55:09,657 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 21:55:09,657 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 21:55:09,657 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 21:55:09,657 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 21:55:09,658 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - c38578f6-362c-4d77-9323-b32f4d8e0bae:group-FD80C1596D53 ConfigurationManager, init=-1: [c38578f6-362c-4d77-9323-b32f4d8e0bae:127.0.0.1:35691], old=null, confs=<EMPTY_MAP>
2019-06-13 21:55:09,658 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfcd4db55-33a8-496c-a44a-b66afc7203c5/ratis] (custom)
2019-06-13 21:55:09,659 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfcd4db55-33a8-496c-a44a-b66afc7203c5/ratis/a1649f47-04e5-4236-84d0-fd80c1596d53 does not exist. Creating ...
2019-06-13 21:55:09,662 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfcd4db55-33a8-496c-a44a-b66afc7203c5/ratis/a1649f47-04e5-4236-84d0-fd80c1596d53/in_use.lock acquired by nodename 4219@ozone-mzc6g-525209162
2019-06-13 21:55:09,665 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfcd4db55-33a8-496c-a44a-b66afc7203c5/ratis/a1649f47-04e5-4236-84d0-fd80c1596d53 has been successfully formatted.
2019-06-13 21:55:09,666 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 21:55:09,667 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 21:55:09,667 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 21:55:09,667 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 21:55:09,667 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 21:55:09,669 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 21:55:09,669 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new c38578f6-362c-4d77-9323-b32f4d8e0bae-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfcd4db55-33a8-496c-a44a-b66afc7203c5/ratis/a1649f47-04e5-4236-84d0-fd80c1596d53
2019-06-13 21:55:09,669 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 21:55:09,669 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 21:55:09,669 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 21:55:09,669 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 21:55:09,669 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 21:55:09,669 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 21:55:09,670 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 21:55:09,670 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 21:55:09,670 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 21:55:09,670 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 21:55:09,671 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 21:55:09,672 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 21:55:09,672 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 21:55:09,672 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - c38578f6-362c-4d77-9323-b32f4d8e0bae: start group-FD80C1596D53
2019-06-13 21:55:09,672 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - c38578f6-362c-4d77-9323-b32f4d8e0bae:group-FD80C1596D53 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 21:55:09,672 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c38578f6-362c-4d77-9323-b32f4d8e0bae: start FollowerState
2019-06-13 21:55:09,673 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-FD80C1596D53,id=c38578f6-362c-4d77-9323-b32f4d8e0bae
2019-06-13 21:55:10,835 INFO  impl.FollowerState (FollowerState.java:run(101)) - c38578f6-362c-4d77-9323-b32f4d8e0bae:group-FD80C1596D53 changes to CANDIDATE, lastRpcTime:1162, electionTimeout:1161ms
2019-06-13 21:55:10,835 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - c38578f6-362c-4d77-9323-b32f4d8e0bae: shutdown FollowerState
2019-06-13 21:55:10,835 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - c38578f6-362c-4d77-9323-b32f4d8e0bae:group-FD80C1596D53 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 21:55:10,835 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c38578f6-362c-4d77-9323-b32f4d8e0bae: start LeaderElection
2019-06-13 21:55:10,839 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - c38578f6-362c-4d77-9323-b32f4d8e0bae:group-FD80C1596D53:LeaderElection4: begin an election at term 1 for -1: [c38578f6-362c-4d77-9323-b32f4d8e0bae:127.0.0.1:35691], old=null
2019-06-13 21:55:10,839 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - c38578f6-362c-4d77-9323-b32f4d8e0bae: shutdown LeaderElection
2019-06-13 21:55:10,839 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - c38578f6-362c-4d77-9323-b32f4d8e0bae:group-FD80C1596D53 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 21:55:10,840 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - c38578f6-362c-4d77-9323-b32f4d8e0bae:group-FD80C1596D53 change Leader from null to c38578f6-362c-4d77-9323-b32f4d8e0bae at term 1 for becomeLeader, leader elected after 1172ms
2019-06-13 21:55:10,840 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 21:55:10,840 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 21:55:10,840 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 21:55:10,840 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 21:55:10,840 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c38578f6-362c-4d77-9323-b32f4d8e0bae: start LeaderState
2019-06-13 21:55:10,841 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - c38578f6-362c-4d77-9323-b32f4d8e0bae-RaftLogWorker: Starting segment from index:0
2019-06-13 21:55:10,849 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - c38578f6-362c-4d77-9323-b32f4d8e0bae:group-FD80C1596D53 set configuration 0: [c38578f6-362c-4d77-9323-b32f4d8e0bae:127.0.0.1:35691], old=null at 0
2019-06-13 21:55:10,906 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - c38578f6-362c-4d77-9323-b32f4d8e0bae-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfcd4db55-33a8-496c-a44a-b66afc7203c5/ratis/a1649f47-04e5-4236-84d0-fd80c1596d53/current/log_inprogress_0
2019-06-13 21:55:11,751 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 4460334818131212912 is closed with bcsId 0.
2019-06-13 21:55:11,752 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 21:55:11,756 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - c38578f6-362c-4d77-9323-b32f4d8e0bae: close
2019-06-13 21:55:11,756 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - c38578f6-362c-4d77-9323-b32f4d8e0bae: shutdown group-FD80C1596D53
2019-06-13 21:55:11,756 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-FD80C1596D53,id=c38578f6-362c-4d77-9323-b32f4d8e0bae
2019-06-13 21:55:11,756 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - c38578f6-362c-4d77-9323-b32f4d8e0bae: shutdown LeaderState
2019-06-13 21:55:11,757 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - c38578f6-362c-4d77-9323-b32f4d8e0bae-PendingRequests: sendNotLeaderResponses
2019-06-13 21:55:11,769 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-13 21:55:11,770 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfcd4db55-33a8-496c-a44a-b66afc7203c5/ratis/a1649f47-04e5-4236-84d0-fd80c1596d53/sm/snapshot.1_2
2019-06-13 21:55:11,773 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-c38578f6-362c-4d77-9323-b32f4d8e0bae-group-FD80C1596D53: set stopIndex = 2
2019-06-13 21:55:11,774 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - c38578f6-362c-4d77-9323-b32f4d8e0bae:group-FD80C1596D53 closes. The last applied log index is 2
2019-06-13 21:55:11,774 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - c38578f6-362c-4d77-9323-b32f4d8e0bae-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 21:55:11,781 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - c38578f6-362c-4d77-9323-b32f4d8e0bae-RaftLogWorker close()
2019-06-13 21:55:11,789 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - c38578f6-362c-4d77-9323-b32f4d8e0bae: shutdown server with port 35691 now
2019-06-13 21:55:11,793 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - c38578f6-362c-4d77-9323-b32f4d8e0bae: shutdown server with port 35691 successfully
2019-06-13 21:55:11,802 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 21:55:11,862 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler03b09135-685e-4b0c-a8c1-f3a7b9d90386/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 21:55:11,869 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler03b09135-685e-4b0c-a8c1-f3a7b9d90386/hdds to VolumeSet
2019-06-13 21:55:11,870 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@732c9b5c
2019-06-13 21:55:11,873 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@732c9b5c
2019-06-13 21:55:11,920 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 34187
2019-06-13 21:55:11,921 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 21:55:11,922 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 21:55:11,922 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 34187 (custom)
2019-06-13 21:55:11,922 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 21:55:11,923 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 21:55:11,923 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 21:55:11,923 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 21:55:11,924 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler03b09135-685e-4b0c-a8c1-f3a7b9d90386/ratis] (custom)
2019-06-13 21:55:11,924 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42723
2019-06-13 21:55:11,925 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 21:55:11,925 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 21:55:11,925 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a at port 34187
2019-06-13 21:55:11,980 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a: start RPC server
2019-06-13 21:55:11,982 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a: GrpcService started, listening on 0.0.0.0/0.0.0.0:34187
2019-06-13 21:55:11,991 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a: addNew group-2F95E5DF24DA:[3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a:127.0.0.1:34187] returns group-2F95E5DF24DA:java.util.concurrent.CompletableFuture@4e5e302d[Not completed]
2019-06-13 21:55:11,992 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a: new RaftServerImpl for group-2F95E5DF24DA:[3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a:127.0.0.1:34187] with ContainerStateMachine:uninitialized
2019-06-13 21:55:11,993 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 21:55:11,993 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 21:55:11,993 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 21:55:11,993 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 21:55:11,994 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a:group-2F95E5DF24DA ConfigurationManager, init=-1: [3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a:127.0.0.1:34187], old=null, confs=<EMPTY_MAP>
2019-06-13 21:55:11,994 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler03b09135-685e-4b0c-a8c1-f3a7b9d90386/ratis] (custom)
2019-06-13 21:55:11,994 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler03b09135-685e-4b0c-a8c1-f3a7b9d90386/ratis/5c2a285e-5bbe-4660-9667-2f95e5df24da does not exist. Creating ...
2019-06-13 21:55:11,997 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler03b09135-685e-4b0c-a8c1-f3a7b9d90386/ratis/5c2a285e-5bbe-4660-9667-2f95e5df24da/in_use.lock acquired by nodename 4219@ozone-mzc6g-525209162
2019-06-13 21:55:12,002 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler03b09135-685e-4b0c-a8c1-f3a7b9d90386/ratis/5c2a285e-5bbe-4660-9667-2f95e5df24da has been successfully formatted.
2019-06-13 21:55:12,003 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 21:55:12,003 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 21:55:12,003 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 21:55:12,003 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 21:55:12,003 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 21:55:12,003 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 21:55:12,003 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler03b09135-685e-4b0c-a8c1-f3a7b9d90386/ratis/5c2a285e-5bbe-4660-9667-2f95e5df24da
2019-06-13 21:55:12,004 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 21:55:12,004 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 21:55:12,005 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 21:55:12,006 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 21:55:12,006 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 21:55:12,006 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 21:55:12,006 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 21:55:12,006 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 21:55:12,006 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 21:55:12,006 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 21:55:12,007 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 21:55:12,007 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 21:55:12,007 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 21:55:12,007 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a: start group-2F95E5DF24DA
2019-06-13 21:55:12,008 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a:group-2F95E5DF24DA changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 21:55:12,008 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a: start FollowerState
2019-06-13 21:55:12,008 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-2F95E5DF24DA,id=3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a
2019-06-13 21:55:13,088 INFO  impl.FollowerState (FollowerState.java:run(101)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a:group-2F95E5DF24DA changes to CANDIDATE, lastRpcTime:1080, electionTimeout:1080ms
2019-06-13 21:55:13,088 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a: shutdown FollowerState
2019-06-13 21:55:13,089 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a:group-2F95E5DF24DA changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 21:55:13,089 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a: start LeaderElection
2019-06-13 21:55:13,092 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a:group-2F95E5DF24DA:LeaderElection5: begin an election at term 1 for -1: [3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a:127.0.0.1:34187], old=null
2019-06-13 21:55:13,093 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a: shutdown LeaderElection
2019-06-13 21:55:13,093 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a:group-2F95E5DF24DA changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 21:55:13,093 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a:group-2F95E5DF24DA change Leader from null to 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a at term 1 for becomeLeader, leader elected after 1089ms
2019-06-13 21:55:13,093 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 21:55:13,093 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 21:55:13,093 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 21:55:13,093 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 21:55:13,094 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a: start LeaderState
2019-06-13 21:55:13,094 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a-RaftLogWorker: Starting segment from index:0
2019-06-13 21:55:13,109 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a:group-2F95E5DF24DA set configuration 0: [3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a:127.0.0.1:34187], old=null at 0
2019-06-13 21:55:13,142 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler03b09135-685e-4b0c-a8c1-f3a7b9d90386/ratis/5c2a285e-5bbe-4660-9667-2f95e5df24da/current/log_inprogress_0
2019-06-13 21:55:14,099 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 8989968186630708220 is closed with bcsId 0.
2019-06-13 21:55:14,100 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 21:55:14,101 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a: close
2019-06-13 21:55:14,101 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a: shutdown group-2F95E5DF24DA
2019-06-13 21:55:14,101 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-2F95E5DF24DA,id=3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a
2019-06-13 21:55:14,101 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a: shutdown LeaderState
2019-06-13 21:55:14,102 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a-PendingRequests: sendNotLeaderResponses
2019-06-13 21:55:14,103 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a-group-2F95E5DF24DA: set stopIndex = 4
2019-06-13 21:55:14,104 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-13 21:55:14,109 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler03b09135-685e-4b0c-a8c1-f3a7b9d90386/ratis/5c2a285e-5bbe-4660-9667-2f95e5df24da/sm/snapshot.1_4
2019-06-13 21:55:14,110 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a:group-2F95E5DF24DA closes. The last applied log index is 4
2019-06-13 21:55:14,110 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 21:55:14,111 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a-RaftLogWorker close()
2019-06-13 21:55:14,112 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a: shutdown server with port 34187 now
2019-06-13 21:55:14,115 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 3e88760a-a7d2-4b8f-b1d7-dbc2a1462e6a: shutdown server with port 34187 successfully
2019-06-13 21:55:14,122 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
