2019-06-13 13:35:32,056 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-13 13:35:32,140 INFO  ozone.RatisTestHelper (RatisTestHelper.java:initRatisConf(109)) - dfs.container.ratis.rpc.type = GRPC
2019-06-13 13:35:32,185 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 13:35:32,193 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 34301 (custom)
2019-06-13 13:35:32,194 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 13:35:32,195 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 13:35:32,196 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 13:35:32,197 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 13:35:32,237 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/03aa8498-14e4-4d02-94d5-5c047a89a8d4] (custom)
2019-06-13 13:35:32,241 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 03aa8498-14e4-4d02-94d5-5c047a89a8d4 at port 34301
2019-06-13 13:35:32,256 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4: start RPC server
2019-06-13 13:35:32,257 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4: GrpcService started, listening on 0.0.0.0/0.0.0.0:34301
2019-06-13 13:35:32,335 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4: addNew group-BAF59CCC9AEE:[03aa8498-14e4-4d02-94d5-5c047a89a8d4:0.0.0.0:34301] returns group-BAF59CCC9AEE:java.util.concurrent.CompletableFuture@11df68c7[Not completed]
2019-06-13 13:35:32,340 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4: new RaftServerImpl for group-BAF59CCC9AEE:[03aa8498-14e4-4d02-94d5-5c047a89a8d4:0.0.0.0:34301] with ContainerStateMachine:uninitialized
2019-06-13 13:35:32,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 13:35:32,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 13:35:32,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 13:35:32,343 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 13:35:32,348 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4:group-BAF59CCC9AEE ConfigurationManager, init=-1: [03aa8498-14e4-4d02-94d5-5c047a89a8d4:0.0.0.0:34301], old=null, confs=<EMPTY_MAP>
2019-06-13 13:35:32,348 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/03aa8498-14e4-4d02-94d5-5c047a89a8d4] (custom)
2019-06-13 13:35:32,354 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/03aa8498-14e4-4d02-94d5-5c047a89a8d4/e0cb7ed7-aa20-46aa-a590-baf59ccc9aee does not exist. Creating ...
2019-06-13 13:35:32,364 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/03aa8498-14e4-4d02-94d5-5c047a89a8d4/e0cb7ed7-aa20-46aa-a590-baf59ccc9aee/in_use.lock acquired by nodename 3179@ozone-zq879-1582033226
2019-06-13 13:35:32,371 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/03aa8498-14e4-4d02-94d5-5c047a89a8d4/e0cb7ed7-aa20-46aa-a590-baf59ccc9aee has been successfully formatted.
2019-06-13 13:35:32,372 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 13:35:32,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 13:35:32,374 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 13:35:32,375 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 13:35:32,378 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 13:35:32,380 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 13:35:32,382 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 03aa8498-14e4-4d02-94d5-5c047a89a8d4-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/03aa8498-14e4-4d02-94d5-5c047a89a8d4/e0cb7ed7-aa20-46aa-a590-baf59ccc9aee
2019-06-13 13:35:32,383 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 13:35:32,383 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 13:35:32,384 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 13:35:32,385 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 13:35:32,385 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 13:35:32,386 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 13:35:32,386 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 13:35:32,387 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 13:35:32,387 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 13:35:32,389 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 13:35:32,393 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 13:35:32,394 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 13:35:32,394 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 13:35:32,407 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4: start group-BAF59CCC9AEE
2019-06-13 13:35:32,408 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4:group-BAF59CCC9AEE changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 13:35:32,408 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4: start FollowerState
2019-06-13 13:35:32,445 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-BAF59CCC9AEE,id=03aa8498-14e4-4d02-94d5-5c047a89a8d4
2019-06-13 13:35:32,499 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-9EC6E56BCE67->03aa8498-14e4-4d02-94d5-5c047a89a8d4: receive RaftClientReply:client-9EC6E56BCE67->03aa8498-14e4-4d02-94d5-5c047a89a8d4@group-BAF59CCC9AEE, cid=1, FAILED org.apache.ratis.protocol.NotLeaderException: Server 03aa8498-14e4-4d02-94d5-5c047a89a8d4 is not the leader (null). Request must be sent to leader., logIndex=0, commits[03aa8498-14e4-4d02-94d5-5c047a89a8d4:c-1]
2019-06-13 13:35:33,506 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-9EC6E56BCE67->03aa8498-14e4-4d02-94d5-5c047a89a8d4: receive RaftClientReply:client-9EC6E56BCE67->03aa8498-14e4-4d02-94d5-5c047a89a8d4@group-BAF59CCC9AEE, cid=1, FAILED org.apache.ratis.protocol.NotLeaderException: Server 03aa8498-14e4-4d02-94d5-5c047a89a8d4 is not the leader (null). Request must be sent to leader., logIndex=0, commits[03aa8498-14e4-4d02-94d5-5c047a89a8d4:c-1]
2019-06-13 13:35:33,509 INFO  impl.FollowerState (FollowerState.java:run(101)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4:group-BAF59CCC9AEE changes to CANDIDATE, lastRpcTime:1100, electionTimeout:1100ms
2019-06-13 13:35:33,509 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4: shutdown FollowerState
2019-06-13 13:35:33,509 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4:group-BAF59CCC9AEE changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 13:35:33,510 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4: start LeaderElection
2019-06-13 13:35:33,514 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4:group-BAF59CCC9AEE:LeaderElection1: begin an election at term 1 for -1: [03aa8498-14e4-4d02-94d5-5c047a89a8d4:0.0.0.0:34301], old=null
2019-06-13 13:35:33,514 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4: shutdown LeaderElection
2019-06-13 13:35:33,515 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4:group-BAF59CCC9AEE changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 13:35:33,515 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4:group-BAF59CCC9AEE change Leader from null to 03aa8498-14e4-4d02-94d5-5c047a89a8d4 at term 1 for becomeLeader, leader elected after 1142ms
2019-06-13 13:35:33,518 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 13:35:33,519 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 13:35:33,520 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 13:35:33,521 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 13:35:33,527 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4: start LeaderState
2019-06-13 13:35:33,541 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4-RaftLogWorker: Starting segment from index:0
2019-06-13 13:35:33,547 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4:group-BAF59CCC9AEE set configuration 0: [03aa8498-14e4-4d02-94d5-5c047a89a8d4:0.0.0.0:34301], old=null at 0
2019-06-13 13:35:33,671 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/03aa8498-14e4-4d02-94d5-5c047a89a8d4/e0cb7ed7-aa20-46aa-a590-baf59ccc9aee/current/log_inprogress_0
2019-06-13 13:35:34,522 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-13 13:35:34,526 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-9EC6E56BCE67->03aa8498-14e4-4d02-94d5-5c047a89a8d4: receive RaftClientReply:client-9EC6E56BCE67->03aa8498-14e4-4d02-94d5-5c047a89a8d4@group-BAF59CCC9AEE, cid=1, SUCCESS, logIndex=1, commits[03aa8498-14e4-4d02-94d5-5c047a89a8d4:c2]
2019-06-13 13:35:34,528 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-13 13:35:34,540 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-0B5C27C350C7->03aa8498-14e4-4d02-94d5-5c047a89a8d4: receive RaftClientReply:client-0B5C27C350C7->03aa8498-14e4-4d02-94d5-5c047a89a8d4@group-BAF59CCC9AEE, cid=2, SUCCESS, logIndex=3, commits[03aa8498-14e4-4d02-94d5-5c047a89a8d4:c3]
2019-06-13 13:35:34,544 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4: close
2019-06-13 13:35:34,545 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4: shutdown group-BAF59CCC9AEE
2019-06-13 13:35:34,546 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-BAF59CCC9AEE,id=03aa8498-14e4-4d02-94d5-5c047a89a8d4
2019-06-13 13:35:34,546 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4: shutdown LeaderState
2019-06-13 13:35:34,547 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4-PendingRequests: sendNotLeaderResponses
2019-06-13 13:35:34,547 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 13:35:34,548 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 13:35:34,549 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-03aa8498-14e4-4d02-94d5-5c047a89a8d4-group-BAF59CCC9AEE: set stopIndex = 4
2019-06-13 13:35:34,549 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-13 13:35:34,550 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/03aa8498-14e4-4d02-94d5-5c047a89a8d4/e0cb7ed7-aa20-46aa-a590-baf59ccc9aee/sm/snapshot.1_3
2019-06-13 13:35:34,556 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4:group-BAF59CCC9AEE closes. The last applied log index is 4
2019-06-13 13:35:34,557 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 13:35:34,557 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4-RaftLogWorker close()
2019-06-13 13:35:34,558 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4: shutdown server with port 34301 now
2019-06-13 13:35:34,560 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 03aa8498-14e4-4d02-94d5-5c047a89a8d4: shutdown server with port 34301 successfully
2019-06-13 13:35:34,562 INFO  ozone.RatisTestHelper (RatisTestHelper.java:initRatisConf(109)) - dfs.container.ratis.rpc.type = GRPC
2019-06-13 13:35:34,564 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 13:35:34,564 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 44985 (custom)
2019-06-13 13:35:34,580 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 13:35:34,581 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 13:35:34,581 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 13:35:34,581 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 13:35:34,582 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee] (custom)
2019-06-13 13:35:34,582 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee at port 44985
2019-06-13 13:35:34,597 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee: start RPC server
2019-06-13 13:35:34,599 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee: GrpcService started, listening on 0.0.0.0/0.0.0.0:44985
Jun 13, 2019 1:35:34 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=17, target=0.0.0.0:34301} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:130)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 13, 2019 1:35:34 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=9, target=0.0.0.0:33169} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connectToDatanode(XceiverClientGrpc.java:163)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connect(XceiverClientGrpc.java:120)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:227)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServer(TestSecureContainerServer.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-13 13:35:34,629 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee: addNew group-26518669D8AE:[ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:0.0.0.0:44985, 6274f9f4-e64f-4437-b16a-920297e02d23:0.0.0.0:46017, 18dc598e-3535-40bd-bf4f-1a1d8f113870:0.0.0.0:41339] returns group-26518669D8AE:java.util.concurrent.CompletableFuture@4ce1b0d7[Not completed]
2019-06-13 13:35:34,630 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee: new RaftServerImpl for group-26518669D8AE:[ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:0.0.0.0:44985, 6274f9f4-e64f-4437-b16a-920297e02d23:0.0.0.0:46017, 18dc598e-3535-40bd-bf4f-1a1d8f113870:0.0.0.0:41339] with ContainerStateMachine:uninitialized
2019-06-13 13:35:34,631 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 13:35:34,631 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 13:35:34,631 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 13:35:34,631 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 13:35:34,631 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:group-26518669D8AE ConfigurationManager, init=-1: [ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:0.0.0.0:44985, 6274f9f4-e64f-4437-b16a-920297e02d23:0.0.0.0:46017, 18dc598e-3535-40bd-bf4f-1a1d8f113870:0.0.0.0:41339], old=null, confs=<EMPTY_MAP>
2019-06-13 13:35:34,631 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee] (custom)
2019-06-13 13:35:34,632 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee/4bf1582a-802c-4866-9fc7-26518669d8ae does not exist. Creating ...
2019-06-13 13:35:34,634 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee/4bf1582a-802c-4866-9fc7-26518669d8ae/in_use.lock acquired by nodename 3179@ozone-zq879-1582033226
2019-06-13 13:35:34,636 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee/4bf1582a-802c-4866-9fc7-26518669d8ae has been successfully formatted.
2019-06-13 13:35:34,636 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 13:35:34,636 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 13:35:34,637 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 13:35:34,637 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 13:35:34,637 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 13:35:34,637 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 13:35:34,637 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee/4bf1582a-802c-4866-9fc7-26518669d8ae
2019-06-13 13:35:34,637 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 13:35:34,637 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 13:35:34,637 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 13:35:34,637 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 13:35:34,638 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 13:35:34,638 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 13:35:34,638 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 13:35:34,638 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 13:35:34,638 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 13:35:34,638 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 13:35:34,639 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 13:35:34,639 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 13:35:34,639 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 13:35:34,639 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee: start group-26518669D8AE
2019-06-13 13:35:34,639 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:group-26518669D8AE changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 13:35:34,639 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee: start FollowerState
2019-06-13 13:35:34,640 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-26518669D8AE,id=ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee
2019-06-13 13:35:34,644 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 13:35:34,644 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 41339 (custom)
2019-06-13 13:35:34,644 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 13:35:34,644 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 13:35:34,644 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 13:35:34,645 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 13:35:34,645 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/18dc598e-3535-40bd-bf4f-1a1d8f113870] (custom)
2019-06-13 13:35:34,645 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 18dc598e-3535-40bd-bf4f-1a1d8f113870 at port 41339
2019-06-13 13:35:34,656 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870: start RPC server
2019-06-13 13:35:34,658 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870: GrpcService started, listening on 0.0.0.0/0.0.0.0:41339
2019-06-13 13:35:34,681 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870: addNew group-26518669D8AE:[ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:0.0.0.0:44985, 6274f9f4-e64f-4437-b16a-920297e02d23:0.0.0.0:46017, 18dc598e-3535-40bd-bf4f-1a1d8f113870:0.0.0.0:41339] returns group-26518669D8AE:java.util.concurrent.CompletableFuture@38202afb[Not completed]
2019-06-13 13:35:34,682 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870: new RaftServerImpl for group-26518669D8AE:[ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:0.0.0.0:44985, 6274f9f4-e64f-4437-b16a-920297e02d23:0.0.0.0:46017, 18dc598e-3535-40bd-bf4f-1a1d8f113870:0.0.0.0:41339] with ContainerStateMachine:uninitialized
2019-06-13 13:35:34,682 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 13:35:34,682 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 13:35:34,682 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 13:35:34,683 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 13:35:34,683 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870:group-26518669D8AE ConfigurationManager, init=-1: [ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:0.0.0.0:44985, 6274f9f4-e64f-4437-b16a-920297e02d23:0.0.0.0:46017, 18dc598e-3535-40bd-bf4f-1a1d8f113870:0.0.0.0:41339], old=null, confs=<EMPTY_MAP>
2019-06-13 13:35:34,683 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/18dc598e-3535-40bd-bf4f-1a1d8f113870] (custom)
2019-06-13 13:35:34,683 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/18dc598e-3535-40bd-bf4f-1a1d8f113870/4bf1582a-802c-4866-9fc7-26518669d8ae does not exist. Creating ...
2019-06-13 13:35:34,685 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/18dc598e-3535-40bd-bf4f-1a1d8f113870/4bf1582a-802c-4866-9fc7-26518669d8ae/in_use.lock acquired by nodename 3179@ozone-zq879-1582033226
2019-06-13 13:35:34,687 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/18dc598e-3535-40bd-bf4f-1a1d8f113870/4bf1582a-802c-4866-9fc7-26518669d8ae has been successfully formatted.
2019-06-13 13:35:34,688 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 13:35:34,688 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 13:35:34,688 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 13:35:34,688 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 13:35:34,688 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 13:35:34,688 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 13:35:34,689 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 18dc598e-3535-40bd-bf4f-1a1d8f113870-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/18dc598e-3535-40bd-bf4f-1a1d8f113870/4bf1582a-802c-4866-9fc7-26518669d8ae
2019-06-13 13:35:34,689 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 13:35:34,689 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 13:35:34,689 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 13:35:34,689 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 13:35:34,689 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 13:35:34,690 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 13:35:34,690 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 13:35:34,690 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 13:35:34,690 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 13:35:34,690 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 13:35:34,691 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 13:35:34,691 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 13:35:34,691 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 13:35:34,691 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870: start group-26518669D8AE
2019-06-13 13:35:34,691 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870:group-26518669D8AE changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 13:35:34,692 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870: start FollowerState
2019-06-13 13:35:34,692 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-26518669D8AE,id=18dc598e-3535-40bd-bf4f-1a1d8f113870
2019-06-13 13:35:34,696 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 13:35:34,696 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 46017 (custom)
2019-06-13 13:35:34,697 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 13:35:34,697 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 13:35:34,697 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 13:35:34,697 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 13:35:34,698 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/6274f9f4-e64f-4437-b16a-920297e02d23] (custom)
2019-06-13 13:35:34,698 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 6274f9f4-e64f-4437-b16a-920297e02d23 at port 46017
2019-06-13 13:35:34,705 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 6274f9f4-e64f-4437-b16a-920297e02d23: start RPC server
2019-06-13 13:35:34,706 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 6274f9f4-e64f-4437-b16a-920297e02d23: GrpcService started, listening on 0.0.0.0/0.0.0.0:46017
2019-06-13 13:35:34,727 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 6274f9f4-e64f-4437-b16a-920297e02d23: addNew group-26518669D8AE:[ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:0.0.0.0:44985, 6274f9f4-e64f-4437-b16a-920297e02d23:0.0.0.0:46017, 18dc598e-3535-40bd-bf4f-1a1d8f113870:0.0.0.0:41339] returns group-26518669D8AE:java.util.concurrent.CompletableFuture@109059a7[Not completed]
2019-06-13 13:35:34,727 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 6274f9f4-e64f-4437-b16a-920297e02d23: new RaftServerImpl for group-26518669D8AE:[ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:0.0.0.0:44985, 6274f9f4-e64f-4437-b16a-920297e02d23:0.0.0.0:46017, 18dc598e-3535-40bd-bf4f-1a1d8f113870:0.0.0.0:41339] with ContainerStateMachine:uninitialized
2019-06-13 13:35:34,728 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 13:35:34,728 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 13:35:34,728 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 13:35:34,729 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 13:35:34,729 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 6274f9f4-e64f-4437-b16a-920297e02d23:group-26518669D8AE ConfigurationManager, init=-1: [ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:0.0.0.0:44985, 6274f9f4-e64f-4437-b16a-920297e02d23:0.0.0.0:46017, 18dc598e-3535-40bd-bf4f-1a1d8f113870:0.0.0.0:41339], old=null, confs=<EMPTY_MAP>
2019-06-13 13:35:34,729 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/6274f9f4-e64f-4437-b16a-920297e02d23] (custom)
2019-06-13 13:35:34,729 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/6274f9f4-e64f-4437-b16a-920297e02d23/4bf1582a-802c-4866-9fc7-26518669d8ae does not exist. Creating ...
2019-06-13 13:35:34,732 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/6274f9f4-e64f-4437-b16a-920297e02d23/4bf1582a-802c-4866-9fc7-26518669d8ae/in_use.lock acquired by nodename 3179@ozone-zq879-1582033226
2019-06-13 13:35:34,734 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/6274f9f4-e64f-4437-b16a-920297e02d23/4bf1582a-802c-4866-9fc7-26518669d8ae has been successfully formatted.
2019-06-13 13:35:34,734 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 13:35:34,735 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 13:35:34,735 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 13:35:34,735 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 13:35:34,735 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 13:35:34,735 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 13:35:34,735 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 6274f9f4-e64f-4437-b16a-920297e02d23-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/6274f9f4-e64f-4437-b16a-920297e02d23/4bf1582a-802c-4866-9fc7-26518669d8ae
2019-06-13 13:35:34,736 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 13:35:34,736 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 13:35:34,736 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 13:35:34,736 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 13:35:34,736 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 13:35:34,736 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 13:35:34,736 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 13:35:34,736 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 13:35:34,737 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 13:35:34,737 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 13:35:34,737 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 13:35:34,737 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 13:35:34,738 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 13:35:34,738 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 6274f9f4-e64f-4437-b16a-920297e02d23: start group-26518669D8AE
2019-06-13 13:35:34,738 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6274f9f4-e64f-4437-b16a-920297e02d23:group-26518669D8AE changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 13:35:34,738 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6274f9f4-e64f-4437-b16a-920297e02d23: start FollowerState
2019-06-13 13:35:34,738 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-26518669D8AE,id=6274f9f4-e64f-4437-b16a-920297e02d23
2019-06-13 13:35:34,764 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-FE8B3DD3CDEC->ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee: receive RaftClientReply:client-FE8B3DD3CDEC->ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee@group-26518669D8AE, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee is not the leader (18dc598e-3535-40bd-bf4f-1a1d8f113870:0.0.0.0:41339). Request must be sent to leader., logIndex=0, commits[ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:c-1]
2019-06-13 13:35:34,768 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 13:35:35,743 INFO  impl.FollowerState (FollowerState.java:run(101)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870:group-26518669D8AE changes to CANDIDATE, lastRpcTime:1051, electionTimeout:1051ms
2019-06-13 13:35:35,744 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870: shutdown FollowerState
2019-06-13 13:35:35,744 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870:group-26518669D8AE changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 13:35:35,744 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870: start LeaderElection
2019-06-13 13:35:35,747 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870:group-26518669D8AE:LeaderElection2: begin an election at term 1 for -1: [ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:0.0.0.0:44985, 6274f9f4-e64f-4437-b16a-920297e02d23:0.0.0.0:46017, 18dc598e-3535-40bd-bf4f-1a1d8f113870:0.0.0.0:41339], old=null
2019-06-13 13:35:35,764 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6274f9f4-e64f-4437-b16a-920297e02d23:group-26518669D8AE changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:18dc598e-3535-40bd-bf4f-1a1d8f113870
2019-06-13 13:35:35,764 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:group-26518669D8AE changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:18dc598e-3535-40bd-bf4f-1a1d8f113870
2019-06-13 13:35:35,764 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee: shutdown FollowerState
2019-06-13 13:35:35,764 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee: start FollowerState
2019-06-13 13:35:35,764 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 6274f9f4-e64f-4437-b16a-920297e02d23: shutdown FollowerState
2019-06-13 13:35:35,766 INFO  impl.FollowerState (FollowerState.java:run(109)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 13:35:35,766 INFO  impl.FollowerState (FollowerState.java:run(96)) - 6274f9f4-e64f-4437-b16a-920297e02d23 heartbeat monitor quit
2019-06-13 13:35:35,766 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6274f9f4-e64f-4437-b16a-920297e02d23: start FollowerState
2019-06-13 13:35:35,775 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870:group-26518669D8AE:LeaderElection2: Election PASSED; received 1 response(s) [18dc598e-3535-40bd-bf4f-1a1d8f113870->6274f9f4-e64f-4437-b16a-920297e02d23,true-t1] and 0 exception(s); 18dc598e-3535-40bd-bf4f-1a1d8f113870:t1, leader=null, voted=18dc598e-3535-40bd-bf4f-1a1d8f113870, raftlog=18dc598e-3535-40bd-bf4f-1a1d8f113870-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:0.0.0.0:44985, 6274f9f4-e64f-4437-b16a-920297e02d23:0.0.0.0:46017, 18dc598e-3535-40bd-bf4f-1a1d8f113870:0.0.0.0:41339], old=null
2019-06-13 13:35:35,775 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870: shutdown LeaderElection
2019-06-13 13:35:35,775 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870:group-26518669D8AE changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 13:35:35,776 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-FE8B3DD3CDEC->18dc598e-3535-40bd-bf4f-1a1d8f113870: receive RaftClientReply:client-FE8B3DD3CDEC->18dc598e-3535-40bd-bf4f-1a1d8f113870@group-26518669D8AE, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server 18dc598e-3535-40bd-bf4f-1a1d8f113870 is not the leader (ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:0.0.0.0:44985). Request must be sent to leader., logIndex=0, commits[18dc598e-3535-40bd-bf4f-1a1d8f113870:c-1]
2019-06-13 13:35:35,779 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870:group-26518669D8AE change Leader from null to 18dc598e-3535-40bd-bf4f-1a1d8f113870 at term 1 for becomeLeader, leader elected after 1087ms
2019-06-13 13:35:35,779 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 13:35:35,779 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 13:35:35,780 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 13:35:35,780 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 13:35:35,782 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 13:35:35,782 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 13:35:35,783 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 13:35:35,842 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 13:35:35,845 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 13:35:35,845 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 13:35:35,846 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 13:35:35,846 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 13:35:35,846 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 13:35:35,846 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 13:35:35,846 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 13:35:35,846 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 13:35:35,847 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 13:35:35,847 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870: start LeaderState
2019-06-13 13:35:35,847 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870-RaftLogWorker: Starting segment from index:0
2019-06-13 13:35:35,848 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870:group-26518669D8AE set configuration 0: [ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:0.0.0.0:44985, 6274f9f4-e64f-4437-b16a-920297e02d23:0.0.0.0:46017, 18dc598e-3535-40bd-bf4f-1a1d8f113870:0.0.0.0:41339], old=null at 0
2019-06-13 13:35:35,889 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/18dc598e-3535-40bd-bf4f-1a1d8f113870/4bf1582a-802c-4866-9fc7-26518669d8ae/current/log_inprogress_0
2019-06-13 13:35:35,889 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:group-26518669D8AE change Leader from null to 18dc598e-3535-40bd-bf4f-1a1d8f113870 at term 1 for appendEntries, leader elected after 1252ms
2019-06-13 13:35:35,889 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 6274f9f4-e64f-4437-b16a-920297e02d23:group-26518669D8AE change Leader from null to 18dc598e-3535-40bd-bf4f-1a1d8f113870 at term 1 for appendEntries, leader elected after 1154ms
2019-06-13 13:35:35,906 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 6274f9f4-e64f-4437-b16a-920297e02d23:group-26518669D8AE set configuration 0: [ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:0.0.0.0:44985, 6274f9f4-e64f-4437-b16a-920297e02d23:0.0.0.0:46017, 18dc598e-3535-40bd-bf4f-1a1d8f113870:0.0.0.0:41339], old=null at 0
2019-06-13 13:35:35,906 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:group-26518669D8AE set configuration 0: [ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:0.0.0.0:44985, 6274f9f4-e64f-4437-b16a-920297e02d23:0.0.0.0:46017, 18dc598e-3535-40bd-bf4f-1a1d8f113870:0.0.0.0:41339], old=null at 0
2019-06-13 13:35:35,906 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 6274f9f4-e64f-4437-b16a-920297e02d23-RaftLogWorker: Starting segment from index:0
2019-06-13 13:35:35,906 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee-RaftLogWorker: Starting segment from index:0
2019-06-13 13:35:35,951 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee/4bf1582a-802c-4866-9fc7-26518669d8ae/current/log_inprogress_0
2019-06-13 13:35:35,955 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 6274f9f4-e64f-4437-b16a-920297e02d23-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/6274f9f4-e64f-4437-b16a-920297e02d23/4bf1582a-802c-4866-9fc7-26518669d8ae/current/log_inprogress_0
Jun 13, 2019 1:35:36 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=43, target=0.0.0.0:41339} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:131)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 13, 2019 1:35:36 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=51, target=0.0.0.0:46017} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:131)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 13, 2019 1:35:36 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=35, target=0.0.0.0:44985} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:131)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-13 13:35:36,796 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-FE8B3DD3CDEC->ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee: receive RaftClientReply:client-FE8B3DD3CDEC->ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee@group-26518669D8AE, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee is not the leader (18dc598e-3535-40bd-bf4f-1a1d8f113870:0.0.0.0:41339). Request must be sent to leader., logIndex=0, commits[ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:c0, 6274f9f4-e64f-4437-b16a-920297e02d23:c0, 18dc598e-3535-40bd-bf4f-1a1d8f113870:c0]
2019-06-13 13:35:36,798 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 13:35:37,808 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-13 13:35:37,811 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-13 13:35:37,813 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-13 13:35:37,814 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-FE8B3DD3CDEC->18dc598e-3535-40bd-bf4f-1a1d8f113870: receive RaftClientReply:client-FE8B3DD3CDEC->18dc598e-3535-40bd-bf4f-1a1d8f113870@group-26518669D8AE, cid=6, SUCCESS, logIndex=1, commits[18dc598e-3535-40bd-bf4f-1a1d8f113870:c1, ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:c0, 6274f9f4-e64f-4437-b16a-920297e02d23:c0]
2019-06-13 13:35:37,814 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-13 13:35:37,824 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8303A857CF9C->ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee: receive RaftClientReply:client-8303A857CF9C->ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee@group-26518669D8AE, cid=7, FAILED org.apache.ratis.protocol.NotLeaderException: Server ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee is not the leader (18dc598e-3535-40bd-bf4f-1a1d8f113870:0.0.0.0:41339). Request must be sent to leader., logIndex=0, commits[ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:c1, 6274f9f4-e64f-4437-b16a-920297e02d23:c0, 18dc598e-3535-40bd-bf4f-1a1d8f113870:c1]
2019-06-13 13:35:37,826 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 2-OrderedRequestStreamObserver2: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 13:35:38,846 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8303A857CF9C->18dc598e-3535-40bd-bf4f-1a1d8f113870: receive RaftClientReply:client-8303A857CF9C->18dc598e-3535-40bd-bf4f-1a1d8f113870@group-26518669D8AE, cid=7, SUCCESS, logIndex=3, commits[18dc598e-3535-40bd-bf4f-1a1d8f113870:c3, ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:c2, 6274f9f4-e64f-4437-b16a-920297e02d23:c2]
2019-06-13 13:35:38,849 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee: close
2019-06-13 13:35:38,850 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee: shutdown group-26518669D8AE
2019-06-13 13:35:38,850 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-26518669D8AE,id=ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee
2019-06-13 13:35:38,850 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee: shutdown FollowerState
2019-06-13 13:35:38,851 INFO  impl.FollowerState (FollowerState.java:run(109)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 13:35:38,851 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-13 13:35:38,851 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee/4bf1582a-802c-4866-9fc7-26518669d8ae/sm/snapshot.1_3
2019-06-13 13:35:38,851 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee-group-26518669D8AE: set stopIndex = 3
2019-06-13 13:35:38,851 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:group-26518669D8AE closes. The last applied log index is 3
2019-06-13 13:35:38,852 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 13:35:38,853 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee-RaftLogWorker close()
2019-06-13 13:35:38,853 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee: shutdown server with port 44985 now
2019-06-13 13:35:38,854 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 13:35:38,854 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee: shutdown server with port 44985 successfully
2019-06-13 13:35:38,855 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870: Failed appendEntries to ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee:0.0.0.0:44985: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-13 13:35:38,856 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870->ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee: nextIndex: updateUnconditionally 5 -> 0
2019-06-13 13:35:38,857 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870: close
2019-06-13 13:35:38,857 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870: shutdown group-26518669D8AE
2019-06-13 13:35:38,858 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-26518669D8AE,id=18dc598e-3535-40bd-bf4f-1a1d8f113870
2019-06-13 13:35:38,858 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870: shutdown LeaderState
2019-06-13 13:35:38,858 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(18dc598e-3535-40bd-bf4f-1a1d8f113870 -> ee439a6e-4dcf-47c2-afaa-3de8ed3b46ee): Wait interrupted by java.lang.InterruptedException
2019-06-13 13:35:38,859 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870-PendingRequests: sendNotLeaderResponses
2019-06-13 13:35:38,858 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(18dc598e-3535-40bd-bf4f-1a1d8f113870 -> 6274f9f4-e64f-4437-b16a-920297e02d23): Wait interrupted by java.lang.InterruptedException
2019-06-13 13:35:38,861 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 6274f9f4-e64f-4437-b16a-920297e02d23: appendEntries completed
2019-06-13 13:35:38,862 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-18dc598e-3535-40bd-bf4f-1a1d8f113870-group-26518669D8AE: set stopIndex = 4
2019-06-13 13:35:38,862 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-13 13:35:38,863 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/18dc598e-3535-40bd-bf4f-1a1d8f113870/4bf1582a-802c-4866-9fc7-26518669d8ae/sm/snapshot.1_3
2019-06-13 13:35:38,863 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870:group-26518669D8AE closes. The last applied log index is 4
2019-06-13 13:35:38,864 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870: follower 18dc598e-3535-40bd-bf4f-1a1d8f113870->6274f9f4-e64f-4437-b16a-920297e02d23(c3,m4,n5, attendVote=true, lastRpcSendTime=22, lastRpcResponseTime=15) response Completed
2019-06-13 13:35:38,864 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 13:35:38,864 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870->6274f9f4-e64f-4437-b16a-920297e02d23: nextIndex: updateUnconditionally 5 -> -1
2019-06-13 13:35:38,865 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870-RaftLogWorker close()
2019-06-13 13:35:38,865 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870: shutdown server with port 41339 now
2019-06-13 13:35:38,867 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 18dc598e-3535-40bd-bf4f-1a1d8f113870: shutdown server with port 41339 successfully
2019-06-13 13:35:38,869 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 6274f9f4-e64f-4437-b16a-920297e02d23: close
2019-06-13 13:35:38,870 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 6274f9f4-e64f-4437-b16a-920297e02d23: shutdown group-26518669D8AE
2019-06-13 13:35:38,871 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-26518669D8AE,id=6274f9f4-e64f-4437-b16a-920297e02d23
2019-06-13 13:35:38,871 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 6274f9f4-e64f-4437-b16a-920297e02d23: shutdown FollowerState
2019-06-13 13:35:38,871 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-6274f9f4-e64f-4437-b16a-920297e02d23-group-26518669D8AE: set stopIndex = 3
2019-06-13 13:35:38,871 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-13 13:35:38,872 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/6274f9f4-e64f-4437-b16a-920297e02d23/4bf1582a-802c-4866-9fc7-26518669d8ae/sm/snapshot.1_3
2019-06-13 13:35:38,872 INFO  impl.FollowerState (FollowerState.java:run(109)) - 6274f9f4-e64f-4437-b16a-920297e02d23: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 13:35:38,874 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 6274f9f4-e64f-4437-b16a-920297e02d23:group-26518669D8AE closes. The last applied log index is 3
2019-06-13 13:35:38,875 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 6274f9f4-e64f-4437-b16a-920297e02d23-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 13:35:38,875 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 6274f9f4-e64f-4437-b16a-920297e02d23-RaftLogWorker close()
2019-06-13 13:35:38,876 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 6274f9f4-e64f-4437-b16a-920297e02d23: shutdown server with port 46017 now
2019-06-13 13:35:38,876 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 6274f9f4-e64f-4437-b16a-920297e02d23: shutdown server with port 46017 successfully
