2019-06-14 10:20:23,163 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4aa2431a-d282-4a46-ba42-f09bf1937672/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:20:23,167 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4aa2431a-d282-4a46-ba42-f09bf1937672/hdds to VolumeSet
2019-06-14 10:20:23,177 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-14 10:20:23,212 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-14 10:20:24,321 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 33169
2019-06-14 10:20:24,790 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 10:20:24,815 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:20:24,825 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 33169 (custom)
2019-06-14 10:20:24,826 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:20:24,828 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:20:24,829 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:20:24,830 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:20:24,992 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4aa2431a-d282-4a46-ba42-f09bf1937672/ratis] (custom)
2019-06-14 10:20:25,004 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42965
2019-06-14 10:20:25,030 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:20:25,031 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:20:25,032 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 2e835561-ad72-4d31-82cd-bfb14ec3ef36 at port 33169
2019-06-14 10:20:25,089 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36: start RPC server
2019-06-14 10:20:25,265 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36: GrpcService started, listening on 0.0.0.0/0.0.0.0:33169
2019-06-14 10:20:25,638 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36: addNew group-57CBB9AD588E:[2e835561-ad72-4d31-82cd-bfb14ec3ef36:127.0.0.1:33169] returns group-57CBB9AD588E:java.util.concurrent.CompletableFuture@3fc33b87[Not completed]
2019-06-14 10:20:25,672 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36: new RaftServerImpl for group-57CBB9AD588E:[2e835561-ad72-4d31-82cd-bfb14ec3ef36:127.0.0.1:33169] with ContainerStateMachine:uninitialized
2019-06-14 10:20:25,674 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:20:25,674 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:20:25,674 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:20:25,675 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:20:25,681 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36:group-57CBB9AD588E ConfigurationManager, init=-1: [2e835561-ad72-4d31-82cd-bfb14ec3ef36:127.0.0.1:33169], old=null, confs=<EMPTY_MAP>
2019-06-14 10:20:25,681 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4aa2431a-d282-4a46-ba42-f09bf1937672/ratis] (custom)
2019-06-14 10:20:25,688 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4aa2431a-d282-4a46-ba42-f09bf1937672/ratis/27885558-8e75-45c1-b6f3-57cbb9ad588e does not exist. Creating ...
2019-06-14 10:20:25,704 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4aa2431a-d282-4a46-ba42-f09bf1937672/ratis/27885558-8e75-45c1-b6f3-57cbb9ad588e/in_use.lock acquired by nodename 4179@ozone-cf6ld-331198676
2019-06-14 10:20:25,713 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4aa2431a-d282-4a46-ba42-f09bf1937672/ratis/27885558-8e75-45c1-b6f3-57cbb9ad588e has been successfully formatted.
2019-06-14 10:20:25,716 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:20:25,716 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:20:25,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:20:25,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:20:25,723 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:20:25,727 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:20:25,730 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 2e835561-ad72-4d31-82cd-bfb14ec3ef36-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4aa2431a-d282-4a46-ba42-f09bf1937672/ratis/27885558-8e75-45c1-b6f3-57cbb9ad588e
2019-06-14 10:20:25,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:20:25,731 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:20:25,733 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:20:25,733 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:20:25,734 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:20:25,734 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:20:25,735 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:20:25,735 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:20:25,736 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:20:25,738 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:20:25,743 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:20:25,744 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:20:25,745 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:20:25,854 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36: start group-57CBB9AD588E
2019-06-14 10:20:25,855 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36:group-57CBB9AD588E changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:20:25,856 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36: start FollowerState
2019-06-14 10:20:25,858 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-57CBB9AD588E,id=2e835561-ad72-4d31-82cd-bfb14ec3ef36
2019-06-14 10:20:26,954 INFO  impl.FollowerState (FollowerState.java:run(101)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36:group-57CBB9AD588E changes to CANDIDATE, lastRpcTime:1098, electionTimeout:1097ms
2019-06-14 10:20:26,954 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36: shutdown FollowerState
2019-06-14 10:20:26,954 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36:group-57CBB9AD588E changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:20:26,956 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36: start LeaderElection
2019-06-14 10:20:27,030 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36:group-57CBB9AD588E:LeaderElection1: begin an election at term 1 for -1: [2e835561-ad72-4d31-82cd-bfb14ec3ef36:127.0.0.1:33169], old=null
2019-06-14 10:20:27,031 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36: shutdown LeaderElection
2019-06-14 10:20:27,032 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36:group-57CBB9AD588E changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:20:27,032 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36:group-57CBB9AD588E change Leader from null to 2e835561-ad72-4d31-82cd-bfb14ec3ef36 at term 1 for becomeLeader, leader elected after 1316ms
2019-06-14 10:20:27,035 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:20:27,036 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:20:27,037 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:20:27,038 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:20:27,045 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36: start LeaderState
2019-06-14 10:20:27,057 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36-RaftLogWorker: Starting segment from index:0
2019-06-14 10:20:27,066 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36:group-57CBB9AD588E set configuration 0: [2e835561-ad72-4d31-82cd-bfb14ec3ef36:127.0.0.1:33169], old=null at 0
2019-06-14 10:20:27,225 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4aa2431a-d282-4a46-ba42-f09bf1937672/ratis/27885558-8e75-45c1-b6f3-57cbb9ad588e/current/log_inprogress_0
2019-06-14 10:20:28,345 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-14 10:20:28,411 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 140333589735507809 is closed with bcsId 0.
2019-06-14 10:20:28,411 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:20:28,412 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36: close
2019-06-14 10:20:28,414 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36: shutdown group-57CBB9AD588E
2019-06-14 10:20:28,414 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-57CBB9AD588E,id=2e835561-ad72-4d31-82cd-bfb14ec3ef36
2019-06-14 10:20:28,414 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36: shutdown LeaderState
2019-06-14 10:20:28,415 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36-PendingRequests: sendNotLeaderResponses
2019-06-14 10:20:28,417 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-2e835561-ad72-4d31-82cd-bfb14ec3ef36-group-57CBB9AD588E: set stopIndex = 4
2019-06-14 10:20:28,417 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-14 10:20:28,418 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4aa2431a-d282-4a46-ba42-f09bf1937672/ratis/27885558-8e75-45c1-b6f3-57cbb9ad588e/sm/snapshot.1_4
2019-06-14 10:20:28,425 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36:group-57CBB9AD588E closes. The last applied log index is 4
2019-06-14 10:20:28,426 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:20:28,427 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36-RaftLogWorker close()
2019-06-14 10:20:28,429 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36: shutdown server with port 33169 now
2019-06-14 10:20:28,432 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 2e835561-ad72-4d31-82cd-bfb14ec3ef36: shutdown server with port 33169 successfully
2019-06-14 10:20:28,442 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:20:28,480 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler270275b3-e88f-4c24-a1e6-11e6eae9b7f1/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:20:28,481 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler270275b3-e88f-4c24-a1e6-11e6eae9b7f1/hdds to VolumeSet
2019-06-14 10:20:28,481 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@6f7e336b
2019-06-14 10:20:28,485 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@6f7e336b
2019-06-14 10:20:28,499 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 41717
2019-06-14 10:20:28,500 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 10:20:28,500 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:20:28,501 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 41717 (custom)
2019-06-14 10:20:28,501 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:20:28,501 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:20:28,501 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:20:28,502 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:20:28,503 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler270275b3-e88f-4c24-a1e6-11e6eae9b7f1/ratis] (custom)
2019-06-14 10:20:28,503 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 34489
2019-06-14 10:20:28,504 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:20:28,504 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:20:28,504 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 032020c3-0b7e-47a6-9410-db8bebb0a789 at port 41717
2019-06-14 10:20:28,521 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 032020c3-0b7e-47a6-9410-db8bebb0a789: start RPC server
2019-06-14 10:20:28,522 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 032020c3-0b7e-47a6-9410-db8bebb0a789: GrpcService started, listening on 0.0.0.0/0.0.0.0:41717
2019-06-14 10:20:28,535 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 032020c3-0b7e-47a6-9410-db8bebb0a789: addNew group-26594220B6B6:[032020c3-0b7e-47a6-9410-db8bebb0a789:127.0.0.1:41717] returns group-26594220B6B6:java.util.concurrent.CompletableFuture@259934e6[Not completed]
2019-06-14 10:20:28,539 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 032020c3-0b7e-47a6-9410-db8bebb0a789: new RaftServerImpl for group-26594220B6B6:[032020c3-0b7e-47a6-9410-db8bebb0a789:127.0.0.1:41717] with ContainerStateMachine:uninitialized
2019-06-14 10:20:28,539 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:20:28,539 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:20:28,539 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:20:28,540 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:20:28,540 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 032020c3-0b7e-47a6-9410-db8bebb0a789:group-26594220B6B6 ConfigurationManager, init=-1: [032020c3-0b7e-47a6-9410-db8bebb0a789:127.0.0.1:41717], old=null, confs=<EMPTY_MAP>
2019-06-14 10:20:28,540 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler270275b3-e88f-4c24-a1e6-11e6eae9b7f1/ratis] (custom)
2019-06-14 10:20:28,540 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler270275b3-e88f-4c24-a1e6-11e6eae9b7f1/ratis/61cbfe78-c098-442e-a9fc-26594220b6b6 does not exist. Creating ...
2019-06-14 10:20:28,547 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler270275b3-e88f-4c24-a1e6-11e6eae9b7f1/ratis/61cbfe78-c098-442e-a9fc-26594220b6b6/in_use.lock acquired by nodename 4179@ozone-cf6ld-331198676
2019-06-14 10:20:28,550 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler270275b3-e88f-4c24-a1e6-11e6eae9b7f1/ratis/61cbfe78-c098-442e-a9fc-26594220b6b6 has been successfully formatted.
2019-06-14 10:20:28,550 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:20:28,550 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:20:28,550 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:20:28,550 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:20:28,550 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:20:28,550 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:20:28,551 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 032020c3-0b7e-47a6-9410-db8bebb0a789-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler270275b3-e88f-4c24-a1e6-11e6eae9b7f1/ratis/61cbfe78-c098-442e-a9fc-26594220b6b6
2019-06-14 10:20:28,555 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:20:28,555 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:20:28,555 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:20:28,555 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:20:28,555 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:20:28,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:20:28,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:20:28,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:20:28,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:20:28,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:20:28,559 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:20:28,563 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:20:28,563 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:20:28,563 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 032020c3-0b7e-47a6-9410-db8bebb0a789: start group-26594220B6B6
2019-06-14 10:20:28,563 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 032020c3-0b7e-47a6-9410-db8bebb0a789:group-26594220B6B6 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:20:28,563 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 032020c3-0b7e-47a6-9410-db8bebb0a789: start FollowerState
2019-06-14 10:20:28,565 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-26594220B6B6,id=032020c3-0b7e-47a6-9410-db8bebb0a789
2019-06-14 10:20:29,710 INFO  impl.FollowerState (FollowerState.java:run(101)) - 032020c3-0b7e-47a6-9410-db8bebb0a789:group-26594220B6B6 changes to CANDIDATE, lastRpcTime:1146, electionTimeout:1145ms
2019-06-14 10:20:29,711 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 032020c3-0b7e-47a6-9410-db8bebb0a789: shutdown FollowerState
2019-06-14 10:20:29,711 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 032020c3-0b7e-47a6-9410-db8bebb0a789:group-26594220B6B6 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:20:29,711 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 032020c3-0b7e-47a6-9410-db8bebb0a789: start LeaderElection
2019-06-14 10:20:30,110 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 032020c3-0b7e-47a6-9410-db8bebb0a789:group-26594220B6B6:LeaderElection2: begin an election at term 1 for -1: [032020c3-0b7e-47a6-9410-db8bebb0a789:127.0.0.1:41717], old=null
2019-06-14 10:20:30,110 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 032020c3-0b7e-47a6-9410-db8bebb0a789: shutdown LeaderElection
2019-06-14 10:20:30,110 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 032020c3-0b7e-47a6-9410-db8bebb0a789:group-26594220B6B6 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:20:30,110 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 032020c3-0b7e-47a6-9410-db8bebb0a789:group-26594220B6B6 change Leader from null to 032020c3-0b7e-47a6-9410-db8bebb0a789 at term 1 for becomeLeader, leader elected after 1560ms
2019-06-14 10:20:30,111 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:20:30,111 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:20:30,111 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:20:30,111 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:20:30,111 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 032020c3-0b7e-47a6-9410-db8bebb0a789: start LeaderState
2019-06-14 10:20:30,112 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 032020c3-0b7e-47a6-9410-db8bebb0a789-RaftLogWorker: Starting segment from index:0
2019-06-14 10:20:30,116 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 032020c3-0b7e-47a6-9410-db8bebb0a789:group-26594220B6B6 set configuration 0: [032020c3-0b7e-47a6-9410-db8bebb0a789:127.0.0.1:41717], old=null at 0
2019-06-14 10:20:30,151 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 032020c3-0b7e-47a6-9410-db8bebb0a789-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler270275b3-e88f-4c24-a1e6-11e6eae9b7f1/ratis/61cbfe78-c098-442e-a9fc-26594220b6b6/current/log_inprogress_0
2019-06-14 10:20:30,625 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:20:30,631 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 032020c3-0b7e-47a6-9410-db8bebb0a789: close
2019-06-14 10:20:30,631 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 032020c3-0b7e-47a6-9410-db8bebb0a789: shutdown group-26594220B6B6
2019-06-14 10:20:30,631 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-26594220B6B6,id=032020c3-0b7e-47a6-9410-db8bebb0a789
2019-06-14 10:20:30,632 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 032020c3-0b7e-47a6-9410-db8bebb0a789: shutdown LeaderState
2019-06-14 10:20:30,632 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 032020c3-0b7e-47a6-9410-db8bebb0a789-PendingRequests: sendNotLeaderResponses
2019-06-14 10:20:30,633 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-032020c3-0b7e-47a6-9410-db8bebb0a789-group-26594220B6B6: set stopIndex = 2
2019-06-14 10:20:30,633 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-14 10:20:30,633 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler270275b3-e88f-4c24-a1e6-11e6eae9b7f1/ratis/61cbfe78-c098-442e-a9fc-26594220b6b6/sm/snapshot.1_2
2019-06-14 10:20:30,633 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 032020c3-0b7e-47a6-9410-db8bebb0a789:group-26594220B6B6 closes. The last applied log index is 2
2019-06-14 10:20:30,634 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 032020c3-0b7e-47a6-9410-db8bebb0a789-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:20:30,634 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 032020c3-0b7e-47a6-9410-db8bebb0a789-RaftLogWorker close()
2019-06-14 10:20:30,635 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 032020c3-0b7e-47a6-9410-db8bebb0a789: shutdown server with port 41717 now
2019-06-14 10:20:30,636 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 032020c3-0b7e-47a6-9410-db8bebb0a789: shutdown server with port 41717 successfully
2019-06-14 10:20:30,638 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:20:30,667 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2df3f25c-6574-4dc0-b1b9-298fdc6fed71/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:20:30,667 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2df3f25c-6574-4dc0-b1b9-298fdc6fed71/hdds to VolumeSet
2019-06-14 10:20:30,667 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@26a2f7f9
2019-06-14 10:20:30,668 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@26a2f7f9
2019-06-14 10:20:30,680 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 45041
2019-06-14 10:20:30,681 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 10:20:30,682 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:20:30,682 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 45041 (custom)
2019-06-14 10:20:30,682 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:20:30,683 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:20:30,683 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:20:30,683 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:20:30,684 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2df3f25c-6574-4dc0-b1b9-298fdc6fed71/ratis] (custom)
2019-06-14 10:20:30,684 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 37281
2019-06-14 10:20:30,684 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:20:30,685 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:20:30,685 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis bd545786-ae28-4039-9939-51484a7fc628 at port 45041
2019-06-14 10:20:30,707 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - bd545786-ae28-4039-9939-51484a7fc628: start RPC server
2019-06-14 10:20:30,708 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - bd545786-ae28-4039-9939-51484a7fc628: GrpcService started, listening on 0.0.0.0/0.0.0.0:45041
2019-06-14 10:20:30,718 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - bd545786-ae28-4039-9939-51484a7fc628: addNew group-DE0F05D71F49:[bd545786-ae28-4039-9939-51484a7fc628:127.0.0.1:45041] returns group-DE0F05D71F49:java.util.concurrent.CompletableFuture@6cc9a80d[Not completed]
2019-06-14 10:20:30,719 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - bd545786-ae28-4039-9939-51484a7fc628: new RaftServerImpl for group-DE0F05D71F49:[bd545786-ae28-4039-9939-51484a7fc628:127.0.0.1:45041] with ContainerStateMachine:uninitialized
2019-06-14 10:20:30,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:20:30,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:20:30,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:20:30,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:20:30,720 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - bd545786-ae28-4039-9939-51484a7fc628:group-DE0F05D71F49 ConfigurationManager, init=-1: [bd545786-ae28-4039-9939-51484a7fc628:127.0.0.1:45041], old=null, confs=<EMPTY_MAP>
2019-06-14 10:20:30,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2df3f25c-6574-4dc0-b1b9-298fdc6fed71/ratis] (custom)
2019-06-14 10:20:30,721 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2df3f25c-6574-4dc0-b1b9-298fdc6fed71/ratis/30bb910d-b02a-4615-a508-de0f05d71f49 does not exist. Creating ...
2019-06-14 10:20:30,728 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2df3f25c-6574-4dc0-b1b9-298fdc6fed71/ratis/30bb910d-b02a-4615-a508-de0f05d71f49/in_use.lock acquired by nodename 4179@ozone-cf6ld-331198676
2019-06-14 10:20:30,731 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2df3f25c-6574-4dc0-b1b9-298fdc6fed71/ratis/30bb910d-b02a-4615-a508-de0f05d71f49 has been successfully formatted.
2019-06-14 10:20:30,731 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:20:30,731 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:20:30,732 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:20:30,732 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:20:30,732 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:20:30,732 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:20:30,732 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new bd545786-ae28-4039-9939-51484a7fc628-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2df3f25c-6574-4dc0-b1b9-298fdc6fed71/ratis/30bb910d-b02a-4615-a508-de0f05d71f49
2019-06-14 10:20:30,732 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:20:30,732 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:20:30,732 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:20:30,732 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:20:30,733 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:20:30,733 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:20:30,733 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:20:30,733 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:20:30,733 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:20:30,733 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:20:30,734 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:20:30,734 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:20:30,734 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:20:30,734 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - bd545786-ae28-4039-9939-51484a7fc628: start group-DE0F05D71F49
2019-06-14 10:20:30,734 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bd545786-ae28-4039-9939-51484a7fc628:group-DE0F05D71F49 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:20:30,734 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bd545786-ae28-4039-9939-51484a7fc628: start FollowerState
2019-06-14 10:20:30,735 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-DE0F05D71F49,id=bd545786-ae28-4039-9939-51484a7fc628
2019-06-14 10:20:31,847 INFO  impl.FollowerState (FollowerState.java:run(101)) - bd545786-ae28-4039-9939-51484a7fc628:group-DE0F05D71F49 changes to CANDIDATE, lastRpcTime:1112, electionTimeout:1112ms
2019-06-14 10:20:31,847 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - bd545786-ae28-4039-9939-51484a7fc628: shutdown FollowerState
2019-06-14 10:20:31,847 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bd545786-ae28-4039-9939-51484a7fc628:group-DE0F05D71F49 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:20:31,847 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bd545786-ae28-4039-9939-51484a7fc628: start LeaderElection
2019-06-14 10:20:31,890 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - bd545786-ae28-4039-9939-51484a7fc628:group-DE0F05D71F49:LeaderElection3: begin an election at term 1 for -1: [bd545786-ae28-4039-9939-51484a7fc628:127.0.0.1:45041], old=null
2019-06-14 10:20:31,890 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - bd545786-ae28-4039-9939-51484a7fc628: shutdown LeaderElection
2019-06-14 10:20:31,891 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bd545786-ae28-4039-9939-51484a7fc628:group-DE0F05D71F49 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:20:31,891 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - bd545786-ae28-4039-9939-51484a7fc628:group-DE0F05D71F49 change Leader from null to bd545786-ae28-4039-9939-51484a7fc628 at term 1 for becomeLeader, leader elected after 1159ms
2019-06-14 10:20:31,891 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:20:31,891 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:20:31,891 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:20:31,891 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:20:31,892 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bd545786-ae28-4039-9939-51484a7fc628: start LeaderState
2019-06-14 10:20:31,892 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - bd545786-ae28-4039-9939-51484a7fc628-RaftLogWorker: Starting segment from index:0
2019-06-14 10:20:31,892 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - bd545786-ae28-4039-9939-51484a7fc628:group-DE0F05D71F49 set configuration 0: [bd545786-ae28-4039-9939-51484a7fc628:127.0.0.1:45041], old=null at 0
2019-06-14 10:20:31,942 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - bd545786-ae28-4039-9939-51484a7fc628-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2df3f25c-6574-4dc0-b1b9-298fdc6fed71/ratis/30bb910d-b02a-4615-a508-de0f05d71f49/current/log_inprogress_0
2019-06-14 10:20:32,821 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 462394771239478726 is closed with bcsId 0.
2019-06-14 10:20:32,822 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:20:32,823 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - bd545786-ae28-4039-9939-51484a7fc628: close
2019-06-14 10:20:32,823 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - bd545786-ae28-4039-9939-51484a7fc628: shutdown group-DE0F05D71F49
2019-06-14 10:20:32,823 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-DE0F05D71F49,id=bd545786-ae28-4039-9939-51484a7fc628
2019-06-14 10:20:32,824 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - bd545786-ae28-4039-9939-51484a7fc628: shutdown LeaderState
2019-06-14 10:20:32,824 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - bd545786-ae28-4039-9939-51484a7fc628-PendingRequests: sendNotLeaderResponses
2019-06-14 10:20:32,825 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-bd545786-ae28-4039-9939-51484a7fc628-group-DE0F05D71F49: set stopIndex = 2
2019-06-14 10:20:32,825 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-14 10:20:32,826 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2df3f25c-6574-4dc0-b1b9-298fdc6fed71/ratis/30bb910d-b02a-4615-a508-de0f05d71f49/sm/snapshot.1_2
2019-06-14 10:20:32,826 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - bd545786-ae28-4039-9939-51484a7fc628:group-DE0F05D71F49 closes. The last applied log index is 2
2019-06-14 10:20:32,827 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - bd545786-ae28-4039-9939-51484a7fc628-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:20:32,828 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - bd545786-ae28-4039-9939-51484a7fc628-RaftLogWorker close()
2019-06-14 10:20:32,830 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - bd545786-ae28-4039-9939-51484a7fc628: shutdown server with port 45041 now
2019-06-14 10:20:32,835 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - bd545786-ae28-4039-9939-51484a7fc628: shutdown server with port 45041 successfully
2019-06-14 10:20:32,838 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:20:32,891 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler170dcf57-bd5b-4d61-b1d9-852888b35d18/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:20:32,892 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler170dcf57-bd5b-4d61-b1d9-852888b35d18/hdds to VolumeSet
2019-06-14 10:20:32,892 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@66153688
2019-06-14 10:20:32,892 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@66153688
2019-06-14 10:20:32,908 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 45933
2019-06-14 10:20:32,909 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 10:20:32,909 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:20:32,910 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 45933 (custom)
2019-06-14 10:20:32,910 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:20:32,910 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:20:32,910 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:20:32,911 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:20:32,911 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler170dcf57-bd5b-4d61-b1d9-852888b35d18/ratis] (custom)
2019-06-14 10:20:32,912 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 46699
2019-06-14 10:20:32,912 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:20:32,912 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:20:32,912 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 5000bdaa-8cd7-444a-893b-5920d5165d8d at port 45933
2019-06-14 10:20:32,919 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d: start RPC server
2019-06-14 10:20:32,920 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d: GrpcService started, listening on 0.0.0.0/0.0.0.0:45933
Jun 14, 2019 10:20:32 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:41717} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 14, 2019 10:20:32 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:45041} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-14 10:20:32,942 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d: addNew group-B9B07F447D23:[5000bdaa-8cd7-444a-893b-5920d5165d8d:127.0.0.1:45933] returns group-B9B07F447D23:java.util.concurrent.CompletableFuture@20e72520[Not completed]
2019-06-14 10:20:32,943 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d: new RaftServerImpl for group-B9B07F447D23:[5000bdaa-8cd7-444a-893b-5920d5165d8d:127.0.0.1:45933] with ContainerStateMachine:uninitialized
2019-06-14 10:20:32,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:20:32,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:20:32,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:20:32,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:20:32,944 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d:group-B9B07F447D23 ConfigurationManager, init=-1: [5000bdaa-8cd7-444a-893b-5920d5165d8d:127.0.0.1:45933], old=null, confs=<EMPTY_MAP>
2019-06-14 10:20:32,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler170dcf57-bd5b-4d61-b1d9-852888b35d18/ratis] (custom)
2019-06-14 10:20:32,945 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler170dcf57-bd5b-4d61-b1d9-852888b35d18/ratis/e4345eaf-f4f4-419f-9733-b9b07f447d23 does not exist. Creating ...
2019-06-14 10:20:32,967 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler170dcf57-bd5b-4d61-b1d9-852888b35d18/ratis/e4345eaf-f4f4-419f-9733-b9b07f447d23/in_use.lock acquired by nodename 4179@ozone-cf6ld-331198676
2019-06-14 10:20:33,044 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler170dcf57-bd5b-4d61-b1d9-852888b35d18/ratis/e4345eaf-f4f4-419f-9733-b9b07f447d23 has been successfully formatted.
2019-06-14 10:20:33,044 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:20:33,044 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:20:33,044 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:20:33,044 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:20:33,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:20:33,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:20:33,045 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 5000bdaa-8cd7-444a-893b-5920d5165d8d-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler170dcf57-bd5b-4d61-b1d9-852888b35d18/ratis/e4345eaf-f4f4-419f-9733-b9b07f447d23
2019-06-14 10:20:33,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:20:33,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:20:33,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:20:33,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:20:33,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:20:33,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:20:33,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:20:33,046 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:20:33,046 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:20:33,046 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:20:33,046 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:20:33,046 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:20:33,046 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:20:33,047 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d: start group-B9B07F447D23
2019-06-14 10:20:33,047 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d:group-B9B07F447D23 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:20:33,047 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d: start FollowerState
2019-06-14 10:20:33,047 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-B9B07F447D23,id=5000bdaa-8cd7-444a-893b-5920d5165d8d
2019-06-14 10:20:34,101 INFO  impl.FollowerState (FollowerState.java:run(101)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d:group-B9B07F447D23 changes to CANDIDATE, lastRpcTime:1054, electionTimeout:1054ms
2019-06-14 10:20:34,101 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d: shutdown FollowerState
2019-06-14 10:20:34,101 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d:group-B9B07F447D23 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:20:34,101 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d: start LeaderElection
2019-06-14 10:20:34,256 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d:group-B9B07F447D23:LeaderElection4: begin an election at term 1 for -1: [5000bdaa-8cd7-444a-893b-5920d5165d8d:127.0.0.1:45933], old=null
2019-06-14 10:20:34,256 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d: shutdown LeaderElection
2019-06-14 10:20:34,256 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d:group-B9B07F447D23 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:20:34,256 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d:group-B9B07F447D23 change Leader from null to 5000bdaa-8cd7-444a-893b-5920d5165d8d at term 1 for becomeLeader, leader elected after 1211ms
2019-06-14 10:20:34,256 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:20:34,256 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:20:34,257 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:20:34,257 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:20:34,257 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d: start LeaderState
2019-06-14 10:20:34,257 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d-RaftLogWorker: Starting segment from index:0
2019-06-14 10:20:34,259 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d:group-B9B07F447D23 set configuration 0: [5000bdaa-8cd7-444a-893b-5920d5165d8d:127.0.0.1:45933], old=null at 0
2019-06-14 10:20:34,329 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler170dcf57-bd5b-4d61-b1d9-852888b35d18/ratis/e4345eaf-f4f4-419f-9733-b9b07f447d23/current/log_inprogress_0
2019-06-14 10:20:35,194 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 5288804562267774198 is closed with bcsId 0.
2019-06-14 10:20:35,195 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:20:35,195 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d: close
2019-06-14 10:20:35,195 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d: shutdown group-B9B07F447D23
2019-06-14 10:20:35,196 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-B9B07F447D23,id=5000bdaa-8cd7-444a-893b-5920d5165d8d
2019-06-14 10:20:35,196 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d: shutdown LeaderState
2019-06-14 10:20:35,196 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d-PendingRequests: sendNotLeaderResponses
2019-06-14 10:20:35,197 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-5000bdaa-8cd7-444a-893b-5920d5165d8d-group-B9B07F447D23: set stopIndex = 2
2019-06-14 10:20:35,197 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-14 10:20:35,197 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler170dcf57-bd5b-4d61-b1d9-852888b35d18/ratis/e4345eaf-f4f4-419f-9733-b9b07f447d23/sm/snapshot.1_2
2019-06-14 10:20:35,198 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d:group-B9B07F447D23 closes. The last applied log index is 2
2019-06-14 10:20:35,198 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:20:35,199 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d-RaftLogWorker close()
2019-06-14 10:20:35,199 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d: shutdown server with port 45933 now
2019-06-14 10:20:35,200 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 5000bdaa-8cd7-444a-893b-5920d5165d8d: shutdown server with port 45933 successfully
2019-06-14 10:20:35,205 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:20:35,227 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler7c70cdc3-d199-49b9-8ddf-50a82e3f42c4/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:20:35,229 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler7c70cdc3-d199-49b9-8ddf-50a82e3f42c4/hdds to VolumeSet
2019-06-14 10:20:35,229 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@68217d41
2019-06-14 10:20:35,230 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@68217d41
2019-06-14 10:20:35,243 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 33987
2019-06-14 10:20:35,243 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 10:20:35,244 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:20:35,244 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 33987 (custom)
2019-06-14 10:20:35,245 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:20:35,245 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:20:35,245 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:20:35,245 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:20:35,246 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler7c70cdc3-d199-49b9-8ddf-50a82e3f42c4/ratis] (custom)
2019-06-14 10:20:35,246 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 39135
2019-06-14 10:20:35,247 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:20:35,247 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:20:35,247 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 8573c5cf-4e88-4093-b9ff-b79eff454b53 at port 33987
2019-06-14 10:20:35,272 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53: start RPC server
2019-06-14 10:20:35,274 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53: GrpcService started, listening on 0.0.0.0/0.0.0.0:33987
2019-06-14 10:20:35,285 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53: addNew group-C8CEE4154D9A:[8573c5cf-4e88-4093-b9ff-b79eff454b53:127.0.0.1:33987] returns group-C8CEE4154D9A:java.util.concurrent.CompletableFuture@a76b152[Not completed]
2019-06-14 10:20:35,285 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53: new RaftServerImpl for group-C8CEE4154D9A:[8573c5cf-4e88-4093-b9ff-b79eff454b53:127.0.0.1:33987] with ContainerStateMachine:uninitialized
2019-06-14 10:20:35,286 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:20:35,286 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:20:35,286 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:20:35,286 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:20:35,287 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53:group-C8CEE4154D9A ConfigurationManager, init=-1: [8573c5cf-4e88-4093-b9ff-b79eff454b53:127.0.0.1:33987], old=null, confs=<EMPTY_MAP>
2019-06-14 10:20:35,287 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler7c70cdc3-d199-49b9-8ddf-50a82e3f42c4/ratis] (custom)
2019-06-14 10:20:35,287 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler7c70cdc3-d199-49b9-8ddf-50a82e3f42c4/ratis/27fb9e51-6da9-4e54-bf51-c8cee4154d9a does not exist. Creating ...
2019-06-14 10:20:35,290 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler7c70cdc3-d199-49b9-8ddf-50a82e3f42c4/ratis/27fb9e51-6da9-4e54-bf51-c8cee4154d9a/in_use.lock acquired by nodename 4179@ozone-cf6ld-331198676
2019-06-14 10:20:35,293 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler7c70cdc3-d199-49b9-8ddf-50a82e3f42c4/ratis/27fb9e51-6da9-4e54-bf51-c8cee4154d9a has been successfully formatted.
2019-06-14 10:20:35,294 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:20:35,294 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:20:35,294 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:20:35,294 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:20:35,294 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:20:35,294 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:20:35,294 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 8573c5cf-4e88-4093-b9ff-b79eff454b53-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler7c70cdc3-d199-49b9-8ddf-50a82e3f42c4/ratis/27fb9e51-6da9-4e54-bf51-c8cee4154d9a
2019-06-14 10:20:35,295 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:20:35,295 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:20:35,295 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:20:35,295 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:20:35,295 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:20:35,295 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:20:35,295 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:20:35,296 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:20:35,296 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:20:35,296 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:20:35,296 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:20:35,296 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:20:35,297 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:20:35,297 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53: start group-C8CEE4154D9A
2019-06-14 10:20:35,297 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53:group-C8CEE4154D9A changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:20:35,297 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53: start FollowerState
2019-06-14 10:20:35,297 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C8CEE4154D9A,id=8573c5cf-4e88-4093-b9ff-b79eff454b53
2019-06-14 10:20:36,482 INFO  impl.FollowerState (FollowerState.java:run(101)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53:group-C8CEE4154D9A changes to CANDIDATE, lastRpcTime:1184, electionTimeout:1184ms
2019-06-14 10:20:36,482 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53: shutdown FollowerState
2019-06-14 10:20:36,482 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53:group-C8CEE4154D9A changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:20:36,482 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53: start LeaderElection
2019-06-14 10:20:36,488 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53:group-C8CEE4154D9A:LeaderElection5: begin an election at term 1 for -1: [8573c5cf-4e88-4093-b9ff-b79eff454b53:127.0.0.1:33987], old=null
2019-06-14 10:20:36,488 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53: shutdown LeaderElection
2019-06-14 10:20:36,488 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53:group-C8CEE4154D9A changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:20:36,488 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53:group-C8CEE4154D9A change Leader from null to 8573c5cf-4e88-4093-b9ff-b79eff454b53 at term 1 for becomeLeader, leader elected after 1194ms
2019-06-14 10:20:36,488 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:20:36,489 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:20:36,489 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:20:36,489 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:20:36,489 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53: start LeaderState
2019-06-14 10:20:36,489 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53-RaftLogWorker: Starting segment from index:0
2019-06-14 10:20:36,489 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53:group-C8CEE4154D9A set configuration 0: [8573c5cf-4e88-4093-b9ff-b79eff454b53:127.0.0.1:33987], old=null at 0
2019-06-14 10:20:36,529 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler7c70cdc3-d199-49b9-8ddf-50a82e3f42c4/ratis/27fb9e51-6da9-4e54-bf51-c8cee4154d9a/current/log_inprogress_0
2019-06-14 10:20:37,335 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 5105939541669904951 is closed with bcsId 0.
2019-06-14 10:20:37,336 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:20:37,336 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53: close
2019-06-14 10:20:37,336 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53: shutdown group-C8CEE4154D9A
2019-06-14 10:20:37,336 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C8CEE4154D9A,id=8573c5cf-4e88-4093-b9ff-b79eff454b53
2019-06-14 10:20:37,336 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53: shutdown LeaderState
2019-06-14 10:20:37,337 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53-PendingRequests: sendNotLeaderResponses
2019-06-14 10:20:37,338 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-8573c5cf-4e88-4093-b9ff-b79eff454b53-group-C8CEE4154D9A: set stopIndex = 4
2019-06-14 10:20:37,338 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-14 10:20:37,338 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler7c70cdc3-d199-49b9-8ddf-50a82e3f42c4/ratis/27fb9e51-6da9-4e54-bf51-c8cee4154d9a/sm/snapshot.1_4
2019-06-14 10:20:37,338 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53:group-C8CEE4154D9A closes. The last applied log index is 4
2019-06-14 10:20:37,338 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:20:37,339 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53-RaftLogWorker close()
2019-06-14 10:20:37,340 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53: shutdown server with port 33987 now
2019-06-14 10:20:37,341 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 8573c5cf-4e88-4093-b9ff-b79eff454b53: shutdown server with port 33987 successfully
2019-06-14 10:20:37,344 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
