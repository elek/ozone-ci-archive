2019-06-14 10:27:15,374 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:15,464 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:15,467 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:15,486 INFO  util.log (Log.java:initialized(192)) - Logging initialized @744ms
2019-06-14 10:27:15,576 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedBlocks
2019-06-14 10:27:15,576 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedBlocks
2019-06-14 10:27:15,576 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: validCerts
2019-06-14 10:27:15,576 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:validCerts
2019-06-14 10:27:15,577 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: revokedCerts
2019-06-14 10:27:15,577 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:revokedCerts
2019-06-14 10:27:15,587 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-14 10:27:15,588 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-14 10:27:15,589 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-14 10:27:15,657 INFO  node.SCMNodeManager (SCMNodeManager.java:<init>(108)) - Entering startup safe mode.
2019-06-14 10:27:15,715 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(125)) - Loading file from sun.misc.CompoundEnumeration@62379589
2019-06-14 10:27:15,717 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(171)) - Loading network topology layer schema file
2019-06-14 10:27:15,771 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:15,791 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:initializePipelineState(126)) - No pipeline exists in current db
2019-06-14 10:27:15,793 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:15,848 WARN  events.EventQueue (EventQueue.java:fireEvent(175)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='SafeModeStatus'}
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-14 10:27:16,144 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:27:16,175 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 37187
2019-06-14 10:27:16,199 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:27:16,226 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 45145
2019-06-14 10:27:16,234 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:27:16,235 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 34591
2019-06-14 10:27:16,255 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for scm at: http://0.0.0.0:0
2019-06-14 10:27:16,413 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:27:16,419 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:27:16,426 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:27:16,428 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context scm
2019-06-14 10:27:16,428 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:27:16,429 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:27:16,456 INFO  server.StorageContainerManager (StorageContainerManager.java:start(752)) - StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:34591
2019-06-14 10:27:16,516 WARN  impl.MetricsConfig (MetricsConfig.java:loadFirst(134)) - Cannot locate configuration: tried hadoop-metrics2-storagecontainermanager.properties,hadoop-metrics2.properties
2019-06-14 10:27:16,525 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:startTimer(374)) - Scheduled Metric snapshot period at 10 second(s).
2019-06-14 10:27:16,525 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:start(191)) - StorageContainerManager metrics system started
2019-06-14 10:27:16,712 INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:start(149)) - RPC server for Client  is listening at /0.0.0.0:34591
2019-06-14 10:27:16,713 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:27:16,714 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 34591: starting
2019-06-14 10:27:16,721 INFO  server.StorageContainerManager (StorageContainerManager.java:start(761)) - ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:45145
2019-06-14 10:27:16,721 INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:start(137)) - RPC server for Block Protocol is listening at /0.0.0.0:45145
2019-06-14 10:27:16,722 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:27:16,722 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 45145: starting
2019-06-14 10:27:16,724 INFO  server.StorageContainerManager (StorageContainerManager.java:start(765)) - ScmDatanodeProtocl RPC server is listening at /0.0.0.0:37187
2019-06-14 10:27:16,724 INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:start(191)) - RPC server for DataNodes is listening at /0.0.0.0:37187
2019-06-14 10:27:16,725 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:27:16,725 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 37187: starting
2019-06-14 10:27:16,728 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 46805
2019-06-14 10:27:16,729 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:27:16,759 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@35229f85{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:27:16,759 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@b1712f3{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-14 10:27:16,789 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@66629f63{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/scm/,AVAILABLE}{/scm}
2019-06-14 10:27:16,794 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@224b4d61{HTTP/1.1,[http/1.1]}{0.0.0.0:46805}
2019-06-14 10:27:16,795 INFO  server.Server (Server.java:doStart(419)) - Started @2053ms
2019-06-14 10:27:16,795 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of SCM is listening at http://0.0.0.0:46805
2019-06-14 10:27:16,801 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:27:16,805 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:17,072 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:17,073 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(519)) - OM Service ID is not set. Setting it to the default ID: omServiceIdDefault
2019-06-14 10:27:17,074 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(525)) - OM Node ID is not set. Setting it to the OmStorage's OmID: 108ef23f-ec2b-4bb4-8930-bdf848a8d42f
2019-06-14 10:27:17,075 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 10:27:17,076 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 10:27:17,076 INFO  om.OzoneManager (OzoneManager.java:loadOMHAConfigs(476)) - Found matching OM address with OMServiceId: null, OMNodeId: null, RPC Address: localhost:0 and Ratis port: 9872
2019-06-14 10:27:17,247 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:17,254 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: userTable
2019-06-14 10:27:17,254 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:userTable
2019-06-14 10:27:17,254 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: volumeTable
2019-06-14 10:27:17,254 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:volumeTable
2019-06-14 10:27:17,255 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: bucketTable
2019-06-14 10:27:17,255 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:bucketTable
2019-06-14 10:27:17,255 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: keyTable
2019-06-14 10:27:17,255 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:keyTable
2019-06-14 10:27:17,255 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedTable
2019-06-14 10:27:17,256 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedTable
2019-06-14 10:27:17,256 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: openKeyTable
2019-06-14 10:27:17,256 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:openKeyTable
2019-06-14 10:27:17,256 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3Table
2019-06-14 10:27:17,257 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3Table
2019-06-14 10:27:17,257 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: multipartInfoTable
2019-06-14 10:27:17,257 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:multipartInfoTable
2019-06-14 10:27:17,257 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: dTokenTable
2019-06-14 10:27:17,258 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:dTokenTable
2019-06-14 10:27:17,258 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3SecretTable
2019-06-14 10:27:17,258 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3SecretTable
2019-06-14 10:27:17,259 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: prefixTable
2019-06-14 10:27:17,259 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:prefixTable
2019-06-14 10:27:17,259 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-14 10:27:17,259 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-14 10:27:17,259 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-14 10:27:17,842 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:27:17,842 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 38271
2019-06-14 10:27:17,865 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:17,865 INFO  om.OzoneManager (OzoneManager.java:start(1217)) - OzoneManager RPC server is listening at localhost/127.0.0.1:38271
2019-06-14 10:27:17,865 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - OzoneManager metrics system started (again)
2019-06-14 10:27:17,866 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:27:17,866 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 38271: starting
2019-06-14 10:27:17,899 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for ozoneManager at: http://0.0.0.0:0
2019-06-14 10:27:17,901 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:27:17,901 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:27:17,903 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:27:17,903 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context ozoneManager
2019-06-14 10:27:17,904 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:27:17,904 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:27:17,905 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 42069
2019-06-14 10:27:17,906 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:27:17,934 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@1a411233{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:27:17,934 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@7c2327fa{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-14 10:27:17,938 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@4565a70a{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/ozoneManager/,AVAILABLE}{/ozoneManager}
2019-06-14 10:27:17,939 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@a0a9fa5{HTTP/1.1,[http/1.1]}{0.0.0.0:42069}
2019-06-14 10:27:17,939 INFO  server.Server (Server.java:doStart(419)) - Started @3197ms
2019-06-14 10:27:17,940 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of OZONEMANAGER is listening at http://0.0.0.0:42069
2019-06-14 10:27:18,076 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:27:18,215 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:27:18,243 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-0/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:27:18,244 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-0/data/containers/hdds to VolumeSet
2019-06-14 10:27:18,247 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@4ed38226
2019-06-14 10:27:18,262 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@4ed38226
2019-06-14 10:27:18,301 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 41877
2019-06-14 10:27:18,364 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:27:18,374 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 41877 (custom)
2019-06-14 10:27:18,375 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:27:18,377 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:18,378 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:27:18,378 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:18,519 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-0/data/ratis] (custom)
2019-06-14 10:27:18,524 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 43877
2019-06-14 10:27:18,548 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:27:18,557 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:27:18,558 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:27:18,559 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:27:18,560 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:27:18,561 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:27:18,561 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:27:18,561 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:27:18,562 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 45981
2019-06-14 10:27:18,562 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:27:18,563 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@a565cbd{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:27:18,564 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@2f66f0d0{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:27:18,602 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@2b037cfc{/,file:///tmp/jetty-0.0.0.0-45981-hddsDatanode-_-any-7475454188450470085.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:27:18,603 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@44924587{HTTP/1.1,[http/1.1]}{0.0.0.0:45981}
2019-06-14 10:27:18,603 INFO  server.Server (Server.java:doStart(419)) - Started @3862ms
2019-06-14 10:27:18,604 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:45981
Jun 14, 2019 10:27:18 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:27:19,529 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@78a8978a
2019-06-14 10:27:19,530 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:27:19,531 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:27:19,538 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:27:19,546 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-1/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:27:19,550 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-1/data/containers/hdds to VolumeSet
2019-06-14 10:27:19,550 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@5d66e944
2019-06-14 10:27:19,554 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@5d66e944
2019-06-14 10:27:19,571 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 33799
2019-06-14 10:27:19,572 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:27:19,573 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 33799 (custom)
2019-06-14 10:27:19,573 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:27:19,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:19,575 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:27:19,575 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:19,575 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-1/data/ratis] (custom)
2019-06-14 10:27:19,575 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 39377
2019-06-14 10:27:19,576 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:27:19,577 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:27:19,578 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:27:19,579 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:27:19,580 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:27:19,580 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:27:19,580 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:27:19,581 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:27:19,581 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 45135
2019-06-14 10:27:19,581 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:27:19,588 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@691124ee{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:27:19,589 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@5403799b{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:27:19,619 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@59a2388e{/,file:///tmp/jetty-0.0.0.0-45135-hddsDatanode-_-any-3830094460383396033.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:27:19,620 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@186d8a71{HTTP/1.1,[http/1.1]}{0.0.0.0:45135}
2019-06-14 10:27:19,620 INFO  server.Server (Server.java:doStart(419)) - Started @4878ms
2019-06-14 10:27:19,623 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:45135
Jun 14, 2019 10:27:19 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:27:19,709 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-0/meta/datanode.id
2019-06-14 10:27:19,811 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@aa61e4e
2019-06-14 10:27:19,812 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:27:19,812 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:27:19,814 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:27:19,826 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-1/meta/datanode.id
2019-06-14 10:27:19,830 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-2/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:27:19,831 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-2/data/containers/hdds to VolumeSet
2019-06-14 10:27:19,831 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@32227215
2019-06-14 10:27:19,832 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@32227215
2019-06-14 10:27:19,844 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 37247
2019-06-14 10:27:19,845 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:27:19,845 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 37247 (custom)
2019-06-14 10:27:19,846 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:27:19,846 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:19,846 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:27:19,846 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:19,847 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-2/data/ratis] (custom)
2019-06-14 10:27:19,847 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 40865
2019-06-14 10:27:19,848 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:27:19,849 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:27:19,850 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:27:19,851 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:27:19,852 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:27:19,853 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:27:19,853 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:27:19,853 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:27:19,854 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 44821
2019-06-14 10:27:19,854 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:27:19,856 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@d3e3085{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:27:19,856 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@285005b8{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:27:19,878 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@52bd9a27{/,file:///tmp/jetty-0.0.0.0-44821-hddsDatanode-_-any-1821005974032662722.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:27:19,879 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@611e5819{HTTP/1.1,[http/1.1]}{0.0.0.0:44821}
2019-06-14 10:27:19,879 INFO  server.Server (Server.java:doStart(419)) - Started @5137ms
2019-06-14 10:27:19,879 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:44821
Jun 14, 2019 10:27:19 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:27:20,050 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@707865bd
2019-06-14 10:27:20,051 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:27:20,051 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:27:20,054 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-2/meta/datanode.id
2019-06-14 10:27:20,054 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:27:20,070 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-3/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:27:20,070 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-3/data/containers/hdds to VolumeSet
2019-06-14 10:27:20,071 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@475f5672
2019-06-14 10:27:20,074 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@475f5672
2019-06-14 10:27:20,089 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 46667
2019-06-14 10:27:20,090 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:27:20,090 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 46667 (custom)
2019-06-14 10:27:20,091 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:27:20,091 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:20,091 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:27:20,092 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:20,092 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-3/data/ratis] (custom)
2019-06-14 10:27:20,093 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 39619
2019-06-14 10:27:20,093 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:27:20,094 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:27:20,095 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:27:20,096 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:27:20,097 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:27:20,098 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:27:20,098 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:27:20,098 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:27:20,099 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 44915
2019-06-14 10:27:20,099 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:27:20,103 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@3830f918{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:27:20,103 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@739831a4{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:27:20,126 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@e91af20{/,file:///tmp/jetty-0.0.0.0-44915-hddsDatanode-_-any-495594430729815366.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:27:20,127 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@2f1f12a0{HTTP/1.1,[http/1.1]}{0.0.0.0:44915}
2019-06-14 10:27:20,128 INFO  server.Server (Server.java:doStart(419)) - Started @5387ms
2019-06-14 10:27:20,129 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:44915
Jun 14, 2019 10:27:20 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:27:20,271 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@3c54ddec
2019-06-14 10:27:20,271 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:27:20,272 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:27:20,274 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:27:20,275 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-3/meta/datanode.id
2019-06-14 10:27:20,280 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-4/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:27:20,280 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-4/data/containers/hdds to VolumeSet
2019-06-14 10:27:20,280 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@67acfde9
2019-06-14 10:27:20,286 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@67acfde9
2019-06-14 10:27:20,296 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 37999
2019-06-14 10:27:20,297 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:27:20,297 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 37999 (custom)
2019-06-14 10:27:20,298 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:27:20,298 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:20,298 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:27:20,298 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:20,299 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-4/data/ratis] (custom)
2019-06-14 10:27:20,299 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 34031
2019-06-14 10:27:20,300 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:27:20,301 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:27:20,302 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:27:20,302 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:27:20,304 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:27:20,304 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:27:20,304 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:27:20,305 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:27:20,305 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 44137
2019-06-14 10:27:20,305 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:27:20,308 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@b1b471{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:27:20,308 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@4f1afe8f{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:27:20,338 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@4dc52559{/,file:///tmp/jetty-0.0.0.0-44137-hddsDatanode-_-any-4700871845262105953.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:27:20,338 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@5c3d4f05{HTTP/1.1,[http/1.1]}{0.0.0.0:44137}
2019-06-14 10:27:20,339 INFO  server.Server (Server.java:doStart(419)) - Started @5598ms
2019-06-14 10:27:20,340 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:44137
Jun 14, 2019 10:27:20 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:27:20,476 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@ceb7701
2019-06-14 10:27:20,476 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:27:20,477 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:27:20,486 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:27:20,487 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-4/meta/datanode.id
2019-06-14 10:27:20,493 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-5/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:27:20,494 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-5/data/containers/hdds to VolumeSet
2019-06-14 10:27:20,494 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@5627cb29
2019-06-14 10:27:20,495 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@5627cb29
2019-06-14 10:27:20,504 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 38305
2019-06-14 10:27:20,505 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:27:20,506 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 38305 (custom)
2019-06-14 10:27:20,506 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:27:20,506 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:20,507 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:27:20,507 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:20,507 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-5/data/ratis] (custom)
2019-06-14 10:27:20,508 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 46423
2019-06-14 10:27:20,508 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:27:20,517 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:27:20,518 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:27:20,519 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:27:20,520 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:27:20,521 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:27:20,521 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:27:20,521 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:27:20,522 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 39633
2019-06-14 10:27:20,522 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:27:20,525 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@6b063470{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:27:20,525 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@527937d0{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:27:20,548 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@70be89ec{/,file:///tmp/jetty-0.0.0.0-39633-hddsDatanode-_-any-8370543279438421308.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:27:20,549 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@2aee0704{HTTP/1.1,[http/1.1]}{0.0.0.0:39633}
2019-06-14 10:27:20,549 INFO  server.Server (Server.java:doStart(419)) - Started @5808ms
2019-06-14 10:27:20,550 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:39633
Jun 14, 2019 10:27:20 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:27:20,665 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@159ac15f
2019-06-14 10:27:20,666 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:27:20,670 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:27:20,671 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-5/meta/datanode.id
2019-06-14 10:27:21,558 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:27:21,558 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:27:21,558 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 227a6fd9-6137-4d19-bf85-40110cf9fabd at port 41877
2019-06-14 10:27:21,571 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: start RPC server
2019-06-14 10:27:21,666 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:27:21,702 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: GrpcService started, listening on 0.0.0.0/0.0.0.0:41877
2019-06-14 10:27:21,818 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:27:21,819 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:27:21,819 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis a0eb4e14-4e55-404d-acf1-1f052f7ff9fb at port 33799
2019-06-14 10:27:21,829 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: start RPC server
2019-06-14 10:27:21,832 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: GrpcService started, listening on 0.0.0.0/0.0.0.0:33799
2019-06-14 10:27:22,057 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:27:22,058 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:27:22,059 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 7532b1c1-eee6-40f9-81b4-f2c881484f0d at port 37247
2019-06-14 10:27:22,064 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: start RPC server
2019-06-14 10:27:22,066 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: GrpcService started, listening on 0.0.0.0/0.0.0.0:37247
2019-06-14 10:27:22,278 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:27:22,280 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:27:22,280 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis da9925a9-e302-487a-a7c2-5233ffc8e882 at port 46667
2019-06-14 10:27:22,286 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - da9925a9-e302-487a-a7c2-5233ffc8e882: start RPC server
2019-06-14 10:27:22,287 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - da9925a9-e302-487a-a7c2-5233ffc8e882: GrpcService started, listening on 0.0.0.0/0.0.0.0:46667
2019-06-14 10:27:22,490 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:27:22,492 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:27:22,492 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 5cb89b60-561f-4d51-91d3-1a386bffeb6b at port 37999
2019-06-14 10:27:22,498 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: start RPC server
2019-06-14 10:27:22,500 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: GrpcService started, listening on 0.0.0.0/0.0.0.0:37999
2019-06-14 10:27:22,667 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:27:22,674 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:27:22,676 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:27:22,677 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 7bba2558-4743-447d-9e01-b6a234175195 at port 38305
2019-06-14 10:27:22,690 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 7bba2558-4743-447d-9e01-b6a234175195: start RPC server
2019-06-14 10:27:22,692 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 7bba2558-4743-447d-9e01-b6a234175195: GrpcService started, listening on 0.0.0.0/0.0.0.0:38305
2019-06-14 10:27:23,558 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 227a6fd9-6137-4d19-bf85-40110cf9fabd{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:27:23,565 INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 1 DataNodes registered, 1 required.
2019-06-14 10:27:23,565 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(177)) - ScmSafeModeManager, all rules are successfully validated
2019-06-14 10:27:23,565 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:exitSafeMode(193)) - SCM exiting safe mode.
2019-06-14 10:27:23,667 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 1 of 6 DN Heartbeats.
2019-06-14 10:27:23,830 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : a0eb4e14-4e55-404d-acf1-1f052f7ff9fb{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:27:23,986 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: addNew group-B02FBD1AF667:[227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877] returns group-B02FBD1AF667:java.util.concurrent.CompletableFuture@348611a8[Not completed]
2019-06-14 10:27:23,992 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: new RaftServerImpl for group-B02FBD1AF667:[227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877] with ContainerStateMachine:uninitialized
2019-06-14 10:27:23,993 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:23,993 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:23,994 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:23,994 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:24,000 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd:group-B02FBD1AF667 ConfigurationManager, init=-1: [227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:24,001 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-0/data/ratis] (custom)
2019-06-14 10:27:24,007 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-0/data/ratis/672f2670-c3ca-4779-8cf3-b02fbd1af667 does not exist. Creating ...
2019-06-14 10:27:24,012 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-0/data/ratis/672f2670-c3ca-4779-8cf3-b02fbd1af667/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:24,016 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-0/data/ratis/672f2670-c3ca-4779-8cf3-b02fbd1af667 has been successfully formatted.
2019-06-14 10:27:24,018 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:24,018 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:24,019 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:24,176 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 7532b1c1-eee6-40f9-81b4-f2c881484f0d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:27:24,182 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:24,186 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:24,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:24,194 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 227a6fd9-6137-4d19-bf85-40110cf9fabd-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-0/data/ratis/672f2670-c3ca-4779-8cf3-b02fbd1af667
2019-06-14 10:27:24,195 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:24,195 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:24,197 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:24,198 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:24,198 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:24,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:24,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:24,200 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:24,200 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:24,203 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:24,208 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:24,209 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:24,210 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:24,228 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: start group-B02FBD1AF667
2019-06-14 10:27:24,229 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd:group-B02FBD1AF667 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:24,230 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: start FollowerState
2019-06-14 10:27:24,232 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-B02FBD1AF667,id=227a6fd9-6137-4d19-bf85-40110cf9fabd
2019-06-14 10:27:24,276 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 672f2670-c3ca-4779-8cf3-b02fbd1af667, Nodes: 227a6fd9-6137-4d19-bf85-40110cf9fabd{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:27:24,276 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : da9925a9-e302-487a-a7c2-5233ffc8e882{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:27:24,296 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - da9925a9-e302-487a-a7c2-5233ffc8e882: addNew group-E8F75B76E96D:[da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667] returns group-E8F75B76E96D:java.util.concurrent.CompletableFuture@31117c2[Not completed]
2019-06-14 10:27:24,296 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - da9925a9-e302-487a-a7c2-5233ffc8e882: new RaftServerImpl for group-E8F75B76E96D:[da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667] with ContainerStateMachine:uninitialized
2019-06-14 10:27:24,297 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:24,298 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:24,298 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:24,298 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:24,298 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - da9925a9-e302-487a-a7c2-5233ffc8e882:group-E8F75B76E96D ConfigurationManager, init=-1: [da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:24,298 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-3/data/ratis] (custom)
2019-06-14 10:27:24,298 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-3/data/ratis/f6cb7eac-b0f5-48c2-b40f-e8f75b76e96d does not exist. Creating ...
2019-06-14 10:27:24,301 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-3/data/ratis/f6cb7eac-b0f5-48c2-b40f-e8f75b76e96d/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:24,303 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-3/data/ratis/f6cb7eac-b0f5-48c2-b40f-e8f75b76e96d has been successfully formatted.
2019-06-14 10:27:24,303 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:24,303 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:24,303 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:24,303 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:24,303 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:24,303 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:24,304 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new da9925a9-e302-487a-a7c2-5233ffc8e882-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-3/data/ratis/f6cb7eac-b0f5-48c2-b40f-e8f75b76e96d
2019-06-14 10:27:24,304 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:24,304 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:24,305 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:24,305 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:24,305 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:24,305 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:24,305 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:24,305 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:24,305 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:24,305 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:24,309 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:24,310 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:24,310 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:24,310 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - da9925a9-e302-487a-a7c2-5233ffc8e882: start group-E8F75B76E96D
2019-06-14 10:27:24,310 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - da9925a9-e302-487a-a7c2-5233ffc8e882:group-E8F75B76E96D changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:24,310 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - da9925a9-e302-487a-a7c2-5233ffc8e882: start FollowerState
2019-06-14 10:27:24,311 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-E8F75B76E96D,id=da9925a9-e302-487a-a7c2-5233ffc8e882
2019-06-14 10:27:24,320 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: f6cb7eac-b0f5-48c2-b40f-e8f75b76e96d, Nodes: da9925a9-e302-487a-a7c2-5233ffc8e882{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:27:24,357 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: addNew group-F56F5462F812:[7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247] returns group-F56F5462F812:java.util.concurrent.CompletableFuture@5f189cd6[Not completed]
2019-06-14 10:27:24,383 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: new RaftServerImpl for group-F56F5462F812:[7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247] with ContainerStateMachine:uninitialized
2019-06-14 10:27:24,383 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:24,383 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:24,383 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:24,383 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:24,383 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d:group-F56F5462F812 ConfigurationManager, init=-1: [7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:24,383 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-2/data/ratis] (custom)
2019-06-14 10:27:24,383 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-2/data/ratis/07582538-a144-4af0-8a6f-f56f5462f812 does not exist. Creating ...
2019-06-14 10:27:24,386 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-2/data/ratis/07582538-a144-4af0-8a6f-f56f5462f812/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:24,389 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-2/data/ratis/07582538-a144-4af0-8a6f-f56f5462f812 has been successfully formatted.
2019-06-14 10:27:24,389 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:24,390 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:24,390 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:24,391 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:24,391 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:24,391 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:24,391 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 7532b1c1-eee6-40f9-81b4-f2c881484f0d-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-2/data/ratis/07582538-a144-4af0-8a6f-f56f5462f812
2019-06-14 10:27:24,391 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:24,391 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:24,391 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:24,391 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:24,391 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:24,391 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:24,391 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:24,392 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:24,392 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:24,392 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:24,392 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:24,392 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:24,392 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:24,393 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: start group-F56F5462F812
2019-06-14 10:27:24,393 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d:group-F56F5462F812 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:24,393 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: start FollowerState
2019-06-14 10:27:24,393 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-F56F5462F812,id=7532b1c1-eee6-40f9-81b4-f2c881484f0d
2019-06-14 10:27:24,402 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 07582538-a144-4af0-8a6f-f56f5462f812, Nodes: 7532b1c1-eee6-40f9-81b4-f2c881484f0d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:27:24,419 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: addNew group-9D6BC50045DC:[a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799] returns group-9D6BC50045DC:java.util.concurrent.CompletableFuture@701d85ae[Not completed]
2019-06-14 10:27:24,423 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: new RaftServerImpl for group-9D6BC50045DC:[a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799] with ContainerStateMachine:uninitialized
2019-06-14 10:27:24,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:24,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:24,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:24,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:24,423 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-9D6BC50045DC ConfigurationManager, init=-1: [a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:24,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-1/data/ratis] (custom)
2019-06-14 10:27:24,424 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-1/data/ratis/ab524387-db58-42a2-bf7e-9d6bc50045dc does not exist. Creating ...
2019-06-14 10:27:24,426 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-1/data/ratis/ab524387-db58-42a2-bf7e-9d6bc50045dc/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:24,429 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-1/data/ratis/ab524387-db58-42a2-bf7e-9d6bc50045dc has been successfully formatted.
2019-06-14 10:27:24,429 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:24,429 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:24,429 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:24,429 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:24,429 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:24,429 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:24,429 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new a0eb4e14-4e55-404d-acf1-1f052f7ff9fb-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-1/data/ratis/ab524387-db58-42a2-bf7e-9d6bc50045dc
2019-06-14 10:27:24,429 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:24,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:24,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:24,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:24,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:24,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:24,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:24,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:24,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:24,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:24,431 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:24,431 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:24,431 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:24,431 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: start group-9D6BC50045DC
2019-06-14 10:27:24,431 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-9D6BC50045DC changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:24,431 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: start FollowerState
2019-06-14 10:27:24,432 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-9D6BC50045DC,id=a0eb4e14-4e55-404d-acf1-1f052f7ff9fb
2019-06-14 10:27:24,441 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: ab524387-db58-42a2-bf7e-9d6bc50045dc, Nodes: a0eb4e14-4e55-404d-acf1-1f052f7ff9fb{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:27:24,474 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - da9925a9-e302-487a-a7c2-5233ffc8e882: addNew group-C5510B48FB6D:[7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247, da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799] returns group-C5510B48FB6D:java.util.concurrent.CompletableFuture@7c994a54[Not completed]
2019-06-14 10:27:24,474 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - da9925a9-e302-487a-a7c2-5233ffc8e882: new RaftServerImpl for group-C5510B48FB6D:[7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247, da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799] with ContainerStateMachine:uninitialized
2019-06-14 10:27:24,474 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:24,476 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:24,476 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:24,476 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:24,476 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - da9925a9-e302-487a-a7c2-5233ffc8e882:group-C5510B48FB6D ConfigurationManager, init=-1: [7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247, da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:24,476 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-3/data/ratis] (custom)
2019-06-14 10:27:24,476 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-3/data/ratis/a4c922ec-45bd-44fe-8ce9-c5510b48fb6d does not exist. Creating ...
2019-06-14 10:27:24,478 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: addNew group-C5510B48FB6D:[7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247, da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799] returns group-C5510B48FB6D:java.util.concurrent.CompletableFuture@5a449830[Not completed]
2019-06-14 10:27:24,478 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: addNew group-C5510B48FB6D:[7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247, da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799] returns group-C5510B48FB6D:java.util.concurrent.CompletableFuture@79f93452[Not completed]
2019-06-14 10:27:24,478 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-3/data/ratis/a4c922ec-45bd-44fe-8ce9-c5510b48fb6d/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:24,479 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: new RaftServerImpl for group-C5510B48FB6D:[7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247, da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799] with ContainerStateMachine:uninitialized
2019-06-14 10:27:24,479 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:24,479 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:24,479 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:24,480 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:24,480 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D ConfigurationManager, init=-1: [7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247, da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:24,480 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-1/data/ratis] (custom)
2019-06-14 10:27:24,480 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: new RaftServerImpl for group-C5510B48FB6D:[7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247, da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799] with ContainerStateMachine:uninitialized
2019-06-14 10:27:24,480 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:24,480 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:24,480 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-1/data/ratis/a4c922ec-45bd-44fe-8ce9-c5510b48fb6d does not exist. Creating ...
2019-06-14 10:27:24,480 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:24,481 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:24,481 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d:group-C5510B48FB6D ConfigurationManager, init=-1: [7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247, da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:24,481 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-2/data/ratis] (custom)
2019-06-14 10:27:24,481 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-2/data/ratis/a4c922ec-45bd-44fe-8ce9-c5510b48fb6d does not exist. Creating ...
2019-06-14 10:27:24,482 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-3/data/ratis/a4c922ec-45bd-44fe-8ce9-c5510b48fb6d has been successfully formatted.
2019-06-14 10:27:24,482 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:24,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:24,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:24,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:24,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:24,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:24,483 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new da9925a9-e302-487a-a7c2-5233ffc8e882-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-3/data/ratis/a4c922ec-45bd-44fe-8ce9-c5510b48fb6d
2019-06-14 10:27:24,483 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:24,483 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:24,483 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:24,483 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:24,483 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:24,483 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:24,483 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:24,483 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-1/data/ratis/a4c922ec-45bd-44fe-8ce9-c5510b48fb6d/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:24,484 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-2/data/ratis/a4c922ec-45bd-44fe-8ce9-c5510b48fb6d/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:24,483 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:24,484 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:24,484 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:24,485 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:24,485 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:24,485 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:24,485 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - da9925a9-e302-487a-a7c2-5233ffc8e882: start group-C5510B48FB6D
2019-06-14 10:27:24,485 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - da9925a9-e302-487a-a7c2-5233ffc8e882:group-C5510B48FB6D changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:24,485 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - da9925a9-e302-487a-a7c2-5233ffc8e882: start FollowerState
2019-06-14 10:27:24,485 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C5510B48FB6D,id=da9925a9-e302-487a-a7c2-5233ffc8e882
2019-06-14 10:27:24,486 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-2/data/ratis/a4c922ec-45bd-44fe-8ce9-c5510b48fb6d has been successfully formatted.
2019-06-14 10:27:24,486 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:24,486 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:24,486 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:24,486 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:24,486 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:24,486 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:24,487 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 7532b1c1-eee6-40f9-81b4-f2c881484f0d-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-2/data/ratis/a4c922ec-45bd-44fe-8ce9-c5510b48fb6d
2019-06-14 10:27:24,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:24,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:24,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:24,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:24,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:24,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:24,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:24,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:24,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:24,486 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-1/data/ratis/a4c922ec-45bd-44fe-8ce9-c5510b48fb6d has been successfully formatted.
2019-06-14 10:27:24,488 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:24,488 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:24,488 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:24,488 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:24,488 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:24,488 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:24,488 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new a0eb4e14-4e55-404d-acf1-1f052f7ff9fb-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-1/data/ratis/a4c922ec-45bd-44fe-8ce9-c5510b48fb6d
2019-06-14 10:27:24,488 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:24,489 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:24,489 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:24,489 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:24,489 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:24,489 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:24,489 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:24,489 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:24,489 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:24,490 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:24,491 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:24,491 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:24,491 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:24,491 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: start group-C5510B48FB6D
2019-06-14 10:27:24,491 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:24,491 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: start FollowerState
2019-06-14 10:27:24,492 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:24,493 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 5cb89b60-561f-4d51-91d3-1a386bffeb6b{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:27:24,494 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:24,494 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C5510B48FB6D,id=a0eb4e14-4e55-404d-acf1-1f052f7ff9fb
2019-06-14 10:27:24,494 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:24,494 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:24,494 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: start group-C5510B48FB6D
2019-06-14 10:27:24,495 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d:group-C5510B48FB6D changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:24,496 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: start FollowerState
2019-06-14 10:27:24,505 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C5510B48FB6D,id=7532b1c1-eee6-40f9-81b4-f2c881484f0d
2019-06-14 10:27:24,515 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: a4c922ec-45bd-44fe-8ce9-c5510b48fb6d, Nodes: da9925a9-e302-487a-a7c2-5233ffc8e882{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}7532b1c1-eee6-40f9-81b4-f2c881484f0d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}a0eb4e14-4e55-404d-acf1-1f052f7ff9fb{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-14 10:27:24,527 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: addNew group-814B4970B58E:[5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999] returns group-814B4970B58E:java.util.concurrent.CompletableFuture@50bcf340[Not completed]
2019-06-14 10:27:24,527 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: new RaftServerImpl for group-814B4970B58E:[5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999] with ContainerStateMachine:uninitialized
2019-06-14 10:27:24,528 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:24,528 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:24,528 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:24,528 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:24,528 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b:group-814B4970B58E ConfigurationManager, init=-1: [5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:24,528 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-4/data/ratis] (custom)
2019-06-14 10:27:24,529 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-4/data/ratis/f63a0309-0435-47a3-bd04-814b4970b58e does not exist. Creating ...
2019-06-14 10:27:24,531 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-4/data/ratis/f63a0309-0435-47a3-bd04-814b4970b58e/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:24,533 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-4/data/ratis/f63a0309-0435-47a3-bd04-814b4970b58e has been successfully formatted.
2019-06-14 10:27:24,533 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:24,534 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:24,534 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:24,534 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:24,534 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:24,534 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:24,534 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 5cb89b60-561f-4d51-91d3-1a386bffeb6b-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-4/data/ratis/f63a0309-0435-47a3-bd04-814b4970b58e
2019-06-14 10:27:24,534 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:24,534 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:24,534 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:24,534 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:24,534 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:24,535 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:24,535 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:24,535 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:24,535 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:24,535 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:24,535 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:24,535 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:24,535 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:24,535 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: start group-814B4970B58E
2019-06-14 10:27:24,536 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b:group-814B4970B58E changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:24,536 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: start FollowerState
2019-06-14 10:27:24,536 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-814B4970B58E,id=5cb89b60-561f-4d51-91d3-1a386bffeb6b
2019-06-14 10:27:24,541 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: f63a0309-0435-47a3-bd04-814b4970b58e, Nodes: 5cb89b60-561f-4d51-91d3-1a386bffeb6b{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:27:24,668 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 5 of 6 DN Heartbeats.
2019-06-14 10:27:24,672 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 7bba2558-4743-447d-9e01-b6a234175195{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:27:24,686 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 7bba2558-4743-447d-9e01-b6a234175195: addNew group-7A9664CDC12C:[7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305] returns group-7A9664CDC12C:java.util.concurrent.CompletableFuture@24e1a3e1[Not completed]
2019-06-14 10:27:24,686 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 7bba2558-4743-447d-9e01-b6a234175195: new RaftServerImpl for group-7A9664CDC12C:[7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305] with ContainerStateMachine:uninitialized
2019-06-14 10:27:24,686 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:24,686 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:24,687 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:24,687 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:24,687 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 7bba2558-4743-447d-9e01-b6a234175195:group-7A9664CDC12C ConfigurationManager, init=-1: [7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:24,687 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-5/data/ratis] (custom)
2019-06-14 10:27:24,687 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-5/data/ratis/8e7e092b-4bff-440c-bfed-7a9664cdc12c does not exist. Creating ...
2019-06-14 10:27:24,689 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-5/data/ratis/8e7e092b-4bff-440c-bfed-7a9664cdc12c/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:24,692 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-5/data/ratis/8e7e092b-4bff-440c-bfed-7a9664cdc12c has been successfully formatted.
2019-06-14 10:27:24,692 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:24,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:24,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:24,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:24,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:24,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:24,692 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 7bba2558-4743-447d-9e01-b6a234175195-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-5/data/ratis/8e7e092b-4bff-440c-bfed-7a9664cdc12c
2019-06-14 10:27:24,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:24,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:24,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:24,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:24,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:24,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:24,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:24,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:24,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:24,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:24,694 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:24,694 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:24,694 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:24,694 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 7bba2558-4743-447d-9e01-b6a234175195: start group-7A9664CDC12C
2019-06-14 10:27:24,694 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7bba2558-4743-447d-9e01-b6a234175195:group-7A9664CDC12C changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:24,694 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7bba2558-4743-447d-9e01-b6a234175195: start FollowerState
2019-06-14 10:27:24,694 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-7A9664CDC12C,id=7bba2558-4743-447d-9e01-b6a234175195
2019-06-14 10:27:24,699 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 8e7e092b-4bff-440c-bfed-7a9664cdc12c, Nodes: 7bba2558-4743-447d-9e01-b6a234175195{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:27:24,718 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 7bba2558-4743-447d-9e01-b6a234175195: addNew group-A890AFBAA66E:[7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305, 5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999, 227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877] returns group-A890AFBAA66E:java.util.concurrent.CompletableFuture@9b6a595[Not completed]
2019-06-14 10:27:24,719 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 7bba2558-4743-447d-9e01-b6a234175195: new RaftServerImpl for group-A890AFBAA66E:[7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305, 5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999, 227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877] with ContainerStateMachine:uninitialized
2019-06-14 10:27:24,719 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: addNew group-A890AFBAA66E:[7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305, 5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999, 227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877] returns group-A890AFBAA66E:java.util.concurrent.CompletableFuture@41c59801[Not completed]
2019-06-14 10:27:24,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:24,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:24,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:24,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:24,719 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 7bba2558-4743-447d-9e01-b6a234175195:group-A890AFBAA66E ConfigurationManager, init=-1: [7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305, 5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999, 227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:24,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-5/data/ratis] (custom)
2019-06-14 10:27:24,720 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: new RaftServerImpl for group-A890AFBAA66E:[7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305, 5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999, 227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877] with ContainerStateMachine:uninitialized
2019-06-14 10:27:24,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:24,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:24,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:24,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:24,721 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: addNew group-A890AFBAA66E:[7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305, 5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999, 227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877] returns group-A890AFBAA66E:java.util.concurrent.CompletableFuture@7591887c[Not completed]
2019-06-14 10:27:24,721 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b:group-A890AFBAA66E ConfigurationManager, init=-1: [7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305, 5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999, 227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:24,722 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-5/data/ratis/510e86c6-50de-4e75-8368-a890afbaa66e does not exist. Creating ...
2019-06-14 10:27:24,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-4/data/ratis] (custom)
2019-06-14 10:27:24,722 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: new RaftServerImpl for group-A890AFBAA66E:[7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305, 5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999, 227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877] with ContainerStateMachine:uninitialized
2019-06-14 10:27:24,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:24,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:24,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:24,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:24,722 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd:group-A890AFBAA66E ConfigurationManager, init=-1: [7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305, 5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999, 227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:24,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-0/data/ratis] (custom)
2019-06-14 10:27:24,723 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-0/data/ratis/510e86c6-50de-4e75-8368-a890afbaa66e does not exist. Creating ...
2019-06-14 10:27:24,722 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-4/data/ratis/510e86c6-50de-4e75-8368-a890afbaa66e does not exist. Creating ...
2019-06-14 10:27:24,725 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-0/data/ratis/510e86c6-50de-4e75-8368-a890afbaa66e/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:24,725 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-4/data/ratis/510e86c6-50de-4e75-8368-a890afbaa66e/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:24,728 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-0/data/ratis/510e86c6-50de-4e75-8368-a890afbaa66e has been successfully formatted.
2019-06-14 10:27:24,728 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:24,728 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:24,728 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:24,728 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:24,728 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:24,728 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:24,728 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 227a6fd9-6137-4d19-bf85-40110cf9fabd-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-0/data/ratis/510e86c6-50de-4e75-8368-a890afbaa66e
2019-06-14 10:27:24,729 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:24,729 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:24,728 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-4/data/ratis/510e86c6-50de-4e75-8368-a890afbaa66e has been successfully formatted.
2019-06-14 10:27:24,729 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:24,729 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:24,729 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:24,729 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:24,729 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:24,729 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:24,730 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 5cb89b60-561f-4d51-91d3-1a386bffeb6b-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-4/data/ratis/510e86c6-50de-4e75-8368-a890afbaa66e
2019-06-14 10:27:24,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:24,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:24,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:24,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:24,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:24,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:24,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:24,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:24,731 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:24,731 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:24,729 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:24,729 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-5/data/ratis/510e86c6-50de-4e75-8368-a890afbaa66e/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:24,731 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:24,731 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:24,732 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:24,732 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: start group-A890AFBAA66E
2019-06-14 10:27:24,732 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b:group-A890AFBAA66E changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:24,732 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: start FollowerState
2019-06-14 10:27:24,731 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:24,732 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:24,732 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-A890AFBAA66E,id=5cb89b60-561f-4d51-91d3-1a386bffeb6b
2019-06-14 10:27:24,732 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:24,733 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:24,733 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:24,733 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:24,733 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:24,734 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:24,739 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:24,739 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:24,739 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: start group-A890AFBAA66E
2019-06-14 10:27:24,739 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd:group-A890AFBAA66E changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:24,739 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: start FollowerState
2019-06-14 10:27:24,740 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-A890AFBAA66E,id=227a6fd9-6137-4d19-bf85-40110cf9fabd
2019-06-14 10:27:24,740 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-5/data/ratis/510e86c6-50de-4e75-8368-a890afbaa66e has been successfully formatted.
2019-06-14 10:27:24,742 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:24,742 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:24,742 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:24,742 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:24,754 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:24,754 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:24,755 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 7bba2558-4743-447d-9e01-b6a234175195-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-5/data/ratis/510e86c6-50de-4e75-8368-a890afbaa66e
2019-06-14 10:27:24,755 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:24,755 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:24,755 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:24,755 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:24,755 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:24,756 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:24,756 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:24,756 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:24,756 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:24,756 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:24,756 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:24,756 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:24,756 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:24,757 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 7bba2558-4743-447d-9e01-b6a234175195: start group-A890AFBAA66E
2019-06-14 10:27:24,757 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7bba2558-4743-447d-9e01-b6a234175195:group-A890AFBAA66E changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:24,757 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7bba2558-4743-447d-9e01-b6a234175195: start FollowerState
2019-06-14 10:27:24,757 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-A890AFBAA66E,id=7bba2558-4743-447d-9e01-b6a234175195
2019-06-14 10:27:24,766 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 510e86c6-50de-4e75-8368-a890afbaa66e, Nodes: 5cb89b60-561f-4d51-91d3-1a386bffeb6b{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}227a6fd9-6137-4d19-bf85-40110cf9fabd{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}7bba2558-4743-447d-9e01-b6a234175195{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-14 10:27:25,363 INFO  impl.FollowerState (FollowerState.java:run(101)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd:group-B02FBD1AF667 changes to CANDIDATE, lastRpcTime:1132, electionTimeout:1132ms
2019-06-14 10:27:25,363 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: shutdown FollowerState
2019-06-14 10:27:25,363 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd:group-B02FBD1AF667 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:25,365 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: start LeaderElection
2019-06-14 10:27:25,374 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd:group-B02FBD1AF667:LeaderElection1: begin an election at term 1 for -1: [227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877], old=null
2019-06-14 10:27:25,376 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: shutdown LeaderElection
2019-06-14 10:27:25,376 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd:group-B02FBD1AF667 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:27:25,376 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd:group-B02FBD1AF667 change Leader from null to 227a6fd9-6137-4d19-bf85-40110cf9fabd at term 1 for becomeLeader, leader elected after 1358ms
2019-06-14 10:27:25,379 INFO  impl.FollowerState (FollowerState.java:run(101)) - da9925a9-e302-487a-a7c2-5233ffc8e882:group-E8F75B76E96D changes to CANDIDATE, lastRpcTime:1069, electionTimeout:1068ms
2019-06-14 10:27:25,380 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - da9925a9-e302-487a-a7c2-5233ffc8e882: shutdown FollowerState
2019-06-14 10:27:25,381 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - da9925a9-e302-487a-a7c2-5233ffc8e882:group-E8F75B76E96D changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:25,381 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - da9925a9-e302-487a-a7c2-5233ffc8e882: start LeaderElection
2019-06-14 10:27:25,382 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:27:25,382 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:27:25,388 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:27:25,388 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:27:25,388 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - da9925a9-e302-487a-a7c2-5233ffc8e882:group-E8F75B76E96D:LeaderElection2: begin an election at term 1 for -1: [da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667], old=null
2019-06-14 10:27:25,389 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - da9925a9-e302-487a-a7c2-5233ffc8e882: shutdown LeaderElection
2019-06-14 10:27:25,389 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - da9925a9-e302-487a-a7c2-5233ffc8e882:group-E8F75B76E96D changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:27:25,389 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - da9925a9-e302-487a-a7c2-5233ffc8e882:group-E8F75B76E96D change Leader from null to da9925a9-e302-487a-a7c2-5233ffc8e882 at term 1 for becomeLeader, leader elected after 1085ms
2019-06-14 10:27:25,390 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:27:25,390 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:27:25,390 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:27:25,390 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:27:25,396 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: start LeaderState
2019-06-14 10:27:25,396 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - da9925a9-e302-487a-a7c2-5233ffc8e882: start LeaderState
2019-06-14 10:27:25,412 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - da9925a9-e302-487a-a7c2-5233ffc8e882-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:25,412 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:25,419 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd:group-B02FBD1AF667 set configuration 0: [227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877], old=null at 0
2019-06-14 10:27:25,421 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - da9925a9-e302-487a-a7c2-5233ffc8e882:group-E8F75B76E96D set configuration 0: [da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667], old=null at 0
2019-06-14 10:27:25,515 INFO  impl.FollowerState (FollowerState.java:run(101)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-9D6BC50045DC changes to CANDIDATE, lastRpcTime:1083, electionTimeout:1083ms
2019-06-14 10:27:25,515 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: shutdown FollowerState
2019-06-14 10:27:25,515 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-9D6BC50045DC changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:25,515 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: start LeaderElection
2019-06-14 10:27:25,525 INFO  impl.FollowerState (FollowerState.java:run(101)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d:group-C5510B48FB6D changes to CANDIDATE, lastRpcTime:1030, electionTimeout:1011ms
2019-06-14 10:27:25,526 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: shutdown FollowerState
2019-06-14 10:27:25,526 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d:group-C5510B48FB6D changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:25,526 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: start LeaderElection
2019-06-14 10:27:25,533 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-9D6BC50045DC:LeaderElection3: begin an election at term 1 for -1: [a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799], old=null
2019-06-14 10:27:25,533 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: shutdown LeaderElection
2019-06-14 10:27:25,533 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-9D6BC50045DC changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:27:25,535 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-9D6BC50045DC change Leader from null to a0eb4e14-4e55-404d-acf1-1f052f7ff9fb at term 1 for becomeLeader, leader elected after 1104ms
2019-06-14 10:27:25,535 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d:group-C5510B48FB6D:LeaderElection4: begin an election at term 1 for -1: [7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247, da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799], old=null
2019-06-14 10:27:25,538 INFO  impl.FollowerState (FollowerState.java:run(101)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d:group-F56F5462F812 changes to CANDIDATE, lastRpcTime:1144, electionTimeout:1144ms
2019-06-14 10:27:25,538 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: shutdown FollowerState
2019-06-14 10:27:25,538 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d:group-F56F5462F812 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:25,538 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: start LeaderElection
2019-06-14 10:27:25,538 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:27:25,549 INFO  impl.FollowerState (FollowerState.java:run(101)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b:group-814B4970B58E changes to CANDIDATE, lastRpcTime:1013, electionTimeout:1013ms
2019-06-14 10:27:25,549 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: shutdown FollowerState
2019-06-14 10:27:25,549 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b:group-814B4970B58E changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:25,553 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:27:25,553 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: start LeaderElection
2019-06-14 10:27:25,554 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:27:25,554 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:27:25,554 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: start LeaderState
2019-06-14 10:27:25,554 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:25,565 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-9D6BC50045DC set configuration 0: [a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799], old=null at 0
2019-06-14 10:27:25,580 INFO  impl.FollowerState (FollowerState.java:run(101)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D changes to CANDIDATE, lastRpcTime:1088, electionTimeout:1081ms
2019-06-14 10:27:25,580 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d:group-F56F5462F812:LeaderElection5: begin an election at term 1 for -1: [7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247], old=null
2019-06-14 10:27:25,580 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: shutdown FollowerState
2019-06-14 10:27:25,580 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: shutdown LeaderElection
2019-06-14 10:27:25,580 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:25,580 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: start LeaderElection
2019-06-14 10:27:25,580 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d:group-F56F5462F812 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:27:25,580 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d:group-F56F5462F812 change Leader from null to 7532b1c1-eee6-40f9-81b4-f2c881484f0d at term 1 for becomeLeader, leader elected after 1190ms
2019-06-14 10:27:25,582 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b:group-814B4970B58E:LeaderElection6: begin an election at term 1 for -1: [5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999], old=null
2019-06-14 10:27:25,583 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: shutdown LeaderElection
2019-06-14 10:27:25,583 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b:group-814B4970B58E changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:27:25,583 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b:group-814B4970B58E change Leader from null to 5cb89b60-561f-4d51-91d3-1a386bffeb6b at term 1 for becomeLeader, leader elected after 1049ms
2019-06-14 10:27:25,594 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:27:25,594 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:27:25,594 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:27:25,594 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:27:25,595 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:27:25,595 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: start LeaderState
2019-06-14 10:27:25,595 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:25,596 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:27:25,597 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b:group-814B4970B58E set configuration 0: [5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999], old=null at 0
2019-06-14 10:27:25,600 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:27:25,600 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:27:25,600 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: start LeaderState
2019-06-14 10:27:25,600 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:25,601 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d:group-F56F5462F812 set configuration 0: [7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247], old=null at 0
2019-06-14 10:27:25,604 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D:LeaderElection7: begin an election at term 1 for -1: [7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247, da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799], old=null
2019-06-14 10:27:25,604 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - da9925a9-e302-487a-a7c2-5233ffc8e882:group-C5510B48FB6D changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:7532b1c1-eee6-40f9-81b4-f2c881484f0d
2019-06-14 10:27:25,604 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - da9925a9-e302-487a-a7c2-5233ffc8e882: shutdown FollowerState
2019-06-14 10:27:25,604 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - da9925a9-e302-487a-a7c2-5233ffc8e882: start FollowerState
2019-06-14 10:27:25,604 INFO  impl.FollowerState (FollowerState.java:run(109)) - da9925a9-e302-487a-a7c2-5233ffc8e882: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:27:25,701 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d:group-C5510B48FB6D:LeaderElection4: Election PASSED; received 1 response(s) [7532b1c1-eee6-40f9-81b4-f2c881484f0d->da9925a9-e302-487a-a7c2-5233ffc8e882,true-t1] and 0 exception(s); 7532b1c1-eee6-40f9-81b4-f2c881484f0d:t1, leader=null, voted=7532b1c1-eee6-40f9-81b4-f2c881484f0d, raftlog=7532b1c1-eee6-40f9-81b4-f2c881484f0d-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247, da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799], old=null
2019-06-14 10:27:25,702 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: shutdown LeaderElection
2019-06-14 10:27:25,702 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d:group-C5510B48FB6D changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:27:25,702 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d:group-C5510B48FB6D change Leader from null to 7532b1c1-eee6-40f9-81b4-f2c881484f0d at term 1 for becomeLeader, leader elected after 1215ms
2019-06-14 10:27:25,702 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:27:25,702 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:27:25,702 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:27:25,702 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:27:25,705 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:27:25,705 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:25,705 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - da9925a9-e302-487a-a7c2-5233ffc8e882-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-3/data/ratis/f6cb7eac-b0f5-48c2-b40f-e8f75b76e96d/current/log_inprogress_0
2019-06-14 10:27:25,762 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-0/data/ratis/672f2670-c3ca-4779-8cf3-b02fbd1af667/current/log_inprogress_0
2019-06-14 10:27:25,758 INFO  impl.FollowerState (FollowerState.java:run(101)) - 7bba2558-4743-447d-9e01-b6a234175195:group-7A9664CDC12C changes to CANDIDATE, lastRpcTime:1063, electionTimeout:1063ms
2019-06-14 10:27:25,762 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 7bba2558-4743-447d-9e01-b6a234175195: shutdown FollowerState
2019-06-14 10:27:25,762 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7bba2558-4743-447d-9e01-b6a234175195:group-7A9664CDC12C changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:25,742 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Cluster is ready. Got 6 of 6 DN Heartbeats.
2019-06-14 10:27:25,705 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:27:25,779 INFO  impl.FollowerState (FollowerState.java:run(101)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b:group-A890AFBAA66E changes to CANDIDATE, lastRpcTime:1030, electionTimeout:1030ms
2019-06-14 10:27:25,806 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: shutdown FollowerState
2019-06-14 10:27:25,806 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b:group-A890AFBAA66E changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:25,806 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: start LeaderElection
2019-06-14 10:27:25,779 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-4/data/ratis/f63a0309-0435-47a3-bd04-814b4970b58e/current/log_inprogress_0
2019-06-14 10:27:25,763 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7bba2558-4743-447d-9e01-b6a234175195: start LeaderElection
2019-06-14 10:27:25,804 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-1/data/ratis/ab524387-db58-42a2-bf7e-9d6bc50045dc/current/log_inprogress_0
2019-06-14 10:27:25,803 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:27:25,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:25,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:25,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:27:25,808 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:25,808 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:27:25,808 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:27:25,809 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:25,809 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:25,809 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: start LeaderState
2019-06-14 10:27:25,809 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:25,811 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-2/data/ratis/07582538-a144-4af0-8a6f-f56f5462f812/current/log_inprogress_0
2019-06-14 10:27:25,811 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d:group-C5510B48FB6D set configuration 0: [7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247, da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799], old=null at 0
2019-06-14 10:27:25,852 INFO  impl.RaftServerImpl (RaftServerImpl.java:requestVote(738)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d-LEADER: Withhold vote from candidate a0eb4e14-4e55-404d-acf1-1f052f7ff9fb with term 1. State: leader=7532b1c1-eee6-40f9-81b4-f2c881484f0d, term=1, lastRpcElapsed=null
2019-06-14 10:27:25,864 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-2/data/ratis/a4c922ec-45bd-44fe-8ce9-c5510b48fb6d/current/log_inprogress_0
2019-06-14 10:27:25,872 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b:group-A890AFBAA66E:LeaderElection9: begin an election at term 1 for -1: [7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305, 5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999, 227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877], old=null
2019-06-14 10:27:25,873 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 7bba2558-4743-447d-9e01-b6a234175195:group-7A9664CDC12C:LeaderElection8: begin an election at term 1 for -1: [7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305], old=null
2019-06-14 10:27:25,873 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 7bba2558-4743-447d-9e01-b6a234175195: shutdown LeaderElection
2019-06-14 10:27:25,873 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7bba2558-4743-447d-9e01-b6a234175195:group-7A9664CDC12C changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:27:25,873 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 7bba2558-4743-447d-9e01-b6a234175195:group-7A9664CDC12C change Leader from null to 7bba2558-4743-447d-9e01-b6a234175195 at term 1 for becomeLeader, leader elected after 1181ms
2019-06-14 10:27:25,881 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - da9925a9-e302-487a-a7c2-5233ffc8e882:group-C5510B48FB6D change Leader from null to 7532b1c1-eee6-40f9-81b4-f2c881484f0d at term 1 for appendEntries, leader elected after 1398ms
2019-06-14 10:27:25,887 INFO  impl.FollowerState (FollowerState.java:run(101)) - 7bba2558-4743-447d-9e01-b6a234175195:group-A890AFBAA66E changes to CANDIDATE, lastRpcTime:1129, electionTimeout:1128ms
2019-06-14 10:27:25,887 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 7bba2558-4743-447d-9e01-b6a234175195: shutdown FollowerState
2019-06-14 10:27:25,887 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7bba2558-4743-447d-9e01-b6a234175195:group-A890AFBAA66E changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:25,887 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7bba2558-4743-447d-9e01-b6a234175195: start LeaderElection
2019-06-14 10:27:25,889 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:27:25,890 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:27:25,890 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:27:25,890 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:27:25,890 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7bba2558-4743-447d-9e01-b6a234175195: start LeaderState
2019-06-14 10:27:25,890 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 7bba2558-4743-447d-9e01-b6a234175195-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:25,891 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 7bba2558-4743-447d-9e01-b6a234175195:group-7A9664CDC12C set configuration 0: [7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305], old=null at 0
2019-06-14 10:27:25,913 INFO  impl.FollowerState (FollowerState.java:run(101)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd:group-A890AFBAA66E changes to CANDIDATE, lastRpcTime:1173, electionTimeout:1152ms
2019-06-14 10:27:25,914 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: shutdown FollowerState
2019-06-14 10:27:25,914 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd:group-A890AFBAA66E changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:25,914 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: start LeaderElection
2019-06-14 10:27:25,914 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D changes role from CANDIDATE to FOLLOWER at term 1 for appendEntries
2019-06-14 10:27:25,915 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: shutdown LeaderElection
2019-06-14 10:27:25,915 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: start FollowerState
2019-06-14 10:27:25,914 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D:LeaderElection7: Election REJECTED; received 2 response(s) [a0eb4e14-4e55-404d-acf1-1f052f7ff9fb->7532b1c1-eee6-40f9-81b4-f2c881484f0d,false-t1, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb->da9925a9-e302-487a-a7c2-5233ffc8e882,false-t1] and 0 exception(s); a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:t1, leader=null, voted=a0eb4e14-4e55-404d-acf1-1f052f7ff9fb, raftlog=a0eb4e14-4e55-404d-acf1-1f052f7ff9fb-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247, da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799], old=null
2019-06-14 10:27:25,924 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D change Leader from null to 7532b1c1-eee6-40f9-81b4-f2c881484f0d at term 1 for appendEntries, leader elected after 1435ms
2019-06-14 10:27:25,948 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 7bba2558-4743-447d-9e01-b6a234175195:group-A890AFBAA66E:LeaderElection10: begin an election at term 1 for -1: [7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305, 5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999, 227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877], old=null
2019-06-14 10:27:25,950 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 7bba2558-4743-447d-9e01-b6a234175195-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-5/data/ratis/8e7e092b-4bff-440c-bfed-7a9664cdc12c/current/log_inprogress_0
2019-06-14 10:27:25,950 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd:group-A890AFBAA66E:LeaderElection11: begin an election at term 1 for -1: [7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305, 5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999, 227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877], old=null
2019-06-14 10:27:25,981 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b:group-A890AFBAA66E:LeaderElection9: Election REJECTED; received 2 response(s) [5cb89b60-561f-4d51-91d3-1a386bffeb6b->7bba2558-4743-447d-9e01-b6a234175195,false-t1, 5cb89b60-561f-4d51-91d3-1a386bffeb6b->227a6fd9-6137-4d19-bf85-40110cf9fabd,false-t1] and 0 exception(s); 5cb89b60-561f-4d51-91d3-1a386bffeb6b:t1, leader=null, voted=5cb89b60-561f-4d51-91d3-1a386bffeb6b, raftlog=5cb89b60-561f-4d51-91d3-1a386bffeb6b-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305, 5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999, 227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877], old=null
2019-06-14 10:27:25,981 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b:group-A890AFBAA66E changes role from CANDIDATE to FOLLOWER at term 1 for DISCOVERED_A_NEW_TERM
2019-06-14 10:27:25,982 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: shutdown LeaderElection
2019-06-14 10:27:25,987 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D set configuration 0: [7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247, da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799], old=null at 0
2019-06-14 10:27:25,999 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:25,997 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: start FollowerState
2019-06-14 10:27:26,022 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - da9925a9-e302-487a-a7c2-5233ffc8e882:group-C5510B48FB6D set configuration 0: [7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247, da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799], old=null at 0
2019-06-14 10:27:26,022 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - da9925a9-e302-487a-a7c2-5233ffc8e882-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:26,050 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-1/data/ratis/a4c922ec-45bd-44fe-8ce9-c5510b48fb6d/current/log_inprogress_0
2019-06-14 10:27:26,074 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd:group-A890AFBAA66E:LeaderElection11: Election REJECTED; received 2 response(s) [227a6fd9-6137-4d19-bf85-40110cf9fabd->7bba2558-4743-447d-9e01-b6a234175195,false-t1, 227a6fd9-6137-4d19-bf85-40110cf9fabd->5cb89b60-561f-4d51-91d3-1a386bffeb6b,false-t1] and 0 exception(s); 227a6fd9-6137-4d19-bf85-40110cf9fabd:t1, leader=null, voted=227a6fd9-6137-4d19-bf85-40110cf9fabd, raftlog=227a6fd9-6137-4d19-bf85-40110cf9fabd-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305, 5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999, 227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877], old=null
2019-06-14 10:27:26,074 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 7bba2558-4743-447d-9e01-b6a234175195:group-A890AFBAA66E:LeaderElection10: Election REJECTED; received 2 response(s) [7bba2558-4743-447d-9e01-b6a234175195->227a6fd9-6137-4d19-bf85-40110cf9fabd,false-t1, 7bba2558-4743-447d-9e01-b6a234175195->5cb89b60-561f-4d51-91d3-1a386bffeb6b,false-t1] and 0 exception(s); 7bba2558-4743-447d-9e01-b6a234175195:t1, leader=null, voted=7bba2558-4743-447d-9e01-b6a234175195, raftlog=7bba2558-4743-447d-9e01-b6a234175195-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305, 5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999, 227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877], old=null
2019-06-14 10:27:26,074 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7bba2558-4743-447d-9e01-b6a234175195:group-A890AFBAA66E changes role from CANDIDATE to FOLLOWER at term 1 for DISCOVERED_A_NEW_TERM
2019-06-14 10:27:26,074 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd:group-A890AFBAA66E changes role from CANDIDATE to FOLLOWER at term 1 for DISCOVERED_A_NEW_TERM
2019-06-14 10:27:26,093 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: shutdown LeaderElection
2019-06-14 10:27:26,074 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 7bba2558-4743-447d-9e01-b6a234175195: shutdown LeaderElection
2019-06-14 10:27:26,094 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: start FollowerState
2019-06-14 10:27:26,094 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7bba2558-4743-447d-9e01-b6a234175195: start FollowerState
2019-06-14 10:27:26,096 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - da9925a9-e302-487a-a7c2-5233ffc8e882-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-3/data/ratis/a4c922ec-45bd-44fe-8ce9-c5510b48fb6d/current/log_inprogress_0
2019-06-14 10:27:26,274 INFO  rpc.RpcClient (RpcClient.java:createVolume(289)) - Creating Volume: datanodefailurehandlingtest, with root as owner.
2019-06-14 10:27:26,307 INFO  rpc.RpcClient (RpcClient.java:createBucket(426)) - Creating Bucket: datanodefailurehandlingtest/datanodefailurehandlingtest, with Versioning false and Storage Type set to DISK and Encryption set to false 
2019-06-14 10:27:26,495 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-D39DE47DD13C->da9925a9-e302-487a-a7c2-5233ffc8e882: receive RaftClientReply:client-D39DE47DD13C->da9925a9-e302-487a-a7c2-5233ffc8e882@group-C5510B48FB6D, cid=12, FAILED org.apache.ratis.protocol.NotLeaderException: Server da9925a9-e302-487a-a7c2-5233ffc8e882 is not the leader (7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247). Request must be sent to leader., logIndex=0, commits[da9925a9-e302-487a-a7c2-5233ffc8e882:c0, 7532b1c1-eee6-40f9-81b4-f2c881484f0d:c0, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:c-1]
2019-06-14 10:27:26,507 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:27:27,218 INFO  impl.FollowerState (FollowerState.java:run(101)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b:group-A890AFBAA66E changes to CANDIDATE, lastRpcTime:1221, electionTimeout:1165ms
2019-06-14 10:27:27,219 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: shutdown FollowerState
2019-06-14 10:27:27,219 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b:group-A890AFBAA66E changes role from FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2019-06-14 10:27:27,220 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: start LeaderElection
2019-06-14 10:27:27,224 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b:group-A890AFBAA66E:LeaderElection12: begin an election at term 2 for -1: [7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305, 5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999, 227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877], old=null
2019-06-14 10:27:27,227 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7bba2558-4743-447d-9e01-b6a234175195:group-A890AFBAA66E changes role from FOLLOWER to FOLLOWER at term 2 for recognizeCandidate:5cb89b60-561f-4d51-91d3-1a386bffeb6b
2019-06-14 10:27:27,227 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 7bba2558-4743-447d-9e01-b6a234175195: shutdown FollowerState
2019-06-14 10:27:27,228 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7bba2558-4743-447d-9e01-b6a234175195: start FollowerState
2019-06-14 10:27:27,228 INFO  impl.FollowerState (FollowerState.java:run(109)) - 7bba2558-4743-447d-9e01-b6a234175195: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:27:27,232 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd:group-A890AFBAA66E changes role from FOLLOWER to FOLLOWER at term 2 for recognizeCandidate:5cb89b60-561f-4d51-91d3-1a386bffeb6b
2019-06-14 10:27:27,232 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: shutdown FollowerState
2019-06-14 10:27:27,232 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: start FollowerState
2019-06-14 10:27:27,232 INFO  impl.FollowerState (FollowerState.java:run(109)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:27:27,240 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b:group-A890AFBAA66E:LeaderElection12: Election PASSED; received 1 response(s) [5cb89b60-561f-4d51-91d3-1a386bffeb6b->7bba2558-4743-447d-9e01-b6a234175195,true-t2] and 0 exception(s); 5cb89b60-561f-4d51-91d3-1a386bffeb6b:t2, leader=null, voted=5cb89b60-561f-4d51-91d3-1a386bffeb6b, raftlog=5cb89b60-561f-4d51-91d3-1a386bffeb6b-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305, 5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999, 227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877], old=null
2019-06-14 10:27:27,240 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: shutdown LeaderElection
2019-06-14 10:27:27,240 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b:group-A890AFBAA66E changes role from CANDIDATE to LEADER at term 2 for changeToLeader
2019-06-14 10:27:27,242 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b:group-A890AFBAA66E change Leader from null to 5cb89b60-561f-4d51-91d3-1a386bffeb6b at term 2 for becomeLeader, leader elected after 2513ms
2019-06-14 10:27:27,242 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:27:27,242 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:27:27,242 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:27:27,242 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:27:27,243 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:27:27,243 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:27,243 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:27:27,243 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:27:27,243 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:27,243 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:27,244 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:27:27,244 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:27,244 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:27:27,244 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:27:27,244 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:27,244 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:27,244 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: start LeaderState
2019-06-14 10:27:27,245 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:27,247 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 7bba2558-4743-447d-9e01-b6a234175195:group-A890AFBAA66E change Leader from null to 5cb89b60-561f-4d51-91d3-1a386bffeb6b at term 2 for appendEntries, leader elected after 2505ms
2019-06-14 10:27:27,264 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b:group-A890AFBAA66E set configuration 0: [7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305, 5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999, 227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877], old=null at 0
2019-06-14 10:27:27,284 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-4/data/ratis/510e86c6-50de-4e75-8368-a890afbaa66e/current/log_inprogress_0
2019-06-14 10:27:27,291 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd:group-A890AFBAA66E change Leader from null to 5cb89b60-561f-4d51-91d3-1a386bffeb6b at term 2 for appendEntries, leader elected after 2563ms
2019-06-14 10:27:27,296 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 7bba2558-4743-447d-9e01-b6a234175195:group-A890AFBAA66E set configuration 0: [7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305, 5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999, 227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877], old=null at 0
2019-06-14 10:27:27,296 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd:group-A890AFBAA66E set configuration 0: [7bba2558-4743-447d-9e01-b6a234175195:192.168.46.40:38305, 5cb89b60-561f-4d51-91d3-1a386bffeb6b:192.168.46.40:37999, 227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877], old=null at 0
2019-06-14 10:27:27,296 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 7bba2558-4743-447d-9e01-b6a234175195-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:27,296 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:27,338 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-0/data/ratis/510e86c6-50de-4e75-8368-a890afbaa66e/current/log_inprogress_0
2019-06-14 10:27:27,343 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 7bba2558-4743-447d-9e01-b6a234175195-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-5/data/ratis/510e86c6-50de-4e75-8368-a890afbaa66e/current/log_inprogress_0
2019-06-14 10:27:27,520 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-D39DE47DD13C->a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: receive RaftClientReply:client-D39DE47DD13C->a0eb4e14-4e55-404d-acf1-1f052f7ff9fb@group-C5510B48FB6D, cid=12, FAILED org.apache.ratis.protocol.NotLeaderException: Server a0eb4e14-4e55-404d-acf1-1f052f7ff9fb is not the leader (7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247). Request must be sent to leader., logIndex=0, commits[a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:c0, 7532b1c1-eee6-40f9-81b4-f2c881484f0d:c0, da9925a9-e302-487a-a7c2-5233ffc8e882:c0]
2019-06-14 10:27:27,523 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:27:28,534 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-D39DE47DD13C->da9925a9-e302-487a-a7c2-5233ffc8e882: receive RaftClientReply:client-D39DE47DD13C->da9925a9-e302-487a-a7c2-5233ffc8e882@group-C5510B48FB6D, cid=12, FAILED org.apache.ratis.protocol.NotLeaderException: Server da9925a9-e302-487a-a7c2-5233ffc8e882 is not the leader (7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247). Request must be sent to leader., logIndex=0, commits[da9925a9-e302-487a-a7c2-5233ffc8e882:c0, 7532b1c1-eee6-40f9-81b4-f2c881484f0d:c0, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:c0]
2019-06-14 10:27:28,539 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:27:29,552 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-D39DE47DD13C->a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: receive RaftClientReply:client-D39DE47DD13C->a0eb4e14-4e55-404d-acf1-1f052f7ff9fb@group-C5510B48FB6D, cid=12, FAILED org.apache.ratis.protocol.NotLeaderException: Server a0eb4e14-4e55-404d-acf1-1f052f7ff9fb is not the leader (7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247). Request must be sent to leader., logIndex=0, commits[a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:c0, 7532b1c1-eee6-40f9-81b4-f2c881484f0d:c0, da9925a9-e302-487a-a7c2-5233ffc8e882:c0]
2019-06-14 10:27:29,556 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:27:30,569 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-D39DE47DD13C->da9925a9-e302-487a-a7c2-5233ffc8e882: receive RaftClientReply:client-D39DE47DD13C->da9925a9-e302-487a-a7c2-5233ffc8e882@group-C5510B48FB6D, cid=12, FAILED org.apache.ratis.protocol.NotLeaderException: Server da9925a9-e302-487a-a7c2-5233ffc8e882 is not the leader (7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247). Request must be sent to leader., logIndex=0, commits[da9925a9-e302-487a-a7c2-5233ffc8e882:c0, 7532b1c1-eee6-40f9-81b4-f2c881484f0d:c0, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:c0]
2019-06-14 10:27:30,572 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 2-OrderedRequestStreamObserver2: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:27:31,756 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-D39DE47DD13C->7532b1c1-eee6-40f9-81b4-f2c881484f0d: receive RaftClientReply:client-D39DE47DD13C->7532b1c1-eee6-40f9-81b4-f2c881484f0d@group-C5510B48FB6D, cid=12, SUCCESS, logIndex=1, commits[7532b1c1-eee6-40f9-81b4-f2c881484f0d:c2, da9925a9-e302-487a-a7c2-5233ffc8e882:c1, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:c1]
2019-06-14 10:27:31,800 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-D39DE47DD13C->7532b1c1-eee6-40f9-81b4-f2c881484f0d: receive RaftClientReply:client-D39DE47DD13C->7532b1c1-eee6-40f9-81b4-f2c881484f0d@group-C5510B48FB6D, cid=13, SUCCESS, logIndex=3, commits[7532b1c1-eee6-40f9-81b4-f2c881484f0d:c4, da9925a9-e302-487a-a7c2-5233ffc8e882:c3, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:c3]
2019-06-14 10:27:31,807 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:27:31,808 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@3c54ddec
2019-06-14 10:27:31,808 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:27:31,809 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:27:31,810 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - da9925a9-e302-487a-a7c2-5233ffc8e882: close
2019-06-14 10:27:31,811 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - da9925a9-e302-487a-a7c2-5233ffc8e882: shutdown group-E8F75B76E96D
2019-06-14 10:27:31,811 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - da9925a9-e302-487a-a7c2-5233ffc8e882: shutdown group-C5510B48FB6D
2019-06-14 10:27:31,811 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-E8F75B76E96D,id=da9925a9-e302-487a-a7c2-5233ffc8e882
2019-06-14 10:27:31,811 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C5510B48FB6D,id=da9925a9-e302-487a-a7c2-5233ffc8e882
2019-06-14 10:27:31,811 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - da9925a9-e302-487a-a7c2-5233ffc8e882: shutdown LeaderState
2019-06-14 10:27:31,811 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - da9925a9-e302-487a-a7c2-5233ffc8e882: shutdown FollowerState
2019-06-14 10:27:31,812 INFO  impl.FollowerState (FollowerState.java:run(109)) - da9925a9-e302-487a-a7c2-5233ffc8e882: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:27:31,812 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-14 10:27:31,813 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - da9925a9-e302-487a-a7c2-5233ffc8e882-PendingRequests: sendNotLeaderResponses
2019-06-14 10:27:31,812 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-da9925a9-e302-487a-a7c2-5233ffc8e882-group-C5510B48FB6D: set stopIndex = 3
2019-06-14 10:27:31,813 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-3/data/ratis/a4c922ec-45bd-44fe-8ce9-c5510b48fb6d/sm/snapshot.1_3
2019-06-14 10:27:31,822 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:27:31,822 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-da9925a9-e302-487a-a7c2-5233ffc8e882-group-E8F75B76E96D: set stopIndex = 0
2019-06-14 10:27:31,873 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - da9925a9-e302-487a-a7c2-5233ffc8e882:group-E8F75B76E96D closes. The last applied log index is 0
2019-06-14 10:27:31,882 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - da9925a9-e302-487a-a7c2-5233ffc8e882-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:31,896 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - da9925a9-e302-487a-a7c2-5233ffc8e882-RaftLogWorker close()
2019-06-14 10:27:31,906 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - da9925a9-e302-487a-a7c2-5233ffc8e882:group-C5510B48FB6D closes. The last applied log index is 3
2019-06-14 10:27:31,906 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - da9925a9-e302-487a-a7c2-5233ffc8e882-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:31,917 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - da9925a9-e302-487a-a7c2-5233ffc8e882-RaftLogWorker close()
2019-06-14 10:27:31,922 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - da9925a9-e302-487a-a7c2-5233ffc8e882: shutdown server with port 46667 now
2019-06-14 10:27:31,924 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - da9925a9-e302-487a-a7c2-5233ffc8e882: shutdown server with port 46667 successfully
2019-06-14 10:27:31,925 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - da9925a9-e302-487a-a7c2-5233ffc8e882: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:27:31,926 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: Failed appendEntries to da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-14 10:27:31,929 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:27:31,929 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d->da9925a9-e302-487a-a7c2-5233ffc8e882: nextIndex: updateUnconditionally 5 -> 0
2019-06-14 10:27:31,938 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:27:31,940 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@e91af20{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:27:31,944 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@2f1f12a0{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:27:31,944 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@739831a4{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:27:31,944 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@3830f918{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:27:31,945 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:27:31,946 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@707865bd
2019-06-14 10:27:31,946 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:27:31,946 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:27:31,946 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: close
2019-06-14 10:27:31,947 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: shutdown group-F56F5462F812
2019-06-14 10:27:31,947 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: shutdown group-C5510B48FB6D
2019-06-14 10:27:31,947 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-F56F5462F812,id=7532b1c1-eee6-40f9-81b4-f2c881484f0d
2019-06-14 10:27:31,947 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C5510B48FB6D,id=7532b1c1-eee6-40f9-81b4-f2c881484f0d
2019-06-14 10:27:31,947 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: shutdown LeaderState
2019-06-14 10:27:31,947 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: shutdown LeaderState
2019-06-14 10:27:31,948 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d-PendingRequests: sendNotLeaderResponses
2019-06-14 10:27:31,948 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(7532b1c1-eee6-40f9-81b4-f2c881484f0d -> a0eb4e14-4e55-404d-acf1-1f052f7ff9fb): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:27:31,948 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(7532b1c1-eee6-40f9-81b4-f2c881484f0d -> da9925a9-e302-487a-a7c2-5233ffc8e882): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:27:31,948 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d-PendingRequests: sendNotLeaderResponses
2019-06-14 10:27:31,952 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: appendEntries completed
2019-06-14 10:27:31,952 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-7532b1c1-eee6-40f9-81b4-f2c881484f0d-group-F56F5462F812: set stopIndex = 0
2019-06-14 10:27:31,952 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:27:31,953 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: follower 7532b1c1-eee6-40f9-81b4-f2c881484f0d->a0eb4e14-4e55-404d-acf1-1f052f7ff9fb(c3,m4,n5, attendVote=true, lastRpcSendTime=179, lastRpcResponseTime=168) response Completed
2019-06-14 10:27:31,953 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d:group-F56F5462F812 closes. The last applied log index is 0
2019-06-14 10:27:31,954 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:31,956 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-7532b1c1-eee6-40f9-81b4-f2c881484f0d-group-C5510B48FB6D: set stopIndex = 4
2019-06-14 10:27:31,956 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-14 10:27:31,956 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-2/data/ratis/a4c922ec-45bd-44fe-8ce9-c5510b48fb6d/sm/snapshot.1_4
2019-06-14 10:27:31,956 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d:group-C5510B48FB6D closes. The last applied log index is 4
2019-06-14 10:27:31,954 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d->a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: nextIndex: updateUnconditionally 5 -> 0
2019-06-14 10:27:31,957 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:31,959 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d-RaftLogWorker close()
2019-06-14 10:27:31,960 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d-RaftLogWorker close()
2019-06-14 10:27:31,965 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: shutdown server with port 37247 now
2019-06-14 10:27:31,967 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 7532b1c1-eee6-40f9-81b4-f2c881484f0d: shutdown server with port 37247 successfully
2019-06-14 10:27:31,968 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:27:31,978 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:27:31,979 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@52bd9a27{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:27:31,979 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@611e5819{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:27:31,979 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@285005b8{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:27:31,980 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@d3e3085{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:27:33,004 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-D39DE47DD13C->a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: receive RaftClientReply:client-D39DE47DD13C->a0eb4e14-4e55-404d-acf1-1f052f7ff9fb@group-C5510B48FB6D, cid=14, FAILED org.apache.ratis.protocol.NotLeaderException: Server a0eb4e14-4e55-404d-acf1-1f052f7ff9fb is not the leader (7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247). Request must be sent to leader., logIndex=0, commits[a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:c3, 7532b1c1-eee6-40f9-81b4-f2c881484f0d:c3, da9925a9-e302-487a-a7c2-5233ffc8e882:c2]
2019-06-14 10:27:33,006 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 2-OrderedRequestStreamObserver2: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:27:33,963 INFO  impl.FollowerState (FollowerState.java:run(101)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D changes to CANDIDATE, lastRpcTime:2181, electionTimeout:1161ms
2019-06-14 10:27:33,965 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: shutdown FollowerState
2019-06-14 10:27:33,965 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D changes role from FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2019-06-14 10:27:33,966 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: start LeaderElection
2019-06-14 10:27:33,967 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D change Leader from 7532b1c1-eee6-40f9-81b4-f2c881484f0d to null at term 1 for initElection
2019-06-14 10:27:33,970 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D:LeaderElection13: begin an election at term 2 for 0: [7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247, da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799], old=null
2019-06-14 10:27:33,974 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D:LeaderElection13 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:37247
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:33,977 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D:LeaderElection13 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:46667
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:33,979 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D:LeaderElection13: Election REJECTED; received 0 response(s) [] and 2 exception(s); a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:t2, leader=null, voted=a0eb4e14-4e55-404d-acf1-1f052f7ff9fb, raftlog=a0eb4e14-4e55-404d-acf1-1f052f7ff9fb-SegmentedRaftLog:OPENED:c3,f4,i4, conf=0: [7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247, da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799], old=null
2019-06-14 10:27:33,980 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:37247
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:33,980 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:46667
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:33,980 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D changes role from CANDIDATE to FOLLOWER at term 2 for DISCOVERED_A_NEW_TERM
2019-06-14 10:27:33,980 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: shutdown LeaderElection
2019-06-14 10:27:33,985 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: start FollowerState
2019-06-14 10:27:34,675 INFO  node.StaleNodeHandler (StaleNodeHandler.java:onMessage(58)) - Datanode 7532b1c1-eee6-40f9-81b4-f2c881484f0d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null} moved to stale state. Finalizing its pipelines [PipelineID=07582538-a144-4af0-8a6f-f56f5462f812, PipelineID=a4c922ec-45bd-44fe-8ce9-c5510b48fb6d]
2019-06-14 10:27:34,677 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: 07582538-a144-4af0-8a6f-f56f5462f812, Nodes: 7532b1c1-eee6-40f9-81b4-f2c881484f0d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:27:34,677 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 07582538-a144-4af0-8a6f-f56f5462f812, Nodes: 7532b1c1-eee6-40f9-81b4-f2c881484f0d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-06-14 10:27:34,678 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: a4c922ec-45bd-44fe-8ce9-c5510b48fb6d, Nodes: da9925a9-e302-487a-a7c2-5233ffc8e882{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}7532b1c1-eee6-40f9-81b4-f2c881484f0d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}a0eb4e14-4e55-404d-acf1-1f052f7ff9fb{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-14 10:27:34,679 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: a4c922ec-45bd-44fe-8ce9-c5510b48fb6d, Nodes: da9925a9-e302-487a-a7c2-5233ffc8e882{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}7532b1c1-eee6-40f9-81b4-f2c881484f0d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}a0eb4e14-4e55-404d-acf1-1f052f7ff9fb{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] moved to CLOSED state
2019-06-14 10:27:34,681 INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #1
2019-06-14 10:27:34,775 INFO  node.StaleNodeHandler (StaleNodeHandler.java:onMessage(58)) - Datanode da9925a9-e302-487a-a7c2-5233ffc8e882{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null} moved to stale state. Finalizing its pipelines [PipelineID=f6cb7eac-b0f5-48c2-b40f-e8f75b76e96d, PipelineID=a4c922ec-45bd-44fe-8ce9-c5510b48fb6d]
2019-06-14 10:27:34,776 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: f6cb7eac-b0f5-48c2-b40f-e8f75b76e96d, Nodes: da9925a9-e302-487a-a7c2-5233ffc8e882{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:27:34,776 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: f6cb7eac-b0f5-48c2-b40f-e8f75b76e96d, Nodes: da9925a9-e302-487a-a7c2-5233ffc8e882{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-06-14 10:27:34,776 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: a4c922ec-45bd-44fe-8ce9-c5510b48fb6d, Nodes: da9925a9-e302-487a-a7c2-5233ffc8e882{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}7532b1c1-eee6-40f9-81b4-f2c881484f0d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}a0eb4e14-4e55-404d-acf1-1f052f7ff9fb{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
2019-06-14 10:27:35,056 INFO  impl.FollowerState (FollowerState.java:run(101)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D changes to CANDIDATE, lastRpcTime:1071, electionTimeout:1063ms
2019-06-14 10:27:35,057 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: shutdown FollowerState
2019-06-14 10:27:35,057 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D changes role from FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2019-06-14 10:27:35,057 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: start LeaderElection
2019-06-14 10:27:35,060 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D:LeaderElection14: begin an election at term 3 for 0: [7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247, da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799], old=null
2019-06-14 10:27:35,063 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D:LeaderElection14 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:37247
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:35,065 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D:LeaderElection14 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:46667
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:35,066 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D:LeaderElection14: Election REJECTED; received 0 response(s) [] and 2 exception(s); a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:t3, leader=null, voted=a0eb4e14-4e55-404d-acf1-1f052f7ff9fb, raftlog=a0eb4e14-4e55-404d-acf1-1f052f7ff9fb-SegmentedRaftLog:OPENED:c3,f4,i4, conf=0: [7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247, da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799], old=null
2019-06-14 10:27:35,066 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:37247
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:35,066 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:46667
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:35,067 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D changes role from CANDIDATE to FOLLOWER at term 3 for DISCOVERED_A_NEW_TERM
2019-06-14 10:27:35,068 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: shutdown LeaderElection
2019-06-14 10:27:35,068 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: start FollowerState
2019-06-14 10:27:36,144 INFO  impl.FollowerState (FollowerState.java:run(101)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D changes to CANDIDATE, lastRpcTime:1076, electionTimeout:1075ms
2019-06-14 10:27:36,146 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: shutdown FollowerState
2019-06-14 10:27:36,146 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D changes role from FOLLOWER to CANDIDATE at term 3 for changeToCandidate
2019-06-14 10:27:36,146 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: start LeaderElection
2019-06-14 10:27:36,149 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D:LeaderElection15: begin an election at term 4 for 0: [7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247, da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799], old=null
2019-06-14 10:27:36,150 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D:LeaderElection15 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:46667
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:36,151 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D:LeaderElection15 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:37247
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:36,152 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D:LeaderElection15: Election REJECTED; received 0 response(s) [] and 2 exception(s); a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:t4, leader=null, voted=a0eb4e14-4e55-404d-acf1-1f052f7ff9fb, raftlog=a0eb4e14-4e55-404d-acf1-1f052f7ff9fb-SegmentedRaftLog:OPENED:c3,f4,i4, conf=0: [7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247, da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799], old=null
2019-06-14 10:27:36,152 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:46667
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:36,152 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:37247
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:36,153 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D changes role from CANDIDATE to FOLLOWER at term 4 for DISCOVERED_A_NEW_TERM
2019-06-14 10:27:36,154 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: shutdown LeaderElection
2019-06-14 10:27:36,154 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: start FollowerState
2019-06-14 10:27:37,039 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-D39DE47DD13C->a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: receive RaftClientReply:client-D39DE47DD13C->a0eb4e14-4e55-404d-acf1-1f052f7ff9fb@group-C5510B48FB6D, cid=14, FAILED org.apache.ratis.protocol.NotLeaderException: Server a0eb4e14-4e55-404d-acf1-1f052f7ff9fb is not the leader (da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667). Request must be sent to leader., logIndex=0, commits[a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:c3, 7532b1c1-eee6-40f9-81b4-f2c881484f0d:c3, da9925a9-e302-487a-a7c2-5233ffc8e882:c2]
2019-06-14 10:27:37,045 WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(276)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-D39DE47DD13C->a0eb4e14-4e55-404d-acf1-1f052f7ff9fb@group-C5510B48FB6D, cid=14, seq=3*, RW, org.apache.hadoop.hdds.scm.XceiverClientRatis$$Lambda$436/510793091@78c708b1 for 5 attempts with RetryLimited(maxAttempts=5, sleepTime=1000ms) on the pipeline Pipeline[ Id: a4c922ec-45bd-44fe-8ce9-c5510b48fb6d, Nodes: da9925a9-e302-487a-a7c2-5233ffc8e882{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}7532b1c1-eee6-40f9-81b4-f2c881484f0d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}a0eb4e14-4e55-404d-acf1-1f052f7ff9fb{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]. The last committed block length is 1048576, uncommitted data length is 2097152 retry count 0
2019-06-14 10:27:37,065 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 3-OrderedRequestStreamObserver3: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:27:37,140 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F03950E2C479->5cb89b60-561f-4d51-91d3-1a386bffeb6b: receive RaftClientReply:client-F03950E2C479->5cb89b60-561f-4d51-91d3-1a386bffeb6b@group-A890AFBAA66E, cid=18, SUCCESS, logIndex=1, commits[5cb89b60-561f-4d51-91d3-1a386bffeb6b:c1, 7bba2558-4743-447d-9e01-b6a234175195:c0, 227a6fd9-6137-4d19-bf85-40110cf9fabd:c0]
2019-06-14 10:27:37,165 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F03950E2C479->5cb89b60-561f-4d51-91d3-1a386bffeb6b: receive RaftClientReply:client-F03950E2C479->5cb89b60-561f-4d51-91d3-1a386bffeb6b@group-A890AFBAA66E, cid=19, SUCCESS, logIndex=3, commits[5cb89b60-561f-4d51-91d3-1a386bffeb6b:c4, 7bba2558-4743-447d-9e01-b6a234175195:c3, 227a6fd9-6137-4d19-bf85-40110cf9fabd:c3]
2019-06-14 10:27:37,182 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F03950E2C479->5cb89b60-561f-4d51-91d3-1a386bffeb6b: receive RaftClientReply:client-F03950E2C479->5cb89b60-561f-4d51-91d3-1a386bffeb6b@group-A890AFBAA66E, cid=20, SUCCESS, logIndex=5, commits[5cb89b60-561f-4d51-91d3-1a386bffeb6b:c5, 7bba2558-4743-447d-9e01-b6a234175195:c4, 227a6fd9-6137-4d19-bf85-40110cf9fabd:c3]
2019-06-14 10:27:37,189 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F03950E2C479->5cb89b60-561f-4d51-91d3-1a386bffeb6b: receive RaftClientReply:client-F03950E2C479->5cb89b60-561f-4d51-91d3-1a386bffeb6b@group-A890AFBAA66E, cid=21, SUCCESS, logIndex=6, commits[5cb89b60-561f-4d51-91d3-1a386bffeb6b:c6, 7bba2558-4743-447d-9e01-b6a234175195:c4, 227a6fd9-6137-4d19-bf85-40110cf9fabd:c4]
2019-06-14 10:27:37,202 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F03950E2C479->5cb89b60-561f-4d51-91d3-1a386bffeb6b: receive RaftClientReply:client-F03950E2C479->5cb89b60-561f-4d51-91d3-1a386bffeb6b@group-A890AFBAA66E, cid=22, SUCCESS, logIndex=0, commits[5cb89b60-561f-4d51-91d3-1a386bffeb6b:c8, 7bba2558-4743-447d-9e01-b6a234175195:c6, 227a6fd9-6137-4d19-bf85-40110cf9fabd:c6]
2019-06-14 10:27:37,345 INFO  impl.FollowerState (FollowerState.java:run(101)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D changes to CANDIDATE, lastRpcTime:1191, electionTimeout:1190ms
2019-06-14 10:27:37,346 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: shutdown FollowerState
2019-06-14 10:27:37,346 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D changes role from FOLLOWER to CANDIDATE at term 4 for changeToCandidate
2019-06-14 10:27:37,346 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: start LeaderElection
2019-06-14 10:27:37,351 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D:LeaderElection16: begin an election at term 5 for 0: [7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247, da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799], old=null
2019-06-14 10:27:37,352 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D:LeaderElection16 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:46667
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:37,354 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D:LeaderElection16 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:37247
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:37,355 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D:LeaderElection16: Election REJECTED; received 0 response(s) [] and 2 exception(s); a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:t5, leader=null, voted=a0eb4e14-4e55-404d-acf1-1f052f7ff9fb, raftlog=a0eb4e14-4e55-404d-acf1-1f052f7ff9fb-SegmentedRaftLog:OPENED:c3,f4,i4, conf=0: [7532b1c1-eee6-40f9-81b4-f2c881484f0d:192.168.46.40:37247, da9925a9-e302-487a-a7c2-5233ffc8e882:192.168.46.40:46667, a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:192.168.46.40:33799], old=null
2019-06-14 10:27:37,355 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:46667
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:37,355 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:37247
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:37,355 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D changes role from CANDIDATE to FOLLOWER at term 5 for DISCOVERED_A_NEW_TERM
2019-06-14 10:27:37,356 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: shutdown LeaderElection
2019-06-14 10:27:37,356 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: start FollowerState
2019-06-14 10:27:37,376 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:shutdown(321)) - Shutting down the Mini Ozone Cluster
2019-06-14 10:27:37,383 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(336)) - Stopping the Mini Ozone Cluster
2019-06-14 10:27:37,383 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(338)) - Stopping the OzoneManager
2019-06-14 10:27:37,383 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 38271
2019-06-14 10:27:37,384 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-14 10:27:37,384 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 38271
2019-06-14 10:27:37,384 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service KeyDeletingService
2019-06-14 10:27:37,388 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@4565a70a{/,null,UNAVAILABLE}{/ozoneManager}
2019-06-14 10:27:37,390 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@a0a9fa5{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:27:37,390 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@7c2327fa{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,UNAVAILABLE}
2019-06-14 10:27:37,390 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@1a411233{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:27:37,395 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(344)) - Stopping the StorageContainerManager
2019-06-14 10:27:37,395 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(789)) - Stopping Replication Manager Service.
2019-06-14 10:27:37,395 INFO  container.ReplicationManager (ReplicationManager.java:stop(191)) - Replication Monitor Thread is not running.
2019-06-14 10:27:37,395 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(796)) - Stopping Lease Manager of the command watchers
2019-06-14 10:27:37,395 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(803)) - Stopping datanode service RPC server
2019-06-14 10:27:37,395 INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(373)) - Stopping the RPC server for DataNodes
2019-06-14 10:27:37,395 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 37187
2019-06-14 10:27:37,397 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 37187
2019-06-14 10:27:37,397 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(811)) - Stopping block service RPC server
2019-06-14 10:27:37,397 INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(145)) - Stopping the RPC server for Block Protocol
2019-06-14 10:27:37,397 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 45145
2019-06-14 10:27:37,397 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-14 10:27:37,398 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 45145
2019-06-14 10:27:37,398 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(818)) - Stopping the StorageContainerLocationProtocol RPC server
2019-06-14 10:27:37,398 INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(157)) - Stopping the RPC server for Client Protocol
2019-06-14 10:27:37,398 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-14 10:27:37,398 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 34591
2019-06-14 10:27:37,401 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 34591
2019-06-14 10:27:37,401 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(825)) - Stopping Storage Container Manager HTTP server.
2019-06-14 10:27:37,401 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-14 10:27:37,401 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@66629f63{/,null,UNAVAILABLE}{/scm}
2019-06-14 10:27:37,402 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@224b4d61{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:27:37,402 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@b1712f3{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,UNAVAILABLE}
2019-06-14 10:27:37,402 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@35229f85{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:27:37,403 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(836)) - Stopping Block Manager Service.
2019-06-14 10:27:37,403 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service SCMBlockDeletingService
2019-06-14 10:27:37,403 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service SCMBlockDeletingService
2019-06-14 10:27:37,404 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(858)) - Stopping SCM Event Queue.
2019-06-14 10:27:37,407 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(350)) - Shutting the HddsDatanodes
2019-06-14 10:27:37,407 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:27:37,407 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@78a8978a
2019-06-14 10:27:37,408 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:27:37,408 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:27:37,408 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: close
2019-06-14 10:27:37,408 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: shutdown group-B02FBD1AF667
2019-06-14 10:27:37,409 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-B02FBD1AF667,id=227a6fd9-6137-4d19-bf85-40110cf9fabd
2019-06-14 10:27:37,409 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: shutdown LeaderState
2019-06-14 10:27:37,409 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd-PendingRequests: sendNotLeaderResponses
2019-06-14 10:27:37,409 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-227a6fd9-6137-4d19-bf85-40110cf9fabd-group-B02FBD1AF667: set stopIndex = 0
2019-06-14 10:27:37,409 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:27:37,412 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd:group-B02FBD1AF667 closes. The last applied log index is 0
2019-06-14 10:27:37,412 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:37,414 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd-RaftLogWorker close()
2019-06-14 10:27:37,414 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: shutdown group-A890AFBAA66E
2019-06-14 10:27:37,414 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-A890AFBAA66E,id=227a6fd9-6137-4d19-bf85-40110cf9fabd
2019-06-14 10:27:37,414 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: shutdown FollowerState
2019-06-14 10:27:37,414 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-227a6fd9-6137-4d19-bf85-40110cf9fabd-group-A890AFBAA66E: set stopIndex = 6
2019-06-14 10:27:37,415 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:2, i:6)
2019-06-14 10:27:37,415 INFO  impl.FollowerState (FollowerState.java:run(109)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:27:37,415 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-0/data/ratis/510e86c6-50de-4e75-8368-a890afbaa66e/sm/snapshot.2_6
2019-06-14 10:27:37,415 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd:group-A890AFBAA66E closes. The last applied log index is 6
2019-06-14 10:27:37,415 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:37,417 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd-RaftLogWorker close()
2019-06-14 10:27:37,418 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: shutdown server with port 41877 now
2019-06-14 10:27:37,419 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:27:37,421 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 227a6fd9-6137-4d19-bf85-40110cf9fabd: shutdown server with port 41877 successfully
2019-06-14 10:27:37,422 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:27:37,422 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: Failed appendEntries to 227a6fd9-6137-4d19-bf85-40110cf9fabd:192.168.46.40:41877: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-14 10:27:37,424 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b->227a6fd9-6137-4d19-bf85-40110cf9fabd: nextIndex: updateUnconditionally 9 -> 0
2019-06-14 10:27:37,434 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:27:37,434 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@2b037cfc{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:27:37,435 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@44924587{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:27:37,435 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@2f66f0d0{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:27:37,435 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@a565cbd{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:27:37,436 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:27:37,436 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@aa61e4e
2019-06-14 10:27:37,436 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:27:37,436 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:27:37,437 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: close
2019-06-14 10:27:37,437 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: shutdown group-9D6BC50045DC
2019-06-14 10:27:37,437 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: shutdown group-C5510B48FB6D
2019-06-14 10:27:37,437 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-9D6BC50045DC,id=a0eb4e14-4e55-404d-acf1-1f052f7ff9fb
2019-06-14 10:27:37,437 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C5510B48FB6D,id=a0eb4e14-4e55-404d-acf1-1f052f7ff9fb
2019-06-14 10:27:37,437 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: shutdown LeaderState
2019-06-14 10:27:37,437 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: shutdown FollowerState
2019-06-14 10:27:37,438 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb-PendingRequests: sendNotLeaderResponses
2019-06-14 10:27:37,438 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-14 10:27:37,438 INFO  impl.FollowerState (FollowerState.java:run(109)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:27:37,438 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-a0eb4e14-4e55-404d-acf1-1f052f7ff9fb-group-C5510B48FB6D: set stopIndex = 3
2019-06-14 10:27:37,438 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-1/data/ratis/a4c922ec-45bd-44fe-8ce9-c5510b48fb6d/sm/snapshot.1_3
2019-06-14 10:27:37,442 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-a0eb4e14-4e55-404d-acf1-1f052f7ff9fb-group-9D6BC50045DC: set stopIndex = 0
2019-06-14 10:27:37,442 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-C5510B48FB6D closes. The last applied log index is 3
2019-06-14 10:27:37,442 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:27:37,443 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:37,444 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb:group-9D6BC50045DC closes. The last applied log index is 0
2019-06-14 10:27:37,444 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb-RaftLogWorker close()
2019-06-14 10:27:37,444 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:37,445 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb-RaftLogWorker close()
2019-06-14 10:27:37,447 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: shutdown server with port 33799 now
2019-06-14 10:27:37,448 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - a0eb4e14-4e55-404d-acf1-1f052f7ff9fb: shutdown server with port 33799 successfully
2019-06-14 10:27:37,449 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:27:37,460 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:27:37,460 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@59a2388e{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:27:37,461 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@186d8a71{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:27:37,461 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@5403799b{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:27:37,461 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@691124ee{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:27:37,462 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:27:37,462 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@ceb7701
2019-06-14 10:27:37,462 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:27:37,463 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:27:37,463 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: close
2019-06-14 10:27:37,463 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: shutdown group-814B4970B58E
2019-06-14 10:27:37,463 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: shutdown group-A890AFBAA66E
2019-06-14 10:27:37,463 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-814B4970B58E,id=5cb89b60-561f-4d51-91d3-1a386bffeb6b
2019-06-14 10:27:37,464 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-A890AFBAA66E,id=5cb89b60-561f-4d51-91d3-1a386bffeb6b
2019-06-14 10:27:37,464 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: shutdown LeaderState
2019-06-14 10:27:37,464 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: shutdown LeaderState
2019-06-14 10:27:37,464 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b-PendingRequests: sendNotLeaderResponses
2019-06-14 10:27:37,464 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(5cb89b60-561f-4d51-91d3-1a386bffeb6b -> 7bba2558-4743-447d-9e01-b6a234175195): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:27:37,464 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(5cb89b60-561f-4d51-91d3-1a386bffeb6b -> 227a6fd9-6137-4d19-bf85-40110cf9fabd): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:27:37,464 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b-PendingRequests: sendNotLeaderResponses
2019-06-14 10:27:37,465 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:27:37,464 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-5cb89b60-561f-4d51-91d3-1a386bffeb6b-group-814B4970B58E: set stopIndex = 0
2019-06-14 10:27:37,470 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:2, i:6)
2019-06-14 10:27:37,470 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-5cb89b60-561f-4d51-91d3-1a386bffeb6b-group-A890AFBAA66E: set stopIndex = 8
2019-06-14 10:27:37,470 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-4/data/ratis/510e86c6-50de-4e75-8368-a890afbaa66e/sm/snapshot.2_6
2019-06-14 10:27:37,471 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b:group-A890AFBAA66E closes. The last applied log index is 8
2019-06-14 10:27:37,471 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:37,470 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b:group-814B4970B58E closes. The last applied log index is 0
2019-06-14 10:27:37,472 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b-RaftLogWorker close()
2019-06-14 10:27:37,471 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 7bba2558-4743-447d-9e01-b6a234175195: appendEntries completed
2019-06-14 10:27:37,472 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:37,475 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: follower 5cb89b60-561f-4d51-91d3-1a386bffeb6b->7bba2558-4743-447d-9e01-b6a234175195(c6,m8,n9, attendVote=true, lastRpcSendTime=290, lastRpcResponseTime=280) response Completed
2019-06-14 10:27:37,475 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b-RaftLogWorker close()
2019-06-14 10:27:37,476 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b->7bba2558-4743-447d-9e01-b6a234175195: nextIndex: updateUnconditionally 9 -> -1
2019-06-14 10:27:37,477 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: shutdown server with port 37999 now
2019-06-14 10:27:37,478 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 5cb89b60-561f-4d51-91d3-1a386bffeb6b: shutdown server with port 37999 successfully
2019-06-14 10:27:37,479 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-UnorderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:27:37,480 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:27:37,491 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:27:37,492 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@4dc52559{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:27:37,493 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@5c3d4f05{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:27:37,493 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@4f1afe8f{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:27:37,493 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@b1b471{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:27:37,494 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:27:37,494 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@159ac15f
2019-06-14 10:27:37,494 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:27:37,495 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:27:37,495 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 7bba2558-4743-447d-9e01-b6a234175195: close
2019-06-14 10:27:37,495 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 7bba2558-4743-447d-9e01-b6a234175195: shutdown group-7A9664CDC12C
2019-06-14 10:27:37,496 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-7A9664CDC12C,id=7bba2558-4743-447d-9e01-b6a234175195
2019-06-14 10:27:37,496 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 7bba2558-4743-447d-9e01-b6a234175195: shutdown LeaderState
2019-06-14 10:27:37,496 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 7bba2558-4743-447d-9e01-b6a234175195-PendingRequests: sendNotLeaderResponses
2019-06-14 10:27:37,496 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-7bba2558-4743-447d-9e01-b6a234175195-group-7A9664CDC12C: set stopIndex = 0
2019-06-14 10:27:37,497 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:27:37,497 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 7bba2558-4743-447d-9e01-b6a234175195:group-7A9664CDC12C closes. The last applied log index is 0
2019-06-14 10:27:37,497 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 7bba2558-4743-447d-9e01-b6a234175195-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:37,498 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 7bba2558-4743-447d-9e01-b6a234175195-RaftLogWorker close()
2019-06-14 10:27:37,499 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 7bba2558-4743-447d-9e01-b6a234175195: shutdown group-A890AFBAA66E
2019-06-14 10:27:37,499 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-A890AFBAA66E,id=7bba2558-4743-447d-9e01-b6a234175195
2019-06-14 10:27:37,499 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 7bba2558-4743-447d-9e01-b6a234175195: shutdown FollowerState
2019-06-14 10:27:37,499 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-7bba2558-4743-447d-9e01-b6a234175195-group-A890AFBAA66E: set stopIndex = 6
2019-06-14 10:27:37,499 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:2, i:6)
2019-06-14 10:27:37,499 INFO  impl.FollowerState (FollowerState.java:run(109)) - 7bba2558-4743-447d-9e01-b6a234175195: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:27:37,500 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-7cae2cd1-b099-4a1a-8321-d33df0eb9eee/datanode-5/data/ratis/510e86c6-50de-4e75-8368-a890afbaa66e/sm/snapshot.2_6
2019-06-14 10:27:37,500 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 7bba2558-4743-447d-9e01-b6a234175195:group-A890AFBAA66E closes. The last applied log index is 6
2019-06-14 10:27:37,500 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 7bba2558-4743-447d-9e01-b6a234175195-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:37,501 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 7bba2558-4743-447d-9e01-b6a234175195-RaftLogWorker close()
2019-06-14 10:27:37,501 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 7bba2558-4743-447d-9e01-b6a234175195: shutdown server with port 38305 now
2019-06-14 10:27:37,503 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 7bba2558-4743-447d-9e01-b6a234175195: shutdown server with port 38305 successfully
2019-06-14 10:27:37,504 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:27:37,546 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:27:37,547 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@70be89ec{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:27:37,547 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@2aee0704{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:27:37,548 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@527937d0{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:27:37,548 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@6b063470{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:27:37,583 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:37,587 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:37,587 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:37,588 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedBlocks
2019-06-14 10:27:37,588 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedBlocks
2019-06-14 10:27:37,588 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: validCerts
2019-06-14 10:27:37,588 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:validCerts
2019-06-14 10:27:37,588 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: revokedCerts
2019-06-14 10:27:37,588 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:revokedCerts
2019-06-14 10:27:37,589 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-14 10:27:37,589 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-14 10:27:37,589 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-14 10:27:37,627 INFO  node.SCMNodeManager (SCMNodeManager.java:<init>(108)) - Entering startup safe mode.
2019-06-14 10:27:37,628 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(125)) - Loading file from sun.misc.CompoundEnumeration@2ba9f986
2019-06-14 10:27:37,628 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(171)) - Loading network topology layer schema file
2019-06-14 10:27:37,631 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:37,643 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:initializePipelineState(126)) - No pipeline exists in current db
2019-06-14 10:27:37,643 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:37,657 WARN  events.EventQueue (EventQueue.java:fireEvent(175)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='SafeModeStatus'}
2019-06-14 10:27:37,658 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:27:37,659 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 43565
2019-06-14 10:27:37,661 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:27:37,661 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 34375
2019-06-14 10:27:37,663 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:27:37,663 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 36547
2019-06-14 10:27:37,666 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for scm at: http://0.0.0.0:0
2019-06-14 10:27:37,667 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:27:37,667 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:27:37,669 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:27:37,669 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context scm
2019-06-14 10:27:37,669 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:27:37,670 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:27:37,675 INFO  server.StorageContainerManager (StorageContainerManager.java:start(752)) - StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:36547
2019-06-14 10:27:37,675 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - StorageContainerManager metrics system started (again)
2019-06-14 10:27:37,675 INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:start(149)) - RPC server for Client  is listening at /0.0.0.0:36547
2019-06-14 10:27:37,676 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:27:37,678 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 36547: starting
2019-06-14 10:27:37,740 INFO  server.StorageContainerManager (StorageContainerManager.java:start(761)) - ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:34375
2019-06-14 10:27:37,740 INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:start(137)) - RPC server for Block Protocol is listening at /0.0.0.0:34375
2019-06-14 10:27:37,740 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:27:37,741 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 34375: starting
2019-06-14 10:27:37,753 INFO  server.StorageContainerManager (StorageContainerManager.java:start(765)) - ScmDatanodeProtocl RPC server is listening at /0.0.0.0:43565
2019-06-14 10:27:37,754 INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:start(191)) - RPC server for DataNodes is listening at /0.0.0.0:43565
2019-06-14 10:27:37,754 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:27:37,754 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 43565: starting
2019-06-14 10:27:37,760 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 38981
2019-06-14 10:27:37,760 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:27:37,761 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@7afe0e67{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:27:37,762 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@31228d83{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-14 10:27:37,766 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@5280688{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/scm/,AVAILABLE}{/scm}
2019-06-14 10:27:37,766 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@643f6179{HTTP/1.1,[http/1.1]}{0.0.0.0:38981}
2019-06-14 10:27:37,767 INFO  server.Server (Server.java:doStart(419)) - Started @23025ms
2019-06-14 10:27:37,767 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of SCM is listening at http://0.0.0.0:38981
2019-06-14 10:27:37,768 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:37,768 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:27:37,771 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:37,771 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(519)) - OM Service ID is not set. Setting it to the default ID: omServiceIdDefault
2019-06-14 10:27:37,771 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(525)) - OM Node ID is not set. Setting it to the OmStorage's OmID: 492e9870-cbf0-43c8-90a3-293ccd0927d5
2019-06-14 10:27:37,771 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 10:27:37,772 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 10:27:37,772 INFO  om.OzoneManager (OzoneManager.java:loadOMHAConfigs(476)) - Found matching OM address with OMServiceId: null, OMNodeId: null, RPC Address: localhost:0 and Ratis port: 9872
2019-06-14 10:27:37,782 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:37,782 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: userTable
2019-06-14 10:27:37,782 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:userTable
2019-06-14 10:27:37,782 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: volumeTable
2019-06-14 10:27:37,783 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:volumeTable
2019-06-14 10:27:37,783 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: bucketTable
2019-06-14 10:27:37,783 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:bucketTable
2019-06-14 10:27:37,783 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: keyTable
2019-06-14 10:27:37,783 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:keyTable
2019-06-14 10:27:37,783 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedTable
2019-06-14 10:27:37,783 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedTable
2019-06-14 10:27:37,783 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: openKeyTable
2019-06-14 10:27:37,784 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:openKeyTable
2019-06-14 10:27:37,784 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3Table
2019-06-14 10:27:37,784 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3Table
2019-06-14 10:27:37,784 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: multipartInfoTable
2019-06-14 10:27:37,784 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:multipartInfoTable
2019-06-14 10:27:37,784 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: dTokenTable
2019-06-14 10:27:37,784 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:dTokenTable
2019-06-14 10:27:37,785 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3SecretTable
2019-06-14 10:27:37,785 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3SecretTable
2019-06-14 10:27:37,785 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: prefixTable
2019-06-14 10:27:37,785 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:prefixTable
2019-06-14 10:27:37,785 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-14 10:27:37,785 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-14 10:27:37,785 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-14 10:27:37,919 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:27:37,920 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 40509
2019-06-14 10:27:37,931 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:37,931 INFO  om.OzoneManager (OzoneManager.java:start(1217)) - OzoneManager RPC server is listening at localhost/127.0.0.1:40509
2019-06-14 10:27:37,931 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - OzoneManager metrics system started (again)
2019-06-14 10:27:37,933 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:27:37,938 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 40509: starting
2019-06-14 10:27:37,957 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for ozoneManager at: http://0.0.0.0:0
2019-06-14 10:27:37,958 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:27:37,959 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:27:37,960 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:27:37,960 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context ozoneManager
2019-06-14 10:27:37,960 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:27:37,961 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:27:37,961 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 46789
2019-06-14 10:27:37,961 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:27:37,963 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@36dafa24{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:27:37,963 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@c758a2d{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-14 10:27:37,966 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@18e4551{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/ozoneManager/,AVAILABLE}{/ozoneManager}
2019-06-14 10:27:37,967 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@3ea48c37{HTTP/1.1,[http/1.1]}{0.0.0.0:46789}
2019-06-14 10:27:37,967 INFO  server.Server (Server.java:doStart(419)) - Started @23226ms
2019-06-14 10:27:37,968 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of OZONEMANAGER is listening at http://0.0.0.0:46789
2019-06-14 10:27:37,977 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:27:37,977 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:27:37,988 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-0/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:27:37,988 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-0/data/containers/hdds to VolumeSet
2019-06-14 10:27:37,988 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@76828577
2019-06-14 10:27:37,989 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@76828577
2019-06-14 10:27:37,999 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 45485
2019-06-14 10:27:38,000 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:27:38,000 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 45485 (custom)
2019-06-14 10:27:38,000 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:27:38,000 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:38,001 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:27:38,001 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:38,001 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-0/data/ratis] (custom)
2019-06-14 10:27:38,001 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 44051
2019-06-14 10:27:38,002 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:27:38,002 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:27:38,003 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:27:38,004 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:27:38,005 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:27:38,005 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:27:38,005 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:27:38,005 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:27:38,006 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 34257
2019-06-14 10:27:38,006 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:27:38,007 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@4a6a6a69{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:27:38,008 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@53e93fb7{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:27:38,036 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@45cd8607{/,file:///tmp/jetty-0.0.0.0-34257-hddsDatanode-_-any-4933728847897107941.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:27:38,036 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@4d492a9{HTTP/1.1,[http/1.1]}{0.0.0.0:34257}
2019-06-14 10:27:38,037 INFO  server.Server (Server.java:doStart(419)) - Started @23296ms
2019-06-14 10:27:38,038 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:34257
Jun 14, 2019 10:27:38 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:27:38,167 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@259195fe
2019-06-14 10:27:38,167 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:27:38,169 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:27:38,174 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:27:38,177 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-1/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:27:38,177 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-1/data/containers/hdds to VolumeSet
2019-06-14 10:27:38,178 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@4bfa5eb9
2019-06-14 10:27:38,178 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-0/meta/datanode.id
2019-06-14 10:27:38,181 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@4bfa5eb9
2019-06-14 10:27:38,191 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 33641
2019-06-14 10:27:38,191 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:27:38,192 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 33641 (custom)
2019-06-14 10:27:38,192 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:27:38,192 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:38,192 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:27:38,193 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:38,193 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-1/data/ratis] (custom)
2019-06-14 10:27:38,194 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 46501
2019-06-14 10:27:38,194 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:27:38,195 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:27:38,196 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:27:38,196 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:27:38,198 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:27:38,198 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:27:38,198 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:27:38,198 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:27:38,199 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 45539
2019-06-14 10:27:38,199 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:27:38,201 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@1fb6b8fb{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:27:38,201 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@1a10c47e{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:27:38,227 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@4c5f7b4f{/,file:///tmp/jetty-0.0.0.0-45539-hddsDatanode-_-any-2274698170372128458.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:27:38,229 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@4b544732{HTTP/1.1,[http/1.1]}{0.0.0.0:45539}
2019-06-14 10:27:38,229 INFO  server.Server (Server.java:doStart(419)) - Started @23487ms
2019-06-14 10:27:38,229 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:45539
Jun 14, 2019 10:27:38 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:27:38,337 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@60ed0b9d
2019-06-14 10:27:38,337 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:27:38,341 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:27:38,346 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:27:38,347 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-1/meta/datanode.id
2019-06-14 10:27:38,355 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-2/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:27:38,356 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-2/data/containers/hdds to VolumeSet
2019-06-14 10:27:38,356 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@2eb6d34a
2019-06-14 10:27:38,357 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@2eb6d34a
2019-06-14 10:27:38,368 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 37339
2019-06-14 10:27:38,369 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:27:38,369 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 37339 (custom)
2019-06-14 10:27:38,369 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:27:38,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:38,370 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:27:38,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:38,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-2/data/ratis] (custom)
2019-06-14 10:27:38,370 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 43461
2019-06-14 10:27:38,371 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:27:38,371 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:27:38,372 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:27:38,373 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:27:38,374 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:27:38,374 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:27:38,374 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:27:38,375 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:27:38,375 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 45413
2019-06-14 10:27:38,375 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:27:38,376 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@48fc0211{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:27:38,377 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@7d088813{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:27:38,399 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@3dbb3fb7{/,file:///tmp/jetty-0.0.0.0-45413-hddsDatanode-_-any-896771052889423518.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:27:38,399 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@68a426c3{HTTP/1.1,[http/1.1]}{0.0.0.0:45413}
2019-06-14 10:27:38,400 INFO  server.Server (Server.java:doStart(419)) - Started @23659ms
2019-06-14 10:27:38,401 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:45413
Jun 14, 2019 10:27:38 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:27:38,495 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@29f3185c
2019-06-14 10:27:38,496 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:27:38,497 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:27:38,506 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:27:38,508 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-2/meta/datanode.id
2019-06-14 10:27:38,513 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-3/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:27:38,514 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-3/data/containers/hdds to VolumeSet
2019-06-14 10:27:38,514 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@693f2c89
2019-06-14 10:27:38,518 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@693f2c89
2019-06-14 10:27:38,527 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 46645
2019-06-14 10:27:38,528 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:27:38,528 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 46645 (custom)
2019-06-14 10:27:38,529 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:27:38,529 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:38,529 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:27:38,529 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:38,529 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-3/data/ratis] (custom)
2019-06-14 10:27:38,530 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 45505
2019-06-14 10:27:38,530 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:27:38,531 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:27:38,531 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:27:38,534 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:27:38,535 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:27:38,536 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:27:38,536 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:27:38,536 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:27:38,536 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 36713
2019-06-14 10:27:38,536 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:27:38,539 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@6f7a20da{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:27:38,539 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@77ba583{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:27:38,563 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@44492c06{/,file:///tmp/jetty-0.0.0.0-36713-hddsDatanode-_-any-9169517187396672050.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:27:38,563 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@5c4714ef{HTTP/1.1,[http/1.1]}{0.0.0.0:36713}
2019-06-14 10:27:38,564 INFO  server.Server (Server.java:doStart(419)) - Started @23823ms
2019-06-14 10:27:38,565 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:36713
Jun 14, 2019 10:27:38 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:27:38,692 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@32b95de
2019-06-14 10:27:38,692 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:27:38,694 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:27:38,698 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:27:38,700 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-3/meta/datanode.id
2019-06-14 10:27:38,706 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-4/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:27:38,707 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-4/data/containers/hdds to VolumeSet
2019-06-14 10:27:38,707 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@76134b9b
2019-06-14 10:27:38,707 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@76134b9b
2019-06-14 10:27:38,725 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43029
2019-06-14 10:27:38,727 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:27:38,727 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43029 (custom)
2019-06-14 10:27:38,727 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:27:38,727 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:38,727 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:27:38,728 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:38,728 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-4/data/ratis] (custom)
2019-06-14 10:27:38,728 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 34241
2019-06-14 10:27:38,729 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:27:38,730 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:27:38,731 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:27:38,731 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:27:38,732 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:27:38,732 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:27:38,733 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:27:38,733 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:27:38,733 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 36775
2019-06-14 10:27:38,733 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:27:38,735 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@dc8b2ff{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:27:38,735 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@14201a90{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:27:38,764 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@1da53f4f{/,file:///tmp/jetty-0.0.0.0-36775-hddsDatanode-_-any-5619380766010309605.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:27:38,765 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@17bb531f{HTTP/1.1,[http/1.1]}{0.0.0.0:36775}
2019-06-14 10:27:38,766 INFO  server.Server (Server.java:doStart(419)) - Started @24025ms
2019-06-14 10:27:38,767 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:36775
Jun 14, 2019 10:27:38 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:27:38,876 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@12be4f83
2019-06-14 10:27:38,876 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:27:38,878 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:27:38,882 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:27:38,883 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-4/meta/datanode.id
2019-06-14 10:27:38,887 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-5/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:27:38,887 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-5/data/containers/hdds to VolumeSet
2019-06-14 10:27:38,887 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@29519337
2019-06-14 10:27:38,889 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@29519337
2019-06-14 10:27:38,898 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 42123
2019-06-14 10:27:38,900 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:27:38,900 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42123 (custom)
2019-06-14 10:27:38,900 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:27:38,901 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:38,901 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:27:38,901 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:38,901 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-5/data/ratis] (custom)
2019-06-14 10:27:38,902 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 35769
2019-06-14 10:27:38,902 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:27:38,903 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:27:38,904 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:27:38,913 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:27:38,915 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:27:38,915 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:27:38,915 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:27:38,916 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:27:38,916 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 42487
2019-06-14 10:27:38,916 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:27:38,938 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@2b6fcca1{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:27:38,939 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@24b3f778{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:27:38,968 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@283e1759{/,file:///tmp/jetty-0.0.0.0-42487-hddsDatanode-_-any-1103466666757104065.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:27:38,977 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@2acb1264{HTTP/1.1,[http/1.1]}{0.0.0.0:42487}
2019-06-14 10:27:38,977 INFO  server.Server (Server.java:doStart(419)) - Started @24235ms
2019-06-14 10:27:38,978 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:42487
Jun 14, 2019 10:27:38 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:27:39,065 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@62360a68
2019-06-14 10:27:39,065 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:27:39,074 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:27:39,075 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-5/meta/datanode.id
2019-06-14 10:27:39,791 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-14 10:27:40,067 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:27:40,182 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:27:40,183 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:27:40,183 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis cdb26579-7e70-4e4e-af71-ded7b57c9157 at port 45485
2019-06-14 10:27:40,187 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: start RPC server
2019-06-14 10:27:40,187 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: GrpcService started, listening on 0.0.0.0/0.0.0.0:45485
2019-06-14 10:27:40,191 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-14 10:27:40,191 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-14 10:27:40,191 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-14 10:27:40,350 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:27:40,351 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:27:40,351 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis ca5b104e-5d4b-499b-9f87-b75880259d68 at port 33641
2019-06-14 10:27:40,355 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - ca5b104e-5d4b-499b-9f87-b75880259d68: start RPC server
2019-06-14 10:27:40,355 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - ca5b104e-5d4b-499b-9f87-b75880259d68: GrpcService started, listening on 0.0.0.0/0.0.0.0:33641
2019-06-14 10:27:40,509 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:27:40,511 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:27:40,511 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 27617c4a-5a35-4cec-830e-fa4967527a30 at port 37339
2019-06-14 10:27:40,521 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 27617c4a-5a35-4cec-830e-fa4967527a30: start RPC server
2019-06-14 10:27:40,522 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 27617c4a-5a35-4cec-830e-fa4967527a30: GrpcService started, listening on 0.0.0.0/0.0.0.0:37339
2019-06-14 10:27:40,701 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:27:40,704 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:27:40,704 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 43635eb7-d1ac-47d7-8f50-5c051f2656f7 at port 46645
2019-06-14 10:27:40,735 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: start RPC server
2019-06-14 10:27:40,735 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: GrpcService started, listening on 0.0.0.0/0.0.0.0:46645
2019-06-14 10:27:40,885 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:27:40,887 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:27:40,887 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis e8cf28ec-919d-46d9-8310-74643439f44d at port 43029
2019-06-14 10:27:40,891 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - e8cf28ec-919d-46d9-8310-74643439f44d: start RPC server
2019-06-14 10:27:40,893 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - e8cf28ec-919d-46d9-8310-74643439f44d: GrpcService started, listening on 0.0.0.0/0.0.0.0:43029
2019-06-14 10:27:41,067 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:27:41,077 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:27:41,081 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:27:41,082 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 1a945b57-ef45-49ed-92c5-75ee453031c6 at port 42123
2019-06-14 10:27:41,085 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: start RPC server
2019-06-14 10:27:41,086 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: GrpcService started, listening on 0.0.0.0/0.0.0.0:42123
2019-06-14 10:27:42,068 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:27:42,177 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : cdb26579-7e70-4e4e-af71-ded7b57c9157{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:27:42,178 INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 1 DataNodes registered, 1 required.
2019-06-14 10:27:42,181 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(177)) - ScmSafeModeManager, all rules are successfully validated
2019-06-14 10:27:42,181 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:exitSafeMode(193)) - SCM exiting safe mode.
2019-06-14 10:27:42,192 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: addNew group-2CFE4D2BC0C7:[cdb26579-7e70-4e4e-af71-ded7b57c9157:192.168.46.40:45485] returns group-2CFE4D2BC0C7:java.util.concurrent.CompletableFuture@243e2265[Not completed]
2019-06-14 10:27:42,193 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: new RaftServerImpl for group-2CFE4D2BC0C7:[cdb26579-7e70-4e4e-af71-ded7b57c9157:192.168.46.40:45485] with ContainerStateMachine:uninitialized
2019-06-14 10:27:42,193 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:42,193 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:42,193 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:42,193 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:42,193 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - cdb26579-7e70-4e4e-af71-ded7b57c9157:group-2CFE4D2BC0C7 ConfigurationManager, init=-1: [cdb26579-7e70-4e4e-af71-ded7b57c9157:192.168.46.40:45485], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:42,193 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-0/data/ratis] (custom)
2019-06-14 10:27:42,193 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-0/data/ratis/d0106914-13d9-479a-b1a8-2cfe4d2bc0c7 does not exist. Creating ...
2019-06-14 10:27:42,195 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-0/data/ratis/d0106914-13d9-479a-b1a8-2cfe4d2bc0c7/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:42,198 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-0/data/ratis/d0106914-13d9-479a-b1a8-2cfe4d2bc0c7 has been successfully formatted.
2019-06-14 10:27:42,198 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:42,198 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:42,198 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:42,198 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:42,198 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:42,198 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:42,198 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new cdb26579-7e70-4e4e-af71-ded7b57c9157-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-0/data/ratis/d0106914-13d9-479a-b1a8-2cfe4d2bc0c7
2019-06-14 10:27:42,198 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:42,198 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:42,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:42,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:42,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:42,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:42,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:42,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:42,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:42,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:42,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:42,200 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:42,200 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:42,200 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: start group-2CFE4D2BC0C7
2019-06-14 10:27:42,200 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cdb26579-7e70-4e4e-af71-ded7b57c9157:group-2CFE4D2BC0C7 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:42,200 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: start FollowerState
2019-06-14 10:27:42,201 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-2CFE4D2BC0C7,id=cdb26579-7e70-4e4e-af71-ded7b57c9157
2019-06-14 10:27:42,204 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: d0106914-13d9-479a-b1a8-2cfe4d2bc0c7, Nodes: cdb26579-7e70-4e4e-af71-ded7b57c9157{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:27:42,347 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : ca5b104e-5d4b-499b-9f87-b75880259d68{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:27:42,353 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - ca5b104e-5d4b-499b-9f87-b75880259d68: addNew group-0663B0B8C0FE:[ca5b104e-5d4b-499b-9f87-b75880259d68:192.168.46.40:33641] returns group-0663B0B8C0FE:java.util.concurrent.CompletableFuture@6ca92415[Not completed]
2019-06-14 10:27:42,353 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - ca5b104e-5d4b-499b-9f87-b75880259d68: new RaftServerImpl for group-0663B0B8C0FE:[ca5b104e-5d4b-499b-9f87-b75880259d68:192.168.46.40:33641] with ContainerStateMachine:uninitialized
2019-06-14 10:27:42,353 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:42,353 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:42,354 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:42,354 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:42,354 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - ca5b104e-5d4b-499b-9f87-b75880259d68:group-0663B0B8C0FE ConfigurationManager, init=-1: [ca5b104e-5d4b-499b-9f87-b75880259d68:192.168.46.40:33641], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:42,354 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-1/data/ratis] (custom)
2019-06-14 10:27:42,354 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-1/data/ratis/8d6ddf67-5d7d-4e39-8551-0663b0b8c0fe does not exist. Creating ...
2019-06-14 10:27:42,357 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-1/data/ratis/8d6ddf67-5d7d-4e39-8551-0663b0b8c0fe/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:42,359 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-1/data/ratis/8d6ddf67-5d7d-4e39-8551-0663b0b8c0fe has been successfully formatted.
2019-06-14 10:27:42,359 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:42,359 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:42,359 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:42,359 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:42,359 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:42,359 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:42,359 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new ca5b104e-5d4b-499b-9f87-b75880259d68-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-1/data/ratis/8d6ddf67-5d7d-4e39-8551-0663b0b8c0fe
2019-06-14 10:27:42,359 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:42,360 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:42,360 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:42,360 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:42,360 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:42,360 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:42,360 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:42,360 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:42,360 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:42,360 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:42,360 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:42,360 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:42,361 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:42,361 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - ca5b104e-5d4b-499b-9f87-b75880259d68: start group-0663B0B8C0FE
2019-06-14 10:27:42,361 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - ca5b104e-5d4b-499b-9f87-b75880259d68:group-0663B0B8C0FE changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:42,361 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - ca5b104e-5d4b-499b-9f87-b75880259d68: start FollowerState
2019-06-14 10:27:42,361 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-0663B0B8C0FE,id=ca5b104e-5d4b-499b-9f87-b75880259d68
2019-06-14 10:27:42,364 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 8d6ddf67-5d7d-4e39-8551-0663b0b8c0fe, Nodes: ca5b104e-5d4b-499b-9f87-b75880259d68{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:27:42,507 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 27617c4a-5a35-4cec-830e-fa4967527a30{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:27:42,519 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 27617c4a-5a35-4cec-830e-fa4967527a30: addNew group-D9A20DB564C6:[27617c4a-5a35-4cec-830e-fa4967527a30:192.168.46.40:37339] returns group-D9A20DB564C6:java.util.concurrent.CompletableFuture@49b1086a[Not completed]
2019-06-14 10:27:42,520 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 27617c4a-5a35-4cec-830e-fa4967527a30: new RaftServerImpl for group-D9A20DB564C6:[27617c4a-5a35-4cec-830e-fa4967527a30:192.168.46.40:37339] with ContainerStateMachine:uninitialized
2019-06-14 10:27:42,520 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:42,520 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:42,520 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:42,520 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:42,520 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 27617c4a-5a35-4cec-830e-fa4967527a30:group-D9A20DB564C6 ConfigurationManager, init=-1: [27617c4a-5a35-4cec-830e-fa4967527a30:192.168.46.40:37339], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:42,520 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-2/data/ratis] (custom)
2019-06-14 10:27:42,521 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-2/data/ratis/84a578e0-932e-4061-9749-d9a20db564c6 does not exist. Creating ...
2019-06-14 10:27:42,523 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-2/data/ratis/84a578e0-932e-4061-9749-d9a20db564c6/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:42,525 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-2/data/ratis/84a578e0-932e-4061-9749-d9a20db564c6 has been successfully formatted.
2019-06-14 10:27:42,525 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:42,525 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:42,525 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:42,525 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:42,525 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:42,525 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:42,525 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 27617c4a-5a35-4cec-830e-fa4967527a30-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-2/data/ratis/84a578e0-932e-4061-9749-d9a20db564c6
2019-06-14 10:27:42,526 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:42,526 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:42,526 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:42,526 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:42,526 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:42,526 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:42,526 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:42,526 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:42,526 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:42,526 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:42,527 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:42,527 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:42,527 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:42,527 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 27617c4a-5a35-4cec-830e-fa4967527a30: start group-D9A20DB564C6
2019-06-14 10:27:42,527 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 27617c4a-5a35-4cec-830e-fa4967527a30:group-D9A20DB564C6 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:42,527 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 27617c4a-5a35-4cec-830e-fa4967527a30: start FollowerState
2019-06-14 10:27:42,527 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D9A20DB564C6,id=27617c4a-5a35-4cec-830e-fa4967527a30
2019-06-14 10:27:42,530 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 84a578e0-932e-4061-9749-d9a20db564c6, Nodes: 27617c4a-5a35-4cec-830e-fa4967527a30{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:27:42,542 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 27617c4a-5a35-4cec-830e-fa4967527a30: addNew group-486A20CAB2C9:[27617c4a-5a35-4cec-830e-fa4967527a30:192.168.46.40:37339, cdb26579-7e70-4e4e-af71-ded7b57c9157:192.168.46.40:45485, ca5b104e-5d4b-499b-9f87-b75880259d68:192.168.46.40:33641] returns group-486A20CAB2C9:java.util.concurrent.CompletableFuture@639f401f[Not completed]
2019-06-14 10:27:42,543 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 27617c4a-5a35-4cec-830e-fa4967527a30: new RaftServerImpl for group-486A20CAB2C9:[27617c4a-5a35-4cec-830e-fa4967527a30:192.168.46.40:37339, cdb26579-7e70-4e4e-af71-ded7b57c9157:192.168.46.40:45485, ca5b104e-5d4b-499b-9f87-b75880259d68:192.168.46.40:33641] with ContainerStateMachine:uninitialized
2019-06-14 10:27:42,543 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:42,543 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:42,543 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - ca5b104e-5d4b-499b-9f87-b75880259d68: addNew group-486A20CAB2C9:[27617c4a-5a35-4cec-830e-fa4967527a30:192.168.46.40:37339, cdb26579-7e70-4e4e-af71-ded7b57c9157:192.168.46.40:45485, ca5b104e-5d4b-499b-9f87-b75880259d68:192.168.46.40:33641] returns group-486A20CAB2C9:java.util.concurrent.CompletableFuture@6720cb95[Not completed]
2019-06-14 10:27:42,543 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:42,543 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:42,543 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 27617c4a-5a35-4cec-830e-fa4967527a30:group-486A20CAB2C9 ConfigurationManager, init=-1: [27617c4a-5a35-4cec-830e-fa4967527a30:192.168.46.40:37339, cdb26579-7e70-4e4e-af71-ded7b57c9157:192.168.46.40:45485, ca5b104e-5d4b-499b-9f87-b75880259d68:192.168.46.40:33641], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:42,543 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-2/data/ratis] (custom)
2019-06-14 10:27:42,544 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-2/data/ratis/94aa7427-62ab-4cbb-bfe5-486a20cab2c9 does not exist. Creating ...
2019-06-14 10:27:42,544 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: addNew group-486A20CAB2C9:[27617c4a-5a35-4cec-830e-fa4967527a30:192.168.46.40:37339, cdb26579-7e70-4e4e-af71-ded7b57c9157:192.168.46.40:45485, ca5b104e-5d4b-499b-9f87-b75880259d68:192.168.46.40:33641] returns group-486A20CAB2C9:java.util.concurrent.CompletableFuture@6cef228f[Not completed]
2019-06-14 10:27:42,544 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - ca5b104e-5d4b-499b-9f87-b75880259d68: new RaftServerImpl for group-486A20CAB2C9:[27617c4a-5a35-4cec-830e-fa4967527a30:192.168.46.40:37339, cdb26579-7e70-4e4e-af71-ded7b57c9157:192.168.46.40:45485, ca5b104e-5d4b-499b-9f87-b75880259d68:192.168.46.40:33641] with ContainerStateMachine:uninitialized
2019-06-14 10:27:42,544 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:42,544 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:42,544 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:42,544 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: new RaftServerImpl for group-486A20CAB2C9:[27617c4a-5a35-4cec-830e-fa4967527a30:192.168.46.40:37339, cdb26579-7e70-4e4e-af71-ded7b57c9157:192.168.46.40:45485, ca5b104e-5d4b-499b-9f87-b75880259d68:192.168.46.40:33641] with ContainerStateMachine:uninitialized
2019-06-14 10:27:42,545 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:42,545 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:42,545 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - ca5b104e-5d4b-499b-9f87-b75880259d68:group-486A20CAB2C9 ConfigurationManager, init=-1: [27617c4a-5a35-4cec-830e-fa4967527a30:192.168.46.40:37339, cdb26579-7e70-4e4e-af71-ded7b57c9157:192.168.46.40:45485, ca5b104e-5d4b-499b-9f87-b75880259d68:192.168.46.40:33641], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:42,545 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:42,545 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-1/data/ratis] (custom)
2019-06-14 10:27:42,545 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:42,545 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:42,545 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-1/data/ratis/94aa7427-62ab-4cbb-bfe5-486a20cab2c9 does not exist. Creating ...
2019-06-14 10:27:42,545 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - cdb26579-7e70-4e4e-af71-ded7b57c9157:group-486A20CAB2C9 ConfigurationManager, init=-1: [27617c4a-5a35-4cec-830e-fa4967527a30:192.168.46.40:37339, cdb26579-7e70-4e4e-af71-ded7b57c9157:192.168.46.40:45485, ca5b104e-5d4b-499b-9f87-b75880259d68:192.168.46.40:33641], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:42,546 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-0/data/ratis] (custom)
2019-06-14 10:27:42,546 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-2/data/ratis/94aa7427-62ab-4cbb-bfe5-486a20cab2c9/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:42,546 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-0/data/ratis/94aa7427-62ab-4cbb-bfe5-486a20cab2c9 does not exist. Creating ...
2019-06-14 10:27:42,547 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-0/data/ratis/94aa7427-62ab-4cbb-bfe5-486a20cab2c9/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:42,547 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-2/data/ratis/94aa7427-62ab-4cbb-bfe5-486a20cab2c9 has been successfully formatted.
2019-06-14 10:27:42,547 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-1/data/ratis/94aa7427-62ab-4cbb-bfe5-486a20cab2c9/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:42,548 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:42,548 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:42,548 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:42,548 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:42,548 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:42,548 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:42,548 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 27617c4a-5a35-4cec-830e-fa4967527a30-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-2/data/ratis/94aa7427-62ab-4cbb-bfe5-486a20cab2c9
2019-06-14 10:27:42,548 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:42,548 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:42,549 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:42,549 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:42,549 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:42,549 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:42,549 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:42,549 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:42,549 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:42,549 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:42,550 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-1/data/ratis/94aa7427-62ab-4cbb-bfe5-486a20cab2c9 has been successfully formatted.
2019-06-14 10:27:42,550 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:42,550 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-0/data/ratis/94aa7427-62ab-4cbb-bfe5-486a20cab2c9 has been successfully formatted.
2019-06-14 10:27:42,550 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:42,550 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:42,550 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:42,550 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:42,550 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 27617c4a-5a35-4cec-830e-fa4967527a30: start group-486A20CAB2C9
2019-06-14 10:27:42,550 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:42,550 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 27617c4a-5a35-4cec-830e-fa4967527a30:group-486A20CAB2C9 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:42,550 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:42,551 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:42,551 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 27617c4a-5a35-4cec-830e-fa4967527a30: start FollowerState
2019-06-14 10:27:42,551 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:42,551 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:42,551 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:42,551 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:42,551 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:42,551 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:42,551 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:42,552 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new ca5b104e-5d4b-499b-9f87-b75880259d68-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-1/data/ratis/94aa7427-62ab-4cbb-bfe5-486a20cab2c9
2019-06-14 10:27:42,552 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new cdb26579-7e70-4e4e-af71-ded7b57c9157-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-0/data/ratis/94aa7427-62ab-4cbb-bfe5-486a20cab2c9
2019-06-14 10:27:42,552 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:42,552 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-486A20CAB2C9,id=27617c4a-5a35-4cec-830e-fa4967527a30
2019-06-14 10:27:42,552 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:42,552 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:42,552 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:42,552 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:42,552 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:42,553 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:42,553 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:42,553 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:42,553 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:42,552 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:42,553 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:42,553 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:42,553 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:42,553 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:42,553 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:42,553 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:42,554 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:42,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:42,558 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:42,558 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:42,558 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:42,560 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:42,560 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:42,560 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:42,560 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:42,560 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: start group-486A20CAB2C9
2019-06-14 10:27:42,561 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cdb26579-7e70-4e4e-af71-ded7b57c9157:group-486A20CAB2C9 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:42,561 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: start FollowerState
2019-06-14 10:27:42,561 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-486A20CAB2C9,id=cdb26579-7e70-4e4e-af71-ded7b57c9157
2019-06-14 10:27:42,560 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - ca5b104e-5d4b-499b-9f87-b75880259d68: start group-486A20CAB2C9
2019-06-14 10:27:42,561 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - ca5b104e-5d4b-499b-9f87-b75880259d68:group-486A20CAB2C9 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:42,562 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - ca5b104e-5d4b-499b-9f87-b75880259d68: start FollowerState
2019-06-14 10:27:42,562 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-486A20CAB2C9,id=ca5b104e-5d4b-499b-9f87-b75880259d68
2019-06-14 10:27:42,571 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 94aa7427-62ab-4cbb-bfe5-486a20cab2c9, Nodes: ca5b104e-5d4b-499b-9f87-b75880259d68{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}27617c4a-5a35-4cec-830e-fa4967527a30{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}cdb26579-7e70-4e4e-af71-ded7b57c9157{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-14 10:27:42,698 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 43635eb7-d1ac-47d7-8f50-5c051f2656f7{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:27:42,705 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: addNew group-861ECD30C7E6:[43635eb7-d1ac-47d7-8f50-5c051f2656f7:192.168.46.40:46645] returns group-861ECD30C7E6:java.util.concurrent.CompletableFuture@51eef5a5[Not completed]
2019-06-14 10:27:42,706 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: new RaftServerImpl for group-861ECD30C7E6:[43635eb7-d1ac-47d7-8f50-5c051f2656f7:192.168.46.40:46645] with ContainerStateMachine:uninitialized
2019-06-14 10:27:42,706 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:42,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:42,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:42,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:42,707 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7:group-861ECD30C7E6 ConfigurationManager, init=-1: [43635eb7-d1ac-47d7-8f50-5c051f2656f7:192.168.46.40:46645], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:42,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-3/data/ratis] (custom)
2019-06-14 10:27:42,707 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-3/data/ratis/66758ac0-d1bd-4444-ac04-861ecd30c7e6 does not exist. Creating ...
2019-06-14 10:27:42,709 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-3/data/ratis/66758ac0-d1bd-4444-ac04-861ecd30c7e6/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:42,711 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-3/data/ratis/66758ac0-d1bd-4444-ac04-861ecd30c7e6 has been successfully formatted.
2019-06-14 10:27:42,711 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:42,711 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:42,711 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:42,711 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:42,711 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:42,712 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:42,712 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 43635eb7-d1ac-47d7-8f50-5c051f2656f7-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-3/data/ratis/66758ac0-d1bd-4444-ac04-861ecd30c7e6
2019-06-14 10:27:42,712 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:42,712 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:42,712 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:42,712 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:42,712 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:42,712 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:42,712 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:42,712 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:42,712 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:42,712 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:42,713 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:42,713 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:42,713 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:42,713 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: start group-861ECD30C7E6
2019-06-14 10:27:42,713 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7:group-861ECD30C7E6 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:42,713 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: start FollowerState
2019-06-14 10:27:42,714 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-861ECD30C7E6,id=43635eb7-d1ac-47d7-8f50-5c051f2656f7
2019-06-14 10:27:42,716 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 66758ac0-d1bd-4444-ac04-861ecd30c7e6, Nodes: 43635eb7-d1ac-47d7-8f50-5c051f2656f7{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:27:42,883 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : e8cf28ec-919d-46d9-8310-74643439f44d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:27:42,887 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e8cf28ec-919d-46d9-8310-74643439f44d: addNew group-C1EFFC3B474C:[e8cf28ec-919d-46d9-8310-74643439f44d:192.168.46.40:43029] returns group-C1EFFC3B474C:java.util.concurrent.CompletableFuture@6cbaa6ce[Not completed]
2019-06-14 10:27:42,888 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - e8cf28ec-919d-46d9-8310-74643439f44d: new RaftServerImpl for group-C1EFFC3B474C:[e8cf28ec-919d-46d9-8310-74643439f44d:192.168.46.40:43029] with ContainerStateMachine:uninitialized
2019-06-14 10:27:42,888 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:42,888 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:42,888 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:42,888 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:42,888 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - e8cf28ec-919d-46d9-8310-74643439f44d:group-C1EFFC3B474C ConfigurationManager, init=-1: [e8cf28ec-919d-46d9-8310-74643439f44d:192.168.46.40:43029], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:42,888 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-4/data/ratis] (custom)
2019-06-14 10:27:42,888 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-4/data/ratis/44be8a53-06ab-49e7-b6ec-c1effc3b474c does not exist. Creating ...
2019-06-14 10:27:42,890 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-4/data/ratis/44be8a53-06ab-49e7-b6ec-c1effc3b474c/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:42,892 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-4/data/ratis/44be8a53-06ab-49e7-b6ec-c1effc3b474c has been successfully formatted.
2019-06-14 10:27:42,893 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:42,893 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:42,893 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:42,893 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:42,893 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:42,893 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:42,893 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new e8cf28ec-919d-46d9-8310-74643439f44d-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-4/data/ratis/44be8a53-06ab-49e7-b6ec-c1effc3b474c
2019-06-14 10:27:42,893 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:42,894 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:42,894 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:42,894 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:42,894 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:42,894 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:42,894 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:42,894 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:42,894 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:42,894 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:42,894 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:42,894 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:42,895 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:42,895 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - e8cf28ec-919d-46d9-8310-74643439f44d: start group-C1EFFC3B474C
2019-06-14 10:27:42,895 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - e8cf28ec-919d-46d9-8310-74643439f44d:group-C1EFFC3B474C changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:42,895 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e8cf28ec-919d-46d9-8310-74643439f44d: start FollowerState
2019-06-14 10:27:42,899 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C1EFFC3B474C,id=e8cf28ec-919d-46d9-8310-74643439f44d
2019-06-14 10:27:42,907 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 44be8a53-06ab-49e7-b6ec-c1effc3b474c, Nodes: e8cf28ec-919d-46d9-8310-74643439f44d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:27:43,068 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 5 of 6 DN Heartbeats.
2019-06-14 10:27:43,075 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 1a945b57-ef45-49ed-92c5-75ee453031c6{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:27:43,080 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: addNew group-7D5F67A37EDB:[1a945b57-ef45-49ed-92c5-75ee453031c6:192.168.46.40:42123] returns group-7D5F67A37EDB:java.util.concurrent.CompletableFuture@6e56b5e8[Not completed]
2019-06-14 10:27:43,081 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: new RaftServerImpl for group-7D5F67A37EDB:[1a945b57-ef45-49ed-92c5-75ee453031c6:192.168.46.40:42123] with ContainerStateMachine:uninitialized
2019-06-14 10:27:43,081 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:43,081 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:43,081 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:43,081 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:43,081 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 1a945b57-ef45-49ed-92c5-75ee453031c6:group-7D5F67A37EDB ConfigurationManager, init=-1: [1a945b57-ef45-49ed-92c5-75ee453031c6:192.168.46.40:42123], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:43,081 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-5/data/ratis] (custom)
2019-06-14 10:27:43,082 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-5/data/ratis/94648977-6e3a-43c4-bcaf-7d5f67a37edb does not exist. Creating ...
2019-06-14 10:27:43,084 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-5/data/ratis/94648977-6e3a-43c4-bcaf-7d5f67a37edb/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:43,086 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-5/data/ratis/94648977-6e3a-43c4-bcaf-7d5f67a37edb has been successfully formatted.
2019-06-14 10:27:43,086 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:43,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:43,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:43,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:43,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:43,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:43,086 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 1a945b57-ef45-49ed-92c5-75ee453031c6-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-5/data/ratis/94648977-6e3a-43c4-bcaf-7d5f67a37edb
2019-06-14 10:27:43,087 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:43,087 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:43,087 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:43,087 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:43,087 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:43,087 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:43,087 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:43,087 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:43,087 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:43,087 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:43,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:43,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:43,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:43,088 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: start group-7D5F67A37EDB
2019-06-14 10:27:43,088 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1a945b57-ef45-49ed-92c5-75ee453031c6:group-7D5F67A37EDB changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:43,088 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: start FollowerState
2019-06-14 10:27:43,088 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-7D5F67A37EDB,id=1a945b57-ef45-49ed-92c5-75ee453031c6
2019-06-14 10:27:43,094 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 94648977-6e3a-43c4-bcaf-7d5f67a37edb, Nodes: 1a945b57-ef45-49ed-92c5-75ee453031c6{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:27:43,102 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: addNew group-2D3C48945B1A:[43635eb7-d1ac-47d7-8f50-5c051f2656f7:192.168.46.40:46645, 1a945b57-ef45-49ed-92c5-75ee453031c6:192.168.46.40:42123, e8cf28ec-919d-46d9-8310-74643439f44d:192.168.46.40:43029] returns group-2D3C48945B1A:java.util.concurrent.CompletableFuture@788d7578[Not completed]
2019-06-14 10:27:43,102 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: addNew group-2D3C48945B1A:[43635eb7-d1ac-47d7-8f50-5c051f2656f7:192.168.46.40:46645, 1a945b57-ef45-49ed-92c5-75ee453031c6:192.168.46.40:42123, e8cf28ec-919d-46d9-8310-74643439f44d:192.168.46.40:43029] returns group-2D3C48945B1A:java.util.concurrent.CompletableFuture@64a633ca[Not completed]
2019-06-14 10:27:43,102 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e8cf28ec-919d-46d9-8310-74643439f44d: addNew group-2D3C48945B1A:[43635eb7-d1ac-47d7-8f50-5c051f2656f7:192.168.46.40:46645, 1a945b57-ef45-49ed-92c5-75ee453031c6:192.168.46.40:42123, e8cf28ec-919d-46d9-8310-74643439f44d:192.168.46.40:43029] returns group-2D3C48945B1A:java.util.concurrent.CompletableFuture@33da742f[Not completed]
2019-06-14 10:27:43,103 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: new RaftServerImpl for group-2D3C48945B1A:[43635eb7-d1ac-47d7-8f50-5c051f2656f7:192.168.46.40:46645, 1a945b57-ef45-49ed-92c5-75ee453031c6:192.168.46.40:42123, e8cf28ec-919d-46d9-8310-74643439f44d:192.168.46.40:43029] with ContainerStateMachine:uninitialized
2019-06-14 10:27:43,103 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:43,103 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:43,103 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - e8cf28ec-919d-46d9-8310-74643439f44d: new RaftServerImpl for group-2D3C48945B1A:[43635eb7-d1ac-47d7-8f50-5c051f2656f7:192.168.46.40:46645, 1a945b57-ef45-49ed-92c5-75ee453031c6:192.168.46.40:42123, e8cf28ec-919d-46d9-8310-74643439f44d:192.168.46.40:43029] with ContainerStateMachine:uninitialized
2019-06-14 10:27:43,103 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:43,103 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:43,103 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: new RaftServerImpl for group-2D3C48945B1A:[43635eb7-d1ac-47d7-8f50-5c051f2656f7:192.168.46.40:46645, 1a945b57-ef45-49ed-92c5-75ee453031c6:192.168.46.40:42123, e8cf28ec-919d-46d9-8310-74643439f44d:192.168.46.40:43029] with ContainerStateMachine:uninitialized
2019-06-14 10:27:43,103 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:43,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:43,103 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:43,104 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7:group-2D3C48945B1A ConfigurationManager, init=-1: [43635eb7-d1ac-47d7-8f50-5c051f2656f7:192.168.46.40:46645, 1a945b57-ef45-49ed-92c5-75ee453031c6:192.168.46.40:42123, e8cf28ec-919d-46d9-8310-74643439f44d:192.168.46.40:43029], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:43,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:43,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:43,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:43,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-3/data/ratis] (custom)
2019-06-14 10:27:43,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:43,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:43,104 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-3/data/ratis/8e403484-69ec-4b76-9671-2d3c48945b1a does not exist. Creating ...
2019-06-14 10:27:43,104 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 1a945b57-ef45-49ed-92c5-75ee453031c6:group-2D3C48945B1A ConfigurationManager, init=-1: [43635eb7-d1ac-47d7-8f50-5c051f2656f7:192.168.46.40:46645, 1a945b57-ef45-49ed-92c5-75ee453031c6:192.168.46.40:42123, e8cf28ec-919d-46d9-8310-74643439f44d:192.168.46.40:43029], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:43,105 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - e8cf28ec-919d-46d9-8310-74643439f44d:group-2D3C48945B1A ConfigurationManager, init=-1: [43635eb7-d1ac-47d7-8f50-5c051f2656f7:192.168.46.40:46645, 1a945b57-ef45-49ed-92c5-75ee453031c6:192.168.46.40:42123, e8cf28ec-919d-46d9-8310-74643439f44d:192.168.46.40:43029], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:43,105 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-5/data/ratis] (custom)
2019-06-14 10:27:43,105 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-4/data/ratis] (custom)
2019-06-14 10:27:43,105 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-5/data/ratis/8e403484-69ec-4b76-9671-2d3c48945b1a does not exist. Creating ...
2019-06-14 10:27:43,105 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-4/data/ratis/8e403484-69ec-4b76-9671-2d3c48945b1a does not exist. Creating ...
2019-06-14 10:27:43,107 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-3/data/ratis/8e403484-69ec-4b76-9671-2d3c48945b1a/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:43,108 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-4/data/ratis/8e403484-69ec-4b76-9671-2d3c48945b1a/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:43,108 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-5/data/ratis/8e403484-69ec-4b76-9671-2d3c48945b1a/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:43,109 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-3/data/ratis/8e403484-69ec-4b76-9671-2d3c48945b1a has been successfully formatted.
2019-06-14 10:27:43,110 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:43,110 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:43,110 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:43,110 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:43,110 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-5/data/ratis/8e403484-69ec-4b76-9671-2d3c48945b1a has been successfully formatted.
2019-06-14 10:27:43,110 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:43,110 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-4/data/ratis/8e403484-69ec-4b76-9671-2d3c48945b1a has been successfully formatted.
2019-06-14 10:27:43,111 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:43,111 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:43,111 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 43635eb7-d1ac-47d7-8f50-5c051f2656f7-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-3/data/ratis/8e403484-69ec-4b76-9671-2d3c48945b1a
2019-06-14 10:27:43,111 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:43,111 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:43,111 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:43,111 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:43,111 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:43,111 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:43,111 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:43,111 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:43,111 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:43,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:43,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:43,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:43,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:43,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:43,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:43,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:43,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:43,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:43,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:43,113 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:43,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:43,113 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new e8cf28ec-919d-46d9-8310-74643439f44d-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-4/data/ratis/8e403484-69ec-4b76-9671-2d3c48945b1a
2019-06-14 10:27:43,113 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:43,113 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:43,113 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:43,113 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:43,113 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:43,113 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:43,113 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:43,113 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:43,113 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 1a945b57-ef45-49ed-92c5-75ee453031c6-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-5/data/ratis/8e403484-69ec-4b76-9671-2d3c48945b1a
2019-06-14 10:27:43,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:43,113 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:43,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:43,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:43,114 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: start group-2D3C48945B1A
2019-06-14 10:27:43,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:43,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:43,114 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7:group-2D3C48945B1A changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:43,115 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: start FollowerState
2019-06-14 10:27:43,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:43,115 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-2D3C48945B1A,id=43635eb7-d1ac-47d7-8f50-5c051f2656f7
2019-06-14 10:27:43,115 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:43,115 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:43,116 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:43,116 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:43,116 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:43,116 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:43,116 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - e8cf28ec-919d-46d9-8310-74643439f44d: start group-2D3C48945B1A
2019-06-14 10:27:43,116 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - e8cf28ec-919d-46d9-8310-74643439f44d:group-2D3C48945B1A changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:43,116 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:43,116 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e8cf28ec-919d-46d9-8310-74643439f44d: start FollowerState
2019-06-14 10:27:43,116 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:43,117 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:43,117 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-2D3C48945B1A,id=e8cf28ec-919d-46d9-8310-74643439f44d
2019-06-14 10:27:43,117 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:43,117 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:43,118 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:43,118 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:43,118 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:43,118 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: start group-2D3C48945B1A
2019-06-14 10:27:43,118 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1a945b57-ef45-49ed-92c5-75ee453031c6:group-2D3C48945B1A changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:43,118 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: start FollowerState
2019-06-14 10:27:43,119 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-2D3C48945B1A,id=1a945b57-ef45-49ed-92c5-75ee453031c6
2019-06-14 10:27:43,120 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 8e403484-69ec-4b76-9671-2d3c48945b1a, Nodes: 1a945b57-ef45-49ed-92c5-75ee453031c6{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}e8cf28ec-919d-46d9-8310-74643439f44d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}43635eb7-d1ac-47d7-8f50-5c051f2656f7{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-14 10:27:43,379 INFO  impl.FollowerState (FollowerState.java:run(101)) - cdb26579-7e70-4e4e-af71-ded7b57c9157:group-2CFE4D2BC0C7 changes to CANDIDATE, lastRpcTime:1179, electionTimeout:1179ms
2019-06-14 10:27:43,380 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: shutdown FollowerState
2019-06-14 10:27:43,380 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cdb26579-7e70-4e4e-af71-ded7b57c9157:group-2CFE4D2BC0C7 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:43,380 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: start LeaderElection
2019-06-14 10:27:43,385 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - cdb26579-7e70-4e4e-af71-ded7b57c9157:group-2CFE4D2BC0C7:LeaderElection17: begin an election at term 1 for -1: [cdb26579-7e70-4e4e-af71-ded7b57c9157:192.168.46.40:45485], old=null
2019-06-14 10:27:43,387 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: shutdown LeaderElection
2019-06-14 10:27:43,387 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cdb26579-7e70-4e4e-af71-ded7b57c9157:group-2CFE4D2BC0C7 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:27:43,387 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - cdb26579-7e70-4e4e-af71-ded7b57c9157:group-2CFE4D2BC0C7 change Leader from null to cdb26579-7e70-4e4e-af71-ded7b57c9157 at term 1 for becomeLeader, leader elected after 1188ms
2019-06-14 10:27:43,387 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:27:43,387 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:27:43,387 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:27:43,387 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:27:43,387 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: start LeaderState
2019-06-14 10:27:43,387 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - cdb26579-7e70-4e4e-af71-ded7b57c9157-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:43,388 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - cdb26579-7e70-4e4e-af71-ded7b57c9157:group-2CFE4D2BC0C7 set configuration 0: [cdb26579-7e70-4e4e-af71-ded7b57c9157:192.168.46.40:45485], old=null at 0
2019-06-14 10:27:43,424 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - cdb26579-7e70-4e4e-af71-ded7b57c9157-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-0/data/ratis/d0106914-13d9-479a-b1a8-2cfe4d2bc0c7/current/log_inprogress_0
2019-06-14 10:27:43,505 INFO  impl.FollowerState (FollowerState.java:run(101)) - ca5b104e-5d4b-499b-9f87-b75880259d68:group-0663B0B8C0FE changes to CANDIDATE, lastRpcTime:1144, electionTimeout:1144ms
2019-06-14 10:27:43,505 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - ca5b104e-5d4b-499b-9f87-b75880259d68: shutdown FollowerState
2019-06-14 10:27:43,505 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - ca5b104e-5d4b-499b-9f87-b75880259d68:group-0663B0B8C0FE changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:43,505 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - ca5b104e-5d4b-499b-9f87-b75880259d68: start LeaderElection
2019-06-14 10:27:43,512 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - ca5b104e-5d4b-499b-9f87-b75880259d68:group-0663B0B8C0FE:LeaderElection18: begin an election at term 1 for -1: [ca5b104e-5d4b-499b-9f87-b75880259d68:192.168.46.40:33641], old=null
2019-06-14 10:27:43,512 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - ca5b104e-5d4b-499b-9f87-b75880259d68: shutdown LeaderElection
2019-06-14 10:27:43,512 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - ca5b104e-5d4b-499b-9f87-b75880259d68:group-0663B0B8C0FE changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:27:43,512 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - ca5b104e-5d4b-499b-9f87-b75880259d68:group-0663B0B8C0FE change Leader from null to ca5b104e-5d4b-499b-9f87-b75880259d68 at term 1 for becomeLeader, leader elected after 1153ms
2019-06-14 10:27:43,512 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:27:43,512 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:27:43,512 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:27:43,513 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:27:43,513 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - ca5b104e-5d4b-499b-9f87-b75880259d68: start LeaderState
2019-06-14 10:27:43,513 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - ca5b104e-5d4b-499b-9f87-b75880259d68-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:43,513 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - ca5b104e-5d4b-499b-9f87-b75880259d68:group-0663B0B8C0FE set configuration 0: [ca5b104e-5d4b-499b-9f87-b75880259d68:192.168.46.40:33641], old=null at 0
2019-06-14 10:27:43,548 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - ca5b104e-5d4b-499b-9f87-b75880259d68-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-1/data/ratis/8d6ddf67-5d7d-4e39-8551-0663b0b8c0fe/current/log_inprogress_0
2019-06-14 10:27:43,562 INFO  impl.FollowerState (FollowerState.java:run(101)) - cdb26579-7e70-4e4e-af71-ded7b57c9157:group-486A20CAB2C9 changes to CANDIDATE, lastRpcTime:1001, electionTimeout:1001ms
2019-06-14 10:27:43,562 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: shutdown FollowerState
2019-06-14 10:27:43,562 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cdb26579-7e70-4e4e-af71-ded7b57c9157:group-486A20CAB2C9 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:43,563 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: start LeaderElection
2019-06-14 10:27:43,568 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - cdb26579-7e70-4e4e-af71-ded7b57c9157:group-486A20CAB2C9:LeaderElection19: begin an election at term 1 for -1: [27617c4a-5a35-4cec-830e-fa4967527a30:192.168.46.40:37339, cdb26579-7e70-4e4e-af71-ded7b57c9157:192.168.46.40:45485, ca5b104e-5d4b-499b-9f87-b75880259d68:192.168.46.40:33641], old=null
2019-06-14 10:27:43,573 INFO  impl.FollowerState (FollowerState.java:run(101)) - ca5b104e-5d4b-499b-9f87-b75880259d68:group-486A20CAB2C9 changes to CANDIDATE, lastRpcTime:1011, electionTimeout:1011ms
2019-06-14 10:27:43,573 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - ca5b104e-5d4b-499b-9f87-b75880259d68: shutdown FollowerState
2019-06-14 10:27:43,573 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - ca5b104e-5d4b-499b-9f87-b75880259d68:group-486A20CAB2C9 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:43,573 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - ca5b104e-5d4b-499b-9f87-b75880259d68: start LeaderElection
2019-06-14 10:27:43,580 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - ca5b104e-5d4b-499b-9f87-b75880259d68:group-486A20CAB2C9:LeaderElection20: begin an election at term 1 for -1: [27617c4a-5a35-4cec-830e-fa4967527a30:192.168.46.40:37339, cdb26579-7e70-4e4e-af71-ded7b57c9157:192.168.46.40:45485, ca5b104e-5d4b-499b-9f87-b75880259d68:192.168.46.40:33641], old=null
2019-06-14 10:27:43,586 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 27617c4a-5a35-4cec-830e-fa4967527a30:group-486A20CAB2C9 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:cdb26579-7e70-4e4e-af71-ded7b57c9157
2019-06-14 10:27:43,587 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 27617c4a-5a35-4cec-830e-fa4967527a30: shutdown FollowerState
2019-06-14 10:27:43,587 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 27617c4a-5a35-4cec-830e-fa4967527a30: start FollowerState
2019-06-14 10:27:43,587 INFO  impl.FollowerState (FollowerState.java:run(109)) - 27617c4a-5a35-4cec-830e-fa4967527a30: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:27:43,591 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - cdb26579-7e70-4e4e-af71-ded7b57c9157:group-486A20CAB2C9:LeaderElection19: Election PASSED; received 2 response(s) [cdb26579-7e70-4e4e-af71-ded7b57c9157->27617c4a-5a35-4cec-830e-fa4967527a30,true-t1, cdb26579-7e70-4e4e-af71-ded7b57c9157->ca5b104e-5d4b-499b-9f87-b75880259d68,false-t1] and 0 exception(s); cdb26579-7e70-4e4e-af71-ded7b57c9157:t1, leader=null, voted=cdb26579-7e70-4e4e-af71-ded7b57c9157, raftlog=cdb26579-7e70-4e4e-af71-ded7b57c9157-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [27617c4a-5a35-4cec-830e-fa4967527a30:192.168.46.40:37339, cdb26579-7e70-4e4e-af71-ded7b57c9157:192.168.46.40:45485, ca5b104e-5d4b-499b-9f87-b75880259d68:192.168.46.40:33641], old=null
2019-06-14 10:27:43,591 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: shutdown LeaderElection
2019-06-14 10:27:43,591 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cdb26579-7e70-4e4e-af71-ded7b57c9157:group-486A20CAB2C9 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:27:43,592 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - cdb26579-7e70-4e4e-af71-ded7b57c9157:group-486A20CAB2C9 change Leader from null to cdb26579-7e70-4e4e-af71-ded7b57c9157 at term 1 for becomeLeader, leader elected after 1041ms
2019-06-14 10:27:43,592 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:27:43,592 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:27:43,592 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:27:43,592 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:27:43,592 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:27:43,592 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:43,592 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:27:43,592 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:27:43,592 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:43,592 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:43,593 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:27:43,593 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:43,593 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:27:43,593 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:27:43,593 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:43,593 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:43,593 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: start LeaderState
2019-06-14 10:27:43,593 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - cdb26579-7e70-4e4e-af71-ded7b57c9157-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:43,595 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - cdb26579-7e70-4e4e-af71-ded7b57c9157:group-486A20CAB2C9 set configuration 0: [27617c4a-5a35-4cec-830e-fa4967527a30:192.168.46.40:37339, cdb26579-7e70-4e4e-af71-ded7b57c9157:192.168.46.40:45485, ca5b104e-5d4b-499b-9f87-b75880259d68:192.168.46.40:33641], old=null at 0
2019-06-14 10:27:43,595 INFO  impl.RaftServerImpl (RaftServerImpl.java:requestVote(738)) - cdb26579-7e70-4e4e-af71-ded7b57c9157-LEADER: Withhold vote from candidate ca5b104e-5d4b-499b-9f87-b75880259d68 with term 1. State: leader=cdb26579-7e70-4e4e-af71-ded7b57c9157, term=1, lastRpcElapsed=null
2019-06-14 10:27:43,613 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 27617c4a-5a35-4cec-830e-fa4967527a30:group-486A20CAB2C9 change Leader from null to cdb26579-7e70-4e4e-af71-ded7b57c9157 at term 1 for appendEntries, leader elected after 1065ms
2019-06-14 10:27:43,614 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - ca5b104e-5d4b-499b-9f87-b75880259d68:group-486A20CAB2C9 changes role from CANDIDATE to FOLLOWER at term 1 for appendEntries
2019-06-14 10:27:43,614 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - ca5b104e-5d4b-499b-9f87-b75880259d68:group-486A20CAB2C9:LeaderElection20: Election REJECTED; received 2 response(s) [ca5b104e-5d4b-499b-9f87-b75880259d68->27617c4a-5a35-4cec-830e-fa4967527a30,false-t1, ca5b104e-5d4b-499b-9f87-b75880259d68->cdb26579-7e70-4e4e-af71-ded7b57c9157,false-t1] and 0 exception(s); ca5b104e-5d4b-499b-9f87-b75880259d68:t1, leader=null, voted=ca5b104e-5d4b-499b-9f87-b75880259d68, raftlog=ca5b104e-5d4b-499b-9f87-b75880259d68-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [27617c4a-5a35-4cec-830e-fa4967527a30:192.168.46.40:37339, cdb26579-7e70-4e4e-af71-ded7b57c9157:192.168.46.40:45485, ca5b104e-5d4b-499b-9f87-b75880259d68:192.168.46.40:33641], old=null
2019-06-14 10:27:43,614 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - ca5b104e-5d4b-499b-9f87-b75880259d68: shutdown LeaderElection
2019-06-14 10:27:43,614 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - ca5b104e-5d4b-499b-9f87-b75880259d68: start FollowerState
2019-06-14 10:27:43,615 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - ca5b104e-5d4b-499b-9f87-b75880259d68:group-486A20CAB2C9 change Leader from null to cdb26579-7e70-4e4e-af71-ded7b57c9157 at term 1 for appendEntries, leader elected after 1064ms
2019-06-14 10:27:43,618 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 27617c4a-5a35-4cec-830e-fa4967527a30:group-486A20CAB2C9 set configuration 0: [27617c4a-5a35-4cec-830e-fa4967527a30:192.168.46.40:37339, cdb26579-7e70-4e4e-af71-ded7b57c9157:192.168.46.40:45485, ca5b104e-5d4b-499b-9f87-b75880259d68:192.168.46.40:33641], old=null at 0
2019-06-14 10:27:43,632 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 27617c4a-5a35-4cec-830e-fa4967527a30-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:43,633 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - ca5b104e-5d4b-499b-9f87-b75880259d68:group-486A20CAB2C9 set configuration 0: [27617c4a-5a35-4cec-830e-fa4967527a30:192.168.46.40:37339, cdb26579-7e70-4e4e-af71-ded7b57c9157:192.168.46.40:45485, ca5b104e-5d4b-499b-9f87-b75880259d68:192.168.46.40:33641], old=null at 0
2019-06-14 10:27:43,633 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - ca5b104e-5d4b-499b-9f87-b75880259d68-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:43,635 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - cdb26579-7e70-4e4e-af71-ded7b57c9157-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-0/data/ratis/94aa7427-62ab-4cbb-bfe5-486a20cab2c9/current/log_inprogress_0
2019-06-14 10:27:43,655 INFO  impl.FollowerState (FollowerState.java:run(101)) - 27617c4a-5a35-4cec-830e-fa4967527a30:group-D9A20DB564C6 changes to CANDIDATE, lastRpcTime:1128, electionTimeout:1128ms
2019-06-14 10:27:43,656 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 27617c4a-5a35-4cec-830e-fa4967527a30: shutdown FollowerState
2019-06-14 10:27:43,656 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 27617c4a-5a35-4cec-830e-fa4967527a30:group-D9A20DB564C6 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:43,656 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 27617c4a-5a35-4cec-830e-fa4967527a30: start LeaderElection
2019-06-14 10:27:43,698 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 27617c4a-5a35-4cec-830e-fa4967527a30:group-D9A20DB564C6:LeaderElection21: begin an election at term 1 for -1: [27617c4a-5a35-4cec-830e-fa4967527a30:192.168.46.40:37339], old=null
2019-06-14 10:27:43,699 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 27617c4a-5a35-4cec-830e-fa4967527a30: shutdown LeaderElection
2019-06-14 10:27:43,699 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 27617c4a-5a35-4cec-830e-fa4967527a30:group-D9A20DB564C6 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:27:43,699 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 27617c4a-5a35-4cec-830e-fa4967527a30:group-D9A20DB564C6 change Leader from null to 27617c4a-5a35-4cec-830e-fa4967527a30 at term 1 for becomeLeader, leader elected after 1173ms
2019-06-14 10:27:43,699 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:27:43,699 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:27:43,699 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:27:43,699 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 27617c4a-5a35-4cec-830e-fa4967527a30-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-2/data/ratis/94aa7427-62ab-4cbb-bfe5-486a20cab2c9/current/log_inprogress_0
2019-06-14 10:27:43,700 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:27:43,700 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 27617c4a-5a35-4cec-830e-fa4967527a30: start LeaderState
2019-06-14 10:27:43,701 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 27617c4a-5a35-4cec-830e-fa4967527a30-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:43,700 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - ca5b104e-5d4b-499b-9f87-b75880259d68-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-1/data/ratis/94aa7427-62ab-4cbb-bfe5-486a20cab2c9/current/log_inprogress_0
2019-06-14 10:27:43,705 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 27617c4a-5a35-4cec-830e-fa4967527a30:group-D9A20DB564C6 set configuration 0: [27617c4a-5a35-4cec-830e-fa4967527a30:192.168.46.40:37339], old=null at 0
2019-06-14 10:27:43,750 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 27617c4a-5a35-4cec-830e-fa4967527a30-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-2/data/ratis/84a578e0-932e-4061-9749-d9a20db564c6/current/log_inprogress_0
2019-06-14 10:27:43,751 INFO  impl.FollowerState (FollowerState.java:run(101)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7:group-861ECD30C7E6 changes to CANDIDATE, lastRpcTime:1037, electionTimeout:1037ms
2019-06-14 10:27:43,751 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: shutdown FollowerState
2019-06-14 10:27:43,751 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7:group-861ECD30C7E6 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:43,751 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: start LeaderElection
2019-06-14 10:27:43,758 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7:group-861ECD30C7E6:LeaderElection22: begin an election at term 1 for -1: [43635eb7-d1ac-47d7-8f50-5c051f2656f7:192.168.46.40:46645], old=null
2019-06-14 10:27:43,758 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: shutdown LeaderElection
2019-06-14 10:27:43,759 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7:group-861ECD30C7E6 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:27:43,759 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7:group-861ECD30C7E6 change Leader from null to 43635eb7-d1ac-47d7-8f50-5c051f2656f7 at term 1 for becomeLeader, leader elected after 1047ms
2019-06-14 10:27:43,759 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:27:43,759 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:27:43,759 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:27:43,759 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:27:43,759 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: start LeaderState
2019-06-14 10:27:43,760 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:43,760 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7:group-861ECD30C7E6 set configuration 0: [43635eb7-d1ac-47d7-8f50-5c051f2656f7:192.168.46.40:46645], old=null at 0
2019-06-14 10:27:43,795 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-3/data/ratis/66758ac0-d1bd-4444-ac04-861ecd30c7e6/current/log_inprogress_0
2019-06-14 10:27:43,954 INFO  impl.FollowerState (FollowerState.java:run(101)) - e8cf28ec-919d-46d9-8310-74643439f44d:group-C1EFFC3B474C changes to CANDIDATE, lastRpcTime:1059, electionTimeout:1059ms
2019-06-14 10:27:43,954 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e8cf28ec-919d-46d9-8310-74643439f44d: shutdown FollowerState
2019-06-14 10:27:43,954 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - e8cf28ec-919d-46d9-8310-74643439f44d:group-C1EFFC3B474C changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:43,954 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e8cf28ec-919d-46d9-8310-74643439f44d: start LeaderElection
2019-06-14 10:27:43,969 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - e8cf28ec-919d-46d9-8310-74643439f44d:group-C1EFFC3B474C:LeaderElection23: begin an election at term 1 for -1: [e8cf28ec-919d-46d9-8310-74643439f44d:192.168.46.40:43029], old=null
2019-06-14 10:27:43,969 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e8cf28ec-919d-46d9-8310-74643439f44d: shutdown LeaderElection
2019-06-14 10:27:43,969 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - e8cf28ec-919d-46d9-8310-74643439f44d:group-C1EFFC3B474C changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:27:43,969 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - e8cf28ec-919d-46d9-8310-74643439f44d:group-C1EFFC3B474C change Leader from null to e8cf28ec-919d-46d9-8310-74643439f44d at term 1 for becomeLeader, leader elected after 1076ms
2019-06-14 10:27:43,969 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:27:43,969 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:27:43,969 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:27:43,969 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:27:43,970 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e8cf28ec-919d-46d9-8310-74643439f44d: start LeaderState
2019-06-14 10:27:43,970 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - e8cf28ec-919d-46d9-8310-74643439f44d-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:43,970 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - e8cf28ec-919d-46d9-8310-74643439f44d:group-C1EFFC3B474C set configuration 0: [e8cf28ec-919d-46d9-8310-74643439f44d:192.168.46.40:43029], old=null at 0
2019-06-14 10:27:44,009 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - e8cf28ec-919d-46d9-8310-74643439f44d-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-4/data/ratis/44be8a53-06ab-49e7-b6ec-c1effc3b474c/current/log_inprogress_0
2019-06-14 10:27:44,068 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Cluster is ready. Got 6 of 6 DN Heartbeats.
2019-06-14 10:27:44,101 INFO  rpc.RpcClient (RpcClient.java:createVolume(289)) - Creating Volume: datanodefailurehandlingtest, with root as owner.
2019-06-14 10:27:44,110 INFO  rpc.RpcClient (RpcClient.java:createBucket(426)) - Creating Bucket: datanodefailurehandlingtest/datanodefailurehandlingtest, with Versioning false and Storage Type set to DISK and Encryption set to false 
2019-06-14 10:27:44,160 INFO  impl.FollowerState (FollowerState.java:run(101)) - e8cf28ec-919d-46d9-8310-74643439f44d:group-2D3C48945B1A changes to CANDIDATE, lastRpcTime:1044, electionTimeout:1043ms
2019-06-14 10:27:44,160 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e8cf28ec-919d-46d9-8310-74643439f44d: shutdown FollowerState
2019-06-14 10:27:44,161 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - e8cf28ec-919d-46d9-8310-74643439f44d:group-2D3C48945B1A changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:44,161 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e8cf28ec-919d-46d9-8310-74643439f44d: start LeaderElection
2019-06-14 10:27:44,167 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F8DAED685A70->ca5b104e-5d4b-499b-9f87-b75880259d68: receive RaftClientReply:client-F8DAED685A70->ca5b104e-5d4b-499b-9f87-b75880259d68@group-486A20CAB2C9, cid=35, FAILED org.apache.ratis.protocol.NotLeaderException: Server ca5b104e-5d4b-499b-9f87-b75880259d68 is not the leader (cdb26579-7e70-4e4e-af71-ded7b57c9157:192.168.46.40:45485). Request must be sent to leader., logIndex=0, commits[ca5b104e-5d4b-499b-9f87-b75880259d68:c-1, 27617c4a-5a35-4cec-830e-fa4967527a30:c-1, cdb26579-7e70-4e4e-af71-ded7b57c9157:c-1]
2019-06-14 10:27:44,173 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:27:44,173 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - e8cf28ec-919d-46d9-8310-74643439f44d:group-2D3C48945B1A:LeaderElection24: begin an election at term 1 for -1: [43635eb7-d1ac-47d7-8f50-5c051f2656f7:192.168.46.40:46645, 1a945b57-ef45-49ed-92c5-75ee453031c6:192.168.46.40:42123, e8cf28ec-919d-46d9-8310-74643439f44d:192.168.46.40:43029], old=null
2019-06-14 10:27:44,187 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1a945b57-ef45-49ed-92c5-75ee453031c6:group-2D3C48945B1A changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:e8cf28ec-919d-46d9-8310-74643439f44d
2019-06-14 10:27:44,187 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: shutdown FollowerState
2019-06-14 10:27:44,187 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: start FollowerState
2019-06-14 10:27:44,187 INFO  impl.FollowerState (FollowerState.java:run(109)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:27:44,191 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7:group-2D3C48945B1A changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:e8cf28ec-919d-46d9-8310-74643439f44d
2019-06-14 10:27:44,191 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: shutdown FollowerState
2019-06-14 10:27:44,192 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: start FollowerState
2019-06-14 10:27:44,192 INFO  impl.FollowerState (FollowerState.java:run(109)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:27:44,194 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - e8cf28ec-919d-46d9-8310-74643439f44d:group-2D3C48945B1A:LeaderElection24: Election PASSED; received 1 response(s) [e8cf28ec-919d-46d9-8310-74643439f44d->1a945b57-ef45-49ed-92c5-75ee453031c6,true-t1] and 0 exception(s); e8cf28ec-919d-46d9-8310-74643439f44d:t1, leader=null, voted=e8cf28ec-919d-46d9-8310-74643439f44d, raftlog=e8cf28ec-919d-46d9-8310-74643439f44d-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [43635eb7-d1ac-47d7-8f50-5c051f2656f7:192.168.46.40:46645, 1a945b57-ef45-49ed-92c5-75ee453031c6:192.168.46.40:42123, e8cf28ec-919d-46d9-8310-74643439f44d:192.168.46.40:43029], old=null
2019-06-14 10:27:44,194 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e8cf28ec-919d-46d9-8310-74643439f44d: shutdown LeaderElection
2019-06-14 10:27:44,194 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - e8cf28ec-919d-46d9-8310-74643439f44d:group-2D3C48945B1A changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:27:44,195 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - e8cf28ec-919d-46d9-8310-74643439f44d:group-2D3C48945B1A change Leader from null to e8cf28ec-919d-46d9-8310-74643439f44d at term 1 for becomeLeader, leader elected after 1083ms
2019-06-14 10:27:44,195 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:27:44,195 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:27:44,195 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:27:44,195 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:27:44,195 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:27:44,195 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:44,196 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:27:44,196 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:27:44,196 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:44,196 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:44,196 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:27:44,196 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:44,196 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:27:44,197 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:27:44,197 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:44,197 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:44,197 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e8cf28ec-919d-46d9-8310-74643439f44d: start LeaderState
2019-06-14 10:27:44,197 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - e8cf28ec-919d-46d9-8310-74643439f44d-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:44,222 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7:group-2D3C48945B1A change Leader from null to e8cf28ec-919d-46d9-8310-74643439f44d at term 1 for appendEntries, leader elected after 1112ms
2019-06-14 10:27:44,240 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - e8cf28ec-919d-46d9-8310-74643439f44d:group-2D3C48945B1A set configuration 0: [43635eb7-d1ac-47d7-8f50-5c051f2656f7:192.168.46.40:46645, 1a945b57-ef45-49ed-92c5-75ee453031c6:192.168.46.40:42123, e8cf28ec-919d-46d9-8310-74643439f44d:192.168.46.40:43029], old=null at 0
2019-06-14 10:27:44,240 INFO  impl.FollowerState (FollowerState.java:run(101)) - 1a945b57-ef45-49ed-92c5-75ee453031c6:group-7D5F67A37EDB changes to CANDIDATE, lastRpcTime:1152, electionTimeout:1131ms
2019-06-14 10:27:44,244 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - e8cf28ec-919d-46d9-8310-74643439f44d-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-4/data/ratis/8e403484-69ec-4b76-9671-2d3c48945b1a/current/log_inprogress_0
2019-06-14 10:27:44,245 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: shutdown FollowerState
2019-06-14 10:27:44,245 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1a945b57-ef45-49ed-92c5-75ee453031c6:group-7D5F67A37EDB changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:44,245 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: start LeaderElection
2019-06-14 10:27:44,247 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 1a945b57-ef45-49ed-92c5-75ee453031c6:group-2D3C48945B1A change Leader from null to e8cf28ec-919d-46d9-8310-74643439f44d at term 1 for appendEntries, leader elected after 1136ms
2019-06-14 10:27:44,251 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7:group-2D3C48945B1A set configuration 0: [43635eb7-d1ac-47d7-8f50-5c051f2656f7:192.168.46.40:46645, 1a945b57-ef45-49ed-92c5-75ee453031c6:192.168.46.40:42123, e8cf28ec-919d-46d9-8310-74643439f44d:192.168.46.40:43029], old=null at 0
2019-06-14 10:27:44,251 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 1a945b57-ef45-49ed-92c5-75ee453031c6:group-7D5F67A37EDB:LeaderElection25: begin an election at term 1 for -1: [1a945b57-ef45-49ed-92c5-75ee453031c6:192.168.46.40:42123], old=null
2019-06-14 10:27:44,251 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:44,251 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: shutdown LeaderElection
2019-06-14 10:27:44,251 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1a945b57-ef45-49ed-92c5-75ee453031c6:group-7D5F67A37EDB changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:27:44,252 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 1a945b57-ef45-49ed-92c5-75ee453031c6:group-7D5F67A37EDB change Leader from null to 1a945b57-ef45-49ed-92c5-75ee453031c6 at term 1 for becomeLeader, leader elected after 1165ms
2019-06-14 10:27:44,252 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:27:44,252 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:27:44,252 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:27:44,252 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:27:44,252 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: start LeaderState
2019-06-14 10:27:44,252 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 1a945b57-ef45-49ed-92c5-75ee453031c6-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:44,253 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 1a945b57-ef45-49ed-92c5-75ee453031c6:group-7D5F67A37EDB set configuration 0: [1a945b57-ef45-49ed-92c5-75ee453031c6:192.168.46.40:42123], old=null at 0
2019-06-14 10:27:44,287 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 1a945b57-ef45-49ed-92c5-75ee453031c6:group-2D3C48945B1A set configuration 0: [43635eb7-d1ac-47d7-8f50-5c051f2656f7:192.168.46.40:46645, 1a945b57-ef45-49ed-92c5-75ee453031c6:192.168.46.40:42123, e8cf28ec-919d-46d9-8310-74643439f44d:192.168.46.40:43029], old=null at 0
2019-06-14 10:27:44,287 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 1a945b57-ef45-49ed-92c5-75ee453031c6-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:44,312 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 1a945b57-ef45-49ed-92c5-75ee453031c6-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-5/data/ratis/94648977-6e3a-43c4-bcaf-7d5f67a37edb/current/log_inprogress_0
2019-06-14 10:27:44,312 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-3/data/ratis/8e403484-69ec-4b76-9671-2d3c48945b1a/current/log_inprogress_0
2019-06-14 10:27:44,330 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 1a945b57-ef45-49ed-92c5-75ee453031c6-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-5/data/ratis/8e403484-69ec-4b76-9671-2d3c48945b1a/current/log_inprogress_0
2019-06-14 10:27:45,180 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F8DAED685A70->27617c4a-5a35-4cec-830e-fa4967527a30: receive RaftClientReply:client-F8DAED685A70->27617c4a-5a35-4cec-830e-fa4967527a30@group-486A20CAB2C9, cid=35, FAILED org.apache.ratis.protocol.NotLeaderException: Server 27617c4a-5a35-4cec-830e-fa4967527a30 is not the leader (cdb26579-7e70-4e4e-af71-ded7b57c9157:192.168.46.40:45485). Request must be sent to leader., logIndex=0, commits[27617c4a-5a35-4cec-830e-fa4967527a30:c0, cdb26579-7e70-4e4e-af71-ded7b57c9157:c0, ca5b104e-5d4b-499b-9f87-b75880259d68:c0]
2019-06-14 10:27:45,183 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:27:46,250 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F8DAED685A70->ca5b104e-5d4b-499b-9f87-b75880259d68: receive RaftClientReply:client-F8DAED685A70->ca5b104e-5d4b-499b-9f87-b75880259d68@group-486A20CAB2C9, cid=35, FAILED org.apache.ratis.protocol.NotLeaderException: Server ca5b104e-5d4b-499b-9f87-b75880259d68 is not the leader (cdb26579-7e70-4e4e-af71-ded7b57c9157:192.168.46.40:45485). Request must be sent to leader., logIndex=0, commits[ca5b104e-5d4b-499b-9f87-b75880259d68:c0, 27617c4a-5a35-4cec-830e-fa4967527a30:c0, cdb26579-7e70-4e4e-af71-ded7b57c9157:c0]
2019-06-14 10:27:46,256 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:27:47,302 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F8DAED685A70->cdb26579-7e70-4e4e-af71-ded7b57c9157: receive RaftClientReply:client-F8DAED685A70->cdb26579-7e70-4e4e-af71-ded7b57c9157@group-486A20CAB2C9, cid=35, SUCCESS, logIndex=1, commits[cdb26579-7e70-4e4e-af71-ded7b57c9157:c1, 27617c4a-5a35-4cec-830e-fa4967527a30:c0, ca5b104e-5d4b-499b-9f87-b75880259d68:c0]
2019-06-14 10:27:47,328 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F8DAED685A70->cdb26579-7e70-4e4e-af71-ded7b57c9157: receive RaftClientReply:client-F8DAED685A70->cdb26579-7e70-4e4e-af71-ded7b57c9157@group-486A20CAB2C9, cid=36, SUCCESS, logIndex=3, commits[cdb26579-7e70-4e4e-af71-ded7b57c9157:c4, 27617c4a-5a35-4cec-830e-fa4967527a30:c3, ca5b104e-5d4b-499b-9f87-b75880259d68:c3]
2019-06-14 10:27:47,330 INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #1
2019-06-14 10:27:47,331 INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #1
2019-06-14 10:27:47,332 INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #1
2019-06-14 10:27:49,314 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 1 is closed with bcsId 3.
2019-06-14 10:27:49,314 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 1 is closed with bcsId 3.
2019-06-14 10:27:49,321 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 1 is closed with bcsId 3.
10:27:49.338 [grpc-default-executor-0] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 1 locID: 102269456490299396 bcsId: 3} | ret=FAILURE
org.apache.hadoop.hdds.scm.container.common.helpers.ContainerNotOpenException: Container 1 in CLOSED state
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.validateContainerCommand(HddsDispatcher.java:408) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.startTransaction(ContainerStateMachine.java:269) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.ratis.server.impl.RaftServerImpl.submitClientRequestAsync(RaftServerImpl.java:550) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$submitClientRequestAsync$7(RaftServerProxy.java:333) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$5(RaftServerProxy.java:328) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:109) ~[ratis-common-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$submitRequest$6(RaftServerProxy.java:328) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:981) ~[?:1.8.0_212]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2124) ~[?:1.8.0_212]
	at org.apache.ratis.server.impl.RaftServerProxy.submitRequest(RaftServerProxy.java:327) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.submitClientRequestAsync(RaftServerProxy.java:333) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:206) ~[ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$OrderedRequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:306) ~[ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.util.SlidingWindow$Server.processRequestsFromHead(SlidingWindow.java:399) [ratis-common-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.util.SlidingWindow$Server.receivedRequest(SlidingWindow.java:391) [ratis-common-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$OrderedRequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:312) [ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.onNext(GrpcClientProtocolService.java:226) [ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.onNext(GrpcClientProtocolService.java:154) [ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:248) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:263) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:686) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-06-14 10:27:49,366 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F8DAED685A70->cdb26579-7e70-4e4e-af71-ded7b57c9157: receive RaftClientReply:client-F8DAED685A70->cdb26579-7e70-4e4e-af71-ded7b57c9157@group-486A20CAB2C9, cid=37, FAILED org.apache.ratis.protocol.StateMachineException: org.apache.hadoop.hdds.scm.container.common.helpers.ContainerNotOpenException from Server cdb26579-7e70-4e4e-af71-ded7b57c9157: Container 1 in CLOSED state, logIndex=0, commits[cdb26579-7e70-4e4e-af71-ded7b57c9157:c6, 27617c4a-5a35-4cec-830e-fa4967527a30:c5, ca5b104e-5d4b-499b-9f87-b75880259d68:c5]
10:27:49.366 [grpc-default-executor-0] ERROR DNAudit - user=null | ip=null | op=PUT_BLOCK {blockData=[blockId=conID: 1 locID: 102269456490299396 bcsId: 0,size=2097152]} | ret=FAILURE
org.apache.hadoop.hdds.scm.container.common.helpers.ContainerNotOpenException: Container 1 in CLOSED state
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.validateContainerCommand(HddsDispatcher.java:408) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.startTransaction(ContainerStateMachine.java:269) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.ratis.server.impl.RaftServerImpl.submitClientRequestAsync(RaftServerImpl.java:550) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$submitClientRequestAsync$7(RaftServerProxy.java:333) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$5(RaftServerProxy.java:328) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:109) ~[ratis-common-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$submitRequest$6(RaftServerProxy.java:328) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:981) ~[?:1.8.0_212]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2124) ~[?:1.8.0_212]
	at org.apache.ratis.server.impl.RaftServerProxy.submitRequest(RaftServerProxy.java:327) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.submitClientRequestAsync(RaftServerProxy.java:333) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:206) ~[ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$OrderedRequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:306) ~[ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.util.SlidingWindow$Server.processRequestsFromHead(SlidingWindow.java:399) [ratis-common-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.util.SlidingWindow$Server.receivedRequest(SlidingWindow.java:391) [ratis-common-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$OrderedRequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:312) [ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.onNext(GrpcClientProtocolService.java:226) [ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.onNext(GrpcClientProtocolService.java:154) [ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:248) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:263) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:686) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-06-14 10:27:49,371 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F8DAED685A70->cdb26579-7e70-4e4e-af71-ded7b57c9157: receive RaftClientReply:client-F8DAED685A70->cdb26579-7e70-4e4e-af71-ded7b57c9157@group-486A20CAB2C9, cid=38, FAILED org.apache.ratis.protocol.StateMachineException: org.apache.hadoop.hdds.scm.container.common.helpers.ContainerNotOpenException from Server cdb26579-7e70-4e4e-af71-ded7b57c9157: Container 1 in CLOSED state, logIndex=0, commits[cdb26579-7e70-4e4e-af71-ded7b57c9157:c6, 27617c4a-5a35-4cec-830e-fa4967527a30:c5, ca5b104e-5d4b-499b-9f87-b75880259d68:c5]
2019-06-14 10:27:49,434 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F8DAED685A70->cdb26579-7e70-4e4e-af71-ded7b57c9157: receive RaftClientReply:client-F8DAED685A70->cdb26579-7e70-4e4e-af71-ded7b57c9157@group-486A20CAB2C9, cid=39, SUCCESS, logIndex=7, commits[cdb26579-7e70-4e4e-af71-ded7b57c9157:c7, 27617c4a-5a35-4cec-830e-fa4967527a30:c6, ca5b104e-5d4b-499b-9f87-b75880259d68:c5]
2019-06-14 10:27:49,465 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F8DAED685A70->cdb26579-7e70-4e4e-af71-ded7b57c9157: receive RaftClientReply:client-F8DAED685A70->cdb26579-7e70-4e4e-af71-ded7b57c9157@group-486A20CAB2C9, cid=40, SUCCESS, logIndex=9, commits[cdb26579-7e70-4e4e-af71-ded7b57c9157:c10, 27617c4a-5a35-4cec-830e-fa4967527a30:c9, ca5b104e-5d4b-499b-9f87-b75880259d68:c9]
2019-06-14 10:27:49,567 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:shutdown(321)) - Shutting down the Mini Ozone Cluster
2019-06-14 10:27:49,567 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(336)) - Stopping the Mini Ozone Cluster
2019-06-14 10:27:49,568 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(338)) - Stopping the OzoneManager
2019-06-14 10:27:49,568 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 40509
2019-06-14 10:27:49,577 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 40509
2019-06-14 10:27:49,577 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service KeyDeletingService
2019-06-14 10:27:49,579 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-14 10:27:49,579 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@18e4551{/,null,UNAVAILABLE}{/ozoneManager}
2019-06-14 10:27:49,580 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@3ea48c37{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:27:49,580 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@c758a2d{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,UNAVAILABLE}
2019-06-14 10:27:49,580 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@36dafa24{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:27:49,582 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(344)) - Stopping the StorageContainerManager
2019-06-14 10:27:49,582 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(789)) - Stopping Replication Manager Service.
2019-06-14 10:27:49,582 INFO  container.ReplicationManager (ReplicationManager.java:stop(191)) - Replication Monitor Thread is not running.
2019-06-14 10:27:49,582 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(796)) - Stopping Lease Manager of the command watchers
2019-06-14 10:27:49,582 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(803)) - Stopping datanode service RPC server
2019-06-14 10:27:49,582 INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(373)) - Stopping the RPC server for DataNodes
2019-06-14 10:27:49,582 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 43565
2019-06-14 10:27:49,585 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 43565
2019-06-14 10:27:49,585 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-14 10:27:49,586 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(811)) - Stopping block service RPC server
2019-06-14 10:27:49,586 INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(145)) - Stopping the RPC server for Block Protocol
2019-06-14 10:27:49,586 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 34375
2019-06-14 10:27:49,588 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 34375
2019-06-14 10:27:49,589 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-14 10:27:49,589 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(818)) - Stopping the StorageContainerLocationProtocol RPC server
2019-06-14 10:27:49,590 INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(157)) - Stopping the RPC server for Client Protocol
2019-06-14 10:27:49,590 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 36547
2019-06-14 10:27:49,592 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-14 10:27:49,592 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(825)) - Stopping Storage Container Manager HTTP server.
2019-06-14 10:27:49,592 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 36547
2019-06-14 10:27:49,593 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@5280688{/,null,UNAVAILABLE}{/scm}
2019-06-14 10:27:49,595 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@643f6179{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:27:49,595 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@31228d83{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,UNAVAILABLE}
2019-06-14 10:27:49,595 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@7afe0e67{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:27:49,596 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(836)) - Stopping Block Manager Service.
2019-06-14 10:27:49,596 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service SCMBlockDeletingService
2019-06-14 10:27:49,597 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service SCMBlockDeletingService
2019-06-14 10:27:49,597 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(858)) - Stopping SCM Event Queue.
2019-06-14 10:27:49,600 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(350)) - Shutting the HddsDatanodes
2019-06-14 10:27:49,600 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:27:49,600 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@259195fe
2019-06-14 10:27:49,600 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:27:49,601 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:27:49,601 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: close
2019-06-14 10:27:49,601 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: shutdown group-486A20CAB2C9
2019-06-14 10:27:49,601 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: shutdown group-2CFE4D2BC0C7
2019-06-14 10:27:49,601 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-486A20CAB2C9,id=cdb26579-7e70-4e4e-af71-ded7b57c9157
2019-06-14 10:27:49,601 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-2CFE4D2BC0C7,id=cdb26579-7e70-4e4e-af71-ded7b57c9157
2019-06-14 10:27:49,601 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: shutdown LeaderState
2019-06-14 10:27:49,602 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: shutdown LeaderState
2019-06-14 10:27:49,602 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(cdb26579-7e70-4e4e-af71-ded7b57c9157 -> ca5b104e-5d4b-499b-9f87-b75880259d68): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:27:49,602 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - cdb26579-7e70-4e4e-af71-ded7b57c9157-PendingRequests: sendNotLeaderResponses
2019-06-14 10:27:49,602 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(cdb26579-7e70-4e4e-af71-ded7b57c9157 -> 27617c4a-5a35-4cec-830e-fa4967527a30): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:27:49,602 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - ca5b104e-5d4b-499b-9f87-b75880259d68: appendEntries completed
2019-06-14 10:27:49,604 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-cdb26579-7e70-4e4e-af71-ded7b57c9157-group-486A20CAB2C9: set stopIndex = 10
2019-06-14 10:27:49,605 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 27617c4a-5a35-4cec-830e-fa4967527a30: appendEntries completed
2019-06-14 10:27:49,605 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: follower cdb26579-7e70-4e4e-af71-ded7b57c9157->ca5b104e-5d4b-499b-9f87-b75880259d68(c9,m10,n11, attendVote=true, lastRpcSendTime=154, lastRpcResponseTime=151) response Completed
2019-06-14 10:27:49,602 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - cdb26579-7e70-4e4e-af71-ded7b57c9157-PendingRequests: sendNotLeaderResponses
2019-06-14 10:27:49,606 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - cdb26579-7e70-4e4e-af71-ded7b57c9157->ca5b104e-5d4b-499b-9f87-b75880259d68: nextIndex: updateUnconditionally 11 -> 0
2019-06-14 10:27:49,607 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:27:49,604 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:10)
2019-06-14 10:27:49,607 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-0/data/ratis/94aa7427-62ab-4cbb-bfe5-486a20cab2c9/sm/snapshot.1_10
2019-06-14 10:27:49,607 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - cdb26579-7e70-4e4e-af71-ded7b57c9157:group-486A20CAB2C9 closes. The last applied log index is 10
2019-06-14 10:27:49,606 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-cdb26579-7e70-4e4e-af71-ded7b57c9157-group-2CFE4D2BC0C7: set stopIndex = 0
2019-06-14 10:27:49,607 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - cdb26579-7e70-4e4e-af71-ded7b57c9157-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:49,607 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - cdb26579-7e70-4e4e-af71-ded7b57c9157:group-2CFE4D2BC0C7 closes. The last applied log index is 0
2019-06-14 10:27:49,607 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: follower cdb26579-7e70-4e4e-af71-ded7b57c9157->27617c4a-5a35-4cec-830e-fa4967527a30(c9,m10,n11, attendVote=true, lastRpcSendTime=156, lastRpcResponseTime=151) response Completed
2019-06-14 10:27:49,609 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - cdb26579-7e70-4e4e-af71-ded7b57c9157-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:49,611 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - cdb26579-7e70-4e4e-af71-ded7b57c9157-RaftLogWorker close()
2019-06-14 10:27:49,611 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - cdb26579-7e70-4e4e-af71-ded7b57c9157->27617c4a-5a35-4cec-830e-fa4967527a30: nextIndex: updateUnconditionally 11 -> -1
2019-06-14 10:27:49,611 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - cdb26579-7e70-4e4e-af71-ded7b57c9157-RaftLogWorker close()
2019-06-14 10:27:49,615 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: shutdown server with port 45485 now
2019-06-14 10:27:49,617 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - cdb26579-7e70-4e4e-af71-ded7b57c9157: shutdown server with port 45485 successfully
2019-06-14 10:27:49,619 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:27:49,630 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:27:49,631 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@45cd8607{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:27:49,631 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@4d492a9{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:27:49,632 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@53e93fb7{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:27:49,632 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@4a6a6a69{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:27:49,632 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:27:49,633 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@60ed0b9d
2019-06-14 10:27:49,634 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:27:49,634 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:27:49,634 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - ca5b104e-5d4b-499b-9f87-b75880259d68: close
2019-06-14 10:27:49,634 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - ca5b104e-5d4b-499b-9f87-b75880259d68: shutdown group-486A20CAB2C9
2019-06-14 10:27:49,634 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - ca5b104e-5d4b-499b-9f87-b75880259d68: shutdown group-0663B0B8C0FE
2019-06-14 10:27:49,634 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-486A20CAB2C9,id=ca5b104e-5d4b-499b-9f87-b75880259d68
2019-06-14 10:27:49,634 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-0663B0B8C0FE,id=ca5b104e-5d4b-499b-9f87-b75880259d68
2019-06-14 10:27:49,635 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - ca5b104e-5d4b-499b-9f87-b75880259d68: shutdown FollowerState
2019-06-14 10:27:49,635 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - ca5b104e-5d4b-499b-9f87-b75880259d68: shutdown LeaderState
2019-06-14 10:27:49,635 INFO  impl.FollowerState (FollowerState.java:run(109)) - ca5b104e-5d4b-499b-9f87-b75880259d68: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:27:49,635 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:9)
2019-06-14 10:27:49,636 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-1/data/ratis/94aa7427-62ab-4cbb-bfe5-486a20cab2c9/sm/snapshot.1_9
2019-06-14 10:27:49,635 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-ca5b104e-5d4b-499b-9f87-b75880259d68-group-486A20CAB2C9: set stopIndex = 9
2019-06-14 10:27:49,635 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - ca5b104e-5d4b-499b-9f87-b75880259d68-PendingRequests: sendNotLeaderResponses
2019-06-14 10:27:49,636 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - ca5b104e-5d4b-499b-9f87-b75880259d68:group-486A20CAB2C9 closes. The last applied log index is 9
2019-06-14 10:27:49,639 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - ca5b104e-5d4b-499b-9f87-b75880259d68-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:49,639 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-ca5b104e-5d4b-499b-9f87-b75880259d68-group-0663B0B8C0FE: set stopIndex = 0
2019-06-14 10:27:49,640 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:27:49,641 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - ca5b104e-5d4b-499b-9f87-b75880259d68:group-0663B0B8C0FE closes. The last applied log index is 0
2019-06-14 10:27:49,641 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - ca5b104e-5d4b-499b-9f87-b75880259d68-RaftLogWorker close()
2019-06-14 10:27:49,642 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - ca5b104e-5d4b-499b-9f87-b75880259d68-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:49,645 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - ca5b104e-5d4b-499b-9f87-b75880259d68-RaftLogWorker close()
2019-06-14 10:27:49,647 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - ca5b104e-5d4b-499b-9f87-b75880259d68: shutdown server with port 33641 now
2019-06-14 10:27:49,650 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - ca5b104e-5d4b-499b-9f87-b75880259d68: shutdown server with port 33641 successfully
2019-06-14 10:27:49,653 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:27:49,666 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:27:49,667 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@4c5f7b4f{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:27:49,669 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@4b544732{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:27:49,670 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@1a10c47e{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:27:49,670 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@1fb6b8fb{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:27:49,672 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:27:49,673 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@29f3185c
2019-06-14 10:27:49,673 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:27:49,673 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:27:49,673 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 27617c4a-5a35-4cec-830e-fa4967527a30: close
2019-06-14 10:27:49,674 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 27617c4a-5a35-4cec-830e-fa4967527a30: shutdown group-486A20CAB2C9
2019-06-14 10:27:49,674 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-486A20CAB2C9,id=27617c4a-5a35-4cec-830e-fa4967527a30
2019-06-14 10:27:49,674 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 27617c4a-5a35-4cec-830e-fa4967527a30: shutdown FollowerState
2019-06-14 10:27:49,674 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-27617c4a-5a35-4cec-830e-fa4967527a30-group-486A20CAB2C9: set stopIndex = 9
2019-06-14 10:27:49,674 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:9)
2019-06-14 10:27:49,675 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-4f374ca9-3e0c-4d2b-8262-179da854953e/datanode-2/data/ratis/94aa7427-62ab-4cbb-bfe5-486a20cab2c9/sm/snapshot.1_9
2019-06-14 10:27:49,675 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 27617c4a-5a35-4cec-830e-fa4967527a30:group-486A20CAB2C9 closes. The last applied log index is 9
2019-06-14 10:27:49,674 INFO  impl.FollowerState (FollowerState.java:run(109)) - 27617c4a-5a35-4cec-830e-fa4967527a30: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:27:49,675 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 27617c4a-5a35-4cec-830e-fa4967527a30-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:49,678 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 27617c4a-5a35-4cec-830e-fa4967527a30-RaftLogWorker close()
2019-06-14 10:27:49,680 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 27617c4a-5a35-4cec-830e-fa4967527a30: shutdown group-D9A20DB564C6
2019-06-14 10:27:49,681 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D9A20DB564C6,id=27617c4a-5a35-4cec-830e-fa4967527a30
2019-06-14 10:27:49,681 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 27617c4a-5a35-4cec-830e-fa4967527a30: shutdown LeaderState
2019-06-14 10:27:49,681 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 27617c4a-5a35-4cec-830e-fa4967527a30-PendingRequests: sendNotLeaderResponses
2019-06-14 10:27:49,687 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-27617c4a-5a35-4cec-830e-fa4967527a30-group-D9A20DB564C6: set stopIndex = 0
2019-06-14 10:27:49,687 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:27:49,687 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 27617c4a-5a35-4cec-830e-fa4967527a30:group-D9A20DB564C6 closes. The last applied log index is 0
2019-06-14 10:27:49,687 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 27617c4a-5a35-4cec-830e-fa4967527a30-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:49,689 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 27617c4a-5a35-4cec-830e-fa4967527a30-RaftLogWorker close()
2019-06-14 10:27:49,691 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 27617c4a-5a35-4cec-830e-fa4967527a30: shutdown server with port 37339 now
2019-06-14 10:27:49,692 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 27617c4a-5a35-4cec-830e-fa4967527a30: shutdown server with port 37339 successfully
2019-06-14 10:27:49,693 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:27:49,700 ERROR statemachine.EndpointStateMachine (EndpointStateMachine.java:logIfNeeded(204)) - Unable to communicate to SCM server at 0.0.0.0:43565 for past 0 seconds.
java.io.EOFException: End of File Exception between local host is: "ozone-cf6ld-438179620/192.168.46.40"; destination host is: "0.0.0.0":43565; : java.io.EOFException; For more details see:  http://wiki.apache.org/hadoop/EOFException
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:831)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:789)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1515)
	at org.apache.hadoop.ipc.Client.call(Client.java:1457)
	at org.apache.hadoop.ipc.Client.call(Client.java:1367)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:228)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:116)
	at com.sun.proxy.$Proxy82.sendHeartbeat(Unknown Source)
	at org.apache.hadoop.ozone.protocolPB.StorageContainerDatanodeProtocolClientSideTranslatorPB.sendHeartbeat(StorageContainerDatanodeProtocolClientSideTranslatorPB.java:131)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:139)
	at org.apache.hadoop.ozone.container.common.states.endpoint.HeartbeatEndpointTask.call(HeartbeatEndpointTask.java:74)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.hadoop.ipc.Client$IpcStreams.readResponse(Client.java:1816)
	at org.apache.hadoop.ipc.Client$Connection.receiveRpcResponse(Client.java:1173)
	at org.apache.hadoop.ipc.Client$Connection.run(Client.java:1069)
2019-06-14 10:27:49,707 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:27:49,707 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@3dbb3fb7{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:27:49,708 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@68a426c3{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:27:49,708 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@7d088813{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:27:49,709 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@48fc0211{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:27:49,710 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:27:49,710 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@32b95de
2019-06-14 10:27:49,710 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:27:49,710 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:27:49,711 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: close
2019-06-14 10:27:49,711 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: shutdown group-861ECD30C7E6
2019-06-14 10:27:49,711 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: shutdown group-2D3C48945B1A
2019-06-14 10:27:49,711 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-861ECD30C7E6,id=43635eb7-d1ac-47d7-8f50-5c051f2656f7
2019-06-14 10:27:49,711 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-2D3C48945B1A,id=43635eb7-d1ac-47d7-8f50-5c051f2656f7
2019-06-14 10:27:49,712 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: shutdown FollowerState
2019-06-14 10:27:49,712 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: shutdown LeaderState
2019-06-14 10:27:49,712 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:27:49,712 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-43635eb7-d1ac-47d7-8f50-5c051f2656f7-group-2D3C48945B1A: set stopIndex = 0
2019-06-14 10:27:49,712 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7-PendingRequests: sendNotLeaderResponses
2019-06-14 10:27:49,712 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7:group-2D3C48945B1A closes. The last applied log index is 0
2019-06-14 10:27:49,713 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:27:49,713 INFO  impl.FollowerState (FollowerState.java:run(109)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:27:49,713 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-43635eb7-d1ac-47d7-8f50-5c051f2656f7-group-861ECD30C7E6: set stopIndex = 0
2019-06-14 10:27:49,713 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:49,715 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7:group-861ECD30C7E6 closes. The last applied log index is 0
2019-06-14 10:27:49,716 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7-RaftLogWorker close()
2019-06-14 10:27:49,716 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:49,722 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7-RaftLogWorker close()
2019-06-14 10:27:49,723 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: shutdown server with port 46645 now
2019-06-14 10:27:49,726 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:27:49,726 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 43635eb7-d1ac-47d7-8f50-5c051f2656f7: shutdown server with port 46645 successfully
2019-06-14 10:27:49,726 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - e8cf28ec-919d-46d9-8310-74643439f44d: Failed appendEntries to 43635eb7-d1ac-47d7-8f50-5c051f2656f7:192.168.46.40:46645: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-14 10:27:49,727 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - e8cf28ec-919d-46d9-8310-74643439f44d->43635eb7-d1ac-47d7-8f50-5c051f2656f7: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:27:49,728 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:27:49,739 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:27:49,739 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@44492c06{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:27:49,740 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@5c4714ef{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:27:49,740 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@77ba583{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:27:49,741 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@6f7a20da{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:27:49,741 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:27:49,742 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@12be4f83
2019-06-14 10:27:49,742 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:27:49,742 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:27:49,742 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - e8cf28ec-919d-46d9-8310-74643439f44d: close
2019-06-14 10:27:49,743 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - e8cf28ec-919d-46d9-8310-74643439f44d: shutdown group-2D3C48945B1A
2019-06-14 10:27:49,743 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - e8cf28ec-919d-46d9-8310-74643439f44d: shutdown group-C1EFFC3B474C
2019-06-14 10:27:49,743 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-2D3C48945B1A,id=e8cf28ec-919d-46d9-8310-74643439f44d
2019-06-14 10:27:49,743 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C1EFFC3B474C,id=e8cf28ec-919d-46d9-8310-74643439f44d
2019-06-14 10:27:49,743 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e8cf28ec-919d-46d9-8310-74643439f44d: shutdown LeaderState
2019-06-14 10:27:49,743 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e8cf28ec-919d-46d9-8310-74643439f44d: shutdown LeaderState
2019-06-14 10:27:49,743 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - e8cf28ec-919d-46d9-8310-74643439f44d-PendingRequests: sendNotLeaderResponses
2019-06-14 10:27:49,744 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(e8cf28ec-919d-46d9-8310-74643439f44d -> 43635eb7-d1ac-47d7-8f50-5c051f2656f7): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:27:49,744 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-e8cf28ec-919d-46d9-8310-74643439f44d-group-C1EFFC3B474C: set stopIndex = 0
2019-06-14 10:27:49,743 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - e8cf28ec-919d-46d9-8310-74643439f44d-PendingRequests: sendNotLeaderResponses
2019-06-14 10:27:49,744 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(e8cf28ec-919d-46d9-8310-74643439f44d -> 1a945b57-ef45-49ed-92c5-75ee453031c6): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:27:49,744 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:27:49,744 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:27:49,745 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - e8cf28ec-919d-46d9-8310-74643439f44d:group-C1EFFC3B474C closes. The last applied log index is 0
2019-06-14 10:27:49,745 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - e8cf28ec-919d-46d9-8310-74643439f44d-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:49,744 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-e8cf28ec-919d-46d9-8310-74643439f44d-group-2D3C48945B1A: set stopIndex = 0
2019-06-14 10:27:49,746 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - e8cf28ec-919d-46d9-8310-74643439f44d-RaftLogWorker close()
2019-06-14 10:27:49,745 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: appendEntries completed
2019-06-14 10:27:49,746 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - e8cf28ec-919d-46d9-8310-74643439f44d:group-2D3C48945B1A closes. The last applied log index is 0
2019-06-14 10:27:49,750 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - e8cf28ec-919d-46d9-8310-74643439f44d-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:49,750 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - e8cf28ec-919d-46d9-8310-74643439f44d: follower e8cf28ec-919d-46d9-8310-74643439f44d->1a945b57-ef45-49ed-92c5-75ee453031c6(c0,m0,n1, attendVote=true, lastRpcSendTime=407, lastRpcResponseTime=406) response Completed
2019-06-14 10:27:49,750 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - e8cf28ec-919d-46d9-8310-74643439f44d-RaftLogWorker close()
2019-06-14 10:27:49,751 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - e8cf28ec-919d-46d9-8310-74643439f44d->1a945b57-ef45-49ed-92c5-75ee453031c6: nextIndex: updateUnconditionally 1 -> -1
2019-06-14 10:27:49,751 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - e8cf28ec-919d-46d9-8310-74643439f44d: shutdown server with port 43029 now
2019-06-14 10:27:49,752 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - e8cf28ec-919d-46d9-8310-74643439f44d: shutdown server with port 43029 successfully
2019-06-14 10:27:49,754 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:27:49,764 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:27:49,764 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@1da53f4f{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:27:49,765 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@17bb531f{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:27:49,765 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@14201a90{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:27:49,765 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@dc8b2ff{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:27:49,766 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:27:49,766 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@62360a68
2019-06-14 10:27:49,767 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:27:49,767 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:27:49,767 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: close
2019-06-14 10:27:49,767 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: shutdown group-7D5F67A37EDB
2019-06-14 10:27:49,767 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: shutdown group-2D3C48945B1A
2019-06-14 10:27:49,767 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-7D5F67A37EDB,id=1a945b57-ef45-49ed-92c5-75ee453031c6
2019-06-14 10:27:49,767 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-2D3C48945B1A,id=1a945b57-ef45-49ed-92c5-75ee453031c6
2019-06-14 10:27:49,768 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: shutdown LeaderState
2019-06-14 10:27:49,768 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: shutdown FollowerState
2019-06-14 10:27:49,768 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 1a945b57-ef45-49ed-92c5-75ee453031c6-PendingRequests: sendNotLeaderResponses
2019-06-14 10:27:49,768 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:27:49,768 INFO  impl.FollowerState (FollowerState.java:run(109)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:27:49,768 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-1a945b57-ef45-49ed-92c5-75ee453031c6-group-2D3C48945B1A: set stopIndex = 0
2019-06-14 10:27:49,768 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:27:49,768 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-1a945b57-ef45-49ed-92c5-75ee453031c6-group-7D5F67A37EDB: set stopIndex = 0
2019-06-14 10:27:49,769 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 1a945b57-ef45-49ed-92c5-75ee453031c6:group-2D3C48945B1A closes. The last applied log index is 0
2019-06-14 10:27:49,769 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 1a945b57-ef45-49ed-92c5-75ee453031c6:group-7D5F67A37EDB closes. The last applied log index is 0
2019-06-14 10:27:49,769 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 1a945b57-ef45-49ed-92c5-75ee453031c6-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:49,769 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 1a945b57-ef45-49ed-92c5-75ee453031c6-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:49,769 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 1a945b57-ef45-49ed-92c5-75ee453031c6-RaftLogWorker close()
2019-06-14 10:27:49,769 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 1a945b57-ef45-49ed-92c5-75ee453031c6-RaftLogWorker close()
2019-06-14 10:27:49,770 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: shutdown server with port 42123 now
2019-06-14 10:27:49,770 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 1a945b57-ef45-49ed-92c5-75ee453031c6: shutdown server with port 42123 successfully
2019-06-14 10:27:49,771 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:27:49,779 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:27:49,780 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@283e1759{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:27:49,780 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@2acb1264{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:27:49,781 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@24b3f778{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:27:49,781 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@2b6fcca1{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:27:49,803 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:49,808 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:49,808 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:49,808 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedBlocks
2019-06-14 10:27:49,808 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedBlocks
2019-06-14 10:27:49,809 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: validCerts
2019-06-14 10:27:49,809 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:validCerts
2019-06-14 10:27:49,809 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: revokedCerts
2019-06-14 10:27:49,809 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:revokedCerts
2019-06-14 10:27:49,809 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-14 10:27:49,809 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-14 10:27:49,810 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-14 10:27:49,848 INFO  node.SCMNodeManager (SCMNodeManager.java:<init>(108)) - Entering startup safe mode.
2019-06-14 10:27:49,849 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(125)) - Loading file from sun.misc.CompoundEnumeration@71beada8
2019-06-14 10:27:49,850 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(171)) - Loading network topology layer schema file
2019-06-14 10:27:49,852 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:49,865 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:initializePipelineState(126)) - No pipeline exists in current db
2019-06-14 10:27:49,865 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:49,879 WARN  events.EventQueue (EventQueue.java:fireEvent(175)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='SafeModeStatus'}
2019-06-14 10:27:49,881 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:27:49,882 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 34073
2019-06-14 10:27:49,887 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:27:49,887 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 45961
2019-06-14 10:27:49,891 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:27:49,893 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for scm at: http://0.0.0.0:0
2019-06-14 10:27:49,894 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 39659
2019-06-14 10:27:49,895 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:27:49,895 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:27:49,896 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:27:49,897 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context scm
2019-06-14 10:27:49,897 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:27:49,897 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:27:49,902 INFO  server.StorageContainerManager (StorageContainerManager.java:start(752)) - StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:39659
2019-06-14 10:27:49,902 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - StorageContainerManager metrics system started (again)
2019-06-14 10:27:49,902 INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:start(149)) - RPC server for Client  is listening at /0.0.0.0:39659
2019-06-14 10:27:49,903 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 39659: starting
2019-06-14 10:27:49,903 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:27:49,912 INFO  server.StorageContainerManager (StorageContainerManager.java:start(761)) - ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:45961
2019-06-14 10:27:49,912 INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:start(137)) - RPC server for Block Protocol is listening at /0.0.0.0:45961
2019-06-14 10:27:49,912 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:27:49,912 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 45961: starting
2019-06-14 10:27:49,934 INFO  server.StorageContainerManager (StorageContainerManager.java:start(765)) - ScmDatanodeProtocl RPC server is listening at /0.0.0.0:34073
2019-06-14 10:27:49,934 INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:start(191)) - RPC server for DataNodes is listening at /0.0.0.0:34073
2019-06-14 10:27:49,934 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:27:49,934 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 34073: starting
2019-06-14 10:27:49,937 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 44435
2019-06-14 10:27:49,937 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:27:49,938 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@4946485c{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:27:49,939 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@7c682e26{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-14 10:27:49,942 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@39a865c1{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/scm/,AVAILABLE}{/scm}
2019-06-14 10:27:49,942 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@141dfcf9{HTTP/1.1,[http/1.1]}{0.0.0.0:44435}
2019-06-14 10:27:49,943 INFO  server.Server (Server.java:doStart(419)) - Started @35201ms
2019-06-14 10:27:49,943 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of SCM is listening at http://0.0.0.0:44435
2019-06-14 10:27:49,944 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:49,944 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:27:49,947 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:49,947 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(519)) - OM Service ID is not set. Setting it to the default ID: omServiceIdDefault
2019-06-14 10:27:49,947 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(525)) - OM Node ID is not set. Setting it to the OmStorage's OmID: d223ce73-7f99-4159-9d7d-f5f60a2b65c5
2019-06-14 10:27:49,947 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 10:27:49,947 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 10:27:49,948 INFO  om.OzoneManager (OzoneManager.java:loadOMHAConfigs(476)) - Found matching OM address with OMServiceId: null, OMNodeId: null, RPC Address: localhost:0 and Ratis port: 9872
2019-06-14 10:27:49,951 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:49,952 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: userTable
2019-06-14 10:27:49,952 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:userTable
2019-06-14 10:27:49,952 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: volumeTable
2019-06-14 10:27:49,952 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:volumeTable
2019-06-14 10:27:49,952 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: bucketTable
2019-06-14 10:27:49,952 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:bucketTable
2019-06-14 10:27:49,952 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: keyTable
2019-06-14 10:27:49,953 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:keyTable
2019-06-14 10:27:49,953 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedTable
2019-06-14 10:27:49,953 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedTable
2019-06-14 10:27:49,953 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: openKeyTable
2019-06-14 10:27:49,953 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:openKeyTable
2019-06-14 10:27:49,953 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3Table
2019-06-14 10:27:49,953 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3Table
2019-06-14 10:27:49,953 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: multipartInfoTable
2019-06-14 10:27:49,954 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:multipartInfoTable
2019-06-14 10:27:49,954 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: dTokenTable
2019-06-14 10:27:49,954 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:dTokenTable
2019-06-14 10:27:49,954 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3SecretTable
2019-06-14 10:27:49,954 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3SecretTable
2019-06-14 10:27:49,954 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: prefixTable
2019-06-14 10:27:49,954 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:prefixTable
2019-06-14 10:27:49,954 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-14 10:27:49,955 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-14 10:27:49,955 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-14 10:27:50,091 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:27:50,092 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 42883
2019-06-14 10:27:50,102 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:27:50,102 INFO  om.OzoneManager (OzoneManager.java:start(1217)) - OzoneManager RPC server is listening at localhost/127.0.0.1:42883
2019-06-14 10:27:50,102 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - OzoneManager metrics system started (again)
2019-06-14 10:27:50,102 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:27:50,102 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 42883: starting
2019-06-14 10:27:50,107 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for ozoneManager at: http://0.0.0.0:0
2019-06-14 10:27:50,108 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:27:50,108 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:27:50,109 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:27:50,110 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context ozoneManager
2019-06-14 10:27:50,110 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:27:50,110 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:27:50,111 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 33247
2019-06-14 10:27:50,111 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:27:50,112 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@fceab5d{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:27:50,112 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@1592e540{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-14 10:27:50,115 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@36cf16a6{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/ozoneManager/,AVAILABLE}{/ozoneManager}
2019-06-14 10:27:50,115 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@3dd750ba{HTTP/1.1,[http/1.1]}{0.0.0.0:33247}
2019-06-14 10:27:50,116 INFO  server.Server (Server.java:doStart(419)) - Started @35374ms
2019-06-14 10:27:50,116 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of OZONEMANAGER is listening at http://0.0.0.0:33247
2019-06-14 10:27:50,127 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:27:50,127 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:27:50,132 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-0/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:27:50,132 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-0/data/containers/hdds to VolumeSet
2019-06-14 10:27:50,132 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1e194966
2019-06-14 10:27:50,134 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1e194966
2019-06-14 10:27:50,142 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 38579
2019-06-14 10:27:50,143 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:27:50,143 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 38579 (custom)
2019-06-14 10:27:50,143 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:27:50,143 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:50,144 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:27:50,144 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:50,144 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-0/data/ratis] (custom)
2019-06-14 10:27:50,144 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 45103
2019-06-14 10:27:50,145 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:27:50,146 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:27:50,147 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:27:50,147 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:27:50,148 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:27:50,149 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:27:50,149 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:27:50,149 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:27:50,150 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 33325
2019-06-14 10:27:50,150 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:27:50,170 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@35f01759{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:27:50,171 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@2aa07d80{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:27:50,194 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@4bab78ce{/,file:///tmp/jetty-0.0.0.0-33325-hddsDatanode-_-any-4420459590174097834.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:27:50,194 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@42ffbab6{HTTP/1.1,[http/1.1]}{0.0.0.0:33325}
2019-06-14 10:27:50,195 INFO  server.Server (Server.java:doStart(419)) - Started @35454ms
2019-06-14 10:27:50,196 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:33325
Jun 14, 2019 10:27:50 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:27:50,310 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@40d10264
2019-06-14 10:27:50,311 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:27:50,311 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:27:50,314 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:27:50,319 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-0/meta/datanode.id
2019-06-14 10:27:50,324 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-1/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:27:50,324 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-1/data/containers/hdds to VolumeSet
2019-06-14 10:27:50,325 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@40dee07b
2019-06-14 10:27:50,326 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@40dee07b
2019-06-14 10:27:50,335 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 39701
2019-06-14 10:27:50,336 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:27:50,336 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 39701 (custom)
2019-06-14 10:27:50,337 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:27:50,337 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:50,337 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:27:50,337 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:50,338 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-1/data/ratis] (custom)
2019-06-14 10:27:50,338 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42937
2019-06-14 10:27:50,338 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:27:50,339 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:27:50,340 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:27:50,341 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:27:50,342 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:27:50,342 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:27:50,342 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:27:50,343 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:27:50,343 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 33695
2019-06-14 10:27:50,343 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:27:50,350 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@b4d83ac{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:27:50,350 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@66944c7c{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:27:50,375 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@5bccaedb{/,file:///tmp/jetty-0.0.0.0-33695-hddsDatanode-_-any-5626111318758691081.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:27:50,377 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@3c5e45dd{HTTP/1.1,[http/1.1]}{0.0.0.0:33695}
2019-06-14 10:27:50,377 INFO  server.Server (Server.java:doStart(419)) - Started @35635ms
2019-06-14 10:27:50,377 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:33695
Jun 14, 2019 10:27:50 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:27:50,533 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@6fc28e5b
2019-06-14 10:27:50,533 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:27:50,533 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:27:50,534 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:27:50,535 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-1/meta/datanode.id
2019-06-14 10:27:50,537 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-2/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:27:50,537 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-2/data/containers/hdds to VolumeSet
2019-06-14 10:27:50,537 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@19c1f6f4
2019-06-14 10:27:50,538 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@19c1f6f4
2019-06-14 10:27:50,547 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 35961
2019-06-14 10:27:50,548 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:27:50,548 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 35961 (custom)
2019-06-14 10:27:50,548 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:27:50,548 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:50,548 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:27:50,549 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:50,549 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-2/data/ratis] (custom)
2019-06-14 10:27:50,549 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 34991
2019-06-14 10:27:50,550 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:27:50,550 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:27:50,551 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:27:50,552 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:27:50,553 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:27:50,553 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:27:50,553 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:27:50,553 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:27:50,554 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 42175
2019-06-14 10:27:50,554 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:27:50,555 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@493968a9{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:27:50,555 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@3c65f00e{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:27:50,579 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@5d3f8661{/,file:///tmp/jetty-0.0.0.0-42175-hddsDatanode-_-any-4695670288133070471.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:27:50,580 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@1df9f7c6{HTTP/1.1,[http/1.1]}{0.0.0.0:42175}
2019-06-14 10:27:50,580 INFO  server.Server (Server.java:doStart(419)) - Started @35839ms
2019-06-14 10:27:50,581 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:42175
Jun 14, 2019 10:27:50 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:27:50,664 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@18b45500
2019-06-14 10:27:50,665 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:27:50,665 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:27:50,667 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:27:50,668 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-2/meta/datanode.id
2019-06-14 10:27:50,671 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-3/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:27:50,672 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-3/data/containers/hdds to VolumeSet
2019-06-14 10:27:50,672 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3e12c5de
2019-06-14 10:27:50,672 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3e12c5de
2019-06-14 10:27:50,686 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 35213
2019-06-14 10:27:50,686 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:27:50,687 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 35213 (custom)
2019-06-14 10:27:50,687 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:27:50,687 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:50,687 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:27:50,687 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:50,688 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-3/data/ratis] (custom)
2019-06-14 10:27:50,688 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 38083
2019-06-14 10:27:50,688 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:27:50,690 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:27:50,690 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:27:50,691 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:27:50,692 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:27:50,692 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:27:50,692 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:27:50,692 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:27:50,693 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 43449
2019-06-14 10:27:50,693 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:27:50,694 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@4040ccae{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:27:50,695 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@18f8ebd4{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:27:50,716 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@3d2b13b1{/,file:///tmp/jetty-0.0.0.0-43449-hddsDatanode-_-any-2546213633964107449.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:27:50,716 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@30eb55c9{HTTP/1.1,[http/1.1]}{0.0.0.0:43449}
2019-06-14 10:27:50,718 INFO  server.Server (Server.java:doStart(419)) - Started @35976ms
2019-06-14 10:27:50,718 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:43449
Jun 14, 2019 10:27:50 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:27:50,855 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@5bba9949
2019-06-14 10:27:50,855 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:27:50,856 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:27:50,870 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-4/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:27:50,871 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-4/data/containers/hdds to VolumeSet
2019-06-14 10:27:50,871 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@18209303
2019-06-14 10:27:50,878 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:27:50,882 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@18209303
2019-06-14 10:27:50,889 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-3/meta/datanode.id
2019-06-14 10:27:50,891 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 36827
2019-06-14 10:27:50,898 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:27:50,898 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 36827 (custom)
2019-06-14 10:27:50,898 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:27:50,899 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:50,899 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:27:50,899 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:50,899 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-4/data/ratis] (custom)
2019-06-14 10:27:50,899 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 34009
2019-06-14 10:27:50,900 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:27:50,901 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:27:50,903 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:27:50,903 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:27:50,904 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:27:50,905 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:27:50,905 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:27:50,905 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:27:50,906 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 41691
2019-06-14 10:27:50,906 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:27:50,907 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@3093b9ff{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:27:50,907 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@379b4e86{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:27:50,929 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@78508e6b{/,file:///tmp/jetty-0.0.0.0-41691-hddsDatanode-_-any-2691017797451316150.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:27:50,930 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@1bde9a22{HTTP/1.1,[http/1.1]}{0.0.0.0:41691}
2019-06-14 10:27:50,932 INFO  server.Server (Server.java:doStart(419)) - Started @36190ms
2019-06-14 10:27:50,932 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:41691
Jun 14, 2019 10:27:50 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:27:51,023 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@e04b8a0
2019-06-14 10:27:51,023 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:27:51,023 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:27:51,025 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:27:51,026 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-4/meta/datanode.id
2019-06-14 10:27:51,029 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-5/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:27:51,029 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-5/data/containers/hdds to VolumeSet
2019-06-14 10:27:51,029 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@5895c065
2019-06-14 10:27:51,029 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@5895c065
2019-06-14 10:27:51,042 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 44531
2019-06-14 10:27:51,046 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:27:51,046 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 44531 (custom)
2019-06-14 10:27:51,046 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:27:51,047 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:51,047 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:27:51,047 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:51,047 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-5/data/ratis] (custom)
2019-06-14 10:27:51,048 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42887
2019-06-14 10:27:51,048 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:27:51,049 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:27:51,050 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:27:51,050 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:27:51,051 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:27:51,052 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:27:51,052 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:27:51,052 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:27:51,052 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 44533
2019-06-14 10:27:51,053 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:27:51,066 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@64e89bb2{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:27:51,067 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@10830d50{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:27:51,089 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@7682bf66{/,file:///tmp/jetty-0.0.0.0-44533-hddsDatanode-_-any-3899918040027628984.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:27:51,089 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@4eb73cc8{HTTP/1.1,[http/1.1]}{0.0.0.0:44533}
2019-06-14 10:27:51,090 INFO  server.Server (Server.java:doStart(419)) - Started @36349ms
2019-06-14 10:27:51,091 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:44533
Jun 14, 2019 10:27:51 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:27:51,233 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@3ea6faf0
2019-06-14 10:27:51,233 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:27:51,234 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:27:51,234 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-5/meta/datanode.id
2019-06-14 10:27:51,752 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-14 10:27:51,952 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-14 10:27:52,152 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-14 10:27:52,233 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:27:52,322 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:27:52,322 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:27:52,322 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07 at port 38579
2019-06-14 10:27:52,326 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: start RPC server
2019-06-14 10:27:52,327 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: GrpcService started, listening on 0.0.0.0/0.0.0.0:38579
2019-06-14 10:27:52,453 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-14 10:27:52,453 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-14 10:27:52,453 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-14 10:27:52,538 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:27:52,539 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:27:52,539 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7 at port 39701
2019-06-14 10:27:52,542 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: start RPC server
2019-06-14 10:27:52,544 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: GrpcService started, listening on 0.0.0.0/0.0.0.0:39701
2019-06-14 10:27:52,670 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:27:52,670 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:27:52,670 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis bc54a94b-7132-4b07-a9d2-2b3707eeac69 at port 35961
2019-06-14 10:27:52,714 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: start RPC server
2019-06-14 10:27:52,714 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: GrpcService started, listening on 0.0.0.0/0.0.0.0:35961
2019-06-14 10:27:52,881 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:27:52,881 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:27:52,881 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 39d16e95-c256-46df-a703-247d3a759235 at port 35213
2019-06-14 10:27:52,885 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 39d16e95-c256-46df-a703-247d3a759235: start RPC server
2019-06-14 10:27:52,887 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 39d16e95-c256-46df-a703-247d3a759235: GrpcService started, listening on 0.0.0.0/0.0.0.0:35213
2019-06-14 10:27:53,028 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:27:53,028 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:27:53,028 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis a4e4938e-b68b-4cdf-99b1-dab4b8403476 at port 36827
2019-06-14 10:27:53,032 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: start RPC server
2019-06-14 10:27:53,032 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: GrpcService started, listening on 0.0.0.0/0.0.0.0:36827
2019-06-14 10:27:53,234 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:27:53,236 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:27:53,236 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:27:53,237 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 165e809a-482b-4a99-9113-540c84dfdac6 at port 44531
2019-06-14 10:27:53,240 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 165e809a-482b-4a99-9113-540c84dfdac6: start RPC server
2019-06-14 10:27:53,246 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 165e809a-482b-4a99-9113-540c84dfdac6: GrpcService started, listening on 0.0.0.0/0.0.0.0:44531
2019-06-14 10:27:54,234 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:27:54,317 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:27:54,319 INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 1 DataNodes registered, 1 required.
2019-06-14 10:27:54,320 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(177)) - ScmSafeModeManager, all rules are successfully validated
2019-06-14 10:27:54,320 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:exitSafeMode(193)) - SCM exiting safe mode.
Jun 14, 2019 10:27:54 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=383, target=192.168.46.40:46501} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connectToDatanode(XceiverClientGrpc.java:163)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.reconnect(XceiverClientGrpc.java:398)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommandAsync(XceiverClientGrpc.java:349)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommandWithRetry(XceiverClientGrpc.java:262)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommandWithTraceIDAndRetry(XceiverClientGrpc.java:239)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommand(XceiverClientGrpc.java:222)
	at org.apache.hadoop.hdds.scm.storage.ContainerProtocolCalls.getBlock(ContainerProtocolCalls.java:118)
	at org.apache.hadoop.hdds.scm.storage.BlockInputStream.getChunkInfos(BlockInputStream.java:167)
	at org.apache.hadoop.hdds.scm.storage.BlockInputStream.initialize(BlockInputStream.java:118)
	at org.apache.hadoop.hdds.scm.storage.BlockInputStream.read(BlockInputStream.java:222)
	at org.apache.hadoop.ozone.client.io.KeyInputStream.read(KeyInputStream.java:171)
	at org.apache.hadoop.ozone.client.io.OzoneInputStream.read(OzoneInputStream.java:47)
	at java.io.InputStream.read(InputStream.java:101)
	at org.apache.hadoop.ozone.container.ContainerTestHelper.validateData(ContainerTestHelper.java:709)
	at org.apache.hadoop.ozone.client.rpc.TestFailureHandlingByClient.validateData(TestFailureHandlingByClient.java:497)
	at org.apache.hadoop.ozone.client.rpc.TestFailureHandlingByClient.testContainerExclusionWithClosedContainerException(TestFailureHandlingByClient.java:358)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-14 10:27:54,330 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: addNew group-899EB2E094CC:[807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:192.168.46.40:38579] returns group-899EB2E094CC:java.util.concurrent.CompletableFuture@3da7b9ee[Not completed]
2019-06-14 10:27:54,330 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: new RaftServerImpl for group-899EB2E094CC:[807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:192.168.46.40:38579] with ContainerStateMachine:uninitialized
2019-06-14 10:27:54,330 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:54,331 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:54,331 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:54,331 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:54,331 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:group-899EB2E094CC ConfigurationManager, init=-1: [807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:192.168.46.40:38579], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:54,331 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-0/data/ratis] (custom)
2019-06-14 10:27:54,331 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-0/data/ratis/685ed62b-3810-4143-8658-899eb2e094cc does not exist. Creating ...
2019-06-14 10:27:54,333 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-0/data/ratis/685ed62b-3810-4143-8658-899eb2e094cc/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:54,335 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-0/data/ratis/685ed62b-3810-4143-8658-899eb2e094cc has been successfully formatted.
2019-06-14 10:27:54,336 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:54,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:54,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:54,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:54,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:54,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:54,336 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-0/data/ratis/685ed62b-3810-4143-8658-899eb2e094cc
2019-06-14 10:27:54,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:54,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:54,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:54,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:54,337 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:54,337 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:54,337 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:54,337 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:54,337 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:54,337 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:54,337 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:54,338 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:54,338 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:54,338 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: start group-899EB2E094CC
2019-06-14 10:27:54,338 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:group-899EB2E094CC changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:54,338 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: start FollowerState
2019-06-14 10:27:54,338 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-899EB2E094CC,id=807d8c6c-cd12-4929-ab88-2fe0d7a9ec07
2019-06-14 10:27:54,340 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 685ed62b-3810-4143-8658-899eb2e094cc, Nodes: 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:27:54,535 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:27:54,541 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: addNew group-B93209A721F5:[6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:192.168.46.40:39701] returns group-B93209A721F5:java.util.concurrent.CompletableFuture@52b9f4b6[Not completed]
2019-06-14 10:27:54,541 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: new RaftServerImpl for group-B93209A721F5:[6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:192.168.46.40:39701] with ContainerStateMachine:uninitialized
2019-06-14 10:27:54,541 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:54,541 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:54,541 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:54,541 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:54,542 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:group-B93209A721F5 ConfigurationManager, init=-1: [6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:192.168.46.40:39701], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:54,542 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-1/data/ratis] (custom)
2019-06-14 10:27:54,542 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-1/data/ratis/0dc49f3c-485c-47ff-a154-b93209a721f5 does not exist. Creating ...
2019-06-14 10:27:54,544 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-1/data/ratis/0dc49f3c-485c-47ff-a154-b93209a721f5/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:54,546 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-1/data/ratis/0dc49f3c-485c-47ff-a154-b93209a721f5 has been successfully formatted.
2019-06-14 10:27:54,546 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:54,546 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:54,546 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:54,546 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:54,547 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:54,547 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:54,547 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-1/data/ratis/0dc49f3c-485c-47ff-a154-b93209a721f5
2019-06-14 10:27:54,547 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:54,547 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:54,547 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:54,547 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:54,547 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:54,547 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:54,547 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:54,547 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:54,547 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:54,547 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:54,548 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:54,548 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:54,548 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:54,548 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: start group-B93209A721F5
2019-06-14 10:27:54,548 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:group-B93209A721F5 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:54,548 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: start FollowerState
2019-06-14 10:27:54,549 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-B93209A721F5,id=6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7
2019-06-14 10:27:54,550 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 0dc49f3c-485c-47ff-a154-b93209a721f5, Nodes: 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:27:54,668 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : bc54a94b-7132-4b07-a9d2-2b3707eeac69{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:27:54,674 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: addNew group-8DED78E4F307:[bc54a94b-7132-4b07-a9d2-2b3707eeac69:192.168.46.40:35961] returns group-8DED78E4F307:java.util.concurrent.CompletableFuture@26237381[Not completed]
2019-06-14 10:27:54,674 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: new RaftServerImpl for group-8DED78E4F307:[bc54a94b-7132-4b07-a9d2-2b3707eeac69:192.168.46.40:35961] with ContainerStateMachine:uninitialized
2019-06-14 10:27:54,674 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:54,674 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:54,674 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:54,675 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:54,675 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69:group-8DED78E4F307 ConfigurationManager, init=-1: [bc54a94b-7132-4b07-a9d2-2b3707eeac69:192.168.46.40:35961], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:54,675 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-2/data/ratis] (custom)
2019-06-14 10:27:54,675 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-2/data/ratis/adca781b-a29f-4394-b919-8ded78e4f307 does not exist. Creating ...
2019-06-14 10:27:54,677 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-2/data/ratis/adca781b-a29f-4394-b919-8ded78e4f307/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:54,679 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-2/data/ratis/adca781b-a29f-4394-b919-8ded78e4f307 has been successfully formatted.
2019-06-14 10:27:54,679 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:54,679 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:54,679 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:54,679 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:54,679 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:54,680 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:54,680 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new bc54a94b-7132-4b07-a9d2-2b3707eeac69-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-2/data/ratis/adca781b-a29f-4394-b919-8ded78e4f307
2019-06-14 10:27:54,680 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:54,680 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:54,680 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:54,680 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:54,680 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:54,680 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:54,680 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:54,680 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:54,680 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:54,680 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:54,681 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:54,681 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:54,681 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:54,681 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: start group-8DED78E4F307
2019-06-14 10:27:54,681 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69:group-8DED78E4F307 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:54,681 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: start FollowerState
2019-06-14 10:27:54,681 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-8DED78E4F307,id=bc54a94b-7132-4b07-a9d2-2b3707eeac69
2019-06-14 10:27:54,683 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: adca781b-a29f-4394-b919-8ded78e4f307, Nodes: bc54a94b-7132-4b07-a9d2-2b3707eeac69{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:27:54,696 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: addNew group-C06A7EE3DC17:[807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:192.168.46.40:38579, bc54a94b-7132-4b07-a9d2-2b3707eeac69:192.168.46.40:35961, 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:192.168.46.40:39701] returns group-C06A7EE3DC17:java.util.concurrent.CompletableFuture@64123554[Not completed]
2019-06-14 10:27:54,697 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: new RaftServerImpl for group-C06A7EE3DC17:[807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:192.168.46.40:38579, bc54a94b-7132-4b07-a9d2-2b3707eeac69:192.168.46.40:35961, 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:192.168.46.40:39701] with ContainerStateMachine:uninitialized
2019-06-14 10:27:54,697 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:54,697 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:54,697 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:54,697 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:54,697 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:group-C06A7EE3DC17 ConfigurationManager, init=-1: [807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:192.168.46.40:38579, bc54a94b-7132-4b07-a9d2-2b3707eeac69:192.168.46.40:35961, 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:192.168.46.40:39701], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:54,697 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-0/data/ratis] (custom)
2019-06-14 10:27:54,697 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: addNew group-C06A7EE3DC17:[807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:192.168.46.40:38579, bc54a94b-7132-4b07-a9d2-2b3707eeac69:192.168.46.40:35961, 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:192.168.46.40:39701] returns group-C06A7EE3DC17:java.util.concurrent.CompletableFuture@63a90bda[Not completed]
2019-06-14 10:27:54,698 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-0/data/ratis/a2420fe4-5827-4332-a4c1-c06a7ee3dc17 does not exist. Creating ...
2019-06-14 10:27:54,698 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: addNew group-C06A7EE3DC17:[807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:192.168.46.40:38579, bc54a94b-7132-4b07-a9d2-2b3707eeac69:192.168.46.40:35961, 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:192.168.46.40:39701] returns group-C06A7EE3DC17:java.util.concurrent.CompletableFuture@63d5f86a[Not completed]
2019-06-14 10:27:54,698 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: new RaftServerImpl for group-C06A7EE3DC17:[807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:192.168.46.40:38579, bc54a94b-7132-4b07-a9d2-2b3707eeac69:192.168.46.40:35961, 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:192.168.46.40:39701] with ContainerStateMachine:uninitialized
2019-06-14 10:27:54,698 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:54,698 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:54,699 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:54,699 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:54,699 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:group-C06A7EE3DC17 ConfigurationManager, init=-1: [807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:192.168.46.40:38579, bc54a94b-7132-4b07-a9d2-2b3707eeac69:192.168.46.40:35961, 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:192.168.46.40:39701], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:54,699 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-1/data/ratis] (custom)
2019-06-14 10:27:54,699 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-1/data/ratis/a2420fe4-5827-4332-a4c1-c06a7ee3dc17 does not exist. Creating ...
2019-06-14 10:27:54,699 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: new RaftServerImpl for group-C06A7EE3DC17:[807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:192.168.46.40:38579, bc54a94b-7132-4b07-a9d2-2b3707eeac69:192.168.46.40:35961, 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:192.168.46.40:39701] with ContainerStateMachine:uninitialized
2019-06-14 10:27:54,700 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:54,700 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:54,700 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-0/data/ratis/a2420fe4-5827-4332-a4c1-c06a7ee3dc17/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:54,700 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:54,700 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:54,700 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69:group-C06A7EE3DC17 ConfigurationManager, init=-1: [807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:192.168.46.40:38579, bc54a94b-7132-4b07-a9d2-2b3707eeac69:192.168.46.40:35961, 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:192.168.46.40:39701], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:54,700 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-2/data/ratis] (custom)
2019-06-14 10:27:54,701 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-2/data/ratis/a2420fe4-5827-4332-a4c1-c06a7ee3dc17 does not exist. Creating ...
2019-06-14 10:27:54,701 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-1/data/ratis/a2420fe4-5827-4332-a4c1-c06a7ee3dc17/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:54,703 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-2/data/ratis/a2420fe4-5827-4332-a4c1-c06a7ee3dc17/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:54,703 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-0/data/ratis/a2420fe4-5827-4332-a4c1-c06a7ee3dc17 has been successfully formatted.
2019-06-14 10:27:54,704 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:54,704 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:54,704 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:54,704 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-1/data/ratis/a2420fe4-5827-4332-a4c1-c06a7ee3dc17 has been successfully formatted.
2019-06-14 10:27:54,704 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:54,704 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:54,704 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:54,704 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:54,704 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-0/data/ratis/a2420fe4-5827-4332-a4c1-c06a7ee3dc17
2019-06-14 10:27:54,704 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:54,705 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:54,705 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:54,705 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:54,705 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:54,705 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:54,705 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:54,705 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:54,705 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-2/data/ratis/a2420fe4-5827-4332-a4c1-c06a7ee3dc17 has been successfully formatted.
2019-06-14 10:27:54,705 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:54,706 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:54,705 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:54,706 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:54,706 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:54,706 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:54,706 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-1/data/ratis/a2420fe4-5827-4332-a4c1-c06a7ee3dc17
2019-06-14 10:27:54,706 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:54,706 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:54,706 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:54,706 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:54,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:54,707 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new bc54a94b-7132-4b07-a9d2-2b3707eeac69-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-2/data/ratis/a2420fe4-5827-4332-a4c1-c06a7ee3dc17
2019-06-14 10:27:54,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:54,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:54,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:54,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:54,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:54,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:54,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:54,708 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:54,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:54,708 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:54,708 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:54,708 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:54,708 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:54,708 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:54,708 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:54,708 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:54,709 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:54,709 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:54,709 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:54,709 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:54,709 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:54,709 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:54,709 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:54,710 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:54,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:54,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:54,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:54,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:54,718 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: start group-C06A7EE3DC17
2019-06-14 10:27:54,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:54,718 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:group-C06A7EE3DC17 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:54,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:54,718 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: start FollowerState
2019-06-14 10:27:54,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:54,718 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: start group-C06A7EE3DC17
2019-06-14 10:27:54,718 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:group-C06A7EE3DC17 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:54,719 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: start group-C06A7EE3DC17
2019-06-14 10:27:54,719 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69:group-C06A7EE3DC17 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:54,719 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: start FollowerState
2019-06-14 10:27:54,719 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C06A7EE3DC17,id=807d8c6c-cd12-4929-ab88-2fe0d7a9ec07
2019-06-14 10:27:54,719 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: start FollowerState
2019-06-14 10:27:54,719 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C06A7EE3DC17,id=bc54a94b-7132-4b07-a9d2-2b3707eeac69
2019-06-14 10:27:54,719 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C06A7EE3DC17,id=6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7
2019-06-14 10:27:54,724 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: a2420fe4-5827-4332-a4c1-c06a7ee3dc17, Nodes: 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}bc54a94b-7132-4b07-a9d2-2b3707eeac69{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}807d8c6c-cd12-4929-ab88-2fe0d7a9ec07{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-14 10:27:54,878 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 39d16e95-c256-46df-a703-247d3a759235{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:27:54,891 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 39d16e95-c256-46df-a703-247d3a759235: addNew group-9A024048B0B0:[39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213] returns group-9A024048B0B0:java.util.concurrent.CompletableFuture@c50b86c[Not completed]
2019-06-14 10:27:54,892 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 39d16e95-c256-46df-a703-247d3a759235: new RaftServerImpl for group-9A024048B0B0:[39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213] with ContainerStateMachine:uninitialized
2019-06-14 10:27:54,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:54,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:54,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:54,893 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:54,893 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 39d16e95-c256-46df-a703-247d3a759235:group-9A024048B0B0 ConfigurationManager, init=-1: [39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:54,893 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-3/data/ratis] (custom)
2019-06-14 10:27:54,893 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-3/data/ratis/a0b79aa8-8a56-4ffb-af16-9a024048b0b0 does not exist. Creating ...
2019-06-14 10:27:54,895 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-3/data/ratis/a0b79aa8-8a56-4ffb-af16-9a024048b0b0/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:54,897 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-3/data/ratis/a0b79aa8-8a56-4ffb-af16-9a024048b0b0 has been successfully formatted.
2019-06-14 10:27:54,897 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:54,897 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:54,897 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:54,898 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:54,898 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:54,898 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:54,898 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 39d16e95-c256-46df-a703-247d3a759235-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-3/data/ratis/a0b79aa8-8a56-4ffb-af16-9a024048b0b0
2019-06-14 10:27:54,898 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:54,898 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:54,898 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:54,898 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:54,898 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:54,898 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:54,898 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:54,898 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:54,898 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:54,899 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:54,899 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:54,899 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:54,899 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:54,899 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 39d16e95-c256-46df-a703-247d3a759235: start group-9A024048B0B0
2019-06-14 10:27:54,899 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 39d16e95-c256-46df-a703-247d3a759235:group-9A024048B0B0 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:54,899 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 39d16e95-c256-46df-a703-247d3a759235: start FollowerState
2019-06-14 10:27:54,900 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-9A024048B0B0,id=39d16e95-c256-46df-a703-247d3a759235
2019-06-14 10:27:54,901 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: a0b79aa8-8a56-4ffb-af16-9a024048b0b0, Nodes: 39d16e95-c256-46df-a703-247d3a759235{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:27:55,025 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : a4e4938e-b68b-4cdf-99b1-dab4b8403476{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:27:55,032 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: addNew group-8E4F0D3E56B9:[a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827] returns group-8E4F0D3E56B9:java.util.concurrent.CompletableFuture@6b9f9ade[Not completed]
2019-06-14 10:27:55,033 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: new RaftServerImpl for group-8E4F0D3E56B9:[a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827] with ContainerStateMachine:uninitialized
2019-06-14 10:27:55,033 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:55,033 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:55,033 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:55,033 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:55,033 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-8E4F0D3E56B9 ConfigurationManager, init=-1: [a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:55,033 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-4/data/ratis] (custom)
2019-06-14 10:27:55,033 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-4/data/ratis/a2686f1f-7f67-42c7-9851-8e4f0d3e56b9 does not exist. Creating ...
2019-06-14 10:27:55,036 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-4/data/ratis/a2686f1f-7f67-42c7-9851-8e4f0d3e56b9/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:55,038 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-4/data/ratis/a2686f1f-7f67-42c7-9851-8e4f0d3e56b9 has been successfully formatted.
2019-06-14 10:27:55,038 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:55,038 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:55,038 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:55,038 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:55,038 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:55,038 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:55,038 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new a4e4938e-b68b-4cdf-99b1-dab4b8403476-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-4/data/ratis/a2686f1f-7f67-42c7-9851-8e4f0d3e56b9
2019-06-14 10:27:55,038 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:55,038 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:55,038 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:55,039 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:55,039 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:55,039 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:55,039 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:55,039 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:55,039 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:55,039 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:55,039 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:55,039 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:55,039 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:55,040 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: start group-8E4F0D3E56B9
2019-06-14 10:27:55,040 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-8E4F0D3E56B9 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:55,040 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: start FollowerState
2019-06-14 10:27:55,040 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-8E4F0D3E56B9,id=a4e4938e-b68b-4cdf-99b1-dab4b8403476
2019-06-14 10:27:55,042 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: a2686f1f-7f67-42c7-9851-8e4f0d3e56b9, Nodes: a4e4938e-b68b-4cdf-99b1-dab4b8403476{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:27:55,234 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 5 of 6 DN Heartbeats.
2019-06-14 10:27:55,235 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 165e809a-482b-4a99-9113-540c84dfdac6{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:27:55,241 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 165e809a-482b-4a99-9113-540c84dfdac6: addNew group-4CD4858D81EA:[165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531] returns group-4CD4858D81EA:java.util.concurrent.CompletableFuture@953f79d[Not completed]
2019-06-14 10:27:55,242 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 165e809a-482b-4a99-9113-540c84dfdac6: new RaftServerImpl for group-4CD4858D81EA:[165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531] with ContainerStateMachine:uninitialized
2019-06-14 10:27:55,242 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:55,242 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:55,242 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:55,243 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:55,243 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 165e809a-482b-4a99-9113-540c84dfdac6:group-4CD4858D81EA ConfigurationManager, init=-1: [165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:55,243 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-5/data/ratis] (custom)
2019-06-14 10:27:55,243 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-5/data/ratis/4c4ce3ff-6378-436c-8875-4cd4858d81ea does not exist. Creating ...
2019-06-14 10:27:55,245 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-5/data/ratis/4c4ce3ff-6378-436c-8875-4cd4858d81ea/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:55,247 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-5/data/ratis/4c4ce3ff-6378-436c-8875-4cd4858d81ea has been successfully formatted.
2019-06-14 10:27:55,247 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:55,248 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:55,248 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:55,248 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:55,248 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:55,248 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:55,248 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 165e809a-482b-4a99-9113-540c84dfdac6-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-5/data/ratis/4c4ce3ff-6378-436c-8875-4cd4858d81ea
2019-06-14 10:27:55,248 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:55,248 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:55,248 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:55,248 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:55,248 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:55,248 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:55,248 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:55,248 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:55,249 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:55,249 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:55,249 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:55,249 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:55,249 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:55,249 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 165e809a-482b-4a99-9113-540c84dfdac6: start group-4CD4858D81EA
2019-06-14 10:27:55,250 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 165e809a-482b-4a99-9113-540c84dfdac6:group-4CD4858D81EA changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:55,250 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 165e809a-482b-4a99-9113-540c84dfdac6: start FollowerState
2019-06-14 10:27:55,250 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-4CD4858D81EA,id=165e809a-482b-4a99-9113-540c84dfdac6
2019-06-14 10:27:55,255 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 4c4ce3ff-6378-436c-8875-4cd4858d81ea, Nodes: 165e809a-482b-4a99-9113-540c84dfdac6{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:27:55,270 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 39d16e95-c256-46df-a703-247d3a759235: addNew group-3802833F67F1:[a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827, 165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531, 39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213] returns group-3802833F67F1:java.util.concurrent.CompletableFuture@a87a522[Not completed]
2019-06-14 10:27:55,270 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 165e809a-482b-4a99-9113-540c84dfdac6: addNew group-3802833F67F1:[a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827, 165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531, 39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213] returns group-3802833F67F1:java.util.concurrent.CompletableFuture@4605a0ba[Not completed]
2019-06-14 10:27:55,271 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 39d16e95-c256-46df-a703-247d3a759235: new RaftServerImpl for group-3802833F67F1:[a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827, 165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531, 39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213] with ContainerStateMachine:uninitialized
2019-06-14 10:27:55,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:55,271 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: addNew group-3802833F67F1:[a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827, 165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531, 39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213] returns group-3802833F67F1:java.util.concurrent.CompletableFuture@522437df[Not completed]
2019-06-14 10:27:55,271 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 165e809a-482b-4a99-9113-540c84dfdac6: new RaftServerImpl for group-3802833F67F1:[a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827, 165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531, 39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213] with ContainerStateMachine:uninitialized
2019-06-14 10:27:55,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:55,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:55,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:55,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:55,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:55,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:55,271 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: new RaftServerImpl for group-3802833F67F1:[a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827, 165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531, 39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213] with ContainerStateMachine:uninitialized
2019-06-14 10:27:55,272 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 165e809a-482b-4a99-9113-540c84dfdac6:group-3802833F67F1 ConfigurationManager, init=-1: [a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827, 165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531, 39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:55,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-5/data/ratis] (custom)
2019-06-14 10:27:55,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:55,272 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 39d16e95-c256-46df-a703-247d3a759235:group-3802833F67F1 ConfigurationManager, init=-1: [a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827, 165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531, 39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:55,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-3/data/ratis] (custom)
2019-06-14 10:27:55,273 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-3/data/ratis/90ed3804-81ea-431d-a1c5-3802833f67f1 does not exist. Creating ...
2019-06-14 10:27:55,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:27:55,272 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-5/data/ratis/90ed3804-81ea-431d-a1c5-3802833f67f1 does not exist. Creating ...
2019-06-14 10:27:55,273 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:27:55,273 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:27:55,273 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:55,274 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1 ConfigurationManager, init=-1: [a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827, 165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531, 39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213], old=null, confs=<EMPTY_MAP>
2019-06-14 10:27:55,274 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-4/data/ratis] (custom)
2019-06-14 10:27:55,274 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-4/data/ratis/90ed3804-81ea-431d-a1c5-3802833f67f1 does not exist. Creating ...
2019-06-14 10:27:55,276 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-3/data/ratis/90ed3804-81ea-431d-a1c5-3802833f67f1/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:55,276 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-5/data/ratis/90ed3804-81ea-431d-a1c5-3802833f67f1/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:55,277 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-4/data/ratis/90ed3804-81ea-431d-a1c5-3802833f67f1/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:27:55,278 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-3/data/ratis/90ed3804-81ea-431d-a1c5-3802833f67f1 has been successfully formatted.
2019-06-14 10:27:55,278 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:55,278 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:55,278 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:55,278 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:55,278 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:55,278 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:55,278 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 39d16e95-c256-46df-a703-247d3a759235-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-3/data/ratis/90ed3804-81ea-431d-a1c5-3802833f67f1
2019-06-14 10:27:55,279 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:55,279 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:55,279 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:55,279 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:55,279 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:55,279 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:55,279 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:55,279 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:55,279 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:55,279 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:55,280 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-4/data/ratis/90ed3804-81ea-431d-a1c5-3802833f67f1 has been successfully formatted.
2019-06-14 10:27:55,280 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:55,280 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:55,280 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-5/data/ratis/90ed3804-81ea-431d-a1c5-3802833f67f1 has been successfully formatted.
2019-06-14 10:27:55,280 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:55,280 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:27:55,280 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:55,280 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:27:55,280 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:55,281 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:55,281 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new a4e4938e-b68b-4cdf-99b1-dab4b8403476-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-4/data/ratis/90ed3804-81ea-431d-a1c5-3802833f67f1
2019-06-14 10:27:55,281 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:55,281 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:55,281 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:55,281 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:55,281 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:55,281 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:55,281 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:55,280 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:27:55,281 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:55,282 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:55,282 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:55,282 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:55,282 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:27:55,282 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 165e809a-482b-4a99-9113-540c84dfdac6-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-5/data/ratis/90ed3804-81ea-431d-a1c5-3802833f67f1
2019-06-14 10:27:55,282 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:27:55,282 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:27:55,282 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:27:55,283 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:27:55,283 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:27:55,283 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:27:55,283 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:27:55,283 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:27:55,283 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:27:55,284 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:55,284 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:55,284 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:55,284 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:55,284 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:27:55,284 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:55,284 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:27:55,284 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:55,284 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:55,285 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: start group-3802833F67F1
2019-06-14 10:27:55,285 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:55,285 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: start FollowerState
2019-06-14 10:27:55,285 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 39d16e95-c256-46df-a703-247d3a759235: start group-3802833F67F1
2019-06-14 10:27:55,285 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 39d16e95-c256-46df-a703-247d3a759235:group-3802833F67F1 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:55,285 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 39d16e95-c256-46df-a703-247d3a759235: start FollowerState
2019-06-14 10:27:55,285 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:27:55,285 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-3802833F67F1,id=a4e4938e-b68b-4cdf-99b1-dab4b8403476
2019-06-14 10:27:55,285 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:27:55,285 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-3802833F67F1,id=39d16e95-c256-46df-a703-247d3a759235
2019-06-14 10:27:55,286 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 165e809a-482b-4a99-9113-540c84dfdac6: start group-3802833F67F1
2019-06-14 10:27:55,286 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 165e809a-482b-4a99-9113-540c84dfdac6:group-3802833F67F1 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:27:55,289 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 165e809a-482b-4a99-9113-540c84dfdac6: start FollowerState
2019-06-14 10:27:55,297 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-3802833F67F1,id=165e809a-482b-4a99-9113-540c84dfdac6
2019-06-14 10:27:55,301 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 90ed3804-81ea-431d-a1c5-3802833f67f1, Nodes: 165e809a-482b-4a99-9113-540c84dfdac6{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}39d16e95-c256-46df-a703-247d3a759235{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}a4e4938e-b68b-4cdf-99b1-dab4b8403476{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-14 10:27:55,350 INFO  impl.FollowerState (FollowerState.java:run(101)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:group-899EB2E094CC changes to CANDIDATE, lastRpcTime:1012, electionTimeout:1012ms
2019-06-14 10:27:55,350 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: shutdown FollowerState
2019-06-14 10:27:55,350 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:group-899EB2E094CC changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:55,350 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: start LeaderElection
2019-06-14 10:27:55,357 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:group-899EB2E094CC:LeaderElection26: begin an election at term 1 for -1: [807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:192.168.46.40:38579], old=null
2019-06-14 10:27:55,359 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: shutdown LeaderElection
2019-06-14 10:27:55,359 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:group-899EB2E094CC changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:27:55,359 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:group-899EB2E094CC change Leader from null to 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07 at term 1 for becomeLeader, leader elected after 1023ms
2019-06-14 10:27:55,359 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:27:55,359 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:27:55,359 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:27:55,359 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:27:55,359 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: start LeaderState
2019-06-14 10:27:55,359 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:55,360 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:group-899EB2E094CC set configuration 0: [807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:192.168.46.40:38579], old=null at 0
2019-06-14 10:27:55,396 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-0/data/ratis/685ed62b-3810-4143-8658-899eb2e094cc/current/log_inprogress_0
2019-06-14 10:27:55,573 INFO  impl.FollowerState (FollowerState.java:run(101)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:group-B93209A721F5 changes to CANDIDATE, lastRpcTime:1024, electionTimeout:1024ms
2019-06-14 10:27:55,573 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: shutdown FollowerState
2019-06-14 10:27:55,573 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:group-B93209A721F5 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:55,573 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: start LeaderElection
2019-06-14 10:27:55,580 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:group-B93209A721F5:LeaderElection27: begin an election at term 1 for -1: [6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:192.168.46.40:39701], old=null
2019-06-14 10:27:55,580 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: shutdown LeaderElection
2019-06-14 10:27:55,580 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:group-B93209A721F5 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:27:55,581 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:group-B93209A721F5 change Leader from null to 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7 at term 1 for becomeLeader, leader elected after 1034ms
2019-06-14 10:27:55,581 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:27:55,581 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:27:55,581 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:27:55,581 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:27:55,581 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: start LeaderState
2019-06-14 10:27:55,581 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:55,582 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:group-B93209A721F5 set configuration 0: [6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:192.168.46.40:39701], old=null at 0
2019-06-14 10:27:55,617 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-1/data/ratis/0dc49f3c-485c-47ff-a154-b93209a721f5/current/log_inprogress_0
2019-06-14 10:27:55,737 INFO  impl.FollowerState (FollowerState.java:run(101)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69:group-C06A7EE3DC17 changes to CANDIDATE, lastRpcTime:1017, electionTimeout:1017ms
2019-06-14 10:27:55,737 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: shutdown FollowerState
2019-06-14 10:27:55,737 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69:group-C06A7EE3DC17 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:55,737 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: start LeaderElection
2019-06-14 10:27:55,747 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69:group-C06A7EE3DC17:LeaderElection28: begin an election at term 1 for -1: [807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:192.168.46.40:38579, bc54a94b-7132-4b07-a9d2-2b3707eeac69:192.168.46.40:35961, 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:192.168.46.40:39701], old=null
2019-06-14 10:27:55,755 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:group-C06A7EE3DC17 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:bc54a94b-7132-4b07-a9d2-2b3707eeac69
2019-06-14 10:27:55,755 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: shutdown FollowerState
2019-06-14 10:27:55,755 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: start FollowerState
2019-06-14 10:27:55,755 INFO  impl.FollowerState (FollowerState.java:run(109)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:27:55,757 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:group-C06A7EE3DC17 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:bc54a94b-7132-4b07-a9d2-2b3707eeac69
2019-06-14 10:27:55,757 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: shutdown FollowerState
2019-06-14 10:27:55,757 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: start FollowerState
2019-06-14 10:27:55,757 INFO  impl.FollowerState (FollowerState.java:run(109)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:27:55,761 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69:group-C06A7EE3DC17:LeaderElection28: Election PASSED; received 1 response(s) [bc54a94b-7132-4b07-a9d2-2b3707eeac69->6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7,true-t1] and 0 exception(s); bc54a94b-7132-4b07-a9d2-2b3707eeac69:t1, leader=null, voted=bc54a94b-7132-4b07-a9d2-2b3707eeac69, raftlog=bc54a94b-7132-4b07-a9d2-2b3707eeac69-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:192.168.46.40:38579, bc54a94b-7132-4b07-a9d2-2b3707eeac69:192.168.46.40:35961, 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:192.168.46.40:39701], old=null
2019-06-14 10:27:55,761 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: shutdown LeaderElection
2019-06-14 10:27:55,761 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69:group-C06A7EE3DC17 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:27:55,761 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69:group-C06A7EE3DC17 change Leader from null to bc54a94b-7132-4b07-a9d2-2b3707eeac69 at term 1 for becomeLeader, leader elected after 1055ms
2019-06-14 10:27:55,761 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:27:55,761 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:27:55,761 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:27:55,761 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:27:55,762 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:27:55,762 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:55,762 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:27:55,762 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:27:55,762 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:55,762 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:55,762 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:27:55,762 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:27:55,762 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:27:55,762 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:27:55,763 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:27:55,763 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:27:55,763 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: start LeaderState
2019-06-14 10:27:55,763 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:55,763 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69:group-C06A7EE3DC17 set configuration 0: [807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:192.168.46.40:38579, bc54a94b-7132-4b07-a9d2-2b3707eeac69:192.168.46.40:35961, 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:192.168.46.40:39701], old=null at 0
2019-06-14 10:27:55,764 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:group-C06A7EE3DC17 change Leader from null to bc54a94b-7132-4b07-a9d2-2b3707eeac69 at term 1 for appendEntries, leader elected after 1060ms
2019-06-14 10:27:55,782 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:group-C06A7EE3DC17 change Leader from null to bc54a94b-7132-4b07-a9d2-2b3707eeac69 at term 1 for appendEntries, leader elected after 1077ms
2019-06-14 10:27:55,803 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:group-C06A7EE3DC17 set configuration 0: [807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:192.168.46.40:38579, bc54a94b-7132-4b07-a9d2-2b3707eeac69:192.168.46.40:35961, 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:192.168.46.40:39701], old=null at 0
2019-06-14 10:27:55,803 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:55,803 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-2/data/ratis/a2420fe4-5827-4332-a4c1-c06a7ee3dc17/current/log_inprogress_0
2019-06-14 10:27:55,805 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:group-C06A7EE3DC17 set configuration 0: [807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:192.168.46.40:38579, bc54a94b-7132-4b07-a9d2-2b3707eeac69:192.168.46.40:35961, 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:192.168.46.40:39701], old=null at 0
2019-06-14 10:27:55,805 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:55,827 INFO  impl.FollowerState (FollowerState.java:run(101)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69:group-8DED78E4F307 changes to CANDIDATE, lastRpcTime:1146, electionTimeout:1146ms
2019-06-14 10:27:55,827 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: shutdown FollowerState
2019-06-14 10:27:55,828 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69:group-8DED78E4F307 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:55,828 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: start LeaderElection
2019-06-14 10:27:55,849 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-0/data/ratis/a2420fe4-5827-4332-a4c1-c06a7ee3dc17/current/log_inprogress_0
2019-06-14 10:27:55,849 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69:group-8DED78E4F307:LeaderElection29: begin an election at term 1 for -1: [bc54a94b-7132-4b07-a9d2-2b3707eeac69:192.168.46.40:35961], old=null
2019-06-14 10:27:55,849 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-1/data/ratis/a2420fe4-5827-4332-a4c1-c06a7ee3dc17/current/log_inprogress_0
2019-06-14 10:27:55,849 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: shutdown LeaderElection
2019-06-14 10:27:55,849 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69:group-8DED78E4F307 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:27:55,849 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69:group-8DED78E4F307 change Leader from null to bc54a94b-7132-4b07-a9d2-2b3707eeac69 at term 1 for becomeLeader, leader elected after 1169ms
2019-06-14 10:27:55,849 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:27:55,849 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:27:55,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:27:55,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:27:55,850 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: start LeaderState
2019-06-14 10:27:55,850 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:55,851 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69:group-8DED78E4F307 set configuration 0: [bc54a94b-7132-4b07-a9d2-2b3707eeac69:192.168.46.40:35961], old=null at 0
2019-06-14 10:27:55,887 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-2/data/ratis/adca781b-a29f-4394-b919-8ded78e4f307/current/log_inprogress_0
2019-06-14 10:27:55,918 INFO  impl.FollowerState (FollowerState.java:run(101)) - 39d16e95-c256-46df-a703-247d3a759235:group-9A024048B0B0 changes to CANDIDATE, lastRpcTime:1018, electionTimeout:1018ms
2019-06-14 10:27:55,918 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 39d16e95-c256-46df-a703-247d3a759235: shutdown FollowerState
2019-06-14 10:27:55,918 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 39d16e95-c256-46df-a703-247d3a759235:group-9A024048B0B0 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:55,918 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 39d16e95-c256-46df-a703-247d3a759235: start LeaderElection
2019-06-14 10:27:55,923 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 39d16e95-c256-46df-a703-247d3a759235:group-9A024048B0B0:LeaderElection30: begin an election at term 1 for -1: [39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213], old=null
2019-06-14 10:27:55,924 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 39d16e95-c256-46df-a703-247d3a759235: shutdown LeaderElection
2019-06-14 10:27:55,924 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 39d16e95-c256-46df-a703-247d3a759235:group-9A024048B0B0 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:27:55,924 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 39d16e95-c256-46df-a703-247d3a759235:group-9A024048B0B0 change Leader from null to 39d16e95-c256-46df-a703-247d3a759235 at term 1 for becomeLeader, leader elected after 1026ms
2019-06-14 10:27:55,924 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:27:55,924 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:27:55,924 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:27:55,924 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:27:55,924 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 39d16e95-c256-46df-a703-247d3a759235: start LeaderState
2019-06-14 10:27:55,924 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 39d16e95-c256-46df-a703-247d3a759235-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:55,925 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 39d16e95-c256-46df-a703-247d3a759235:group-9A024048B0B0 set configuration 0: [39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213], old=null at 0
2019-06-14 10:27:55,960 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 39d16e95-c256-46df-a703-247d3a759235-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-3/data/ratis/a0b79aa8-8a56-4ffb-af16-9a024048b0b0/current/log_inprogress_0
2019-06-14 10:27:56,208 INFO  impl.FollowerState (FollowerState.java:run(101)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-8E4F0D3E56B9 changes to CANDIDATE, lastRpcTime:1168, electionTimeout:1168ms
2019-06-14 10:27:56,208 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: shutdown FollowerState
2019-06-14 10:27:56,209 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-8E4F0D3E56B9 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:56,209 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: start LeaderElection
2019-06-14 10:27:56,214 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-8E4F0D3E56B9:LeaderElection31: begin an election at term 1 for -1: [a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827], old=null
2019-06-14 10:27:56,214 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: shutdown LeaderElection
2019-06-14 10:27:56,214 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-8E4F0D3E56B9 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:27:56,215 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-8E4F0D3E56B9 change Leader from null to a4e4938e-b68b-4cdf-99b1-dab4b8403476 at term 1 for becomeLeader, leader elected after 1176ms
2019-06-14 10:27:56,215 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:27:56,215 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:27:56,215 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:27:56,215 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:27:56,215 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: start LeaderState
2019-06-14 10:27:56,215 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476-RaftLogWorker: Starting segment from index:0
2019-06-14 10:27:56,217 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-8E4F0D3E56B9 set configuration 0: [a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827], old=null at 0
2019-06-14 10:27:56,234 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Cluster is ready. Got 6 of 6 DN Heartbeats.
2019-06-14 10:27:56,255 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-4/data/ratis/a2686f1f-7f67-42c7-9851-8e4f0d3e56b9/current/log_inprogress_0
2019-06-14 10:27:56,267 INFO  rpc.RpcClient (RpcClient.java:createVolume(289)) - Creating Volume: datanodefailurehandlingtest, with root as owner.
2019-06-14 10:27:56,278 INFO  rpc.RpcClient (RpcClient.java:createBucket(426)) - Creating Bucket: datanodefailurehandlingtest/datanodefailurehandlingtest, with Versioning false and Storage Type set to DISK and Encryption set to false 
2019-06-14 10:27:56,293 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:27:56,294 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@3ea6faf0
2019-06-14 10:27:56,294 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:27:56,294 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:27:56,295 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 165e809a-482b-4a99-9113-540c84dfdac6: close
2019-06-14 10:27:56,295 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 165e809a-482b-4a99-9113-540c84dfdac6: shutdown group-4CD4858D81EA
2019-06-14 10:27:56,295 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-4CD4858D81EA,id=165e809a-482b-4a99-9113-540c84dfdac6
2019-06-14 10:27:56,295 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 165e809a-482b-4a99-9113-540c84dfdac6: shutdown FollowerState
2019-06-14 10:27:56,295 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-165e809a-482b-4a99-9113-540c84dfdac6-group-4CD4858D81EA: set stopIndex = -1
2019-06-14 10:27:56,296 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:27:56,296 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 165e809a-482b-4a99-9113-540c84dfdac6:group-4CD4858D81EA closes. The last applied log index is -1
2019-06-14 10:27:56,296 INFO  impl.FollowerState (FollowerState.java:run(109)) - 165e809a-482b-4a99-9113-540c84dfdac6: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:27:56,296 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 165e809a-482b-4a99-9113-540c84dfdac6-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:56,296 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 165e809a-482b-4a99-9113-540c84dfdac6-RaftLogWorker close()
2019-06-14 10:27:56,298 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 165e809a-482b-4a99-9113-540c84dfdac6: shutdown group-3802833F67F1
2019-06-14 10:27:56,298 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-3802833F67F1,id=165e809a-482b-4a99-9113-540c84dfdac6
2019-06-14 10:27:56,298 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 165e809a-482b-4a99-9113-540c84dfdac6: shutdown FollowerState
2019-06-14 10:27:56,298 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-165e809a-482b-4a99-9113-540c84dfdac6-group-3802833F67F1: set stopIndex = -1
2019-06-14 10:27:56,298 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:27:56,298 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 165e809a-482b-4a99-9113-540c84dfdac6:group-3802833F67F1 closes. The last applied log index is -1
2019-06-14 10:27:56,298 INFO  impl.FollowerState (FollowerState.java:run(109)) - 165e809a-482b-4a99-9113-540c84dfdac6: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:27:56,299 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 165e809a-482b-4a99-9113-540c84dfdac6-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:56,299 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 165e809a-482b-4a99-9113-540c84dfdac6-RaftLogWorker close()
2019-06-14 10:27:56,300 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 165e809a-482b-4a99-9113-540c84dfdac6: shutdown server with port 44531 now
2019-06-14 10:27:56,300 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 165e809a-482b-4a99-9113-540c84dfdac6: shutdown server with port 44531 successfully
2019-06-14 10:27:56,301 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:27:56,313 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:27:56,313 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@7682bf66{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:27:56,314 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@4eb73cc8{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:27:56,314 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@10830d50{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:27:56,314 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@64e89bb2{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:27:56,315 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:27:56,315 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@5bba9949
2019-06-14 10:27:56,315 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:27:56,316 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:27:56,316 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 39d16e95-c256-46df-a703-247d3a759235: close
2019-06-14 10:27:56,316 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 39d16e95-c256-46df-a703-247d3a759235: shutdown group-3802833F67F1
2019-06-14 10:27:56,316 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 39d16e95-c256-46df-a703-247d3a759235: shutdown group-9A024048B0B0
2019-06-14 10:27:56,316 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-3802833F67F1,id=39d16e95-c256-46df-a703-247d3a759235
2019-06-14 10:27:56,316 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-9A024048B0B0,id=39d16e95-c256-46df-a703-247d3a759235
2019-06-14 10:27:56,317 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 39d16e95-c256-46df-a703-247d3a759235: shutdown LeaderState
2019-06-14 10:27:56,317 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 39d16e95-c256-46df-a703-247d3a759235: shutdown FollowerState
2019-06-14 10:27:56,317 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:27:56,317 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 39d16e95-c256-46df-a703-247d3a759235-PendingRequests: sendNotLeaderResponses
2019-06-14 10:27:56,317 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-39d16e95-c256-46df-a703-247d3a759235-group-3802833F67F1: set stopIndex = -1
2019-06-14 10:27:56,317 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 39d16e95-c256-46df-a703-247d3a759235:group-3802833F67F1 closes. The last applied log index is -1
2019-06-14 10:27:56,317 INFO  impl.FollowerState (FollowerState.java:run(109)) - 39d16e95-c256-46df-a703-247d3a759235: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:27:56,318 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 39d16e95-c256-46df-a703-247d3a759235-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:56,317 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:27:56,318 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 39d16e95-c256-46df-a703-247d3a759235-RaftLogWorker close()
2019-06-14 10:27:56,317 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-39d16e95-c256-46df-a703-247d3a759235-group-9A024048B0B0: set stopIndex = 0
2019-06-14 10:27:56,319 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 39d16e95-c256-46df-a703-247d3a759235:group-9A024048B0B0 closes. The last applied log index is 0
2019-06-14 10:27:56,319 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 39d16e95-c256-46df-a703-247d3a759235-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:27:56,324 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 39d16e95-c256-46df-a703-247d3a759235-RaftLogWorker close()
2019-06-14 10:27:56,326 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 39d16e95-c256-46df-a703-247d3a759235: shutdown server with port 35213 now
2019-06-14 10:27:56,327 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 39d16e95-c256-46df-a703-247d3a759235: shutdown server with port 35213 successfully
2019-06-14 10:27:56,328 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:27:56,340 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:27:56,340 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@3d2b13b1{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:27:56,341 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@30eb55c9{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:27:56,341 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@18f8ebd4{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:27:56,341 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@4040ccae{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:27:56,470 INFO  impl.FollowerState (FollowerState.java:run(101)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1 changes to CANDIDATE, lastRpcTime:1185, electionTimeout:1185ms
2019-06-14 10:27:56,470 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: shutdown FollowerState
2019-06-14 10:27:56,470 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:27:56,470 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: start LeaderElection
2019-06-14 10:27:56,475 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1:LeaderElection32: begin an election at term 1 for -1: [a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827, 165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531, 39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213], old=null
2019-06-14 10:27:56,480 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1:LeaderElection32 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:44531
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:56,482 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1:LeaderElection32 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:35213
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:56,483 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1:LeaderElection32: Election REJECTED; received 0 response(s) [] and 2 exception(s); a4e4938e-b68b-4cdf-99b1-dab4b8403476:t1, leader=null, voted=a4e4938e-b68b-4cdf-99b1-dab4b8403476, raftlog=a4e4938e-b68b-4cdf-99b1-dab4b8403476-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827, 165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531, 39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213], old=null
2019-06-14 10:27:56,483 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:44531
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:56,484 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:35213
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:56,484 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1 changes role from CANDIDATE to FOLLOWER at term 1 for DISCOVERED_A_NEW_TERM
2019-06-14 10:27:56,484 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: shutdown LeaderElection
2019-06-14 10:27:56,484 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: start FollowerState
2019-06-14 10:27:57,362 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-5E1F0B8124A7->a4e4938e-b68b-4cdf-99b1-dab4b8403476: receive RaftClientReply:client-5E1F0B8124A7->a4e4938e-b68b-4cdf-99b1-dab4b8403476@group-3802833F67F1, cid=53, FAILED org.apache.ratis.protocol.NotLeaderException: Server a4e4938e-b68b-4cdf-99b1-dab4b8403476 is not the leader (165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531). Request must be sent to leader., logIndex=0, commits[a4e4938e-b68b-4cdf-99b1-dab4b8403476:c-1]
2019-06-14 10:27:57,371 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:27:57,515 INFO  impl.FollowerState (FollowerState.java:run(101)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1 changes to CANDIDATE, lastRpcTime:1031, electionTimeout:1031ms
2019-06-14 10:27:57,517 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: shutdown FollowerState
2019-06-14 10:27:57,517 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1 changes role from FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2019-06-14 10:27:57,517 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: start LeaderElection
2019-06-14 10:27:57,520 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1:LeaderElection33: begin an election at term 2 for -1: [a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827, 165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531, 39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213], old=null
2019-06-14 10:27:57,521 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1:LeaderElection33 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:44531
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:57,522 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1:LeaderElection33 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:35213
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:57,524 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1:LeaderElection33: Election REJECTED; received 0 response(s) [] and 2 exception(s); a4e4938e-b68b-4cdf-99b1-dab4b8403476:t2, leader=null, voted=a4e4938e-b68b-4cdf-99b1-dab4b8403476, raftlog=a4e4938e-b68b-4cdf-99b1-dab4b8403476-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827, 165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531, 39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213], old=null
2019-06-14 10:27:57,524 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:44531
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:57,524 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:35213
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:57,524 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1 changes role from CANDIDATE to FOLLOWER at term 2 for DISCOVERED_A_NEW_TERM
2019-06-14 10:27:57,524 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: shutdown LeaderElection
2019-06-14 10:27:57,524 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: start FollowerState
2019-06-14 10:27:57,957 INFO  node.StaleNodeHandler (StaleNodeHandler.java:onMessage(58)) - Datanode 39d16e95-c256-46df-a703-247d3a759235{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null} moved to stale state. Finalizing its pipelines [PipelineID=90ed3804-81ea-431d-a1c5-3802833f67f1, PipelineID=a0b79aa8-8a56-4ffb-af16-9a024048b0b0]
2019-06-14 10:27:57,959 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: 90ed3804-81ea-431d-a1c5-3802833f67f1, Nodes: 165e809a-482b-4a99-9113-540c84dfdac6{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}39d16e95-c256-46df-a703-247d3a759235{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}a4e4938e-b68b-4cdf-99b1-dab4b8403476{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-14 10:27:57,959 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 90ed3804-81ea-431d-a1c5-3802833f67f1, Nodes: 165e809a-482b-4a99-9113-540c84dfdac6{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}39d16e95-c256-46df-a703-247d3a759235{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}a4e4938e-b68b-4cdf-99b1-dab4b8403476{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] moved to CLOSED state
2019-06-14 10:27:57,959 INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #1
2019-06-14 10:27:57,959 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: a0b79aa8-8a56-4ffb-af16-9a024048b0b0, Nodes: 39d16e95-c256-46df-a703-247d3a759235{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:27:57,964 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: a0b79aa8-8a56-4ffb-af16-9a024048b0b0, Nodes: 39d16e95-c256-46df-a703-247d3a759235{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-06-14 10:27:58,257 INFO  node.StaleNodeHandler (StaleNodeHandler.java:onMessage(58)) - Datanode 165e809a-482b-4a99-9113-540c84dfdac6{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null} moved to stale state. Finalizing its pipelines [PipelineID=4c4ce3ff-6378-436c-8875-4cd4858d81ea, PipelineID=90ed3804-81ea-431d-a1c5-3802833f67f1]
2019-06-14 10:27:58,257 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: 4c4ce3ff-6378-436c-8875-4cd4858d81ea, Nodes: 165e809a-482b-4a99-9113-540c84dfdac6{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:27:58,258 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 4c4ce3ff-6378-436c-8875-4cd4858d81ea, Nodes: 165e809a-482b-4a99-9113-540c84dfdac6{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-06-14 10:27:58,258 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: 90ed3804-81ea-431d-a1c5-3802833f67f1, Nodes: 165e809a-482b-4a99-9113-540c84dfdac6{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}39d16e95-c256-46df-a703-247d3a759235{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}a4e4938e-b68b-4cdf-99b1-dab4b8403476{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
2019-06-14 10:27:58,653 INFO  impl.FollowerState (FollowerState.java:run(101)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1 changes to CANDIDATE, lastRpcTime:1128, electionTimeout:1128ms
2019-06-14 10:27:58,653 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: shutdown FollowerState
2019-06-14 10:27:58,653 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1 changes role from FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2019-06-14 10:27:58,653 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: start LeaderElection
2019-06-14 10:27:58,656 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1:LeaderElection34: begin an election at term 3 for -1: [a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827, 165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531, 39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213], old=null
2019-06-14 10:27:58,660 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1:LeaderElection34 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:44531
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:58,665 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1:LeaderElection34 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:35213
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:58,667 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1:LeaderElection34: Election REJECTED; received 0 response(s) [] and 2 exception(s); a4e4938e-b68b-4cdf-99b1-dab4b8403476:t3, leader=null, voted=a4e4938e-b68b-4cdf-99b1-dab4b8403476, raftlog=a4e4938e-b68b-4cdf-99b1-dab4b8403476-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827, 165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531, 39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213], old=null
2019-06-14 10:27:58,667 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:44531
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:58,668 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:35213
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:58,671 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1 changes role from CANDIDATE to FOLLOWER at term 3 for DISCOVERED_A_NEW_TERM
2019-06-14 10:27:58,671 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: shutdown LeaderElection
2019-06-14 10:27:58,671 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: start FollowerState
2019-06-14 10:27:59,715 INFO  impl.FollowerState (FollowerState.java:run(101)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1 changes to CANDIDATE, lastRpcTime:1043, electionTimeout:1041ms
2019-06-14 10:27:59,715 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: shutdown FollowerState
2019-06-14 10:27:59,715 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1 changes role from FOLLOWER to CANDIDATE at term 3 for changeToCandidate
2019-06-14 10:27:59,715 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: start LeaderElection
2019-06-14 10:27:59,717 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1:LeaderElection35: begin an election at term 4 for -1: [a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827, 165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531, 39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213], old=null
2019-06-14 10:27:59,718 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1:LeaderElection35 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:35213
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:59,720 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1:LeaderElection35 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:44531
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:59,722 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1:LeaderElection35: Election REJECTED; received 0 response(s) [] and 2 exception(s); a4e4938e-b68b-4cdf-99b1-dab4b8403476:t4, leader=null, voted=a4e4938e-b68b-4cdf-99b1-dab4b8403476, raftlog=a4e4938e-b68b-4cdf-99b1-dab4b8403476-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827, 165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531, 39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213], old=null
2019-06-14 10:27:59,722 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:35213
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:59,722 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:44531
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:27:59,722 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1 changes role from CANDIDATE to FOLLOWER at term 4 for DISCOVERED_A_NEW_TERM
2019-06-14 10:27:59,722 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: shutdown LeaderElection
2019-06-14 10:27:59,722 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: start FollowerState
2019-06-14 10:28:00,025 ERROR commandhandler.CloseContainerCommandHandler (CloseContainerCommandHandler.java:handle(84)) - Container #1 does not exist in datanode. Container close failed.
2019-06-14 10:28:00,391 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-5E1F0B8124A7->a4e4938e-b68b-4cdf-99b1-dab4b8403476: receive RaftClientReply:client-5E1F0B8124A7->a4e4938e-b68b-4cdf-99b1-dab4b8403476@group-3802833F67F1, cid=53, FAILED org.apache.ratis.protocol.NotLeaderException: Server a4e4938e-b68b-4cdf-99b1-dab4b8403476 is not the leader (39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213). Request must be sent to leader., logIndex=0, commits[a4e4938e-b68b-4cdf-99b1-dab4b8403476:c-1]
2019-06-14 10:28:00,394 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:00,813 INFO  impl.FollowerState (FollowerState.java:run(101)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1 changes to CANDIDATE, lastRpcTime:1091, electionTimeout:1091ms
2019-06-14 10:28:00,814 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: shutdown FollowerState
2019-06-14 10:28:00,814 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1 changes role from FOLLOWER to CANDIDATE at term 4 for changeToCandidate
2019-06-14 10:28:00,814 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: start LeaderElection
2019-06-14 10:28:00,816 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1:LeaderElection36: begin an election at term 5 for -1: [a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827, 165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531, 39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213], old=null
2019-06-14 10:28:00,817 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1:LeaderElection36 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:44531
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:00,819 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1:LeaderElection36 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:35213
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:00,821 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1:LeaderElection36: Election REJECTED; received 0 response(s) [] and 2 exception(s); a4e4938e-b68b-4cdf-99b1-dab4b8403476:t5, leader=null, voted=a4e4938e-b68b-4cdf-99b1-dab4b8403476, raftlog=a4e4938e-b68b-4cdf-99b1-dab4b8403476-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827, 165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531, 39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213], old=null
2019-06-14 10:28:00,821 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:44531
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:00,821 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:35213
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:00,821 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1 changes role from CANDIDATE to FOLLOWER at term 5 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:00,821 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: shutdown LeaderElection
2019-06-14 10:28:00,821 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: start FollowerState
2019-06-14 10:28:01,402 WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(276)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-5E1F0B8124A7->39d16e95-c256-46df-a703-247d3a759235@group-3802833F67F1, cid=53, seq=1*, RW, org.apache.hadoop.hdds.scm.XceiverClientRatis$$Lambda$436/510793091@63ffdafc for 5 attempts with RetryLimited(maxAttempts=5, sleepTime=1000ms) on the pipeline Pipeline[ Id: 90ed3804-81ea-431d-a1c5-3802833f67f1, Nodes: 165e809a-482b-4a99-9113-540c84dfdac6{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}39d16e95-c256-46df-a703-247d3a759235{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}a4e4938e-b68b-4cdf-99b1-dab4b8403476{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]. The last committed block length is 0, uncommitted data length is 524288 retry count 0
2019-06-14 10:28:01,421 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-79DF8D84A823->6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: receive RaftClientReply:client-79DF8D84A823->6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7@group-C06A7EE3DC17, cid=55, FAILED org.apache.ratis.protocol.NotLeaderException: Server 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7 is not the leader (bc54a94b-7132-4b07-a9d2-2b3707eeac69:192.168.46.40:35961). Request must be sent to leader., logIndex=0, commits[6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:c0, 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:c0, bc54a94b-7132-4b07-a9d2-2b3707eeac69:c0]
2019-06-14 10:28:01,425 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:01,927 INFO  impl.FollowerState (FollowerState.java:run(101)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1 changes to CANDIDATE, lastRpcTime:1106, electionTimeout:1106ms
2019-06-14 10:28:01,928 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: shutdown FollowerState
2019-06-14 10:28:01,928 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1 changes role from FOLLOWER to CANDIDATE at term 5 for changeToCandidate
2019-06-14 10:28:01,928 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: start LeaderElection
2019-06-14 10:28:01,930 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1:LeaderElection37: begin an election at term 6 for -1: [a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827, 165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531, 39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213], old=null
2019-06-14 10:28:01,931 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1:LeaderElection37 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:35213
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:01,933 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1:LeaderElection37 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:44531
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:01,941 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1:LeaderElection37: Election REJECTED; received 0 response(s) [] and 2 exception(s); a4e4938e-b68b-4cdf-99b1-dab4b8403476:t6, leader=null, voted=a4e4938e-b68b-4cdf-99b1-dab4b8403476, raftlog=a4e4938e-b68b-4cdf-99b1-dab4b8403476-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [a4e4938e-b68b-4cdf-99b1-dab4b8403476:192.168.46.40:36827, 165e809a-482b-4a99-9113-540c84dfdac6:192.168.46.40:44531, 39d16e95-c256-46df-a703-247d3a759235:192.168.46.40:35213], old=null
2019-06-14 10:28:01,941 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:35213
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:01,941 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:44531
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:01,941 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1 changes role from CANDIDATE to FOLLOWER at term 6 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:01,941 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: shutdown LeaderElection
2019-06-14 10:28:01,942 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: start FollowerState
2019-06-14 10:28:02,482 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-79DF8D84A823->bc54a94b-7132-4b07-a9d2-2b3707eeac69: receive RaftClientReply:client-79DF8D84A823->bc54a94b-7132-4b07-a9d2-2b3707eeac69@group-C06A7EE3DC17, cid=55, SUCCESS, logIndex=1, commits[bc54a94b-7132-4b07-a9d2-2b3707eeac69:c1, 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:c0, 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:c0]
2019-06-14 10:28:02,530 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-79DF8D84A823->bc54a94b-7132-4b07-a9d2-2b3707eeac69: receive RaftClientReply:client-79DF8D84A823->bc54a94b-7132-4b07-a9d2-2b3707eeac69@group-C06A7EE3DC17, cid=56, SUCCESS, logIndex=3, commits[bc54a94b-7132-4b07-a9d2-2b3707eeac69:c4, 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:c3, 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:c3]
2019-06-14 10:28:02,548 INFO  keyvalue.KeyValueHandler (ContainerUtils.java:logAndReturnError(146)) - Operation: GetBlock : Trace ID: 55b69cb267ab8c45:55b69cb267ab8c45:0:0 : Message: Unable to find the block with bcsID 3 .Container 2 bcsId is 0. : Result: UNKNOWN_BCSID
10:28:02.552 [grpc-default-executor-3] ERROR DNAudit - user=null | ip=null | op=GET_BLOCK {blockData=conID: 2 locID: 102269457623023624 bcsId: 3} | ret=FAILURE
java.lang.Exception: Unable to find the block with bcsID 3 .Container 2 bcsId is 0.
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatchRequest(HddsDispatcher.java:320) [hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.dispatch(HddsDispatcher.java:148) [hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.GrpcXceiverService$1.onNext(GrpcXceiverService.java:73) [hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.GrpcXceiverService$1.onNext(GrpcXceiverService.java:61) [hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:248) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.Contexts$ContextualizedServerCallListener.onMessage(Contexts.java:76) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.hadoop.hdds.tracing.GrpcServerInterceptor$1.onMessage(GrpcServerInterceptor.java:46) [hadoop-hdds-common-0.5.0-SNAPSHOT.jar:?]
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:263) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:686) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-06-14 10:28:02,572 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:shutdown(321)) - Shutting down the Mini Ozone Cluster
2019-06-14 10:28:02,573 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(336)) - Stopping the Mini Ozone Cluster
2019-06-14 10:28:02,573 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(338)) - Stopping the OzoneManager
2019-06-14 10:28:02,573 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 42883
2019-06-14 10:28:02,583 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-14 10:28:02,583 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 42883
2019-06-14 10:28:02,583 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service KeyDeletingService
2019-06-14 10:28:02,585 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@36cf16a6{/,null,UNAVAILABLE}{/ozoneManager}
2019-06-14 10:28:02,585 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@3dd750ba{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:28:02,585 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@1592e540{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,UNAVAILABLE}
2019-06-14 10:28:02,586 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@fceab5d{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:28:02,587 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(344)) - Stopping the StorageContainerManager
2019-06-14 10:28:02,587 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(789)) - Stopping Replication Manager Service.
2019-06-14 10:28:02,587 INFO  container.ReplicationManager (ReplicationManager.java:stop(191)) - Replication Monitor Thread is not running.
2019-06-14 10:28:02,587 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(796)) - Stopping Lease Manager of the command watchers
2019-06-14 10:28:02,587 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(803)) - Stopping datanode service RPC server
2019-06-14 10:28:02,587 INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(373)) - Stopping the RPC server for DataNodes
2019-06-14 10:28:02,588 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 34073
2019-06-14 10:28:02,590 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 34073
2019-06-14 10:28:02,591 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-14 10:28:02,591 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(811)) - Stopping block service RPC server
2019-06-14 10:28:02,591 INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(145)) - Stopping the RPC server for Block Protocol
2019-06-14 10:28:02,591 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 45961
2019-06-14 10:28:02,593 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 45961
2019-06-14 10:28:02,594 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(818)) - Stopping the StorageContainerLocationProtocol RPC server
2019-06-14 10:28:02,594 INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(157)) - Stopping the RPC server for Client Protocol
2019-06-14 10:28:02,594 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-14 10:28:02,594 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 39659
2019-06-14 10:28:02,596 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 39659
2019-06-14 10:28:02,598 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(825)) - Stopping Storage Container Manager HTTP server.
2019-06-14 10:28:02,598 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-14 10:28:02,598 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@39a865c1{/,null,UNAVAILABLE}{/scm}
2019-06-14 10:28:02,599 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@141dfcf9{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:28:02,599 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@7c682e26{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,UNAVAILABLE}
2019-06-14 10:28:02,599 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@4946485c{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:28:02,599 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(836)) - Stopping Block Manager Service.
2019-06-14 10:28:02,600 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service SCMBlockDeletingService
2019-06-14 10:28:02,600 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service SCMBlockDeletingService
2019-06-14 10:28:02,600 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(858)) - Stopping SCM Event Queue.
2019-06-14 10:28:02,605 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(350)) - Shutting the HddsDatanodes
2019-06-14 10:28:02,605 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:28:02,605 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@40d10264
2019-06-14 10:28:02,605 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:28:02,606 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:28:02,606 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: close
2019-06-14 10:28:02,607 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: shutdown group-899EB2E094CC
2019-06-14 10:28:02,607 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-899EB2E094CC,id=807d8c6c-cd12-4929-ab88-2fe0d7a9ec07
2019-06-14 10:28:02,607 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: shutdown LeaderState
2019-06-14 10:28:02,607 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07-PendingRequests: sendNotLeaderResponses
2019-06-14 10:28:02,607 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-807d8c6c-cd12-4929-ab88-2fe0d7a9ec07-group-899EB2E094CC: set stopIndex = 0
2019-06-14 10:28:02,607 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:28:02,607 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:group-899EB2E094CC closes. The last applied log index is 0
2019-06-14 10:28:02,607 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:02,608 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07-RaftLogWorker close()
2019-06-14 10:28:02,609 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: shutdown group-C06A7EE3DC17
2019-06-14 10:28:02,609 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C06A7EE3DC17,id=807d8c6c-cd12-4929-ab88-2fe0d7a9ec07
2019-06-14 10:28:02,609 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: shutdown FollowerState
2019-06-14 10:28:02,609 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-807d8c6c-cd12-4929-ab88-2fe0d7a9ec07-group-C06A7EE3DC17: set stopIndex = 3
2019-06-14 10:28:02,610 INFO  impl.FollowerState (FollowerState.java:run(109)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:28:02,610 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-14 10:28:02,610 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-0/data/ratis/a2420fe4-5827-4332-a4c1-c06a7ee3dc17/sm/snapshot.1_3
2019-06-14 10:28:02,610 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:group-C06A7EE3DC17 closes. The last applied log index is 3
2019-06-14 10:28:02,610 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:02,611 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07-RaftLogWorker close()
2019-06-14 10:28:02,612 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: shutdown server with port 38579 now
2019-06-14 10:28:02,613 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:02,613 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: shutdown server with port 38579 successfully
2019-06-14 10:28:02,613 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: Failed appendEntries to 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07:192.168.46.40:38579: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-14 10:28:02,614 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:28:02,618 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69->807d8c6c-cd12-4929-ab88-2fe0d7a9ec07: nextIndex: updateUnconditionally 5 -> 0
2019-06-14 10:28:02,626 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:28:02,626 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@4bab78ce{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:28:02,627 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@42ffbab6{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:28:02,627 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@2aa07d80{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:28:02,627 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@35f01759{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:28:02,628 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:28:02,628 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@6fc28e5b
2019-06-14 10:28:02,628 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:28:02,629 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:28:02,629 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: close
2019-06-14 10:28:02,629 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: shutdown group-C06A7EE3DC17
2019-06-14 10:28:02,629 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C06A7EE3DC17,id=6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7
2019-06-14 10:28:02,630 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: shutdown FollowerState
2019-06-14 10:28:02,630 INFO  impl.FollowerState (FollowerState.java:run(109)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:28:02,630 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-14 10:28:02,630 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-1/data/ratis/a2420fe4-5827-4332-a4c1-c06a7ee3dc17/sm/snapshot.1_3
2019-06-14 10:28:02,630 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7-group-C06A7EE3DC17: set stopIndex = 3
2019-06-14 10:28:02,631 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:group-C06A7EE3DC17 closes. The last applied log index is 3
2019-06-14 10:28:02,631 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:02,632 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7-RaftLogWorker close()
2019-06-14 10:28:02,632 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: shutdown group-B93209A721F5
2019-06-14 10:28:02,633 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-B93209A721F5,id=6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7
2019-06-14 10:28:02,633 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: shutdown LeaderState
2019-06-14 10:28:02,633 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7-PendingRequests: sendNotLeaderResponses
2019-06-14 10:28:02,635 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7-group-B93209A721F5: set stopIndex = 0
2019-06-14 10:28:02,635 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:28:02,636 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:group-B93209A721F5 closes. The last applied log index is 0
2019-06-14 10:28:02,636 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:02,637 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7-RaftLogWorker close()
2019-06-14 10:28:02,638 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: shutdown server with port 39701 now
2019-06-14 10:28:02,639 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:02,639 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: shutdown server with port 39701 successfully
2019-06-14 10:28:02,639 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: Failed appendEntries to 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7:192.168.46.40:39701: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-14 10:28:02,641 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69->6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7: nextIndex: updateUnconditionally 5 -> 0
2019-06-14 10:28:02,643 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:28:02,654 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:28:02,654 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@5bccaedb{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:28:02,655 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@3c5e45dd{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:28:02,655 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@66944c7c{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:28:02,655 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@b4d83ac{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:28:02,656 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:28:02,656 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@18b45500
2019-06-14 10:28:02,656 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:28:02,656 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:28:02,657 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: close
2019-06-14 10:28:02,657 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: shutdown group-C06A7EE3DC17
2019-06-14 10:28:02,657 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C06A7EE3DC17,id=bc54a94b-7132-4b07-a9d2-2b3707eeac69
2019-06-14 10:28:02,657 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: shutdown LeaderState
2019-06-14 10:28:02,657 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69-PendingRequests: sendNotLeaderResponses
2019-06-14 10:28:02,657 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(bc54a94b-7132-4b07-a9d2-2b3707eeac69 -> 807d8c6c-cd12-4929-ab88-2fe0d7a9ec07): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:28:02,657 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(bc54a94b-7132-4b07-a9d2-2b3707eeac69 -> 6ccfd13f-02d2-4b0f-b56e-0ee15e531cf7): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:28:02,659 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-bc54a94b-7132-4b07-a9d2-2b3707eeac69-group-C06A7EE3DC17: set stopIndex = 4
2019-06-14 10:28:02,659 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-14 10:28:02,659 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-0bab8f0e-a0e2-4a81-b387-b69d992f6ca8/datanode-2/data/ratis/a2420fe4-5827-4332-a4c1-c06a7ee3dc17/sm/snapshot.1_4
2019-06-14 10:28:02,659 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69:group-C06A7EE3DC17 closes. The last applied log index is 4
2019-06-14 10:28:02,659 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:02,660 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69-RaftLogWorker close()
2019-06-14 10:28:02,661 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: shutdown group-8DED78E4F307
2019-06-14 10:28:02,661 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-8DED78E4F307,id=bc54a94b-7132-4b07-a9d2-2b3707eeac69
2019-06-14 10:28:02,661 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: shutdown LeaderState
2019-06-14 10:28:02,661 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69-PendingRequests: sendNotLeaderResponses
2019-06-14 10:28:02,662 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-bc54a94b-7132-4b07-a9d2-2b3707eeac69-group-8DED78E4F307: set stopIndex = 0
2019-06-14 10:28:02,662 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:28:02,662 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69:group-8DED78E4F307 closes. The last applied log index is 0
2019-06-14 10:28:02,662 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:02,663 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69-RaftLogWorker close()
2019-06-14 10:28:02,664 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: shutdown server with port 35961 now
2019-06-14 10:28:02,664 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - bc54a94b-7132-4b07-a9d2-2b3707eeac69: shutdown server with port 35961 successfully
2019-06-14 10:28:02,665 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:28:02,676 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:28:02,677 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@5d3f8661{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:28:02,677 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@1df9f7c6{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:28:02,677 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@3c65f00e{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:28:02,678 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@493968a9{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:28:02,678 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:28:02,679 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@e04b8a0
2019-06-14 10:28:02,679 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:28:02,679 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:28:02,679 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: close
2019-06-14 10:28:02,679 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: shutdown group-3802833F67F1
2019-06-14 10:28:02,679 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: shutdown group-8E4F0D3E56B9
2019-06-14 10:28:02,679 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-3802833F67F1,id=a4e4938e-b68b-4cdf-99b1-dab4b8403476
2019-06-14 10:28:02,680 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: shutdown FollowerState
2019-06-14 10:28:02,680 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-a4e4938e-b68b-4cdf-99b1-dab4b8403476-group-3802833F67F1: set stopIndex = -1
2019-06-14 10:28:02,680 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-8E4F0D3E56B9,id=a4e4938e-b68b-4cdf-99b1-dab4b8403476
2019-06-14 10:28:02,680 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: shutdown LeaderState
2019-06-14 10:28:02,680 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476-PendingRequests: sendNotLeaderResponses
2019-06-14 10:28:02,680 INFO  impl.FollowerState (FollowerState.java:run(109)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:28:02,680 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:28:02,682 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-3802833F67F1 closes. The last applied log index is -1
2019-06-14 10:28:02,683 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:28:02,683 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:02,683 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-a4e4938e-b68b-4cdf-99b1-dab4b8403476-group-8E4F0D3E56B9: set stopIndex = 0
2019-06-14 10:28:02,683 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476-RaftLogWorker close()
2019-06-14 10:28:02,683 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476:group-8E4F0D3E56B9 closes. The last applied log index is 0
2019-06-14 10:28:02,684 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:02,685 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476-RaftLogWorker close()
2019-06-14 10:28:02,686 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: shutdown server with port 36827 now
2019-06-14 10:28:02,687 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - a4e4938e-b68b-4cdf-99b1-dab4b8403476: shutdown server with port 36827 successfully
2019-06-14 10:28:02,690 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:28:02,699 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:28:02,700 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@78508e6b{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:28:02,701 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@1bde9a22{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:28:02,701 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@379b4e86{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:28:02,701 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@3093b9ff{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:28:02,720 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:02,725 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:02,725 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:02,725 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedBlocks
2019-06-14 10:28:02,725 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedBlocks
2019-06-14 10:28:02,726 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: validCerts
2019-06-14 10:28:02,726 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:validCerts
2019-06-14 10:28:02,726 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: revokedCerts
2019-06-14 10:28:02,726 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:revokedCerts
2019-06-14 10:28:02,726 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-14 10:28:02,726 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-14 10:28:02,726 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-14 10:28:02,764 INFO  node.SCMNodeManager (SCMNodeManager.java:<init>(108)) - Entering startup safe mode.
2019-06-14 10:28:02,765 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(125)) - Loading file from sun.misc.CompoundEnumeration@788d9139
2019-06-14 10:28:02,765 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(171)) - Loading network topology layer schema file
2019-06-14 10:28:02,768 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:02,780 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:initializePipelineState(126)) - No pipeline exists in current db
2019-06-14 10:28:02,780 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:02,794 WARN  events.EventQueue (EventQueue.java:fireEvent(175)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='SafeModeStatus'}
2019-06-14 10:28:02,795 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:28:02,795 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 41075
2019-06-14 10:28:02,799 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:28:02,799 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 35033
2019-06-14 10:28:02,801 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:28:02,802 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 42811
2019-06-14 10:28:02,807 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for scm at: http://0.0.0.0:0
2019-06-14 10:28:02,808 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:28:02,809 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:28:02,810 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:28:02,810 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context scm
2019-06-14 10:28:02,811 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:28:02,811 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:28:02,815 INFO  server.StorageContainerManager (StorageContainerManager.java:start(752)) - StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:42811
2019-06-14 10:28:02,815 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - StorageContainerManager metrics system started (again)
2019-06-14 10:28:02,815 INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:start(149)) - RPC server for Client  is listening at /0.0.0.0:42811
2019-06-14 10:28:02,815 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:28:02,818 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 42811: starting
2019-06-14 10:28:02,840 INFO  server.StorageContainerManager (StorageContainerManager.java:start(761)) - ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:35033
2019-06-14 10:28:02,840 INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:start(137)) - RPC server for Block Protocol is listening at /0.0.0.0:35033
2019-06-14 10:28:02,840 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:28:02,840 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 35033: starting
2019-06-14 10:28:02,848 INFO  server.StorageContainerManager (StorageContainerManager.java:start(765)) - ScmDatanodeProtocl RPC server is listening at /0.0.0.0:41075
2019-06-14 10:28:02,848 INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:start(191)) - RPC server for DataNodes is listening at /0.0.0.0:41075
2019-06-14 10:28:02,848 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:28:02,848 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 41075: starting
2019-06-14 10:28:02,851 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 39591
2019-06-14 10:28:02,851 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:28:02,852 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@2ff62720{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:28:02,852 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@42c9b1ee{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-14 10:28:02,855 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@5bcfdaf3{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/scm/,AVAILABLE}{/scm}
2019-06-14 10:28:02,855 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@38347345{HTTP/1.1,[http/1.1]}{0.0.0.0:39591}
2019-06-14 10:28:02,855 INFO  server.Server (Server.java:doStart(419)) - Started @48114ms
2019-06-14 10:28:02,857 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of SCM is listening at http://0.0.0.0:39591
2019-06-14 10:28:02,858 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:02,858 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:28:02,860 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:02,861 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(519)) - OM Service ID is not set. Setting it to the default ID: omServiceIdDefault
2019-06-14 10:28:02,861 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(525)) - OM Node ID is not set. Setting it to the OmStorage's OmID: fe92874e-cd72-46a0-8900-c8f33e93d268
2019-06-14 10:28:02,861 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 10:28:02,861 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 10:28:02,861 INFO  om.OzoneManager (OzoneManager.java:loadOMHAConfigs(476)) - Found matching OM address with OMServiceId: null, OMNodeId: null, RPC Address: localhost:0 and Ratis port: 9872
2019-06-14 10:28:02,864 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:02,865 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: userTable
2019-06-14 10:28:02,865 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:userTable
2019-06-14 10:28:02,865 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: volumeTable
2019-06-14 10:28:02,865 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:volumeTable
2019-06-14 10:28:02,865 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: bucketTable
2019-06-14 10:28:02,865 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:bucketTable
2019-06-14 10:28:02,865 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: keyTable
2019-06-14 10:28:02,866 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:keyTable
2019-06-14 10:28:02,866 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedTable
2019-06-14 10:28:02,866 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedTable
2019-06-14 10:28:02,866 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: openKeyTable
2019-06-14 10:28:02,866 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:openKeyTable
2019-06-14 10:28:02,866 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3Table
2019-06-14 10:28:02,866 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3Table
2019-06-14 10:28:02,866 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: multipartInfoTable
2019-06-14 10:28:02,867 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:multipartInfoTable
2019-06-14 10:28:02,867 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: dTokenTable
2019-06-14 10:28:02,867 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:dTokenTable
2019-06-14 10:28:02,867 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3SecretTable
2019-06-14 10:28:02,867 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3SecretTable
2019-06-14 10:28:02,867 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: prefixTable
2019-06-14 10:28:02,867 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:prefixTable
2019-06-14 10:28:02,867 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-14 10:28:02,868 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-14 10:28:02,868 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-14 10:28:02,998 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:28:02,999 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 41189
2019-06-14 10:28:03,009 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:03,009 INFO  om.OzoneManager (OzoneManager.java:start(1217)) - OzoneManager RPC server is listening at localhost/127.0.0.1:41189
2019-06-14 10:28:03,009 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - OzoneManager metrics system started (again)
2019-06-14 10:28:03,010 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:28:03,010 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 41189: starting
2019-06-14 10:28:03,016 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for ozoneManager at: http://0.0.0.0:0
2019-06-14 10:28:03,017 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:28:03,017 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:28:03,018 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:28:03,019 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context ozoneManager
2019-06-14 10:28:03,019 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:28:03,019 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:28:03,019 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 33829
2019-06-14 10:28:03,019 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:28:03,021 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@22105c76{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:28:03,021 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@7f5ecada{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-14 10:28:03,024 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@22846a1d{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/ozoneManager/,AVAILABLE}{/ozoneManager}
2019-06-14 10:28:03,024 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@fe38c0e{HTTP/1.1,[http/1.1]}{0.0.0.0:33829}
2019-06-14 10:28:03,025 INFO  server.Server (Server.java:doStart(419)) - Started @48283ms
2019-06-14 10:28:03,025 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of OZONEMANAGER is listening at http://0.0.0.0:33829
2019-06-14 10:28:03,033 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:28:03,033 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:28:03,038 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-0/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:28:03,038 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-0/data/containers/hdds to VolumeSet
2019-06-14 10:28:03,038 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@53b907d9
2019-06-14 10:28:03,039 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@53b907d9
2019-06-14 10:28:03,047 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 44923
2019-06-14 10:28:03,048 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:28:03,048 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 44923 (custom)
2019-06-14 10:28:03,048 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:28:03,048 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:03,048 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:28:03,049 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:03,049 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-0/data/ratis] (custom)
2019-06-14 10:28:03,049 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 38307
2019-06-14 10:28:03,050 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:28:03,050 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:28:03,051 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:28:03,051 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:28:03,052 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:28:03,053 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:28:03,053 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:28:03,053 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:28:03,054 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 33747
2019-06-14 10:28:03,054 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:28:03,060 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@52b30dcd{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:28:03,060 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@1bbc1b90{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:28:03,082 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@8636cf4{/,file:///tmp/jetty-0.0.0.0-33747-hddsDatanode-_-any-3514949403261588834.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:28:03,082 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@7c9512c6{HTTP/1.1,[http/1.1]}{0.0.0.0:33747}
2019-06-14 10:28:03,083 INFO  server.Server (Server.java:doStart(419)) - Started @48341ms
2019-06-14 10:28:03,083 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:33747
Jun 14, 2019 10:28:03 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:28:03,212 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@361d8567
2019-06-14 10:28:03,213 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:28:03,213 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:28:03,214 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:28:03,214 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-0/meta/datanode.id
2019-06-14 10:28:03,219 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-1/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:28:03,220 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-1/data/containers/hdds to VolumeSet
2019-06-14 10:28:03,220 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@4d84688f
2019-06-14 10:28:03,220 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@4d84688f
2019-06-14 10:28:03,229 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43295
2019-06-14 10:28:03,230 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:28:03,230 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43295 (custom)
2019-06-14 10:28:03,231 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:28:03,231 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:03,231 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:28:03,231 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:03,231 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-1/data/ratis] (custom)
2019-06-14 10:28:03,232 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 33893
2019-06-14 10:28:03,232 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:28:03,233 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:28:03,233 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:28:03,234 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:28:03,235 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:28:03,235 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:28:03,235 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:28:03,235 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:28:03,236 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 42865
2019-06-14 10:28:03,236 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:28:03,237 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@6f95654c{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:28:03,238 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@74c23525{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:28:03,260 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@2682cccc{/,file:///tmp/jetty-0.0.0.0-42865-hddsDatanode-_-any-2964448036150990818.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:28:03,260 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@2ae08750{HTTP/1.1,[http/1.1]}{0.0.0.0:42865}
2019-06-14 10:28:03,261 INFO  server.Server (Server.java:doStart(419)) - Started @48519ms
2019-06-14 10:28:03,261 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:42865
Jun 14, 2019 10:28:03 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:28:03,353 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@40105b39
2019-06-14 10:28:03,354 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:28:03,354 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:28:03,357 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:28:03,358 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-1/meta/datanode.id
2019-06-14 10:28:03,361 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-2/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:28:03,361 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-2/data/containers/hdds to VolumeSet
2019-06-14 10:28:03,361 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@2b3d03b2
2019-06-14 10:28:03,362 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@2b3d03b2
2019-06-14 10:28:03,371 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 35827
2019-06-14 10:28:03,372 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:28:03,372 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 35827 (custom)
2019-06-14 10:28:03,373 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:28:03,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:03,373 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:28:03,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:03,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-2/data/ratis] (custom)
2019-06-14 10:28:03,374 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42671
2019-06-14 10:28:03,374 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:28:03,375 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:28:03,376 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:28:03,389 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:28:03,391 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:28:03,391 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:28:03,391 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:28:03,391 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:28:03,392 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 35213
2019-06-14 10:28:03,392 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:28:03,410 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@1b96d447{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:28:03,411 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@3a47bf0e{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:28:03,450 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@4a3383dc{/,file:///tmp/jetty-0.0.0.0-35213-hddsDatanode-_-any-6798654560734139111.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:28:03,452 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@72ce8a9b{HTTP/1.1,[http/1.1]}{0.0.0.0:35213}
2019-06-14 10:28:03,452 INFO  server.Server (Server.java:doStart(419)) - Started @48711ms
2019-06-14 10:28:03,453 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:35213
Jun 14, 2019 10:28:03 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:28:03,539 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@7901a5ab
2019-06-14 10:28:03,539 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:28:03,539 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:28:03,546 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:28:03,546 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-2/meta/datanode.id
2019-06-14 10:28:03,554 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-3/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:28:03,554 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-3/data/containers/hdds to VolumeSet
2019-06-14 10:28:03,554 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3293030b
2019-06-14 10:28:03,554 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3293030b
2019-06-14 10:28:03,563 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 44229
2019-06-14 10:28:03,564 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:28:03,564 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 44229 (custom)
2019-06-14 10:28:03,564 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:28:03,565 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:03,565 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:28:03,565 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:03,565 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-3/data/ratis] (custom)
2019-06-14 10:28:03,566 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 44469
2019-06-14 10:28:03,566 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:28:03,567 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:28:03,567 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:28:03,573 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:28:03,575 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:28:03,575 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:28:03,575 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:28:03,576 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:28:03,576 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 38103
2019-06-14 10:28:03,576 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:28:03,578 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@1b30b6f8{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:28:03,579 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@575fe6da{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:28:03,606 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@1c25deb0{/,file:///tmp/jetty-0.0.0.0-38103-hddsDatanode-_-any-7502754891258550557.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:28:03,607 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@1be12e05{HTTP/1.1,[http/1.1]}{0.0.0.0:38103}
2019-06-14 10:28:03,608 INFO  server.Server (Server.java:doStart(419)) - Started @48867ms
2019-06-14 10:28:03,609 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:38103
Jun 14, 2019 10:28:03 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:28:03,693 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@1f235a0a
2019-06-14 10:28:03,693 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:28:03,693 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:28:03,697 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:28:03,699 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-4/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:28:03,699 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-3/meta/datanode.id
2019-06-14 10:28:03,699 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-4/data/containers/hdds to VolumeSet
2019-06-14 10:28:03,700 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@24558113
2019-06-14 10:28:03,702 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@24558113
2019-06-14 10:28:03,710 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 32961
2019-06-14 10:28:03,711 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:28:03,712 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 32961 (custom)
2019-06-14 10:28:03,712 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:28:03,712 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:03,712 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:28:03,712 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:03,713 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-4/data/ratis] (custom)
2019-06-14 10:28:03,713 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 35577
2019-06-14 10:28:03,714 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:28:03,715 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:28:03,716 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:28:03,716 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:28:03,717 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:28:03,717 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:28:03,718 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:28:03,718 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:28:03,718 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 44967
2019-06-14 10:28:03,718 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:28:03,720 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@59db8216{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:28:03,720 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@33bf2602{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:28:03,741 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@7c93e69{/,file:///tmp/jetty-0.0.0.0-44967-hddsDatanode-_-any-8109717561318117589.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:28:03,741 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@4e4c05a0{HTTP/1.1,[http/1.1]}{0.0.0.0:44967}
2019-06-14 10:28:03,742 INFO  server.Server (Server.java:doStart(419)) - Started @49001ms
2019-06-14 10:28:03,743 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:44967
Jun 14, 2019 10:28:03 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:28:03,867 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@7bb3294c
2019-06-14 10:28:03,867 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:28:03,868 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:28:03,877 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:28:03,879 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-4/meta/datanode.id
2019-06-14 10:28:03,886 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-5/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:28:03,886 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-5/data/containers/hdds to VolumeSet
2019-06-14 10:28:03,887 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@84e43fb
2019-06-14 10:28:03,889 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@84e43fb
2019-06-14 10:28:03,904 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 33479
2019-06-14 10:28:03,905 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:28:03,905 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 33479 (custom)
2019-06-14 10:28:03,905 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:28:03,905 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:03,906 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:28:03,906 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:03,906 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-5/data/ratis] (custom)
2019-06-14 10:28:03,906 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 38357
2019-06-14 10:28:03,907 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:28:03,907 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:28:03,908 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:28:03,909 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:28:03,910 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:28:03,910 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:28:03,910 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:28:03,910 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:28:03,911 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 40133
2019-06-14 10:28:03,911 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:28:03,914 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@5e8e02a3{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:28:03,918 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@66576bd2{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:28:03,942 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@7b38db21{/,file:///tmp/jetty-0.0.0.0-40133-hddsDatanode-_-any-1220089393187946502.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:28:03,946 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@54f4734e{HTTP/1.1,[http/1.1]}{0.0.0.0:40133}
2019-06-14 10:28:03,946 INFO  server.Server (Server.java:doStart(419)) - Started @49205ms
2019-06-14 10:28:03,947 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:40133
Jun 14, 2019 10:28:03 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:28:04,026 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@156f0281
2019-06-14 10:28:04,026 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:28:04,027 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:28:04,027 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-5/meta/datanode.id
2019-06-14 10:28:05,026 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:28:05,066 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-14 10:28:05,223 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:28:05,224 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:28:05,224 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 75f987be-0e56-498c-a731-9178ff149875 at port 44923
2019-06-14 10:28:05,227 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 75f987be-0e56-498c-a731-9178ff149875: start RPC server
2019-06-14 10:28:05,228 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 75f987be-0e56-498c-a731-9178ff149875: GrpcService started, listening on 0.0.0.0/0.0.0.0:44923
2019-06-14 10:28:05,360 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:28:05,360 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:28:05,360 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis bd91091a-c280-437f-8263-5f77ae9d5b9a at port 43295
2019-06-14 10:28:05,364 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: start RPC server
2019-06-14 10:28:05,364 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: GrpcService started, listening on 0.0.0.0/0.0.0.0:43295
2019-06-14 10:28:05,469 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-14 10:28:05,549 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:28:05,550 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:28:05,550 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis b9c49b19-09c2-4188-a006-d6759c13b106 at port 35827
2019-06-14 10:28:05,554 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - b9c49b19-09c2-4188-a006-d6759c13b106: start RPC server
2019-06-14 10:28:05,554 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - b9c49b19-09c2-4188-a006-d6759c13b106: GrpcService started, listening on 0.0.0.0/0.0.0.0:35827
2019-06-14 10:28:05,569 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-14 10:28:05,569 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-14 10:28:05,700 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:28:05,700 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:28:05,700 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis d78c9fa1-8140-46fa-98f3-1d025e275fbb at port 44229
2019-06-14 10:28:05,720 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: start RPC server
2019-06-14 10:28:05,721 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: GrpcService started, listening on 0.0.0.0/0.0.0.0:44229
2019-06-14 10:28:05,881 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:28:05,881 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:28:05,881 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 295b690a-12a8-417c-9186-35ca4bb21c45 at port 32961
2019-06-14 10:28:05,884 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 295b690a-12a8-417c-9186-35ca4bb21c45: start RPC server
2019-06-14 10:28:05,885 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 295b690a-12a8-417c-9186-35ca4bb21c45: GrpcService started, listening on 0.0.0.0/0.0.0.0:32961
2019-06-14 10:28:06,027 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:28:06,030 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:28:06,030 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:28:06,030 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis b58bcdda-f0cf-47c2-806d-984c7da72fef at port 33479
2019-06-14 10:28:06,033 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: start RPC server
2019-06-14 10:28:06,034 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: GrpcService started, listening on 0.0.0.0/0.0.0.0:33479
2019-06-14 10:28:07,027 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:28:07,217 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 75f987be-0e56-498c-a731-9178ff149875{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:28:07,219 INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 1 DataNodes registered, 1 required.
2019-06-14 10:28:07,223 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(177)) - ScmSafeModeManager, all rules are successfully validated
2019-06-14 10:28:07,223 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:exitSafeMode(193)) - SCM exiting safe mode.
2019-06-14 10:28:07,227 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 75f987be-0e56-498c-a731-9178ff149875: addNew group-2F3A23DD38D8:[75f987be-0e56-498c-a731-9178ff149875:192.168.46.40:44923] returns group-2F3A23DD38D8:java.util.concurrent.CompletableFuture@67c9fc5c[Not completed]
2019-06-14 10:28:07,228 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 75f987be-0e56-498c-a731-9178ff149875: new RaftServerImpl for group-2F3A23DD38D8:[75f987be-0e56-498c-a731-9178ff149875:192.168.46.40:44923] with ContainerStateMachine:uninitialized
2019-06-14 10:28:07,228 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:07,228 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:07,228 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:07,228 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:07,228 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 75f987be-0e56-498c-a731-9178ff149875:group-2F3A23DD38D8 ConfigurationManager, init=-1: [75f987be-0e56-498c-a731-9178ff149875:192.168.46.40:44923], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:07,228 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-0/data/ratis] (custom)
2019-06-14 10:28:07,229 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-0/data/ratis/3a0c94a1-bbb5-42ae-bd3b-2f3a23dd38d8 does not exist. Creating ...
2019-06-14 10:28:07,231 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-0/data/ratis/3a0c94a1-bbb5-42ae-bd3b-2f3a23dd38d8/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:07,233 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-0/data/ratis/3a0c94a1-bbb5-42ae-bd3b-2f3a23dd38d8 has been successfully formatted.
2019-06-14 10:28:07,233 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:07,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:07,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:07,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:07,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:07,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:07,233 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 75f987be-0e56-498c-a731-9178ff149875-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-0/data/ratis/3a0c94a1-bbb5-42ae-bd3b-2f3a23dd38d8
2019-06-14 10:28:07,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:07,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:07,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:07,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:07,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:07,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:07,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:07,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:07,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:07,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:07,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:07,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:07,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:07,234 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 75f987be-0e56-498c-a731-9178ff149875: start group-2F3A23DD38D8
2019-06-14 10:28:07,235 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 75f987be-0e56-498c-a731-9178ff149875:group-2F3A23DD38D8 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:07,235 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 75f987be-0e56-498c-a731-9178ff149875: start FollowerState
2019-06-14 10:28:07,235 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-2F3A23DD38D8,id=75f987be-0e56-498c-a731-9178ff149875
2019-06-14 10:28:07,236 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 3a0c94a1-bbb5-42ae-bd3b-2f3a23dd38d8, Nodes: 75f987be-0e56-498c-a731-9178ff149875{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:28:07,358 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : bd91091a-c280-437f-8263-5f77ae9d5b9a{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:28:07,363 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: addNew group-3902C46838A7:[bd91091a-c280-437f-8263-5f77ae9d5b9a:192.168.46.40:43295] returns group-3902C46838A7:java.util.concurrent.CompletableFuture@7a8b1e8f[Not completed]
2019-06-14 10:28:07,363 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: new RaftServerImpl for group-3902C46838A7:[bd91091a-c280-437f-8263-5f77ae9d5b9a:192.168.46.40:43295] with ContainerStateMachine:uninitialized
2019-06-14 10:28:07,364 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:07,364 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:07,364 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:07,364 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:07,364 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - bd91091a-c280-437f-8263-5f77ae9d5b9a:group-3902C46838A7 ConfigurationManager, init=-1: [bd91091a-c280-437f-8263-5f77ae9d5b9a:192.168.46.40:43295], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:07,364 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-1/data/ratis] (custom)
2019-06-14 10:28:07,364 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-1/data/ratis/475d7c49-a467-4dfd-a4d6-3902c46838a7 does not exist. Creating ...
2019-06-14 10:28:07,366 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-1/data/ratis/475d7c49-a467-4dfd-a4d6-3902c46838a7/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:07,372 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-1/data/ratis/475d7c49-a467-4dfd-a4d6-3902c46838a7 has been successfully formatted.
2019-06-14 10:28:07,372 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:07,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:07,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:07,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:07,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:07,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:07,372 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new bd91091a-c280-437f-8263-5f77ae9d5b9a-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-1/data/ratis/475d7c49-a467-4dfd-a4d6-3902c46838a7
2019-06-14 10:28:07,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:07,372 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:07,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:07,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:07,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:07,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:07,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:07,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:07,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:07,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:07,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:07,373 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:07,374 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:07,374 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: start group-3902C46838A7
2019-06-14 10:28:07,374 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bd91091a-c280-437f-8263-5f77ae9d5b9a:group-3902C46838A7 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:07,374 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: start FollowerState
2019-06-14 10:28:07,377 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-3902C46838A7,id=bd91091a-c280-437f-8263-5f77ae9d5b9a
2019-06-14 10:28:07,380 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 475d7c49-a467-4dfd-a4d6-3902c46838a7, Nodes: bd91091a-c280-437f-8263-5f77ae9d5b9a{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:28:07,547 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : b9c49b19-09c2-4188-a006-d6759c13b106{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:28:07,556 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - b9c49b19-09c2-4188-a006-d6759c13b106: addNew group-091A2CB1BF55:[b9c49b19-09c2-4188-a006-d6759c13b106:192.168.46.40:35827] returns group-091A2CB1BF55:java.util.concurrent.CompletableFuture@c1e6e52[Not completed]
2019-06-14 10:28:07,556 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - b9c49b19-09c2-4188-a006-d6759c13b106: new RaftServerImpl for group-091A2CB1BF55:[b9c49b19-09c2-4188-a006-d6759c13b106:192.168.46.40:35827] with ContainerStateMachine:uninitialized
2019-06-14 10:28:07,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:07,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:07,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:07,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:07,557 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - b9c49b19-09c2-4188-a006-d6759c13b106:group-091A2CB1BF55 ConfigurationManager, init=-1: [b9c49b19-09c2-4188-a006-d6759c13b106:192.168.46.40:35827], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:07,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-2/data/ratis] (custom)
2019-06-14 10:28:07,557 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-2/data/ratis/fae3920d-abc2-49cb-ab69-091a2cb1bf55 does not exist. Creating ...
2019-06-14 10:28:07,559 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-2/data/ratis/fae3920d-abc2-49cb-ab69-091a2cb1bf55/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:07,561 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-2/data/ratis/fae3920d-abc2-49cb-ab69-091a2cb1bf55 has been successfully formatted.
2019-06-14 10:28:07,561 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:07,561 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:07,561 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:07,562 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:07,562 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:07,562 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:07,562 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new b9c49b19-09c2-4188-a006-d6759c13b106-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-2/data/ratis/fae3920d-abc2-49cb-ab69-091a2cb1bf55
2019-06-14 10:28:07,562 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:07,562 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:07,562 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:07,562 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:07,562 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:07,562 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:07,562 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:07,562 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:07,562 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:07,562 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:07,563 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:07,563 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:07,563 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:07,563 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - b9c49b19-09c2-4188-a006-d6759c13b106: start group-091A2CB1BF55
2019-06-14 10:28:07,563 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b9c49b19-09c2-4188-a006-d6759c13b106:group-091A2CB1BF55 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:07,563 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b9c49b19-09c2-4188-a006-d6759c13b106: start FollowerState
2019-06-14 10:28:07,563 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-091A2CB1BF55,id=b9c49b19-09c2-4188-a006-d6759c13b106
2019-06-14 10:28:07,565 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: fae3920d-abc2-49cb-ab69-091a2cb1bf55, Nodes: b9c49b19-09c2-4188-a006-d6759c13b106{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:28:07,575 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 75f987be-0e56-498c-a731-9178ff149875: addNew group-8D72E19EE80D:[bd91091a-c280-437f-8263-5f77ae9d5b9a:192.168.46.40:43295, b9c49b19-09c2-4188-a006-d6759c13b106:192.168.46.40:35827, 75f987be-0e56-498c-a731-9178ff149875:192.168.46.40:44923] returns group-8D72E19EE80D:java.util.concurrent.CompletableFuture@3dec19b8[Not completed]
2019-06-14 10:28:07,577 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 75f987be-0e56-498c-a731-9178ff149875: new RaftServerImpl for group-8D72E19EE80D:[bd91091a-c280-437f-8263-5f77ae9d5b9a:192.168.46.40:43295, b9c49b19-09c2-4188-a006-d6759c13b106:192.168.46.40:35827, 75f987be-0e56-498c-a731-9178ff149875:192.168.46.40:44923] with ContainerStateMachine:uninitialized
2019-06-14 10:28:07,577 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:07,577 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:07,577 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:07,578 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:07,578 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 75f987be-0e56-498c-a731-9178ff149875:group-8D72E19EE80D ConfigurationManager, init=-1: [bd91091a-c280-437f-8263-5f77ae9d5b9a:192.168.46.40:43295, b9c49b19-09c2-4188-a006-d6759c13b106:192.168.46.40:35827, 75f987be-0e56-498c-a731-9178ff149875:192.168.46.40:44923], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:07,578 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-0/data/ratis] (custom)
2019-06-14 10:28:07,578 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-0/data/ratis/5e0a7dc3-374b-42f0-9237-8d72e19ee80d does not exist. Creating ...
2019-06-14 10:28:07,579 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: addNew group-8D72E19EE80D:[bd91091a-c280-437f-8263-5f77ae9d5b9a:192.168.46.40:43295, b9c49b19-09c2-4188-a006-d6759c13b106:192.168.46.40:35827, 75f987be-0e56-498c-a731-9178ff149875:192.168.46.40:44923] returns group-8D72E19EE80D:java.util.concurrent.CompletableFuture@44efd458[Not completed]
2019-06-14 10:28:07,580 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: new RaftServerImpl for group-8D72E19EE80D:[bd91091a-c280-437f-8263-5f77ae9d5b9a:192.168.46.40:43295, b9c49b19-09c2-4188-a006-d6759c13b106:192.168.46.40:35827, 75f987be-0e56-498c-a731-9178ff149875:192.168.46.40:44923] with ContainerStateMachine:uninitialized
2019-06-14 10:28:07,580 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:07,580 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:07,580 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-0/data/ratis/5e0a7dc3-374b-42f0-9237-8d72e19ee80d/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:07,580 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:07,580 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:07,581 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - bd91091a-c280-437f-8263-5f77ae9d5b9a:group-8D72E19EE80D ConfigurationManager, init=-1: [bd91091a-c280-437f-8263-5f77ae9d5b9a:192.168.46.40:43295, b9c49b19-09c2-4188-a006-d6759c13b106:192.168.46.40:35827, 75f987be-0e56-498c-a731-9178ff149875:192.168.46.40:44923], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:07,581 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-1/data/ratis] (custom)
2019-06-14 10:28:07,581 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-1/data/ratis/5e0a7dc3-374b-42f0-9237-8d72e19ee80d does not exist. Creating ...
2019-06-14 10:28:07,583 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-0/data/ratis/5e0a7dc3-374b-42f0-9237-8d72e19ee80d has been successfully formatted.
2019-06-14 10:28:07,583 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - b9c49b19-09c2-4188-a006-d6759c13b106: addNew group-8D72E19EE80D:[bd91091a-c280-437f-8263-5f77ae9d5b9a:192.168.46.40:43295, b9c49b19-09c2-4188-a006-d6759c13b106:192.168.46.40:35827, 75f987be-0e56-498c-a731-9178ff149875:192.168.46.40:44923] returns group-8D72E19EE80D:java.util.concurrent.CompletableFuture@39f4d78e[Not completed]
2019-06-14 10:28:07,583 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:07,583 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-1/data/ratis/5e0a7dc3-374b-42f0-9237-8d72e19ee80d/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:07,583 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:07,584 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:07,584 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:07,584 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:07,584 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:07,584 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - b9c49b19-09c2-4188-a006-d6759c13b106: new RaftServerImpl for group-8D72E19EE80D:[bd91091a-c280-437f-8263-5f77ae9d5b9a:192.168.46.40:43295, b9c49b19-09c2-4188-a006-d6759c13b106:192.168.46.40:35827, 75f987be-0e56-498c-a731-9178ff149875:192.168.46.40:44923] with ContainerStateMachine:uninitialized
2019-06-14 10:28:07,584 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 75f987be-0e56-498c-a731-9178ff149875-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-0/data/ratis/5e0a7dc3-374b-42f0-9237-8d72e19ee80d
2019-06-14 10:28:07,584 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:07,584 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:07,584 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:07,585 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:07,585 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:07,585 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:07,585 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:07,585 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:07,585 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:07,585 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:07,585 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:07,586 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:07,586 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:07,586 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-1/data/ratis/5e0a7dc3-374b-42f0-9237-8d72e19ee80d has been successfully formatted.
2019-06-14 10:28:07,586 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:07,586 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:07,586 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:07,586 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:07,586 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:07,586 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:07,587 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new bd91091a-c280-437f-8263-5f77ae9d5b9a-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-1/data/ratis/5e0a7dc3-374b-42f0-9237-8d72e19ee80d
2019-06-14 10:28:07,587 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:07,587 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:07,587 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:07,587 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:07,587 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:07,587 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:07,587 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:07,587 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:07,587 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:07,587 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:07,586 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:07,588 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:07,588 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:07,588 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:07,587 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:07,588 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: start group-8D72E19EE80D
2019-06-14 10:28:07,588 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bd91091a-c280-437f-8263-5f77ae9d5b9a:group-8D72E19EE80D changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:07,588 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: start FollowerState
2019-06-14 10:28:07,588 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 75f987be-0e56-498c-a731-9178ff149875: start group-8D72E19EE80D
2019-06-14 10:28:07,588 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 75f987be-0e56-498c-a731-9178ff149875:group-8D72E19EE80D changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:07,593 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-8D72E19EE80D,id=bd91091a-c280-437f-8263-5f77ae9d5b9a
2019-06-14 10:28:07,593 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:07,593 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:07,593 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 75f987be-0e56-498c-a731-9178ff149875: start FollowerState
2019-06-14 10:28:07,594 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - b9c49b19-09c2-4188-a006-d6759c13b106:group-8D72E19EE80D ConfigurationManager, init=-1: [bd91091a-c280-437f-8263-5f77ae9d5b9a:192.168.46.40:43295, b9c49b19-09c2-4188-a006-d6759c13b106:192.168.46.40:35827, 75f987be-0e56-498c-a731-9178ff149875:192.168.46.40:44923], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:07,594 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-2/data/ratis] (custom)
2019-06-14 10:28:07,594 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-2/data/ratis/5e0a7dc3-374b-42f0-9237-8d72e19ee80d does not exist. Creating ...
2019-06-14 10:28:07,594 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-8D72E19EE80D,id=75f987be-0e56-498c-a731-9178ff149875
2019-06-14 10:28:07,599 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-2/data/ratis/5e0a7dc3-374b-42f0-9237-8d72e19ee80d/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:07,601 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-2/data/ratis/5e0a7dc3-374b-42f0-9237-8d72e19ee80d has been successfully formatted.
2019-06-14 10:28:07,601 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:07,602 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:07,602 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:07,602 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:07,602 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:07,602 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:07,602 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new b9c49b19-09c2-4188-a006-d6759c13b106-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-2/data/ratis/5e0a7dc3-374b-42f0-9237-8d72e19ee80d
2019-06-14 10:28:07,602 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:07,602 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:07,602 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:07,602 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:07,602 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:07,602 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:07,602 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:07,602 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:07,603 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:07,603 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:07,603 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:07,603 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:07,603 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:07,603 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - b9c49b19-09c2-4188-a006-d6759c13b106: start group-8D72E19EE80D
2019-06-14 10:28:07,603 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b9c49b19-09c2-4188-a006-d6759c13b106:group-8D72E19EE80D changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:07,603 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b9c49b19-09c2-4188-a006-d6759c13b106: start FollowerState
2019-06-14 10:28:07,604 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-8D72E19EE80D,id=b9c49b19-09c2-4188-a006-d6759c13b106
2019-06-14 10:28:07,605 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 5e0a7dc3-374b-42f0-9237-8d72e19ee80d, Nodes: b9c49b19-09c2-4188-a006-d6759c13b106{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}75f987be-0e56-498c-a731-9178ff149875{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}bd91091a-c280-437f-8263-5f77ae9d5b9a{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-14 10:28:07,698 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : d78c9fa1-8140-46fa-98f3-1d025e275fbb{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:28:07,704 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: addNew group-1D0420C8326B:[d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229] returns group-1D0420C8326B:java.util.concurrent.CompletableFuture@1a54ef82[Not completed]
2019-06-14 10:28:07,704 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: new RaftServerImpl for group-1D0420C8326B:[d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229] with ContainerStateMachine:uninitialized
2019-06-14 10:28:07,704 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:07,704 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:07,705 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:07,705 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:07,705 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb:group-1D0420C8326B ConfigurationManager, init=-1: [d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:07,705 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-3/data/ratis] (custom)
2019-06-14 10:28:07,705 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-3/data/ratis/4b99eb5d-eb43-41d4-9e93-1d0420c8326b does not exist. Creating ...
2019-06-14 10:28:07,707 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-3/data/ratis/4b99eb5d-eb43-41d4-9e93-1d0420c8326b/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:07,709 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-3/data/ratis/4b99eb5d-eb43-41d4-9e93-1d0420c8326b has been successfully formatted.
2019-06-14 10:28:07,709 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:07,709 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:07,710 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:07,710 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:07,710 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:07,710 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:07,710 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new d78c9fa1-8140-46fa-98f3-1d025e275fbb-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-3/data/ratis/4b99eb5d-eb43-41d4-9e93-1d0420c8326b
2019-06-14 10:28:07,710 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:07,710 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:07,710 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:07,710 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:07,710 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:07,710 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:07,710 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:07,710 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:07,710 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:07,711 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:07,711 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:07,711 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:07,711 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:07,711 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: start group-1D0420C8326B
2019-06-14 10:28:07,711 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb:group-1D0420C8326B changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:07,711 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: start FollowerState
2019-06-14 10:28:07,712 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-1D0420C8326B,id=d78c9fa1-8140-46fa-98f3-1d025e275fbb
2019-06-14 10:28:07,713 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 4b99eb5d-eb43-41d4-9e93-1d0420c8326b, Nodes: d78c9fa1-8140-46fa-98f3-1d025e275fbb{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:28:07,879 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 295b690a-12a8-417c-9186-35ca4bb21c45{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:28:07,886 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 295b690a-12a8-417c-9186-35ca4bb21c45: addNew group-E112609DC54A:[295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961] returns group-E112609DC54A:java.util.concurrent.CompletableFuture@2e4b61a4[Not completed]
2019-06-14 10:28:07,886 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 295b690a-12a8-417c-9186-35ca4bb21c45: new RaftServerImpl for group-E112609DC54A:[295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961] with ContainerStateMachine:uninitialized
2019-06-14 10:28:07,886 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:07,886 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:07,886 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:07,886 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:07,887 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-E112609DC54A ConfigurationManager, init=-1: [295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:07,887 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-4/data/ratis] (custom)
2019-06-14 10:28:07,887 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-4/data/ratis/1b3cd96c-e761-4217-8dbd-e112609dc54a does not exist. Creating ...
2019-06-14 10:28:07,889 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-4/data/ratis/1b3cd96c-e761-4217-8dbd-e112609dc54a/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:07,891 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-4/data/ratis/1b3cd96c-e761-4217-8dbd-e112609dc54a has been successfully formatted.
2019-06-14 10:28:07,891 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:07,891 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:07,891 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:07,891 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:07,891 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:07,891 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:07,891 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 295b690a-12a8-417c-9186-35ca4bb21c45-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-4/data/ratis/1b3cd96c-e761-4217-8dbd-e112609dc54a
2019-06-14 10:28:07,891 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:07,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:07,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:07,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:07,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:07,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:07,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:07,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:07,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:07,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:07,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:07,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:07,893 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:07,893 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 295b690a-12a8-417c-9186-35ca4bb21c45: start group-E112609DC54A
2019-06-14 10:28:07,893 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-E112609DC54A changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:07,893 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 295b690a-12a8-417c-9186-35ca4bb21c45: start FollowerState
2019-06-14 10:28:07,893 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-E112609DC54A,id=295b690a-12a8-417c-9186-35ca4bb21c45
2019-06-14 10:28:07,894 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 1b3cd96c-e761-4217-8dbd-e112609dc54a, Nodes: 295b690a-12a8-417c-9186-35ca4bb21c45{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:28:08,027 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 5 of 6 DN Heartbeats.
2019-06-14 10:28:08,028 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : b58bcdda-f0cf-47c2-806d-984c7da72fef{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:28:08,038 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: addNew group-F08BE2A1B6FA:[b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479] returns group-F08BE2A1B6FA:java.util.concurrent.CompletableFuture@4b1472a[Not completed]
2019-06-14 10:28:08,038 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: new RaftServerImpl for group-F08BE2A1B6FA:[b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479] with ContainerStateMachine:uninitialized
2019-06-14 10:28:08,038 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:08,038 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:08,039 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:08,039 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:08,039 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - b58bcdda-f0cf-47c2-806d-984c7da72fef:group-F08BE2A1B6FA ConfigurationManager, init=-1: [b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:08,039 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-5/data/ratis] (custom)
2019-06-14 10:28:08,039 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-5/data/ratis/1ed40399-2416-487f-95f3-f08be2a1b6fa does not exist. Creating ...
2019-06-14 10:28:08,041 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-5/data/ratis/1ed40399-2416-487f-95f3-f08be2a1b6fa/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:08,044 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-5/data/ratis/1ed40399-2416-487f-95f3-f08be2a1b6fa has been successfully formatted.
2019-06-14 10:28:08,044 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:08,044 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:08,044 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:08,044 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:08,044 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:08,044 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:08,044 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new b58bcdda-f0cf-47c2-806d-984c7da72fef-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-5/data/ratis/1ed40399-2416-487f-95f3-f08be2a1b6fa
2019-06-14 10:28:08,044 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:08,044 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:08,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:08,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:08,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:08,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:08,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:08,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:08,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:08,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:08,046 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:08,046 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:08,046 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:08,046 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: start group-F08BE2A1B6FA
2019-06-14 10:28:08,046 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b58bcdda-f0cf-47c2-806d-984c7da72fef:group-F08BE2A1B6FA changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:08,046 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: start FollowerState
2019-06-14 10:28:08,046 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-F08BE2A1B6FA,id=b58bcdda-f0cf-47c2-806d-984c7da72fef
2019-06-14 10:28:08,048 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 1ed40399-2416-487f-95f3-f08be2a1b6fa, Nodes: b58bcdda-f0cf-47c2-806d-984c7da72fef{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:28:08,056 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: addNew group-9305B63EF336:[b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479, d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229, 295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961] returns group-9305B63EF336:java.util.concurrent.CompletableFuture@1722bb4a[Not completed]
2019-06-14 10:28:08,056 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 295b690a-12a8-417c-9186-35ca4bb21c45: addNew group-9305B63EF336:[b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479, d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229, 295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961] returns group-9305B63EF336:java.util.concurrent.CompletableFuture@2b1d5ff4[Not completed]
2019-06-14 10:28:08,056 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 295b690a-12a8-417c-9186-35ca4bb21c45: new RaftServerImpl for group-9305B63EF336:[b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479, d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229, 295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961] with ContainerStateMachine:uninitialized
2019-06-14 10:28:08,056 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:08,056 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:08,056 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:08,056 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: addNew group-9305B63EF336:[b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479, d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229, 295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961] returns group-9305B63EF336:java.util.concurrent.CompletableFuture@5c981ea4[Not completed]
2019-06-14 10:28:08,056 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:08,057 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-9305B63EF336 ConfigurationManager, init=-1: [b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479, d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229, 295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:08,057 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-4/data/ratis] (custom)
2019-06-14 10:28:08,057 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: new RaftServerImpl for group-9305B63EF336:[b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479, d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229, 295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961] with ContainerStateMachine:uninitialized
2019-06-14 10:28:08,057 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-4/data/ratis/502b1cdf-3a57-451f-982e-9305b63ef336 does not exist. Creating ...
2019-06-14 10:28:08,056 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: new RaftServerImpl for group-9305B63EF336:[b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479, d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229, 295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961] with ContainerStateMachine:uninitialized
2019-06-14 10:28:08,057 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:08,057 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:08,057 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:08,057 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:08,058 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:08,058 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:08,058 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:08,058 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:08,058 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - b58bcdda-f0cf-47c2-806d-984c7da72fef:group-9305B63EF336 ConfigurationManager, init=-1: [b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479, d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229, 295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:08,058 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb:group-9305B63EF336 ConfigurationManager, init=-1: [b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479, d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229, 295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:08,058 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-5/data/ratis] (custom)
2019-06-14 10:28:08,058 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-3/data/ratis] (custom)
2019-06-14 10:28:08,059 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-3/data/ratis/502b1cdf-3a57-451f-982e-9305b63ef336 does not exist. Creating ...
2019-06-14 10:28:08,059 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-5/data/ratis/502b1cdf-3a57-451f-982e-9305b63ef336 does not exist. Creating ...
2019-06-14 10:28:08,059 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-4/data/ratis/502b1cdf-3a57-451f-982e-9305b63ef336/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:08,061 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-5/data/ratis/502b1cdf-3a57-451f-982e-9305b63ef336/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:08,061 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-3/data/ratis/502b1cdf-3a57-451f-982e-9305b63ef336/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:08,062 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-4/data/ratis/502b1cdf-3a57-451f-982e-9305b63ef336 has been successfully formatted.
2019-06-14 10:28:08,062 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-5/data/ratis/502b1cdf-3a57-451f-982e-9305b63ef336 has been successfully formatted.
2019-06-14 10:28:08,062 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-3/data/ratis/502b1cdf-3a57-451f-982e-9305b63ef336 has been successfully formatted.
2019-06-14 10:28:08,063 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:08,062 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:08,063 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:08,063 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:08,063 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:08,063 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:08,063 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:08,063 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:08,063 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:08,063 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:08,063 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:08,063 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:08,064 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new b58bcdda-f0cf-47c2-806d-984c7da72fef-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-5/data/ratis/502b1cdf-3a57-451f-982e-9305b63ef336
2019-06-14 10:28:08,063 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:08,064 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:08,064 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:08,064 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:08,064 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:08,064 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:08,064 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:08,064 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:08,064 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:08,064 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:08,064 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:08,065 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:08,065 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 295b690a-12a8-417c-9186-35ca4bb21c45-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-4/data/ratis/502b1cdf-3a57-451f-982e-9305b63ef336
2019-06-14 10:28:08,065 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:08,065 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:08,065 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new d78c9fa1-8140-46fa-98f3-1d025e275fbb-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-3/data/ratis/502b1cdf-3a57-451f-982e-9305b63ef336
2019-06-14 10:28:08,065 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:08,065 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:08,065 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:08,065 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:08,065 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:08,065 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:08,065 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:08,066 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:08,066 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:08,066 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:08,066 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:08,066 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:08,066 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:08,066 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:08,066 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:08,066 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: start group-9305B63EF336
2019-06-14 10:28:08,066 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:08,066 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b58bcdda-f0cf-47c2-806d-984c7da72fef:group-9305B63EF336 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:08,066 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:08,067 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: start FollowerState
2019-06-14 10:28:08,067 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:08,067 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:08,067 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:08,067 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:08,067 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:08,067 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:08,067 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:08,067 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:08,067 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-9305B63EF336,id=b58bcdda-f0cf-47c2-806d-984c7da72fef
2019-06-14 10:28:08,068 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:08,068 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:08,068 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:08,068 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: start group-9305B63EF336
2019-06-14 10:28:08,069 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb:group-9305B63EF336 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:08,070 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:08,070 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:08,070 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: start FollowerState
2019-06-14 10:28:08,070 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:08,070 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 295b690a-12a8-417c-9186-35ca4bb21c45: start group-9305B63EF336
2019-06-14 10:28:08,070 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-9305B63EF336 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:08,070 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 295b690a-12a8-417c-9186-35ca4bb21c45: start FollowerState
2019-06-14 10:28:08,070 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-9305B63EF336,id=d78c9fa1-8140-46fa-98f3-1d025e275fbb
2019-06-14 10:28:08,070 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-9305B63EF336,id=295b690a-12a8-417c-9186-35ca4bb21c45
2019-06-14 10:28:08,073 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 502b1cdf-3a57-451f-982e-9305b63ef336, Nodes: b58bcdda-f0cf-47c2-806d-984c7da72fef{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}d78c9fa1-8140-46fa-98f3-1d025e275fbb{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}295b690a-12a8-417c-9186-35ca4bb21c45{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-14 10:28:08,320 INFO  impl.FollowerState (FollowerState.java:run(101)) - 75f987be-0e56-498c-a731-9178ff149875:group-2F3A23DD38D8 changes to CANDIDATE, lastRpcTime:1085, electionTimeout:1085ms
2019-06-14 10:28:08,320 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 75f987be-0e56-498c-a731-9178ff149875: shutdown FollowerState
2019-06-14 10:28:08,320 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 75f987be-0e56-498c-a731-9178ff149875:group-2F3A23DD38D8 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:08,320 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 75f987be-0e56-498c-a731-9178ff149875: start LeaderElection
2019-06-14 10:28:08,326 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 75f987be-0e56-498c-a731-9178ff149875:group-2F3A23DD38D8:LeaderElection38: begin an election at term 1 for -1: [75f987be-0e56-498c-a731-9178ff149875:192.168.46.40:44923], old=null
2019-06-14 10:28:08,326 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 75f987be-0e56-498c-a731-9178ff149875: shutdown LeaderElection
2019-06-14 10:28:08,326 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 75f987be-0e56-498c-a731-9178ff149875:group-2F3A23DD38D8 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:28:08,326 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 75f987be-0e56-498c-a731-9178ff149875:group-2F3A23DD38D8 change Leader from null to 75f987be-0e56-498c-a731-9178ff149875 at term 1 for becomeLeader, leader elected after 1093ms
2019-06-14 10:28:08,326 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:08,326 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:08,326 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:08,326 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:08,326 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 75f987be-0e56-498c-a731-9178ff149875: start LeaderState
2019-06-14 10:28:08,327 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 75f987be-0e56-498c-a731-9178ff149875-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:08,328 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 75f987be-0e56-498c-a731-9178ff149875:group-2F3A23DD38D8 set configuration 0: [75f987be-0e56-498c-a731-9178ff149875:192.168.46.40:44923], old=null at 0
2019-06-14 10:28:08,363 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 75f987be-0e56-498c-a731-9178ff149875-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-0/data/ratis/3a0c94a1-bbb5-42ae-bd3b-2f3a23dd38d8/current/log_inprogress_0
2019-06-14 10:28:08,542 INFO  impl.FollowerState (FollowerState.java:run(101)) - bd91091a-c280-437f-8263-5f77ae9d5b9a:group-3902C46838A7 changes to CANDIDATE, lastRpcTime:1168, electionTimeout:1165ms
2019-06-14 10:28:08,542 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: shutdown FollowerState
2019-06-14 10:28:08,543 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bd91091a-c280-437f-8263-5f77ae9d5b9a:group-3902C46838A7 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:08,543 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: start LeaderElection
2019-06-14 10:28:08,548 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - bd91091a-c280-437f-8263-5f77ae9d5b9a:group-3902C46838A7:LeaderElection39: begin an election at term 1 for -1: [bd91091a-c280-437f-8263-5f77ae9d5b9a:192.168.46.40:43295], old=null
2019-06-14 10:28:08,548 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: shutdown LeaderElection
2019-06-14 10:28:08,548 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bd91091a-c280-437f-8263-5f77ae9d5b9a:group-3902C46838A7 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:28:08,548 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - bd91091a-c280-437f-8263-5f77ae9d5b9a:group-3902C46838A7 change Leader from null to bd91091a-c280-437f-8263-5f77ae9d5b9a at term 1 for becomeLeader, leader elected after 1176ms
2019-06-14 10:28:08,549 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:08,549 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:08,549 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:08,549 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:08,549 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: start LeaderState
2019-06-14 10:28:08,549 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - bd91091a-c280-437f-8263-5f77ae9d5b9a-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:08,553 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - bd91091a-c280-437f-8263-5f77ae9d5b9a:group-3902C46838A7 set configuration 0: [bd91091a-c280-437f-8263-5f77ae9d5b9a:192.168.46.40:43295], old=null at 0
2019-06-14 10:28:08,585 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - bd91091a-c280-437f-8263-5f77ae9d5b9a-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-1/data/ratis/475d7c49-a467-4dfd-a4d6-3902c46838a7/current/log_inprogress_0
2019-06-14 10:28:08,633 INFO  impl.FollowerState (FollowerState.java:run(101)) - b9c49b19-09c2-4188-a006-d6759c13b106:group-8D72E19EE80D changes to CANDIDATE, lastRpcTime:1029, electionTimeout:1029ms
2019-06-14 10:28:08,633 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b9c49b19-09c2-4188-a006-d6759c13b106: shutdown FollowerState
2019-06-14 10:28:08,633 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b9c49b19-09c2-4188-a006-d6759c13b106:group-8D72E19EE80D changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:08,633 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b9c49b19-09c2-4188-a006-d6759c13b106: start LeaderElection
2019-06-14 10:28:08,639 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b9c49b19-09c2-4188-a006-d6759c13b106:group-8D72E19EE80D:LeaderElection40: begin an election at term 1 for -1: [bd91091a-c280-437f-8263-5f77ae9d5b9a:192.168.46.40:43295, b9c49b19-09c2-4188-a006-d6759c13b106:192.168.46.40:35827, 75f987be-0e56-498c-a731-9178ff149875:192.168.46.40:44923], old=null
2019-06-14 10:28:08,644 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 75f987be-0e56-498c-a731-9178ff149875:group-8D72E19EE80D changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:b9c49b19-09c2-4188-a006-d6759c13b106
2019-06-14 10:28:08,644 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 75f987be-0e56-498c-a731-9178ff149875: shutdown FollowerState
2019-06-14 10:28:08,644 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 75f987be-0e56-498c-a731-9178ff149875: start FollowerState
2019-06-14 10:28:08,644 INFO  impl.FollowerState (FollowerState.java:run(109)) - 75f987be-0e56-498c-a731-9178ff149875: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:28:08,649 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bd91091a-c280-437f-8263-5f77ae9d5b9a:group-8D72E19EE80D changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:b9c49b19-09c2-4188-a006-d6759c13b106
2019-06-14 10:28:08,649 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: shutdown FollowerState
2019-06-14 10:28:08,649 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: start FollowerState
2019-06-14 10:28:08,650 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b9c49b19-09c2-4188-a006-d6759c13b106:group-8D72E19EE80D:LeaderElection40: Election PASSED; received 1 response(s) [b9c49b19-09c2-4188-a006-d6759c13b106->75f987be-0e56-498c-a731-9178ff149875,true-t1] and 0 exception(s); b9c49b19-09c2-4188-a006-d6759c13b106:t1, leader=null, voted=b9c49b19-09c2-4188-a006-d6759c13b106, raftlog=b9c49b19-09c2-4188-a006-d6759c13b106-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [bd91091a-c280-437f-8263-5f77ae9d5b9a:192.168.46.40:43295, b9c49b19-09c2-4188-a006-d6759c13b106:192.168.46.40:35827, 75f987be-0e56-498c-a731-9178ff149875:192.168.46.40:44923], old=null
2019-06-14 10:28:08,650 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b9c49b19-09c2-4188-a006-d6759c13b106: shutdown LeaderElection
2019-06-14 10:28:08,650 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b9c49b19-09c2-4188-a006-d6759c13b106:group-8D72E19EE80D changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:28:08,650 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - b9c49b19-09c2-4188-a006-d6759c13b106:group-8D72E19EE80D change Leader from null to b9c49b19-09c2-4188-a006-d6759c13b106 at term 1 for becomeLeader, leader elected after 1048ms
2019-06-14 10:28:08,650 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:08,650 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:08,650 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:08,650 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:08,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:28:08,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:08,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:28:08,651 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:28:08,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:08,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:08,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:28:08,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:08,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:28:08,652 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:28:08,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:08,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:08,652 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b9c49b19-09c2-4188-a006-d6759c13b106: start LeaderState
2019-06-14 10:28:08,652 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - b9c49b19-09c2-4188-a006-d6759c13b106-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:08,657 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - bd91091a-c280-437f-8263-5f77ae9d5b9a:group-8D72E19EE80D change Leader from null to b9c49b19-09c2-4188-a006-d6759c13b106 at term 1 for appendEntries, leader elected after 1070ms
2019-06-14 10:28:08,657 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - b9c49b19-09c2-4188-a006-d6759c13b106:group-8D72E19EE80D set configuration 0: [bd91091a-c280-437f-8263-5f77ae9d5b9a:192.168.46.40:43295, b9c49b19-09c2-4188-a006-d6759c13b106:192.168.46.40:35827, 75f987be-0e56-498c-a731-9178ff149875:192.168.46.40:44923], old=null at 0
2019-06-14 10:28:08,659 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 75f987be-0e56-498c-a731-9178ff149875:group-8D72E19EE80D change Leader from null to b9c49b19-09c2-4188-a006-d6759c13b106 at term 1 for appendEntries, leader elected after 1075ms
2019-06-14 10:28:08,671 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - bd91091a-c280-437f-8263-5f77ae9d5b9a:group-8D72E19EE80D set configuration 0: [bd91091a-c280-437f-8263-5f77ae9d5b9a:192.168.46.40:43295, b9c49b19-09c2-4188-a006-d6759c13b106:192.168.46.40:35827, 75f987be-0e56-498c-a731-9178ff149875:192.168.46.40:44923], old=null at 0
2019-06-14 10:28:08,671 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - bd91091a-c280-437f-8263-5f77ae9d5b9a-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:08,691 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 75f987be-0e56-498c-a731-9178ff149875:group-8D72E19EE80D set configuration 0: [bd91091a-c280-437f-8263-5f77ae9d5b9a:192.168.46.40:43295, b9c49b19-09c2-4188-a006-d6759c13b106:192.168.46.40:35827, 75f987be-0e56-498c-a731-9178ff149875:192.168.46.40:44923], old=null at 0
2019-06-14 10:28:08,691 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 75f987be-0e56-498c-a731-9178ff149875-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:08,696 INFO  impl.FollowerState (FollowerState.java:run(101)) - b9c49b19-09c2-4188-a006-d6759c13b106:group-091A2CB1BF55 changes to CANDIDATE, lastRpcTime:1133, electionTimeout:1133ms
2019-06-14 10:28:08,696 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b9c49b19-09c2-4188-a006-d6759c13b106: shutdown FollowerState
2019-06-14 10:28:08,697 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b9c49b19-09c2-4188-a006-d6759c13b106:group-091A2CB1BF55 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:08,697 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b9c49b19-09c2-4188-a006-d6759c13b106: start LeaderElection
2019-06-14 10:28:08,697 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - b9c49b19-09c2-4188-a006-d6759c13b106-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-2/data/ratis/5e0a7dc3-374b-42f0-9237-8d72e19ee80d/current/log_inprogress_0
2019-06-14 10:28:08,721 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b9c49b19-09c2-4188-a006-d6759c13b106:group-091A2CB1BF55:LeaderElection41: begin an election at term 1 for -1: [b9c49b19-09c2-4188-a006-d6759c13b106:192.168.46.40:35827], old=null
2019-06-14 10:28:08,721 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b9c49b19-09c2-4188-a006-d6759c13b106: shutdown LeaderElection
2019-06-14 10:28:08,721 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b9c49b19-09c2-4188-a006-d6759c13b106:group-091A2CB1BF55 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:28:08,721 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - b9c49b19-09c2-4188-a006-d6759c13b106:group-091A2CB1BF55 change Leader from null to b9c49b19-09c2-4188-a006-d6759c13b106 at term 1 for becomeLeader, leader elected after 1159ms
2019-06-14 10:28:08,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:08,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:08,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:08,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:08,722 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b9c49b19-09c2-4188-a006-d6759c13b106: start LeaderState
2019-06-14 10:28:08,722 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - b9c49b19-09c2-4188-a006-d6759c13b106-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:08,722 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - b9c49b19-09c2-4188-a006-d6759c13b106:group-091A2CB1BF55 set configuration 0: [b9c49b19-09c2-4188-a006-d6759c13b106:192.168.46.40:35827], old=null at 0
2019-06-14 10:28:08,745 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - bd91091a-c280-437f-8263-5f77ae9d5b9a-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-1/data/ratis/5e0a7dc3-374b-42f0-9237-8d72e19ee80d/current/log_inprogress_0
2019-06-14 10:28:08,745 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 75f987be-0e56-498c-a731-9178ff149875-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-0/data/ratis/5e0a7dc3-374b-42f0-9237-8d72e19ee80d/current/log_inprogress_0
2019-06-14 10:28:08,763 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - b9c49b19-09c2-4188-a006-d6759c13b106-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-2/data/ratis/fae3920d-abc2-49cb-ab69-091a2cb1bf55/current/log_inprogress_0
2019-06-14 10:28:08,787 INFO  impl.FollowerState (FollowerState.java:run(101)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb:group-1D0420C8326B changes to CANDIDATE, lastRpcTime:1075, electionTimeout:1075ms
2019-06-14 10:28:08,787 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: shutdown FollowerState
2019-06-14 10:28:08,787 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb:group-1D0420C8326B changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:08,787 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: start LeaderElection
2019-06-14 10:28:08,797 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb:group-1D0420C8326B:LeaderElection42: begin an election at term 1 for -1: [d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229], old=null
2019-06-14 10:28:08,797 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: shutdown LeaderElection
2019-06-14 10:28:08,797 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb:group-1D0420C8326B changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:28:08,797 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb:group-1D0420C8326B change Leader from null to d78c9fa1-8140-46fa-98f3-1d025e275fbb at term 1 for becomeLeader, leader elected after 1088ms
2019-06-14 10:28:08,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:08,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:08,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:08,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:08,798 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: start LeaderState
2019-06-14 10:28:08,798 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:08,801 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb:group-1D0420C8326B set configuration 0: [d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229], old=null at 0
2019-06-14 10:28:08,842 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-3/data/ratis/4b99eb5d-eb43-41d4-9e93-1d0420c8326b/current/log_inprogress_0
2019-06-14 10:28:09,028 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Cluster is ready. Got 6 of 6 DN Heartbeats.
2019-06-14 10:28:09,048 INFO  impl.FollowerState (FollowerState.java:run(101)) - b58bcdda-f0cf-47c2-806d-984c7da72fef:group-F08BE2A1B6FA changes to CANDIDATE, lastRpcTime:1002, electionTimeout:1002ms
2019-06-14 10:28:09,048 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: shutdown FollowerState
2019-06-14 10:28:09,049 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b58bcdda-f0cf-47c2-806d-984c7da72fef:group-F08BE2A1B6FA changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:09,049 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: start LeaderElection
2019-06-14 10:28:09,051 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b58bcdda-f0cf-47c2-806d-984c7da72fef:group-F08BE2A1B6FA:LeaderElection43: begin an election at term 1 for -1: [b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479], old=null
2019-06-14 10:28:09,051 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: shutdown LeaderElection
2019-06-14 10:28:09,052 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b58bcdda-f0cf-47c2-806d-984c7da72fef:group-F08BE2A1B6FA changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:28:09,052 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - b58bcdda-f0cf-47c2-806d-984c7da72fef:group-F08BE2A1B6FA change Leader from null to b58bcdda-f0cf-47c2-806d-984c7da72fef at term 1 for becomeLeader, leader elected after 1007ms
2019-06-14 10:28:09,052 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:09,052 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:09,052 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:09,052 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:09,052 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: start LeaderState
2019-06-14 10:28:09,052 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - b58bcdda-f0cf-47c2-806d-984c7da72fef-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:09,053 INFO  rpc.RpcClient (RpcClient.java:createVolume(289)) - Creating Volume: datanodefailurehandlingtest, with root as owner.
2019-06-14 10:28:09,053 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - b58bcdda-f0cf-47c2-806d-984c7da72fef:group-F08BE2A1B6FA set configuration 0: [b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479], old=null at 0
2019-06-14 10:28:09,056 INFO  impl.FollowerState (FollowerState.java:run(101)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-E112609DC54A changes to CANDIDATE, lastRpcTime:1163, electionTimeout:1163ms
2019-06-14 10:28:09,056 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 295b690a-12a8-417c-9186-35ca4bb21c45: shutdown FollowerState
2019-06-14 10:28:09,056 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-E112609DC54A changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:09,056 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 295b690a-12a8-417c-9186-35ca4bb21c45: start LeaderElection
2019-06-14 10:28:09,100 INFO  rpc.RpcClient (RpcClient.java:createBucket(426)) - Creating Bucket: datanodefailurehandlingtest/datanodefailurehandlingtest, with Versioning false and Storage Type set to DISK and Encryption set to false 
2019-06-14 10:28:09,100 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - b58bcdda-f0cf-47c2-806d-984c7da72fef-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-5/data/ratis/1ed40399-2416-487f-95f3-f08be2a1b6fa/current/log_inprogress_0
2019-06-14 10:28:09,108 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-E112609DC54A:LeaderElection44: begin an election at term 1 for -1: [295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961], old=null
2019-06-14 10:28:09,108 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: shutdown LeaderElection
2019-06-14 10:28:09,108 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-E112609DC54A changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:28:09,108 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-E112609DC54A change Leader from null to 295b690a-12a8-417c-9186-35ca4bb21c45 at term 1 for becomeLeader, leader elected after 1217ms
2019-06-14 10:28:09,109 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:09,109 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:09,109 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:09,109 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:09,109 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 295b690a-12a8-417c-9186-35ca4bb21c45: start LeaderState
2019-06-14 10:28:09,109 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 295b690a-12a8-417c-9186-35ca4bb21c45-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:09,109 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-E112609DC54A set configuration 0: [295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961], old=null at 0
2019-06-14 10:28:09,157 INFO  impl.FollowerState (FollowerState.java:run(101)) - b58bcdda-f0cf-47c2-806d-984c7da72fef:group-9305B63EF336 changes to CANDIDATE, lastRpcTime:1090, electionTimeout:1090ms
2019-06-14 10:28:09,157 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: shutdown FollowerState
2019-06-14 10:28:09,157 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b58bcdda-f0cf-47c2-806d-984c7da72fef:group-9305B63EF336 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:09,157 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: start LeaderElection
2019-06-14 10:28:09,201 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 295b690a-12a8-417c-9186-35ca4bb21c45-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-4/data/ratis/1b3cd96c-e761-4217-8dbd-e112609dc54a/current/log_inprogress_0
2019-06-14 10:28:09,195 INFO  impl.FollowerState (FollowerState.java:run(101)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-9305B63EF336 changes to CANDIDATE, lastRpcTime:1123, electionTimeout:1112ms
2019-06-14 10:28:09,202 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 295b690a-12a8-417c-9186-35ca4bb21c45: shutdown FollowerState
2019-06-14 10:28:09,202 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-9305B63EF336 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:09,202 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 295b690a-12a8-417c-9186-35ca4bb21c45: start LeaderElection
2019-06-14 10:28:09,210 INFO  impl.FollowerState (FollowerState.java:run(101)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb:group-9305B63EF336 changes to CANDIDATE, lastRpcTime:1134, electionTimeout:1134ms
2019-06-14 10:28:09,210 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: shutdown FollowerState
2019-06-14 10:28:09,210 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb:group-9305B63EF336 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:09,216 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b58bcdda-f0cf-47c2-806d-984c7da72fef:group-9305B63EF336:LeaderElection45: begin an election at term 1 for -1: [b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479, d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229, 295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961], old=null
2019-06-14 10:28:09,218 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: start LeaderElection
2019-06-14 10:28:09,225 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef: receive RaftClientReply:client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef@group-9305B63EF336, cid=69, FAILED org.apache.ratis.protocol.NotLeaderException: Server b58bcdda-f0cf-47c2-806d-984c7da72fef is not the leader (295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961). Request must be sent to leader., logIndex=0, commits[b58bcdda-f0cf-47c2-806d-984c7da72fef:c-1]
2019-06-14 10:28:09,232 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-9305B63EF336:LeaderElection46: begin an election at term 1 for -1: [b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479, d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229, 295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961], old=null
2019-06-14 10:28:09,234 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b58bcdda-f0cf-47c2-806d-984c7da72fef:group-9305B63EF336:LeaderElection45: Election REJECTED; received 2 response(s) [b58bcdda-f0cf-47c2-806d-984c7da72fef->d78c9fa1-8140-46fa-98f3-1d025e275fbb,false-t1, b58bcdda-f0cf-47c2-806d-984c7da72fef->295b690a-12a8-417c-9186-35ca4bb21c45,false-t1] and 0 exception(s); b58bcdda-f0cf-47c2-806d-984c7da72fef:t1, leader=null, voted=b58bcdda-f0cf-47c2-806d-984c7da72fef, raftlog=b58bcdda-f0cf-47c2-806d-984c7da72fef-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479, d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229, 295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961], old=null
2019-06-14 10:28:09,237 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b58bcdda-f0cf-47c2-806d-984c7da72fef:group-9305B63EF336 changes role from CANDIDATE to FOLLOWER at term 1 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:09,237 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: shutdown LeaderElection
2019-06-14 10:28:09,234 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:09,238 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: start FollowerState
2019-06-14 10:28:09,233 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb:group-9305B63EF336:LeaderElection47: begin an election at term 1 for -1: [b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479, d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229, 295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961], old=null
2019-06-14 10:28:09,245 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-9305B63EF336:LeaderElection46: Election REJECTED; received 2 response(s) [295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef,false-t1, 295b690a-12a8-417c-9186-35ca4bb21c45->d78c9fa1-8140-46fa-98f3-1d025e275fbb,false-t1] and 0 exception(s); 295b690a-12a8-417c-9186-35ca4bb21c45:t1, leader=null, voted=295b690a-12a8-417c-9186-35ca4bb21c45, raftlog=295b690a-12a8-417c-9186-35ca4bb21c45-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479, d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229, 295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961], old=null
2019-06-14 10:28:09,246 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-9305B63EF336 changes role from CANDIDATE to FOLLOWER at term 1 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:09,246 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: shutdown LeaderElection
2019-06-14 10:28:09,246 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 295b690a-12a8-417c-9186-35ca4bb21c45: start FollowerState
2019-06-14 10:28:09,261 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb:group-9305B63EF336:LeaderElection47: Election REJECTED; received 2 response(s) [d78c9fa1-8140-46fa-98f3-1d025e275fbb->b58bcdda-f0cf-47c2-806d-984c7da72fef,false-t1, d78c9fa1-8140-46fa-98f3-1d025e275fbb->295b690a-12a8-417c-9186-35ca4bb21c45,false-t1] and 0 exception(s); d78c9fa1-8140-46fa-98f3-1d025e275fbb:t1, leader=null, voted=d78c9fa1-8140-46fa-98f3-1d025e275fbb, raftlog=d78c9fa1-8140-46fa-98f3-1d025e275fbb-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479, d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229, 295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961], old=null
2019-06-14 10:28:09,261 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb:group-9305B63EF336 changes role from CANDIDATE to FOLLOWER at term 1 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:09,262 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: shutdown LeaderElection
2019-06-14 10:28:09,262 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: start FollowerState
2019-06-14 10:28:10,242 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->d78c9fa1-8140-46fa-98f3-1d025e275fbb: receive RaftClientReply:client-19C8B3D5AD4B->d78c9fa1-8140-46fa-98f3-1d025e275fbb@group-9305B63EF336, cid=69, FAILED org.apache.ratis.protocol.NotLeaderException: Server d78c9fa1-8140-46fa-98f3-1d025e275fbb is not the leader (b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479). Request must be sent to leader., logIndex=0, commits[d78c9fa1-8140-46fa-98f3-1d025e275fbb:c-1]
2019-06-14 10:28:10,247 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:10,315 INFO  impl.FollowerState (FollowerState.java:run(101)) - b58bcdda-f0cf-47c2-806d-984c7da72fef:group-9305B63EF336 changes to CANDIDATE, lastRpcTime:1076, electionTimeout:1076ms
2019-06-14 10:28:10,315 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: shutdown FollowerState
2019-06-14 10:28:10,315 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b58bcdda-f0cf-47c2-806d-984c7da72fef:group-9305B63EF336 changes role from FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2019-06-14 10:28:10,315 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: start LeaderElection
2019-06-14 10:28:10,317 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b58bcdda-f0cf-47c2-806d-984c7da72fef:group-9305B63EF336:LeaderElection48: begin an election at term 2 for -1: [b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479, d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229, 295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961], old=null
2019-06-14 10:28:10,319 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-9305B63EF336 changes role from FOLLOWER to FOLLOWER at term 2 for recognizeCandidate:b58bcdda-f0cf-47c2-806d-984c7da72fef
2019-06-14 10:28:10,319 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 295b690a-12a8-417c-9186-35ca4bb21c45: shutdown FollowerState
2019-06-14 10:28:10,319 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 295b690a-12a8-417c-9186-35ca4bb21c45: start FollowerState
2019-06-14 10:28:10,319 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb:group-9305B63EF336 changes role from FOLLOWER to FOLLOWER at term 2 for recognizeCandidate:b58bcdda-f0cf-47c2-806d-984c7da72fef
2019-06-14 10:28:10,319 INFO  impl.FollowerState (FollowerState.java:run(109)) - 295b690a-12a8-417c-9186-35ca4bb21c45: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:28:10,319 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: shutdown FollowerState
2019-06-14 10:28:10,319 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: start FollowerState
2019-06-14 10:28:10,319 INFO  impl.FollowerState (FollowerState.java:run(109)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:28:10,322 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b58bcdda-f0cf-47c2-806d-984c7da72fef:group-9305B63EF336:LeaderElection48: Election PASSED; received 1 response(s) [b58bcdda-f0cf-47c2-806d-984c7da72fef->295b690a-12a8-417c-9186-35ca4bb21c45,true-t2] and 0 exception(s); b58bcdda-f0cf-47c2-806d-984c7da72fef:t2, leader=null, voted=b58bcdda-f0cf-47c2-806d-984c7da72fef, raftlog=b58bcdda-f0cf-47c2-806d-984c7da72fef-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479, d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229, 295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961], old=null
2019-06-14 10:28:10,322 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: shutdown LeaderElection
2019-06-14 10:28:10,322 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b58bcdda-f0cf-47c2-806d-984c7da72fef:group-9305B63EF336 changes role from CANDIDATE to LEADER at term 2 for changeToLeader
2019-06-14 10:28:10,322 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - b58bcdda-f0cf-47c2-806d-984c7da72fef:group-9305B63EF336 change Leader from null to b58bcdda-f0cf-47c2-806d-984c7da72fef at term 2 for becomeLeader, leader elected after 2259ms
2019-06-14 10:28:10,322 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:10,323 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:10,323 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:10,323 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:10,323 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:28:10,323 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:10,323 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:28:10,323 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:28:10,323 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:10,323 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:10,323 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:28:10,324 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:10,324 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:28:10,324 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:28:10,324 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:10,324 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:10,324 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: start LeaderState
2019-06-14 10:28:10,324 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - b58bcdda-f0cf-47c2-806d-984c7da72fef-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:10,325 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - b58bcdda-f0cf-47c2-806d-984c7da72fef:group-9305B63EF336 set configuration 0: [b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479, d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229, 295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961], old=null at 0
2019-06-14 10:28:10,326 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb:group-9305B63EF336 change Leader from null to b58bcdda-f0cf-47c2-806d-984c7da72fef at term 2 for appendEntries, leader elected after 2263ms
2019-06-14 10:28:10,326 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-9305B63EF336 change Leader from null to b58bcdda-f0cf-47c2-806d-984c7da72fef at term 2 for appendEntries, leader elected after 2263ms
2019-06-14 10:28:10,331 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb:group-9305B63EF336 set configuration 0: [b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479, d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229, 295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961], old=null at 0
2019-06-14 10:28:10,331 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:10,331 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-9305B63EF336 set configuration 0: [b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479, d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229, 295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961], old=null at 0
2019-06-14 10:28:10,331 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 295b690a-12a8-417c-9186-35ca4bb21c45-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:10,372 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-3/data/ratis/502b1cdf-3a57-451f-982e-9305b63ef336/current/log_inprogress_0
2019-06-14 10:28:10,377 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 295b690a-12a8-417c-9186-35ca4bb21c45-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-4/data/ratis/502b1cdf-3a57-451f-982e-9305b63ef336/current/log_inprogress_0
2019-06-14 10:28:10,377 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - b58bcdda-f0cf-47c2-806d-984c7da72fef-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-5/data/ratis/502b1cdf-3a57-451f-982e-9305b63ef336/current/log_inprogress_0
2019-06-14 10:28:11,264 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->295b690a-12a8-417c-9186-35ca4bb21c45: receive RaftClientReply:client-19C8B3D5AD4B->295b690a-12a8-417c-9186-35ca4bb21c45@group-9305B63EF336, cid=69, FAILED org.apache.ratis.protocol.NotLeaderException: Server 295b690a-12a8-417c-9186-35ca4bb21c45 is not the leader (b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479). Request must be sent to leader., logIndex=0, commits[295b690a-12a8-417c-9186-35ca4bb21c45:c0, b58bcdda-f0cf-47c2-806d-984c7da72fef:c0, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c0]
2019-06-14 10:28:11,268 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:12,313 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef: receive RaftClientReply:client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef@group-9305B63EF336, cid=69, SUCCESS, logIndex=1, commits[b58bcdda-f0cf-47c2-806d-984c7da72fef:c1, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c0, 295b690a-12a8-417c-9186-35ca4bb21c45:c0]
2019-06-14 10:28:12,351 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef: receive RaftClientReply:client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef@group-9305B63EF336, cid=70, SUCCESS, logIndex=3, commits[b58bcdda-f0cf-47c2-806d-984c7da72fef:c4, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c3, 295b690a-12a8-417c-9186-35ca4bb21c45:c3]
2019-06-14 10:28:12,368 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef: receive RaftClientReply:client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef@group-9305B63EF336, cid=71, SUCCESS, logIndex=5, commits[b58bcdda-f0cf-47c2-806d-984c7da72fef:c8, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c6, 295b690a-12a8-417c-9186-35ca4bb21c45:c6]
2019-06-14 10:28:12,378 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef: receive RaftClientReply:client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef@group-9305B63EF336, cid=72, SUCCESS, logIndex=6, commits[b58bcdda-f0cf-47c2-806d-984c7da72fef:c8, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c6, 295b690a-12a8-417c-9186-35ca4bb21c45:c6]
2019-06-14 10:28:12,406 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef: receive RaftClientReply:client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef@group-9305B63EF336, cid=73, SUCCESS, logIndex=9, commits[b58bcdda-f0cf-47c2-806d-984c7da72fef:c9, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c8, 295b690a-12a8-417c-9186-35ca4bb21c45:c6]
2019-06-14 10:28:12,415 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef: receive RaftClientReply:client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef@group-9305B63EF336, cid=74, SUCCESS, logIndex=11, commits[b58bcdda-f0cf-47c2-806d-984c7da72fef:c11, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c9, 295b690a-12a8-417c-9186-35ca4bb21c45:c10]
2019-06-14 10:28:12,419 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef: receive RaftClientReply:client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef@group-9305B63EF336, cid=75, SUCCESS, logIndex=12, commits[b58bcdda-f0cf-47c2-806d-984c7da72fef:c12, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c10, 295b690a-12a8-417c-9186-35ca4bb21c45:c10]
2019-06-14 10:28:12,436 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef: receive RaftClientReply:client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef@group-9305B63EF336, cid=76, SUCCESS, logIndex=13, commits[b58bcdda-f0cf-47c2-806d-984c7da72fef:c14, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c11, 295b690a-12a8-417c-9186-35ca4bb21c45:c11]
2019-06-14 10:28:12,443 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef: receive RaftClientReply:client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef@group-9305B63EF336, cid=77, SUCCESS, logIndex=0, commits[b58bcdda-f0cf-47c2-806d-984c7da72fef:c16, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c13, 295b690a-12a8-417c-9186-35ca4bb21c45:c13]
2019-06-14 10:28:12,503 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef: receive RaftClientReply:client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef@group-9305B63EF336, cid=78, SUCCESS, logIndex=17, commits[b58bcdda-f0cf-47c2-806d-984c7da72fef:c17, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c16, 295b690a-12a8-417c-9186-35ca4bb21c45:c16]
2019-06-14 10:28:12,538 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef: receive RaftClientReply:client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef@group-9305B63EF336, cid=79, SUCCESS, logIndex=19, commits[b58bcdda-f0cf-47c2-806d-984c7da72fef:c24, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c19, 295b690a-12a8-417c-9186-35ca4bb21c45:c21]
2019-06-14 10:28:12,539 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef: receive RaftClientReply:client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef@group-9305B63EF336, cid=80, SUCCESS, logIndex=20, commits[b58bcdda-f0cf-47c2-806d-984c7da72fef:c24, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c21, 295b690a-12a8-417c-9186-35ca4bb21c45:c21]
2019-06-14 10:28:12,567 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef: receive RaftClientReply:client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef@group-9305B63EF336, cid=81, SUCCESS, logIndex=21, commits[b58bcdda-f0cf-47c2-806d-984c7da72fef:c24, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c21, 295b690a-12a8-417c-9186-35ca4bb21c45:c21]
2019-06-14 10:28:12,586 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef: receive RaftClientReply:client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef@group-9305B63EF336, cid=82, SUCCESS, logIndex=25, commits[b58bcdda-f0cf-47c2-806d-984c7da72fef:c25, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c21, 295b690a-12a8-417c-9186-35ca4bb21c45:c24]
2019-06-14 10:28:12,676 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef: receive RaftClientReply:client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef@group-9305B63EF336, cid=83, SUCCESS, logIndex=27, commits[b58bcdda-f0cf-47c2-806d-984c7da72fef:c27, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c25, 295b690a-12a8-417c-9186-35ca4bb21c45:c25]
2019-06-14 10:28:12,686 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef: receive RaftClientReply:client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef@group-9305B63EF336, cid=84, SUCCESS, logIndex=28, commits[b58bcdda-f0cf-47c2-806d-984c7da72fef:c29, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c25, 295b690a-12a8-417c-9186-35ca4bb21c45:c26]
2019-06-14 10:28:12,687 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef: receive RaftClientReply:client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef@group-9305B63EF336, cid=85, SUCCESS, logIndex=29, commits[b58bcdda-f0cf-47c2-806d-984c7da72fef:c29, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c26, 295b690a-12a8-417c-9186-35ca4bb21c45:c26]
2019-06-14 10:28:12,690 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef: receive RaftClientReply:client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef@group-9305B63EF336, cid=86, SUCCESS, logIndex=0, commits[b58bcdda-f0cf-47c2-806d-984c7da72fef:c31, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c29, 295b690a-12a8-417c-9186-35ca4bb21c45:c29]
2019-06-14 10:28:12,693 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef: receive RaftClientReply:client-19C8B3D5AD4B->b58bcdda-f0cf-47c2-806d-984c7da72fef@group-9305B63EF336, cid=87, SUCCESS, logIndex=0, commits[b58bcdda-f0cf-47c2-806d-984c7da72fef:c32, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c29, 295b690a-12a8-417c-9186-35ca4bb21c45:c29]
2019-06-14 10:28:12,744 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-BBF5D7A1FC53->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-BBF5D7A1FC53->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=88, SUCCESS, logIndex=1, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c1, bd91091a-c280-437f-8263-5f77ae9d5b9a:c0, 75f987be-0e56-498c-a731-9178ff149875:c0]
2019-06-14 10:28:12,776 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-BBF5D7A1FC53->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-BBF5D7A1FC53->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=89, SUCCESS, logIndex=3, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c4, bd91091a-c280-437f-8263-5f77ae9d5b9a:c3, 75f987be-0e56-498c-a731-9178ff149875:c3]
2019-06-14 10:28:12,794 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-BBF5D7A1FC53->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-BBF5D7A1FC53->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=90, SUCCESS, logIndex=5, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c5, bd91091a-c280-437f-8263-5f77ae9d5b9a:c4, 75f987be-0e56-498c-a731-9178ff149875:c3]
2019-06-14 10:28:12,806 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-BBF5D7A1FC53->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-BBF5D7A1FC53->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=91, SUCCESS, logIndex=6, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c8, bd91091a-c280-437f-8263-5f77ae9d5b9a:c6, 75f987be-0e56-498c-a731-9178ff149875:c6]
2019-06-14 10:28:12,806 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:28:12,806 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@156f0281
2019-06-14 10:28:12,807 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:28:12,807 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:28:12,807 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: close
2019-06-14 10:28:12,807 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: shutdown group-F08BE2A1B6FA
2019-06-14 10:28:12,807 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: shutdown group-9305B63EF336
2019-06-14 10:28:12,808 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-9305B63EF336,id=b58bcdda-f0cf-47c2-806d-984c7da72fef
2019-06-14 10:28:12,808 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-F08BE2A1B6FA,id=b58bcdda-f0cf-47c2-806d-984c7da72fef
2019-06-14 10:28:12,808 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: shutdown LeaderState
2019-06-14 10:28:12,808 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: shutdown LeaderState
2019-06-14 10:28:12,808 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - b58bcdda-f0cf-47c2-806d-984c7da72fef-PendingRequests: sendNotLeaderResponses
2019-06-14 10:28:12,808 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(b58bcdda-f0cf-47c2-806d-984c7da72fef -> 295b690a-12a8-417c-9186-35ca4bb21c45): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:28:12,815 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-b58bcdda-f0cf-47c2-806d-984c7da72fef-group-F08BE2A1B6FA: set stopIndex = 0
2019-06-14 10:28:12,816 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 295b690a-12a8-417c-9186-35ca4bb21c45: appendEntries completed
2019-06-14 10:28:12,808 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(b58bcdda-f0cf-47c2-806d-984c7da72fef -> d78c9fa1-8140-46fa-98f3-1d025e275fbb): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:28:12,816 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: appendEntries completed
2019-06-14 10:28:12,817 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: follower b58bcdda-f0cf-47c2-806d-984c7da72fef->295b690a-12a8-417c-9186-35ca4bb21c45(c29,m32,n33, attendVote=true, lastRpcSendTime=138, lastRpcResponseTime=127) response Completed
2019-06-14 10:28:12,808 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - b58bcdda-f0cf-47c2-806d-984c7da72fef-PendingRequests: sendNotLeaderResponses
2019-06-14 10:28:12,818 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - b58bcdda-f0cf-47c2-806d-984c7da72fef->295b690a-12a8-417c-9186-35ca4bb21c45: nextIndex: updateUnconditionally 33 -> 0
2019-06-14 10:28:12,817 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: follower b58bcdda-f0cf-47c2-806d-984c7da72fef->d78c9fa1-8140-46fa-98f3-1d025e275fbb(c29,m32,n33, attendVote=true, lastRpcSendTime=138, lastRpcResponseTime=127) response Completed
2019-06-14 10:28:12,816 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:28:12,819 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:2, i:29)
2019-06-14 10:28:12,819 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-5/data/ratis/502b1cdf-3a57-451f-982e-9305b63ef336/sm/snapshot.2_29
2019-06-14 10:28:12,819 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-b58bcdda-f0cf-47c2-806d-984c7da72fef-group-9305B63EF336: set stopIndex = 32
2019-06-14 10:28:12,819 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - b58bcdda-f0cf-47c2-806d-984c7da72fef:group-9305B63EF336 closes. The last applied log index is 32
2019-06-14 10:28:12,819 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - b58bcdda-f0cf-47c2-806d-984c7da72fef:group-F08BE2A1B6FA closes. The last applied log index is 0
2019-06-14 10:28:12,819 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - b58bcdda-f0cf-47c2-806d-984c7da72fef-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:12,821 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - b58bcdda-f0cf-47c2-806d-984c7da72fef-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:12,821 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - b58bcdda-f0cf-47c2-806d-984c7da72fef->d78c9fa1-8140-46fa-98f3-1d025e275fbb: nextIndex: updateUnconditionally 33 -> -1
2019-06-14 10:28:12,822 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - b58bcdda-f0cf-47c2-806d-984c7da72fef-RaftLogWorker close()
2019-06-14 10:28:12,824 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - b58bcdda-f0cf-47c2-806d-984c7da72fef-RaftLogWorker close()
2019-06-14 10:28:12,826 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: shutdown server with port 33479 now
2019-06-14 10:28:12,826 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - b58bcdda-f0cf-47c2-806d-984c7da72fef: shutdown server with port 33479 successfully
2019-06-14 10:28:12,828 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 2-UnorderedRequestStreamObserver2: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:12,830 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:28:12,840 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:28:12,841 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@7b38db21{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:28:12,841 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@54f4734e{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:28:12,841 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@66576bd2{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:28:12,841 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@5e8e02a3{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:28:12,861 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-BBF5D7A1FC53->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-BBF5D7A1FC53->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=92, SUCCESS, logIndex=9, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c9, bd91091a-c280-437f-8263-5f77ae9d5b9a:c8, 75f987be-0e56-498c-a731-9178ff149875:c6]
2019-06-14 10:28:12,878 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-BBF5D7A1FC53->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-BBF5D7A1FC53->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=93, SUCCESS, logIndex=11, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c11, bd91091a-c280-437f-8263-5f77ae9d5b9a:c9, 75f987be-0e56-498c-a731-9178ff149875:c9]
2019-06-14 10:28:12,898 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-BBF5D7A1FC53->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-BBF5D7A1FC53->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=94, SUCCESS, logIndex=12, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c12, bd91091a-c280-437f-8263-5f77ae9d5b9a:c9, 75f987be-0e56-498c-a731-9178ff149875:c9]
2019-06-14 10:28:12,913 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-BBF5D7A1FC53->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-BBF5D7A1FC53->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=95, SUCCESS, logIndex=13, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c14, bd91091a-c280-437f-8263-5f77ae9d5b9a:c11, 75f987be-0e56-498c-a731-9178ff149875:c11]
2019-06-14 10:28:12,921 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-BBF5D7A1FC53->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-BBF5D7A1FC53->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=96, SUCCESS, logIndex=0, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c16, bd91091a-c280-437f-8263-5f77ae9d5b9a:c13, 75f987be-0e56-498c-a731-9178ff149875:c13]
2019-06-14 10:28:13,936 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->d78c9fa1-8140-46fa-98f3-1d025e275fbb: receive RaftClientReply:client-19C8B3D5AD4B->d78c9fa1-8140-46fa-98f3-1d025e275fbb@group-9305B63EF336, cid=97, FAILED org.apache.ratis.protocol.NotLeaderException: Server d78c9fa1-8140-46fa-98f3-1d025e275fbb is not the leader (b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479). Request must be sent to leader., logIndex=0, commits[d78c9fa1-8140-46fa-98f3-1d025e275fbb:c29, b58bcdda-f0cf-47c2-806d-984c7da72fef:c29, 295b690a-12a8-417c-9186-35ca4bb21c45:c26]
2019-06-14 10:28:13,940 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:14,544 INFO  impl.FollowerState (FollowerState.java:run(101)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-9305B63EF336 changes to CANDIDATE, lastRpcTime:1856, electionTimeout:1078ms
2019-06-14 10:28:14,544 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 295b690a-12a8-417c-9186-35ca4bb21c45: shutdown FollowerState
2019-06-14 10:28:14,544 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-9305B63EF336 changes role from FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2019-06-14 10:28:14,544 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 295b690a-12a8-417c-9186-35ca4bb21c45: start LeaderElection
2019-06-14 10:28:14,544 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-9305B63EF336 change Leader from b58bcdda-f0cf-47c2-806d-984c7da72fef to null at term 2 for initElection
2019-06-14 10:28:14,547 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-9305B63EF336:LeaderElection49: begin an election at term 3 for 0: [b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479, d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229, 295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961], old=null
2019-06-14 10:28:14,549 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-9305B63EF336:LeaderElection49 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:33479
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:14,550 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb:group-9305B63EF336 change Leader from b58bcdda-f0cf-47c2-806d-984c7da72fef to null at term 3 for updateCurrentTerm
2019-06-14 10:28:14,552 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb:group-9305B63EF336 changes role from FOLLOWER to FOLLOWER at term 3 for recognizeCandidate:295b690a-12a8-417c-9186-35ca4bb21c45
2019-06-14 10:28:14,552 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: shutdown FollowerState
2019-06-14 10:28:14,552 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: start FollowerState
2019-06-14 10:28:14,552 INFO  impl.FollowerState (FollowerState.java:run(109)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:28:14,555 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-9305B63EF336:LeaderElection49: Election PASSED; received 1 response(s) [295b690a-12a8-417c-9186-35ca4bb21c45->d78c9fa1-8140-46fa-98f3-1d025e275fbb,true-t3] and 1 exception(s); 295b690a-12a8-417c-9186-35ca4bb21c45:t3, leader=null, voted=295b690a-12a8-417c-9186-35ca4bb21c45, raftlog=295b690a-12a8-417c-9186-35ca4bb21c45-SegmentedRaftLog:OPENED:c29,f32,i32, conf=0: [b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479, d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229, 295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961], old=null
2019-06-14 10:28:14,555 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:33479
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:14,555 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: shutdown LeaderElection
2019-06-14 10:28:14,555 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-9305B63EF336 changes role from CANDIDATE to LEADER at term 3 for changeToLeader
2019-06-14 10:28:14,555 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-9305B63EF336 change Leader from null to 295b690a-12a8-417c-9186-35ca4bb21c45 at term 3 for becomeLeader, leader elected after 10ms
2019-06-14 10:28:14,555 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:14,555 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:14,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:14,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:14,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:28:14,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:14,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:28:14,556 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:28:14,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:14,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:14,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:28:14,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:14,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:28:14,556 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:28:14,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:14,557 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:14,557 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 295b690a-12a8-417c-9186-35ca4bb21c45: start LeaderState
2019-06-14 10:28:14,557 INFO  storage.RaftLogWorker (RaftLogWorker.java:rollLogSegment(303)) - 295b690a-12a8-417c-9186-35ca4bb21c45-RaftLogWorker: Rolling segment log-0_32 to index:32
2019-06-14 10:28:14,558 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-9305B63EF336 set configuration 33: [b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479, d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229, 295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961], old=null at 33
2019-06-14 10:28:14,558 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(433)) - 295b690a-12a8-417c-9186-35ca4bb21c45-RaftLogWorker: Rolled log segment from /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-4/data/ratis/502b1cdf-3a57-451f-982e-9305b63ef336/current/log_inprogress_0 to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-4/data/ratis/502b1cdf-3a57-451f-982e-9305b63ef336/current/log_0-32
2019-06-14 10:28:14,559 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:14,559 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb:group-9305B63EF336 change Leader from null to 295b690a-12a8-417c-9186-35ca4bb21c45 at term 3 for appendEntries, leader elected after 9ms
2019-06-14 10:28:14,575 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb:group-9305B63EF336 set configuration 33: [b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479, d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229, 295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961], old=null at 33
2019-06-14 10:28:14,575 INFO  storage.RaftLogWorker (RaftLogWorker.java:rollLogSegment(303)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb-RaftLogWorker: Rolling segment log-0_32 to index:32
2019-06-14 10:28:14,577 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(433)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb-RaftLogWorker: Rolled log segment from /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-3/data/ratis/502b1cdf-3a57-451f-982e-9305b63ef336/current/log_inprogress_0 to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-3/data/ratis/502b1cdf-3a57-451f-982e-9305b63ef336/current/log_0-32
2019-06-14 10:28:14,582 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 33 -> 0
2019-06-14 10:28:14,621 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 295b690a-12a8-417c-9186-35ca4bb21c45-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-4/data/ratis/502b1cdf-3a57-451f-982e-9305b63ef336/current/log_inprogress_33
2019-06-14 10:28:14,622 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:14,624 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-3/data/ratis/502b1cdf-3a57-451f-982e-9305b63ef336/current/log_inprogress_33
2019-06-14 10:28:14,624 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:14,629 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:14,630 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:14,634 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:14,635 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:15,136 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:15,138 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:15,571 INFO  node.StaleNodeHandler (StaleNodeHandler.java:onMessage(58)) - Datanode b58bcdda-f0cf-47c2-806d-984c7da72fef{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null} moved to stale state. Finalizing its pipelines [PipelineID=1ed40399-2416-487f-95f3-f08be2a1b6fa, PipelineID=502b1cdf-3a57-451f-982e-9305b63ef336]
2019-06-14 10:28:15,571 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: 1ed40399-2416-487f-95f3-f08be2a1b6fa, Nodes: b58bcdda-f0cf-47c2-806d-984c7da72fef{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:28:15,571 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 1ed40399-2416-487f-95f3-f08be2a1b6fa, Nodes: b58bcdda-f0cf-47c2-806d-984c7da72fef{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-06-14 10:28:15,572 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: 502b1cdf-3a57-451f-982e-9305b63ef336, Nodes: b58bcdda-f0cf-47c2-806d-984c7da72fef{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}d78c9fa1-8140-46fa-98f3-1d025e275fbb{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}295b690a-12a8-417c-9186-35ca4bb21c45{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-14 10:28:15,572 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 502b1cdf-3a57-451f-982e-9305b63ef336, Nodes: b58bcdda-f0cf-47c2-806d-984c7da72fef{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}d78c9fa1-8140-46fa-98f3-1d025e275fbb{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}295b690a-12a8-417c-9186-35ca4bb21c45{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] moved to CLOSED state
2019-06-14 10:28:15,572 INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #1
2019-06-14 10:28:15,572 INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #2
2019-06-14 10:28:15,573 INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #4
2019-06-14 10:28:15,636 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:15,639 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:15,952 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:15,955 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:15,985 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:16,005 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:16,006 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->295b690a-12a8-417c-9186-35ca4bb21c45: receive RaftClientReply:client-19C8B3D5AD4B->295b690a-12a8-417c-9186-35ca4bb21c45@group-9305B63EF336, cid=97, SUCCESS, logIndex=35, commits[295b690a-12a8-417c-9186-35ca4bb21c45:c35, b58bcdda-f0cf-47c2-806d-984c7da72fef:c29, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c34]
2019-06-14 10:28:16,008 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:16,010 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:16,017 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:16,018 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:16,020 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:16,022 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:16,027 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:16,029 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:16,033 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->295b690a-12a8-417c-9186-35ca4bb21c45: receive RaftClientReply:client-19C8B3D5AD4B->295b690a-12a8-417c-9186-35ca4bb21c45@group-9305B63EF336, cid=98, SUCCESS, logIndex=37, commits[295b690a-12a8-417c-9186-35ca4bb21c45:c38, b58bcdda-f0cf-47c2-806d-984c7da72fef:c29, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c37]
2019-06-14 10:28:16,036 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:16,039 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:16,045 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:16,047 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:16,048 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->295b690a-12a8-417c-9186-35ca4bb21c45: receive RaftClientReply:client-19C8B3D5AD4B->295b690a-12a8-417c-9186-35ca4bb21c45@group-9305B63EF336, cid=99, SUCCESS, logIndex=39, commits[295b690a-12a8-417c-9186-35ca4bb21c45:c39, b58bcdda-f0cf-47c2-806d-984c7da72fef:c29, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c38]
2019-06-14 10:28:16,050 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->295b690a-12a8-417c-9186-35ca4bb21c45: receive RaftClientReply:client-19C8B3D5AD4B->295b690a-12a8-417c-9186-35ca4bb21c45@group-9305B63EF336, cid=100, SUCCESS, logIndex=40, commits[295b690a-12a8-417c-9186-35ca4bb21c45:c41, b58bcdda-f0cf-47c2-806d-984c7da72fef:c29, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c39]
2019-06-14 10:28:16,051 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:16,055 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:16,056 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:16,057 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:16,495 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:16,498 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:16,513 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 1 is closed with bcsId 13.
2019-06-14 10:28:16,518 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:16,520 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:16,523 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:16,524 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:16,527 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:16,529 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 1 is closed with bcsId 13.
2019-06-14 10:28:16,529 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:16,533 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:16,535 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:16,538 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 2 is closed with bcsId 29.
2019-06-14 10:28:16,542 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:16,560 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 2 is closed with bcsId 29.
2019-06-14 10:28:16,561 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:16,566 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:16,573 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:16,574 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 4 is closed with bcsId 40.
2019-06-14 10:28:16,575 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:16,577 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:16,593 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 4 is closed with bcsId 40.
2019-06-14 10:28:17,075 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:17,077 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:17,576 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:17,577 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:18,076 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:18,078 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:18,577 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:18,583 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:19,077 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:19,077 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:19,579 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:19,579 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:20,079 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:20,079 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:20,580 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:20,580 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:21,051 WARN  scm.XceiverClientRatis (XceiverClientRatis.java:watchForCommit(260)) - 3 way commit failed 
java.util.concurrent.TimeoutException
	at java.util.concurrent.CompletableFuture.timedGet(CompletableFuture.java:1771)
	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1915)
	at org.apache.hadoop.hdds.scm.XceiverClientRatis.watchForCommit(XceiverClientRatis.java:257)
	at org.apache.hadoop.hdds.scm.storage.CommitWatcher.watchForCommit(CommitWatcher.java:194)
	at org.apache.hadoop.hdds.scm.storage.CommitWatcher.watchOnFirstIndex(CommitWatcher.java:135)
	at org.apache.hadoop.hdds.scm.storage.BlockOutputStream.watchForCommit(BlockOutputStream.java:355)
	at org.apache.hadoop.hdds.scm.storage.BlockOutputStream.handleFullBuffer(BlockOutputStream.java:332)
	at org.apache.hadoop.hdds.scm.storage.BlockOutputStream.write(BlockOutputStream.java:259)
	at org.apache.hadoop.ozone.client.io.BlockOutputStreamEntry.write(BlockOutputStreamEntry.java:129)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleWrite(KeyOutputStream.java:211)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.write(KeyOutputStream.java:193)
	at org.apache.hadoop.ozone.client.io.OzoneOutputStream.write(OzoneOutputStream.java:49)
	at java.io.OutputStream.write(OutputStream.java:75)
	at org.apache.hadoop.ozone.client.rpc.TestFailureHandlingByClient.testMultiBlockWritesWithIntermittentDnFailures(TestFailureHandlingByClient.java:237)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2019-06-14 10:28:21,057 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->295b690a-12a8-417c-9186-35ca4bb21c45: receive RaftClientReply:client-19C8B3D5AD4B->295b690a-12a8-417c-9186-35ca4bb21c45@group-9305B63EF336, cid=102, SUCCESS, logIndex=0, commits[295b690a-12a8-417c-9186-35ca4bb21c45:c48, b58bcdda-f0cf-47c2-806d-984c7da72fef:c29, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c48]
2019-06-14 10:28:21,058 INFO  scm.XceiverClientRatis (XceiverClientRatis.java:lambda$watchForCommit$7(278)) - Could not commit 37 to all the nodes. Server b58bcdda-f0cf-47c2-806d-984c7da72fef has failed. Committed by majority.
2019-06-14 10:28:21,081 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:21,081 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:21,581 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:21,581 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:22,081 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:22,082 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:22,582 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:22,582 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:23,082 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:23,082 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:23,583 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:23,583 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:24,083 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:24,083 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:24,584 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:24,584 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:25,090 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:25,091 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:25,091 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->d78c9fa1-8140-46fa-98f3-1d025e275fbb: receive RaftClientReply:client-19C8B3D5AD4B->d78c9fa1-8140-46fa-98f3-1d025e275fbb@group-9305B63EF336, cid=103, FAILED org.apache.ratis.protocol.NotLeaderException: Server d78c9fa1-8140-46fa-98f3-1d025e275fbb is not the leader (295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961). Request must be sent to leader., logIndex=0, commits[d78c9fa1-8140-46fa-98f3-1d025e275fbb:c48, b58bcdda-f0cf-47c2-806d-984c7da72fef:c29, 295b690a-12a8-417c-9186-35ca4bb21c45:c48]
2019-06-14 10:28:25,091 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-19C8B3D5AD4B->d78c9fa1-8140-46fa-98f3-1d025e275fbb@group-9305B63EF336, cid=101, seq=0, Watch-ALL_COMMITTED(37), Message:<EMPTY>, reply=RaftClientReply:client-19C8B3D5AD4B->d78c9fa1-8140-46fa-98f3-1d025e275fbb@group-9305B63EF336, cid=101, FAILED org.apache.ratis.protocol.NotLeaderException: Server d78c9fa1-8140-46fa-98f3-1d025e275fbb is not the leader (295b690a-12a8-417c-9186-35ca4bb21c45:192.168.46.40:32961). Request must be sent to leader., logIndex=0, commits[d78c9fa1-8140-46fa-98f3-1d025e275fbb:c48, b58bcdda-f0cf-47c2-806d-984c7da72fef:c29, 295b690a-12a8-417c-9186-35ca4bb21c45:c48]
2019-06-14 10:28:25,101 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 2-OrderedRequestStreamObserver2: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:25,585 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:25,585 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:26,085 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:26,086 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:26,586 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:26,586 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:26,682 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-19C8B3D5AD4B->295b690a-12a8-417c-9186-35ca4bb21c45@group-9305B63EF336, cid=101, seq=0, Watch-ALL_COMMITTED(37), Message:<EMPTY>, reply=RaftClientReply:client-19C8B3D5AD4B->295b690a-12a8-417c-9186-35ca4bb21c45@group-9305B63EF336, cid=101, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 101 and log index 37 is not yet replicated to ALL_COMMITTED, logIndex=37, commits[295b690a-12a8-417c-9186-35ca4bb21c45:c48, b58bcdda-f0cf-47c2-806d-984c7da72fef:c29, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c48]
2019-06-14 10:28:27,086 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:27,086 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
10:28:27.124 [grpc-default-executor-3] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 4 locID: 102269458128306189 bcsId: 40} | ret=FAILURE
org.apache.hadoop.hdds.scm.container.common.helpers.ContainerNotOpenException: Container 4 in CLOSED state
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.validateContainerCommand(HddsDispatcher.java:408) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.startTransaction(ContainerStateMachine.java:269) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.ratis.server.impl.RaftServerImpl.submitClientRequestAsync(RaftServerImpl.java:550) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$submitClientRequestAsync$7(RaftServerProxy.java:333) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$5(RaftServerProxy.java:328) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:109) ~[ratis-common-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$submitRequest$6(RaftServerProxy.java:328) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:981) ~[?:1.8.0_212]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2124) ~[?:1.8.0_212]
	at org.apache.ratis.server.impl.RaftServerProxy.submitRequest(RaftServerProxy.java:327) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.submitClientRequestAsync(RaftServerProxy.java:333) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:206) ~[ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$OrderedRequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:306) ~[ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.util.SlidingWindow$Server.processRequestsFromHead(SlidingWindow.java:399) [ratis-common-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.util.SlidingWindow$Server.receivedRequest(SlidingWindow.java:391) [ratis-common-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$OrderedRequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:312) [ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.onNext(GrpcClientProtocolService.java:226) [ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.onNext(GrpcClientProtocolService.java:154) [ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:248) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:263) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:686) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-06-14 10:28:27,133 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->295b690a-12a8-417c-9186-35ca4bb21c45: receive RaftClientReply:client-19C8B3D5AD4B->295b690a-12a8-417c-9186-35ca4bb21c45@group-9305B63EF336, cid=103, FAILED org.apache.ratis.protocol.StateMachineException: org.apache.hadoop.hdds.scm.container.common.helpers.ContainerNotOpenException from Server 295b690a-12a8-417c-9186-35ca4bb21c45: Container 4 in CLOSED state, logIndex=0, commits[295b690a-12a8-417c-9186-35ca4bb21c45:c48, b58bcdda-f0cf-47c2-806d-984c7da72fef:c29, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c48]
10:28:27.137 [grpc-default-executor-0] ERROR DNAudit - user=null | ip=null | op=PUT_BLOCK {blockData=[blockId=conID: 4 locID: 102269458128306189 bcsId: 0,size=3145728]} | ret=FAILURE
org.apache.hadoop.hdds.scm.container.common.helpers.ContainerNotOpenException: Container 4 in CLOSED state
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.validateContainerCommand(HddsDispatcher.java:408) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.startTransaction(ContainerStateMachine.java:269) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.ratis.server.impl.RaftServerImpl.submitClientRequestAsync(RaftServerImpl.java:550) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$submitClientRequestAsync$7(RaftServerProxy.java:333) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$5(RaftServerProxy.java:328) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:109) ~[ratis-common-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$submitRequest$6(RaftServerProxy.java:328) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:981) ~[?:1.8.0_212]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2124) ~[?:1.8.0_212]
	at org.apache.ratis.server.impl.RaftServerProxy.submitRequest(RaftServerProxy.java:327) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.submitClientRequestAsync(RaftServerProxy.java:333) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:206) ~[ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$OrderedRequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:306) ~[ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.util.SlidingWindow$Server.processRequestsFromHead(SlidingWindow.java:399) [ratis-common-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.util.SlidingWindow$Server.receivedRequest(SlidingWindow.java:391) [ratis-common-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$OrderedRequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:312) [ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.onNext(GrpcClientProtocolService.java:226) [ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.onNext(GrpcClientProtocolService.java:154) [ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:248) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:263) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:686) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-06-14 10:28:27,142 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-19C8B3D5AD4B->295b690a-12a8-417c-9186-35ca4bb21c45: receive RaftClientReply:client-19C8B3D5AD4B->295b690a-12a8-417c-9186-35ca4bb21c45@group-9305B63EF336, cid=104, FAILED org.apache.ratis.protocol.StateMachineException: org.apache.hadoop.hdds.scm.container.common.helpers.ContainerNotOpenException from Server 295b690a-12a8-417c-9186-35ca4bb21c45: Container 4 in CLOSED state, logIndex=0, commits[295b690a-12a8-417c-9186-35ca4bb21c45:c48, b58bcdda-f0cf-47c2-806d-984c7da72fef:c29, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c48]
2019-06-14 10:28:27,156 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-UnorderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:27,205 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=105, SUCCESS, logIndex=17, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c17, bd91091a-c280-437f-8263-5f77ae9d5b9a:c16, 75f987be-0e56-498c-a731-9178ff149875:c16]
2019-06-14 10:28:27,237 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=106, SUCCESS, logIndex=19, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c20, bd91091a-c280-437f-8263-5f77ae9d5b9a:c19, 75f987be-0e56-498c-a731-9178ff149875:c19]
2019-06-14 10:28:27,319 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=107, SUCCESS, logIndex=21, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c21, bd91091a-c280-437f-8263-5f77ae9d5b9a:c19, 75f987be-0e56-498c-a731-9178ff149875:c20]
2019-06-14 10:28:27,321 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=108, SUCCESS, logIndex=22, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c22, bd91091a-c280-437f-8263-5f77ae9d5b9a:c20, 75f987be-0e56-498c-a731-9178ff149875:c20]
2019-06-14 10:28:27,322 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:28:27,322 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@1f235a0a
2019-06-14 10:28:27,322 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:28:27,323 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:28:27,323 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: close
2019-06-14 10:28:27,324 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: shutdown group-1D0420C8326B
2019-06-14 10:28:27,324 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-1D0420C8326B,id=d78c9fa1-8140-46fa-98f3-1d025e275fbb
2019-06-14 10:28:27,324 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: shutdown LeaderState
2019-06-14 10:28:27,324 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb-PendingRequests: sendNotLeaderResponses
2019-06-14 10:28:27,330 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: shutdown group-9305B63EF336
2019-06-14 10:28:27,331 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-9305B63EF336,id=d78c9fa1-8140-46fa-98f3-1d025e275fbb
2019-06-14 10:28:27,331 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: shutdown FollowerState
2019-06-14 10:28:27,331 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-d78c9fa1-8140-46fa-98f3-1d025e275fbb-group-9305B63EF336: set stopIndex = 48
2019-06-14 10:28:27,331 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:3, i:47)
2019-06-14 10:28:27,333 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-d78c9fa1-8140-46fa-98f3-1d025e275fbb-group-1D0420C8326B: set stopIndex = 0
2019-06-14 10:28:27,331 INFO  impl.FollowerState (FollowerState.java:run(109)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:28:27,333 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-3/data/ratis/502b1cdf-3a57-451f-982e-9305b63ef336/sm/snapshot.3_47
2019-06-14 10:28:27,333 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:28:27,334 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb:group-9305B63EF336 closes. The last applied log index is 48
2019-06-14 10:28:27,335 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb:group-1D0420C8326B closes. The last applied log index is 0
2019-06-14 10:28:27,336 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:27,336 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb-RaftLogWorker close()
2019-06-14 10:28:27,338 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb-RaftLogWorker close()
2019-06-14 10:28:27,339 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: shutdown server with port 44229 now
2019-06-14 10:28:27,340 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: shutdown server with port 44229 successfully
2019-06-14 10:28:27,341 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - d78c9fa1-8140-46fa-98f3-1d025e275fbb: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:27,341 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-14 10:28:27,341 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->d78c9fa1-8140-46fa-98f3-1d025e275fbb: nextIndex: updateUnconditionally 49 -> 0
2019-06-14 10:28:27,342 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:28:27,354 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:28:27,354 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@1c25deb0{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:28:27,355 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@1be12e05{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:28:27,355 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@575fe6da{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:28:27,355 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@1b30b6f8{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:28:27,399 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=109, SUCCESS, logIndex=25, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c25, bd91091a-c280-437f-8263-5f77ae9d5b9a:c24, 75f987be-0e56-498c-a731-9178ff149875:c24]
2019-06-14 10:28:27,403 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=110, SUCCESS, logIndex=27, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c27, bd91091a-c280-437f-8263-5f77ae9d5b9a:c25, 75f987be-0e56-498c-a731-9178ff149875:c25]
2019-06-14 10:28:27,421 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=111, SUCCESS, logIndex=29, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c29, bd91091a-c280-437f-8263-5f77ae9d5b9a:c27, 75f987be-0e56-498c-a731-9178ff149875:c28]
2019-06-14 10:28:27,434 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=112, SUCCESS, logIndex=31, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c31, bd91091a-c280-437f-8263-5f77ae9d5b9a:c29, 75f987be-0e56-498c-a731-9178ff149875:c29]
2019-06-14 10:28:27,444 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=113, SUCCESS, logIndex=0, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c32, bd91091a-c280-437f-8263-5f77ae9d5b9a:c31, 75f987be-0e56-498c-a731-9178ff149875:c31]
2019-06-14 10:28:27,587 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:27,587 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:27,626 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:27,626 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->d78c9fa1-8140-46fa-98f3-1d025e275fbb: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:28,087 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:28,087 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:28,126 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:28,126 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->d78c9fa1-8140-46fa-98f3-1d025e275fbb: nextIndex: updateUnconditionally 0 -> 0
10:28:28.462 [grpc-default-executor-0] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 1 locID: 102269458128371727 bcsId: 0} | ret=FAILURE
org.apache.hadoop.hdds.scm.container.common.helpers.ContainerNotOpenException: Container 1 in CLOSED state
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.validateContainerCommand(HddsDispatcher.java:408) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.startTransaction(ContainerStateMachine.java:269) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.ratis.server.impl.RaftServerImpl.submitClientRequestAsync(RaftServerImpl.java:550) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$submitClientRequestAsync$7(RaftServerProxy.java:333) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$5(RaftServerProxy.java:328) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:109) ~[ratis-common-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$submitRequest$6(RaftServerProxy.java:328) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:981) ~[?:1.8.0_212]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2124) ~[?:1.8.0_212]
	at org.apache.ratis.server.impl.RaftServerProxy.submitRequest(RaftServerProxy.java:327) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.submitClientRequestAsync(RaftServerProxy.java:333) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:206) ~[ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$OrderedRequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:306) ~[ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.util.SlidingWindow$Server.processRequestsFromHead(SlidingWindow.java:399) [ratis-common-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.util.SlidingWindow$Server.receivedRequest(SlidingWindow.java:391) [ratis-common-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$OrderedRequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:312) [ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.onNext(GrpcClientProtocolService.java:226) [ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.onNext(GrpcClientProtocolService.java:154) [ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:248) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:263) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:686) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-06-14 10:28:28,469 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8B571733D133->295b690a-12a8-417c-9186-35ca4bb21c45: receive RaftClientReply:client-8B571733D133->295b690a-12a8-417c-9186-35ca4bb21c45@group-9305B63EF336, cid=114, FAILED org.apache.ratis.protocol.StateMachineException: org.apache.hadoop.hdds.scm.container.common.helpers.ContainerNotOpenException from Server 295b690a-12a8-417c-9186-35ca4bb21c45: Container 1 in CLOSED state, logIndex=0, commits[295b690a-12a8-417c-9186-35ca4bb21c45:c48, b58bcdda-f0cf-47c2-806d-984c7da72fef:c29, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c48]
10:28:28.478 [grpc-default-executor-4] ERROR DNAudit - user=null | ip=null | op=PUT_BLOCK {blockData=[blockId=conID: 1 locID: 102269458128371727 bcsId: 0,size=1048576]} | ret=FAILURE
org.apache.hadoop.hdds.scm.container.common.helpers.ContainerNotOpenException: Container 1 in CLOSED state
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.validateContainerCommand(HddsDispatcher.java:408) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.startTransaction(ContainerStateMachine.java:269) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.ratis.server.impl.RaftServerImpl.submitClientRequestAsync(RaftServerImpl.java:550) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$submitClientRequestAsync$7(RaftServerProxy.java:333) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$5(RaftServerProxy.java:328) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:109) ~[ratis-common-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$submitRequest$6(RaftServerProxy.java:328) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:981) ~[?:1.8.0_212]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2124) ~[?:1.8.0_212]
	at org.apache.ratis.server.impl.RaftServerProxy.submitRequest(RaftServerProxy.java:327) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.submitClientRequestAsync(RaftServerProxy.java:333) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:206) ~[ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$OrderedRequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:306) ~[ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.util.SlidingWindow$Server.processRequestsFromHead(SlidingWindow.java:399) [ratis-common-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.util.SlidingWindow$Server.receivedRequest(SlidingWindow.java:391) [ratis-common-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$OrderedRequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:312) [ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.onNext(GrpcClientProtocolService.java:226) [ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.onNext(GrpcClientProtocolService.java:154) [ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:248) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:263) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:686) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
10:28:28.487 [grpc-default-executor-4] ERROR DNAudit - user=null | ip=null | op=WRITE_CHUNK {blockData=conID: 1 locID: 102269458128371727 bcsId: 0} | ret=FAILURE
org.apache.hadoop.hdds.scm.container.common.helpers.ContainerNotOpenException: Container 1 in CLOSED state
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.validateContainerCommand(HddsDispatcher.java:408) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.startTransaction(ContainerStateMachine.java:269) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.ratis.server.impl.RaftServerImpl.submitClientRequestAsync(RaftServerImpl.java:550) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$submitClientRequestAsync$7(RaftServerProxy.java:333) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$5(RaftServerProxy.java:328) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:109) ~[ratis-common-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$submitRequest$6(RaftServerProxy.java:328) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:981) ~[?:1.8.0_212]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2124) ~[?:1.8.0_212]
	at org.apache.ratis.server.impl.RaftServerProxy.submitRequest(RaftServerProxy.java:327) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.submitClientRequestAsync(RaftServerProxy.java:333) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:206) ~[ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$OrderedRequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:306) ~[ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.util.SlidingWindow$Server.processRequestsFromHead(SlidingWindow.java:399) [ratis-common-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.util.SlidingWindow$Server.receivedRequest(SlidingWindow.java:391) [ratis-common-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$OrderedRequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:312) [ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.onNext(GrpcClientProtocolService.java:226) [ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.onNext(GrpcClientProtocolService.java:154) [ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.thirdparty.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:248) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:263) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:686) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at org.apache.ratis.thirdparty.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:123) [ratis-thirdparty-misc-0.2.0.jar:0.2.0]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-06-14 10:28:28,488 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8B571733D133->295b690a-12a8-417c-9186-35ca4bb21c45: receive RaftClientReply:client-8B571733D133->295b690a-12a8-417c-9186-35ca4bb21c45@group-9305B63EF336, cid=115, FAILED org.apache.ratis.protocol.StateMachineException: org.apache.hadoop.hdds.scm.container.common.helpers.ContainerNotOpenException from Server 295b690a-12a8-417c-9186-35ca4bb21c45: Container 1 in CLOSED state, logIndex=0, commits[295b690a-12a8-417c-9186-35ca4bb21c45:c48, b58bcdda-f0cf-47c2-806d-984c7da72fef:c29, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c48]
10:28:28.492 [Thread-1897] ERROR DNAudit - user=null | ip=null | op=PUT_BLOCK {blockData=[blockId=conID: 1 locID: 102269458128371727 bcsId: 0,size=2097152]} | ret=FAILURE
org.apache.hadoop.hdds.scm.container.common.helpers.ContainerNotOpenException: Container 1 in CLOSED state
	at org.apache.hadoop.ozone.container.common.impl.HddsDispatcher.validateContainerCommand(HddsDispatcher.java:408) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.container.common.transport.server.ratis.ContainerStateMachine.startTransaction(ContainerStateMachine.java:269) ~[hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar:?]
	at org.apache.ratis.server.impl.RaftServerImpl.submitClientRequestAsync(RaftServerImpl.java:550) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$submitClientRequestAsync$7(RaftServerProxy.java:333) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$null$5(RaftServerProxy.java:328) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.util.JavaUtils.callAsUnchecked(JavaUtils.java:109) ~[ratis-common-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.lambda$submitRequest$6(RaftServerProxy.java:328) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at java.util.concurrent.CompletableFuture.uniComposeStage(CompletableFuture.java:981) ~[?:1.8.0_212]
	at java.util.concurrent.CompletableFuture.thenCompose(CompletableFuture.java:2124) ~[?:1.8.0_212]
	at org.apache.ratis.server.impl.RaftServerProxy.submitRequest(RaftServerProxy.java:327) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.server.impl.RaftServerProxy.submitClientRequestAsync(RaftServerProxy.java:333) ~[ratis-server-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$RequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:206) ~[ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$OrderedRequestStreamObserver.processClientRequest(GrpcClientProtocolService.java:306) ~[ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.util.SlidingWindow$Server.processRequestsFromHead(SlidingWindow.java:399) ~[ratis-common-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.util.SlidingWindow$Server.receiveReply(SlidingWindow.java:414) ~[ratis-common-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at org.apache.ratis.grpc.client.GrpcClientProtocolService$OrderedRequestStreamObserver.lambda$processClientRequest$0(GrpcClientProtocolService.java:307) ~[ratis-grpc-0.4.0-fe2b15d-SNAPSHOT.jar:0.4.0-fe2b15d-SNAPSHOT]
	at java.util.concurrent.CompletableFuture.uniAccept(CompletableFuture.java:656) [?:1.8.0_212]
	at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:632) [?:1.8.0_212]
	at java.util.concurrent.CompletableFuture$Completion.run(CompletableFuture.java:442) [?:1.8.0_212]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_212]
2019-06-14 10:28:28,492 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8B571733D133->295b690a-12a8-417c-9186-35ca4bb21c45: receive RaftClientReply:client-8B571733D133->295b690a-12a8-417c-9186-35ca4bb21c45@group-9305B63EF336, cid=116, FAILED org.apache.ratis.protocol.StateMachineException: org.apache.hadoop.hdds.scm.container.common.helpers.ContainerNotOpenException from Server 295b690a-12a8-417c-9186-35ca4bb21c45: Container 1 in CLOSED state, logIndex=0, commits[295b690a-12a8-417c-9186-35ca4bb21c45:c48, b58bcdda-f0cf-47c2-806d-984c7da72fef:c29, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c48]
2019-06-14 10:28:28,504 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8B571733D133->295b690a-12a8-417c-9186-35ca4bb21c45: receive RaftClientReply:client-8B571733D133->295b690a-12a8-417c-9186-35ca4bb21c45@group-9305B63EF336, cid=117, FAILED org.apache.ratis.protocol.StateMachineException: org.apache.hadoop.hdds.scm.container.common.helpers.ContainerNotOpenException from Server 295b690a-12a8-417c-9186-35ca4bb21c45: Container 1 in CLOSED state, logIndex=0, commits[295b690a-12a8-417c-9186-35ca4bb21c45:c48, b58bcdda-f0cf-47c2-806d-984c7da72fef:c29, d78c9fa1-8140-46fa-98f3-1d025e275fbb:c48]
2019-06-14 10:28:28,591 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:28,591 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:28,625 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=118, SUCCESS, logIndex=33, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c33, bd91091a-c280-437f-8263-5f77ae9d5b9a:c32, 75f987be-0e56-498c-a731-9178ff149875:c32]
2019-06-14 10:28:28,631 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:28,631 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->d78c9fa1-8140-46fa-98f3-1d025e275fbb: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:28,647 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=119, SUCCESS, logIndex=35, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c40, bd91091a-c280-437f-8263-5f77ae9d5b9a:c37, 75f987be-0e56-498c-a731-9178ff149875:c37]
2019-06-14 10:28:28,648 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=120, SUCCESS, logIndex=36, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c40, bd91091a-c280-437f-8263-5f77ae9d5b9a:c37, 75f987be-0e56-498c-a731-9178ff149875:c37]
2019-06-14 10:28:28,669 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=121, SUCCESS, logIndex=37, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c40, bd91091a-c280-437f-8263-5f77ae9d5b9a:c37, 75f987be-0e56-498c-a731-9178ff149875:c37]
2019-06-14 10:28:28,683 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=122, SUCCESS, logIndex=41, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c41, bd91091a-c280-437f-8263-5f77ae9d5b9a:c40, 75f987be-0e56-498c-a731-9178ff149875:c40]
2019-06-14 10:28:28,702 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=123, SUCCESS, logIndex=43, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c43, bd91091a-c280-437f-8263-5f77ae9d5b9a:c41, 75f987be-0e56-498c-a731-9178ff149875:c41]
2019-06-14 10:28:28,703 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106: receive RaftClientReply:client-3381C2C44539->b9c49b19-09c2-4188-a006-d6759c13b106@group-8D72E19EE80D, cid=124, SUCCESS, logIndex=0, commits[b9c49b19-09c2-4188-a006-d6759c13b106:c44, bd91091a-c280-437f-8263-5f77ae9d5b9a:c43, 75f987be-0e56-498c-a731-9178ff149875:c43]
2019-06-14 10:28:29,213 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:29,214 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->d78c9fa1-8140-46fa-98f3-1d025e275fbb: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:29,219 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:29,219 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
Jun 14, 2019 10:28:29 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=547, target=192.168.46.40:42937} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connectToDatanode(XceiverClientGrpc.java:163)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.reconnect(XceiverClientGrpc.java:398)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommandAsync(XceiverClientGrpc.java:349)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommandWithRetry(XceiverClientGrpc.java:262)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommandWithTraceIDAndRetry(XceiverClientGrpc.java:239)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommand(XceiverClientGrpc.java:222)
	at org.apache.hadoop.hdds.scm.storage.ContainerProtocolCalls.getBlock(ContainerProtocolCalls.java:118)
	at org.apache.hadoop.hdds.scm.storage.BlockInputStream.getChunkInfos(BlockInputStream.java:167)
	at org.apache.hadoop.hdds.scm.storage.BlockInputStream.initialize(BlockInputStream.java:118)
	at org.apache.hadoop.hdds.scm.storage.BlockInputStream.read(BlockInputStream.java:222)
	at org.apache.hadoop.ozone.client.io.KeyInputStream.read(KeyInputStream.java:171)
	at org.apache.hadoop.ozone.client.io.OzoneInputStream.read(OzoneInputStream.java:47)
	at java.io.InputStream.read(InputStream.java:101)
	at org.apache.hadoop.ozone.container.ContainerTestHelper.validateData(ContainerTestHelper.java:709)
	at org.apache.hadoop.ozone.client.rpc.TestFailureHandlingByClient.validateData(TestFailureHandlingByClient.java:497)
	at org.apache.hadoop.ozone.client.rpc.TestFailureHandlingByClient.testWriteSmallFile(TestFailureHandlingByClient.java:297)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 14, 2019 10:28:29 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=219, target=192.168.46.40:39377} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connectToDatanode(XceiverClientGrpc.java:163)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.reconnect(XceiverClientGrpc.java:398)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommandAsync(XceiverClientGrpc.java:349)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommandWithRetry(XceiverClientGrpc.java:262)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommandWithTraceIDAndRetry(XceiverClientGrpc.java:239)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommand(XceiverClientGrpc.java:222)
	at org.apache.hadoop.hdds.scm.storage.ContainerProtocolCalls.getBlock(ContainerProtocolCalls.java:118)
	at org.apache.hadoop.hdds.scm.storage.BlockInputStream.getChunkInfos(BlockInputStream.java:167)
	at org.apache.hadoop.hdds.scm.storage.BlockInputStream.initialize(BlockInputStream.java:118)
	at org.apache.hadoop.hdds.scm.storage.BlockInputStream.read(BlockInputStream.java:222)
	at org.apache.hadoop.ozone.client.io.KeyInputStream.read(KeyInputStream.java:171)
	at org.apache.hadoop.ozone.client.io.OzoneInputStream.read(OzoneInputStream.java:47)
	at java.io.InputStream.read(InputStream.java:101)
	at org.apache.hadoop.ozone.container.ContainerTestHelper.validateData(ContainerTestHelper.java:709)
	at org.apache.hadoop.ozone.client.rpc.TestFailureHandlingByClient.validateData(TestFailureHandlingByClient.java:497)
	at org.apache.hadoop.ozone.client.rpc.TestFailureHandlingByClient.testPipelineExclusionWithPipelineFailure(TestFailureHandlingByClient.java:485)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 14, 2019 10:28:29 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=552, target=192.168.46.40:34991} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connectToDatanode(XceiverClientGrpc.java:163)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.reconnect(XceiverClientGrpc.java:398)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommandAsync(XceiverClientGrpc.java:349)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommandWithRetry(XceiverClientGrpc.java:262)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommandWithTraceIDAndRetry(XceiverClientGrpc.java:239)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommand(XceiverClientGrpc.java:222)
	at org.apache.hadoop.hdds.scm.storage.ContainerProtocolCalls.getBlock(ContainerProtocolCalls.java:118)
	at org.apache.hadoop.hdds.scm.storage.BlockInputStream.getChunkInfos(BlockInputStream.java:167)
	at org.apache.hadoop.hdds.scm.storage.BlockInputStream.initialize(BlockInputStream.java:118)
	at org.apache.hadoop.hdds.scm.storage.BlockInputStream.read(BlockInputStream.java:222)
	at org.apache.hadoop.ozone.client.io.KeyInputStream.read(KeyInputStream.java:171)
	at org.apache.hadoop.ozone.client.io.OzoneInputStream.read(OzoneInputStream.java:47)
	at java.io.InputStream.read(InputStream.java:101)
	at org.apache.hadoop.ozone.container.ContainerTestHelper.validateData(ContainerTestHelper.java:709)
	at org.apache.hadoop.ozone.client.rpc.TestFailureHandlingByClient.validateData(TestFailureHandlingByClient.java:497)
	at org.apache.hadoop.ozone.client.rpc.TestFailureHandlingByClient.testWriteSmallFile(TestFailureHandlingByClient.java:297)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 14, 2019 10:28:29 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=206, target=192.168.46.40:37999} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsync(GrpcClientRpc.java:66)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequestAsync(RaftClientImpl.java:351)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequestWithRetryAsync(RaftClientImpl.java:313)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:251)
	at org.apache.ratis.util.SlidingWindow$Client.submitNewRequest(SlidingWindow.java:230)
	at org.apache.ratis.client.impl.RaftClientImpl.sendAsync(RaftClientImpl.java:207)
	at org.apache.ratis.client.impl.RaftClientImpl.sendAsync(RaftClientImpl.java:174)
	at org.apache.hadoop.hdds.scm.XceiverClientRatis.sendRequestAsync(XceiverClientRatis.java:222)
	at org.apache.hadoop.hdds.scm.XceiverClientRatis.sendCommandAsync(XceiverClientRatis.java:299)
	at org.apache.hadoop.hdds.scm.storage.ContainerProtocolCalls.writeChunkAsync(ContainerProtocolCalls.java:310)
	at org.apache.hadoop.hdds.scm.storage.BlockOutputStream.writeChunkToContainer(BlockOutputStream.java:609)
	at org.apache.hadoop.hdds.scm.storage.BlockOutputStream.writeChunk(BlockOutputStream.java:466)
	at org.apache.hadoop.hdds.scm.storage.BlockOutputStream.writeOnRetry(BlockOutputStream.java:293)
	at org.apache.hadoop.ozone.client.io.BlockOutputStreamEntry.writeOnRetry(BlockOutputStreamEntry.java:200)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleWrite(KeyOutputStream.java:209)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleRetry(KeyOutputStream.java:376)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleException(KeyOutputStream.java:325)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleWrite(KeyOutputStream.java:231)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.write(KeyOutputStream.java:193)
	at org.apache.hadoop.ozone.client.io.OzoneOutputStream.write(OzoneOutputStream.java:49)
	at java.io.OutputStream.write(OutputStream.java:75)
	at org.apache.hadoop.ozone.client.rpc.TestFailureHandlingByClient.testPipelineExclusionWithPipelineFailure(TestFailureHandlingByClient.java:462)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 14, 2019 10:28:29 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=224, target=192.168.46.40:34031} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connectToDatanode(XceiverClientGrpc.java:163)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.reconnect(XceiverClientGrpc.java:398)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommandAsync(XceiverClientGrpc.java:349)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommandWithRetry(XceiverClientGrpc.java:262)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommandWithTraceIDAndRetry(XceiverClientGrpc.java:239)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommand(XceiverClientGrpc.java:222)
	at org.apache.hadoop.hdds.scm.storage.ContainerProtocolCalls.getBlock(ContainerProtocolCalls.java:118)
	at org.apache.hadoop.hdds.scm.storage.BlockInputStream.getChunkInfos(BlockInputStream.java:167)
	at org.apache.hadoop.hdds.scm.storage.BlockInputStream.initialize(BlockInputStream.java:118)
	at org.apache.hadoop.hdds.scm.storage.BlockInputStream.read(BlockInputStream.java:222)
	at org.apache.hadoop.ozone.client.io.KeyInputStream.read(KeyInputStream.java:171)
	at org.apache.hadoop.ozone.client.io.OzoneInputStream.read(OzoneInputStream.java:47)
	at java.io.InputStream.read(InputStream.java:101)
	at org.apache.hadoop.ozone.container.ContainerTestHelper.validateData(ContainerTestHelper.java:709)
	at org.apache.hadoop.ozone.client.rpc.TestFailureHandlingByClient.validateData(TestFailureHandlingByClient.java:497)
	at org.apache.hadoop.ozone.client.rpc.TestFailureHandlingByClient.testPipelineExclusionWithPipelineFailure(TestFailureHandlingByClient.java:485)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 14, 2019 10:28:29 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=211, target=192.168.46.40:39619} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connectToDatanode(XceiverClientGrpc.java:163)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.reconnect(XceiverClientGrpc.java:398)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommandAsync(XceiverClientGrpc.java:349)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommandWithRetry(XceiverClientGrpc.java:262)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommandWithTraceIDAndRetry(XceiverClientGrpc.java:239)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommand(XceiverClientGrpc.java:222)
	at org.apache.hadoop.hdds.scm.storage.ContainerProtocolCalls.getBlock(ContainerProtocolCalls.java:118)
	at org.apache.hadoop.hdds.scm.storage.BlockInputStream.getChunkInfos(BlockInputStream.java:167)
	at org.apache.hadoop.hdds.scm.storage.BlockInputStream.initialize(BlockInputStream.java:118)
	at org.apache.hadoop.hdds.scm.storage.BlockInputStream.read(BlockInputStream.java:222)
	at org.apache.hadoop.ozone.client.io.KeyInputStream.read(KeyInputStream.java:171)
	at org.apache.hadoop.ozone.client.io.OzoneInputStream.read(OzoneInputStream.java:47)
	at java.io.InputStream.read(InputStream.java:101)
	at org.apache.hadoop.ozone.container.ContainerTestHelper.validateData(ContainerTestHelper.java:709)
	at org.apache.hadoop.ozone.client.rpc.TestFailureHandlingByClient.validateData(TestFailureHandlingByClient.java:497)
	at org.apache.hadoop.ozone.client.rpc.TestFailureHandlingByClient.testPipelineExclusionWithPipelineFailure(TestFailureHandlingByClient.java:485)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 14, 2019 10:28:29 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=215, target=192.168.46.40:40865} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connectToDatanode(XceiverClientGrpc.java:163)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.reconnect(XceiverClientGrpc.java:398)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommandAsync(XceiverClientGrpc.java:349)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommandWithRetry(XceiverClientGrpc.java:262)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommandWithTraceIDAndRetry(XceiverClientGrpc.java:239)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.sendCommand(XceiverClientGrpc.java:222)
	at org.apache.hadoop.hdds.scm.storage.ContainerProtocolCalls.getBlock(ContainerProtocolCalls.java:118)
	at org.apache.hadoop.hdds.scm.storage.BlockInputStream.getChunkInfos(BlockInputStream.java:167)
	at org.apache.hadoop.hdds.scm.storage.BlockInputStream.initialize(BlockInputStream.java:118)
	at org.apache.hadoop.hdds.scm.storage.BlockInputStream.read(BlockInputStream.java:222)
	at org.apache.hadoop.ozone.client.io.KeyInputStream.read(KeyInputStream.java:171)
	at org.apache.hadoop.ozone.client.io.OzoneInputStream.read(OzoneInputStream.java:47)
	at java.io.InputStream.read(InputStream.java:101)
	at org.apache.hadoop.ozone.container.ContainerTestHelper.validateData(ContainerTestHelper.java:709)
	at org.apache.hadoop.ozone.client.rpc.TestFailureHandlingByClient.validateData(TestFailureHandlingByClient.java:497)
	at org.apache.hadoop.ozone.client.rpc.TestFailureHandlingByClient.testPipelineExclusionWithPipelineFailure(TestFailureHandlingByClient.java:485)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 14, 2019 10:28:29 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=377, target=192.168.46.40:45485} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsync(GrpcClientRpc.java:66)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequestAsync(RaftClientImpl.java:351)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequestWithRetryAsync(RaftClientImpl.java:313)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:251)
	at org.apache.ratis.util.SlidingWindow$Client.retry(SlidingWindow.java:267)
	at org.apache.ratis.client.impl.RaftClientImpl.lambda$null$10(RaftClientImpl.java:320)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$0(TimeoutScheduler.java:85)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$1(TimeoutScheduler.java:104)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:50)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:91)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

Jun 14, 2019 10:28:29 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=542, target=192.168.46.40:35961} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsync(GrpcClientRpc.java:66)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequestAsync(RaftClientImpl.java:351)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequestWithRetryAsync(RaftClientImpl.java:313)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:251)
	at org.apache.ratis.util.SlidingWindow$Client.retry(SlidingWindow.java:267)
	at org.apache.ratis.client.impl.RaftClientImpl.lambda$null$10(RaftClientImpl.java:320)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$0(TimeoutScheduler.java:85)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$1(TimeoutScheduler.java:104)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:50)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:91)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

Jun 14, 2019 10:28:29 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=531, target=192.168.46.40:35213} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsync(GrpcClientRpc.java:66)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequestAsync(RaftClientImpl.java:351)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequestWithRetryAsync(RaftClientImpl.java:313)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:251)
	at org.apache.ratis.util.SlidingWindow$Client.retry(SlidingWindow.java:267)
	at org.apache.ratis.client.impl.RaftClientImpl.lambda$null$10(RaftClientImpl.java:320)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$0(TimeoutScheduler.java:85)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$1(TimeoutScheduler.java:104)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:50)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:91)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2019-06-14 10:28:29,620 INFO  node.StaleNodeHandler (StaleNodeHandler.java:onMessage(58)) - Datanode d78c9fa1-8140-46fa-98f3-1d025e275fbb{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null} moved to stale state. Finalizing its pipelines [PipelineID=4b99eb5d-eb43-41d4-9e93-1d0420c8326b, PipelineID=502b1cdf-3a57-451f-982e-9305b63ef336]
2019-06-14 10:28:29,620 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: 4b99eb5d-eb43-41d4-9e93-1d0420c8326b, Nodes: d78c9fa1-8140-46fa-98f3-1d025e275fbb{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:28:29,620 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 4b99eb5d-eb43-41d4-9e93-1d0420c8326b, Nodes: d78c9fa1-8140-46fa-98f3-1d025e275fbb{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-06-14 10:28:29,620 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: 502b1cdf-3a57-451f-982e-9305b63ef336, Nodes: b58bcdda-f0cf-47c2-806d-984c7da72fef{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}d78c9fa1-8140-46fa-98f3-1d025e275fbb{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}295b690a-12a8-417c-9186-35ca4bb21c45{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
2019-06-14 10:28:29,713 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to d78c9fa1-8140-46fa-98f3-1d025e275fbb:192.168.46.40:44229: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:29,713 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->d78c9fa1-8140-46fa-98f3-1d025e275fbb: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:29,719 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 295b690a-12a8-417c-9186-35ca4bb21c45: Failed appendEntries to b58bcdda-f0cf-47c2-806d-984c7da72fef:192.168.46.40:33479: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:29,719 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 295b690a-12a8-417c-9186-35ca4bb21c45->b58bcdda-f0cf-47c2-806d-984c7da72fef: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:29,723 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:shutdown(321)) - Shutting down the Mini Ozone Cluster
2019-06-14 10:28:29,723 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(336)) - Stopping the Mini Ozone Cluster
2019-06-14 10:28:29,723 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(338)) - Stopping the OzoneManager
2019-06-14 10:28:29,723 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 41189
2019-06-14 10:28:29,726 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 41189
2019-06-14 10:28:29,726 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service KeyDeletingService
2019-06-14 10:28:29,726 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-14 10:28:29,728 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@22846a1d{/,null,UNAVAILABLE}{/ozoneManager}
2019-06-14 10:28:29,729 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@fe38c0e{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:28:29,729 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@7f5ecada{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,UNAVAILABLE}
2019-06-14 10:28:29,729 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@22105c76{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:28:29,731 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(344)) - Stopping the StorageContainerManager
2019-06-14 10:28:29,731 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(789)) - Stopping Replication Manager Service.
2019-06-14 10:28:29,731 INFO  container.ReplicationManager (ReplicationManager.java:stop(191)) - Replication Monitor Thread is not running.
2019-06-14 10:28:29,731 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(796)) - Stopping Lease Manager of the command watchers
2019-06-14 10:28:29,731 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(803)) - Stopping datanode service RPC server
2019-06-14 10:28:29,731 INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(373)) - Stopping the RPC server for DataNodes
2019-06-14 10:28:29,731 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 41075
2019-06-14 10:28:29,734 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 41075
2019-06-14 10:28:29,735 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-14 10:28:29,735 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(811)) - Stopping block service RPC server
2019-06-14 10:28:29,735 INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(145)) - Stopping the RPC server for Block Protocol
2019-06-14 10:28:29,735 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 35033
2019-06-14 10:28:29,738 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 35033
2019-06-14 10:28:29,739 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-14 10:28:29,739 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(818)) - Stopping the StorageContainerLocationProtocol RPC server
2019-06-14 10:28:29,739 INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(157)) - Stopping the RPC server for Client Protocol
2019-06-14 10:28:29,739 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 42811
2019-06-14 10:28:29,741 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(825)) - Stopping Storage Container Manager HTTP server.
2019-06-14 10:28:29,742 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-14 10:28:29,742 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@5bcfdaf3{/,null,UNAVAILABLE}{/scm}
2019-06-14 10:28:29,742 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 42811
2019-06-14 10:28:29,743 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@38347345{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:28:29,743 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@42c9b1ee{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,UNAVAILABLE}
2019-06-14 10:28:29,743 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@2ff62720{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:28:29,744 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(836)) - Stopping Block Manager Service.
2019-06-14 10:28:29,744 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service SCMBlockDeletingService
2019-06-14 10:28:29,744 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service SCMBlockDeletingService
2019-06-14 10:28:29,744 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(858)) - Stopping SCM Event Queue.
2019-06-14 10:28:29,746 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(350)) - Shutting the HddsDatanodes
2019-06-14 10:28:29,746 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:28:29,746 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@361d8567
2019-06-14 10:28:29,747 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:28:29,747 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:28:29,747 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 75f987be-0e56-498c-a731-9178ff149875: close
2019-06-14 10:28:29,747 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 75f987be-0e56-498c-a731-9178ff149875: shutdown group-2F3A23DD38D8
2019-06-14 10:28:29,747 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-2F3A23DD38D8,id=75f987be-0e56-498c-a731-9178ff149875
2019-06-14 10:28:29,748 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 75f987be-0e56-498c-a731-9178ff149875: shutdown LeaderState
2019-06-14 10:28:29,748 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 75f987be-0e56-498c-a731-9178ff149875-PendingRequests: sendNotLeaderResponses
2019-06-14 10:28:29,748 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-75f987be-0e56-498c-a731-9178ff149875-group-2F3A23DD38D8: set stopIndex = 0
2019-06-14 10:28:29,748 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:28:29,749 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 75f987be-0e56-498c-a731-9178ff149875:group-2F3A23DD38D8 closes. The last applied log index is 0
2019-06-14 10:28:29,749 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 75f987be-0e56-498c-a731-9178ff149875-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:29,749 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 75f987be-0e56-498c-a731-9178ff149875-RaftLogWorker close()
2019-06-14 10:28:29,749 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 75f987be-0e56-498c-a731-9178ff149875: shutdown group-8D72E19EE80D
2019-06-14 10:28:29,749 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-8D72E19EE80D,id=75f987be-0e56-498c-a731-9178ff149875
2019-06-14 10:28:29,750 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 75f987be-0e56-498c-a731-9178ff149875: shutdown FollowerState
2019-06-14 10:28:29,750 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-75f987be-0e56-498c-a731-9178ff149875-group-8D72E19EE80D: set stopIndex = 44
2019-06-14 10:28:29,750 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:43)
2019-06-14 10:28:29,750 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-0/data/ratis/5e0a7dc3-374b-42f0-9237-8d72e19ee80d/sm/snapshot.1_43
2019-06-14 10:28:29,750 INFO  impl.FollowerState (FollowerState.java:run(109)) - 75f987be-0e56-498c-a731-9178ff149875: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:28:29,750 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 75f987be-0e56-498c-a731-9178ff149875:group-8D72E19EE80D closes. The last applied log index is 44
2019-06-14 10:28:29,750 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 75f987be-0e56-498c-a731-9178ff149875-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:29,751 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 75f987be-0e56-498c-a731-9178ff149875-RaftLogWorker close()
2019-06-14 10:28:29,751 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 75f987be-0e56-498c-a731-9178ff149875: shutdown server with port 44923 now
2019-06-14 10:28:29,751 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - 75f987be-0e56-498c-a731-9178ff149875: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:29,751 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 75f987be-0e56-498c-a731-9178ff149875: shutdown server with port 44923 successfully
2019-06-14 10:28:29,752 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - b9c49b19-09c2-4188-a006-d6759c13b106: Failed appendEntries to 75f987be-0e56-498c-a731-9178ff149875:192.168.46.40:44923: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-14 10:28:29,752 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - b9c49b19-09c2-4188-a006-d6759c13b106->75f987be-0e56-498c-a731-9178ff149875: nextIndex: updateUnconditionally 45 -> 0
2019-06-14 10:28:29,753 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:28:29,762 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:28:29,762 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@8636cf4{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:28:29,766 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@7c9512c6{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:28:29,766 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@1bbc1b90{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:28:29,766 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@52b30dcd{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:28:29,773 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:28:29,774 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@40105b39
2019-06-14 10:28:29,774 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:28:29,774 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:28:29,774 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: close
2019-06-14 10:28:29,775 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: shutdown group-8D72E19EE80D
2019-06-14 10:28:29,775 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-8D72E19EE80D,id=bd91091a-c280-437f-8263-5f77ae9d5b9a
2019-06-14 10:28:29,775 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: shutdown FollowerState
2019-06-14 10:28:29,775 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-bd91091a-c280-437f-8263-5f77ae9d5b9a-group-8D72E19EE80D: set stopIndex = 44
2019-06-14 10:28:29,775 INFO  impl.FollowerState (FollowerState.java:run(109)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:28:29,775 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:43)
2019-06-14 10:28:29,775 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-1/data/ratis/5e0a7dc3-374b-42f0-9237-8d72e19ee80d/sm/snapshot.1_43
2019-06-14 10:28:29,776 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - bd91091a-c280-437f-8263-5f77ae9d5b9a:group-8D72E19EE80D closes. The last applied log index is 44
2019-06-14 10:28:29,776 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - bd91091a-c280-437f-8263-5f77ae9d5b9a-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:29,776 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - bd91091a-c280-437f-8263-5f77ae9d5b9a-RaftLogWorker close()
2019-06-14 10:28:29,776 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: shutdown group-3902C46838A7
2019-06-14 10:28:29,776 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-3902C46838A7,id=bd91091a-c280-437f-8263-5f77ae9d5b9a
2019-06-14 10:28:29,777 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: shutdown LeaderState
2019-06-14 10:28:29,777 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - bd91091a-c280-437f-8263-5f77ae9d5b9a-PendingRequests: sendNotLeaderResponses
2019-06-14 10:28:29,777 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-bd91091a-c280-437f-8263-5f77ae9d5b9a-group-3902C46838A7: set stopIndex = 0
2019-06-14 10:28:29,777 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:28:29,777 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - bd91091a-c280-437f-8263-5f77ae9d5b9a:group-3902C46838A7 closes. The last applied log index is 0
2019-06-14 10:28:29,777 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - bd91091a-c280-437f-8263-5f77ae9d5b9a-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:29,778 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - bd91091a-c280-437f-8263-5f77ae9d5b9a-RaftLogWorker close()
2019-06-14 10:28:29,778 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: shutdown server with port 43295 now
2019-06-14 10:28:29,778 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:29,778 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - bd91091a-c280-437f-8263-5f77ae9d5b9a: shutdown server with port 43295 successfully
2019-06-14 10:28:29,778 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - b9c49b19-09c2-4188-a006-d6759c13b106: Failed appendEntries to bd91091a-c280-437f-8263-5f77ae9d5b9a:192.168.46.40:43295: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-14 10:28:29,779 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - b9c49b19-09c2-4188-a006-d6759c13b106->bd91091a-c280-437f-8263-5f77ae9d5b9a: nextIndex: updateUnconditionally 45 -> 0
2019-06-14 10:28:29,781 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:28:29,788 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:28:29,788 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@2682cccc{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:28:29,789 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@2ae08750{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:28:29,789 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@74c23525{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:28:29,790 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@6f95654c{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:28:29,791 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:28:29,791 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@7901a5ab
2019-06-14 10:28:29,791 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:28:29,791 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:28:29,792 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - b9c49b19-09c2-4188-a006-d6759c13b106: close
2019-06-14 10:28:29,792 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - b9c49b19-09c2-4188-a006-d6759c13b106: shutdown group-091A2CB1BF55
2019-06-14 10:28:29,792 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-091A2CB1BF55,id=b9c49b19-09c2-4188-a006-d6759c13b106
2019-06-14 10:28:29,792 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - b9c49b19-09c2-4188-a006-d6759c13b106: shutdown LeaderState
2019-06-14 10:28:29,792 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - b9c49b19-09c2-4188-a006-d6759c13b106-PendingRequests: sendNotLeaderResponses
2019-06-14 10:28:29,792 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-b9c49b19-09c2-4188-a006-d6759c13b106-group-091A2CB1BF55: set stopIndex = 0
2019-06-14 10:28:29,793 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:28:29,793 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - b9c49b19-09c2-4188-a006-d6759c13b106:group-091A2CB1BF55 closes. The last applied log index is 0
2019-06-14 10:28:29,793 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - b9c49b19-09c2-4188-a006-d6759c13b106-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:29,793 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - b9c49b19-09c2-4188-a006-d6759c13b106-RaftLogWorker close()
2019-06-14 10:28:29,793 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - b9c49b19-09c2-4188-a006-d6759c13b106: shutdown group-8D72E19EE80D
2019-06-14 10:28:29,794 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-8D72E19EE80D,id=b9c49b19-09c2-4188-a006-d6759c13b106
2019-06-14 10:28:29,794 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - b9c49b19-09c2-4188-a006-d6759c13b106: shutdown LeaderState
2019-06-14 10:28:29,794 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - b9c49b19-09c2-4188-a006-d6759c13b106-PendingRequests: sendNotLeaderResponses
2019-06-14 10:28:29,794 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(b9c49b19-09c2-4188-a006-d6759c13b106 -> 75f987be-0e56-498c-a731-9178ff149875): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:28:29,794 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:43)
2019-06-14 10:28:29,794 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-2/data/ratis/5e0a7dc3-374b-42f0-9237-8d72e19ee80d/sm/snapshot.1_43
2019-06-14 10:28:29,794 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(b9c49b19-09c2-4188-a006-d6759c13b106 -> bd91091a-c280-437f-8263-5f77ae9d5b9a): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:28:29,795 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-b9c49b19-09c2-4188-a006-d6759c13b106-group-8D72E19EE80D: set stopIndex = 44
2019-06-14 10:28:29,795 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - b9c49b19-09c2-4188-a006-d6759c13b106:group-8D72E19EE80D closes. The last applied log index is 44
2019-06-14 10:28:29,795 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - b9c49b19-09c2-4188-a006-d6759c13b106-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:29,795 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - b9c49b19-09c2-4188-a006-d6759c13b106-RaftLogWorker close()
2019-06-14 10:28:29,795 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - b9c49b19-09c2-4188-a006-d6759c13b106: shutdown server with port 35827 now
2019-06-14 10:28:29,796 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 3-UnorderedRequestStreamObserver3: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:29,797 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - b9c49b19-09c2-4188-a006-d6759c13b106: shutdown server with port 35827 successfully
2019-06-14 10:28:29,803 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:28:29,812 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:28:29,813 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@4a3383dc{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:28:29,813 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@72ce8a9b{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:28:29,814 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@3a47bf0e{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:28:29,814 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@1b96d447{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:28:29,814 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:28:29,815 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@7bb3294c
2019-06-14 10:28:29,815 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:28:29,815 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:28:29,815 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 295b690a-12a8-417c-9186-35ca4bb21c45: close
2019-06-14 10:28:29,816 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 295b690a-12a8-417c-9186-35ca4bb21c45: shutdown group-E112609DC54A
2019-06-14 10:28:29,816 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-E112609DC54A,id=295b690a-12a8-417c-9186-35ca4bb21c45
2019-06-14 10:28:29,816 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 295b690a-12a8-417c-9186-35ca4bb21c45: shutdown LeaderState
2019-06-14 10:28:29,816 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 295b690a-12a8-417c-9186-35ca4bb21c45-PendingRequests: sendNotLeaderResponses
2019-06-14 10:28:29,816 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-295b690a-12a8-417c-9186-35ca4bb21c45-group-E112609DC54A: set stopIndex = 0
2019-06-14 10:28:29,816 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:28:29,816 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-E112609DC54A closes. The last applied log index is 0
2019-06-14 10:28:29,816 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 295b690a-12a8-417c-9186-35ca4bb21c45-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:29,817 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 295b690a-12a8-417c-9186-35ca4bb21c45-RaftLogWorker close()
2019-06-14 10:28:29,817 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 295b690a-12a8-417c-9186-35ca4bb21c45: shutdown group-9305B63EF336
2019-06-14 10:28:29,817 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-9305B63EF336,id=295b690a-12a8-417c-9186-35ca4bb21c45
2019-06-14 10:28:29,817 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 295b690a-12a8-417c-9186-35ca4bb21c45: shutdown LeaderState
2019-06-14 10:28:29,817 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 295b690a-12a8-417c-9186-35ca4bb21c45-PendingRequests: sendNotLeaderResponses
2019-06-14 10:28:29,817 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(295b690a-12a8-417c-9186-35ca4bb21c45 -> b58bcdda-f0cf-47c2-806d-984c7da72fef): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:28:29,817 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(295b690a-12a8-417c-9186-35ca4bb21c45 -> d78c9fa1-8140-46fa-98f3-1d025e275fbb): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:28:29,818 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-295b690a-12a8-417c-9186-35ca4bb21c45-group-9305B63EF336: set stopIndex = 48
2019-06-14 10:28:29,819 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-19C8B3D5AD4B->295b690a-12a8-417c-9186-35ca4bb21c45@group-9305B63EF336, cid=101, seq=0, Watch-ALL_COMMITTED(37), Message:<EMPTY>, reply=RaftClientReply:client-19C8B3D5AD4B->295b690a-12a8-417c-9186-35ca4bb21c45@group-9305B63EF336, cid=101, FAILED org.apache.ratis.protocol.NotLeaderException: Server 295b690a-12a8-417c-9186-35ca4bb21c45 is not the leader (null). Request must be sent to leader., logIndex=0, commits[295b690a-12a8-417c-9186-35ca4bb21c45:c48]
2019-06-14 10:28:29,819 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:3, i:48)
2019-06-14 10:28:29,819 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-49de4dcf-2cb3-41a8-bffc-73ea0d902d44/datanode-4/data/ratis/502b1cdf-3a57-451f-982e-9305b63ef336/sm/snapshot.3_48
2019-06-14 10:28:29,819 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-19C8B3D5AD4B->295b690a-12a8-417c-9186-35ca4bb21c45@group-9305B63EF336, cid=101, seq=0, Watch-ALL_COMMITTED(37), Message:<EMPTY>, reply=RaftClientReply:client-19C8B3D5AD4B->295b690a-12a8-417c-9186-35ca4bb21c45@group-9305B63EF336, cid=101, FAILED org.apache.ratis.protocol.NotLeaderException: Server 295b690a-12a8-417c-9186-35ca4bb21c45 is not the leader (null). Request must be sent to leader., logIndex=0, commits[295b690a-12a8-417c-9186-35ca4bb21c45:c48]
2019-06-14 10:28:29,819 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 295b690a-12a8-417c-9186-35ca4bb21c45:group-9305B63EF336 closes. The last applied log index is 48
2019-06-14 10:28:29,819 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 295b690a-12a8-417c-9186-35ca4bb21c45-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:29,820 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 295b690a-12a8-417c-9186-35ca4bb21c45-RaftLogWorker close()
2019-06-14 10:28:29,821 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 295b690a-12a8-417c-9186-35ca4bb21c45: shutdown server with port 32961 now
2019-06-14 10:28:29,822 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 295b690a-12a8-417c-9186-35ca4bb21c45: shutdown server with port 32961 successfully
2019-06-14 10:28:29,826 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:28:29,833 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:28:29,834 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@7c93e69{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:28:29,834 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@4e4c05a0{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:28:29,835 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@33bf2602{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:28:29,835 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@59db8216{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:28:29,874 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:29,879 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:29,879 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:29,879 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedBlocks
2019-06-14 10:28:29,879 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedBlocks
2019-06-14 10:28:29,879 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: validCerts
2019-06-14 10:28:29,880 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:validCerts
2019-06-14 10:28:29,880 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: revokedCerts
2019-06-14 10:28:29,880 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:revokedCerts
2019-06-14 10:28:29,880 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-14 10:28:29,880 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-14 10:28:29,880 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-14 10:28:29,917 INFO  node.SCMNodeManager (SCMNodeManager.java:<init>(108)) - Entering startup safe mode.
2019-06-14 10:28:29,918 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(125)) - Loading file from sun.misc.CompoundEnumeration@4df13b7e
2019-06-14 10:28:29,918 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(171)) - Loading network topology layer schema file
2019-06-14 10:28:29,920 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:29,933 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:initializePipelineState(126)) - No pipeline exists in current db
2019-06-14 10:28:29,933 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:29,946 WARN  events.EventQueue (EventQueue.java:fireEvent(175)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='SafeModeStatus'}
2019-06-14 10:28:29,946 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:28:29,947 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 40301
2019-06-14 10:28:29,949 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:28:29,950 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 45491
2019-06-14 10:28:29,951 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:28:29,952 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 38985
2019-06-14 10:28:29,955 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for scm at: http://0.0.0.0:0
2019-06-14 10:28:29,956 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:28:29,957 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:28:29,958 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:28:29,958 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context scm
2019-06-14 10:28:29,958 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:28:29,958 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:28:29,962 INFO  server.StorageContainerManager (StorageContainerManager.java:start(752)) - StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:38985
2019-06-14 10:28:29,962 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - StorageContainerManager metrics system started (again)
2019-06-14 10:28:29,962 INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:start(149)) - RPC server for Client  is listening at /0.0.0.0:38985
2019-06-14 10:28:29,962 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:28:29,962 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 38985: starting
2019-06-14 10:28:29,966 INFO  server.StorageContainerManager (StorageContainerManager.java:start(761)) - ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:45491
2019-06-14 10:28:29,966 INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:start(137)) - RPC server for Block Protocol is listening at /0.0.0.0:45491
2019-06-14 10:28:29,966 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:28:29,967 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 45491: starting
2019-06-14 10:28:29,969 INFO  server.StorageContainerManager (StorageContainerManager.java:start(765)) - ScmDatanodeProtocl RPC server is listening at /0.0.0.0:40301
2019-06-14 10:28:29,969 INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:start(191)) - RPC server for DataNodes is listening at /0.0.0.0:40301
2019-06-14 10:28:29,970 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:28:29,970 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 40301: starting
2019-06-14 10:28:29,973 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 33661
2019-06-14 10:28:29,973 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:28:29,975 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@53a3fc8b{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:28:29,975 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@4d24ab25{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-14 10:28:29,977 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@344769b9{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/scm/,AVAILABLE}{/scm}
2019-06-14 10:28:29,978 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@34376069{HTTP/1.1,[http/1.1]}{0.0.0.0:33661}
2019-06-14 10:28:29,978 INFO  server.Server (Server.java:doStart(419)) - Started @75237ms
2019-06-14 10:28:29,979 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of SCM is listening at http://0.0.0.0:33661
2019-06-14 10:28:29,980 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:29,980 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:28:29,982 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:29,983 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(519)) - OM Service ID is not set. Setting it to the default ID: omServiceIdDefault
2019-06-14 10:28:29,983 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(525)) - OM Node ID is not set. Setting it to the OmStorage's OmID: 9b8e1147-81d2-45ff-b9b2-127caa556888
2019-06-14 10:28:29,983 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 10:28:29,983 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 10:28:29,983 INFO  om.OzoneManager (OzoneManager.java:loadOMHAConfigs(476)) - Found matching OM address with OMServiceId: null, OMNodeId: null, RPC Address: localhost:0 and Ratis port: 9872
2019-06-14 10:28:29,987 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:29,987 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: userTable
2019-06-14 10:28:29,987 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:userTable
2019-06-14 10:28:29,987 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: volumeTable
2019-06-14 10:28:29,987 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:volumeTable
2019-06-14 10:28:29,988 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: bucketTable
2019-06-14 10:28:29,988 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:bucketTable
2019-06-14 10:28:29,988 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: keyTable
2019-06-14 10:28:29,988 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:keyTable
2019-06-14 10:28:29,988 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedTable
2019-06-14 10:28:29,988 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedTable
2019-06-14 10:28:29,988 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: openKeyTable
2019-06-14 10:28:29,989 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:openKeyTable
2019-06-14 10:28:29,989 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3Table
2019-06-14 10:28:29,989 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3Table
2019-06-14 10:28:29,989 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: multipartInfoTable
2019-06-14 10:28:29,989 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:multipartInfoTable
2019-06-14 10:28:29,989 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: dTokenTable
2019-06-14 10:28:29,989 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:dTokenTable
2019-06-14 10:28:29,989 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3SecretTable
2019-06-14 10:28:29,990 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3SecretTable
2019-06-14 10:28:29,990 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: prefixTable
2019-06-14 10:28:29,990 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:prefixTable
2019-06-14 10:28:29,990 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-14 10:28:29,990 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-14 10:28:29,990 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-14 10:28:30,116 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:28:30,117 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 32923
2019-06-14 10:28:30,134 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:30,134 INFO  om.OzoneManager (OzoneManager.java:start(1217)) - OzoneManager RPC server is listening at localhost/127.0.0.1:32923
2019-06-14 10:28:30,134 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - OzoneManager metrics system started (again)
2019-06-14 10:28:30,140 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:28:30,141 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 32923: starting
2019-06-14 10:28:30,154 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for ozoneManager at: http://0.0.0.0:0
2019-06-14 10:28:30,155 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:28:30,156 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:28:30,157 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:28:30,157 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context ozoneManager
2019-06-14 10:28:30,157 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:28:30,157 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:28:30,158 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 36789
2019-06-14 10:28:30,158 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:28:30,159 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@3ec98000{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:28:30,159 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@5b53c3c5{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-14 10:28:30,162 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@16c1345b{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/ozoneManager/,AVAILABLE}{/ozoneManager}
2019-06-14 10:28:30,163 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@278cbf5a{HTTP/1.1,[http/1.1]}{0.0.0.0:36789}
2019-06-14 10:28:30,163 INFO  server.Server (Server.java:doStart(419)) - Started @75421ms
2019-06-14 10:28:30,164 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of OZONEMANAGER is listening at http://0.0.0.0:36789
2019-06-14 10:28:30,173 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:28:30,173 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:28:30,178 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-0/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:28:30,179 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-0/data/containers/hdds to VolumeSet
2019-06-14 10:28:30,179 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@61c0fb12
2019-06-14 10:28:30,179 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@61c0fb12
2019-06-14 10:28:30,190 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 41431
2019-06-14 10:28:30,192 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:28:30,192 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 41431 (custom)
2019-06-14 10:28:30,192 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:28:30,193 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:30,193 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:28:30,193 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:30,193 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-0/data/ratis] (custom)
2019-06-14 10:28:30,194 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 34265
2019-06-14 10:28:30,194 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:28:30,195 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:28:30,196 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:28:30,197 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:28:30,198 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:28:30,199 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:28:30,199 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:28:30,199 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:28:30,199 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 40249
2019-06-14 10:28:30,200 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:28:30,201 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@6c167296{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:28:30,201 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@5a464be7{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:28:30,225 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@32bae609{/,file:///tmp/jetty-0.0.0.0-40249-hddsDatanode-_-any-5607775869540194574.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:28:30,226 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@74a09d49{HTTP/1.1,[http/1.1]}{0.0.0.0:40249}
2019-06-14 10:28:30,226 INFO  server.Server (Server.java:doStart(419)) - Started @75485ms
2019-06-14 10:28:30,227 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:40249
Jun 14, 2019 10:28:30 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:28:30,329 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@1fe37d27
2019-06-14 10:28:30,329 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:28:30,330 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:28:30,330 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:28:30,331 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-0/meta/datanode.id
2019-06-14 10:28:30,334 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-1/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:28:30,334 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-1/data/containers/hdds to VolumeSet
2019-06-14 10:28:30,335 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1da61a29
2019-06-14 10:28:30,335 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1da61a29
2019-06-14 10:28:30,345 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43081
2019-06-14 10:28:30,346 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:28:30,347 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43081 (custom)
2019-06-14 10:28:30,347 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:28:30,347 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:30,347 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:28:30,347 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:30,348 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-1/data/ratis] (custom)
2019-06-14 10:28:30,348 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 33899
2019-06-14 10:28:30,349 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:28:30,349 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:28:30,350 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:28:30,351 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:28:30,351 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:28:30,352 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:28:30,352 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:28:30,352 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:28:30,352 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 38143
2019-06-14 10:28:30,353 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:28:30,354 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@21251e43{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:28:30,354 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@54c17a2b{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:28:30,375 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@1ee126de{/,file:///tmp/jetty-0.0.0.0-38143-hddsDatanode-_-any-5567697094768425961.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:28:30,375 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@22cce199{HTTP/1.1,[http/1.1]}{0.0.0.0:38143}
2019-06-14 10:28:30,376 INFO  server.Server (Server.java:doStart(419)) - Started @75635ms
2019-06-14 10:28:30,377 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:38143
Jun 14, 2019 10:28:30 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:28:30,458 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@5f32de90
2019-06-14 10:28:30,459 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:28:30,459 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:28:30,474 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:28:30,475 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-1/meta/datanode.id
2019-06-14 10:28:30,479 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-2/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:28:30,479 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-2/data/containers/hdds to VolumeSet
2019-06-14 10:28:30,479 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1d722bff
2019-06-14 10:28:30,479 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1d722bff
2019-06-14 10:28:30,487 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 38747
2019-06-14 10:28:30,488 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:28:30,489 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 38747 (custom)
2019-06-14 10:28:30,489 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:28:30,489 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:30,489 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:28:30,489 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:30,489 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-2/data/ratis] (custom)
2019-06-14 10:28:30,490 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 36675
2019-06-14 10:28:30,490 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:28:30,491 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:28:30,491 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:28:30,492 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:28:30,493 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:28:30,493 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:28:30,493 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:28:30,493 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:28:30,494 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 37165
2019-06-14 10:28:30,494 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:28:30,495 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@5e1e19af{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:28:30,495 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@35d145fb{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:28:30,516 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@4c31b6c2{/,file:///tmp/jetty-0.0.0.0-37165-hddsDatanode-_-any-6506932132878557467.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:28:30,516 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@5605a59b{HTTP/1.1,[http/1.1]}{0.0.0.0:37165}
2019-06-14 10:28:30,517 INFO  server.Server (Server.java:doStart(419)) - Started @75776ms
2019-06-14 10:28:30,518 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:37165
Jun 14, 2019 10:28:30 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:28:30,598 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@4fe8e318
2019-06-14 10:28:30,598 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:28:30,599 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:28:30,618 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:28:30,619 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-3/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:28:30,619 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-3/data/containers/hdds to VolumeSet
2019-06-14 10:28:30,620 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1ced1d14
2019-06-14 10:28:30,620 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-2/meta/datanode.id
2019-06-14 10:28:30,620 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1ced1d14
2019-06-14 10:28:30,628 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 35335
2019-06-14 10:28:30,629 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:28:30,629 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 35335 (custom)
2019-06-14 10:28:30,629 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:28:30,630 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:30,630 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:28:30,630 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:30,630 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-3/data/ratis] (custom)
2019-06-14 10:28:30,631 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 38269
2019-06-14 10:28:30,631 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:28:30,632 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:28:30,632 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:28:30,633 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:28:30,634 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:28:30,634 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:28:30,634 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:28:30,634 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:28:30,634 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 41967
2019-06-14 10:28:30,635 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:28:30,636 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@4fb42efa{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:28:30,637 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@51ac72f7{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:28:30,665 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@73502d5e{/,file:///tmp/jetty-0.0.0.0-41967-hddsDatanode-_-any-771734370205689977.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:28:30,665 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@471d6571{HTTP/1.1,[http/1.1]}{0.0.0.0:41967}
2019-06-14 10:28:30,666 INFO  server.Server (Server.java:doStart(419)) - Started @75925ms
2019-06-14 10:28:30,667 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:41967
Jun 14, 2019 10:28:30 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:28:30,754 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@29280ca6
2019-06-14 10:28:30,754 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:28:30,754 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:28:30,757 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:28:30,757 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-3/meta/datanode.id
2019-06-14 10:28:30,760 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-4/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:28:30,761 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-4/data/containers/hdds to VolumeSet
2019-06-14 10:28:30,761 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@17b9c9ff
2019-06-14 10:28:30,761 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@17b9c9ff
2019-06-14 10:28:30,769 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 40135
2019-06-14 10:28:30,770 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:28:30,770 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 40135 (custom)
2019-06-14 10:28:30,770 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:28:30,771 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:30,771 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:28:30,771 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:30,771 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-4/data/ratis] (custom)
2019-06-14 10:28:30,771 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 35009
2019-06-14 10:28:30,772 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:28:30,772 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:28:30,773 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:28:30,774 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:28:30,775 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:28:30,775 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:28:30,775 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:28:30,775 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:28:30,776 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 35553
2019-06-14 10:28:30,776 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:28:30,777 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@c10f7a8{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:28:30,793 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@33de9d85{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:28:30,816 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@43fdef43{/,file:///tmp/jetty-0.0.0.0-35553-hddsDatanode-_-any-4367140153023789656.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:28:30,817 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@3f36c191{HTTP/1.1,[http/1.1]}{0.0.0.0:35553}
2019-06-14 10:28:30,818 INFO  server.Server (Server.java:doStart(419)) - Started @76077ms
2019-06-14 10:28:30,819 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:35553
Jun 14, 2019 10:28:30 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:28:30,921 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@3db3668
2019-06-14 10:28:30,922 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:28:30,922 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:28:30,923 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:28:30,923 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-4/meta/datanode.id
2019-06-14 10:28:30,928 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-5/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:28:30,928 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-5/data/containers/hdds to VolumeSet
2019-06-14 10:28:30,928 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@7ab8f93
2019-06-14 10:28:30,928 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@7ab8f93
2019-06-14 10:28:30,936 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 44429
2019-06-14 10:28:30,938 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:28:30,938 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 44429 (custom)
2019-06-14 10:28:30,938 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:28:30,938 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:30,938 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:28:30,938 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:30,939 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-5/data/ratis] (custom)
2019-06-14 10:28:30,939 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 46691
2019-06-14 10:28:30,939 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:28:30,940 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:28:30,941 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:28:30,941 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:28:30,942 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:28:30,942 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:28:30,943 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:28:30,943 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:28:30,943 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 42245
2019-06-14 10:28:30,943 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:28:30,944 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@7ccfed46{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:28:30,945 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@71e2ddd{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:28:30,965 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@3e3d8e6c{/,file:///tmp/jetty-0.0.0.0-42245-hddsDatanode-_-any-6871766063656097553.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:28:30,966 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@7fd3197b{HTTP/1.1,[http/1.1]}{0.0.0.0:42245}
2019-06-14 10:28:30,967 INFO  server.Server (Server.java:doStart(419)) - Started @76226ms
2019-06-14 10:28:30,968 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:42245
Jun 14, 2019 10:28:30 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:28:31,048 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@292b7a02
2019-06-14 10:28:31,048 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:28:31,049 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:28:31,050 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-5/meta/datanode.id
2019-06-14 10:28:32,049 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:28:32,338 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:28:32,338 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:28:32,338 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1 at port 41431
2019-06-14 10:28:32,341 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: start RPC server
2019-06-14 10:28:32,342 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: GrpcService started, listening on 0.0.0.0/0.0.0.0:41431
2019-06-14 10:28:32,477 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:28:32,477 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:28:32,477 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis b0aa3512-c9c4-47f5-8fca-680ed027fea5 at port 43081
2019-06-14 10:28:32,484 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start RPC server
2019-06-14 10:28:32,484 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: GrpcService started, listening on 0.0.0.0/0.0.0.0:43081
2019-06-14 10:28:32,621 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:28:32,621 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:28:32,621 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 3e94f7ad-f8b9-473d-b417-a18a228d116d at port 38747
2019-06-14 10:28:32,624 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-14 10:28:32,624 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-14 10:28:32,624 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-14 10:28:32,624 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-14 10:28:32,625 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: start RPC server
2019-06-14 10:28:32,625 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: GrpcService started, listening on 0.0.0.0/0.0.0.0:38747
2019-06-14 10:28:32,760 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:28:32,760 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:28:32,760 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 33efc1b5-c38d-44ff-b22e-2cf6345186ab at port 35335
2019-06-14 10:28:32,763 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab: start RPC server
2019-06-14 10:28:32,764 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab: GrpcService started, listening on 0.0.0.0/0.0.0.0:35335
2019-06-14 10:28:32,925 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:28:32,926 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:28:32,926 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 99630a57-0e9f-428d-8086-37f49b9f2f2f at port 40135
2019-06-14 10:28:32,929 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f: start RPC server
2019-06-14 10:28:32,930 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f: GrpcService started, listening on 0.0.0.0/0.0.0.0:40135
2019-06-14 10:28:33,049 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:28:33,052 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:28:33,052 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:28:33,052 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 39aab27a-937d-4d57-9e31-3229443b5129 at port 44429
2019-06-14 10:28:33,055 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 39aab27a-937d-4d57-9e31-3229443b5129: start RPC server
2019-06-14 10:28:33,056 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 39aab27a-937d-4d57-9e31-3229443b5129: GrpcService started, listening on 0.0.0.0/0.0.0.0:44429
2019-06-14 10:28:34,049 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:28:34,333 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:28:34,335 INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 1 DataNodes registered, 1 required.
2019-06-14 10:28:34,336 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(177)) - ScmSafeModeManager, all rules are successfully validated
2019-06-14 10:28:34,337 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:exitSafeMode(193)) - SCM exiting safe mode.
2019-06-14 10:28:34,341 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: addNew group-7334ADA910CD:[3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431] returns group-7334ADA910CD:java.util.concurrent.CompletableFuture@5ad5bf76[Not completed]
2019-06-14 10:28:34,342 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: new RaftServerImpl for group-7334ADA910CD:[3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431] with ContainerStateMachine:uninitialized
2019-06-14 10:28:34,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:34,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:34,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:34,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:34,342 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:group-7334ADA910CD ConfigurationManager, init=-1: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:34,343 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-0/data/ratis] (custom)
2019-06-14 10:28:34,343 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-0/data/ratis/6b45cbd4-fdeb-4f98-8a2b-7334ada910cd does not exist. Creating ...
2019-06-14 10:28:34,345 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-0/data/ratis/6b45cbd4-fdeb-4f98-8a2b-7334ada910cd/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:34,347 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-0/data/ratis/6b45cbd4-fdeb-4f98-8a2b-7334ada910cd has been successfully formatted.
2019-06-14 10:28:34,347 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:34,348 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:34,348 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:34,348 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:34,348 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:34,348 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:34,348 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-0/data/ratis/6b45cbd4-fdeb-4f98-8a2b-7334ada910cd
2019-06-14 10:28:34,348 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:34,348 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:34,348 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:34,348 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:34,348 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:34,349 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:34,349 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:34,349 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:34,349 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:34,349 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:34,349 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:34,349 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:34,350 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:34,350 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: start group-7334ADA910CD
2019-06-14 10:28:34,350 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:group-7334ADA910CD changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:34,350 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: start FollowerState
2019-06-14 10:28:34,350 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-7334ADA910CD,id=3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1
2019-06-14 10:28:34,352 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 6b45cbd4-fdeb-4f98-8a2b-7334ada910cd, Nodes: 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:28:34,474 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : b0aa3512-c9c4-47f5-8fca-680ed027fea5{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:28:34,479 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: addNew group-E4EB4F6EDEBE:[b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081] returns group-E4EB4F6EDEBE:java.util.concurrent.CompletableFuture@7bd4193a[Not completed]
2019-06-14 10:28:34,480 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: new RaftServerImpl for group-E4EB4F6EDEBE:[b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081] with ContainerStateMachine:uninitialized
2019-06-14 10:28:34,480 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:34,480 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:34,480 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:34,480 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:34,480 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E4EB4F6EDEBE ConfigurationManager, init=-1: [b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:34,480 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-1/data/ratis] (custom)
2019-06-14 10:28:34,480 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-1/data/ratis/ddce84fc-89c0-4d84-a72a-e4eb4f6edebe does not exist. Creating ...
2019-06-14 10:28:34,482 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-1/data/ratis/ddce84fc-89c0-4d84-a72a-e4eb4f6edebe/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:34,484 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-1/data/ratis/ddce84fc-89c0-4d84-a72a-e4eb4f6edebe has been successfully formatted.
2019-06-14 10:28:34,484 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:34,485 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:34,485 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:34,485 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:34,485 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:34,485 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:34,485 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new b0aa3512-c9c4-47f5-8fca-680ed027fea5-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-1/data/ratis/ddce84fc-89c0-4d84-a72a-e4eb4f6edebe
2019-06-14 10:28:34,485 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:34,485 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:34,485 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:34,485 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:34,485 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:34,485 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:34,485 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:34,485 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:34,485 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:34,486 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:34,486 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:34,486 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:34,486 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:34,486 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start group-E4EB4F6EDEBE
2019-06-14 10:28:34,486 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E4EB4F6EDEBE changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:34,486 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:28:34,486 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-E4EB4F6EDEBE,id=b0aa3512-c9c4-47f5-8fca-680ed027fea5
2019-06-14 10:28:34,487 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: ddce84fc-89c0-4d84-a72a-e4eb4f6edebe, Nodes: b0aa3512-c9c4-47f5-8fca-680ed027fea5{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:28:34,618 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 3e94f7ad-f8b9-473d-b417-a18a228d116d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:28:34,626 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: addNew group-852EB5213E14:[3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747] returns group-852EB5213E14:java.util.concurrent.CompletableFuture@6c83a4be[Not completed]
2019-06-14 10:28:34,626 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: new RaftServerImpl for group-852EB5213E14:[3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747] with ContainerStateMachine:uninitialized
2019-06-14 10:28:34,626 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:34,626 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:34,626 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:34,626 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:34,627 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d:group-852EB5213E14 ConfigurationManager, init=-1: [3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:34,627 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-2/data/ratis] (custom)
2019-06-14 10:28:34,627 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-2/data/ratis/de0339ac-8139-4db3-9039-852eb5213e14 does not exist. Creating ...
2019-06-14 10:28:34,629 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-2/data/ratis/de0339ac-8139-4db3-9039-852eb5213e14/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:34,631 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-2/data/ratis/de0339ac-8139-4db3-9039-852eb5213e14 has been successfully formatted.
2019-06-14 10:28:34,631 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:34,631 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:34,631 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:34,631 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:34,631 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:34,631 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:34,631 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 3e94f7ad-f8b9-473d-b417-a18a228d116d-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-2/data/ratis/de0339ac-8139-4db3-9039-852eb5213e14
2019-06-14 10:28:34,632 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:34,632 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:34,632 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:34,632 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:34,632 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:34,632 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:34,632 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:34,632 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:34,632 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:34,632 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:34,632 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:34,632 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:34,633 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:34,633 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: start group-852EB5213E14
2019-06-14 10:28:34,633 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d:group-852EB5213E14 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:34,633 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: start FollowerState
2019-06-14 10:28:34,633 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-852EB5213E14,id=3e94f7ad-f8b9-473d-b417-a18a228d116d
2019-06-14 10:28:34,634 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: de0339ac-8139-4db3-9039-852eb5213e14, Nodes: 3e94f7ad-f8b9-473d-b417-a18a228d116d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:28:34,643 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: addNew group-E9B621366AF0:[3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081] returns group-E9B621366AF0:java.util.concurrent.CompletableFuture@5847b9a5[Not completed]
2019-06-14 10:28:34,643 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: addNew group-E9B621366AF0:[3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081] returns group-E9B621366AF0:java.util.concurrent.CompletableFuture@1c47d8fc[Not completed]
2019-06-14 10:28:34,643 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: new RaftServerImpl for group-E9B621366AF0:[3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081] with ContainerStateMachine:uninitialized
2019-06-14 10:28:34,644 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:34,644 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:34,644 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: addNew group-E9B621366AF0:[3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081] returns group-E9B621366AF0:java.util.concurrent.CompletableFuture@3dd523f1[Not completed]
2019-06-14 10:28:34,644 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: new RaftServerImpl for group-E9B621366AF0:[3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081] with ContainerStateMachine:uninitialized
2019-06-14 10:28:34,644 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:34,644 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:34,644 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:34,644 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: new RaftServerImpl for group-E9B621366AF0:[3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081] with ContainerStateMachine:uninitialized
2019-06-14 10:28:34,644 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 ConfigurationManager, init=-1: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:34,644 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-1/data/ratis] (custom)
2019-06-14 10:28:34,644 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:34,644 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:34,645 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:34,645 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-1/data/ratis/2be980ba-d86e-45e3-a17d-e9b621366af0 does not exist. Creating ...
2019-06-14 10:28:34,645 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:34,645 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:34,645 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:34,645 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:group-E9B621366AF0 ConfigurationManager, init=-1: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:34,645 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:34,645 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-0/data/ratis] (custom)
2019-06-14 10:28:34,645 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d:group-E9B621366AF0 ConfigurationManager, init=-1: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:34,645 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-2/data/ratis] (custom)
2019-06-14 10:28:34,645 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-0/data/ratis/2be980ba-d86e-45e3-a17d-e9b621366af0 does not exist. Creating ...
2019-06-14 10:28:34,646 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-2/data/ratis/2be980ba-d86e-45e3-a17d-e9b621366af0 does not exist. Creating ...
2019-06-14 10:28:34,647 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-1/data/ratis/2be980ba-d86e-45e3-a17d-e9b621366af0/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:34,648 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-2/data/ratis/2be980ba-d86e-45e3-a17d-e9b621366af0/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:34,648 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-0/data/ratis/2be980ba-d86e-45e3-a17d-e9b621366af0/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:34,650 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-2/data/ratis/2be980ba-d86e-45e3-a17d-e9b621366af0 has been successfully formatted.
2019-06-14 10:28:34,650 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-1/data/ratis/2be980ba-d86e-45e3-a17d-e9b621366af0 has been successfully formatted.
2019-06-14 10:28:34,650 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:34,650 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:34,650 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:34,650 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:34,650 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:34,650 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:34,650 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:34,650 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:34,650 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:34,650 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:34,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:34,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:34,651 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new b0aa3512-c9c4-47f5-8fca-680ed027fea5-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-1/data/ratis/2be980ba-d86e-45e3-a17d-e9b621366af0
2019-06-14 10:28:34,651 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-0/data/ratis/2be980ba-d86e-45e3-a17d-e9b621366af0 has been successfully formatted.
2019-06-14 10:28:34,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:34,651 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 3e94f7ad-f8b9-473d-b417-a18a228d116d-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-2/data/ratis/2be980ba-d86e-45e3-a17d-e9b621366af0
2019-06-14 10:28:34,651 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:34,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:34,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:34,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:34,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:34,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:34,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:34,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:34,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:34,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:34,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:34,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:34,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:34,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:34,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:34,652 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-0/data/ratis/2be980ba-d86e-45e3-a17d-e9b621366af0
2019-06-14 10:28:34,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:34,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:34,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:34,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:34,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:34,653 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:34,653 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:34,653 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:34,653 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:34,653 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:34,653 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:34,653 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:34,653 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:34,653 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:34,653 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:34,654 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:34,654 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:34,654 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:34,654 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:34,654 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:34,654 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:34,654 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:34,654 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:34,654 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start group-E9B621366AF0
2019-06-14 10:28:34,655 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:34,655 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:28:34,655 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:34,655 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:34,655 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:34,655 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:34,655 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:34,655 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:34,655 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-E9B621366AF0,id=b0aa3512-c9c4-47f5-8fca-680ed027fea5
2019-06-14 10:28:34,656 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: start group-E9B621366AF0
2019-06-14 10:28:34,656 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d:group-E9B621366AF0 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:34,656 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: start group-E9B621366AF0
2019-06-14 10:28:34,656 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:group-E9B621366AF0 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:34,656 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: start FollowerState
2019-06-14 10:28:34,656 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-E9B621366AF0,id=3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1
2019-06-14 10:28:34,657 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: start FollowerState
2019-06-14 10:28:34,657 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-E9B621366AF0,id=3e94f7ad-f8b9-473d-b417-a18a228d116d
2019-06-14 10:28:34,660 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 2be980ba-d86e-45e3-a17d-e9b621366af0, Nodes: 3e94f7ad-f8b9-473d-b417-a18a228d116d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}b0aa3512-c9c4-47f5-8fca-680ed027fea5{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-14 10:28:34,758 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 33efc1b5-c38d-44ff-b22e-2cf6345186ab{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:28:34,762 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab: addNew group-E6185D92FC79:[33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335] returns group-E6185D92FC79:java.util.concurrent.CompletableFuture@1c44d5f6[Not completed]
2019-06-14 10:28:34,762 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab: new RaftServerImpl for group-E6185D92FC79:[33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335] with ContainerStateMachine:uninitialized
2019-06-14 10:28:34,763 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:34,763 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:34,763 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:34,763 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:34,763 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab:group-E6185D92FC79 ConfigurationManager, init=-1: [33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:34,763 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-3/data/ratis] (custom)
2019-06-14 10:28:34,763 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-3/data/ratis/b59475b8-b357-459e-b604-e6185d92fc79 does not exist. Creating ...
2019-06-14 10:28:34,765 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-3/data/ratis/b59475b8-b357-459e-b604-e6185d92fc79/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:34,767 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-3/data/ratis/b59475b8-b357-459e-b604-e6185d92fc79 has been successfully formatted.
2019-06-14 10:28:34,767 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:34,767 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:34,768 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:34,768 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:34,768 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:34,768 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:34,768 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 33efc1b5-c38d-44ff-b22e-2cf6345186ab-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-3/data/ratis/b59475b8-b357-459e-b604-e6185d92fc79
2019-06-14 10:28:34,768 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:34,768 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:34,768 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:34,768 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:34,768 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:34,768 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:34,768 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:34,768 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:34,768 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:34,769 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:34,769 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:34,769 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:34,769 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:34,769 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab: start group-E6185D92FC79
2019-06-14 10:28:34,769 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab:group-E6185D92FC79 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:34,769 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab: start FollowerState
2019-06-14 10:28:34,769 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-E6185D92FC79,id=33efc1b5-c38d-44ff-b22e-2cf6345186ab
2019-06-14 10:28:34,770 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: b59475b8-b357-459e-b604-e6185d92fc79, Nodes: 33efc1b5-c38d-44ff-b22e-2cf6345186ab{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:28:34,924 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 99630a57-0e9f-428d-8086-37f49b9f2f2f{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:28:34,928 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f: addNew group-2BC068D4182C:[99630a57-0e9f-428d-8086-37f49b9f2f2f:192.168.46.40:40135] returns group-2BC068D4182C:java.util.concurrent.CompletableFuture@15eae0c0[Not completed]
2019-06-14 10:28:34,928 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f: new RaftServerImpl for group-2BC068D4182C:[99630a57-0e9f-428d-8086-37f49b9f2f2f:192.168.46.40:40135] with ContainerStateMachine:uninitialized
2019-06-14 10:28:34,928 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:34,928 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:34,929 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:34,929 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:34,929 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f:group-2BC068D4182C ConfigurationManager, init=-1: [99630a57-0e9f-428d-8086-37f49b9f2f2f:192.168.46.40:40135], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:34,929 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-4/data/ratis] (custom)
2019-06-14 10:28:34,929 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-4/data/ratis/ad333a67-5ba9-4f53-b862-2bc068d4182c does not exist. Creating ...
2019-06-14 10:28:34,931 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-4/data/ratis/ad333a67-5ba9-4f53-b862-2bc068d4182c/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:34,933 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-4/data/ratis/ad333a67-5ba9-4f53-b862-2bc068d4182c has been successfully formatted.
2019-06-14 10:28:34,933 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:34,933 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:34,933 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:34,933 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:34,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:34,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:34,934 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 99630a57-0e9f-428d-8086-37f49b9f2f2f-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-4/data/ratis/ad333a67-5ba9-4f53-b862-2bc068d4182c
2019-06-14 10:28:34,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:34,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:34,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:34,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:34,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:34,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:34,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:34,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:34,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:34,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:34,935 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:34,935 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:34,935 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:34,935 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f: start group-2BC068D4182C
2019-06-14 10:28:34,935 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f:group-2BC068D4182C changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:34,935 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f: start FollowerState
2019-06-14 10:28:34,935 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-2BC068D4182C,id=99630a57-0e9f-428d-8086-37f49b9f2f2f
2019-06-14 10:28:34,936 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: ad333a67-5ba9-4f53-b862-2bc068d4182c, Nodes: 99630a57-0e9f-428d-8086-37f49b9f2f2f{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:28:35,049 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 5 of 6 DN Heartbeats.
2019-06-14 10:28:35,051 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 39aab27a-937d-4d57-9e31-3229443b5129{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:28:35,055 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 39aab27a-937d-4d57-9e31-3229443b5129: addNew group-9ED40E94B47E:[39aab27a-937d-4d57-9e31-3229443b5129:192.168.46.40:44429] returns group-9ED40E94B47E:java.util.concurrent.CompletableFuture@5c7868e4[Not completed]
2019-06-14 10:28:35,056 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 39aab27a-937d-4d57-9e31-3229443b5129: new RaftServerImpl for group-9ED40E94B47E:[39aab27a-937d-4d57-9e31-3229443b5129:192.168.46.40:44429] with ContainerStateMachine:uninitialized
2019-06-14 10:28:35,056 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:35,056 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:35,056 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:35,056 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:35,056 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 39aab27a-937d-4d57-9e31-3229443b5129:group-9ED40E94B47E ConfigurationManager, init=-1: [39aab27a-937d-4d57-9e31-3229443b5129:192.168.46.40:44429], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:35,056 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-5/data/ratis] (custom)
2019-06-14 10:28:35,056 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-5/data/ratis/e64bd13d-4950-45d3-aecc-9ed40e94b47e does not exist. Creating ...
2019-06-14 10:28:35,058 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-5/data/ratis/e64bd13d-4950-45d3-aecc-9ed40e94b47e/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:35,060 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-5/data/ratis/e64bd13d-4950-45d3-aecc-9ed40e94b47e has been successfully formatted.
2019-06-14 10:28:35,061 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:35,061 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:35,061 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:35,061 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:35,061 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:35,061 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:35,061 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 39aab27a-937d-4d57-9e31-3229443b5129-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-5/data/ratis/e64bd13d-4950-45d3-aecc-9ed40e94b47e
2019-06-14 10:28:35,061 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:35,061 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:35,061 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:35,061 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:35,061 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:35,061 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:35,061 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:35,062 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:35,062 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:35,062 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:35,062 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:35,062 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:35,062 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:35,062 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 39aab27a-937d-4d57-9e31-3229443b5129: start group-9ED40E94B47E
2019-06-14 10:28:35,062 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 39aab27a-937d-4d57-9e31-3229443b5129:group-9ED40E94B47E changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:35,062 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 39aab27a-937d-4d57-9e31-3229443b5129: start FollowerState
2019-06-14 10:28:35,063 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-9ED40E94B47E,id=39aab27a-937d-4d57-9e31-3229443b5129
2019-06-14 10:28:35,064 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: e64bd13d-4950-45d3-aecc-9ed40e94b47e, Nodes: 39aab27a-937d-4d57-9e31-3229443b5129{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:28:35,074 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 39aab27a-937d-4d57-9e31-3229443b5129: addNew group-10CF7E7D22E2:[33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335, 99630a57-0e9f-428d-8086-37f49b9f2f2f:192.168.46.40:40135, 39aab27a-937d-4d57-9e31-3229443b5129:192.168.46.40:44429] returns group-10CF7E7D22E2:java.util.concurrent.CompletableFuture@6afeac63[Not completed]
2019-06-14 10:28:35,074 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 39aab27a-937d-4d57-9e31-3229443b5129: new RaftServerImpl for group-10CF7E7D22E2:[33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335, 99630a57-0e9f-428d-8086-37f49b9f2f2f:192.168.46.40:40135, 39aab27a-937d-4d57-9e31-3229443b5129:192.168.46.40:44429] with ContainerStateMachine:uninitialized
2019-06-14 10:28:35,075 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:35,075 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:35,075 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:35,075 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:35,075 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 39aab27a-937d-4d57-9e31-3229443b5129:group-10CF7E7D22E2 ConfigurationManager, init=-1: [33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335, 99630a57-0e9f-428d-8086-37f49b9f2f2f:192.168.46.40:40135, 39aab27a-937d-4d57-9e31-3229443b5129:192.168.46.40:44429], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:35,075 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-5/data/ratis] (custom)
2019-06-14 10:28:35,075 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-5/data/ratis/351ff53c-7f58-442d-962b-10cf7e7d22e2 does not exist. Creating ...
2019-06-14 10:28:35,079 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f: addNew group-10CF7E7D22E2:[33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335, 99630a57-0e9f-428d-8086-37f49b9f2f2f:192.168.46.40:40135, 39aab27a-937d-4d57-9e31-3229443b5129:192.168.46.40:44429] returns group-10CF7E7D22E2:java.util.concurrent.CompletableFuture@368a848b[Not completed]
2019-06-14 10:28:35,079 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-5/data/ratis/351ff53c-7f58-442d-962b-10cf7e7d22e2/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:35,080 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f: new RaftServerImpl for group-10CF7E7D22E2:[33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335, 99630a57-0e9f-428d-8086-37f49b9f2f2f:192.168.46.40:40135, 39aab27a-937d-4d57-9e31-3229443b5129:192.168.46.40:44429] with ContainerStateMachine:uninitialized
2019-06-14 10:28:35,080 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:35,080 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:35,080 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:35,080 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:35,080 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab: addNew group-10CF7E7D22E2:[33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335, 99630a57-0e9f-428d-8086-37f49b9f2f2f:192.168.46.40:40135, 39aab27a-937d-4d57-9e31-3229443b5129:192.168.46.40:44429] returns group-10CF7E7D22E2:java.util.concurrent.CompletableFuture@751559a6[Not completed]
2019-06-14 10:28:35,080 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f:group-10CF7E7D22E2 ConfigurationManager, init=-1: [33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335, 99630a57-0e9f-428d-8086-37f49b9f2f2f:192.168.46.40:40135, 39aab27a-937d-4d57-9e31-3229443b5129:192.168.46.40:44429], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:35,080 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab: new RaftServerImpl for group-10CF7E7D22E2:[33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335, 99630a57-0e9f-428d-8086-37f49b9f2f2f:192.168.46.40:40135, 39aab27a-937d-4d57-9e31-3229443b5129:192.168.46.40:44429] with ContainerStateMachine:uninitialized
2019-06-14 10:28:35,080 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:35,081 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:35,081 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:35,081 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:35,081 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab:group-10CF7E7D22E2 ConfigurationManager, init=-1: [33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335, 99630a57-0e9f-428d-8086-37f49b9f2f2f:192.168.46.40:40135, 39aab27a-937d-4d57-9e31-3229443b5129:192.168.46.40:44429], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:35,081 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-3/data/ratis] (custom)
2019-06-14 10:28:35,081 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-3/data/ratis/351ff53c-7f58-442d-962b-10cf7e7d22e2 does not exist. Creating ...
2019-06-14 10:28:35,080 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-4/data/ratis] (custom)
2019-06-14 10:28:35,081 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-4/data/ratis/351ff53c-7f58-442d-962b-10cf7e7d22e2 does not exist. Creating ...
2019-06-14 10:28:35,082 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-5/data/ratis/351ff53c-7f58-442d-962b-10cf7e7d22e2 has been successfully formatted.
2019-06-14 10:28:35,082 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:35,082 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:35,082 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:35,082 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:35,082 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:35,082 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:35,082 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 39aab27a-937d-4d57-9e31-3229443b5129-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-5/data/ratis/351ff53c-7f58-442d-962b-10cf7e7d22e2
2019-06-14 10:28:35,082 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:35,082 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:35,082 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:35,082 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:35,083 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:35,083 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:35,083 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:35,083 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:35,083 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:35,083 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-3/data/ratis/351ff53c-7f58-442d-962b-10cf7e7d22e2/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:35,083 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:35,083 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:35,084 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:35,084 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:35,084 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 39aab27a-937d-4d57-9e31-3229443b5129: start group-10CF7E7D22E2
2019-06-14 10:28:35,084 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 39aab27a-937d-4d57-9e31-3229443b5129:group-10CF7E7D22E2 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:35,084 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 39aab27a-937d-4d57-9e31-3229443b5129: start FollowerState
2019-06-14 10:28:35,084 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-10CF7E7D22E2,id=39aab27a-937d-4d57-9e31-3229443b5129
2019-06-14 10:28:35,085 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-3/data/ratis/351ff53c-7f58-442d-962b-10cf7e7d22e2 has been successfully formatted.
2019-06-14 10:28:35,085 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:35,085 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:35,085 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:35,085 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-4/data/ratis/351ff53c-7f58-442d-962b-10cf7e7d22e2/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:35,085 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:35,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:35,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:35,086 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 33efc1b5-c38d-44ff-b22e-2cf6345186ab-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-3/data/ratis/351ff53c-7f58-442d-962b-10cf7e7d22e2
2019-06-14 10:28:35,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:35,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:35,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:35,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:35,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:35,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:35,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:35,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:35,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:35,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:35,087 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:35,087 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:35,087 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:35,087 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab: start group-10CF7E7D22E2
2019-06-14 10:28:35,087 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab:group-10CF7E7D22E2 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:35,087 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab: start FollowerState
2019-06-14 10:28:35,087 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-4/data/ratis/351ff53c-7f58-442d-962b-10cf7e7d22e2 has been successfully formatted.
2019-06-14 10:28:35,088 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:35,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:35,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:35,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:35,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:35,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:35,088 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 99630a57-0e9f-428d-8086-37f49b9f2f2f-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-4/data/ratis/351ff53c-7f58-442d-962b-10cf7e7d22e2
2019-06-14 10:28:35,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:35,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:35,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:35,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:35,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:35,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:35,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:35,089 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:35,089 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:35,089 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:35,089 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-10CF7E7D22E2,id=33efc1b5-c38d-44ff-b22e-2cf6345186ab
2019-06-14 10:28:35,089 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:35,089 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:35,089 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:35,089 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f: start group-10CF7E7D22E2
2019-06-14 10:28:35,089 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f:group-10CF7E7D22E2 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:35,090 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f: start FollowerState
2019-06-14 10:28:35,090 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-10CF7E7D22E2,id=99630a57-0e9f-428d-8086-37f49b9f2f2f
2019-06-14 10:28:35,091 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 351ff53c-7f58-442d-962b-10cf7e7d22e2, Nodes: 39aab27a-937d-4d57-9e31-3229443b5129{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}99630a57-0e9f-428d-8086-37f49b9f2f2f{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}33efc1b5-c38d-44ff-b22e-2cf6345186ab{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-14 10:28:35,362 INFO  impl.FollowerState (FollowerState.java:run(101)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:group-7334ADA910CD changes to CANDIDATE, lastRpcTime:1012, electionTimeout:1012ms
2019-06-14 10:28:35,362 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: shutdown FollowerState
2019-06-14 10:28:35,362 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:group-7334ADA910CD changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:35,362 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: start LeaderElection
2019-06-14 10:28:35,365 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:group-7334ADA910CD:LeaderElection50: begin an election at term 1 for -1: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431], old=null
2019-06-14 10:28:35,365 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: shutdown LeaderElection
2019-06-14 10:28:35,365 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:group-7334ADA910CD changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:28:35,365 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:group-7334ADA910CD change Leader from null to 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1 at term 1 for becomeLeader, leader elected after 1017ms
2019-06-14 10:28:35,365 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:35,365 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:35,366 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:35,366 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:35,366 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: start LeaderState
2019-06-14 10:28:35,366 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:35,366 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:group-7334ADA910CD set configuration 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431], old=null at 0
2019-06-14 10:28:35,405 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-0/data/ratis/6b45cbd4-fdeb-4f98-8a2b-7334ada910cd/current/log_inprogress_0
2019-06-14 10:28:35,534 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E4EB4F6EDEBE changes to CANDIDATE, lastRpcTime:1048, electionTimeout:1048ms
2019-06-14 10:28:35,535 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:28:35,535 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E4EB4F6EDEBE changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:35,535 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:28:35,537 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E4EB4F6EDEBE:LeaderElection51: begin an election at term 1 for -1: [b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:35,537 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:28:35,537 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E4EB4F6EDEBE changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:28:35,537 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E4EB4F6EDEBE change Leader from null to b0aa3512-c9c4-47f5-8fca-680ed027fea5 at term 1 for becomeLeader, leader elected after 1052ms
2019-06-14 10:28:35,537 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:35,537 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:35,538 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:35,538 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:35,538 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderState
2019-06-14 10:28:35,538 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:35,538 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E4EB4F6EDEBE set configuration 0: [b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null at 0
2019-06-14 10:28:35,574 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-1/data/ratis/ddce84fc-89c0-4d84-a72a-e4eb4f6edebe/current/log_inprogress_0
2019-06-14 10:28:35,716 INFO  impl.FollowerState (FollowerState.java:run(101)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1059, electionTimeout:1059ms
2019-06-14 10:28:35,716 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: shutdown FollowerState
2019-06-14 10:28:35,716 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:35,716 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: start LeaderElection
2019-06-14 10:28:35,718 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:group-E9B621366AF0:LeaderElection52: begin an election at term 1 for -1: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:35,722 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1
2019-06-14 10:28:35,722 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d:group-E9B621366AF0 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1
2019-06-14 10:28:35,722 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:28:35,722 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: shutdown FollowerState
2019-06-14 10:28:35,722 INFO  impl.FollowerState (FollowerState.java:run(109)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:28:35,722 INFO  impl.FollowerState (FollowerState.java:run(109)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:28:35,722 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:28:35,722 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: start FollowerState
2019-06-14 10:28:35,725 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:group-E9B621366AF0:LeaderElection52: Election PASSED; received 1 response(s) [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1->3e94f7ad-f8b9-473d-b417-a18a228d116d,true-t1] and 0 exception(s); 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:t1, leader=null, voted=3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1, raftlog=3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:35,725 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: shutdown LeaderElection
2019-06-14 10:28:35,725 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:group-E9B621366AF0 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:28:35,725 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:group-E9B621366AF0 change Leader from null to 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1 at term 1 for becomeLeader, leader elected after 1074ms
2019-06-14 10:28:35,725 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:35,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:35,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:35,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:35,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:28:35,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:35,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:28:35,726 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:28:35,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:35,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:35,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:28:35,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:35,727 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:28:35,727 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:28:35,727 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:35,727 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:35,727 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: start LeaderState
2019-06-14 10:28:35,727 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:35,729 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d:group-E9B621366AF0 change Leader from null to 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1 at term 1 for appendEntries, leader elected after 1079ms
2019-06-14 10:28:35,730 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:group-E9B621366AF0 set configuration 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null at 0
2019-06-14 10:28:35,733 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 change Leader from null to 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1 at term 1 for appendEntries, leader elected after 1083ms
2019-06-14 10:28:35,734 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d:group-E9B621366AF0 set configuration 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null at 0
2019-06-14 10:28:35,734 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:35,751 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 set configuration 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null at 0
2019-06-14 10:28:35,751 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:35,770 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-0/data/ratis/2be980ba-d86e-45e3-a17d-e9b621366af0/current/log_inprogress_0
2019-06-14 10:28:35,794 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-1/data/ratis/2be980ba-d86e-45e3-a17d-e9b621366af0/current/log_inprogress_0
2019-06-14 10:28:35,798 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-2/data/ratis/2be980ba-d86e-45e3-a17d-e9b621366af0/current/log_inprogress_0
2019-06-14 10:28:35,805 INFO  impl.FollowerState (FollowerState.java:run(101)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d:group-852EB5213E14 changes to CANDIDATE, lastRpcTime:1172, electionTimeout:1172ms
2019-06-14 10:28:35,805 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: shutdown FollowerState
2019-06-14 10:28:35,805 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d:group-852EB5213E14 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:35,805 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: start LeaderElection
2019-06-14 10:28:35,807 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d:group-852EB5213E14:LeaderElection53: begin an election at term 1 for -1: [3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747], old=null
2019-06-14 10:28:35,807 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: shutdown LeaderElection
2019-06-14 10:28:35,807 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d:group-852EB5213E14 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:28:35,807 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d:group-852EB5213E14 change Leader from null to 3e94f7ad-f8b9-473d-b417-a18a228d116d at term 1 for becomeLeader, leader elected after 1176ms
2019-06-14 10:28:35,808 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:35,808 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:35,808 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:35,808 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:35,808 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: start LeaderState
2019-06-14 10:28:35,808 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:35,808 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d:group-852EB5213E14 set configuration 0: [3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747], old=null at 0
2019-06-14 10:28:35,844 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-2/data/ratis/de0339ac-8139-4db3-9039-852eb5213e14/current/log_inprogress_0
2019-06-14 10:28:35,924 INFO  impl.FollowerState (FollowerState.java:run(101)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab:group-E6185D92FC79 changes to CANDIDATE, lastRpcTime:1155, electionTimeout:1155ms
2019-06-14 10:28:35,925 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab: shutdown FollowerState
2019-06-14 10:28:35,925 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab:group-E6185D92FC79 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:35,925 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab: start LeaderElection
2019-06-14 10:28:35,927 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab:group-E6185D92FC79:LeaderElection54: begin an election at term 1 for -1: [33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335], old=null
2019-06-14 10:28:35,927 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab: shutdown LeaderElection
2019-06-14 10:28:35,927 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab:group-E6185D92FC79 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:28:35,927 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab:group-E6185D92FC79 change Leader from null to 33efc1b5-c38d-44ff-b22e-2cf6345186ab at term 1 for becomeLeader, leader elected after 1159ms
2019-06-14 10:28:35,928 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:35,928 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:35,928 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:35,928 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:35,928 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab: start LeaderState
2019-06-14 10:28:35,928 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:35,937 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab:group-E6185D92FC79 set configuration 0: [33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335], old=null at 0
2019-06-14 10:28:35,964 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-3/data/ratis/b59475b8-b357-459e-b604-e6185d92fc79/current/log_inprogress_0
2019-06-14 10:28:36,050 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Cluster is ready. Got 6 of 6 DN Heartbeats.
2019-06-14 10:28:36,064 INFO  rpc.RpcClient (RpcClient.java:createVolume(289)) - Creating Volume: datanodefailurehandlingtest, with root as owner.
2019-06-14 10:28:36,071 INFO  rpc.RpcClient (RpcClient.java:createBucket(426)) - Creating Bucket: datanodefailurehandlingtest/datanodefailurehandlingtest, with Versioning false and Storage Type set to DISK and Encryption set to false 
2019-06-14 10:28:36,098 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:28:36,098 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@4fe8e318
2019-06-14 10:28:36,099 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:28:36,099 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:28:36,099 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: close
2019-06-14 10:28:36,099 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: shutdown group-E9B621366AF0
2019-06-14 10:28:36,100 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-E9B621366AF0,id=3e94f7ad-f8b9-473d-b417-a18a228d116d
2019-06-14 10:28:36,100 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: shutdown FollowerState
2019-06-14 10:28:36,100 INFO  impl.FollowerState (FollowerState.java:run(109)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:28:36,100 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-3e94f7ad-f8b9-473d-b417-a18a228d116d-group-E9B621366AF0: set stopIndex = -1
2019-06-14 10:28:36,101 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:28:36,101 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d:group-E9B621366AF0 closes. The last applied log index is -1
2019-06-14 10:28:36,101 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:36,101 INFO  impl.FollowerState (FollowerState.java:run(101)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f:group-2BC068D4182C changes to CANDIDATE, lastRpcTime:1166, electionTimeout:1166ms
2019-06-14 10:28:36,109 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f: shutdown FollowerState
2019-06-14 10:28:36,104 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d-RaftLogWorker close()
2019-06-14 10:28:36,110 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f:group-2BC068D4182C changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:36,112 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: shutdown group-852EB5213E14
2019-06-14 10:28:36,112 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f: start LeaderElection
2019-06-14 10:28:36,112 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-852EB5213E14,id=3e94f7ad-f8b9-473d-b417-a18a228d116d
2019-06-14 10:28:36,112 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: shutdown LeaderState
2019-06-14 10:28:36,112 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d-PendingRequests: sendNotLeaderResponses
2019-06-14 10:28:36,113 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-3e94f7ad-f8b9-473d-b417-a18a228d116d-group-852EB5213E14: set stopIndex = 0
2019-06-14 10:28:36,113 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:28:36,113 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d:group-852EB5213E14 closes. The last applied log index is 0
2019-06-14 10:28:36,113 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:36,115 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d-RaftLogWorker close()
2019-06-14 10:28:36,115 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f:group-2BC068D4182C:LeaderElection55: begin an election at term 1 for -1: [99630a57-0e9f-428d-8086-37f49b9f2f2f:192.168.46.40:40135], old=null
2019-06-14 10:28:36,118 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: shutdown server with port 38747 now
2019-06-14 10:28:36,118 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f: shutdown LeaderElection
2019-06-14 10:28:36,118 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f:group-2BC068D4182C changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:28:36,118 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f:group-2BC068D4182C change Leader from null to 99630a57-0e9f-428d-8086-37f49b9f2f2f at term 1 for becomeLeader, leader elected after 1184ms
2019-06-14 10:28:36,118 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:36,118 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:36,118 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:36,118 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:36,118 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: Failed appendEntries to 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-14 10:28:36,119 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f: start LeaderState
2019-06-14 10:28:36,119 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:36,119 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1->3e94f7ad-f8b9-473d-b417-a18a228d116d: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:36,119 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 3e94f7ad-f8b9-473d-b417-a18a228d116d: shutdown server with port 38747 successfully
2019-06-14 10:28:36,130 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:28:36,133 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:36,134 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f:group-2BC068D4182C set configuration 0: [99630a57-0e9f-428d-8086-37f49b9f2f2f:192.168.46.40:40135], old=null at 0
2019-06-14 10:28:36,138 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:36,174 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-4/data/ratis/ad333a67-5ba9-4f53-b862-2bc068d4182c/current/log_inprogress_0
2019-06-14 10:28:36,179 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:28:36,180 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@4c31b6c2{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:28:36,180 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@5605a59b{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:28:36,180 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@35d145fb{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:28:36,181 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@5e1e19af{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:28:36,185 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:28:36,186 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@1fe37d27
2019-06-14 10:28:36,186 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:28:36,186 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:28:36,186 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: close
2019-06-14 10:28:36,186 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: shutdown group-E9B621366AF0
2019-06-14 10:28:36,187 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: shutdown group-7334ADA910CD
2019-06-14 10:28:36,187 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-E9B621366AF0,id=3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1
2019-06-14 10:28:36,187 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: shutdown LeaderState
2019-06-14 10:28:36,187 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-7334ADA910CD,id=3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1
2019-06-14 10:28:36,187 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1 -> 3e94f7ad-f8b9-473d-b417-a18a228d116d): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:28:36,187 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1 -> b0aa3512-c9c4-47f5-8fca-680ed027fea5): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:28:36,187 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1-PendingRequests: sendNotLeaderResponses
2019-06-14 10:28:36,187 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: shutdown LeaderState
2019-06-14 10:28:36,188 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: appendEntries completed
2019-06-14 10:28:36,188 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1-PendingRequests: sendNotLeaderResponses
2019-06-14 10:28:36,188 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1-group-7334ADA910CD: set stopIndex = 0
2019-06-14 10:28:36,188 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: follower 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1->b0aa3512-c9c4-47f5-8fca-680ed027fea5(c-1,m0,n1, attendVote=true, lastRpcSendTime=438, lastRpcResponseTime=393) response Completed
2019-06-14 10:28:36,188 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1-group-E9B621366AF0: set stopIndex = 0
2019-06-14 10:28:36,188 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:28:36,189 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1->b0aa3512-c9c4-47f5-8fca-680ed027fea5: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:36,188 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:28:36,189 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:group-E9B621366AF0 closes. The last applied log index is 0
2019-06-14 10:28:36,189 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:group-7334ADA910CD closes. The last applied log index is 0
2019-06-14 10:28:36,190 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:36,190 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:36,191 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1-RaftLogWorker close()
2019-06-14 10:28:36,191 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1-RaftLogWorker close()
2019-06-14 10:28:36,194 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: shutdown server with port 41431 now
2019-06-14 10:28:36,195 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1: shutdown server with port 41431 successfully
2019-06-14 10:28:36,196 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:28:36,208 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:28:36,208 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@32bae609{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:28:36,208 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@74a09d49{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:28:36,209 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@5a464be7{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:28:36,209 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@6c167296{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:28:36,216 INFO  impl.FollowerState (FollowerState.java:run(101)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab:group-10CF7E7D22E2 changes to CANDIDATE, lastRpcTime:1128, electionTimeout:1127ms
2019-06-14 10:28:36,216 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab: shutdown FollowerState
2019-06-14 10:28:36,216 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab:group-10CF7E7D22E2 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:36,216 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab: start LeaderElection
2019-06-14 10:28:36,219 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab:group-10CF7E7D22E2:LeaderElection56: begin an election at term 1 for -1: [33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335, 99630a57-0e9f-428d-8086-37f49b9f2f2f:192.168.46.40:40135, 39aab27a-937d-4d57-9e31-3229443b5129:192.168.46.40:44429], old=null
2019-06-14 10:28:36,222 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 39aab27a-937d-4d57-9e31-3229443b5129:group-10CF7E7D22E2 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:33efc1b5-c38d-44ff-b22e-2cf6345186ab
2019-06-14 10:28:36,222 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 39aab27a-937d-4d57-9e31-3229443b5129: shutdown FollowerState
2019-06-14 10:28:36,222 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 39aab27a-937d-4d57-9e31-3229443b5129: start FollowerState
2019-06-14 10:28:36,222 INFO  impl.FollowerState (FollowerState.java:run(109)) - 39aab27a-937d-4d57-9e31-3229443b5129: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:28:36,224 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f:group-10CF7E7D22E2 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:33efc1b5-c38d-44ff-b22e-2cf6345186ab
2019-06-14 10:28:36,224 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f: shutdown FollowerState
2019-06-14 10:28:36,225 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f: start FollowerState
2019-06-14 10:28:36,225 INFO  impl.FollowerState (FollowerState.java:run(109)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:28:36,226 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab:group-10CF7E7D22E2:LeaderElection56: Election PASSED; received 1 response(s) [33efc1b5-c38d-44ff-b22e-2cf6345186ab->39aab27a-937d-4d57-9e31-3229443b5129,true-t1] and 0 exception(s); 33efc1b5-c38d-44ff-b22e-2cf6345186ab:t1, leader=null, voted=33efc1b5-c38d-44ff-b22e-2cf6345186ab, raftlog=33efc1b5-c38d-44ff-b22e-2cf6345186ab-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335, 99630a57-0e9f-428d-8086-37f49b9f2f2f:192.168.46.40:40135, 39aab27a-937d-4d57-9e31-3229443b5129:192.168.46.40:44429], old=null
2019-06-14 10:28:36,226 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab: shutdown LeaderElection
2019-06-14 10:28:36,226 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab:group-10CF7E7D22E2 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:28:36,226 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab:group-10CF7E7D22E2 change Leader from null to 33efc1b5-c38d-44ff-b22e-2cf6345186ab at term 1 for becomeLeader, leader elected after 1140ms
2019-06-14 10:28:36,226 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:36,226 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:36,226 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:36,226 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:36,226 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:28:36,226 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:36,226 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:28:36,226 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:28:36,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:36,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:36,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:28:36,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:36,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:28:36,227 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:28:36,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:36,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:36,227 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab: start LeaderState
2019-06-14 10:28:36,228 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:36,229 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f:group-10CF7E7D22E2 change Leader from null to 33efc1b5-c38d-44ff-b22e-2cf6345186ab at term 1 for appendEntries, leader elected after 1141ms
2019-06-14 10:28:36,229 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab:group-10CF7E7D22E2 set configuration 0: [33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335, 99630a57-0e9f-428d-8086-37f49b9f2f2f:192.168.46.40:40135, 39aab27a-937d-4d57-9e31-3229443b5129:192.168.46.40:44429], old=null at 0
2019-06-14 10:28:36,251 INFO  impl.FollowerState (FollowerState.java:run(101)) - 39aab27a-937d-4d57-9e31-3229443b5129:group-9ED40E94B47E changes to CANDIDATE, lastRpcTime:1188, electionTimeout:1170ms
2019-06-14 10:28:36,251 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 39aab27a-937d-4d57-9e31-3229443b5129: shutdown FollowerState
2019-06-14 10:28:36,251 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 39aab27a-937d-4d57-9e31-3229443b5129:group-9ED40E94B47E changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:36,251 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 39aab27a-937d-4d57-9e31-3229443b5129: start LeaderElection
2019-06-14 10:28:36,252 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f:group-10CF7E7D22E2 set configuration 0: [33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335, 99630a57-0e9f-428d-8086-37f49b9f2f2f:192.168.46.40:40135, 39aab27a-937d-4d57-9e31-3229443b5129:192.168.46.40:44429], old=null at 0
2019-06-14 10:28:36,252 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:36,253 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 39aab27a-937d-4d57-9e31-3229443b5129:group-10CF7E7D22E2 change Leader from null to 33efc1b5-c38d-44ff-b22e-2cf6345186ab at term 1 for appendEntries, leader elected after 1170ms
2019-06-14 10:28:36,254 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 39aab27a-937d-4d57-9e31-3229443b5129:group-9ED40E94B47E:LeaderElection57: begin an election at term 1 for -1: [39aab27a-937d-4d57-9e31-3229443b5129:192.168.46.40:44429], old=null
2019-06-14 10:28:36,254 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 39aab27a-937d-4d57-9e31-3229443b5129: shutdown LeaderElection
2019-06-14 10:28:36,254 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 39aab27a-937d-4d57-9e31-3229443b5129:group-9ED40E94B47E changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:28:36,254 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 39aab27a-937d-4d57-9e31-3229443b5129:group-9ED40E94B47E change Leader from null to 39aab27a-937d-4d57-9e31-3229443b5129 at term 1 for becomeLeader, leader elected after 1193ms
2019-06-14 10:28:36,254 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:36,254 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:36,254 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:36,254 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:36,254 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 39aab27a-937d-4d57-9e31-3229443b5129: start LeaderState
2019-06-14 10:28:36,254 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 39aab27a-937d-4d57-9e31-3229443b5129-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:36,255 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 39aab27a-937d-4d57-9e31-3229443b5129:group-9ED40E94B47E set configuration 0: [39aab27a-937d-4d57-9e31-3229443b5129:192.168.46.40:44429], old=null at 0
2019-06-14 10:28:36,255 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 39aab27a-937d-4d57-9e31-3229443b5129:group-10CF7E7D22E2 set configuration 0: [33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335, 99630a57-0e9f-428d-8086-37f49b9f2f2f:192.168.46.40:40135, 39aab27a-937d-4d57-9e31-3229443b5129:192.168.46.40:44429], old=null at 0
2019-06-14 10:28:36,255 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 39aab27a-937d-4d57-9e31-3229443b5129-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:36,280 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 33efc1b5-c38d-44ff-b22e-2cf6345186ab-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-3/data/ratis/351ff53c-7f58-442d-962b-10cf7e7d22e2/current/log_inprogress_0
2019-06-14 10:28:36,297 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 99630a57-0e9f-428d-8086-37f49b9f2f2f-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-4/data/ratis/351ff53c-7f58-442d-962b-10cf7e7d22e2/current/log_inprogress_0
2019-06-14 10:28:36,306 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 39aab27a-937d-4d57-9e31-3229443b5129-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-5/data/ratis/351ff53c-7f58-442d-962b-10cf7e7d22e2/current/log_inprogress_0
2019-06-14 10:28:36,313 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 39aab27a-937d-4d57-9e31-3229443b5129-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-03992a08-0158-43fa-8fa3-615e5cd36033/datanode-5/data/ratis/e64bd13d-4950-45d3-aecc-9ed40e94b47e/current/log_inprogress_0
2019-06-14 10:28:37,144 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-A279EEB8135E->b0aa3512-c9c4-47f5-8fca-680ed027fea5: receive RaftClientReply:client-A279EEB8135E->b0aa3512-c9c4-47f5-8fca-680ed027fea5@group-E9B621366AF0, cid=137, FAILED org.apache.ratis.protocol.NotLeaderException: Server b0aa3512-c9c4-47f5-8fca-680ed027fea5 is not the leader (3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431). Request must be sent to leader., logIndex=0, commits[b0aa3512-c9c4-47f5-8fca-680ed027fea5:c-1, 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:c-1, 3e94f7ad-f8b9-473d-b417-a18a228d116d:c-1]
2019-06-14 10:28:37,146 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:37,428 INFO  node.StaleNodeHandler (StaleNodeHandler.java:onMessage(58)) - Datanode 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null} moved to stale state. Finalizing its pipelines [PipelineID=2be980ba-d86e-45e3-a17d-e9b621366af0, PipelineID=6b45cbd4-fdeb-4f98-8a2b-7334ada910cd]
2019-06-14 10:28:37,428 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: 2be980ba-d86e-45e3-a17d-e9b621366af0, Nodes: 3e94f7ad-f8b9-473d-b417-a18a228d116d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}b0aa3512-c9c4-47f5-8fca-680ed027fea5{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-14 10:28:37,428 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 2be980ba-d86e-45e3-a17d-e9b621366af0, Nodes: 3e94f7ad-f8b9-473d-b417-a18a228d116d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}b0aa3512-c9c4-47f5-8fca-680ed027fea5{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] moved to CLOSED state
2019-06-14 10:28:37,429 INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #1
2019-06-14 10:28:37,429 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: 6b45cbd4-fdeb-4f98-8a2b-7334ada910cd, Nodes: 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:28:37,429 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 6b45cbd4-fdeb-4f98-8a2b-7334ada910cd, Nodes: 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-06-14 10:28:37,628 INFO  node.StaleNodeHandler (StaleNodeHandler.java:onMessage(58)) - Datanode 3e94f7ad-f8b9-473d-b417-a18a228d116d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null} moved to stale state. Finalizing its pipelines [PipelineID=2be980ba-d86e-45e3-a17d-e9b621366af0, PipelineID=de0339ac-8139-4db3-9039-852eb5213e14]
2019-06-14 10:28:37,628 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: 2be980ba-d86e-45e3-a17d-e9b621366af0, Nodes: 3e94f7ad-f8b9-473d-b417-a18a228d116d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}b0aa3512-c9c4-47f5-8fca-680ed027fea5{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
2019-06-14 10:28:37,629 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: de0339ac-8139-4db3-9039-852eb5213e14, Nodes: 3e94f7ad-f8b9-473d-b417-a18a228d116d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:28:37,629 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: de0339ac-8139-4db3-9039-852eb5213e14, Nodes: 3e94f7ad-f8b9-473d-b417-a18a228d116d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-06-14 10:28:37,869 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:2074, electionTimeout:1141ms
2019-06-14 10:28:37,869 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:28:37,869 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2019-06-14 10:28:37,869 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:28:37,869 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 change Leader from 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1 to null at term 1 for initElection
2019-06-14 10:28:37,872 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection58: begin an election at term 2 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:37,876 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection58 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:37,879 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection58 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:37,881 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection58: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t2, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:37,881 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:37,881 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:37,882 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 2 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:37,882 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:28:37,882 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:28:38,958 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1076, electionTimeout:1076ms
2019-06-14 10:28:38,958 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:28:38,958 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2019-06-14 10:28:38,958 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:28:38,961 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection59: begin an election at term 3 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:38,961 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection59 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:38,964 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection59 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:38,966 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection59: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t3, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:38,966 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:38,966 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:38,967 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 3 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:38,967 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:28:38,967 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:28:39,162 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-A279EEB8135E->b0aa3512-c9c4-47f5-8fca-680ed027fea5: receive RaftClientReply:client-A279EEB8135E->b0aa3512-c9c4-47f5-8fca-680ed027fea5@group-E9B621366AF0, cid=137, FAILED org.apache.ratis.protocol.NotLeaderException: Server b0aa3512-c9c4-47f5-8fca-680ed027fea5 is not the leader (3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747). Request must be sent to leader., logIndex=0, commits[b0aa3512-c9c4-47f5-8fca-680ed027fea5:c-1, 3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:c-1, 3e94f7ad-f8b9-473d-b417-a18a228d116d:c-1]
2019-06-14 10:28:39,165 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:39,474 ERROR commandhandler.CloseContainerCommandHandler (CloseContainerCommandHandler.java:handle(84)) - Container #1 does not exist in datanode. Container close failed.
2019-06-14 10:28:40,098 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1131, electionTimeout:1131ms
2019-06-14 10:28:40,098 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:28:40,098 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 3 for changeToCandidate
2019-06-14 10:28:40,098 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:28:40,101 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection60: begin an election at term 4 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:40,101 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection60 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:40,103 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection60 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:40,105 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection60: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t4, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:40,105 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:40,105 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:40,106 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 4 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:40,106 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:28:40,106 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:28:41,176 WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(276)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-A279EEB8135E->3e94f7ad-f8b9-473d-b417-a18a228d116d@group-E9B621366AF0, cid=137, seq=1*, RW, org.apache.hadoop.hdds.scm.XceiverClientRatis$$Lambda$436/510793091@1a024154 for 5 attempts with RetryLimited(maxAttempts=5, sleepTime=1000ms) on the pipeline Pipeline[ Id: 2be980ba-d86e-45e3-a17d-e9b621366af0, Nodes: 3e94f7ad-f8b9-473d-b417-a18a228d116d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}b0aa3512-c9c4-47f5-8fca-680ed027fea5{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]. The last committed block length is 0, uncommitted data length is 1572864 retry count 0
2019-06-14 10:28:41,188 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-16D10F23CC2F->39aab27a-937d-4d57-9e31-3229443b5129: receive RaftClientReply:client-16D10F23CC2F->39aab27a-937d-4d57-9e31-3229443b5129@group-10CF7E7D22E2, cid=141, FAILED org.apache.ratis.protocol.NotLeaderException: Server 39aab27a-937d-4d57-9e31-3229443b5129 is not the leader (33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335). Request must be sent to leader., logIndex=0, commits[39aab27a-937d-4d57-9e31-3229443b5129:c0, 33efc1b5-c38d-44ff-b22e-2cf6345186ab:c0, 99630a57-0e9f-428d-8086-37f49b9f2f2f:c0]
2019-06-14 10:28:41,191 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:41,302 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1196, electionTimeout:1196ms
2019-06-14 10:28:41,302 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:28:41,302 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 4 for changeToCandidate
2019-06-14 10:28:41,302 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:28:41,305 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection61: begin an election at term 5 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:41,305 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection61 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:41,307 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection61 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:41,308 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection61: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t5, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:41,308 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:41,308 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:41,308 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 5 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:41,309 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:28:41,309 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:28:42,198 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-16D10F23CC2F->99630a57-0e9f-428d-8086-37f49b9f2f2f: receive RaftClientReply:client-16D10F23CC2F->99630a57-0e9f-428d-8086-37f49b9f2f2f@group-10CF7E7D22E2, cid=141, FAILED org.apache.ratis.protocol.NotLeaderException: Server 99630a57-0e9f-428d-8086-37f49b9f2f2f is not the leader (33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335). Request must be sent to leader., logIndex=0, commits[99630a57-0e9f-428d-8086-37f49b9f2f2f:c0, 33efc1b5-c38d-44ff-b22e-2cf6345186ab:c0, 39aab27a-937d-4d57-9e31-3229443b5129:c0]
2019-06-14 10:28:42,200 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:42,370 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1061, electionTimeout:1061ms
2019-06-14 10:28:42,370 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:28:42,370 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 5 for changeToCandidate
2019-06-14 10:28:42,370 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:28:42,372 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection62: begin an election at term 6 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:42,373 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection62 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:42,375 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection62 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:42,376 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection62: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t6, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:42,376 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:42,376 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:42,377 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 6 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:42,377 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:28:42,377 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:28:43,208 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-16D10F23CC2F->39aab27a-937d-4d57-9e31-3229443b5129: receive RaftClientReply:client-16D10F23CC2F->39aab27a-937d-4d57-9e31-3229443b5129@group-10CF7E7D22E2, cid=141, FAILED org.apache.ratis.protocol.NotLeaderException: Server 39aab27a-937d-4d57-9e31-3229443b5129 is not the leader (33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335). Request must be sent to leader., logIndex=0, commits[39aab27a-937d-4d57-9e31-3229443b5129:c0, 33efc1b5-c38d-44ff-b22e-2cf6345186ab:c0, 99630a57-0e9f-428d-8086-37f49b9f2f2f:c0]
2019-06-14 10:28:43,214 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:43,393 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1016, electionTimeout:1016ms
2019-06-14 10:28:43,393 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:28:43,393 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 6 for changeToCandidate
2019-06-14 10:28:43,393 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:28:43,396 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection63: begin an election at term 7 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:43,396 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection63 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:43,398 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection63 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:43,400 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection63: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t7, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:43,400 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:43,401 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:43,401 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 7 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:43,401 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:28:43,401 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:28:44,221 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-16D10F23CC2F->99630a57-0e9f-428d-8086-37f49b9f2f2f: receive RaftClientReply:client-16D10F23CC2F->99630a57-0e9f-428d-8086-37f49b9f2f2f@group-10CF7E7D22E2, cid=141, FAILED org.apache.ratis.protocol.NotLeaderException: Server 99630a57-0e9f-428d-8086-37f49b9f2f2f is not the leader (33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335). Request must be sent to leader., logIndex=0, commits[99630a57-0e9f-428d-8086-37f49b9f2f2f:c0, 33efc1b5-c38d-44ff-b22e-2cf6345186ab:c0, 39aab27a-937d-4d57-9e31-3229443b5129:c0]
2019-06-14 10:28:44,224 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:44,582 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1181, electionTimeout:1181ms
2019-06-14 10:28:44,582 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:28:44,582 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 7 for changeToCandidate
2019-06-14 10:28:44,583 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:28:44,585 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection64: begin an election at term 8 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:44,586 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection64 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:44,588 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection64 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:44,590 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection64: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t8, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:44,590 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:44,590 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:44,590 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 8 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:44,591 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:28:44,591 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:28:45,233 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-16D10F23CC2F->39aab27a-937d-4d57-9e31-3229443b5129: receive RaftClientReply:client-16D10F23CC2F->39aab27a-937d-4d57-9e31-3229443b5129@group-10CF7E7D22E2, cid=141, FAILED org.apache.ratis.protocol.NotLeaderException: Server 39aab27a-937d-4d57-9e31-3229443b5129 is not the leader (33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335). Request must be sent to leader., logIndex=0, commits[39aab27a-937d-4d57-9e31-3229443b5129:c0, 33efc1b5-c38d-44ff-b22e-2cf6345186ab:c0, 99630a57-0e9f-428d-8086-37f49b9f2f2f:c0]
2019-06-14 10:28:45,235 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 2-OrderedRequestStreamObserver2: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:45,593 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1002, electionTimeout:1002ms
2019-06-14 10:28:45,593 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:28:45,593 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 8 for changeToCandidate
2019-06-14 10:28:45,593 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:28:45,595 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection65: begin an election at term 9 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:45,596 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection65 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:45,598 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection65 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:45,600 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection65: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t9, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:45,600 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:45,600 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:45,600 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 9 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:45,600 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:28:45,600 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:28:46,240 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-16D10F23CC2F->99630a57-0e9f-428d-8086-37f49b9f2f2f: receive RaftClientReply:client-16D10F23CC2F->99630a57-0e9f-428d-8086-37f49b9f2f2f@group-10CF7E7D22E2, cid=141, FAILED org.apache.ratis.protocol.NotLeaderException: Server 99630a57-0e9f-428d-8086-37f49b9f2f2f is not the leader (33efc1b5-c38d-44ff-b22e-2cf6345186ab:192.168.46.40:35335). Request must be sent to leader., logIndex=0, commits[99630a57-0e9f-428d-8086-37f49b9f2f2f:c0, 33efc1b5-c38d-44ff-b22e-2cf6345186ab:c0, 39aab27a-937d-4d57-9e31-3229443b5129:c0]
2019-06-14 10:28:46,249 WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(276)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-16D10F23CC2F->99630a57-0e9f-428d-8086-37f49b9f2f2f@group-10CF7E7D22E2, cid=141, seq=1*, RW, org.apache.hadoop.hdds.scm.XceiverClientRatis$$Lambda$436/510793091@799f234d for 5 attempts with RetryLimited(maxAttempts=5, sleepTime=1000ms) on the pipeline Pipeline[ Id: 351ff53c-7f58-442d-962b-10cf7e7d22e2, Nodes: 39aab27a-937d-4d57-9e31-3229443b5129{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}99630a57-0e9f-428d-8086-37f49b9f2f2f{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}33efc1b5-c38d-44ff-b22e-2cf6345186ab{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]. The last committed block length is 0, uncommitted data length is 1572864 retry count 0
2019-06-14 10:28:46,252 WARN  block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(192)) - Pipeline creation failed for type:RATIS factor:THREE. Retrying get pipelines call once.
org.apache.hadoop.hdds.scm.pipeline.InsufficientDatanodesException: Cannot create pipeline of factor 3 using 1 nodes.
	at org.apache.hadoop.hdds.scm.pipeline.RatisPipelineProvider.create(RatisPipelineProvider.java:151)
	at org.apache.hadoop.hdds.scm.pipeline.PipelineFactory.create(PipelineFactory.java:57)
	at org.apache.hadoop.hdds.scm.pipeline.SCMPipelineManager.createPipeline(SCMPipelineManager.java:149)
	at org.apache.hadoop.hdds.scm.block.BlockManagerImpl.allocateBlock(BlockManagerImpl.java:190)
	at org.apache.hadoop.hdds.scm.server.SCMBlockProtocolServer.allocateBlock(SCMBlockProtocolServer.java:172)
	at org.apache.hadoop.ozone.protocolPB.ScmBlockLocationProtocolServerSideTranslatorPB.allocateScmBlock(ScmBlockLocationProtocolServerSideTranslatorPB.java:82)
	at org.apache.hadoop.hdds.protocol.proto.ScmBlockLocationProtocolProtos$ScmBlockLocationProtocolService$2.callBlockingMethod(ScmBlockLocationProtocolProtos.java:7533)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:524)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1025)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:876)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:822)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1730)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2682)
2019-06-14 10:28:46,253 INFO  block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(198)) - Could not find available pipeline of type:RATIS and factor:THREE even after retrying
2019-06-14 10:28:46,254 ERROR block.BlockManagerImpl (BlockManagerImpl.java:allocateBlock(222)) - Unable to allocate a block for the size: 4194304, type: RATIS, factor: THREE
10:28:46.254 [IPC Server handler 0 on 32923] ERROR OMAudit - user=root | ip=127.0.0.1 | op=ALLOCATE_BLOCK {volume=datanodefailurehandlingtest, bucket=datanodefailurehandlingtest, key=2155720a-cc02-46d0-8c4c-b26967f7ac3d, dataSize=0, replicationType=null, replicationFactor=null, keyLocationInfo=null, clientID=102269459895287825} | ret=FAILURE
java.io.IOException: Allocate block failed.
	at org.apache.hadoop.hdds.scm.protocolPB.ScmBlockLocationProtocolClientSideTranslatorPB.allocateBlock(ScmBlockLocationProtocolClientSideTranslatorPB.java:111) ~[hadoop-hdds-common-0.5.0-SNAPSHOT.jar:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_212]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_212]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_212]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_212]
	at org.apache.hadoop.hdds.tracing.TraceAllMethod.invoke(TraceAllMethod.java:66) ~[hadoop-hdds-common-0.5.0-SNAPSHOT.jar:?]
	at com.sun.proxy.$Proxy25.allocateBlock(Unknown Source) ~[?:?]
	at org.apache.hadoop.ozone.om.KeyManagerImpl.allocateBlock(KeyManagerImpl.java:347) ~[hadoop-ozone-ozone-manager-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.om.KeyManagerImpl.allocateBlock(KeyManagerImpl.java:315) ~[hadoop-ozone-ozone-manager-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.om.OzoneManager.allocateBlock(OzoneManager.java:2301) [hadoop-ozone-ozone-manager-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.protocolPB.OzoneManagerRequestHandler.allocateBlock(OzoneManagerRequestHandler.java:755) [hadoop-ozone-ozone-manager-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.protocolPB.OzoneManagerRequestHandler.handle(OzoneManagerRequestHandler.java:249) [hadoop-ozone-ozone-manager-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.protocolPB.OzoneManagerProtocolServerSideTranslatorPB.submitRequestDirectlyToOM(OzoneManagerProtocolServerSideTranslatorPB.java:180) [hadoop-ozone-ozone-manager-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.protocolPB.OzoneManagerProtocolServerSideTranslatorPB.submitRequest(OzoneManagerProtocolServerSideTranslatorPB.java:102) [hadoop-ozone-ozone-manager-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ozone.protocol.proto.OzoneManagerProtocolProtos$OzoneManagerService$2.callBlockingMethod(OzoneManagerProtocolProtos.java) [hadoop-ozone-common-0.5.0-SNAPSHOT.jar:?]
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:524) [hadoop-common-3.2.0.jar:?]
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:1025) [hadoop-common-3.2.0.jar:?]
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:876) [hadoop-common-3.2.0.jar:?]
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:822) [hadoop-common-3.2.0.jar:?]
	at java.security.AccessController.doPrivileged(Native Method) [?:1.8.0_212]
	at javax.security.auth.Subject.doAs(Subject.java:422) [?:1.8.0_212]
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1730) [hadoop-common-3.2.0.jar:?]
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2682) [hadoop-common-3.2.0.jar:?]
2019-06-14 10:28:46,255 ERROR io.BlockOutputStreamEntryPool (BlockOutputStreamEntryPool.java:allocateBlockIfNeeded(299)) - Try to allocate more blocks for write failed, already allocated 0 blocks for this write.
INTERNAL_ERROR org.apache.hadoop.ozone.om.exceptions.OMException: Allocate block failed.
	at org.apache.hadoop.ozone.om.protocolPB.OzoneManagerProtocolClientSideTranslatorPB.handleError(OzoneManagerProtocolClientSideTranslatorPB.java:720)
	at org.apache.hadoop.ozone.om.protocolPB.OzoneManagerProtocolClientSideTranslatorPB.allocateBlock(OzoneManagerProtocolClientSideTranslatorPB.java:743)
	at org.apache.hadoop.ozone.client.io.BlockOutputStreamEntryPool.allocateNewBlock(BlockOutputStreamEntryPool.java:248)
	at org.apache.hadoop.ozone.client.io.BlockOutputStreamEntryPool.allocateBlockIfNeeded(BlockOutputStreamEntryPool.java:296)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleWrite(KeyOutputStream.java:201)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleRetry(KeyOutputStream.java:376)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleException(KeyOutputStream.java:325)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleFlushOrClose(KeyOutputStream.java:448)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.close(KeyOutputStream.java:472)
	at org.apache.hadoop.ozone.client.io.OzoneOutputStream.close(OzoneOutputStream.java:60)
	at org.apache.hadoop.ozone.client.rpc.TestFailureHandlingByClient.testBlockWritesWithDnFailures(TestFailureHandlingByClient.java:146)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2019-06-14 10:28:46,270 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:46,273 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:46,274 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:46,274 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedBlocks
2019-06-14 10:28:46,274 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedBlocks
2019-06-14 10:28:46,274 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: validCerts
2019-06-14 10:28:46,274 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:validCerts
2019-06-14 10:28:46,274 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: revokedCerts
2019-06-14 10:28:46,274 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:revokedCerts
2019-06-14 10:28:46,275 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-14 10:28:46,275 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-14 10:28:46,275 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-14 10:28:46,314 INFO  node.SCMNodeManager (SCMNodeManager.java:<init>(108)) - Entering startup safe mode.
2019-06-14 10:28:46,314 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(125)) - Loading file from sun.misc.CompoundEnumeration@2257590f
2019-06-14 10:28:46,315 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(171)) - Loading network topology layer schema file
2019-06-14 10:28:46,317 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:46,329 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:initializePipelineState(126)) - No pipeline exists in current db
2019-06-14 10:28:46,330 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:46,343 WARN  events.EventQueue (EventQueue.java:fireEvent(175)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='SafeModeStatus'}
2019-06-14 10:28:46,344 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:28:46,344 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 40791
2019-06-14 10:28:46,347 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:28:46,347 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 41119
2019-06-14 10:28:46,348 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:28:46,349 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 35791
2019-06-14 10:28:46,351 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for scm at: http://0.0.0.0:0
2019-06-14 10:28:46,352 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:28:46,352 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:28:46,353 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:28:46,354 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context scm
2019-06-14 10:28:46,354 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:28:46,354 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:28:46,356 INFO  server.StorageContainerManager (StorageContainerManager.java:start(752)) - StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:35791
2019-06-14 10:28:46,356 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - StorageContainerManager metrics system started (again)
2019-06-14 10:28:46,356 INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:start(149)) - RPC server for Client  is listening at /0.0.0.0:35791
2019-06-14 10:28:46,357 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:28:46,357 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 35791: starting
2019-06-14 10:28:46,361 INFO  server.StorageContainerManager (StorageContainerManager.java:start(761)) - ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:41119
2019-06-14 10:28:46,361 INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:start(137)) - RPC server for Block Protocol is listening at /0.0.0.0:41119
2019-06-14 10:28:46,361 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:28:46,361 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 41119: starting
2019-06-14 10:28:46,374 INFO  server.StorageContainerManager (StorageContainerManager.java:start(765)) - ScmDatanodeProtocl RPC server is listening at /0.0.0.0:40791
2019-06-14 10:28:46,374 INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:start(191)) - RPC server for DataNodes is listening at /0.0.0.0:40791
2019-06-14 10:28:46,374 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:28:46,374 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 40791: starting
2019-06-14 10:28:46,380 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 39501
2019-06-14 10:28:46,380 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:28:46,381 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@506d7fed{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:28:46,381 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@381d7c4c{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-14 10:28:46,383 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@7695184b{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/scm/,AVAILABLE}{/scm}
2019-06-14 10:28:46,384 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@29390110{HTTP/1.1,[http/1.1]}{0.0.0.0:39501}
2019-06-14 10:28:46,385 INFO  server.Server (Server.java:doStart(419)) - Started @91644ms
2019-06-14 10:28:46,386 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of SCM is listening at http://0.0.0.0:39501
2019-06-14 10:28:46,390 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:46,390 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:28:46,392 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:46,392 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(519)) - OM Service ID is not set. Setting it to the default ID: omServiceIdDefault
2019-06-14 10:28:46,392 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(525)) - OM Node ID is not set. Setting it to the OmStorage's OmID: 6511d95b-4856-4ff7-a701-b7a591df3ba3
2019-06-14 10:28:46,393 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 10:28:46,393 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 10:28:46,393 INFO  om.OzoneManager (OzoneManager.java:loadOMHAConfigs(476)) - Found matching OM address with OMServiceId: null, OMNodeId: null, RPC Address: localhost:0 and Ratis port: 9872
2019-06-14 10:28:46,398 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:46,398 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: userTable
2019-06-14 10:28:46,398 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:userTable
2019-06-14 10:28:46,398 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: volumeTable
2019-06-14 10:28:46,399 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:volumeTable
2019-06-14 10:28:46,399 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: bucketTable
2019-06-14 10:28:46,399 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:bucketTable
2019-06-14 10:28:46,399 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: keyTable
2019-06-14 10:28:46,399 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:keyTable
2019-06-14 10:28:46,399 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedTable
2019-06-14 10:28:46,399 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedTable
2019-06-14 10:28:46,399 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: openKeyTable
2019-06-14 10:28:46,400 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:openKeyTable
2019-06-14 10:28:46,400 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3Table
2019-06-14 10:28:46,400 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3Table
2019-06-14 10:28:46,400 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: multipartInfoTable
2019-06-14 10:28:46,400 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:multipartInfoTable
2019-06-14 10:28:46,400 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: dTokenTable
2019-06-14 10:28:46,400 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:dTokenTable
2019-06-14 10:28:46,400 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3SecretTable
2019-06-14 10:28:46,400 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3SecretTable
2019-06-14 10:28:46,401 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: prefixTable
2019-06-14 10:28:46,401 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:prefixTable
2019-06-14 10:28:46,401 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-14 10:28:46,401 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-14 10:28:46,401 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-14 10:28:46,551 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:28:46,552 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 44499
2019-06-14 10:28:46,568 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:28:46,568 INFO  om.OzoneManager (OzoneManager.java:start(1217)) - OzoneManager RPC server is listening at localhost/127.0.0.1:44499
2019-06-14 10:28:46,569 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - OzoneManager metrics system started (again)
2019-06-14 10:28:46,569 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:28:46,574 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 44499: starting
2019-06-14 10:28:46,582 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for ozoneManager at: http://0.0.0.0:0
2019-06-14 10:28:46,583 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:28:46,583 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:28:46,584 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:28:46,585 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context ozoneManager
2019-06-14 10:28:46,585 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:28:46,585 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:28:46,585 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 44951
2019-06-14 10:28:46,585 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:28:46,586 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@33ef393a{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:28:46,587 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@1ebcfcf1{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-14 10:28:46,589 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@147203c2{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/ozoneManager/,AVAILABLE}{/ozoneManager}
2019-06-14 10:28:46,589 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@11df0bc7{HTTP/1.1,[http/1.1]}{0.0.0.0:44951}
2019-06-14 10:28:46,591 INFO  server.Server (Server.java:doStart(419)) - Started @91850ms
2019-06-14 10:28:46,592 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of OZONEMANAGER is listening at http://0.0.0.0:44951
2019-06-14 10:28:46,600 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:28:46,600 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:28:46,607 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-0/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:28:46,607 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-0/data/containers/hdds to VolumeSet
2019-06-14 10:28:46,607 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@7308d133
2019-06-14 10:28:46,609 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@7308d133
2019-06-14 10:28:46,620 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 40855
2019-06-14 10:28:46,622 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:28:46,622 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 40855 (custom)
2019-06-14 10:28:46,622 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:28:46,622 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:46,623 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:28:46,623 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:46,623 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-0/data/ratis] (custom)
2019-06-14 10:28:46,623 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 33069
2019-06-14 10:28:46,624 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:28:46,624 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:28:46,625 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:28:46,626 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:28:46,627 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:28:46,627 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:28:46,627 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:28:46,627 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:28:46,627 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 46239
2019-06-14 10:28:46,628 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:28:46,629 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@5edd2170{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:28:46,629 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@32db94fb{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:28:46,641 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1040, electionTimeout:1040ms
2019-06-14 10:28:46,641 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:28:46,641 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 9 for changeToCandidate
2019-06-14 10:28:46,641 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:28:46,645 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection66: begin an election at term 10 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:46,646 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection66 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:46,651 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection66 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:46,657 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection66: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t10, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:46,657 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:46,658 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:46,658 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 10 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:46,658 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:28:46,658 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:28:46,667 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@18a538a0{/,file:///tmp/jetty-0.0.0.0-46239-hddsDatanode-_-any-8732254301810532390.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:28:46,668 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@70736b19{HTTP/1.1,[http/1.1]}{0.0.0.0:46239}
2019-06-14 10:28:46,669 INFO  server.Server (Server.java:doStart(419)) - Started @91928ms
2019-06-14 10:28:46,670 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:46239
Jun 14, 2019 10:28:46 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:28:46,813 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@33aa4326
2019-06-14 10:28:46,813 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:28:46,814 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:28:46,834 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-0/meta/datanode.id
2019-06-14 10:28:46,839 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:28:46,839 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-1/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:28:46,839 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-1/data/containers/hdds to VolumeSet
2019-06-14 10:28:46,839 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@2e5ff1d4
2019-06-14 10:28:46,840 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@2e5ff1d4
2019-06-14 10:28:46,849 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43553
2019-06-14 10:28:46,852 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:28:46,852 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43553 (custom)
2019-06-14 10:28:46,852 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:28:46,853 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:46,853 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:28:46,853 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:46,853 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-1/data/ratis] (custom)
2019-06-14 10:28:46,854 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 34557
2019-06-14 10:28:46,854 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:28:46,855 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:28:46,856 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:28:46,856 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:28:46,857 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:28:46,858 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:28:46,858 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:28:46,858 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:28:46,859 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 44695
2019-06-14 10:28:46,859 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:28:46,870 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@7ae97a58{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:28:46,870 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@67544105{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:28:46,892 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@457dc809{/,file:///tmp/jetty-0.0.0.0-44695-hddsDatanode-_-any-7354110459545888722.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:28:46,893 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@5687ba39{HTTP/1.1,[http/1.1]}{0.0.0.0:44695}
2019-06-14 10:28:46,894 INFO  server.Server (Server.java:doStart(419)) - Started @92153ms
2019-06-14 10:28:46,895 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:44695
Jun 14, 2019 10:28:46 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:28:46,984 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@62f63625
2019-06-14 10:28:46,984 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:28:46,984 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:28:47,007 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-2/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:28:47,007 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-2/data/containers/hdds to VolumeSet
2019-06-14 10:28:47,008 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3509f32d
2019-06-14 10:28:47,017 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:28:47,018 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3509f32d
2019-06-14 10:28:47,018 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-1/meta/datanode.id
2019-06-14 10:28:47,029 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 32777
2019-06-14 10:28:47,032 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:28:47,032 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 32777 (custom)
2019-06-14 10:28:47,032 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:28:47,032 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:47,032 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:28:47,033 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:47,033 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-2/data/ratis] (custom)
2019-06-14 10:28:47,033 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 33761
2019-06-14 10:28:47,034 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:28:47,035 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:28:47,036 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:28:47,036 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:28:47,037 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:28:47,037 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:28:47,037 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:28:47,038 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:28:47,038 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 42589
2019-06-14 10:28:47,038 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:28:47,039 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@7b8b755d{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:28:47,039 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@6df605f{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:28:47,060 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@73418044{/,file:///tmp/jetty-0.0.0.0-42589-hddsDatanode-_-any-5841910933729616145.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:28:47,060 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@58ec04f4{HTTP/1.1,[http/1.1]}{0.0.0.0:42589}
2019-06-14 10:28:47,060 INFO  server.Server (Server.java:doStart(419)) - Started @92319ms
2019-06-14 10:28:47,063 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:42589
Jun 14, 2019 10:28:47 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:28:47,146 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@38a3c078
2019-06-14 10:28:47,146 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:28:47,146 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:28:47,154 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:28:47,156 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-2/meta/datanode.id
2019-06-14 10:28:47,159 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-3/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:28:47,159 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-3/data/containers/hdds to VolumeSet
2019-06-14 10:28:47,159 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@5481001f
2019-06-14 10:28:47,160 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@5481001f
2019-06-14 10:28:47,170 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 46725
2019-06-14 10:28:47,172 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:28:47,172 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 46725 (custom)
2019-06-14 10:28:47,173 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:28:47,173 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:47,173 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:28:47,173 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:47,173 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-3/data/ratis] (custom)
2019-06-14 10:28:47,173 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 38197
2019-06-14 10:28:47,174 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:28:47,175 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:28:47,175 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:28:47,177 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:28:47,178 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:28:47,179 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:28:47,179 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:28:47,179 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:28:47,179 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 35903
2019-06-14 10:28:47,179 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:28:47,181 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@2620264e{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:28:47,181 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@59e24c62{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:28:47,202 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@60052518{/,file:///tmp/jetty-0.0.0.0-35903-hddsDatanode-_-any-6173979714267034110.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:28:47,202 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@39336f5{HTTP/1.1,[http/1.1]}{0.0.0.0:35903}
2019-06-14 10:28:47,204 INFO  server.Server (Server.java:doStart(419)) - Started @92463ms
2019-06-14 10:28:47,205 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:35903
Jun 14, 2019 10:28:47 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:28:47,285 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@59cc46a4
2019-06-14 10:28:47,285 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:28:47,285 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:28:47,292 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:28:47,293 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-3/meta/datanode.id
2019-06-14 10:28:47,298 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-4/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:28:47,298 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-4/data/containers/hdds to VolumeSet
2019-06-14 10:28:47,298 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1aaa3406
2019-06-14 10:28:47,298 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1aaa3406
2019-06-14 10:28:47,306 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 34583
2019-06-14 10:28:47,308 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:28:47,308 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 34583 (custom)
2019-06-14 10:28:47,308 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:28:47,308 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:47,309 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:28:47,309 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:47,309 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-4/data/ratis] (custom)
2019-06-14 10:28:47,309 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 35883
2019-06-14 10:28:47,310 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:28:47,310 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:28:47,311 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:28:47,312 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:28:47,313 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:28:47,313 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:28:47,313 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:28:47,313 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:28:47,314 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 36049
2019-06-14 10:28:47,314 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:28:47,315 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@6acdca3a{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:28:47,315 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@45bb502f{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:28:47,336 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@772db1d8{/,file:///tmp/jetty-0.0.0.0-36049-hddsDatanode-_-any-8109307790337468821.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:28:47,336 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@7955b4d4{HTTP/1.1,[http/1.1]}{0.0.0.0:36049}
2019-06-14 10:28:47,338 INFO  server.Server (Server.java:doStart(419)) - Started @92596ms
2019-06-14 10:28:47,338 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:36049
Jun 14, 2019 10:28:47 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:28:47,464 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@524945e2
2019-06-14 10:28:47,464 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:28:47,465 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:28:47,465 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:28:47,466 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-4/meta/datanode.id
2019-06-14 10:28:47,471 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-5/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:28:47,471 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-5/data/containers/hdds to VolumeSet
2019-06-14 10:28:47,471 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@378456cb
2019-06-14 10:28:47,472 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@378456cb
2019-06-14 10:28:47,482 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 38905
2019-06-14 10:28:47,484 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:28:47,484 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 38905 (custom)
2019-06-14 10:28:47,484 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:28:47,484 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:47,484 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:28:47,485 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:47,485 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-5/data/ratis] (custom)
2019-06-14 10:28:47,485 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 37237
2019-06-14 10:28:47,485 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:28:47,518 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:28:47,519 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:28:47,519 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:28:47,520 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:28:47,520 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:28:47,520 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:28:47,520 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:28:47,521 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 38627
2019-06-14 10:28:47,521 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:28:47,522 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@70c68e4e{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:28:47,522 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@21a14c45{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:28:47,543 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@644eed73{/,file:///tmp/jetty-0.0.0.0-38627-hddsDatanode-_-any-254000520253761718.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:28:47,543 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@253a8bdb{HTTP/1.1,[http/1.1]}{0.0.0.0:38627}
2019-06-14 10:28:47,545 INFO  server.Server (Server.java:doStart(419)) - Started @92804ms
2019-06-14 10:28:47,546 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:38627
Jun 14, 2019 10:28:47 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:28:47,624 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@5c6fae3c
2019-06-14 10:28:47,624 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:28:47,625 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:28:47,625 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-5/meta/datanode.id
2019-06-14 10:28:47,727 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1069, electionTimeout:1069ms
2019-06-14 10:28:47,727 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:28:47,727 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 10 for changeToCandidate
2019-06-14 10:28:47,727 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:28:47,731 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection67: begin an election at term 11 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:47,731 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection67 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:47,733 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection67 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:47,740 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection67: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t11, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:47,740 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:47,740 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:47,741 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 11 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:47,741 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:28:47,741 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:28:48,624 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:28:48,788 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1047, electionTimeout:1047ms
2019-06-14 10:28:48,788 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:28:48,788 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 11 for changeToCandidate
2019-06-14 10:28:48,788 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:28:48,791 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection68: begin an election at term 12 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:48,792 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection68 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:48,794 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection68 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:48,797 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection68: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t12, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:48,797 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:48,797 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:48,797 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 12 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:48,797 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:28:48,797 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:28:48,840 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:28:48,840 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:28:48,840 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 0d8fdae0-3e0d-40b6-816c-aada8c2992e3 at port 40855
2019-06-14 10:28:48,844 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: start RPC server
2019-06-14 10:28:48,844 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: GrpcService started, listening on 0.0.0.0/0.0.0.0:40855
2019-06-14 10:28:49,025 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:28:49,025 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:28:49,026 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 793ef3ef-a4eb-4c1a-81b0-b17333f477df at port 43553
2019-06-14 10:28:49,030 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: start RPC server
2019-06-14 10:28:49,030 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: GrpcService started, listening on 0.0.0.0/0.0.0.0:43553
2019-06-14 10:28:49,156 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:28:49,156 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:28:49,156 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 694b9f93-ca67-4b25-b4b9-1a111abba6f5 at port 32777
2019-06-14 10:28:49,159 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: start RPC server
2019-06-14 10:28:49,160 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: GrpcService started, listening on 0.0.0.0/0.0.0.0:32777
2019-06-14 10:28:49,294 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:28:49,294 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:28:49,294 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d at port 46725
2019-06-14 10:28:49,298 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: start RPC server
2019-06-14 10:28:49,298 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: GrpcService started, listening on 0.0.0.0/0.0.0.0:46725
2019-06-14 10:28:49,468 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:28:49,468 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:28:49,468 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 65d9d079-0999-40a1-a2b6-fb43c5122fca at port 34583
2019-06-14 10:28:49,472 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: start RPC server
2019-06-14 10:28:49,472 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: GrpcService started, listening on 0.0.0.0/0.0.0.0:34583
2019-06-14 10:28:49,625 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:28:49,628 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:28:49,628 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:28:49,628 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 7ddba920-5051-41f0-be4c-b5425af80e17 at port 38905
2019-06-14 10:28:49,631 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 7ddba920-5051-41f0-be4c-b5425af80e17: start RPC server
2019-06-14 10:28:49,632 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 7ddba920-5051-41f0-be4c-b5425af80e17: GrpcService started, listening on 0.0.0.0/0.0.0.0:38905
2019-06-14 10:28:49,876 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1079, electionTimeout:1079ms
2019-06-14 10:28:49,877 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:28:49,877 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 12 for changeToCandidate
2019-06-14 10:28:49,877 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:28:49,879 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection69: begin an election at term 13 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:49,880 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection69 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:49,882 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection69 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:49,885 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection69: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t13, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:49,885 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:49,885 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:49,885 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 13 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:49,885 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:28:49,885 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:28:50,625 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:28:50,838 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 0d8fdae0-3e0d-40b6-816c-aada8c2992e3{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:28:50,842 INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 1 DataNodes registered, 1 required.
2019-06-14 10:28:50,852 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(177)) - ScmSafeModeManager, all rules are successfully validated
2019-06-14 10:28:50,852 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:exitSafeMode(193)) - SCM exiting safe mode.
Jun 14, 2019 10:28:50 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=1173, target=192.168.46.40:38747} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequestAsync(GrpcClientRpc.java:66)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequestAsync(RaftClientImpl.java:351)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequestWithRetryAsync(RaftClientImpl.java:313)
	at org.apache.ratis.util.SlidingWindow$Client.sendOrDelayRequest(SlidingWindow.java:251)
	at org.apache.ratis.util.SlidingWindow$Client.retry(SlidingWindow.java:267)
	at org.apache.ratis.client.impl.RaftClientImpl.lambda$null$10(RaftClientImpl.java:320)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$0(TimeoutScheduler.java:85)
	at org.apache.ratis.util.TimeoutScheduler.lambda$onTimeout$1(TimeoutScheduler.java:104)
	at org.apache.ratis.util.LogUtils.runAndLog(LogUtils.java:50)
	at org.apache.ratis.util.LogUtils$1.run(LogUtils.java:91)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

2019-06-14 10:28:50,859 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: addNew group-5A6FFA4D5740:[0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855] returns group-5A6FFA4D5740:java.util.concurrent.CompletableFuture@6a33b986[Not completed]
2019-06-14 10:28:50,859 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: new RaftServerImpl for group-5A6FFA4D5740:[0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855] with ContainerStateMachine:uninitialized
2019-06-14 10:28:50,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:50,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:50,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:50,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:50,860 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:group-5A6FFA4D5740 ConfigurationManager, init=-1: [0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:50,860 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-0/data/ratis] (custom)
2019-06-14 10:28:50,860 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-0/data/ratis/d590690f-7e16-4545-8e40-5a6ffa4d5740 does not exist. Creating ...
2019-06-14 10:28:50,862 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-0/data/ratis/d590690f-7e16-4545-8e40-5a6ffa4d5740/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:50,864 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-0/data/ratis/d590690f-7e16-4545-8e40-5a6ffa4d5740 has been successfully formatted.
2019-06-14 10:28:50,864 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:50,864 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:50,864 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:50,864 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:50,864 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:50,865 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:50,865 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 0d8fdae0-3e0d-40b6-816c-aada8c2992e3-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-0/data/ratis/d590690f-7e16-4545-8e40-5a6ffa4d5740
2019-06-14 10:28:50,865 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:50,865 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:50,865 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:50,865 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:50,865 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:50,865 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:50,865 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:50,865 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:50,865 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:50,865 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:50,866 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:50,866 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:50,866 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:50,866 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: start group-5A6FFA4D5740
2019-06-14 10:28:50,866 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:group-5A6FFA4D5740 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:50,866 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: start FollowerState
2019-06-14 10:28:50,866 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-5A6FFA4D5740,id=0d8fdae0-3e0d-40b6-816c-aada8c2992e3
2019-06-14 10:28:50,868 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: d590690f-7e16-4545-8e40-5a6ffa4d5740, Nodes: 0d8fdae0-3e0d-40b6-816c-aada8c2992e3{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:28:50,907 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1022, electionTimeout:1022ms
2019-06-14 10:28:50,907 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:28:50,908 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 13 for changeToCandidate
2019-06-14 10:28:50,908 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:28:50,910 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection70: begin an election at term 14 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:50,913 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection70 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:50,915 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection70 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:50,918 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection70: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t14, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:50,918 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:50,918 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:50,918 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 14 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:50,918 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:28:50,918 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:28:51,018 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 793ef3ef-a4eb-4c1a-81b0-b17333f477df{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:28:51,024 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: addNew group-442819AA78CB:[793ef3ef-a4eb-4c1a-81b0-b17333f477df:192.168.46.40:43553] returns group-442819AA78CB:java.util.concurrent.CompletableFuture@d4d5747[Not completed]
2019-06-14 10:28:51,024 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: new RaftServerImpl for group-442819AA78CB:[793ef3ef-a4eb-4c1a-81b0-b17333f477df:192.168.46.40:43553] with ContainerStateMachine:uninitialized
2019-06-14 10:28:51,025 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:51,025 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:51,025 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:51,025 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:51,025 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df:group-442819AA78CB ConfigurationManager, init=-1: [793ef3ef-a4eb-4c1a-81b0-b17333f477df:192.168.46.40:43553], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:51,025 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-1/data/ratis] (custom)
2019-06-14 10:28:51,025 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-1/data/ratis/f9ee85c7-d098-4280-a7a3-442819aa78cb does not exist. Creating ...
2019-06-14 10:28:51,027 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-1/data/ratis/f9ee85c7-d098-4280-a7a3-442819aa78cb/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:51,029 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-1/data/ratis/f9ee85c7-d098-4280-a7a3-442819aa78cb has been successfully formatted.
2019-06-14 10:28:51,029 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:51,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:51,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:51,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:51,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:51,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:51,030 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 793ef3ef-a4eb-4c1a-81b0-b17333f477df-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-1/data/ratis/f9ee85c7-d098-4280-a7a3-442819aa78cb
2019-06-14 10:28:51,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:51,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:51,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:51,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:51,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:51,031 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:51,031 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:51,031 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:51,031 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:51,031 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:51,031 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:51,031 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:51,031 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:51,032 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: start group-442819AA78CB
2019-06-14 10:28:51,032 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df:group-442819AA78CB changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:51,032 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: start FollowerState
2019-06-14 10:28:51,032 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-442819AA78CB,id=793ef3ef-a4eb-4c1a-81b0-b17333f477df
2019-06-14 10:28:51,033 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: f9ee85c7-d098-4280-a7a3-442819aa78cb, Nodes: 793ef3ef-a4eb-4c1a-81b0-b17333f477df{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:28:51,154 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 694b9f93-ca67-4b25-b4b9-1a111abba6f5{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:28:51,160 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: addNew group-F932B8E7D716:[694b9f93-ca67-4b25-b4b9-1a111abba6f5:192.168.46.40:32777] returns group-F932B8E7D716:java.util.concurrent.CompletableFuture@3d52e3f6[Not completed]
2019-06-14 10:28:51,161 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: new RaftServerImpl for group-F932B8E7D716:[694b9f93-ca67-4b25-b4b9-1a111abba6f5:192.168.46.40:32777] with ContainerStateMachine:uninitialized
2019-06-14 10:28:51,161 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:51,161 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:51,161 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:51,161 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:51,161 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5:group-F932B8E7D716 ConfigurationManager, init=-1: [694b9f93-ca67-4b25-b4b9-1a111abba6f5:192.168.46.40:32777], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:51,161 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-2/data/ratis] (custom)
2019-06-14 10:28:51,161 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-2/data/ratis/e0c27f47-7149-406b-9fd9-f932b8e7d716 does not exist. Creating ...
2019-06-14 10:28:51,163 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-2/data/ratis/e0c27f47-7149-406b-9fd9-f932b8e7d716/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:51,165 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-2/data/ratis/e0c27f47-7149-406b-9fd9-f932b8e7d716 has been successfully formatted.
2019-06-14 10:28:51,165 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:51,165 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:51,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:51,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:51,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:51,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:51,166 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 694b9f93-ca67-4b25-b4b9-1a111abba6f5-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-2/data/ratis/e0c27f47-7149-406b-9fd9-f932b8e7d716
2019-06-14 10:28:51,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:51,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:51,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:51,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:51,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:51,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:51,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:51,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:51,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:51,167 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:51,167 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:51,167 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:51,167 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:51,167 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: start group-F932B8E7D716
2019-06-14 10:28:51,167 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5:group-F932B8E7D716 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:51,167 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: start FollowerState
2019-06-14 10:28:51,167 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-F932B8E7D716,id=694b9f93-ca67-4b25-b4b9-1a111abba6f5
2019-06-14 10:28:51,170 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: e0c27f47-7149-406b-9fd9-f932b8e7d716, Nodes: 694b9f93-ca67-4b25-b4b9-1a111abba6f5{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:28:51,178 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: addNew group-F935C70EE4ED:[0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855, 694b9f93-ca67-4b25-b4b9-1a111abba6f5:192.168.46.40:32777, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:192.168.46.40:43553] returns group-F935C70EE4ED:java.util.concurrent.CompletableFuture@4e416447[Not completed]
2019-06-14 10:28:51,178 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: addNew group-F935C70EE4ED:[0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855, 694b9f93-ca67-4b25-b4b9-1a111abba6f5:192.168.46.40:32777, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:192.168.46.40:43553] returns group-F935C70EE4ED:java.util.concurrent.CompletableFuture@7fa2c0a[Not completed]
2019-06-14 10:28:51,178 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: new RaftServerImpl for group-F935C70EE4ED:[0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855, 694b9f93-ca67-4b25-b4b9-1a111abba6f5:192.168.46.40:32777, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:192.168.46.40:43553] with ContainerStateMachine:uninitialized
2019-06-14 10:28:51,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:51,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:51,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:51,178 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: new RaftServerImpl for group-F935C70EE4ED:[0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855, 694b9f93-ca67-4b25-b4b9-1a111abba6f5:192.168.46.40:32777, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:192.168.46.40:43553] with ContainerStateMachine:uninitialized
2019-06-14 10:28:51,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:51,179 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:51,179 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5:group-F935C70EE4ED ConfigurationManager, init=-1: [0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855, 694b9f93-ca67-4b25-b4b9-1a111abba6f5:192.168.46.40:32777, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:192.168.46.40:43553], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:51,179 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: addNew group-F935C70EE4ED:[0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855, 694b9f93-ca67-4b25-b4b9-1a111abba6f5:192.168.46.40:32777, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:192.168.46.40:43553] returns group-F935C70EE4ED:java.util.concurrent.CompletableFuture@5b79b677[Not completed]
2019-06-14 10:28:51,179 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: new RaftServerImpl for group-F935C70EE4ED:[0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855, 694b9f93-ca67-4b25-b4b9-1a111abba6f5:192.168.46.40:32777, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:192.168.46.40:43553] with ContainerStateMachine:uninitialized
2019-06-14 10:28:51,179 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:51,179 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:51,179 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:51,179 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:51,180 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df:group-F935C70EE4ED ConfigurationManager, init=-1: [0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855, 694b9f93-ca67-4b25-b4b9-1a111abba6f5:192.168.46.40:32777, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:192.168.46.40:43553], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:51,180 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-1/data/ratis] (custom)
2019-06-14 10:28:51,180 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-1/data/ratis/f946f4c3-c819-4356-8d0f-f935c70ee4ed does not exist. Creating ...
2019-06-14 10:28:51,179 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:51,179 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-2/data/ratis] (custom)
2019-06-14 10:28:51,180 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:51,180 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:51,180 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:group-F935C70EE4ED ConfigurationManager, init=-1: [0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855, 694b9f93-ca67-4b25-b4b9-1a111abba6f5:192.168.46.40:32777, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:192.168.46.40:43553], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:51,180 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-0/data/ratis] (custom)
2019-06-14 10:28:51,197 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-2/data/ratis/f946f4c3-c819-4356-8d0f-f935c70ee4ed does not exist. Creating ...
2019-06-14 10:28:51,197 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-0/data/ratis/f946f4c3-c819-4356-8d0f-f935c70ee4ed does not exist. Creating ...
2019-06-14 10:28:51,199 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-2/data/ratis/f946f4c3-c819-4356-8d0f-f935c70ee4ed/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:51,199 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-1/data/ratis/f946f4c3-c819-4356-8d0f-f935c70ee4ed/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:51,199 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-0/data/ratis/f946f4c3-c819-4356-8d0f-f935c70ee4ed/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:51,201 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-0/data/ratis/f946f4c3-c819-4356-8d0f-f935c70ee4ed has been successfully formatted.
2019-06-14 10:28:51,201 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-1/data/ratis/f946f4c3-c819-4356-8d0f-f935c70ee4ed has been successfully formatted.
2019-06-14 10:28:51,201 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:51,201 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:51,201 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:51,202 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-2/data/ratis/f946f4c3-c819-4356-8d0f-f935c70ee4ed has been successfully formatted.
2019-06-14 10:28:51,202 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:51,202 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:51,202 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:51,202 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:51,202 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:51,202 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:51,202 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:51,202 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:51,202 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:51,202 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:51,202 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:51,202 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:51,202 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 694b9f93-ca67-4b25-b4b9-1a111abba6f5-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-2/data/ratis/f946f4c3-c819-4356-8d0f-f935c70ee4ed
2019-06-14 10:28:51,202 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:51,203 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:51,203 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:51,203 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:51,203 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:51,203 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 0d8fdae0-3e0d-40b6-816c-aada8c2992e3-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-0/data/ratis/f946f4c3-c819-4356-8d0f-f935c70ee4ed
2019-06-14 10:28:51,203 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:51,203 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:51,203 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:51,203 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:51,203 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:51,203 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 793ef3ef-a4eb-4c1a-81b0-b17333f477df-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-1/data/ratis/f946f4c3-c819-4356-8d0f-f935c70ee4ed
2019-06-14 10:28:51,203 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:51,203 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:51,204 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:51,204 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:51,204 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:51,204 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:51,204 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:51,204 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:51,204 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:51,204 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:51,204 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:51,204 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:51,204 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:51,204 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:51,205 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:51,204 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:51,205 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:51,205 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:51,205 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:51,205 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: start group-F935C70EE4ED
2019-06-14 10:28:51,205 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:group-F935C70EE4ED changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:51,205 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: start FollowerState
2019-06-14 10:28:51,204 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:51,205 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:51,206 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-F935C70EE4ED,id=0d8fdae0-3e0d-40b6-816c-aada8c2992e3
2019-06-14 10:28:51,206 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:51,206 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:51,206 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:51,206 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:51,206 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:51,206 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:51,207 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:51,207 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: start group-F935C70EE4ED
2019-06-14 10:28:51,207 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5:group-F935C70EE4ED changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:51,207 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: start FollowerState
2019-06-14 10:28:51,207 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:51,207 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-F935C70EE4ED,id=694b9f93-ca67-4b25-b4b9-1a111abba6f5
2019-06-14 10:28:51,208 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:51,208 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:51,209 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:51,209 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: start group-F935C70EE4ED
2019-06-14 10:28:51,209 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df:group-F935C70EE4ED changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:51,209 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: start FollowerState
2019-06-14 10:28:51,209 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-F935C70EE4ED,id=793ef3ef-a4eb-4c1a-81b0-b17333f477df
2019-06-14 10:28:51,210 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: f946f4c3-c819-4356-8d0f-f935c70ee4ed, Nodes: 0d8fdae0-3e0d-40b6-816c-aada8c2992e3{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}793ef3ef-a4eb-4c1a-81b0-b17333f477df{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}694b9f93-ca67-4b25-b4b9-1a111abba6f5{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-14 10:28:51,292 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:28:51,298 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: addNew group-28C872AAB53E:[7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:192.168.46.40:46725] returns group-28C872AAB53E:java.util.concurrent.CompletableFuture@257d4b15[Not completed]
2019-06-14 10:28:51,298 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: new RaftServerImpl for group-28C872AAB53E:[7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:192.168.46.40:46725] with ContainerStateMachine:uninitialized
2019-06-14 10:28:51,298 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:51,298 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:51,298 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:51,298 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:51,299 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:group-28C872AAB53E ConfigurationManager, init=-1: [7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:192.168.46.40:46725], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:51,299 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-3/data/ratis] (custom)
2019-06-14 10:28:51,299 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-3/data/ratis/ddcc1da9-9f43-41ac-b876-28c872aab53e does not exist. Creating ...
2019-06-14 10:28:51,301 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-3/data/ratis/ddcc1da9-9f43-41ac-b876-28c872aab53e/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:51,303 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-3/data/ratis/ddcc1da9-9f43-41ac-b876-28c872aab53e has been successfully formatted.
2019-06-14 10:28:51,303 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:51,304 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:51,304 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:51,304 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:51,304 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:51,304 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:51,304 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-3/data/ratis/ddcc1da9-9f43-41ac-b876-28c872aab53e
2019-06-14 10:28:51,304 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:51,304 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:51,304 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:51,304 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:51,305 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:51,305 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:51,305 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:51,305 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:51,305 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:51,305 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:51,305 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:51,305 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:51,306 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:51,306 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: start group-28C872AAB53E
2019-06-14 10:28:51,306 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:group-28C872AAB53E changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:51,306 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: start FollowerState
2019-06-14 10:28:51,306 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-28C872AAB53E,id=7cc2898f-b3fe-4ae1-83f6-f7d4837df60d
2019-06-14 10:28:51,308 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: ddcc1da9-9f43-41ac-b876-28c872aab53e, Nodes: 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:28:51,465 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 65d9d079-0999-40a1-a2b6-fb43c5122fca{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:28:51,476 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: addNew group-13B634533A3B:[65d9d079-0999-40a1-a2b6-fb43c5122fca:192.168.46.40:34583] returns group-13B634533A3B:java.util.concurrent.CompletableFuture@3b93dfa[Not completed]
2019-06-14 10:28:51,477 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: new RaftServerImpl for group-13B634533A3B:[65d9d079-0999-40a1-a2b6-fb43c5122fca:192.168.46.40:34583] with ContainerStateMachine:uninitialized
2019-06-14 10:28:51,477 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:51,477 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:51,477 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:51,477 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:51,477 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca:group-13B634533A3B ConfigurationManager, init=-1: [65d9d079-0999-40a1-a2b6-fb43c5122fca:192.168.46.40:34583], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:51,478 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-4/data/ratis] (custom)
2019-06-14 10:28:51,478 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-4/data/ratis/33ae1e6f-65c0-4331-b1eb-13b634533a3b does not exist. Creating ...
2019-06-14 10:28:51,480 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-4/data/ratis/33ae1e6f-65c0-4331-b1eb-13b634533a3b/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:51,482 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-4/data/ratis/33ae1e6f-65c0-4331-b1eb-13b634533a3b has been successfully formatted.
2019-06-14 10:28:51,482 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:51,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:51,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:51,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:51,483 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:51,483 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:51,483 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 65d9d079-0999-40a1-a2b6-fb43c5122fca-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-4/data/ratis/33ae1e6f-65c0-4331-b1eb-13b634533a3b
2019-06-14 10:28:51,483 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:51,483 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:51,483 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:51,483 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:51,483 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:51,483 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:51,483 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:51,484 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:51,484 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:51,484 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:51,484 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:51,484 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:51,484 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:51,484 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: start group-13B634533A3B
2019-06-14 10:28:51,485 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca:group-13B634533A3B changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:51,485 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: start FollowerState
2019-06-14 10:28:51,485 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-13B634533A3B,id=65d9d079-0999-40a1-a2b6-fb43c5122fca
2019-06-14 10:28:51,486 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 33ae1e6f-65c0-4331-b1eb-13b634533a3b, Nodes: 65d9d079-0999-40a1-a2b6-fb43c5122fca{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:28:51,625 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 5 of 6 DN Heartbeats.
2019-06-14 10:28:51,626 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 7ddba920-5051-41f0-be4c-b5425af80e17{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:28:51,636 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 7ddba920-5051-41f0-be4c-b5425af80e17: addNew group-D7FA8A9186B3:[7ddba920-5051-41f0-be4c-b5425af80e17:192.168.46.40:38905] returns group-D7FA8A9186B3:java.util.concurrent.CompletableFuture@7af634c2[Not completed]
2019-06-14 10:28:51,637 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 7ddba920-5051-41f0-be4c-b5425af80e17: new RaftServerImpl for group-D7FA8A9186B3:[7ddba920-5051-41f0-be4c-b5425af80e17:192.168.46.40:38905] with ContainerStateMachine:uninitialized
2019-06-14 10:28:51,637 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:51,637 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:51,637 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:51,637 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:51,637 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 7ddba920-5051-41f0-be4c-b5425af80e17:group-D7FA8A9186B3 ConfigurationManager, init=-1: [7ddba920-5051-41f0-be4c-b5425af80e17:192.168.46.40:38905], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:51,637 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-5/data/ratis] (custom)
2019-06-14 10:28:51,637 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-5/data/ratis/db5cc315-9e79-4e0a-a841-d7fa8a9186b3 does not exist. Creating ...
2019-06-14 10:28:51,639 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-5/data/ratis/db5cc315-9e79-4e0a-a841-d7fa8a9186b3/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:51,641 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-5/data/ratis/db5cc315-9e79-4e0a-a841-d7fa8a9186b3 has been successfully formatted.
2019-06-14 10:28:51,641 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:51,641 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:51,641 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:51,641 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:51,641 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:51,642 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:51,642 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 7ddba920-5051-41f0-be4c-b5425af80e17-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-5/data/ratis/db5cc315-9e79-4e0a-a841-d7fa8a9186b3
2019-06-14 10:28:51,642 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:51,642 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:51,642 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:51,642 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:51,642 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:51,642 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:51,642 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:51,642 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:51,642 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:51,642 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:51,643 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:51,643 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:51,643 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:51,643 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 7ddba920-5051-41f0-be4c-b5425af80e17: start group-D7FA8A9186B3
2019-06-14 10:28:51,643 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7ddba920-5051-41f0-be4c-b5425af80e17:group-D7FA8A9186B3 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:51,643 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7ddba920-5051-41f0-be4c-b5425af80e17: start FollowerState
2019-06-14 10:28:51,643 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D7FA8A9186B3,id=7ddba920-5051-41f0-be4c-b5425af80e17
2019-06-14 10:28:51,645 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: db5cc315-9e79-4e0a-a841-d7fa8a9186b3, Nodes: 7ddba920-5051-41f0-be4c-b5425af80e17{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:28:51,660 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: addNew group-2E24075FED16:[7ddba920-5051-41f0-be4c-b5425af80e17:192.168.46.40:38905, 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:192.168.46.40:46725, 65d9d079-0999-40a1-a2b6-fb43c5122fca:192.168.46.40:34583] returns group-2E24075FED16:java.util.concurrent.CompletableFuture@63b13dde[Not completed]
2019-06-14 10:28:51,660 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: new RaftServerImpl for group-2E24075FED16:[7ddba920-5051-41f0-be4c-b5425af80e17:192.168.46.40:38905, 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:192.168.46.40:46725, 65d9d079-0999-40a1-a2b6-fb43c5122fca:192.168.46.40:34583] with ContainerStateMachine:uninitialized
2019-06-14 10:28:51,660 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:51,660 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:51,660 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:51,660 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:51,661 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca:group-2E24075FED16 ConfigurationManager, init=-1: [7ddba920-5051-41f0-be4c-b5425af80e17:192.168.46.40:38905, 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:192.168.46.40:46725, 65d9d079-0999-40a1-a2b6-fb43c5122fca:192.168.46.40:34583], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:51,661 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-4/data/ratis] (custom)
2019-06-14 10:28:51,661 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-4/data/ratis/faea630d-5a8b-4ce4-abdf-2e24075fed16 does not exist. Creating ...
2019-06-14 10:28:51,663 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-4/data/ratis/faea630d-5a8b-4ce4-abdf-2e24075fed16/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:51,665 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-4/data/ratis/faea630d-5a8b-4ce4-abdf-2e24075fed16 has been successfully formatted.
2019-06-14 10:28:51,665 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:51,665 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:51,665 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:51,665 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:51,665 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:51,665 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:51,665 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 65d9d079-0999-40a1-a2b6-fb43c5122fca-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-4/data/ratis/faea630d-5a8b-4ce4-abdf-2e24075fed16
2019-06-14 10:28:51,665 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:51,665 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:51,665 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:51,666 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 7ddba920-5051-41f0-be4c-b5425af80e17: addNew group-2E24075FED16:[7ddba920-5051-41f0-be4c-b5425af80e17:192.168.46.40:38905, 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:192.168.46.40:46725, 65d9d079-0999-40a1-a2b6-fb43c5122fca:192.168.46.40:34583] returns group-2E24075FED16:java.util.concurrent.CompletableFuture@c38418f[Not completed]
2019-06-14 10:28:51,666 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: addNew group-2E24075FED16:[7ddba920-5051-41f0-be4c-b5425af80e17:192.168.46.40:38905, 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:192.168.46.40:46725, 65d9d079-0999-40a1-a2b6-fb43c5122fca:192.168.46.40:34583] returns group-2E24075FED16:java.util.concurrent.CompletableFuture@47a324ee[Not completed]
2019-06-14 10:28:51,666 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:51,666 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:51,666 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:51,666 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:51,666 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 7ddba920-5051-41f0-be4c-b5425af80e17: new RaftServerImpl for group-2E24075FED16:[7ddba920-5051-41f0-be4c-b5425af80e17:192.168.46.40:38905, 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:192.168.46.40:46725, 65d9d079-0999-40a1-a2b6-fb43c5122fca:192.168.46.40:34583] with ContainerStateMachine:uninitialized
2019-06-14 10:28:51,666 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: new RaftServerImpl for group-2E24075FED16:[7ddba920-5051-41f0-be4c-b5425af80e17:192.168.46.40:38905, 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:192.168.46.40:46725, 65d9d079-0999-40a1-a2b6-fb43c5122fca:192.168.46.40:34583] with ContainerStateMachine:uninitialized
2019-06-14 10:28:51,666 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:51,667 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:51,667 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:28:51,667 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:51,667 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:28:51,667 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:51,667 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:51,667 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 7ddba920-5051-41f0-be4c-b5425af80e17:group-2E24075FED16 ConfigurationManager, init=-1: [7ddba920-5051-41f0-be4c-b5425af80e17:192.168.46.40:38905, 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:192.168.46.40:46725, 65d9d079-0999-40a1-a2b6-fb43c5122fca:192.168.46.40:34583], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:51,667 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-5/data/ratis] (custom)
2019-06-14 10:28:51,668 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-5/data/ratis/faea630d-5a8b-4ce4-abdf-2e24075fed16 does not exist. Creating ...
2019-06-14 10:28:51,667 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:51,667 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:28:51,668 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:51,668 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:group-2E24075FED16 ConfigurationManager, init=-1: [7ddba920-5051-41f0-be4c-b5425af80e17:192.168.46.40:38905, 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:192.168.46.40:46725, 65d9d079-0999-40a1-a2b6-fb43c5122fca:192.168.46.40:34583], old=null, confs=<EMPTY_MAP>
2019-06-14 10:28:51,668 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-3/data/ratis] (custom)
2019-06-14 10:28:51,669 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-3/data/ratis/faea630d-5a8b-4ce4-abdf-2e24075fed16 does not exist. Creating ...
2019-06-14 10:28:51,669 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:51,669 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:51,669 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:51,669 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:51,670 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: start group-2E24075FED16
2019-06-14 10:28:51,670 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca:group-2E24075FED16 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:51,670 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: start FollowerState
2019-06-14 10:28:51,670 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-5/data/ratis/faea630d-5a8b-4ce4-abdf-2e24075fed16/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:51,670 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-2E24075FED16,id=65d9d079-0999-40a1-a2b6-fb43c5122fca
2019-06-14 10:28:51,671 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-3/data/ratis/faea630d-5a8b-4ce4-abdf-2e24075fed16/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:28:51,673 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-5/data/ratis/faea630d-5a8b-4ce4-abdf-2e24075fed16 has been successfully formatted.
2019-06-14 10:28:51,673 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:51,673 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:51,673 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:51,673 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:51,673 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:51,673 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:51,673 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 7ddba920-5051-41f0-be4c-b5425af80e17-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-5/data/ratis/faea630d-5a8b-4ce4-abdf-2e24075fed16
2019-06-14 10:28:51,673 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:51,673 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:51,673 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:51,674 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:51,674 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:51,674 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:51,674 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-3/data/ratis/faea630d-5a8b-4ce4-abdf-2e24075fed16 has been successfully formatted.
2019-06-14 10:28:51,674 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:51,674 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:28:51,674 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:51,674 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:51,674 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:28:51,674 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:51,674 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:28:51,674 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:51,674 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:51,674 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:51,675 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:28:51,675 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:51,675 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-3/data/ratis/faea630d-5a8b-4ce4-abdf-2e24075fed16
2019-06-14 10:28:51,675 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:51,675 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 7ddba920-5051-41f0-be4c-b5425af80e17: start group-2E24075FED16
2019-06-14 10:28:51,675 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7ddba920-5051-41f0-be4c-b5425af80e17:group-2E24075FED16 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:51,675 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7ddba920-5051-41f0-be4c-b5425af80e17: start FollowerState
2019-06-14 10:28:51,675 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:28:51,675 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:28:51,676 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:28:51,676 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:28:51,676 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:28:51,676 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:28:51,676 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:28:51,676 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:28:51,676 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:28:51,676 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:28:51,676 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-2E24075FED16,id=7ddba920-5051-41f0-be4c-b5425af80e17
2019-06-14 10:28:51,676 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:28:51,677 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:28:51,677 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:28:51,677 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: start group-2E24075FED16
2019-06-14 10:28:51,677 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:group-2E24075FED16 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:28:51,677 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: start FollowerState
2019-06-14 10:28:51,677 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-2E24075FED16,id=7cc2898f-b3fe-4ae1-83f6-f7d4837df60d
2019-06-14 10:28:51,679 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: faea630d-5a8b-4ce4-abdf-2e24075fed16, Nodes: 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}65d9d079-0999-40a1-a2b6-fb43c5122fca{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}7ddba920-5051-41f0-be4c-b5425af80e17{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-14 10:28:51,924 INFO  impl.FollowerState (FollowerState.java:run(101)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:group-5A6FFA4D5740 changes to CANDIDATE, lastRpcTime:1057, electionTimeout:1057ms
2019-06-14 10:28:51,924 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: shutdown FollowerState
2019-06-14 10:28:51,924 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:group-5A6FFA4D5740 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:51,924 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: start LeaderElection
2019-06-14 10:28:51,927 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:group-5A6FFA4D5740:LeaderElection71: begin an election at term 1 for -1: [0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855], old=null
2019-06-14 10:28:51,927 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: shutdown LeaderElection
2019-06-14 10:28:51,927 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:group-5A6FFA4D5740 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:28:51,927 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:group-5A6FFA4D5740 change Leader from null to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3 at term 1 for becomeLeader, leader elected after 1062ms
2019-06-14 10:28:51,927 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:51,927 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:51,927 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:51,927 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:51,927 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: start LeaderState
2019-06-14 10:28:51,927 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:51,928 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:group-5A6FFA4D5740 set configuration 0: [0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855], old=null at 0
2019-06-14 10:28:51,964 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-0/data/ratis/d590690f-7e16-4545-8e40-5a6ffa4d5740/current/log_inprogress_0
2019-06-14 10:28:52,051 INFO  impl.FollowerState (FollowerState.java:run(101)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df:group-442819AA78CB changes to CANDIDATE, lastRpcTime:1019, electionTimeout:1019ms
2019-06-14 10:28:52,051 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: shutdown FollowerState
2019-06-14 10:28:52,051 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df:group-442819AA78CB changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:52,051 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: start LeaderElection
2019-06-14 10:28:52,054 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df:group-442819AA78CB:LeaderElection72: begin an election at term 1 for -1: [793ef3ef-a4eb-4c1a-81b0-b17333f477df:192.168.46.40:43553], old=null
2019-06-14 10:28:52,054 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: shutdown LeaderElection
2019-06-14 10:28:52,054 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df:group-442819AA78CB changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:28:52,054 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df:group-442819AA78CB change Leader from null to 793ef3ef-a4eb-4c1a-81b0-b17333f477df at term 1 for becomeLeader, leader elected after 1024ms
2019-06-14 10:28:52,054 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:52,054 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:52,054 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:52,054 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:52,055 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: start LeaderState
2019-06-14 10:28:52,055 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:52,055 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df:group-442819AA78CB set configuration 0: [793ef3ef-a4eb-4c1a-81b0-b17333f477df:192.168.46.40:43553], old=null at 0
2019-06-14 10:28:52,090 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-1/data/ratis/f9ee85c7-d098-4280-a7a3-442819aa78cb/current/log_inprogress_0
2019-06-14 10:28:52,095 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1177, electionTimeout:1177ms
2019-06-14 10:28:52,096 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:28:52,096 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 14 for changeToCandidate
2019-06-14 10:28:52,096 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:28:52,098 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection73: begin an election at term 15 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:52,098 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection73 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:52,102 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection73 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:52,105 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection73: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t15, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:52,105 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:52,105 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:52,105 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 15 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:52,106 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:28:52,106 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:28:52,176 INFO  impl.FollowerState (FollowerState.java:run(101)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5:group-F932B8E7D716 changes to CANDIDATE, lastRpcTime:1009, electionTimeout:1009ms
2019-06-14 10:28:52,176 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: shutdown FollowerState
2019-06-14 10:28:52,177 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5:group-F932B8E7D716 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:52,177 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: start LeaderElection
2019-06-14 10:28:52,179 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5:group-F932B8E7D716:LeaderElection74: begin an election at term 1 for -1: [694b9f93-ca67-4b25-b4b9-1a111abba6f5:192.168.46.40:32777], old=null
2019-06-14 10:28:52,179 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: shutdown LeaderElection
2019-06-14 10:28:52,179 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5:group-F932B8E7D716 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:28:52,179 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5:group-F932B8E7D716 change Leader from null to 694b9f93-ca67-4b25-b4b9-1a111abba6f5 at term 1 for becomeLeader, leader elected after 1013ms
2019-06-14 10:28:52,179 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:52,179 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:52,179 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:52,179 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:52,179 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: start LeaderState
2019-06-14 10:28:52,180 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:52,180 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5:group-F932B8E7D716 set configuration 0: [694b9f93-ca67-4b25-b4b9-1a111abba6f5:192.168.46.40:32777], old=null at 0
2019-06-14 10:28:52,215 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-2/data/ratis/e0c27f47-7149-406b-9fd9-f932b8e7d716/current/log_inprogress_0
2019-06-14 10:28:52,233 INFO  impl.FollowerState (FollowerState.java:run(101)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5:group-F935C70EE4ED changes to CANDIDATE, lastRpcTime:1026, electionTimeout:1025ms
2019-06-14 10:28:52,233 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: shutdown FollowerState
2019-06-14 10:28:52,233 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5:group-F935C70EE4ED changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:52,233 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: start LeaderElection
2019-06-14 10:28:52,235 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5:group-F935C70EE4ED:LeaderElection75: begin an election at term 1 for -1: [0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855, 694b9f93-ca67-4b25-b4b9-1a111abba6f5:192.168.46.40:32777, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:192.168.46.40:43553], old=null
2019-06-14 10:28:52,242 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:group-F935C70EE4ED changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:694b9f93-ca67-4b25-b4b9-1a111abba6f5
2019-06-14 10:28:52,242 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: shutdown FollowerState
2019-06-14 10:28:52,242 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: start FollowerState
2019-06-14 10:28:52,242 INFO  impl.FollowerState (FollowerState.java:run(109)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:28:52,243 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df:group-F935C70EE4ED changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:694b9f93-ca67-4b25-b4b9-1a111abba6f5
2019-06-14 10:28:52,243 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: shutdown FollowerState
2019-06-14 10:28:52,243 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: start FollowerState
2019-06-14 10:28:52,243 INFO  impl.FollowerState (FollowerState.java:run(109)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:28:52,246 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5:group-F935C70EE4ED:LeaderElection75: Election PASSED; received 1 response(s) [694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3,true-t1] and 0 exception(s); 694b9f93-ca67-4b25-b4b9-1a111abba6f5:t1, leader=null, voted=694b9f93-ca67-4b25-b4b9-1a111abba6f5, raftlog=694b9f93-ca67-4b25-b4b9-1a111abba6f5-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855, 694b9f93-ca67-4b25-b4b9-1a111abba6f5:192.168.46.40:32777, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:192.168.46.40:43553], old=null
2019-06-14 10:28:52,246 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: shutdown LeaderElection
2019-06-14 10:28:52,246 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5:group-F935C70EE4ED changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:28:52,246 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5:group-F935C70EE4ED change Leader from null to 694b9f93-ca67-4b25-b4b9-1a111abba6f5 at term 1 for becomeLeader, leader elected after 1044ms
2019-06-14 10:28:52,246 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:52,246 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:52,247 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:52,247 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:52,247 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:28:52,247 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:52,247 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:28:52,247 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:28:52,247 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:52,247 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:52,248 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:28:52,248 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:52,248 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:28:52,248 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:28:52,248 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:52,248 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:52,248 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: start LeaderState
2019-06-14 10:28:52,248 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:52,260 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5:group-F935C70EE4ED set configuration 0: [0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855, 694b9f93-ca67-4b25-b4b9-1a111abba6f5:192.168.46.40:32777, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:192.168.46.40:43553], old=null at 0
2019-06-14 10:28:52,261 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:group-F935C70EE4ED change Leader from null to 694b9f93-ca67-4b25-b4b9-1a111abba6f5 at term 1 for appendEntries, leader elected after 1059ms
2019-06-14 10:28:52,263 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df:group-F935C70EE4ED change Leader from null to 694b9f93-ca67-4b25-b4b9-1a111abba6f5 at term 1 for appendEntries, leader elected after 1061ms
2019-06-14 10:28:52,264 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:group-F935C70EE4ED set configuration 0: [0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855, 694b9f93-ca67-4b25-b4b9-1a111abba6f5:192.168.46.40:32777, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:192.168.46.40:43553], old=null at 0
2019-06-14 10:28:52,264 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:52,264 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df:group-F935C70EE4ED set configuration 0: [0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855, 694b9f93-ca67-4b25-b4b9-1a111abba6f5:192.168.46.40:32777, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:192.168.46.40:43553], old=null at 0
2019-06-14 10:28:52,264 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:52,293 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-2/data/ratis/f946f4c3-c819-4356-8d0f-f935c70ee4ed/current/log_inprogress_0
2019-06-14 10:28:52,303 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-1/data/ratis/f946f4c3-c819-4356-8d0f-f935c70ee4ed/current/log_inprogress_0
2019-06-14 10:28:52,307 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-0/data/ratis/f946f4c3-c819-4356-8d0f-f935c70ee4ed/current/log_inprogress_0
2019-06-14 10:28:52,516 INFO  impl.FollowerState (FollowerState.java:run(101)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:group-28C872AAB53E changes to CANDIDATE, lastRpcTime:1210, electionTimeout:1196ms
2019-06-14 10:28:52,517 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: shutdown FollowerState
2019-06-14 10:28:52,517 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:group-28C872AAB53E changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:52,517 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: start LeaderElection
2019-06-14 10:28:52,519 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:group-28C872AAB53E:LeaderElection76: begin an election at term 1 for -1: [7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:192.168.46.40:46725], old=null
2019-06-14 10:28:52,519 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: shutdown LeaderElection
2019-06-14 10:28:52,519 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:group-28C872AAB53E changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:28:52,519 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:group-28C872AAB53E change Leader from null to 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d at term 1 for becomeLeader, leader elected after 1215ms
2019-06-14 10:28:52,520 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:52,520 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:52,520 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:52,520 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:52,520 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: start LeaderState
2019-06-14 10:28:52,520 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:52,522 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:group-28C872AAB53E set configuration 0: [7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:192.168.46.40:46725], old=null at 0
2019-06-14 10:28:52,563 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-3/data/ratis/ddcc1da9-9f43-41ac-b876-28c872aab53e/current/log_inprogress_0
2019-06-14 10:28:52,625 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Cluster is ready. Got 6 of 6 DN Heartbeats.
2019-06-14 10:28:52,633 INFO  impl.FollowerState (FollowerState.java:run(101)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca:group-13B634533A3B changes to CANDIDATE, lastRpcTime:1148, electionTimeout:1146ms
2019-06-14 10:28:52,633 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: shutdown FollowerState
2019-06-14 10:28:52,633 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca:group-13B634533A3B changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:52,633 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: start LeaderElection
2019-06-14 10:28:52,637 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca:group-13B634533A3B:LeaderElection77: begin an election at term 1 for -1: [65d9d079-0999-40a1-a2b6-fb43c5122fca:192.168.46.40:34583], old=null
2019-06-14 10:28:52,637 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: shutdown LeaderElection
2019-06-14 10:28:52,637 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca:group-13B634533A3B changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:28:52,641 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca:group-13B634533A3B change Leader from null to 65d9d079-0999-40a1-a2b6-fb43c5122fca at term 1 for becomeLeader, leader elected after 1158ms
2019-06-14 10:28:52,643 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:52,643 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:52,643 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:52,643 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:52,643 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: start LeaderState
2019-06-14 10:28:52,644 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:52,646 INFO  rpc.RpcClient (RpcClient.java:createVolume(289)) - Creating Volume: datanodefailurehandlingtest, with root as owner.
2019-06-14 10:28:52,647 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca:group-13B634533A3B set configuration 0: [65d9d079-0999-40a1-a2b6-fb43c5122fca:192.168.46.40:34583], old=null at 0
2019-06-14 10:28:52,671 INFO  rpc.RpcClient (RpcClient.java:createBucket(426)) - Creating Bucket: datanodefailurehandlingtest/datanodefailurehandlingtest, with Versioning false and Storage Type set to DISK and Encryption set to false 
2019-06-14 10:28:52,691 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-4/data/ratis/33ae1e6f-65c0-4331-b1eb-13b634533a3b/current/log_inprogress_0
2019-06-14 10:28:52,713 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8666A1B7C5D4->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: receive RaftClientReply:client-8666A1B7C5D4->0d8fdae0-3e0d-40b6-816c-aada8c2992e3@group-F935C70EE4ED, cid=157, FAILED org.apache.ratis.protocol.NotLeaderException: Server 0d8fdae0-3e0d-40b6-816c-aada8c2992e3 is not the leader (694b9f93-ca67-4b25-b4b9-1a111abba6f5:192.168.46.40:32777). Request must be sent to leader., logIndex=0, commits[0d8fdae0-3e0d-40b6-816c-aada8c2992e3:c-1, 694b9f93-ca67-4b25-b4b9-1a111abba6f5:c-1, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:c-1]
2019-06-14 10:28:52,718 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:52,741 INFO  impl.FollowerState (FollowerState.java:run(101)) - 7ddba920-5051-41f0-be4c-b5425af80e17:group-2E24075FED16 changes to CANDIDATE, lastRpcTime:1065, electionTimeout:1065ms
2019-06-14 10:28:52,741 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 7ddba920-5051-41f0-be4c-b5425af80e17: shutdown FollowerState
2019-06-14 10:28:52,741 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7ddba920-5051-41f0-be4c-b5425af80e17:group-2E24075FED16 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:52,741 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7ddba920-5051-41f0-be4c-b5425af80e17: start LeaderElection
2019-06-14 10:28:52,743 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 7ddba920-5051-41f0-be4c-b5425af80e17:group-2E24075FED16:LeaderElection78: begin an election at term 1 for -1: [7ddba920-5051-41f0-be4c-b5425af80e17:192.168.46.40:38905, 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:192.168.46.40:46725, 65d9d079-0999-40a1-a2b6-fb43c5122fca:192.168.46.40:34583], old=null
2019-06-14 10:28:52,748 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca:group-2E24075FED16 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:7ddba920-5051-41f0-be4c-b5425af80e17
2019-06-14 10:28:52,748 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: shutdown FollowerState
2019-06-14 10:28:52,748 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: start FollowerState
2019-06-14 10:28:52,748 INFO  impl.FollowerState (FollowerState.java:run(109)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:28:52,751 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 7ddba920-5051-41f0-be4c-b5425af80e17:group-2E24075FED16:LeaderElection78: Election PASSED; received 1 response(s) [7ddba920-5051-41f0-be4c-b5425af80e17->65d9d079-0999-40a1-a2b6-fb43c5122fca,true-t1] and 0 exception(s); 7ddba920-5051-41f0-be4c-b5425af80e17:t1, leader=null, voted=7ddba920-5051-41f0-be4c-b5425af80e17, raftlog=7ddba920-5051-41f0-be4c-b5425af80e17-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [7ddba920-5051-41f0-be4c-b5425af80e17:192.168.46.40:38905, 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:192.168.46.40:46725, 65d9d079-0999-40a1-a2b6-fb43c5122fca:192.168.46.40:34583], old=null
2019-06-14 10:28:52,751 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 7ddba920-5051-41f0-be4c-b5425af80e17: shutdown LeaderElection
2019-06-14 10:28:52,751 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7ddba920-5051-41f0-be4c-b5425af80e17:group-2E24075FED16 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:28:52,752 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 7ddba920-5051-41f0-be4c-b5425af80e17:group-2E24075FED16 change Leader from null to 7ddba920-5051-41f0-be4c-b5425af80e17 at term 1 for becomeLeader, leader elected after 1078ms
2019-06-14 10:28:52,752 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:52,752 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:group-2E24075FED16 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:7ddba920-5051-41f0-be4c-b5425af80e17
2019-06-14 10:28:52,752 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: shutdown FollowerState
2019-06-14 10:28:52,752 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:52,752 INFO  impl.FollowerState (FollowerState.java:run(109)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:28:52,752 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:52,752 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: start FollowerState
2019-06-14 10:28:52,752 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:52,752 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:28:52,753 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:52,753 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:28:52,753 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:28:52,753 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:52,753 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:52,753 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:28:52,753 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:28:52,753 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:28:52,753 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:28:52,753 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:28:52,753 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:28:52,754 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7ddba920-5051-41f0-be4c-b5425af80e17: start LeaderState
2019-06-14 10:28:52,754 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 7ddba920-5051-41f0-be4c-b5425af80e17-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:52,754 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 7ddba920-5051-41f0-be4c-b5425af80e17:group-2E24075FED16 set configuration 0: [7ddba920-5051-41f0-be4c-b5425af80e17:192.168.46.40:38905, 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:192.168.46.40:46725, 65d9d079-0999-40a1-a2b6-fb43c5122fca:192.168.46.40:34583], old=null at 0
2019-06-14 10:28:52,755 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca:group-2E24075FED16 change Leader from null to 7ddba920-5051-41f0-be4c-b5425af80e17 at term 1 for appendEntries, leader elected after 1089ms
2019-06-14 10:28:52,760 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:group-2E24075FED16 change Leader from null to 7ddba920-5051-41f0-be4c-b5425af80e17 at term 1 for appendEntries, leader elected after 1085ms
2019-06-14 10:28:52,766 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:group-2E24075FED16 set configuration 0: [7ddba920-5051-41f0-be4c-b5425af80e17:192.168.46.40:38905, 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:192.168.46.40:46725, 65d9d079-0999-40a1-a2b6-fb43c5122fca:192.168.46.40:34583], old=null at 0
2019-06-14 10:28:52,766 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:52,774 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca:group-2E24075FED16 set configuration 0: [7ddba920-5051-41f0-be4c-b5425af80e17:192.168.46.40:38905, 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:192.168.46.40:46725, 65d9d079-0999-40a1-a2b6-fb43c5122fca:192.168.46.40:34583], old=null at 0
2019-06-14 10:28:52,774 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:52,814 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-4/data/ratis/faea630d-5a8b-4ce4-abdf-2e24075fed16/current/log_inprogress_0
2019-06-14 10:28:52,815 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 7ddba920-5051-41f0-be4c-b5425af80e17-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-5/data/ratis/faea630d-5a8b-4ce4-abdf-2e24075fed16/current/log_inprogress_0
2019-06-14 10:28:52,817 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-3/data/ratis/faea630d-5a8b-4ce4-abdf-2e24075fed16/current/log_inprogress_0
2019-06-14 10:28:52,843 INFO  impl.FollowerState (FollowerState.java:run(101)) - 7ddba920-5051-41f0-be4c-b5425af80e17:group-D7FA8A9186B3 changes to CANDIDATE, lastRpcTime:1200, electionTimeout:1200ms
2019-06-14 10:28:52,844 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 7ddba920-5051-41f0-be4c-b5425af80e17: shutdown FollowerState
2019-06-14 10:28:52,844 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7ddba920-5051-41f0-be4c-b5425af80e17:group-D7FA8A9186B3 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:28:52,844 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7ddba920-5051-41f0-be4c-b5425af80e17: start LeaderElection
2019-06-14 10:28:52,846 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 7ddba920-5051-41f0-be4c-b5425af80e17:group-D7FA8A9186B3:LeaderElection79: begin an election at term 1 for -1: [7ddba920-5051-41f0-be4c-b5425af80e17:192.168.46.40:38905], old=null
2019-06-14 10:28:52,846 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 7ddba920-5051-41f0-be4c-b5425af80e17: shutdown LeaderElection
2019-06-14 10:28:52,846 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7ddba920-5051-41f0-be4c-b5425af80e17:group-D7FA8A9186B3 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:28:52,846 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 7ddba920-5051-41f0-be4c-b5425af80e17:group-D7FA8A9186B3 change Leader from null to 7ddba920-5051-41f0-be4c-b5425af80e17 at term 1 for becomeLeader, leader elected after 1204ms
2019-06-14 10:28:52,846 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:28:52,846 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:28:52,846 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:28:52,846 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:28:52,846 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7ddba920-5051-41f0-be4c-b5425af80e17: start LeaderState
2019-06-14 10:28:52,847 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 7ddba920-5051-41f0-be4c-b5425af80e17-RaftLogWorker: Starting segment from index:0
2019-06-14 10:28:52,847 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 7ddba920-5051-41f0-be4c-b5425af80e17:group-D7FA8A9186B3 set configuration 0: [7ddba920-5051-41f0-be4c-b5425af80e17:192.168.46.40:38905], old=null at 0
2019-06-14 10:28:52,882 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 7ddba920-5051-41f0-be4c-b5425af80e17-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-5/data/ratis/db5cc315-9e79-4e0a-a841-d7fa8a9186b3/current/log_inprogress_0
2019-06-14 10:28:53,243 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1137, electionTimeout:1137ms
2019-06-14 10:28:53,243 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:28:53,243 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 15 for changeToCandidate
2019-06-14 10:28:53,243 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:28:53,245 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection80: begin an election at term 16 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:53,246 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection80 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:53,250 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection80 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:53,253 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection80: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t16, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:53,253 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:53,253 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:53,253 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 16 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:53,253 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:28:53,253 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:28:53,761 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5: receive RaftClientReply:client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5@group-F935C70EE4ED, cid=157, SUCCESS, logIndex=1, commits[694b9f93-ca67-4b25-b4b9-1a111abba6f5:c1, 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:c0, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:c0]
2019-06-14 10:28:53,795 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5: receive RaftClientReply:client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5@group-F935C70EE4ED, cid=158, SUCCESS, logIndex=3, commits[694b9f93-ca67-4b25-b4b9-1a111abba6f5:c4, 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:c2, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:c3]
2019-06-14 10:28:53,803 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5: receive RaftClientReply:client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5@group-F935C70EE4ED, cid=159, SUCCESS, logIndex=0, commits[694b9f93-ca67-4b25-b4b9-1a111abba6f5:c4, 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:c3, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:c3]
2019-06-14 10:28:53,804 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:28:53,804 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@33aa4326
2019-06-14 10:28:53,804 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:28:53,804 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:28:53,805 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: close
2019-06-14 10:28:53,805 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: shutdown group-F935C70EE4ED
2019-06-14 10:28:53,805 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: shutdown group-5A6FFA4D5740
2019-06-14 10:28:53,805 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-F935C70EE4ED,id=0d8fdae0-3e0d-40b6-816c-aada8c2992e3
2019-06-14 10:28:53,805 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-5A6FFA4D5740,id=0d8fdae0-3e0d-40b6-816c-aada8c2992e3
2019-06-14 10:28:53,805 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: shutdown FollowerState
2019-06-14 10:28:53,806 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: shutdown LeaderState
2019-06-14 10:28:53,806 INFO  impl.FollowerState (FollowerState.java:run(109)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:28:53,806 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:1)
2019-06-14 10:28:53,806 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-0d8fdae0-3e0d-40b6-816c-aada8c2992e3-group-F935C70EE4ED: set stopIndex = 3
2019-06-14 10:28:53,806 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-0/data/ratis/f946f4c3-c819-4356-8d0f-f935c70ee4ed/sm/snapshot.1_1
2019-06-14 10:28:53,806 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:group-F935C70EE4ED closes. The last applied log index is 3
2019-06-14 10:28:53,806 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3-PendingRequests: sendNotLeaderResponses
2019-06-14 10:28:53,807 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:53,811 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3-RaftLogWorker close()
2019-06-14 10:28:53,814 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:28:53,814 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-0d8fdae0-3e0d-40b6-816c-aada8c2992e3-group-5A6FFA4D5740: set stopIndex = 0
2019-06-14 10:28:53,814 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:group-5A6FFA4D5740 closes. The last applied log index is 0
2019-06-14 10:28:53,814 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:28:53,816 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3-RaftLogWorker close()
2019-06-14 10:28:53,820 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: shutdown server with port 40855 now
2019-06-14 10:28:53,821 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:53,821 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-14 10:28:53,821 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 0d8fdae0-3e0d-40b6-816c-aada8c2992e3: shutdown server with port 40855 successfully
2019-06-14 10:28:53,821 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 5 -> 0
2019-06-14 10:28:53,829 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:28:53,854 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:28:53,855 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@18a538a0{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:28:53,855 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@70736b19{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:28:53,855 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@32db94fb{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:28:53,856 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@5edd2170{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:28:53,867 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:53,867 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:53,882 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5: receive RaftClientReply:client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5@group-F935C70EE4ED, cid=160, SUCCESS, logIndex=5, commits[694b9f93-ca67-4b25-b4b9-1a111abba6f5:c5, 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:c3, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:c4]
2019-06-14 10:28:53,885 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:53,886 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:53,888 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:53,889 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:53,890 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5: receive RaftClientReply:client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5@group-F935C70EE4ED, cid=161, SUCCESS, logIndex=7, commits[694b9f93-ca67-4b25-b4b9-1a111abba6f5:c7, 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:c3, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:c5]
2019-06-14 10:28:53,892 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:53,892 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:53,896 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:53,896 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:53,897 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:53,897 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:53,898 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5: receive RaftClientReply:client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5@group-F935C70EE4ED, cid=162, SUCCESS, logIndex=8, commits[694b9f93-ca67-4b25-b4b9-1a111abba6f5:c8, 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:c3, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:c6]
2019-06-14 10:28:53,905 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5: receive RaftClientReply:client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5@group-F935C70EE4ED, cid=163, SUCCESS, logIndex=9, commits[694b9f93-ca67-4b25-b4b9-1a111abba6f5:c9, 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:c3, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:c6]
2019-06-14 10:28:53,912 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:53,912 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:54,342 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1089, electionTimeout:1089ms
2019-06-14 10:28:54,343 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:28:54,343 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 16 for changeToCandidate
2019-06-14 10:28:54,343 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:28:54,345 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection81: begin an election at term 17 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:54,346 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection81 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:54,350 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection81 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:54,352 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection81: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t17, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:54,352 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:54,352 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:54,352 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 17 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:54,352 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:28:54,352 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:28:54,413 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:54,413 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:54,914 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:54,914 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:55,414 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:55,414 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:55,415 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1062, electionTimeout:1062ms
2019-06-14 10:28:55,415 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:28:55,415 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 17 for changeToCandidate
2019-06-14 10:28:55,415 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:28:55,417 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection82: begin an election at term 18 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:55,421 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection82 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:55,425 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection82 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:55,427 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection82: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t18, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:55,428 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:55,428 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:55,428 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 18 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:55,428 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:28:55,428 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:28:55,915 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:55,915 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:56,415 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:56,416 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:56,485 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1057, electionTimeout:1057ms
2019-06-14 10:28:56,485 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:28:56,485 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 18 for changeToCandidate
2019-06-14 10:28:56,486 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:28:56,488 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection83: begin an election at term 19 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:56,488 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection83 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:56,492 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection83 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:56,495 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection83: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t19, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:56,495 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:56,495 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:56,495 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 19 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:56,495 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:28:56,495 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:28:56,779 INFO  node.StaleNodeHandler (StaleNodeHandler.java:onMessage(58)) - Datanode 0d8fdae0-3e0d-40b6-816c-aada8c2992e3{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null} moved to stale state. Finalizing its pipelines [PipelineID=f946f4c3-c819-4356-8d0f-f935c70ee4ed, PipelineID=d590690f-7e16-4545-8e40-5a6ffa4d5740]
2019-06-14 10:28:56,779 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: f946f4c3-c819-4356-8d0f-f935c70ee4ed, Nodes: 0d8fdae0-3e0d-40b6-816c-aada8c2992e3{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}793ef3ef-a4eb-4c1a-81b0-b17333f477df{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}694b9f93-ca67-4b25-b4b9-1a111abba6f5{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-14 10:28:56,779 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: f946f4c3-c819-4356-8d0f-f935c70ee4ed, Nodes: 0d8fdae0-3e0d-40b6-816c-aada8c2992e3{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}793ef3ef-a4eb-4c1a-81b0-b17333f477df{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}694b9f93-ca67-4b25-b4b9-1a111abba6f5{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] moved to CLOSED state
2019-06-14 10:28:56,779 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: d590690f-7e16-4545-8e40-5a6ffa4d5740, Nodes: 0d8fdae0-3e0d-40b6-816c-aada8c2992e3{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:28:56,779 INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #1
2019-06-14 10:28:56,779 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: d590690f-7e16-4545-8e40-5a6ffa4d5740, Nodes: 0d8fdae0-3e0d-40b6-816c-aada8c2992e3{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-06-14 10:28:56,916 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:56,916 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:57,416 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:57,416 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:57,599 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1103, electionTimeout:1103ms
2019-06-14 10:28:57,599 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:28:57,599 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 19 for changeToCandidate
2019-06-14 10:28:57,599 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:28:57,601 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection84: begin an election at term 20 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:57,602 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection84 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:57,605 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection84 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:57,618 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection84: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t20, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:57,618 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:57,618 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:57,618 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 20 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:57,618 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:28:57,618 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:28:57,924 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:57,924 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:58,425 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:58,425 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:58,803 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1184, electionTimeout:1184ms
2019-06-14 10:28:58,803 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:28:58,803 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 20 for changeToCandidate
2019-06-14 10:28:58,803 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:28:58,805 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection85: begin an election at term 21 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:58,807 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection85 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:58,813 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection85 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:58,827 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection85: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t21, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:58,827 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:58,827 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:58,827 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 21 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:58,827 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:28:58,827 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:28:58,906 WARN  scm.XceiverClientRatis (XceiverClientRatis.java:watchForCommit(260)) - 3 way commit failed 
java.util.concurrent.TimeoutException
	at java.util.concurrent.CompletableFuture.timedGet(CompletableFuture.java:1771)
	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1915)
	at org.apache.hadoop.hdds.scm.XceiverClientRatis.watchForCommit(XceiverClientRatis.java:257)
	at org.apache.hadoop.hdds.scm.storage.CommitWatcher.watchForCommit(CommitWatcher.java:194)
	at org.apache.hadoop.hdds.scm.storage.CommitWatcher.watchOnFirstIndex(CommitWatcher.java:135)
	at org.apache.hadoop.hdds.scm.storage.BlockOutputStream.watchForCommit(BlockOutputStream.java:355)
	at org.apache.hadoop.hdds.scm.storage.BlockOutputStream.handleFullBuffer(BlockOutputStream.java:332)
	at org.apache.hadoop.hdds.scm.storage.BlockOutputStream.write(BlockOutputStream.java:259)
	at org.apache.hadoop.ozone.client.io.BlockOutputStreamEntry.write(BlockOutputStreamEntry.java:129)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleWrite(KeyOutputStream.java:211)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.write(KeyOutputStream.java:193)
	at org.apache.hadoop.ozone.client.io.OzoneOutputStream.write(OzoneOutputStream.java:49)
	at java.io.OutputStream.write(OutputStream.java:75)
	at org.apache.hadoop.ozone.client.rpc.TestFailureHandlingByClient.testDatanodeExclusionWithMajorityCommit(TestFailureHandlingByClient.java:397)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2019-06-14 10:28:58,917 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-8666A1B7C5D4->793ef3ef-a4eb-4c1a-81b0-b17333f477df@group-F935C70EE4ED, cid=165, seq=0, Watch-MAJORITY_COMMITTED(7), Message:<EMPTY>, reply=RaftClientReply:client-8666A1B7C5D4->793ef3ef-a4eb-4c1a-81b0-b17333f477df@group-F935C70EE4ED, cid=165, FAILED org.apache.ratis.protocol.NotLeaderException: Server 793ef3ef-a4eb-4c1a-81b0-b17333f477df is not the leader (694b9f93-ca67-4b25-b4b9-1a111abba6f5:192.168.46.40:32777). Request must be sent to leader., logIndex=0, commits[793ef3ef-a4eb-4c1a-81b0-b17333f477df:c12, 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:c3, 694b9f93-ca67-4b25-b4b9-1a111abba6f5:c12]
2019-06-14 10:28:58,925 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8666A1B7C5D4->793ef3ef-a4eb-4c1a-81b0-b17333f477df: receive RaftClientReply:client-8666A1B7C5D4->793ef3ef-a4eb-4c1a-81b0-b17333f477df@group-F935C70EE4ED, cid=165, FAILED org.apache.ratis.protocol.NotLeaderException: Server 793ef3ef-a4eb-4c1a-81b0-b17333f477df is not the leader (694b9f93-ca67-4b25-b4b9-1a111abba6f5:192.168.46.40:32777). Request must be sent to leader., logIndex=0, commits[793ef3ef-a4eb-4c1a-81b0-b17333f477df:c12, 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:c3, 694b9f93-ca67-4b25-b4b9-1a111abba6f5:c12]
2019-06-14 10:28:58,925 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:58,926 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:58,930 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-8666A1B7C5D4->793ef3ef-a4eb-4c1a-81b0-b17333f477df@group-F935C70EE4ED, cid=164, seq=0, Watch-ALL_COMMITTED(7), Message:<EMPTY>, reply=RaftClientReply:client-8666A1B7C5D4->793ef3ef-a4eb-4c1a-81b0-b17333f477df@group-F935C70EE4ED, cid=164, FAILED org.apache.ratis.protocol.NotLeaderException: Server 793ef3ef-a4eb-4c1a-81b0-b17333f477df is not the leader (694b9f93-ca67-4b25-b4b9-1a111abba6f5:192.168.46.40:32777). Request must be sent to leader., logIndex=0, commits[793ef3ef-a4eb-4c1a-81b0-b17333f477df:c12, 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:c3, 694b9f93-ca67-4b25-b4b9-1a111abba6f5:c12]
2019-06-14 10:28:58,934 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8666A1B7C5D4->793ef3ef-a4eb-4c1a-81b0-b17333f477df: receive RaftClientReply:client-8666A1B7C5D4->793ef3ef-a4eb-4c1a-81b0-b17333f477df@group-F935C70EE4ED, cid=164, FAILED org.apache.ratis.protocol.NotLeaderException: Server 793ef3ef-a4eb-4c1a-81b0-b17333f477df is not the leader (694b9f93-ca67-4b25-b4b9-1a111abba6f5:192.168.46.40:32777). Request must be sent to leader., logIndex=0, commits[793ef3ef-a4eb-4c1a-81b0-b17333f477df:c12, 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:c3, 694b9f93-ca67-4b25-b4b9-1a111abba6f5:c12]
2019-06-14 10:28:58,941 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-UnorderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:58,942 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-UnorderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:28:59,426 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:59,426 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:28:59,754 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:59,754 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:59,760 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:59,761 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:59,763 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:28:59,764 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:28:59,772 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 1 is closed with bcsId 9.
2019-06-14 10:28:59,775 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 1 is closed with bcsId 9.
2019-06-14 10:28:59,861 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1033, electionTimeout:1033ms
2019-06-14 10:28:59,861 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:28:59,861 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 21 for changeToCandidate
2019-06-14 10:28:59,861 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:28:59,863 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection86: begin an election at term 22 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:59,864 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection86 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:59,865 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection86 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:59,865 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection86: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t22, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:28:59,865 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:59,865 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:28:59,865 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 22 for DISCOVERED_A_NEW_TERM
2019-06-14 10:28:59,865 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:28:59,865 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:28:59,953 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5: receive RaftClientReply:client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5@group-F935C70EE4ED, cid=165, SUCCESS, logIndex=0, commits[694b9f93-ca67-4b25-b4b9-1a111abba6f5:c14, 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:c3, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:c13]
2019-06-14 10:28:59,953 INFO  scm.XceiverClientRatis (XceiverClientRatis.java:lambda$watchForCommit$7(278)) - Could not commit 7 to all the nodes. Server 0d8fdae0-3e0d-40b6-816c-aada8c2992e3 has failed. Committed by majority.
2019-06-14 10:29:00,265 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:29:00,265 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:29:00,764 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:29:00,764 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:29:01,010 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1144, electionTimeout:1144ms
2019-06-14 10:29:01,010 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:29:01,010 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 22 for changeToCandidate
2019-06-14 10:29:01,010 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:29:01,012 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection87: begin an election at term 23 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:01,013 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection87 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:01,013 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection87 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:01,013 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection87: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t23, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:01,013 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:01,014 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:01,014 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 23 for DISCOVERED_A_NEW_TERM
2019-06-14 10:29:01,014 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:29:01,014 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:29:01,265 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:29:01,266 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:29:01,765 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:29:01,765 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:29:02,109 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1095, electionTimeout:1095ms
2019-06-14 10:29:02,109 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:29:02,109 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 23 for changeToCandidate
2019-06-14 10:29:02,109 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:29:02,112 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection88: begin an election at term 24 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:02,112 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection88 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:02,112 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection88 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:02,113 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection88: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t24, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:02,113 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:02,113 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:02,113 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 24 for DISCOVERED_A_NEW_TERM
2019-06-14 10:29:02,113 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:29:02,113 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:29:02,265 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:29:02,266 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:29:02,766 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:29:02,766 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:29:03,266 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:29:03,267 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:29:03,293 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1179, electionTimeout:1179ms
2019-06-14 10:29:03,293 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:29:03,293 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 24 for changeToCandidate
2019-06-14 10:29:03,293 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:29:03,296 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection89: begin an election at term 25 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:03,296 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection89 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:03,296 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection89 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:03,296 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection89: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t25, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:03,297 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:03,297 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:03,297 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 25 for DISCOVERED_A_NEW_TERM
2019-06-14 10:29:03,297 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:29:03,297 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:29:03,767 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:29:03,767 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:29:04,268 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:29:04,268 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:29:04,335 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1038, electionTimeout:1038ms
2019-06-14 10:29:04,335 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:29:04,335 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 25 for changeToCandidate
2019-06-14 10:29:04,336 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:29:04,338 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection90: begin an election at term 26 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:04,339 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection90 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:04,339 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection90 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:04,339 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection90: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t26, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:04,339 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:04,339 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:04,339 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 26 for DISCOVERED_A_NEW_TERM
2019-06-14 10:29:04,340 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:29:04,340 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:29:04,674 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5@group-F935C70EE4ED, cid=164, seq=0, Watch-ALL_COMMITTED(7), Message:<EMPTY>, reply=RaftClientReply:client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5@group-F935C70EE4ED, cid=164, FAILED org.apache.ratis.protocol.NotReplicatedException: Request with call Id 164 and log index 7 is not yet replicated to ALL_COMMITTED, logIndex=7, commits[694b9f93-ca67-4b25-b4b9-1a111abba6f5:c14, 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:c3, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:c14]
2019-06-14 10:29:04,768 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:192.168.46.40:40855: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
2019-06-14 10:29:04,768 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->0d8fdae0-3e0d-40b6-816c-aada8c2992e3: nextIndex: updateUnconditionally 0 -> 0
2019-06-14 10:29:04,954 WARN  scm.XceiverClientRatis (XceiverClientRatis.java:watchForCommit(260)) - 3 way commit failed 
java.util.concurrent.TimeoutException
	at java.util.concurrent.CompletableFuture.timedGet(CompletableFuture.java:1771)
	at java.util.concurrent.CompletableFuture.get(CompletableFuture.java:1915)
	at org.apache.hadoop.hdds.scm.XceiverClientRatis.watchForCommit(XceiverClientRatis.java:257)
	at org.apache.hadoop.hdds.scm.storage.CommitWatcher.watchForCommit(CommitWatcher.java:194)
	at org.apache.hadoop.hdds.scm.storage.CommitWatcher.watchOnLastIndex(CommitWatcher.java:157)
	at org.apache.hadoop.hdds.scm.storage.BlockOutputStream.watchForCommit(BlockOutputStream.java:355)
	at org.apache.hadoop.hdds.scm.storage.BlockOutputStream.handleFlush(BlockOutputStream.java:486)
	at org.apache.hadoop.hdds.scm.storage.BlockOutputStream.flush(BlockOutputStream.java:435)
	at org.apache.hadoop.ozone.client.io.BlockOutputStreamEntry.flush(BlockOutputStreamEntry.java:136)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.handleFlushOrClose(KeyOutputStream.java:442)
	at org.apache.hadoop.ozone.client.io.KeyOutputStream.flush(KeyOutputStream.java:396)
	at org.apache.hadoop.ozone.client.io.OzoneOutputStream.flush(OzoneOutputStream.java:54)
	at org.apache.hadoop.ozone.client.rpc.TestFailureHandlingByClient.testDatanodeExclusionWithMajorityCommit(TestFailureHandlingByClient.java:398)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2019-06-14 10:29:04,960 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5: receive RaftClientReply:client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5@group-F935C70EE4ED, cid=167, SUCCESS, logIndex=0, commits[694b9f93-ca67-4b25-b4b9-1a111abba6f5:c14, 0d8fdae0-3e0d-40b6-816c-aada8c2992e3:c3, 793ef3ef-a4eb-4c1a-81b0-b17333f477df:c14]
2019-06-14 10:29:04,960 INFO  scm.XceiverClientRatis (XceiverClientRatis.java:lambda$watchForCommit$7(278)) - Could not commit 9 to all the nodes. Server 0d8fdae0-3e0d-40b6-816c-aada8c2992e3 has failed. Committed by majority.
2019-06-14 10:29:05,062 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:shutdown(321)) - Shutting down the Mini Ozone Cluster
2019-06-14 10:29:05,062 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(336)) - Stopping the Mini Ozone Cluster
2019-06-14 10:29:05,062 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(338)) - Stopping the OzoneManager
2019-06-14 10:29:05,062 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 44499
2019-06-14 10:29:05,068 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 44499
2019-06-14 10:29:05,076 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service KeyDeletingService
2019-06-14 10:29:05,077 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-14 10:29:05,077 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@147203c2{/,null,UNAVAILABLE}{/ozoneManager}
2019-06-14 10:29:05,078 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@11df0bc7{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:29:05,078 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@1ebcfcf1{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,UNAVAILABLE}
2019-06-14 10:29:05,078 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@33ef393a{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:29:05,080 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(344)) - Stopping the StorageContainerManager
2019-06-14 10:29:05,080 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(789)) - Stopping Replication Manager Service.
2019-06-14 10:29:05,080 INFO  container.ReplicationManager (ReplicationManager.java:stop(191)) - Replication Monitor Thread is not running.
2019-06-14 10:29:05,080 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(796)) - Stopping Lease Manager of the command watchers
2019-06-14 10:29:05,081 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(803)) - Stopping datanode service RPC server
2019-06-14 10:29:05,081 INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(373)) - Stopping the RPC server for DataNodes
2019-06-14 10:29:05,081 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 40791
2019-06-14 10:29:05,082 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 40791
2019-06-14 10:29:05,086 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-14 10:29:05,087 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(811)) - Stopping block service RPC server
2019-06-14 10:29:05,087 INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(145)) - Stopping the RPC server for Block Protocol
2019-06-14 10:29:05,087 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 41119
2019-06-14 10:29:05,092 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 41119
2019-06-14 10:29:05,092 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(818)) - Stopping the StorageContainerLocationProtocol RPC server
2019-06-14 10:29:05,092 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-14 10:29:05,094 INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(157)) - Stopping the RPC server for Client Protocol
2019-06-14 10:29:05,094 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 35791
2019-06-14 10:29:05,101 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(825)) - Stopping Storage Container Manager HTTP server.
2019-06-14 10:29:05,101 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 35791
2019-06-14 10:29:05,102 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-14 10:29:05,106 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@7695184b{/,null,UNAVAILABLE}{/scm}
2019-06-14 10:29:05,106 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@29390110{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:29:05,106 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@381d7c4c{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,UNAVAILABLE}
2019-06-14 10:29:05,107 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@506d7fed{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:29:05,107 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(836)) - Stopping Block Manager Service.
2019-06-14 10:29:05,107 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service SCMBlockDeletingService
2019-06-14 10:29:05,108 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service SCMBlockDeletingService
2019-06-14 10:29:05,108 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(858)) - Stopping SCM Event Queue.
2019-06-14 10:29:05,109 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(350)) - Shutting the HddsDatanodes
2019-06-14 10:29:05,110 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:29:05,110 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@62f63625
2019-06-14 10:29:05,110 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:29:05,110 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:29:05,110 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: close
2019-06-14 10:29:05,110 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: shutdown group-F935C70EE4ED
2019-06-14 10:29:05,110 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: shutdown group-442819AA78CB
2019-06-14 10:29:05,111 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-F935C70EE4ED,id=793ef3ef-a4eb-4c1a-81b0-b17333f477df
2019-06-14 10:29:05,111 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-442819AA78CB,id=793ef3ef-a4eb-4c1a-81b0-b17333f477df
2019-06-14 10:29:05,111 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: shutdown FollowerState
2019-06-14 10:29:05,111 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: shutdown LeaderState
2019-06-14 10:29:05,111 INFO  impl.FollowerState (FollowerState.java:run(109)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:29:05,111 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:13)
2019-06-14 10:29:05,111 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-793ef3ef-a4eb-4c1a-81b0-b17333f477df-group-F935C70EE4ED: set stopIndex = 14
2019-06-14 10:29:05,111 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-1/data/ratis/f946f4c3-c819-4356-8d0f-f935c70ee4ed/sm/snapshot.1_13
2019-06-14 10:29:05,111 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df-PendingRequests: sendNotLeaderResponses
2019-06-14 10:29:05,112 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df:group-F935C70EE4ED closes. The last applied log index is 14
2019-06-14 10:29:05,112 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-793ef3ef-a4eb-4c1a-81b0-b17333f477df-group-442819AA78CB: set stopIndex = 0
2019-06-14 10:29:05,112 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:29:05,112 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:29:05,112 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df:group-442819AA78CB closes. The last applied log index is 0
2019-06-14 10:29:05,114 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:29:05,114 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df-RaftLogWorker close()
2019-06-14 10:29:05,118 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df-RaftLogWorker close()
2019-06-14 10:29:05,120 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: shutdown server with port 43553 now
2019-06-14 10:29:05,121 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: Failed appendEntries to 793ef3ef-a4eb-4c1a-81b0-b17333f477df:192.168.46.40:43553: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-14 10:29:05,121 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: shutdown server with port 43553 successfully
2019-06-14 10:29:05,121 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5->793ef3ef-a4eb-4c1a-81b0-b17333f477df: nextIndex: updateUnconditionally 15 -> 0
2019-06-14 10:29:05,121 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - 793ef3ef-a4eb-4c1a-81b0-b17333f477df: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:29:05,122 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:29:05,137 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:29:05,138 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@457dc809{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:29:05,138 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@5687ba39{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:29:05,138 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@67544105{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:29:05,139 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@7ae97a58{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:29:05,139 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:29:05,139 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@38a3c078
2019-06-14 10:29:05,139 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:29:05,140 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:29:05,140 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: close
2019-06-14 10:29:05,140 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: shutdown group-F935C70EE4ED
2019-06-14 10:29:05,140 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: shutdown group-F932B8E7D716
2019-06-14 10:29:05,140 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-F935C70EE4ED,id=694b9f93-ca67-4b25-b4b9-1a111abba6f5
2019-06-14 10:29:05,141 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: shutdown LeaderState
2019-06-14 10:29:05,141 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-F932B8E7D716,id=694b9f93-ca67-4b25-b4b9-1a111abba6f5
2019-06-14 10:29:05,141 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(694b9f93-ca67-4b25-b4b9-1a111abba6f5 -> 793ef3ef-a4eb-4c1a-81b0-b17333f477df): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:29:05,141 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(694b9f93-ca67-4b25-b4b9-1a111abba6f5 -> 0d8fdae0-3e0d-40b6-816c-aada8c2992e3): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:29:05,141 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5-PendingRequests: sendNotLeaderResponses
2019-06-14 10:29:05,141 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: shutdown LeaderState
2019-06-14 10:29:05,142 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5-PendingRequests: sendNotLeaderResponses
2019-06-14 10:29:05,142 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-694b9f93-ca67-4b25-b4b9-1a111abba6f5-group-F932B8E7D716: set stopIndex = 0
2019-06-14 10:29:05,142 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:29:05,142 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5:group-F932B8E7D716 closes. The last applied log index is 0
2019-06-14 10:29:05,142 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:29:05,149 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5-RaftLogWorker close()
2019-06-14 10:29:05,151 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5@group-F935C70EE4ED, cid=164, seq=0, Watch-ALL_COMMITTED(7), Message:<EMPTY>, reply=RaftClientReply:client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5@group-F935C70EE4ED, cid=164, FAILED org.apache.ratis.protocol.NotLeaderException: Server 694b9f93-ca67-4b25-b4b9-1a111abba6f5 is not the leader (null). Request must be sent to leader., logIndex=0, commits[694b9f93-ca67-4b25-b4b9-1a111abba6f5:c14]
2019-06-14 10:29:05,151 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5@group-F935C70EE4ED, cid=164, seq=0, Watch-ALL_COMMITTED(7), Message:<EMPTY>, reply=RaftClientReply:client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5@group-F935C70EE4ED, cid=164, FAILED org.apache.ratis.protocol.NotLeaderException: Server 694b9f93-ca67-4b25-b4b9-1a111abba6f5 is not the leader (null). Request must be sent to leader., logIndex=0, commits[694b9f93-ca67-4b25-b4b9-1a111abba6f5:c14]
2019-06-14 10:29:05,151 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5: receive RaftClientReply:client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5@group-F935C70EE4ED, cid=164, FAILED org.apache.ratis.protocol.NotLeaderException: Server 694b9f93-ca67-4b25-b4b9-1a111abba6f5 is not the leader (null). Request must be sent to leader., logIndex=0, commits[694b9f93-ca67-4b25-b4b9-1a111abba6f5:c14]
2019-06-14 10:29:05,152 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5@group-F935C70EE4ED, cid=166, seq=0, Watch-ALL_COMMITTED(9), Message:<EMPTY>, reply=RaftClientReply:client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5@group-F935C70EE4ED, cid=166, FAILED org.apache.ratis.protocol.NotLeaderException: Server 694b9f93-ca67-4b25-b4b9-1a111abba6f5 is not the leader (null). Request must be sent to leader., logIndex=0, commits[694b9f93-ca67-4b25-b4b9-1a111abba6f5:c14]
2019-06-14 10:29:05,152 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-694b9f93-ca67-4b25-b4b9-1a111abba6f5-group-F935C70EE4ED: set stopIndex = 14
2019-06-14 10:29:05,153 INFO  client.GrpcClientProtocolService (GrpcClientProtocolService.java:lambda$processClientRequest$0(264)) - Failed RaftClientRequest:client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5@group-F935C70EE4ED, cid=166, seq=0, Watch-ALL_COMMITTED(9), Message:<EMPTY>, reply=RaftClientReply:client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5@group-F935C70EE4ED, cid=166, FAILED org.apache.ratis.protocol.NotLeaderException: Server 694b9f93-ca67-4b25-b4b9-1a111abba6f5 is not the leader (null). Request must be sent to leader., logIndex=0, commits[694b9f93-ca67-4b25-b4b9-1a111abba6f5:c14]
2019-06-14 10:29:05,152 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:14)
2019-06-14 10:29:05,153 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-d5821c35-cef7-4964-96cd-7177835c93e2/datanode-2/data/ratis/f946f4c3-c819-4356-8d0f-f935c70ee4ed/sm/snapshot.1_14
2019-06-14 10:29:05,153 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5:group-F935C70EE4ED closes. The last applied log index is 14
2019-06-14 10:29:05,153 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:29:05,159 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5: receive RaftClientReply:client-8666A1B7C5D4->694b9f93-ca67-4b25-b4b9-1a111abba6f5@group-F935C70EE4ED, cid=166, FAILED org.apache.ratis.protocol.NotLeaderException: Server 694b9f93-ca67-4b25-b4b9-1a111abba6f5 is not the leader (null). Request must be sent to leader., logIndex=0, commits[694b9f93-ca67-4b25-b4b9-1a111abba6f5:c14]
2019-06-14 10:29:05,159 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5-RaftLogWorker close()
2019-06-14 10:29:05,161 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: shutdown server with port 32777 now
2019-06-14 10:29:05,161 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 3-UnorderedRequestStreamObserver3: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:29:05,163 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 694b9f93-ca67-4b25-b4b9-1a111abba6f5: shutdown server with port 32777 successfully
2019-06-14 10:29:05,165 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:29:05,176 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:29:05,177 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@73418044{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:29:05,177 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@58ec04f4{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:29:05,177 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@6df605f{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:29:05,178 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@7b8b755d{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:29:05,178 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:29:05,178 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@59cc46a4
2019-06-14 10:29:05,179 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:29:05,179 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:29:05,179 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: close
2019-06-14 10:29:05,179 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: shutdown group-28C872AAB53E
2019-06-14 10:29:05,179 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: shutdown group-2E24075FED16
2019-06-14 10:29:05,179 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-28C872AAB53E,id=7cc2898f-b3fe-4ae1-83f6-f7d4837df60d
2019-06-14 10:29:05,179 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-2E24075FED16,id=7cc2898f-b3fe-4ae1-83f6-f7d4837df60d
2019-06-14 10:29:05,180 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: shutdown FollowerState
2019-06-14 10:29:05,180 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: shutdown LeaderState
2019-06-14 10:29:05,180 INFO  impl.FollowerState (FollowerState.java:run(109)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:29:05,180 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:29:05,180 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-7cc2898f-b3fe-4ae1-83f6-f7d4837df60d-group-2E24075FED16: set stopIndex = 0
2019-06-14 10:29:05,180 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d-PendingRequests: sendNotLeaderResponses
2019-06-14 10:29:05,180 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:group-2E24075FED16 closes. The last applied log index is 0
2019-06-14 10:29:05,181 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:29:05,181 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:29:05,181 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-7cc2898f-b3fe-4ae1-83f6-f7d4837df60d-group-28C872AAB53E: set stopIndex = 0
2019-06-14 10:29:05,183 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d-RaftLogWorker close()
2019-06-14 10:29:05,183 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:group-28C872AAB53E closes. The last applied log index is 0
2019-06-14 10:29:05,185 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:29:05,186 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d-RaftLogWorker close()
2019-06-14 10:29:05,188 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: shutdown server with port 46725 now
2019-06-14 10:29:05,188 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:29:05,188 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: shutdown server with port 46725 successfully
2019-06-14 10:29:05,188 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 7ddba920-5051-41f0-be4c-b5425af80e17: Failed appendEntries to 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d:192.168.46.40:46725: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-14 10:29:05,189 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 7ddba920-5051-41f0-be4c-b5425af80e17->7cc2898f-b3fe-4ae1-83f6-f7d4837df60d: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:29:05,190 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:29:05,210 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:29:05,211 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@60052518{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:29:05,211 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@39336f5{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:29:05,211 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@59e24c62{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:29:05,212 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@2620264e{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:29:05,212 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:29:05,212 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@524945e2
2019-06-14 10:29:05,213 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:29:05,213 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:29:05,213 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: close
2019-06-14 10:29:05,213 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: shutdown group-13B634533A3B
2019-06-14 10:29:05,213 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: shutdown group-2E24075FED16
2019-06-14 10:29:05,214 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-13B634533A3B,id=65d9d079-0999-40a1-a2b6-fb43c5122fca
2019-06-14 10:29:05,214 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-2E24075FED16,id=65d9d079-0999-40a1-a2b6-fb43c5122fca
2019-06-14 10:29:05,214 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: shutdown LeaderState
2019-06-14 10:29:05,214 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: shutdown FollowerState
2019-06-14 10:29:05,214 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca-PendingRequests: sendNotLeaderResponses
2019-06-14 10:29:05,214 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:29:05,215 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-65d9d079-0999-40a1-a2b6-fb43c5122fca-group-13B634533A3B: set stopIndex = 0
2019-06-14 10:29:05,214 INFO  impl.FollowerState (FollowerState.java:run(109)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:29:05,214 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-65d9d079-0999-40a1-a2b6-fb43c5122fca-group-2E24075FED16: set stopIndex = 0
2019-06-14 10:29:05,215 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:29:05,215 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca:group-2E24075FED16 closes. The last applied log index is 0
2019-06-14 10:29:05,215 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca:group-13B634533A3B closes. The last applied log index is 0
2019-06-14 10:29:05,216 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:29:05,218 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca-RaftLogWorker close()
2019-06-14 10:29:05,219 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:29:05,226 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca-RaftLogWorker close()
2019-06-14 10:29:05,228 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: shutdown server with port 34583 now
2019-06-14 10:29:05,228 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: shutdown server with port 34583 successfully
2019-06-14 10:29:05,228 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 7ddba920-5051-41f0-be4c-b5425af80e17: Failed appendEntries to 65d9d079-0999-40a1-a2b6-fb43c5122fca:192.168.46.40:34583: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-14 10:29:05,228 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - 65d9d079-0999-40a1-a2b6-fb43c5122fca: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:29:05,229 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 7ddba920-5051-41f0-be4c-b5425af80e17->65d9d079-0999-40a1-a2b6-fb43c5122fca: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:29:05,229 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:29:05,238 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:29:05,239 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@772db1d8{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:29:05,239 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@7955b4d4{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:29:05,240 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@45bb502f{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:29:05,240 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@6acdca3a{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:29:05,240 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:29:05,240 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@5c6fae3c
2019-06-14 10:29:05,241 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:29:05,241 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:29:05,241 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 7ddba920-5051-41f0-be4c-b5425af80e17: close
2019-06-14 10:29:05,241 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 7ddba920-5051-41f0-be4c-b5425af80e17: shutdown group-D7FA8A9186B3
2019-06-14 10:29:05,241 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 7ddba920-5051-41f0-be4c-b5425af80e17: shutdown group-2E24075FED16
2019-06-14 10:29:05,241 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D7FA8A9186B3,id=7ddba920-5051-41f0-be4c-b5425af80e17
2019-06-14 10:29:05,242 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 7ddba920-5051-41f0-be4c-b5425af80e17: shutdown LeaderState
2019-06-14 10:29:05,241 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-2E24075FED16,id=7ddba920-5051-41f0-be4c-b5425af80e17
2019-06-14 10:29:05,242 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 7ddba920-5051-41f0-be4c-b5425af80e17-PendingRequests: sendNotLeaderResponses
2019-06-14 10:29:05,242 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 7ddba920-5051-41f0-be4c-b5425af80e17: shutdown LeaderState
2019-06-14 10:29:05,242 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-7ddba920-5051-41f0-be4c-b5425af80e17-group-D7FA8A9186B3: set stopIndex = 0
2019-06-14 10:29:05,242 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(7ddba920-5051-41f0-be4c-b5425af80e17 -> 7cc2898f-b3fe-4ae1-83f6-f7d4837df60d): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:29:05,242 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(7ddba920-5051-41f0-be4c-b5425af80e17 -> 65d9d079-0999-40a1-a2b6-fb43c5122fca): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:29:05,242 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 7ddba920-5051-41f0-be4c-b5425af80e17-PendingRequests: sendNotLeaderResponses
2019-06-14 10:29:05,242 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:29:05,243 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-7ddba920-5051-41f0-be4c-b5425af80e17-group-2E24075FED16: set stopIndex = 0
2019-06-14 10:29:05,243 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 7ddba920-5051-41f0-be4c-b5425af80e17:group-D7FA8A9186B3 closes. The last applied log index is 0
2019-06-14 10:29:05,243 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:29:05,243 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 7ddba920-5051-41f0-be4c-b5425af80e17-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:29:05,243 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 7ddba920-5051-41f0-be4c-b5425af80e17:group-2E24075FED16 closes. The last applied log index is 0
2019-06-14 10:29:05,244 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 7ddba920-5051-41f0-be4c-b5425af80e17-RaftLogWorker close()
2019-06-14 10:29:05,244 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 7ddba920-5051-41f0-be4c-b5425af80e17-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:29:05,247 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 7ddba920-5051-41f0-be4c-b5425af80e17-RaftLogWorker close()
2019-06-14 10:29:05,249 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 7ddba920-5051-41f0-be4c-b5425af80e17: shutdown server with port 38905 now
2019-06-14 10:29:05,249 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 7ddba920-5051-41f0-be4c-b5425af80e17: shutdown server with port 38905 successfully
2019-06-14 10:29:05,250 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:29:05,258 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:29:05,259 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@644eed73{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:29:05,259 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@253a8bdb{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:29:05,259 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@21a14c45{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:29:05,259 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@70c68e4e{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:29:05,279 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:29:05,283 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:29:05,283 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:29:05,283 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedBlocks
2019-06-14 10:29:05,283 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedBlocks
2019-06-14 10:29:05,283 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: validCerts
2019-06-14 10:29:05,283 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:validCerts
2019-06-14 10:29:05,284 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: revokedCerts
2019-06-14 10:29:05,284 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:revokedCerts
2019-06-14 10:29:05,284 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-14 10:29:05,284 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-14 10:29:05,284 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-14 10:29:05,324 INFO  node.SCMNodeManager (SCMNodeManager.java:<init>(108)) - Entering startup safe mode.
2019-06-14 10:29:05,324 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchemaFromFile(125)) - Loading file from sun.misc.CompoundEnumeration@2ffc9be
2019-06-14 10:29:05,325 INFO  net.NodeSchemaLoader (NodeSchemaLoader.java:loadSchema(171)) - Loading network topology layer schema file
2019-06-14 10:29:05,326 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:29:05,339 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:initializePipelineState(126)) - No pipeline exists in current db
2019-06-14 10:29:05,339 WARN  server.ServerUtils (ServerUtils.java:getScmDbDir(145)) - ozone.scm.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:29:05,353 WARN  events.EventQueue (EventQueue.java:fireEvent(175)) - No event handler registered for event TypedEvent{payloadType=SafeModeStatus, name='SafeModeStatus'}
2019-06-14 10:29:05,354 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:29:05,354 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 44463
2019-06-14 10:29:05,357 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:29:05,357 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 41413
2019-06-14 10:29:05,360 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:29:05,360 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 38837
2019-06-14 10:29:05,363 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for scm at: http://0.0.0.0:0
2019-06-14 10:29:05,364 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:29:05,364 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:29:05,365 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:29:05,365 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context scm
2019-06-14 10:29:05,365 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:29:05,366 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:29:05,367 INFO  server.StorageContainerManager (StorageContainerManager.java:start(752)) - StorageContainerLocationProtocol RPC server is listening at /0.0.0.0:38837
2019-06-14 10:29:05,368 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - StorageContainerManager metrics system started (again)
2019-06-14 10:29:05,377 INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:start(149)) - RPC server for Client  is listening at /0.0.0.0:38837
2019-06-14 10:29:05,378 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:29:05,387 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 38837: starting
2019-06-14 10:29:05,398 INFO  server.StorageContainerManager (StorageContainerManager.java:start(761)) - ScmBlockLocationProtocol RPC server is listening at /0.0.0.0:41413
2019-06-14 10:29:05,398 INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:start(137)) - RPC server for Block Protocol is listening at /0.0.0.0:41413
2019-06-14 10:29:05,398 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:29:05,400 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 41413: starting
2019-06-14 10:29:05,405 INFO  server.StorageContainerManager (StorageContainerManager.java:start(765)) - ScmDatanodeProtocl RPC server is listening at /0.0.0.0:44463
2019-06-14 10:29:05,405 INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:start(191)) - RPC server for DataNodes is listening at /0.0.0.0:44463
2019-06-14 10:29:05,405 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:29:05,405 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 44463: starting
2019-06-14 10:29:05,414 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 33853
2019-06-14 10:29:05,414 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:29:05,415 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@4ee9daf5{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:29:05,416 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@29ff84fa{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-14 10:29:05,419 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@1fcef7{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/scm/,AVAILABLE}{/scm}
2019-06-14 10:29:05,420 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@2f341732{HTTP/1.1,[http/1.1]}{0.0.0.0:33853}
2019-06-14 10:29:05,421 INFO  server.Server (Server.java:doStart(419)) - Started @110680ms
2019-06-14 10:29:05,422 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of SCM is listening at http://0.0.0.0:33853
2019-06-14 10:29:05,422 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:29:05,423 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:29:05,426 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:29:05,426 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(519)) - OM Service ID is not set. Setting it to the default ID: omServiceIdDefault
2019-06-14 10:29:05,426 INFO  om.OzoneManager (OzoneManager.java:setOMNodeDetails(525)) - OM Node ID is not set. Setting it to the OmStorage's OmID: 14203164-dea0-45c8-8dc0-34a0e932719f
2019-06-14 10:29:05,426 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 10:29:05,426 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 10:29:05,427 INFO  om.OzoneManager (OzoneManager.java:loadOMHAConfigs(476)) - Found matching OM address with OMServiceId: null, OMNodeId: null, RPC Address: localhost:0 and Ratis port: 9872
2019-06-14 10:29:05,433 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:29:05,433 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: userTable
2019-06-14 10:29:05,433 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:userTable
2019-06-14 10:29:05,433 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: volumeTable
2019-06-14 10:29:05,434 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:volumeTable
2019-06-14 10:29:05,434 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: bucketTable
2019-06-14 10:29:05,434 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:bucketTable
2019-06-14 10:29:05,434 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: keyTable
2019-06-14 10:29:05,434 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:keyTable
2019-06-14 10:29:05,435 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: deletedTable
2019-06-14 10:29:05,435 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:deletedTable
2019-06-14 10:29:05,435 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: openKeyTable
2019-06-14 10:29:05,435 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:openKeyTable
2019-06-14 10:29:05,435 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3Table
2019-06-14 10:29:05,435 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3Table
2019-06-14 10:29:05,436 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: multipartInfoTable
2019-06-14 10:29:05,436 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:multipartInfoTable
2019-06-14 10:29:05,436 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: dTokenTable
2019-06-14 10:29:05,436 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:dTokenTable
2019-06-14 10:29:05,436 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: s3SecretTable
2019-06-14 10:29:05,437 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:s3SecretTable
2019-06-14 10:29:05,437 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: prefixTable
2019-06-14 10:29:05,437 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(161)) - Using default column profile:DBProfile.DISK for Table:prefixTable
2019-06-14 10:29:05,437 INFO  db.DBStoreBuilder (DBStoreBuilder.java:addTable(110)) - using custom profile for table: default
2019-06-14 10:29:05,437 INFO  db.DBStoreBuilder (DBStoreBuilder.java:processTables(167)) - Using default column profile:DBProfile.DISK for Table:default
2019-06-14 10:29:05,437 INFO  db.DBStoreBuilder (DBStoreBuilder.java:getDbProfile(198)) - Using default options. DBProfile.DISK
2019-06-14 10:29:05,461 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1121, electionTimeout:1121ms
2019-06-14 10:29:05,461 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:29:05,461 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 26 for changeToCandidate
2019-06-14 10:29:05,461 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:29:05,463 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection91: begin an election at term 27 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:05,464 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection91 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:05,464 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection91 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:05,464 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection91: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t27, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:05,465 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:05,465 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:05,465 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 27 for DISCOVERED_A_NEW_TERM
2019-06-14 10:29:05,465 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:29:05,465 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:29:05,566 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue, queueCapacity: 2000, scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler, ipcBackoff: false.
2019-06-14 10:29:05,566 INFO  ipc.Server (Server.java:run(1074)) - Starting Socket Reader #1 for port 44719
2019-06-14 10:29:05,578 WARN  scm.ScmUtils (ScmUtils.java:getDBPath(63)) - ozone.om.db.dirs is not configured. We recommend adding this setting. Falling back to ozone.metadata.dirs instead.
2019-06-14 10:29:05,578 INFO  om.OzoneManager (OzoneManager.java:start(1217)) - OzoneManager RPC server is listening at localhost/127.0.0.1:44719
2019-06-14 10:29:05,578 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - OzoneManager metrics system started (again)
2019-06-14 10:29:05,579 INFO  ipc.Server (Server.java:run(1153)) - IPC Server listener on 44719: starting
2019-06-14 10:29:05,579 INFO  ipc.Server (Server.java:run(1314)) - IPC Server Responder: starting
2019-06-14 10:29:05,583 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for ozoneManager at: http://0.0.0.0:0
2019-06-14 10:29:05,584 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:29:05,584 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:29:05,586 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:29:05,586 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context ozoneManager
2019-06-14 10:29:05,586 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:29:05,586 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:29:05,587 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 33511
2019-06-14 10:29:05,587 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:29:05,588 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@4540aade{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:29:05,588 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@38cbbd0b{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,AVAILABLE}
2019-06-14 10:29:05,590 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@269a37bc{/,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/ozoneManager/,AVAILABLE}{/ozoneManager}
2019-06-14 10:29:05,590 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@106e816c{HTTP/1.1,[http/1.1]}{0.0.0.0:33511}
2019-06-14 10:29:05,592 INFO  server.Server (Server.java:doStart(419)) - Started @110851ms
2019-06-14 10:29:05,593 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of OZONEMANAGER is listening at http://0.0.0.0:33511
2019-06-14 10:29:05,600 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:29:05,600 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:29:05,608 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-0/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:29:05,608 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-0/data/containers/hdds to VolumeSet
2019-06-14 10:29:05,609 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@46977829
2019-06-14 10:29:05,609 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@46977829
2019-06-14 10:29:05,616 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 46155
2019-06-14 10:29:05,618 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:29:05,619 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 46155 (custom)
2019-06-14 10:29:05,619 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:29:05,619 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:29:05,619 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:29:05,619 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:29:05,619 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-0/data/ratis] (custom)
2019-06-14 10:29:05,620 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 33721
2019-06-14 10:29:05,620 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:29:05,621 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:29:05,621 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:29:05,622 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:29:05,622 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:29:05,623 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:29:05,623 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:29:05,623 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:29:05,623 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 45783
2019-06-14 10:29:05,623 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:29:05,625 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@77227b1f{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:29:05,625 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@34e4a136{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:29:05,646 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@4620e669{/,file:///tmp/jetty-0.0.0.0-45783-hddsDatanode-_-any-1391884601868424095.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:29:05,646 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@4b93a232{HTTP/1.1,[http/1.1]}{0.0.0.0:45783}
2019-06-14 10:29:05,648 INFO  server.Server (Server.java:doStart(419)) - Started @110907ms
2019-06-14 10:29:05,649 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:45783
Jun 14, 2019 10:29:05 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:29:05,737 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@2b8106f
2019-06-14 10:29:05,737 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:29:05,737 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:29:05,738 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:29:05,739 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-0/meta/datanode.id
2019-06-14 10:29:05,744 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-1/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:29:05,744 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-1/data/containers/hdds to VolumeSet
2019-06-14 10:29:05,744 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@2fba15c5
2019-06-14 10:29:05,744 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@2fba15c5
2019-06-14 10:29:05,753 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 46251
2019-06-14 10:29:05,759 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:29:05,759 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 46251 (custom)
2019-06-14 10:29:05,759 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:29:05,759 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:29:05,759 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:29:05,759 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:29:05,760 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-1/data/ratis] (custom)
2019-06-14 10:29:05,760 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 43797
2019-06-14 10:29:05,760 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:29:05,761 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:29:05,770 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:29:05,770 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:29:05,771 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:29:05,771 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:29:05,771 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:29:05,772 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:29:05,772 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 45893
2019-06-14 10:29:05,772 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:29:05,773 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@5d3c0735{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:29:05,774 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@11034fdb{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:29:05,795 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@6dc8a602{/,file:///tmp/jetty-0.0.0.0-45893-hddsDatanode-_-any-5134083679113422525.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:29:05,795 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@2a45c6f0{HTTP/1.1,[http/1.1]}{0.0.0.0:45893}
2019-06-14 10:29:05,801 INFO  server.Server (Server.java:doStart(419)) - Started @111059ms
2019-06-14 10:29:05,801 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:45893
Jun 14, 2019 10:29:05 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:29:05,878 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@69e346b3
2019-06-14 10:29:05,879 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:29:05,879 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:29:05,880 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:29:05,881 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-1/meta/datanode.id
2019-06-14 10:29:05,886 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-2/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:29:05,887 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-2/data/containers/hdds to VolumeSet
2019-06-14 10:29:05,887 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@182ce25e
2019-06-14 10:29:05,887 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@182ce25e
2019-06-14 10:29:05,897 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 38757
2019-06-14 10:29:05,900 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:29:05,900 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 38757 (custom)
2019-06-14 10:29:05,900 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:29:05,900 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:29:05,901 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:29:05,901 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:29:05,901 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-2/data/ratis] (custom)
2019-06-14 10:29:05,902 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 37397
2019-06-14 10:29:05,902 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:29:05,903 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:29:05,904 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:29:05,905 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:29:05,906 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:29:05,906 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:29:05,906 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:29:05,907 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:29:05,907 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 44813
2019-06-14 10:29:05,907 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:29:05,958 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@6ce7d6ab{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:29:05,958 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@21288943{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:29:05,980 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@1ac8f29c{/,file:///tmp/jetty-0.0.0.0-44813-hddsDatanode-_-any-2368704098190880039.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:29:05,980 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@1d07d728{HTTP/1.1,[http/1.1]}{0.0.0.0:44813}
2019-06-14 10:29:05,983 INFO  server.Server (Server.java:doStart(419)) - Started @111241ms
2019-06-14 10:29:05,983 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:44813
Jun 14, 2019 10:29:05 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:29:06,064 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@673ce246
2019-06-14 10:29:06,064 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:29:06,065 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:29:06,065 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:29:06,066 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-2/meta/datanode.id
2019-06-14 10:29:06,073 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-3/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:29:06,073 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-3/data/containers/hdds to VolumeSet
2019-06-14 10:29:06,073 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@50a2034c
2019-06-14 10:29:06,073 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@50a2034c
2019-06-14 10:29:06,081 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 33041
2019-06-14 10:29:06,084 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:29:06,084 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 33041 (custom)
2019-06-14 10:29:06,086 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:29:06,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:29:06,086 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:29:06,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:29:06,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-3/data/ratis] (custom)
2019-06-14 10:29:06,087 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 34949
2019-06-14 10:29:06,087 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:29:06,088 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:29:06,089 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:29:06,089 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:29:06,090 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:29:06,090 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:29:06,090 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:29:06,091 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:29:06,091 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 32867
2019-06-14 10:29:06,091 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:29:06,092 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@79f14c56{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:29:06,093 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@73790bb5{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:29:06,113 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@764bf20d{/,file:///tmp/jetty-0.0.0.0-32867-hddsDatanode-_-any-6146246628560778087.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:29:06,114 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@363bf9d{HTTP/1.1,[http/1.1]}{0.0.0.0:32867}
2019-06-14 10:29:06,116 INFO  server.Server (Server.java:doStart(419)) - Started @111374ms
2019-06-14 10:29:06,116 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:32867
Jun 14, 2019 10:29:06 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:29:06,204 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@e8bd42f
2019-06-14 10:29:06,204 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:29:06,205 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:29:06,205 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:29:06,206 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-3/meta/datanode.id
2019-06-14 10:29:06,212 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-4/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:29:06,212 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-4/data/containers/hdds to VolumeSet
2019-06-14 10:29:06,212 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@7985c32f
2019-06-14 10:29:06,212 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@7985c32f
2019-06-14 10:29:06,221 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 38401
2019-06-14 10:29:06,223 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:29:06,224 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 38401 (custom)
2019-06-14 10:29:06,224 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:29:06,224 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:29:06,224 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:29:06,224 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:29:06,225 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-4/data/ratis] (custom)
2019-06-14 10:29:06,225 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 35551
2019-06-14 10:29:06,229 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:29:06,230 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:29:06,231 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:29:06,232 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:29:06,233 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:29:06,233 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:29:06,234 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:29:06,234 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:29:06,234 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 43237
2019-06-14 10:29:06,234 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:29:06,235 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@4d08fee2{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:29:06,236 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@421f447f{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:29:06,257 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@591be976{/,file:///tmp/jetty-0.0.0.0-43237-hddsDatanode-_-any-8877596208778685331.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:29:06,257 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@520f1862{HTTP/1.1,[http/1.1]}{0.0.0.0:43237}
2019-06-14 10:29:06,257 INFO  server.Server (Server.java:doStart(419)) - Started @111516ms
2019-06-14 10:29:06,258 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:43237
Jun 14, 2019 10:29:06 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:29:06,334 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@79c4c973
2019-06-14 10:29:06,335 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - HddsDatanode metrics system started (again)
2019-06-14 10:29:06,335 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:start(185)) - HddsDatanodeService host:ozone-cf6ld-438179620 ip:192.168.46.40
2019-06-14 10:29:06,338 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:29:06,338 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-4/meta/datanode.id
2019-06-14 10:29:06,343 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-5/data/containers/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 10:29:06,343 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-5/data/containers/hdds to VolumeSet
2019-06-14 10:29:06,343 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@5519ee60
2019-06-14 10:29:06,344 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@5519ee60
2019-06-14 10:29:06,352 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 37649
2019-06-14 10:29:06,354 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 10:29:06,354 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 37649 (custom)
2019-06-14 10:29:06,354 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 10:29:06,354 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:29:06,354 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 10:29:06,354 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:29:06,355 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-5/data/ratis] (custom)
2019-06-14 10:29:06,355 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 39015
2019-06-14 10:29:06,355 INFO  replication.SimpleContainerDownloader (SimpleContainerDownloader.java:<init>(72)) - Starting container downloader service to copy containers to replicate.
2019-06-14 10:29:06,356 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1641)) - Starting Web-server for hddsDatanode at: http://0.0.0.0:0
2019-06-14 10:29:06,357 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2019-06-14 10:29:06,357 WARN  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(97)) - Jetty request log can only be enabled using Log4j
2019-06-14 10:29:06,358 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(975)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2019-06-14 10:29:06,358 INFO  http.HttpServer2 (HttpServer2.java:addFilter(948)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hddsDatanode
2019-06-14 10:29:06,359 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2019-06-14 10:29:06,359 INFO  http.HttpServer2 (HttpServer2.java:addFilter(958)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2019-06-14 10:29:06,359 INFO  http.HttpServer2 (HttpServer2.java:bindListener(1191)) - Jetty bound to port 36623
2019-06-14 10:29:06,359 INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2019-06-14 10:29:06,360 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@701c092c{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,AVAILABLE}
2019-06-14 10:29:06,360 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@590182a6{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,AVAILABLE}
2019-06-14 10:29:06,381 INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@316745d8{/,file:///tmp/jetty-0.0.0.0-36623-hddsDatanode-_-any-7509032711374814890.dir/webapp/,AVAILABLE}{/hddsDatanode}
2019-06-14 10:29:06,381 INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@3df920{HTTP/1.1,[http/1.1]}{0.0.0.0:36623}
2019-06-14 10:29:06,383 INFO  server.Server (Server.java:doStart(419)) - Started @111641ms
2019-06-14 10:29:06,383 INFO  server.BaseHttpServer (BaseHttpServer.java:updateConnectorAddress(207)) - HTTP server of HDDSDATANODE is listening at http://0.0.0.0:36623
Jun 14, 2019 10:29:06 AM com.sun.jersey.server.impl.application.WebApplicationImpl _initiate
INFO: Initiating Jersey application, version 'Jersey: 1.19 02/11/2015 03:25 AM'
2019-06-14 10:29:06,458 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:startPlugins(396)) - Started plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@537979aa
2019-06-14 10:29:06,458 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:29:06,459 INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2019-06-14 10:29:06,460 INFO  datanode.InitDatanodeState (InitDatanodeState.java:persistContainerDatanodeDetails(140)) - DatanodeDetails is persisted to /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-5/meta/datanode.id
2019-06-14 10:29:06,611 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1146, electionTimeout:1146ms
2019-06-14 10:29:06,611 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:29:06,612 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 27 for changeToCandidate
2019-06-14 10:29:06,612 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:29:06,615 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection92: begin an election at term 28 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:06,616 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection92 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:06,621 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection92 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:06,622 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection92: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t28, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:06,622 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:06,622 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:06,622 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 28 for DISCOVERED_A_NEW_TERM
2019-06-14 10:29:06,622 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:29:06,622 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:29:07,296 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-14 10:29:07,458 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:29:07,496 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-14 10:29:07,648 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1025, electionTimeout:1025ms
2019-06-14 10:29:07,648 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:29:07,648 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 28 for changeToCandidate
2019-06-14 10:29:07,648 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:29:07,650 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection93: begin an election at term 29 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:07,651 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection93 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:07,651 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection93 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:07,651 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection93: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t29, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:07,651 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:07,652 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:07,652 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 29 for DISCOVERED_A_NEW_TERM
2019-06-14 10:29:07,652 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:29:07,652 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:29:07,696 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-14 10:29:07,745 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:29:07,746 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:29:07,746 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 57371422-cdf4-4019-b910-8bdfd13d3042 at port 46155
2019-06-14 10:29:07,749 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 57371422-cdf4-4019-b910-8bdfd13d3042: start RPC server
2019-06-14 10:29:07,750 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 57371422-cdf4-4019-b910-8bdfd13d3042: GrpcService started, listening on 0.0.0.0/0.0.0.0:46155
2019-06-14 10:29:07,797 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-14 10:29:07,797 WARN  events.EventQueue (EventQueue.java:fireEvent(147)) - Processing of TypedEvent{payloadType=DatanodeDetails, name='Stale_Node'} is skipped, EventQueue is not running
2019-06-14 10:29:07,882 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:29:07,882 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:29:07,882 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 171f5ea1-4e80-461d-a416-e5869a7bc19d at port 46251
2019-06-14 10:29:07,886 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: start RPC server
2019-06-14 10:29:07,886 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: GrpcService started, listening on 0.0.0.0/0.0.0.0:46251
2019-06-14 10:29:08,068 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:29:08,068 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:29:08,068 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis f7b15b21-0c63-4ad6-a80e-afed583276bc at port 38757
2019-06-14 10:29:08,071 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: start RPC server
2019-06-14 10:29:08,072 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: GrpcService started, listening on 0.0.0.0/0.0.0.0:38757
2019-06-14 10:29:08,208 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:29:08,208 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:29:08,208 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 918fd2a8-d728-4869-bad5-c7f6d75fff19 at port 33041
2019-06-14 10:29:08,212 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: start RPC server
2019-06-14 10:29:08,212 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: GrpcService started, listening on 0.0.0.0/0.0.0.0:33041
2019-06-14 10:29:08,341 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:29:08,341 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:29:08,341 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 090e4df3-5a2c-401f-9461-61991e9fc29d at port 38401
2019-06-14 10:29:08,344 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: start RPC server
2019-06-14 10:29:08,345 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: GrpcService started, listening on 0.0.0.0/0.0.0.0:38401
2019-06-14 10:29:08,458 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:29:08,461 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 10:29:08,461 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 10:29:08,462 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 9be33dce-856e-46ae-b2e2-37061770f2b7 at port 37649
2019-06-14 10:29:08,465 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: start RPC server
2019-06-14 10:29:08,465 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: GrpcService started, listening on 0.0.0.0/0.0.0.0:37649
2019-06-14 10:29:08,823 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1171, electionTimeout:1171ms
2019-06-14 10:29:08,823 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:29:08,823 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 29 for changeToCandidate
2019-06-14 10:29:08,823 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:29:08,826 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection94: begin an election at term 30 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:08,827 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection94 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:08,827 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection94 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:08,827 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection94: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t30, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:08,827 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:08,827 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:08,827 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 30 for DISCOVERED_A_NEW_TERM
2019-06-14 10:29:08,827 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:29:08,827 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:29:09,459 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 0 of 6 DN Heartbeats.
2019-06-14 10:29:09,742 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 57371422-cdf4-4019-b910-8bdfd13d3042{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:29:09,746 INFO  safemode.SCMSafeModeManager (DataNodeSafeModeRule.java:process(71)) - SCM in safe mode. 1 DataNodes registered, 1 required.
2019-06-14 10:29:09,748 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:validateSafeModeExitRules(177)) - ScmSafeModeManager, all rules are successfully validated
2019-06-14 10:29:09,748 INFO  safemode.SCMSafeModeManager (SCMSafeModeManager.java:exitSafeMode(193)) - SCM exiting safe mode.
2019-06-14 10:29:09,753 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 57371422-cdf4-4019-b910-8bdfd13d3042: addNew group-2F1ACBD713C8:[57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155] returns group-2F1ACBD713C8:java.util.concurrent.CompletableFuture@3a4076b7[Not completed]
2019-06-14 10:29:09,753 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 57371422-cdf4-4019-b910-8bdfd13d3042: new RaftServerImpl for group-2F1ACBD713C8:[57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155] with ContainerStateMachine:uninitialized
2019-06-14 10:29:09,753 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:29:09,753 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:29:09,753 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:29:09,753 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:29:09,754 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 57371422-cdf4-4019-b910-8bdfd13d3042:group-2F1ACBD713C8 ConfigurationManager, init=-1: [57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155], old=null, confs=<EMPTY_MAP>
2019-06-14 10:29:09,754 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-0/data/ratis] (custom)
2019-06-14 10:29:09,754 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-0/data/ratis/ac1c40f4-0bcd-4f99-a229-2f1acbd713c8 does not exist. Creating ...
2019-06-14 10:29:09,756 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-0/data/ratis/ac1c40f4-0bcd-4f99-a229-2f1acbd713c8/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:29:09,758 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-0/data/ratis/ac1c40f4-0bcd-4f99-a229-2f1acbd713c8 has been successfully formatted.
2019-06-14 10:29:09,758 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:29:09,758 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:29:09,758 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:29:09,758 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:29:09,758 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:29:09,758 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:29:09,759 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 57371422-cdf4-4019-b910-8bdfd13d3042-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-0/data/ratis/ac1c40f4-0bcd-4f99-a229-2f1acbd713c8
2019-06-14 10:29:09,759 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:29:09,759 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:29:09,759 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:29:09,759 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:29:09,759 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:29:09,759 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:29:09,759 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:29:09,759 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:29:09,759 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:29:09,759 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:29:09,759 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:29:09,760 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:29:09,760 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:29:09,760 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 57371422-cdf4-4019-b910-8bdfd13d3042: start group-2F1ACBD713C8
2019-06-14 10:29:09,760 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 57371422-cdf4-4019-b910-8bdfd13d3042:group-2F1ACBD713C8 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:29:09,760 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 57371422-cdf4-4019-b910-8bdfd13d3042: start FollowerState
2019-06-14 10:29:09,760 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-2F1ACBD713C8,id=57371422-cdf4-4019-b910-8bdfd13d3042
2019-06-14 10:29:09,761 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: ac1c40f4-0bcd-4f99-a229-2f1acbd713c8, Nodes: 57371422-cdf4-4019-b910-8bdfd13d3042{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:29:09,880 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 171f5ea1-4e80-461d-a416-e5869a7bc19d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:29:09,886 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: addNew group-C511289E0BCC:[171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251] returns group-C511289E0BCC:java.util.concurrent.CompletableFuture@551c89ab[Not completed]
2019-06-14 10:29:09,887 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: new RaftServerImpl for group-C511289E0BCC:[171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251] with ContainerStateMachine:uninitialized
2019-06-14 10:29:09,887 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:29:09,887 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:29:09,887 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:29:09,887 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:29:09,887 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d:group-C511289E0BCC ConfigurationManager, init=-1: [171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251], old=null, confs=<EMPTY_MAP>
2019-06-14 10:29:09,887 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-1/data/ratis] (custom)
2019-06-14 10:29:09,887 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-1/data/ratis/2d27f428-565e-4ee4-b4e0-c511289e0bcc does not exist. Creating ...
2019-06-14 10:29:09,889 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-1/data/ratis/2d27f428-565e-4ee4-b4e0-c511289e0bcc/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:29:09,891 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-1/data/ratis/2d27f428-565e-4ee4-b4e0-c511289e0bcc has been successfully formatted.
2019-06-14 10:29:09,891 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:29:09,891 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:29:09,891 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:29:09,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:29:09,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:29:09,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:29:09,892 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 171f5ea1-4e80-461d-a416-e5869a7bc19d-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-1/data/ratis/2d27f428-565e-4ee4-b4e0-c511289e0bcc
2019-06-14 10:29:09,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:29:09,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:29:09,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:29:09,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:29:09,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:29:09,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:29:09,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:29:09,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:29:09,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:29:09,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:29:09,893 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:29:09,893 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:29:09,893 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:29:09,893 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: start group-C511289E0BCC
2019-06-14 10:29:09,893 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d:group-C511289E0BCC changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:29:09,893 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: start FollowerState
2019-06-14 10:29:09,893 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C511289E0BCC,id=171f5ea1-4e80-461d-a416-e5869a7bc19d
2019-06-14 10:29:09,894 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 2d27f428-565e-4ee4-b4e0-c511289e0bcc, Nodes: 171f5ea1-4e80-461d-a416-e5869a7bc19d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:29:09,930 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1102, electionTimeout:1102ms
2019-06-14 10:29:09,930 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:29:09,930 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 30 for changeToCandidate
2019-06-14 10:29:09,930 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:29:09,933 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection95: begin an election at term 31 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:09,933 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection95 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:09,933 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection95 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:09,934 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection95: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t31, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:09,934 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:09,934 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:09,934 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 31 for DISCOVERED_A_NEW_TERM
2019-06-14 10:29:09,934 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:29:09,934 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:29:10,066 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : f7b15b21-0c63-4ad6-a80e-afed583276bc{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:29:10,075 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: addNew group-1811AC1DC160:[f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757] returns group-1811AC1DC160:java.util.concurrent.CompletableFuture@3e0c63be[Not completed]
2019-06-14 10:29:10,075 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: new RaftServerImpl for group-1811AC1DC160:[f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757] with ContainerStateMachine:uninitialized
2019-06-14 10:29:10,075 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:29:10,075 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:29:10,075 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:29:10,075 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:29:10,075 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-1811AC1DC160 ConfigurationManager, init=-1: [f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757], old=null, confs=<EMPTY_MAP>
2019-06-14 10:29:10,076 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-2/data/ratis] (custom)
2019-06-14 10:29:10,076 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-2/data/ratis/f1189f7d-85e3-40e9-9435-1811ac1dc160 does not exist. Creating ...
2019-06-14 10:29:10,078 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-2/data/ratis/f1189f7d-85e3-40e9-9435-1811ac1dc160/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:29:10,079 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-2/data/ratis/f1189f7d-85e3-40e9-9435-1811ac1dc160 has been successfully formatted.
2019-06-14 10:29:10,080 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:29:10,080 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:29:10,080 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:29:10,080 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:29:10,080 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:29:10,080 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:29:10,080 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new f7b15b21-0c63-4ad6-a80e-afed583276bc-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-2/data/ratis/f1189f7d-85e3-40e9-9435-1811ac1dc160
2019-06-14 10:29:10,080 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:29:10,080 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:29:10,080 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:29:10,080 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:29:10,080 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:29:10,080 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:29:10,080 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:29:10,080 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:29:10,081 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:29:10,081 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:29:10,081 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:29:10,081 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:29:10,081 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:29:10,081 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: start group-1811AC1DC160
2019-06-14 10:29:10,081 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-1811AC1DC160 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:29:10,081 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: start FollowerState
2019-06-14 10:29:10,081 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-1811AC1DC160,id=f7b15b21-0c63-4ad6-a80e-afed583276bc
2019-06-14 10:29:10,082 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: f1189f7d-85e3-40e9-9435-1811ac1dc160, Nodes: f7b15b21-0c63-4ad6-a80e-afed583276bc{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:29:10,100 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: addNew group-20E2BD1544BA:[f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757, 171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251, 57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155] returns group-20E2BD1544BA:java.util.concurrent.CompletableFuture@6696d6b9[Not completed]
2019-06-14 10:29:10,100 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: new RaftServerImpl for group-20E2BD1544BA:[f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757, 171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251, 57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155] with ContainerStateMachine:uninitialized
2019-06-14 10:29:10,100 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:29:10,100 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:29:10,100 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:29:10,101 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:29:10,101 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA ConfigurationManager, init=-1: [f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757, 171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251, 57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155], old=null, confs=<EMPTY_MAP>
2019-06-14 10:29:10,101 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-2/data/ratis] (custom)
2019-06-14 10:29:10,101 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-2/data/ratis/f01c641c-4ee0-44f9-8fb5-20e2bd1544ba does not exist. Creating ...
2019-06-14 10:29:10,103 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-2/data/ratis/f01c641c-4ee0-44f9-8fb5-20e2bd1544ba/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:29:10,105 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-2/data/ratis/f01c641c-4ee0-44f9-8fb5-20e2bd1544ba has been successfully formatted.
2019-06-14 10:29:10,109 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: addNew group-20E2BD1544BA:[f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757, 171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251, 57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155] returns group-20E2BD1544BA:java.util.concurrent.CompletableFuture@1cbf53c1[Not completed]
2019-06-14 10:29:10,109 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:29:10,109 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 57371422-cdf4-4019-b910-8bdfd13d3042: addNew group-20E2BD1544BA:[f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757, 171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251, 57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155] returns group-20E2BD1544BA:java.util.concurrent.CompletableFuture@749bd09f[Not completed]
2019-06-14 10:29:10,109 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:29:10,109 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: new RaftServerImpl for group-20E2BD1544BA:[f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757, 171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251, 57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155] with ContainerStateMachine:uninitialized
2019-06-14 10:29:10,109 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 57371422-cdf4-4019-b910-8bdfd13d3042: new RaftServerImpl for group-20E2BD1544BA:[f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757, 171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251, 57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155] with ContainerStateMachine:uninitialized
2019-06-14 10:29:10,110 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:29:10,110 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:29:10,110 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:29:10,110 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:29:10,110 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 57371422-cdf4-4019-b910-8bdfd13d3042:group-20E2BD1544BA ConfigurationManager, init=-1: [f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757, 171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251, 57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155], old=null, confs=<EMPTY_MAP>
2019-06-14 10:29:10,110 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-0/data/ratis] (custom)
2019-06-14 10:29:10,110 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-0/data/ratis/f01c641c-4ee0-44f9-8fb5-20e2bd1544ba does not exist. Creating ...
2019-06-14 10:29:10,109 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:29:10,109 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:29:10,111 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:29:10,111 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:29:10,111 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:29:10,111 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:29:10,111 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:29:10,111 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:29:10,111 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new f7b15b21-0c63-4ad6-a80e-afed583276bc-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-2/data/ratis/f01c641c-4ee0-44f9-8fb5-20e2bd1544ba
2019-06-14 10:29:10,111 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d:group-20E2BD1544BA ConfigurationManager, init=-1: [f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757, 171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251, 57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155], old=null, confs=<EMPTY_MAP>
2019-06-14 10:29:10,111 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:29:10,111 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-1/data/ratis] (custom)
2019-06-14 10:29:10,111 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:29:10,112 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-1/data/ratis/f01c641c-4ee0-44f9-8fb5-20e2bd1544ba does not exist. Creating ...
2019-06-14 10:29:10,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:29:10,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:29:10,112 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-0/data/ratis/f01c641c-4ee0-44f9-8fb5-20e2bd1544ba/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:29:10,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:29:10,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:29:10,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:29:10,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:29:10,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:29:10,113 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:29:10,113 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:29:10,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:29:10,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:29:10,114 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-0/data/ratis/f01c641c-4ee0-44f9-8fb5-20e2bd1544ba has been successfully formatted.
2019-06-14 10:29:10,114 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:29:10,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:29:10,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:29:10,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:29:10,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:29:10,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:29:10,114 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 57371422-cdf4-4019-b910-8bdfd13d3042-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-0/data/ratis/f01c641c-4ee0-44f9-8fb5-20e2bd1544ba
2019-06-14 10:29:10,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:29:10,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:29:10,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:29:10,115 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:29:10,115 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:29:10,115 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-1/data/ratis/f01c641c-4ee0-44f9-8fb5-20e2bd1544ba/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:29:10,115 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: start group-20E2BD1544BA
2019-06-14 10:29:10,115 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:29:10,115 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:29:10,115 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:29:10,115 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: start FollowerState
2019-06-14 10:29:10,115 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:29:10,115 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:29:10,115 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-20E2BD1544BA,id=f7b15b21-0c63-4ad6-a80e-afed583276bc
2019-06-14 10:29:10,115 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:29:10,116 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:29:10,116 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:29:10,116 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:29:10,117 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 57371422-cdf4-4019-b910-8bdfd13d3042: start group-20E2BD1544BA
2019-06-14 10:29:10,117 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 57371422-cdf4-4019-b910-8bdfd13d3042:group-20E2BD1544BA changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:29:10,117 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 57371422-cdf4-4019-b910-8bdfd13d3042: start FollowerState
2019-06-14 10:29:10,117 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-1/data/ratis/f01c641c-4ee0-44f9-8fb5-20e2bd1544ba has been successfully formatted.
2019-06-14 10:29:10,117 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-20E2BD1544BA,id=57371422-cdf4-4019-b910-8bdfd13d3042
2019-06-14 10:29:10,117 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:29:10,117 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:29:10,117 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:29:10,117 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:29:10,117 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:29:10,117 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:29:10,118 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 171f5ea1-4e80-461d-a416-e5869a7bc19d-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-1/data/ratis/f01c641c-4ee0-44f9-8fb5-20e2bd1544ba
2019-06-14 10:29:10,118 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:29:10,118 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:29:10,118 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:29:10,118 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:29:10,118 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:29:10,118 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:29:10,118 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:29:10,118 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:29:10,118 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:29:10,118 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:29:10,119 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:29:10,119 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:29:10,119 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:29:10,119 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: start group-20E2BD1544BA
2019-06-14 10:29:10,119 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d:group-20E2BD1544BA changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:29:10,119 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: start FollowerState
2019-06-14 10:29:10,119 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-20E2BD1544BA,id=171f5ea1-4e80-461d-a416-e5869a7bc19d
2019-06-14 10:29:10,120 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: f01c641c-4ee0-44f9-8fb5-20e2bd1544ba, Nodes: 171f5ea1-4e80-461d-a416-e5869a7bc19d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}57371422-cdf4-4019-b910-8bdfd13d3042{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}f7b15b21-0c63-4ad6-a80e-afed583276bc{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-14 10:29:10,207 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 918fd2a8-d728-4869-bad5-c7f6d75fff19{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:29:10,213 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: addNew group-553A09606F97:[918fd2a8-d728-4869-bad5-c7f6d75fff19:192.168.46.40:33041] returns group-553A09606F97:java.util.concurrent.CompletableFuture@1dcdf656[Not completed]
2019-06-14 10:29:10,213 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: new RaftServerImpl for group-553A09606F97:[918fd2a8-d728-4869-bad5-c7f6d75fff19:192.168.46.40:33041] with ContainerStateMachine:uninitialized
2019-06-14 10:29:10,213 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:29:10,213 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:29:10,213 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:29:10,213 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:29:10,213 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19:group-553A09606F97 ConfigurationManager, init=-1: [918fd2a8-d728-4869-bad5-c7f6d75fff19:192.168.46.40:33041], old=null, confs=<EMPTY_MAP>
2019-06-14 10:29:10,213 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-3/data/ratis] (custom)
2019-06-14 10:29:10,214 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-3/data/ratis/8be4bc42-e323-48fa-8625-553a09606f97 does not exist. Creating ...
2019-06-14 10:29:10,216 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-3/data/ratis/8be4bc42-e323-48fa-8625-553a09606f97/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:29:10,217 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-3/data/ratis/8be4bc42-e323-48fa-8625-553a09606f97 has been successfully formatted.
2019-06-14 10:29:10,218 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:29:10,218 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:29:10,218 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:29:10,218 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:29:10,218 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:29:10,218 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:29:10,218 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 918fd2a8-d728-4869-bad5-c7f6d75fff19-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-3/data/ratis/8be4bc42-e323-48fa-8625-553a09606f97
2019-06-14 10:29:10,218 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:29:10,218 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:29:10,218 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:29:10,218 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:29:10,218 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:29:10,218 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:29:10,218 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:29:10,218 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:29:10,219 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:29:10,219 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:29:10,219 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:29:10,219 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:29:10,219 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:29:10,219 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: start group-553A09606F97
2019-06-14 10:29:10,219 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19:group-553A09606F97 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:29:10,219 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: start FollowerState
2019-06-14 10:29:10,219 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-553A09606F97,id=918fd2a8-d728-4869-bad5-c7f6d75fff19
2019-06-14 10:29:10,221 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 8be4bc42-e323-48fa-8625-553a09606f97, Nodes: 918fd2a8-d728-4869-bad5-c7f6d75fff19{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:29:10,339 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 090e4df3-5a2c-401f-9461-61991e9fc29d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:29:10,344 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: addNew group-D805F6AE7DF8:[090e4df3-5a2c-401f-9461-61991e9fc29d:192.168.46.40:38401] returns group-D805F6AE7DF8:java.util.concurrent.CompletableFuture@7bd6ec6c[Not completed]
2019-06-14 10:29:10,344 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: new RaftServerImpl for group-D805F6AE7DF8:[090e4df3-5a2c-401f-9461-61991e9fc29d:192.168.46.40:38401] with ContainerStateMachine:uninitialized
2019-06-14 10:29:10,345 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:29:10,345 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:29:10,345 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:29:10,345 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:29:10,345 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 090e4df3-5a2c-401f-9461-61991e9fc29d:group-D805F6AE7DF8 ConfigurationManager, init=-1: [090e4df3-5a2c-401f-9461-61991e9fc29d:192.168.46.40:38401], old=null, confs=<EMPTY_MAP>
2019-06-14 10:29:10,345 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-4/data/ratis] (custom)
2019-06-14 10:29:10,345 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-4/data/ratis/ef1e97bd-491c-4684-913f-d805f6ae7df8 does not exist. Creating ...
2019-06-14 10:29:10,347 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-4/data/ratis/ef1e97bd-491c-4684-913f-d805f6ae7df8/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:29:10,349 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-4/data/ratis/ef1e97bd-491c-4684-913f-d805f6ae7df8 has been successfully formatted.
2019-06-14 10:29:10,349 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:29:10,349 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:29:10,350 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:29:10,350 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:29:10,350 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:29:10,350 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:29:10,350 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 090e4df3-5a2c-401f-9461-61991e9fc29d-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-4/data/ratis/ef1e97bd-491c-4684-913f-d805f6ae7df8
2019-06-14 10:29:10,350 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:29:10,350 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:29:10,350 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:29:10,350 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:29:10,350 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:29:10,350 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:29:10,350 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:29:10,350 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:29:10,350 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:29:10,350 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:29:10,351 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:29:10,351 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:29:10,351 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:29:10,351 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: start group-D805F6AE7DF8
2019-06-14 10:29:10,351 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 090e4df3-5a2c-401f-9461-61991e9fc29d:group-D805F6AE7DF8 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:29:10,351 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: start FollowerState
2019-06-14 10:29:10,351 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D805F6AE7DF8,id=090e4df3-5a2c-401f-9461-61991e9fc29d
2019-06-14 10:29:10,352 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: ef1e97bd-491c-4684-913f-d805f6ae7df8, Nodes: 090e4df3-5a2c-401f-9461-61991e9fc29d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:29:10,459 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Waiting for cluster to be ready. Got 5 of 6 DN Heartbeats.
2019-06-14 10:29:10,459 INFO  node.SCMNodeManager (SCMNodeManager.java:register(234)) - Registered Data node : 9be33dce-856e-46ae-b2e2-37061770f2b7{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}
2019-06-14 10:29:10,475 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: addNew group-79E7725230EC:[9be33dce-856e-46ae-b2e2-37061770f2b7:192.168.46.40:37649] returns group-79E7725230EC:java.util.concurrent.CompletableFuture@585b257a[Not completed]
2019-06-14 10:29:10,476 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: new RaftServerImpl for group-79E7725230EC:[9be33dce-856e-46ae-b2e2-37061770f2b7:192.168.46.40:37649] with ContainerStateMachine:uninitialized
2019-06-14 10:29:10,476 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:29:10,476 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:29:10,476 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:29:10,476 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:29:10,476 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 9be33dce-856e-46ae-b2e2-37061770f2b7:group-79E7725230EC ConfigurationManager, init=-1: [9be33dce-856e-46ae-b2e2-37061770f2b7:192.168.46.40:37649], old=null, confs=<EMPTY_MAP>
2019-06-14 10:29:10,476 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-5/data/ratis] (custom)
2019-06-14 10:29:10,476 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-5/data/ratis/8d06b95f-e04e-4ada-9b53-79e7725230ec does not exist. Creating ...
2019-06-14 10:29:10,478 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-5/data/ratis/8d06b95f-e04e-4ada-9b53-79e7725230ec/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:29:10,480 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-5/data/ratis/8d06b95f-e04e-4ada-9b53-79e7725230ec has been successfully formatted.
2019-06-14 10:29:10,481 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:29:10,481 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:29:10,481 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:29:10,481 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:29:10,481 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:29:10,481 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:29:10,481 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 9be33dce-856e-46ae-b2e2-37061770f2b7-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-5/data/ratis/8d06b95f-e04e-4ada-9b53-79e7725230ec
2019-06-14 10:29:10,481 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:29:10,481 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:29:10,481 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:29:10,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:29:10,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:29:10,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:29:10,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:29:10,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:29:10,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:29:10,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:29:10,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:29:10,483 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:29:10,483 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:29:10,483 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: start group-79E7725230EC
2019-06-14 10:29:10,483 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9be33dce-856e-46ae-b2e2-37061770f2b7:group-79E7725230EC changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:29:10,483 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: start FollowerState
2019-06-14 10:29:10,483 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-79E7725230EC,id=9be33dce-856e-46ae-b2e2-37061770f2b7
2019-06-14 10:29:10,484 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: 8d06b95f-e04e-4ada-9b53-79e7725230ec, Nodes: 9be33dce-856e-46ae-b2e2-37061770f2b7{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:29:10,498 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: addNew group-EDAE2759944E:[090e4df3-5a2c-401f-9461-61991e9fc29d:192.168.46.40:38401, 9be33dce-856e-46ae-b2e2-37061770f2b7:192.168.46.40:37649, 918fd2a8-d728-4869-bad5-c7f6d75fff19:192.168.46.40:33041] returns group-EDAE2759944E:java.util.concurrent.CompletableFuture@3427f13e[Not completed]
2019-06-14 10:29:10,499 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: new RaftServerImpl for group-EDAE2759944E:[090e4df3-5a2c-401f-9461-61991e9fc29d:192.168.46.40:38401, 9be33dce-856e-46ae-b2e2-37061770f2b7:192.168.46.40:37649, 918fd2a8-d728-4869-bad5-c7f6d75fff19:192.168.46.40:33041] with ContainerStateMachine:uninitialized
2019-06-14 10:29:10,499 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:29:10,499 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:29:10,499 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:29:10,499 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:29:10,499 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 9be33dce-856e-46ae-b2e2-37061770f2b7:group-EDAE2759944E ConfigurationManager, init=-1: [090e4df3-5a2c-401f-9461-61991e9fc29d:192.168.46.40:38401, 9be33dce-856e-46ae-b2e2-37061770f2b7:192.168.46.40:37649, 918fd2a8-d728-4869-bad5-c7f6d75fff19:192.168.46.40:33041], old=null, confs=<EMPTY_MAP>
2019-06-14 10:29:10,499 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-5/data/ratis] (custom)
2019-06-14 10:29:10,499 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-5/data/ratis/f3f67ffc-988d-4fc3-b35f-edae2759944e does not exist. Creating ...
2019-06-14 10:29:10,503 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-5/data/ratis/f3f67ffc-988d-4fc3-b35f-edae2759944e/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:29:10,504 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: addNew group-EDAE2759944E:[090e4df3-5a2c-401f-9461-61991e9fc29d:192.168.46.40:38401, 9be33dce-856e-46ae-b2e2-37061770f2b7:192.168.46.40:37649, 918fd2a8-d728-4869-bad5-c7f6d75fff19:192.168.46.40:33041] returns group-EDAE2759944E:java.util.concurrent.CompletableFuture@d876fc4[Not completed]
2019-06-14 10:29:10,504 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: addNew group-EDAE2759944E:[090e4df3-5a2c-401f-9461-61991e9fc29d:192.168.46.40:38401, 9be33dce-856e-46ae-b2e2-37061770f2b7:192.168.46.40:37649, 918fd2a8-d728-4869-bad5-c7f6d75fff19:192.168.46.40:33041] returns group-EDAE2759944E:java.util.concurrent.CompletableFuture@43fee4f9[Not completed]
2019-06-14 10:29:10,504 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: new RaftServerImpl for group-EDAE2759944E:[090e4df3-5a2c-401f-9461-61991e9fc29d:192.168.46.40:38401, 9be33dce-856e-46ae-b2e2-37061770f2b7:192.168.46.40:37649, 918fd2a8-d728-4869-bad5-c7f6d75fff19:192.168.46.40:33041] with ContainerStateMachine:uninitialized
2019-06-14 10:29:10,504 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:29:10,504 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: new RaftServerImpl for group-EDAE2759944E:[090e4df3-5a2c-401f-9461-61991e9fc29d:192.168.46.40:38401, 9be33dce-856e-46ae-b2e2-37061770f2b7:192.168.46.40:37649, 918fd2a8-d728-4869-bad5-c7f6d75fff19:192.168.46.40:33041] with ContainerStateMachine:uninitialized
2019-06-14 10:29:10,504 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:29:10,505 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:29:10,505 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:29:10,505 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19:group-EDAE2759944E ConfigurationManager, init=-1: [090e4df3-5a2c-401f-9461-61991e9fc29d:192.168.46.40:38401, 9be33dce-856e-46ae-b2e2-37061770f2b7:192.168.46.40:37649, 918fd2a8-d728-4869-bad5-c7f6d75fff19:192.168.46.40:33041], old=null, confs=<EMPTY_MAP>
2019-06-14 10:29:10,505 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-3/data/ratis] (custom)
2019-06-14 10:29:10,505 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-3/data/ratis/f3f67ffc-988d-4fc3-b35f-edae2759944e does not exist. Creating ...
2019-06-14 10:29:10,505 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-5/data/ratis/f3f67ffc-988d-4fc3-b35f-edae2759944e has been successfully formatted.
2019-06-14 10:29:10,506 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:29:10,506 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:29:10,506 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:29:10,506 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:29:10,506 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:29:10,506 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:29:10,506 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 9be33dce-856e-46ae-b2e2-37061770f2b7-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-5/data/ratis/f3f67ffc-988d-4fc3-b35f-edae2759944e
2019-06-14 10:29:10,506 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:29:10,506 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:29:10,506 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:29:10,506 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:29:10,506 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:29:10,506 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:29:10,507 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:29:10,507 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:29:10,507 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:29:10,507 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:29:10,507 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:29:10,507 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-3/data/ratis/f3f67ffc-988d-4fc3-b35f-edae2759944e/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:29:10,507 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 10:29:10,507 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:29:10,507 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:29:10,508 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: start group-EDAE2759944E
2019-06-14 10:29:10,508 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9be33dce-856e-46ae-b2e2-37061770f2b7:group-EDAE2759944E changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:29:10,508 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: start FollowerState
2019-06-14 10:29:10,508 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 10:29:10,508 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 10:29:10,508 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:29:10,508 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 090e4df3-5a2c-401f-9461-61991e9fc29d:group-EDAE2759944E ConfigurationManager, init=-1: [090e4df3-5a2c-401f-9461-61991e9fc29d:192.168.46.40:38401, 9be33dce-856e-46ae-b2e2-37061770f2b7:192.168.46.40:37649, 918fd2a8-d728-4869-bad5-c7f6d75fff19:192.168.46.40:33041], old=null, confs=<EMPTY_MAP>
2019-06-14 10:29:10,508 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-EDAE2759944E,id=9be33dce-856e-46ae-b2e2-37061770f2b7
2019-06-14 10:29:10,509 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-4/data/ratis] (custom)
2019-06-14 10:29:10,509 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-4/data/ratis/f3f67ffc-988d-4fc3-b35f-edae2759944e does not exist. Creating ...
2019-06-14 10:29:10,510 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-3/data/ratis/f3f67ffc-988d-4fc3-b35f-edae2759944e has been successfully formatted.
2019-06-14 10:29:10,510 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:29:10,510 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:29:10,510 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:29:10,510 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:29:10,510 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:29:10,510 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:29:10,510 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 918fd2a8-d728-4869-bad5-c7f6d75fff19-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-3/data/ratis/f3f67ffc-988d-4fc3-b35f-edae2759944e
2019-06-14 10:29:10,510 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:29:10,510 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:29:10,510 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:29:10,511 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:29:10,511 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:29:10,511 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:29:10,511 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:29:10,511 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:29:10,511 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:29:10,511 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:29:10,511 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:29:10,511 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:29:10,511 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:29:10,511 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: start group-EDAE2759944E
2019-06-14 10:29:10,511 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19:group-EDAE2759944E changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:29:10,511 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: start FollowerState
2019-06-14 10:29:10,512 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-EDAE2759944E,id=918fd2a8-d728-4869-bad5-c7f6d75fff19
2019-06-14 10:29:10,512 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-4/data/ratis/f3f67ffc-988d-4fc3-b35f-edae2759944e/in_use.lock acquired by nodename 14982@ozone-cf6ld-438179620
2019-06-14 10:29:10,514 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-4/data/ratis/f3f67ffc-988d-4fc3-b35f-edae2759944e has been successfully formatted.
2019-06-14 10:29:10,515 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 10:29:10,515 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 10:29:10,515 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 10:29:10,515 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:29:10,515 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:29:10,515 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 10:29:10,515 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 090e4df3-5a2c-401f-9461-61991e9fc29d-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-4/data/ratis/f3f67ffc-988d-4fc3-b35f-edae2759944e
2019-06-14 10:29:10,515 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 10:29:10,515 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 10:29:10,515 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 10:29:10,515 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 10:29:10,515 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 10:29:10,515 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 10:29:10,516 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 10:29:10,516 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 10:29:10,516 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 10:29:10,550 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 10:29:10,553 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 10:29:10,560 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 10:29:10,561 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 10:29:10,561 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: start group-EDAE2759944E
2019-06-14 10:29:10,561 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 090e4df3-5a2c-401f-9461-61991e9fc29d:group-EDAE2759944E changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 10:29:10,561 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: start FollowerState
2019-06-14 10:29:10,561 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-EDAE2759944E,id=090e4df3-5a2c-401f-9461-61991e9fc29d
2019-06-14 10:29:10,562 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:addPipeline(56)) - Created pipeline Pipeline[ Id: f3f67ffc-988d-4fc3-b35f-edae2759944e, Nodes: 918fd2a8-d728-4869-bad5-c7f6d75fff19{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}090e4df3-5a2c-401f-9461-61991e9fc29d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}9be33dce-856e-46ae-b2e2-37061770f2b7{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-14 10:29:10,944 INFO  impl.FollowerState (FollowerState.java:run(101)) - 57371422-cdf4-4019-b910-8bdfd13d3042:group-2F1ACBD713C8 changes to CANDIDATE, lastRpcTime:1184, electionTimeout:1184ms
2019-06-14 10:29:10,944 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 57371422-cdf4-4019-b910-8bdfd13d3042: shutdown FollowerState
2019-06-14 10:29:10,944 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 57371422-cdf4-4019-b910-8bdfd13d3042:group-2F1ACBD713C8 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:29:10,944 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 57371422-cdf4-4019-b910-8bdfd13d3042: start LeaderElection
2019-06-14 10:29:10,945 INFO  impl.FollowerState (FollowerState.java:run(101)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d:group-C511289E0BCC changes to CANDIDATE, lastRpcTime:1052, electionTimeout:1052ms
2019-06-14 10:29:10,945 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: shutdown FollowerState
2019-06-14 10:29:10,945 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d:group-C511289E0BCC changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:29:10,945 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: start LeaderElection
2019-06-14 10:29:10,947 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 57371422-cdf4-4019-b910-8bdfd13d3042:group-2F1ACBD713C8:LeaderElection96: begin an election at term 1 for -1: [57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155], old=null
2019-06-14 10:29:10,947 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 57371422-cdf4-4019-b910-8bdfd13d3042: shutdown LeaderElection
2019-06-14 10:29:10,947 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 57371422-cdf4-4019-b910-8bdfd13d3042:group-2F1ACBD713C8 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:29:10,947 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 57371422-cdf4-4019-b910-8bdfd13d3042:group-2F1ACBD713C8 change Leader from null to 57371422-cdf4-4019-b910-8bdfd13d3042 at term 1 for becomeLeader, leader elected after 1189ms
2019-06-14 10:29:10,947 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:29:10,947 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:29:10,947 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:29:10,947 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:29:10,948 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 57371422-cdf4-4019-b910-8bdfd13d3042: start LeaderState
2019-06-14 10:29:10,948 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 57371422-cdf4-4019-b910-8bdfd13d3042-RaftLogWorker: Starting segment from index:0
2019-06-14 10:29:10,948 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 57371422-cdf4-4019-b910-8bdfd13d3042:group-2F1ACBD713C8 set configuration 0: [57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155], old=null at 0
2019-06-14 10:29:10,948 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d:group-C511289E0BCC:LeaderElection97: begin an election at term 1 for -1: [171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251], old=null
2019-06-14 10:29:10,948 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: shutdown LeaderElection
2019-06-14 10:29:10,948 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d:group-C511289E0BCC changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:29:10,949 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d:group-C511289E0BCC change Leader from null to 171f5ea1-4e80-461d-a416-e5869a7bc19d at term 1 for becomeLeader, leader elected after 1057ms
2019-06-14 10:29:10,949 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:29:10,949 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:29:10,949 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:29:10,949 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:29:10,949 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: start LeaderState
2019-06-14 10:29:10,949 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d-RaftLogWorker: Starting segment from index:0
2019-06-14 10:29:10,949 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d:group-C511289E0BCC set configuration 0: [171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251], old=null at 0
2019-06-14 10:29:10,985 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 57371422-cdf4-4019-b910-8bdfd13d3042-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-0/data/ratis/ac1c40f4-0bcd-4f99-a229-2f1acbd713c8/current/log_inprogress_0
2019-06-14 10:29:10,988 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-1/data/ratis/2d27f428-565e-4ee4-b4e0-c511289e0bcc/current/log_inprogress_0
2019-06-14 10:29:10,995 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1061, electionTimeout:1061ms
2019-06-14 10:29:10,995 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:29:10,995 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 31 for changeToCandidate
2019-06-14 10:29:10,995 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:29:10,998 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection98: begin an election at term 32 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:10,998 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection98 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:10,999 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection98 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:11,000 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection98: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t32, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:11,000 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:11,000 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:11,000 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 32 for DISCOVERED_A_NEW_TERM
2019-06-14 10:29:11,000 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:29:11,000 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:29:11,128 INFO  impl.FollowerState (FollowerState.java:run(101)) - 57371422-cdf4-4019-b910-8bdfd13d3042:group-20E2BD1544BA changes to CANDIDATE, lastRpcTime:1011, electionTimeout:1011ms
2019-06-14 10:29:11,128 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 57371422-cdf4-4019-b910-8bdfd13d3042: shutdown FollowerState
2019-06-14 10:29:11,128 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 57371422-cdf4-4019-b910-8bdfd13d3042:group-20E2BD1544BA changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:29:11,128 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 57371422-cdf4-4019-b910-8bdfd13d3042: start LeaderElection
2019-06-14 10:29:11,131 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 57371422-cdf4-4019-b910-8bdfd13d3042:group-20E2BD1544BA:LeaderElection99: begin an election at term 1 for -1: [f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757, 171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251, 57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155], old=null
2019-06-14 10:29:11,133 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d:group-20E2BD1544BA changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:57371422-cdf4-4019-b910-8bdfd13d3042
2019-06-14 10:29:11,133 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: shutdown FollowerState
2019-06-14 10:29:11,133 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: start FollowerState
2019-06-14 10:29:11,133 INFO  impl.FollowerState (FollowerState.java:run(109)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:29:11,138 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:57371422-cdf4-4019-b910-8bdfd13d3042
2019-06-14 10:29:11,138 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: shutdown FollowerState
2019-06-14 10:29:11,138 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: start FollowerState
2019-06-14 10:29:11,138 INFO  impl.FollowerState (FollowerState.java:run(109)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:29:11,140 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 57371422-cdf4-4019-b910-8bdfd13d3042:group-20E2BD1544BA:LeaderElection99: Election PASSED; received 1 response(s) [57371422-cdf4-4019-b910-8bdfd13d3042->171f5ea1-4e80-461d-a416-e5869a7bc19d,true-t1] and 0 exception(s); 57371422-cdf4-4019-b910-8bdfd13d3042:t1, leader=null, voted=57371422-cdf4-4019-b910-8bdfd13d3042, raftlog=57371422-cdf4-4019-b910-8bdfd13d3042-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757, 171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251, 57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155], old=null
2019-06-14 10:29:11,140 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 57371422-cdf4-4019-b910-8bdfd13d3042: shutdown LeaderElection
2019-06-14 10:29:11,140 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 57371422-cdf4-4019-b910-8bdfd13d3042:group-20E2BD1544BA changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:29:11,140 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 57371422-cdf4-4019-b910-8bdfd13d3042:group-20E2BD1544BA change Leader from null to 57371422-cdf4-4019-b910-8bdfd13d3042 at term 1 for becomeLeader, leader elected after 1025ms
2019-06-14 10:29:11,140 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:29:11,140 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:29:11,140 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:29:11,140 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:29:11,140 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:29:11,140 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:29:11,141 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:29:11,141 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:29:11,141 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:29:11,141 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:29:11,141 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:29:11,141 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:29:11,141 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:29:11,141 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:29:11,141 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:29:11,142 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:29:11,142 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 57371422-cdf4-4019-b910-8bdfd13d3042: start LeaderState
2019-06-14 10:29:11,142 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 57371422-cdf4-4019-b910-8bdfd13d3042-RaftLogWorker: Starting segment from index:0
2019-06-14 10:29:11,142 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 57371422-cdf4-4019-b910-8bdfd13d3042:group-20E2BD1544BA set configuration 0: [f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757, 171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251, 57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155], old=null at 0
2019-06-14 10:29:11,143 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA change Leader from null to 57371422-cdf4-4019-b910-8bdfd13d3042 at term 1 for appendEntries, leader elected after 1033ms
2019-06-14 10:29:11,143 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d:group-20E2BD1544BA change Leader from null to 57371422-cdf4-4019-b910-8bdfd13d3042 at term 1 for appendEntries, leader elected after 1025ms
2019-06-14 10:29:11,144 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA set configuration 0: [f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757, 171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251, 57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155], old=null at 0
2019-06-14 10:29:11,144 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - f7b15b21-0c63-4ad6-a80e-afed583276bc-RaftLogWorker: Starting segment from index:0
2019-06-14 10:29:11,145 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d:group-20E2BD1544BA set configuration 0: [f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757, 171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251, 57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155], old=null at 0
2019-06-14 10:29:11,145 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d-RaftLogWorker: Starting segment from index:0
2019-06-14 10:29:11,188 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-1/data/ratis/f01c641c-4ee0-44f9-8fb5-20e2bd1544ba/current/log_inprogress_0
2019-06-14 10:29:11,196 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - f7b15b21-0c63-4ad6-a80e-afed583276bc-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-2/data/ratis/f01c641c-4ee0-44f9-8fb5-20e2bd1544ba/current/log_inprogress_0
2019-06-14 10:29:11,199 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 57371422-cdf4-4019-b910-8bdfd13d3042-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-0/data/ratis/f01c641c-4ee0-44f9-8fb5-20e2bd1544ba/current/log_inprogress_0
2019-06-14 10:29:11,264 INFO  impl.FollowerState (FollowerState.java:run(101)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-1811AC1DC160 changes to CANDIDATE, lastRpcTime:1182, electionTimeout:1182ms
2019-06-14 10:29:11,264 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: shutdown FollowerState
2019-06-14 10:29:11,264 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-1811AC1DC160 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:29:11,264 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: start LeaderElection
2019-06-14 10:29:11,266 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-1811AC1DC160:LeaderElection100: begin an election at term 1 for -1: [f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757], old=null
2019-06-14 10:29:11,266 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: shutdown LeaderElection
2019-06-14 10:29:11,266 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-1811AC1DC160 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:29:11,266 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-1811AC1DC160 change Leader from null to f7b15b21-0c63-4ad6-a80e-afed583276bc at term 1 for becomeLeader, leader elected after 1186ms
2019-06-14 10:29:11,266 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:29:11,266 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:29:11,267 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:29:11,267 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:29:11,267 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: start LeaderState
2019-06-14 10:29:11,267 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - f7b15b21-0c63-4ad6-a80e-afed583276bc-RaftLogWorker: Starting segment from index:0
2019-06-14 10:29:11,267 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-1811AC1DC160 set configuration 0: [f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757], old=null at 0
2019-06-14 10:29:11,304 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - f7b15b21-0c63-4ad6-a80e-afed583276bc-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-2/data/ratis/f1189f7d-85e3-40e9-9435-1811ac1dc160/current/log_inprogress_0
2019-06-14 10:29:11,305 INFO  impl.FollowerState (FollowerState.java:run(101)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19:group-553A09606F97 changes to CANDIDATE, lastRpcTime:1085, electionTimeout:1085ms
2019-06-14 10:29:11,305 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: shutdown FollowerState
2019-06-14 10:29:11,305 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19:group-553A09606F97 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:29:11,305 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: start LeaderElection
2019-06-14 10:29:11,307 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19:group-553A09606F97:LeaderElection101: begin an election at term 1 for -1: [918fd2a8-d728-4869-bad5-c7f6d75fff19:192.168.46.40:33041], old=null
2019-06-14 10:29:11,307 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: shutdown LeaderElection
2019-06-14 10:29:11,307 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19:group-553A09606F97 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:29:11,307 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19:group-553A09606F97 change Leader from null to 918fd2a8-d728-4869-bad5-c7f6d75fff19 at term 1 for becomeLeader, leader elected after 1089ms
2019-06-14 10:29:11,307 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:29:11,308 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:29:11,308 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:29:11,308 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:29:11,308 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: start LeaderState
2019-06-14 10:29:11,308 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19-RaftLogWorker: Starting segment from index:0
2019-06-14 10:29:11,312 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19:group-553A09606F97 set configuration 0: [918fd2a8-d728-4869-bad5-c7f6d75fff19:192.168.46.40:33041], old=null at 0
2019-06-14 10:29:11,344 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-3/data/ratis/8be4bc42-e323-48fa-8625-553a09606f97/current/log_inprogress_0
2019-06-14 10:29:11,445 INFO  impl.FollowerState (FollowerState.java:run(101)) - 090e4df3-5a2c-401f-9461-61991e9fc29d:group-D805F6AE7DF8 changes to CANDIDATE, lastRpcTime:1094, electionTimeout:1094ms
2019-06-14 10:29:11,445 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: shutdown FollowerState
2019-06-14 10:29:11,445 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 090e4df3-5a2c-401f-9461-61991e9fc29d:group-D805F6AE7DF8 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:29:11,446 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: start LeaderElection
2019-06-14 10:29:11,448 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 090e4df3-5a2c-401f-9461-61991e9fc29d:group-D805F6AE7DF8:LeaderElection102: begin an election at term 1 for -1: [090e4df3-5a2c-401f-9461-61991e9fc29d:192.168.46.40:38401], old=null
2019-06-14 10:29:11,448 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: shutdown LeaderElection
2019-06-14 10:29:11,448 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 090e4df3-5a2c-401f-9461-61991e9fc29d:group-D805F6AE7DF8 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:29:11,448 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 090e4df3-5a2c-401f-9461-61991e9fc29d:group-D805F6AE7DF8 change Leader from null to 090e4df3-5a2c-401f-9461-61991e9fc29d at term 1 for becomeLeader, leader elected after 1098ms
2019-06-14 10:29:11,448 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:29:11,448 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:29:11,448 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:29:11,448 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:29:11,448 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: start LeaderState
2019-06-14 10:29:11,449 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 090e4df3-5a2c-401f-9461-61991e9fc29d-RaftLogWorker: Starting segment from index:0
2019-06-14 10:29:11,449 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 090e4df3-5a2c-401f-9461-61991e9fc29d:group-D805F6AE7DF8 set configuration 0: [090e4df3-5a2c-401f-9461-61991e9fc29d:192.168.46.40:38401], old=null at 0
2019-06-14 10:29:11,459 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:lambda$waitForClusterToBeReady$0(142)) - Cluster is ready. Got 6 of 6 DN Heartbeats.
2019-06-14 10:29:11,489 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9be33dce-856e-46ae-b2e2-37061770f2b7:group-79E7725230EC changes to CANDIDATE, lastRpcTime:1005, electionTimeout:1001ms
2019-06-14 10:29:11,489 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: shutdown FollowerState
2019-06-14 10:29:11,489 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9be33dce-856e-46ae-b2e2-37061770f2b7:group-79E7725230EC changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:29:11,489 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: start LeaderElection
2019-06-14 10:29:11,497 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9be33dce-856e-46ae-b2e2-37061770f2b7:group-79E7725230EC:LeaderElection103: begin an election at term 1 for -1: [9be33dce-856e-46ae-b2e2-37061770f2b7:192.168.46.40:37649], old=null
2019-06-14 10:29:11,497 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 090e4df3-5a2c-401f-9461-61991e9fc29d-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-4/data/ratis/ef1e97bd-491c-4684-913f-d805f6ae7df8/current/log_inprogress_0
2019-06-14 10:29:11,499 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: shutdown LeaderElection
2019-06-14 10:29:11,499 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9be33dce-856e-46ae-b2e2-37061770f2b7:group-79E7725230EC changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:29:11,499 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 9be33dce-856e-46ae-b2e2-37061770f2b7:group-79E7725230EC change Leader from null to 9be33dce-856e-46ae-b2e2-37061770f2b7 at term 1 for becomeLeader, leader elected after 1018ms
2019-06-14 10:29:11,499 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:29:11,500 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:29:11,506 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:29:11,506 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:29:11,506 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: start LeaderState
2019-06-14 10:29:11,507 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 9be33dce-856e-46ae-b2e2-37061770f2b7-RaftLogWorker: Starting segment from index:0
2019-06-14 10:29:11,507 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 9be33dce-856e-46ae-b2e2-37061770f2b7:group-79E7725230EC set configuration 0: [9be33dce-856e-46ae-b2e2-37061770f2b7:192.168.46.40:37649], old=null at 0
2019-06-14 10:29:11,508 INFO  rpc.RpcClient (RpcClient.java:createVolume(289)) - Creating Volume: datanodefailurehandlingtest, with root as owner.
2019-06-14 10:29:11,526 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9be33dce-856e-46ae-b2e2-37061770f2b7:group-EDAE2759944E changes to CANDIDATE, lastRpcTime:1018, electionTimeout:1015ms
2019-06-14 10:29:11,526 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: shutdown FollowerState
2019-06-14 10:29:11,526 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9be33dce-856e-46ae-b2e2-37061770f2b7:group-EDAE2759944E changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 10:29:11,527 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: start LeaderElection
2019-06-14 10:29:11,550 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 9be33dce-856e-46ae-b2e2-37061770f2b7-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-5/data/ratis/8d06b95f-e04e-4ada-9b53-79e7725230ec/current/log_inprogress_0
2019-06-14 10:29:11,550 INFO  rpc.RpcClient (RpcClient.java:createBucket(426)) - Creating Bucket: datanodefailurehandlingtest/datanodefailurehandlingtest, with Versioning false and Storage Type set to DISK and Encryption set to false 
2019-06-14 10:29:11,553 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9be33dce-856e-46ae-b2e2-37061770f2b7:group-EDAE2759944E:LeaderElection104: begin an election at term 1 for -1: [090e4df3-5a2c-401f-9461-61991e9fc29d:192.168.46.40:38401, 9be33dce-856e-46ae-b2e2-37061770f2b7:192.168.46.40:37649, 918fd2a8-d728-4869-bad5-c7f6d75fff19:192.168.46.40:33041], old=null
2019-06-14 10:29:11,560 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 090e4df3-5a2c-401f-9461-61991e9fc29d:group-EDAE2759944E changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:9be33dce-856e-46ae-b2e2-37061770f2b7
2019-06-14 10:29:11,560 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: shutdown FollowerState
2019-06-14 10:29:11,560 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: start FollowerState
2019-06-14 10:29:11,561 INFO  impl.FollowerState (FollowerState.java:run(109)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:29:11,563 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19:group-EDAE2759944E changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:9be33dce-856e-46ae-b2e2-37061770f2b7
2019-06-14 10:29:11,563 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: shutdown FollowerState
2019-06-14 10:29:11,563 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: start FollowerState
2019-06-14 10:29:11,563 INFO  impl.FollowerState (FollowerState.java:run(109)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:29:11,565 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 9be33dce-856e-46ae-b2e2-37061770f2b7:group-EDAE2759944E:LeaderElection104: Election PASSED; received 1 response(s) [9be33dce-856e-46ae-b2e2-37061770f2b7->918fd2a8-d728-4869-bad5-c7f6d75fff19,true-t1] and 0 exception(s); 9be33dce-856e-46ae-b2e2-37061770f2b7:t1, leader=null, voted=9be33dce-856e-46ae-b2e2-37061770f2b7, raftlog=9be33dce-856e-46ae-b2e2-37061770f2b7-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [090e4df3-5a2c-401f-9461-61991e9fc29d:192.168.46.40:38401, 9be33dce-856e-46ae-b2e2-37061770f2b7:192.168.46.40:37649, 918fd2a8-d728-4869-bad5-c7f6d75fff19:192.168.46.40:33041], old=null
2019-06-14 10:29:11,566 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: shutdown LeaderElection
2019-06-14 10:29:11,566 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9be33dce-856e-46ae-b2e2-37061770f2b7:group-EDAE2759944E changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 10:29:11,566 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 9be33dce-856e-46ae-b2e2-37061770f2b7:group-EDAE2759944E change Leader from null to 9be33dce-856e-46ae-b2e2-37061770f2b7 at term 1 for becomeLeader, leader elected after 1059ms
2019-06-14 10:29:11,566 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 10:29:11,566 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 10:29:11,566 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 10:29:11,566 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 10:29:11,566 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:29:11,566 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:29:11,566 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:29:11,566 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:29:11,567 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:29:11,567 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:29:11,567 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-14 10:29:11,567 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 10:29:11,567 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-14 10:29:11,567 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-14 10:29:11,567 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 10:29:11,568 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 10:29:11,568 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: start LeaderState
2019-06-14 10:29:11,568 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 9be33dce-856e-46ae-b2e2-37061770f2b7-RaftLogWorker: Starting segment from index:0
2019-06-14 10:29:11,569 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 9be33dce-856e-46ae-b2e2-37061770f2b7:group-EDAE2759944E set configuration 0: [090e4df3-5a2c-401f-9461-61991e9fc29d:192.168.46.40:38401, 9be33dce-856e-46ae-b2e2-37061770f2b7:192.168.46.40:37649, 918fd2a8-d728-4869-bad5-c7f6d75fff19:192.168.46.40:33041], old=null at 0
2019-06-14 10:29:11,569 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 090e4df3-5a2c-401f-9461-61991e9fc29d:group-EDAE2759944E change Leader from null to 9be33dce-856e-46ae-b2e2-37061770f2b7 at term 1 for appendEntries, leader elected after 1054ms
2019-06-14 10:29:11,570 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19:group-EDAE2759944E change Leader from null to 9be33dce-856e-46ae-b2e2-37061770f2b7 at term 1 for appendEntries, leader elected after 1059ms
2019-06-14 10:29:11,571 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 090e4df3-5a2c-401f-9461-61991e9fc29d:group-EDAE2759944E set configuration 0: [090e4df3-5a2c-401f-9461-61991e9fc29d:192.168.46.40:38401, 9be33dce-856e-46ae-b2e2-37061770f2b7:192.168.46.40:37649, 918fd2a8-d728-4869-bad5-c7f6d75fff19:192.168.46.40:33041], old=null at 0
2019-06-14 10:29:11,571 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 090e4df3-5a2c-401f-9461-61991e9fc29d-RaftLogWorker: Starting segment from index:0
2019-06-14 10:29:11,581 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19:group-EDAE2759944E set configuration 0: [090e4df3-5a2c-401f-9461-61991e9fc29d:192.168.46.40:38401, 9be33dce-856e-46ae-b2e2-37061770f2b7:192.168.46.40:37649, 918fd2a8-d728-4869-bad5-c7f6d75fff19:192.168.46.40:33041], old=null at 0
2019-06-14 10:29:11,581 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19-RaftLogWorker: Starting segment from index:0
2019-06-14 10:29:11,621 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 9be33dce-856e-46ae-b2e2-37061770f2b7-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-5/data/ratis/f3f67ffc-988d-4fc3-b35f-edae2759944e/current/log_inprogress_0
2019-06-14 10:29:11,629 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 090e4df3-5a2c-401f-9461-61991e9fc29d-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-4/data/ratis/f3f67ffc-988d-4fc3-b35f-edae2759944e/current/log_inprogress_0
2019-06-14 10:29:11,642 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->918fd2a8-d728-4869-bad5-c7f6d75fff19: receive RaftClientReply:client-AE2EA10F7D2B->918fd2a8-d728-4869-bad5-c7f6d75fff19@group-EDAE2759944E, cid=180, FAILED org.apache.ratis.protocol.NotLeaderException: Server 918fd2a8-d728-4869-bad5-c7f6d75fff19 is not the leader (9be33dce-856e-46ae-b2e2-37061770f2b7:192.168.46.40:37649). Request must be sent to leader., logIndex=0, commits[918fd2a8-d728-4869-bad5-c7f6d75fff19:c-1, 090e4df3-5a2c-401f-9461-61991e9fc29d:c-1, 9be33dce-856e-46ae-b2e2-37061770f2b7:c-1]
2019-06-14 10:29:11,642 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-3/data/ratis/f3f67ffc-988d-4fc3-b35f-edae2759944e/current/log_inprogress_0
2019-06-14 10:29:11,656 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:29:12,140 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1140, electionTimeout:1140ms
2019-06-14 10:29:12,141 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:29:12,141 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 32 for changeToCandidate
2019-06-14 10:29:12,141 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:29:12,143 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection105: begin an election at term 33 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:12,144 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection105 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:12,144 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection105 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:12,144 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection105: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t33, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:12,144 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:12,144 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:12,144 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 33 for DISCOVERED_A_NEW_TERM
2019-06-14 10:29:12,145 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:29:12,145 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:29:12,695 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7: receive RaftClientReply:client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7@group-EDAE2759944E, cid=180, SUCCESS, logIndex=1, commits[9be33dce-856e-46ae-b2e2-37061770f2b7:c1, 090e4df3-5a2c-401f-9461-61991e9fc29d:c0, 918fd2a8-d728-4869-bad5-c7f6d75fff19:c0]
2019-06-14 10:29:12,730 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7: receive RaftClientReply:client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7@group-EDAE2759944E, cid=181, SUCCESS, logIndex=3, commits[9be33dce-856e-46ae-b2e2-37061770f2b7:c4, 090e4df3-5a2c-401f-9461-61991e9fc29d:c3, 918fd2a8-d728-4869-bad5-c7f6d75fff19:c3]
2019-06-14 10:29:12,742 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7: receive RaftClientReply:client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7@group-EDAE2759944E, cid=182, SUCCESS, logIndex=5, commits[9be33dce-856e-46ae-b2e2-37061770f2b7:c6, 090e4df3-5a2c-401f-9461-61991e9fc29d:c4, 918fd2a8-d728-4869-bad5-c7f6d75fff19:c4]
2019-06-14 10:29:12,754 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7: receive RaftClientReply:client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7@group-EDAE2759944E, cid=183, SUCCESS, logIndex=6, commits[9be33dce-856e-46ae-b2e2-37061770f2b7:c8, 090e4df3-5a2c-401f-9461-61991e9fc29d:c6, 918fd2a8-d728-4869-bad5-c7f6d75fff19:c6]
2019-06-14 10:29:12,767 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7: receive RaftClientReply:client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7@group-EDAE2759944E, cid=184, SUCCESS, logIndex=9, commits[9be33dce-856e-46ae-b2e2-37061770f2b7:c9, 090e4df3-5a2c-401f-9461-61991e9fc29d:c8, 918fd2a8-d728-4869-bad5-c7f6d75fff19:c6]
2019-06-14 10:29:12,777 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7: receive RaftClientReply:client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7@group-EDAE2759944E, cid=185, SUCCESS, logIndex=11, commits[9be33dce-856e-46ae-b2e2-37061770f2b7:c11, 090e4df3-5a2c-401f-9461-61991e9fc29d:c9, 918fd2a8-d728-4869-bad5-c7f6d75fff19:c9]
2019-06-14 10:29:12,781 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7: receive RaftClientReply:client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7@group-EDAE2759944E, cid=186, SUCCESS, logIndex=12, commits[9be33dce-856e-46ae-b2e2-37061770f2b7:c13, 090e4df3-5a2c-401f-9461-61991e9fc29d:c10, 918fd2a8-d728-4869-bad5-c7f6d75fff19:c9]
2019-06-14 10:29:12,786 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7: receive RaftClientReply:client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7@group-EDAE2759944E, cid=187, SUCCESS, logIndex=13, commits[9be33dce-856e-46ae-b2e2-37061770f2b7:c13, 090e4df3-5a2c-401f-9461-61991e9fc29d:c10, 918fd2a8-d728-4869-bad5-c7f6d75fff19:c9]
2019-06-14 10:29:12,792 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7: receive RaftClientReply:client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7@group-EDAE2759944E, cid=188, SUCCESS, logIndex=0, commits[9be33dce-856e-46ae-b2e2-37061770f2b7:c16, 090e4df3-5a2c-401f-9461-61991e9fc29d:c13, 918fd2a8-d728-4869-bad5-c7f6d75fff19:c13]
2019-06-14 10:29:12,794 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7: receive RaftClientReply:client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7@group-EDAE2759944E, cid=189, SUCCESS, logIndex=0, commits[9be33dce-856e-46ae-b2e2-37061770f2b7:c16, 090e4df3-5a2c-401f-9461-61991e9fc29d:c13, 918fd2a8-d728-4869-bad5-c7f6d75fff19:c13]
2019-06-14 10:29:12,803 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:29:12,803 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@69e346b3
2019-06-14 10:29:12,803 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:29:12,804 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:29:12,805 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: close
2019-06-14 10:29:12,805 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: shutdown group-20E2BD1544BA
2019-06-14 10:29:12,805 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-20E2BD1544BA,id=171f5ea1-4e80-461d-a416-e5869a7bc19d
2019-06-14 10:29:12,805 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: shutdown FollowerState
2019-06-14 10:29:12,805 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-171f5ea1-4e80-461d-a416-e5869a7bc19d-group-20E2BD1544BA: set stopIndex = 0
2019-06-14 10:29:12,805 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:29:12,805 INFO  impl.FollowerState (FollowerState.java:run(109)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:29:12,806 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d:group-20E2BD1544BA closes. The last applied log index is 0
2019-06-14 10:29:12,806 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:29:12,809 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d-RaftLogWorker close()
2019-06-14 10:29:12,812 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: shutdown group-C511289E0BCC
2019-06-14 10:29:12,812 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C511289E0BCC,id=171f5ea1-4e80-461d-a416-e5869a7bc19d
2019-06-14 10:29:12,812 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: shutdown LeaderState
2019-06-14 10:29:12,812 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d-PendingRequests: sendNotLeaderResponses
2019-06-14 10:29:12,813 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:29:12,813 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-171f5ea1-4e80-461d-a416-e5869a7bc19d-group-C511289E0BCC: set stopIndex = 0
2019-06-14 10:29:12,813 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d:group-C511289E0BCC closes. The last applied log index is 0
2019-06-14 10:29:12,813 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:29:12,822 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d-RaftLogWorker close()
2019-06-14 10:29:12,833 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: shutdown server with port 46251 now
2019-06-14 10:29:12,834 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: shutdown server with port 46251 successfully
2019-06-14 10:29:12,834 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 57371422-cdf4-4019-b910-8bdfd13d3042: Failed appendEntries to 171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-14 10:29:12,834 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - 171f5ea1-4e80-461d-a416-e5869a7bc19d: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:29:12,834 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 57371422-cdf4-4019-b910-8bdfd13d3042->171f5ea1-4e80-461d-a416-e5869a7bc19d: nextIndex: updateUnconditionally 1 -> 0
2019-06-14 10:29:12,840 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:29:12,857 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:29:12,857 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@6dc8a602{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:29:12,859 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@2a45c6f0{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:29:12,860 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@11034fdb{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:29:12,860 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@5d3c0735{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:29:12,860 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:29:12,861 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@2b8106f
2019-06-14 10:29:12,861 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:29:12,861 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:29:12,862 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 57371422-cdf4-4019-b910-8bdfd13d3042: close
2019-06-14 10:29:12,862 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 57371422-cdf4-4019-b910-8bdfd13d3042: shutdown group-2F1ACBD713C8
2019-06-14 10:29:12,862 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-2F1ACBD713C8,id=57371422-cdf4-4019-b910-8bdfd13d3042
2019-06-14 10:29:12,862 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 57371422-cdf4-4019-b910-8bdfd13d3042: shutdown LeaderState
2019-06-14 10:29:12,862 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 57371422-cdf4-4019-b910-8bdfd13d3042-PendingRequests: sendNotLeaderResponses
2019-06-14 10:29:12,862 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-57371422-cdf4-4019-b910-8bdfd13d3042-group-2F1ACBD713C8: set stopIndex = 0
2019-06-14 10:29:12,862 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:29:12,863 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 57371422-cdf4-4019-b910-8bdfd13d3042:group-2F1ACBD713C8 closes. The last applied log index is 0
2019-06-14 10:29:12,863 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 57371422-cdf4-4019-b910-8bdfd13d3042-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:29:12,863 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 57371422-cdf4-4019-b910-8bdfd13d3042-RaftLogWorker close()
2019-06-14 10:29:12,863 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 57371422-cdf4-4019-b910-8bdfd13d3042: shutdown group-20E2BD1544BA
2019-06-14 10:29:12,863 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-20E2BD1544BA,id=57371422-cdf4-4019-b910-8bdfd13d3042
2019-06-14 10:29:12,863 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 57371422-cdf4-4019-b910-8bdfd13d3042: shutdown LeaderState
2019-06-14 10:29:12,864 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 57371422-cdf4-4019-b910-8bdfd13d3042-PendingRequests: sendNotLeaderResponses
2019-06-14 10:29:12,864 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(57371422-cdf4-4019-b910-8bdfd13d3042 -> 171f5ea1-4e80-461d-a416-e5869a7bc19d): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:29:12,864 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:29:12,864 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(57371422-cdf4-4019-b910-8bdfd13d3042 -> f7b15b21-0c63-4ad6-a80e-afed583276bc): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:29:12,864 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-57371422-cdf4-4019-b910-8bdfd13d3042-group-20E2BD1544BA: set stopIndex = 0
2019-06-14 10:29:12,864 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: appendEntries completed
2019-06-14 10:29:12,864 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 57371422-cdf4-4019-b910-8bdfd13d3042:group-20E2BD1544BA closes. The last applied log index is 0
2019-06-14 10:29:12,864 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - 57371422-cdf4-4019-b910-8bdfd13d3042: follower 57371422-cdf4-4019-b910-8bdfd13d3042->f7b15b21-0c63-4ad6-a80e-afed583276bc(c0,m0,n1, attendVote=true, lastRpcSendTime=163, lastRpcResponseTime=158) response Completed
2019-06-14 10:29:12,865 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 57371422-cdf4-4019-b910-8bdfd13d3042-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:29:12,865 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 57371422-cdf4-4019-b910-8bdfd13d3042->f7b15b21-0c63-4ad6-a80e-afed583276bc: nextIndex: updateUnconditionally 1 -> -1
2019-06-14 10:29:12,865 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 57371422-cdf4-4019-b910-8bdfd13d3042-RaftLogWorker close()
2019-06-14 10:29:12,865 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 57371422-cdf4-4019-b910-8bdfd13d3042: shutdown server with port 46155 now
2019-06-14 10:29:12,867 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 57371422-cdf4-4019-b910-8bdfd13d3042: shutdown server with port 46155 successfully
2019-06-14 10:29:12,870 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:29:12,881 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:29:12,882 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@4620e669{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:29:12,882 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@4b93a232{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:29:12,882 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@34e4a136{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:29:12,883 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@77227b1f{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:29:13,155 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1010, electionTimeout:1010ms
2019-06-14 10:29:13,155 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:29:13,155 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 33 for changeToCandidate
2019-06-14 10:29:13,155 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:29:13,158 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection106: begin an election at term 34 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:13,159 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection106 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:13,159 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection106 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:13,159 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection106: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t34, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:13,159 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:13,160 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:13,160 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 34 for DISCOVERED_A_NEW_TERM
2019-06-14 10:29:13,160 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:29:13,160 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:29:14,332 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1172, electionTimeout:1172ms
2019-06-14 10:29:14,332 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:29:14,332 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 34 for changeToCandidate
2019-06-14 10:29:14,332 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:29:14,339 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection107: begin an election at term 35 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:14,342 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection107 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:14,342 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection107 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:14,342 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection107: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t35, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:14,342 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:14,343 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:14,343 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 35 for DISCOVERED_A_NEW_TERM
2019-06-14 10:29:14,343 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:29:14,343 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:29:14,453 INFO  impl.FollowerState (FollowerState.java:run(101)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA changes to CANDIDATE, lastRpcTime:1747, electionTimeout:1145ms
2019-06-14 10:29:14,453 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: shutdown FollowerState
2019-06-14 10:29:14,453 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA changes role from FOLLOWER to CANDIDATE at term 1 for changeToCandidate
2019-06-14 10:29:14,453 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: start LeaderElection
2019-06-14 10:29:14,453 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA change Leader from 57371422-cdf4-4019-b910-8bdfd13d3042 to null at term 1 for initElection
2019-06-14 10:29:14,455 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA:LeaderElection108: begin an election at term 2 for 0: [f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757, 171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251, 57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155], old=null
2019-06-14 10:29:14,457 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA:LeaderElection108 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:46251
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:14,457 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA:LeaderElection108 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:46155
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:14,458 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA:LeaderElection108: Election REJECTED; received 0 response(s) [] and 2 exception(s); f7b15b21-0c63-4ad6-a80e-afed583276bc:t2, leader=null, voted=f7b15b21-0c63-4ad6-a80e-afed583276bc, raftlog=f7b15b21-0c63-4ad6-a80e-afed583276bc-SegmentedRaftLog:OPENED:c0,f0,i0, conf=0: [f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757, 171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251, 57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155], old=null
2019-06-14 10:29:14,458 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:46251
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:14,458 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:46155
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:14,458 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA changes role from CANDIDATE to FOLLOWER at term 2 for DISCOVERED_A_NEW_TERM
2019-06-14 10:29:14,458 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: shutdown LeaderElection
2019-06-14 10:29:14,458 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: start FollowerState
2019-06-14 10:29:14,865 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-307B6FFC1C83->f7b15b21-0c63-4ad6-a80e-afed583276bc: receive RaftClientReply:client-307B6FFC1C83->f7b15b21-0c63-4ad6-a80e-afed583276bc@group-20E2BD1544BA, cid=190, FAILED org.apache.ratis.protocol.NotLeaderException: Server f7b15b21-0c63-4ad6-a80e-afed583276bc is not the leader (57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155). Request must be sent to leader., logIndex=0, commits[f7b15b21-0c63-4ad6-a80e-afed583276bc:c0, 171f5ea1-4e80-461d-a416-e5869a7bc19d:c0, 57371422-cdf4-4019-b910-8bdfd13d3042:c0]
2019-06-14 10:29:14,867 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:29:14,956 INFO  node.StaleNodeHandler (StaleNodeHandler.java:onMessage(58)) - Datanode 171f5ea1-4e80-461d-a416-e5869a7bc19d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null} moved to stale state. Finalizing its pipelines [PipelineID=f01c641c-4ee0-44f9-8fb5-20e2bd1544ba, PipelineID=2d27f428-565e-4ee4-b4e0-c511289e0bcc]
2019-06-14 10:29:14,956 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: f01c641c-4ee0-44f9-8fb5-20e2bd1544ba, Nodes: 171f5ea1-4e80-461d-a416-e5869a7bc19d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}57371422-cdf4-4019-b910-8bdfd13d3042{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}f7b15b21-0c63-4ad6-a80e-afed583276bc{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]
2019-06-14 10:29:14,956 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: f01c641c-4ee0-44f9-8fb5-20e2bd1544ba, Nodes: 171f5ea1-4e80-461d-a416-e5869a7bc19d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}57371422-cdf4-4019-b910-8bdfd13d3042{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}f7b15b21-0c63-4ad6-a80e-afed583276bc{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED] moved to CLOSED state
2019-06-14 10:29:14,956 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: 2d27f428-565e-4ee4-b4e0-c511289e0bcc, Nodes: 171f5ea1-4e80-461d-a416-e5869a7bc19d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:29:14,956 INFO  container.CloseContainerEventHandler (CloseContainerEventHandler.java:onMessage(61)) - Close container Event triggered for container : #2
2019-06-14 10:29:14,956 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: 2d27f428-565e-4ee4-b4e0-c511289e0bcc, Nodes: 171f5ea1-4e80-461d-a416-e5869a7bc19d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-06-14 10:29:15,414 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1070, electionTimeout:1064ms
2019-06-14 10:29:15,414 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:29:15,414 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 35 for changeToCandidate
2019-06-14 10:29:15,414 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:29:15,417 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection109: begin an election at term 36 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:15,417 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection109 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:15,417 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection109 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:15,418 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection109: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t36, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:15,418 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:15,418 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:15,418 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 36 for DISCOVERED_A_NEW_TERM
2019-06-14 10:29:15,418 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:29:15,418 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:29:15,466 INFO  impl.FollowerState (FollowerState.java:run(101)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA changes to CANDIDATE, lastRpcTime:1008, electionTimeout:1008ms
2019-06-14 10:29:15,466 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: shutdown FollowerState
2019-06-14 10:29:15,467 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA changes role from FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2019-06-14 10:29:15,467 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: start LeaderElection
2019-06-14 10:29:15,469 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA:LeaderElection110: begin an election at term 3 for 0: [f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757, 171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251, 57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155], old=null
2019-06-14 10:29:15,470 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA:LeaderElection110 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:46251
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:15,470 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA:LeaderElection110 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:46155
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:15,470 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA:LeaderElection110: Election REJECTED; received 0 response(s) [] and 2 exception(s); f7b15b21-0c63-4ad6-a80e-afed583276bc:t3, leader=null, voted=f7b15b21-0c63-4ad6-a80e-afed583276bc, raftlog=f7b15b21-0c63-4ad6-a80e-afed583276bc-SegmentedRaftLog:OPENED:c0,f0,i0, conf=0: [f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757, 171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251, 57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155], old=null
2019-06-14 10:29:15,470 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:46251
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:15,470 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:46155
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:15,470 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA changes role from CANDIDATE to FOLLOWER at term 3 for DISCOVERED_A_NEW_TERM
2019-06-14 10:29:15,470 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: shutdown LeaderElection
2019-06-14 10:29:15,471 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: start FollowerState
2019-06-14 10:29:15,756 INFO  node.StaleNodeHandler (StaleNodeHandler.java:onMessage(58)) - Datanode 57371422-cdf4-4019-b910-8bdfd13d3042{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null} moved to stale state. Finalizing its pipelines [PipelineID=ac1c40f4-0bcd-4f99-a229-2f1acbd713c8, PipelineID=f01c641c-4ee0-44f9-8fb5-20e2bd1544ba]
2019-06-14 10:29:15,757 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: ac1c40f4-0bcd-4f99-a229-2f1acbd713c8, Nodes: 57371422-cdf4-4019-b910-8bdfd13d3042{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:OPEN]
2019-06-14 10:29:15,757 INFO  pipeline.PipelineStateManager (PipelineStateManager.java:finalizePipeline(123)) - Pipeline Pipeline[ Id: ac1c40f4-0bcd-4f99-a229-2f1acbd713c8, Nodes: 57371422-cdf4-4019-b910-8bdfd13d3042{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:ONE, State:CLOSED] moved to CLOSED state
2019-06-14 10:29:15,757 INFO  pipeline.SCMPipelineManager (SCMPipelineManager.java:finalizeAndDestroyPipeline(307)) - destroying pipeline:Pipeline[ Id: f01c641c-4ee0-44f9-8fb5-20e2bd1544ba, Nodes: 171f5ea1-4e80-461d-a416-e5869a7bc19d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}57371422-cdf4-4019-b910-8bdfd13d3042{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}f7b15b21-0c63-4ad6-a80e-afed583276bc{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:CLOSED]
2019-06-14 10:29:16,493 INFO  impl.FollowerState (FollowerState.java:run(101)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA changes to CANDIDATE, lastRpcTime:1022, electionTimeout:1022ms
2019-06-14 10:29:16,493 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: shutdown FollowerState
2019-06-14 10:29:16,493 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA changes role from FOLLOWER to CANDIDATE at term 3 for changeToCandidate
2019-06-14 10:29:16,493 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: start LeaderElection
2019-06-14 10:29:16,496 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA:LeaderElection111: begin an election at term 4 for 0: [f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757, 171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251, 57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155], old=null
2019-06-14 10:29:16,496 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA:LeaderElection111 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:46251
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:16,496 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA:LeaderElection111 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:46155
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:16,497 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA:LeaderElection111: Election REJECTED; received 0 response(s) [] and 2 exception(s); f7b15b21-0c63-4ad6-a80e-afed583276bc:t4, leader=null, voted=f7b15b21-0c63-4ad6-a80e-afed583276bc, raftlog=f7b15b21-0c63-4ad6-a80e-afed583276bc-SegmentedRaftLog:OPENED:c0,f0,i0, conf=0: [f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757, 171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251, 57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155], old=null
2019-06-14 10:29:16,497 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:46251
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:16,497 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:46155
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:16,497 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA changes role from CANDIDATE to FOLLOWER at term 4 for DISCOVERED_A_NEW_TERM
2019-06-14 10:29:16,497 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: shutdown LeaderElection
2019-06-14 10:29:16,497 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: start FollowerState
2019-06-14 10:29:16,601 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1183, electionTimeout:1183ms
2019-06-14 10:29:16,602 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:29:16,602 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 36 for changeToCandidate
2019-06-14 10:29:16,602 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:29:16,604 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection112: begin an election at term 37 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:16,604 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection112 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:16,604 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection112 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:16,605 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection112: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t37, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:16,605 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:16,605 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:16,605 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 37 for DISCOVERED_A_NEW_TERM
2019-06-14 10:29:16,605 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:29:16,605 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:29:16,881 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-307B6FFC1C83->f7b15b21-0c63-4ad6-a80e-afed583276bc: receive RaftClientReply:client-307B6FFC1C83->f7b15b21-0c63-4ad6-a80e-afed583276bc@group-20E2BD1544BA, cid=190, FAILED org.apache.ratis.protocol.NotLeaderException: Server f7b15b21-0c63-4ad6-a80e-afed583276bc is not the leader (57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155). Request must be sent to leader., logIndex=0, commits[f7b15b21-0c63-4ad6-a80e-afed583276bc:c0, 171f5ea1-4e80-461d-a416-e5869a7bc19d:c0, 57371422-cdf4-4019-b910-8bdfd13d3042:c0]
2019-06-14 10:29:16,884 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:29:17,065 ERROR commandhandler.CloseContainerCommandHandler (CloseContainerCommandHandler.java:handle(84)) - Container #2 does not exist in datanode. Container close failed.
2019-06-14 10:29:17,659 INFO  impl.FollowerState (FollowerState.java:run(101)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA changes to CANDIDATE, lastRpcTime:1162, electionTimeout:1162ms
2019-06-14 10:29:17,659 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: shutdown FollowerState
2019-06-14 10:29:17,659 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA changes role from FOLLOWER to CANDIDATE at term 4 for changeToCandidate
2019-06-14 10:29:17,660 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: start LeaderElection
2019-06-14 10:29:17,662 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA:LeaderElection113: begin an election at term 5 for 0: [f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757, 171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251, 57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155], old=null
2019-06-14 10:29:17,663 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA:LeaderElection113 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:46155
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:17,663 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA:LeaderElection113 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:46251
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:17,663 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA:LeaderElection113: Election REJECTED; received 0 response(s) [] and 2 exception(s); f7b15b21-0c63-4ad6-a80e-afed583276bc:t5, leader=null, voted=f7b15b21-0c63-4ad6-a80e-afed583276bc, raftlog=f7b15b21-0c63-4ad6-a80e-afed583276bc-SegmentedRaftLog:OPENED:c0,f0,i0, conf=0: [f7b15b21-0c63-4ad6-a80e-afed583276bc:192.168.46.40:38757, 171f5ea1-4e80-461d-a416-e5869a7bc19d:192.168.46.40:46251, 57371422-cdf4-4019-b910-8bdfd13d3042:192.168.46.40:46155], old=null
2019-06-14 10:29:17,663 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:46155
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:17,663 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:46251
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:17,664 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA changes role from CANDIDATE to FOLLOWER at term 5 for DISCOVERED_A_NEW_TERM
2019-06-14 10:29:17,664 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: shutdown LeaderElection
2019-06-14 10:29:17,664 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: start FollowerState
2019-06-14 10:29:17,744 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes to CANDIDATE, lastRpcTime:1138, electionTimeout:1138ms
2019-06-14 10:29:17,744 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown FollowerState
2019-06-14 10:29:17,744 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from FOLLOWER to CANDIDATE at term 37 for changeToCandidate
2019-06-14 10:29:17,744 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start LeaderElection
2019-06-14 10:29:17,746 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection114: begin an election at term 38 for 0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:17,747 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection114 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:17,747 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection114 got exception when requesting votes: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:17,747 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0:LeaderElection114: Election REJECTED; received 0 response(s) [] and 2 exception(s); b0aa3512-c9c4-47f5-8fca-680ed027fea5:t38, leader=null, voted=b0aa3512-c9c4-47f5-8fca-680ed027fea5, raftlog=b0aa3512-c9c4-47f5-8fca-680ed027fea5-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [3f724bbd-d63c-4ef6-aa2a-655c2fd50fa1:192.168.46.40:41431, 3e94f7ad-f8b9-473d-b417-a18a228d116d:192.168.46.40:38747, b0aa3512-c9c4-47f5-8fca-680ed027fea5:192.168.46.40:43081], old=null
2019-06-14 10:29:17,747 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 0: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:41431
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:17,747 INFO  impl.LeaderElection (LogUtils.java:infoOrTrace(149)) -   Exception 1: {}
java.util.concurrent.ExecutionException: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.util.concurrent.FutureTask.get(FutureTask.java:192)
	at org.apache.ratis.server.impl.LeaderElection.waitForResults(LeaderElection.java:262)
	at org.apache.ratis.server.impl.LeaderElection.askForVotes(LeaderElection.java:200)
	at org.apache.ratis.server.impl.LeaderElection.run(LeaderElection.java:130)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: UNAVAILABLE: io exception
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.toStatusRuntimeException(ClientCalls.java:233)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.getUnchecked(ClientCalls.java:214)
	at org.apache.ratis.thirdparty.io.grpc.stub.ClientCalls.blockingUnaryCall(ClientCalls.java:139)
	at org.apache.ratis.proto.grpc.RaftServerProtocolServiceGrpc$RaftServerProtocolServiceBlockingStub.requestVote(RaftServerProtocolServiceGrpc.java:265)
	at org.apache.ratis.grpc.server.GrpcServerProtocolClient.requestVote(GrpcServerProtocolClient.java:83)
	at org.apache.ratis.grpc.server.GrpcService.requestVote(GrpcService.java:194)
	at org.apache.ratis.server.impl.LeaderElection.lambda$submitRequests$1(LeaderElection.java:237)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more
Caused by: org.apache.ratis.thirdparty.io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /192.168.46.40:38747
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at org.apache.ratis.thirdparty.io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:579)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:496)
	at org.apache.ratis.thirdparty.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:897)
	at org.apache.ratis.thirdparty.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 more
Caused by: java.net.ConnectException: Connection refused
	... 11 more
2019-06-14 10:29:17,748 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5:group-E9B621366AF0 changes role from CANDIDATE to FOLLOWER at term 38 for DISCOVERED_A_NEW_TERM
2019-06-14 10:29:17,748 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: shutdown LeaderElection
2019-06-14 10:29:17,748 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0aa3512-c9c4-47f5-8fca-680ed027fea5: start FollowerState
2019-06-14 10:29:17,898 WARN  io.KeyOutputStream (KeyOutputStream.java:handleException(276)) - Encountered exception java.io.IOException: Unexpected Storage Container Exception: java.util.concurrent.CompletionException: java.util.concurrent.CompletionException: org.apache.ratis.protocol.RaftRetryFailureException: Failed RaftClientRequest:client-307B6FFC1C83->171f5ea1-4e80-461d-a416-e5869a7bc19d@group-20E2BD1544BA, cid=190, seq=1*, RW, org.apache.hadoop.hdds.scm.XceiverClientRatis$$Lambda$436/510793091@5bd37bd8 for 5 attempts with RetryLimited(maxAttempts=5, sleepTime=1000ms) on the pipeline Pipeline[ Id: f01c641c-4ee0-44f9-8fb5-20e2bd1544ba, Nodes: 171f5ea1-4e80-461d-a416-e5869a7bc19d{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}57371422-cdf4-4019-b910-8bdfd13d3042{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}f7b15b21-0c63-4ad6-a80e-afed583276bc{ip: 192.168.46.40, host: ozone-cf6ld-438179620, networkLocation: /default-rack, certSerialId: null}, Type:RATIS, Factor:THREE, State:OPEN]. The last committed block length is 0, uncommitted data length is 2097152 retry count 0
2019-06-14 10:29:17,944 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7: receive RaftClientReply:client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7@group-EDAE2759944E, cid=194, SUCCESS, logIndex=17, commits[9be33dce-856e-46ae-b2e2-37061770f2b7:c17, 090e4df3-5a2c-401f-9461-61991e9fc29d:c16, 918fd2a8-d728-4869-bad5-c7f6d75fff19:c16]
2019-06-14 10:29:17,967 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7: receive RaftClientReply:client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7@group-EDAE2759944E, cid=195, SUCCESS, logIndex=19, commits[9be33dce-856e-46ae-b2e2-37061770f2b7:c24, 090e4df3-5a2c-401f-9461-61991e9fc29d:c21, 918fd2a8-d728-4869-bad5-c7f6d75fff19:c21]
2019-06-14 10:29:17,968 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7: receive RaftClientReply:client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7@group-EDAE2759944E, cid=196, SUCCESS, logIndex=20, commits[9be33dce-856e-46ae-b2e2-37061770f2b7:c24, 090e4df3-5a2c-401f-9461-61991e9fc29d:c21, 918fd2a8-d728-4869-bad5-c7f6d75fff19:c21]
2019-06-14 10:29:17,986 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7: receive RaftClientReply:client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7@group-EDAE2759944E, cid=197, SUCCESS, logIndex=21, commits[9be33dce-856e-46ae-b2e2-37061770f2b7:c24, 090e4df3-5a2c-401f-9461-61991e9fc29d:c21, 918fd2a8-d728-4869-bad5-c7f6d75fff19:c21]
2019-06-14 10:29:17,998 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7: receive RaftClientReply:client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7@group-EDAE2759944E, cid=198, SUCCESS, logIndex=25, commits[9be33dce-856e-46ae-b2e2-37061770f2b7:c25, 090e4df3-5a2c-401f-9461-61991e9fc29d:c24, 918fd2a8-d728-4869-bad5-c7f6d75fff19:c21]
2019-06-14 10:29:18,008 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7: receive RaftClientReply:client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7@group-EDAE2759944E, cid=199, SUCCESS, logIndex=27, commits[9be33dce-856e-46ae-b2e2-37061770f2b7:c27, 090e4df3-5a2c-401f-9461-61991e9fc29d:c24, 918fd2a8-d728-4869-bad5-c7f6d75fff19:c25]
2019-06-14 10:29:18,018 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7: receive RaftClientReply:client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7@group-EDAE2759944E, cid=200, SUCCESS, logIndex=28, commits[9be33dce-856e-46ae-b2e2-37061770f2b7:c29, 090e4df3-5a2c-401f-9461-61991e9fc29d:c25, 918fd2a8-d728-4869-bad5-c7f6d75fff19:c26]
2019-06-14 10:29:18,021 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7: receive RaftClientReply:client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7@group-EDAE2759944E, cid=201, SUCCESS, logIndex=29, commits[9be33dce-856e-46ae-b2e2-37061770f2b7:c29, 090e4df3-5a2c-401f-9461-61991e9fc29d:c25, 918fd2a8-d728-4869-bad5-c7f6d75fff19:c26]
2019-06-14 10:29:18,023 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7: receive RaftClientReply:client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7@group-EDAE2759944E, cid=202, SUCCESS, logIndex=0, commits[9be33dce-856e-46ae-b2e2-37061770f2b7:c32, 090e4df3-5a2c-401f-9461-61991e9fc29d:c29, 918fd2a8-d728-4869-bad5-c7f6d75fff19:c27]
2019-06-14 10:29:18,024 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7: receive RaftClientReply:client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7@group-EDAE2759944E, cid=203, SUCCESS, logIndex=0, commits[9be33dce-856e-46ae-b2e2-37061770f2b7:c32, 090e4df3-5a2c-401f-9461-61991e9fc29d:c29, 918fd2a8-d728-4869-bad5-c7f6d75fff19:c29]
2019-06-14 10:29:18,064 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7: receive RaftClientReply:client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7@group-EDAE2759944E, cid=204, SUCCESS, logIndex=33, commits[9be33dce-856e-46ae-b2e2-37061770f2b7:c33, 090e4df3-5a2c-401f-9461-61991e9fc29d:c32, 918fd2a8-d728-4869-bad5-c7f6d75fff19:c32]
2019-06-14 10:29:18,086 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7: receive RaftClientReply:client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7@group-EDAE2759944E, cid=205, SUCCESS, logIndex=35, commits[9be33dce-856e-46ae-b2e2-37061770f2b7:c40, 090e4df3-5a2c-401f-9461-61991e9fc29d:c37, 918fd2a8-d728-4869-bad5-c7f6d75fff19:c37]
2019-06-14 10:29:18,087 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7: receive RaftClientReply:client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7@group-EDAE2759944E, cid=206, SUCCESS, logIndex=36, commits[9be33dce-856e-46ae-b2e2-37061770f2b7:c40, 090e4df3-5a2c-401f-9461-61991e9fc29d:c37, 918fd2a8-d728-4869-bad5-c7f6d75fff19:c37]
2019-06-14 10:29:18,107 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7: receive RaftClientReply:client-AE2EA10F7D2B->9be33dce-856e-46ae-b2e2-37061770f2b7@group-EDAE2759944E, cid=207, SUCCESS, logIndex=37, commits[9be33dce-856e-46ae-b2e2-37061770f2b7:c40, 090e4df3-5a2c-401f-9461-61991e9fc29d:c37, 918fd2a8-d728-4869-bad5-c7f6d75fff19:c37]
2019-06-14 10:29:18,377 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:shutdown(321)) - Shutting down the Mini Ozone Cluster
2019-06-14 10:29:18,378 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(336)) - Stopping the Mini Ozone Cluster
2019-06-14 10:29:18,378 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(338)) - Stopping the OzoneManager
2019-06-14 10:29:18,378 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 44719
2019-06-14 10:29:18,382 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 44719
2019-06-14 10:29:18,383 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-14 10:29:18,383 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service KeyDeletingService
2019-06-14 10:29:18,386 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@269a37bc{/,null,UNAVAILABLE}{/ozoneManager}
2019-06-14 10:29:18,386 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@106e816c{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:29:18,386 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@38cbbd0b{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,UNAVAILABLE}
2019-06-14 10:29:18,387 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@4540aade{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:29:18,388 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(344)) - Stopping the StorageContainerManager
2019-06-14 10:29:18,389 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(789)) - Stopping Replication Manager Service.
2019-06-14 10:29:18,389 INFO  container.ReplicationManager (ReplicationManager.java:stop(191)) - Replication Monitor Thread is not running.
2019-06-14 10:29:18,389 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(796)) - Stopping Lease Manager of the command watchers
2019-06-14 10:29:18,389 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(803)) - Stopping datanode service RPC server
2019-06-14 10:29:18,389 INFO  server.SCMDatanodeProtocolServer (SCMDatanodeProtocolServer.java:stop(373)) - Stopping the RPC server for DataNodes
2019-06-14 10:29:18,389 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 44463
2019-06-14 10:29:18,392 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 44463
2019-06-14 10:29:18,392 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-14 10:29:18,392 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(811)) - Stopping block service RPC server
2019-06-14 10:29:18,394 INFO  server.SCMBlockProtocolServer (SCMBlockProtocolServer.java:stop(145)) - Stopping the RPC server for Block Protocol
2019-06-14 10:29:18,394 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 41413
2019-06-14 10:29:18,397 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 41413
2019-06-14 10:29:18,397 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(818)) - Stopping the StorageContainerLocationProtocol RPC server
2019-06-14 10:29:18,399 INFO  server.SCMClientProtocolServer (SCMClientProtocolServer.java:stop(157)) - Stopping the RPC server for Client Protocol
2019-06-14 10:29:18,399 INFO  ipc.Server (Server.java:stop(3082)) - Stopping server on 38837
2019-06-14 10:29:18,399 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-14 10:29:18,402 INFO  ipc.Server (Server.java:run(1185)) - Stopping IPC Server listener on 38837
2019-06-14 10:29:18,402 INFO  ipc.Server (Server.java:run(1319)) - Stopping IPC Server Responder
2019-06-14 10:29:18,417 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(825)) - Stopping Storage Container Manager HTTP server.
2019-06-14 10:29:18,418 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@1fcef7{/,null,UNAVAILABLE}{/scm}
2019-06-14 10:29:18,418 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@2f341732{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:29:18,418 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@29ff84fa{/static,file:///opt/src/hadoop-ozone/integration-test/target/test-classes/webapps/static,UNAVAILABLE}
2019-06-14 10:29:18,418 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@4ee9daf5{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:29:18,419 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(836)) - Stopping Block Manager Service.
2019-06-14 10:29:18,419 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service SCMBlockDeletingService
2019-06-14 10:29:18,419 INFO  utils.BackgroundService (BackgroundService.java:shutdown(148)) - Shutting down service SCMBlockDeletingService
2019-06-14 10:29:18,420 INFO  server.StorageContainerManager (StorageContainerManager.java:stop(858)) - Stopping SCM Event Queue.
2019-06-14 10:29:18,423 INFO  ozone.MiniOzoneClusterImpl (MiniOzoneClusterImpl.java:stop(350)) - Shutting the HddsDatanodes
2019-06-14 10:29:18,423 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:29:18,423 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@673ce246
2019-06-14 10:29:18,423 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:29:18,424 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:29:18,424 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: close
2019-06-14 10:29:18,424 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: shutdown group-20E2BD1544BA
2019-06-14 10:29:18,424 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-20E2BD1544BA,id=f7b15b21-0c63-4ad6-a80e-afed583276bc
2019-06-14 10:29:18,424 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: shutdown FollowerState
2019-06-14 10:29:18,425 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-f7b15b21-0c63-4ad6-a80e-afed583276bc-group-20E2BD1544BA: set stopIndex = 0
2019-06-14 10:29:18,425 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:29:18,425 INFO  impl.FollowerState (FollowerState.java:run(109)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:29:18,425 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-20E2BD1544BA closes. The last applied log index is 0
2019-06-14 10:29:18,425 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - f7b15b21-0c63-4ad6-a80e-afed583276bc-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:29:18,425 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - f7b15b21-0c63-4ad6-a80e-afed583276bc-RaftLogWorker close()
2019-06-14 10:29:18,426 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: shutdown group-1811AC1DC160
2019-06-14 10:29:18,426 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-1811AC1DC160,id=f7b15b21-0c63-4ad6-a80e-afed583276bc
2019-06-14 10:29:18,426 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: shutdown LeaderState
2019-06-14 10:29:18,426 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - f7b15b21-0c63-4ad6-a80e-afed583276bc-PendingRequests: sendNotLeaderResponses
2019-06-14 10:29:18,436 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-f7b15b21-0c63-4ad6-a80e-afed583276bc-group-1811AC1DC160: set stopIndex = 0
2019-06-14 10:29:18,436 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:29:18,437 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - f7b15b21-0c63-4ad6-a80e-afed583276bc:group-1811AC1DC160 closes. The last applied log index is 0
2019-06-14 10:29:18,437 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - f7b15b21-0c63-4ad6-a80e-afed583276bc-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:29:18,437 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - f7b15b21-0c63-4ad6-a80e-afed583276bc-RaftLogWorker close()
2019-06-14 10:29:18,437 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: shutdown server with port 38757 now
2019-06-14 10:29:18,438 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - f7b15b21-0c63-4ad6-a80e-afed583276bc: shutdown server with port 38757 successfully
2019-06-14 10:29:18,441 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:29:18,455 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:29:18,456 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@1ac8f29c{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:29:18,456 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@1d07d728{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:29:18,456 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@21288943{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:29:18,457 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@6ce7d6ab{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:29:18,457 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:29:18,457 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@e8bd42f
2019-06-14 10:29:18,457 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:29:18,458 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:29:18,458 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: close
2019-06-14 10:29:18,458 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: shutdown group-EDAE2759944E
2019-06-14 10:29:18,458 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-EDAE2759944E,id=918fd2a8-d728-4869-bad5-c7f6d75fff19
2019-06-14 10:29:18,458 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: shutdown FollowerState
2019-06-14 10:29:18,458 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-918fd2a8-d728-4869-bad5-c7f6d75fff19-group-EDAE2759944E: set stopIndex = 37
2019-06-14 10:29:18,459 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:37)
2019-06-14 10:29:18,458 INFO  impl.FollowerState (FollowerState.java:run(109)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:29:18,459 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-3/data/ratis/f3f67ffc-988d-4fc3-b35f-edae2759944e/sm/snapshot.1_37
2019-06-14 10:29:18,459 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19:group-EDAE2759944E closes. The last applied log index is 37
2019-06-14 10:29:18,459 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:29:18,461 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19-RaftLogWorker close()
2019-06-14 10:29:18,461 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: shutdown group-553A09606F97
2019-06-14 10:29:18,461 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-553A09606F97,id=918fd2a8-d728-4869-bad5-c7f6d75fff19
2019-06-14 10:29:18,461 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: shutdown LeaderState
2019-06-14 10:29:18,462 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19-PendingRequests: sendNotLeaderResponses
2019-06-14 10:29:18,463 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-918fd2a8-d728-4869-bad5-c7f6d75fff19-group-553A09606F97: set stopIndex = 0
2019-06-14 10:29:18,463 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:29:18,464 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19:group-553A09606F97 closes. The last applied log index is 0
2019-06-14 10:29:18,464 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:29:18,464 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19-RaftLogWorker close()
2019-06-14 10:29:18,464 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: shutdown server with port 33041 now
2019-06-14 10:29:18,465 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:29:18,465 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: Failed appendEntries to 918fd2a8-d728-4869-bad5-c7f6d75fff19:192.168.46.40:33041: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-14 10:29:18,465 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 9be33dce-856e-46ae-b2e2-37061770f2b7->918fd2a8-d728-4869-bad5-c7f6d75fff19: nextIndex: updateUnconditionally 41 -> 0
2019-06-14 10:29:18,467 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 918fd2a8-d728-4869-bad5-c7f6d75fff19: shutdown server with port 33041 successfully
2019-06-14 10:29:18,468 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:29:18,481 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:29:18,482 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@764bf20d{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:29:18,482 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@363bf9d{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:29:18,482 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@73790bb5{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:29:18,482 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@79f14c56{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:29:18,483 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:29:18,483 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@79c4c973
2019-06-14 10:29:18,483 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:29:18,483 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:29:18,483 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: close
2019-06-14 10:29:18,484 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: shutdown group-EDAE2759944E
2019-06-14 10:29:18,484 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-EDAE2759944E,id=090e4df3-5a2c-401f-9461-61991e9fc29d
2019-06-14 10:29:18,484 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: shutdown FollowerState
2019-06-14 10:29:18,484 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-090e4df3-5a2c-401f-9461-61991e9fc29d-group-EDAE2759944E: set stopIndex = 37
2019-06-14 10:29:18,484 INFO  impl.FollowerState (FollowerState.java:run(109)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-14 10:29:18,484 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:37)
2019-06-14 10:29:18,484 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-4/data/ratis/f3f67ffc-988d-4fc3-b35f-edae2759944e/sm/snapshot.1_37
2019-06-14 10:29:18,485 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 090e4df3-5a2c-401f-9461-61991e9fc29d:group-EDAE2759944E closes. The last applied log index is 37
2019-06-14 10:29:18,485 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 090e4df3-5a2c-401f-9461-61991e9fc29d-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:29:18,486 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 090e4df3-5a2c-401f-9461-61991e9fc29d-RaftLogWorker close()
2019-06-14 10:29:18,487 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: shutdown group-D805F6AE7DF8
2019-06-14 10:29:18,487 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D805F6AE7DF8,id=090e4df3-5a2c-401f-9461-61991e9fc29d
2019-06-14 10:29:18,487 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: shutdown LeaderState
2019-06-14 10:29:18,487 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 090e4df3-5a2c-401f-9461-61991e9fc29d-PendingRequests: sendNotLeaderResponses
2019-06-14 10:29:18,487 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-090e4df3-5a2c-401f-9461-61991e9fc29d-group-D805F6AE7DF8: set stopIndex = 0
2019-06-14 10:29:18,487 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:29:18,488 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 090e4df3-5a2c-401f-9461-61991e9fc29d:group-D805F6AE7DF8 closes. The last applied log index is 0
2019-06-14 10:29:18,488 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 090e4df3-5a2c-401f-9461-61991e9fc29d-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:29:18,488 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 090e4df3-5a2c-401f-9461-61991e9fc29d-RaftLogWorker close()
2019-06-14 10:29:18,488 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: shutdown server with port 38401 now
2019-06-14 10:29:18,494 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:29:18,494 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: Failed appendEntries to 090e4df3-5a2c-401f-9461-61991e9fc29d:192.168.46.40:38401: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-14 10:29:18,494 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 9be33dce-856e-46ae-b2e2-37061770f2b7->090e4df3-5a2c-401f-9461-61991e9fc29d: nextIndex: updateUnconditionally 41 -> 0
2019-06-14 10:29:18,497 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 090e4df3-5a2c-401f-9461-61991e9fc29d: shutdown server with port 38401 successfully
2019-06-14 10:29:18,499 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:29:18,514 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:29:18,515 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@591be976{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:29:18,515 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@520f1862{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:29:18,515 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@421f447f{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:29:18,516 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@4d08fee2{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:29:18,516 INFO  datanode.ObjectStoreHandler (ObjectStoreHandler.java:close(155)) - Closing ObjectStoreHandler.
2019-06-14 10:29:18,516 INFO  ozone.HddsDatanodeService (HddsDatanodeService.java:stop(452)) - Stopped plug-in org.apache.hadoop.ozone.web.OzoneHddsDatanodeService@537979aa
2019-06-14 10:29:18,517 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:lambda$startDaemon$0(350)) - Ozone container server started.
2019-06-14 10:29:18,517 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 10:29:18,517 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: close
2019-06-14 10:29:18,517 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: shutdown group-EDAE2759944E
2019-06-14 10:29:18,517 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-EDAE2759944E,id=9be33dce-856e-46ae-b2e2-37061770f2b7
2019-06-14 10:29:18,517 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: shutdown LeaderState
2019-06-14 10:29:18,518 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(9be33dce-856e-46ae-b2e2-37061770f2b7 -> 090e4df3-5a2c-401f-9461-61991e9fc29d): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:29:18,518 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(9be33dce-856e-46ae-b2e2-37061770f2b7 -> 918fd2a8-d728-4869-bad5-c7f6d75fff19): Wait interrupted by java.lang.InterruptedException
2019-06-14 10:29:18,518 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 9be33dce-856e-46ae-b2e2-37061770f2b7-PendingRequests: sendNotLeaderResponses
2019-06-14 10:29:18,521 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-9be33dce-856e-46ae-b2e2-37061770f2b7-group-EDAE2759944E: set stopIndex = 40
2019-06-14 10:29:18,521 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:40)
2019-06-14 10:29:18,521 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/MiniOzoneClusterImpl-f00c9550-513b-4e43-83f7-af3ebe0fffb0/datanode-5/data/ratis/f3f67ffc-988d-4fc3-b35f-edae2759944e/sm/snapshot.1_40
2019-06-14 10:29:18,521 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 9be33dce-856e-46ae-b2e2-37061770f2b7:group-EDAE2759944E closes. The last applied log index is 40
2019-06-14 10:29:18,522 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 9be33dce-856e-46ae-b2e2-37061770f2b7-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:29:18,523 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 9be33dce-856e-46ae-b2e2-37061770f2b7-RaftLogWorker close()
2019-06-14 10:29:18,523 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: shutdown group-79E7725230EC
2019-06-14 10:29:18,523 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-79E7725230EC,id=9be33dce-856e-46ae-b2e2-37061770f2b7
2019-06-14 10:29:18,524 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: shutdown LeaderState
2019-06-14 10:29:18,524 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 9be33dce-856e-46ae-b2e2-37061770f2b7-PendingRequests: sendNotLeaderResponses
2019-06-14 10:29:18,524 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-9be33dce-856e-46ae-b2e2-37061770f2b7-group-79E7725230EC: set stopIndex = 0
2019-06-14 10:29:18,524 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:0, i:~)
2019-06-14 10:29:18,524 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 9be33dce-856e-46ae-b2e2-37061770f2b7:group-79E7725230EC closes. The last applied log index is 0
2019-06-14 10:29:18,524 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 9be33dce-856e-46ae-b2e2-37061770f2b7-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 10:29:18,524 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 9be33dce-856e-46ae-b2e2-37061770f2b7-RaftLogWorker close()
2019-06-14 10:29:18,525 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: shutdown server with port 37649 now
2019-06-14 10:29:18,525 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-UnorderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-14 10:29:18,525 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 9be33dce-856e-46ae-b2e2-37061770f2b7: shutdown server with port 37649 successfully
2019-06-14 10:29:18,527 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:29:18,537 INFO  statemachine.DatanodeStateMachine (DatanodeStateMachine.java:stopDaemon(395)) - Ozone container server stopped.
2019-06-14 10:29:18,538 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@316745d8{/,null,UNAVAILABLE}{/hddsDatanode}
2019-06-14 10:29:18,538 INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@3df920{HTTP/1.1,[http/1.1]}{0.0.0.0:0}
2019-06-14 10:29:18,538 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@590182a6{/static,jar:file:/root/.m2/repository/org/apache/hadoop/hadoop-hdds-container-service/0.5.0-SNAPSHOT/hadoop-hdds-container-service-0.5.0-SNAPSHOT.jar!/webapps/static,UNAVAILABLE}
2019-06-14 10:29:18,539 INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@701c092c{/logs,file:///opt/src/hadoop-ozone/integration-test/target/log,UNAVAILABLE}
2019-06-14 10:29:18,582 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:29:18,585 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:29:18,586 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 10:29:18,587 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
