2019-06-13 23:44:00,933 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-13 23:44:01,022 INFO  ozone.RatisTestHelper (RatisTestHelper.java:initRatisConf(109)) - dfs.container.ratis.rpc.type = GRPC
2019-06-13 23:44:01,082 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 23:44:01,091 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 34009 (custom)
2019-06-13 23:44:01,092 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 23:44:01,093 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 23:44:01,094 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 23:44:01,095 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 23:44:01,141 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/7cb5d03a-4ede-4877-8e0c-9859de57ee97] (custom)
2019-06-13 23:44:01,147 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 7cb5d03a-4ede-4877-8e0c-9859de57ee97 at port 34009
2019-06-13 23:44:01,175 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97: start RPC server
2019-06-13 23:44:01,178 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97: GrpcService started, listening on 0.0.0.0/0.0.0.0:34009
2019-06-13 23:44:01,251 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97: addNew group-2703F0BF4336:[7cb5d03a-4ede-4877-8e0c-9859de57ee97:0.0.0.0:34009] returns group-2703F0BF4336:java.util.concurrent.CompletableFuture@340bcbf9[Not completed]
2019-06-13 23:44:01,258 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97: new RaftServerImpl for group-2703F0BF4336:[7cb5d03a-4ede-4877-8e0c-9859de57ee97:0.0.0.0:34009] with ContainerStateMachine:uninitialized
2019-06-13 23:44:01,259 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 23:44:01,259 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 23:44:01,260 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 23:44:01,261 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 23:44:01,265 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97:group-2703F0BF4336 ConfigurationManager, init=-1: [7cb5d03a-4ede-4877-8e0c-9859de57ee97:0.0.0.0:34009], old=null, confs=<EMPTY_MAP>
2019-06-13 23:44:01,266 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/7cb5d03a-4ede-4877-8e0c-9859de57ee97] (custom)
2019-06-13 23:44:01,271 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/7cb5d03a-4ede-4877-8e0c-9859de57ee97/43c98f73-6b89-4c16-93eb-2703f0bf4336 does not exist. Creating ...
2019-06-13 23:44:01,279 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/7cb5d03a-4ede-4877-8e0c-9859de57ee97/43c98f73-6b89-4c16-93eb-2703f0bf4336/in_use.lock acquired by nodename 4219@ozone-g79bc-2755786375
2019-06-13 23:44:01,286 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/7cb5d03a-4ede-4877-8e0c-9859de57ee97/43c98f73-6b89-4c16-93eb-2703f0bf4336 has been successfully formatted.
2019-06-13 23:44:01,288 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 23:44:01,288 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 23:44:01,290 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 23:44:01,291 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 23:44:01,294 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 23:44:01,297 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 23:44:01,299 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 7cb5d03a-4ede-4877-8e0c-9859de57ee97-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/7cb5d03a-4ede-4877-8e0c-9859de57ee97/43c98f73-6b89-4c16-93eb-2703f0bf4336
2019-06-13 23:44:01,299 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 23:44:01,300 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 23:44:01,301 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 23:44:01,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 23:44:01,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 23:44:01,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 23:44:01,303 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 23:44:01,303 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 23:44:01,304 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 23:44:01,306 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 23:44:01,311 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 23:44:01,312 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 23:44:01,312 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 23:44:01,326 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97: start group-2703F0BF4336
2019-06-13 23:44:01,327 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97:group-2703F0BF4336 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 23:44:01,328 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97: start FollowerState
2019-06-13 23:44:01,372 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-2703F0BF4336,id=7cb5d03a-4ede-4877-8e0c-9859de57ee97
2019-06-13 23:44:01,429 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-7B7F30A9EE05->7cb5d03a-4ede-4877-8e0c-9859de57ee97: receive RaftClientReply:client-7B7F30A9EE05->7cb5d03a-4ede-4877-8e0c-9859de57ee97@group-2703F0BF4336, cid=1, FAILED org.apache.ratis.protocol.NotLeaderException: Server 7cb5d03a-4ede-4877-8e0c-9859de57ee97 is not the leader (null). Request must be sent to leader., logIndex=0, commits[7cb5d03a-4ede-4877-8e0c-9859de57ee97:c-1]
2019-06-13 23:44:02,436 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-7B7F30A9EE05->7cb5d03a-4ede-4877-8e0c-9859de57ee97: receive RaftClientReply:client-7B7F30A9EE05->7cb5d03a-4ede-4877-8e0c-9859de57ee97@group-2703F0BF4336, cid=1, FAILED org.apache.ratis.protocol.NotLeaderException: Server 7cb5d03a-4ede-4877-8e0c-9859de57ee97 is not the leader (null). Request must be sent to leader., logIndex=0, commits[7cb5d03a-4ede-4877-8e0c-9859de57ee97:c-1]
2019-06-13 23:44:02,502 INFO  impl.FollowerState (FollowerState.java:run(101)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97:group-2703F0BF4336 changes to CANDIDATE, lastRpcTime:1174, electionTimeout:1174ms
2019-06-13 23:44:02,503 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97: shutdown FollowerState
2019-06-13 23:44:02,503 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97:group-2703F0BF4336 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 23:44:02,504 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97: start LeaderElection
2019-06-13 23:44:02,508 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97:group-2703F0BF4336:LeaderElection1: begin an election at term 1 for -1: [7cb5d03a-4ede-4877-8e0c-9859de57ee97:0.0.0.0:34009], old=null
2019-06-13 23:44:02,509 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97: shutdown LeaderElection
2019-06-13 23:44:02,509 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97:group-2703F0BF4336 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 23:44:02,509 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97:group-2703F0BF4336 change Leader from null to 7cb5d03a-4ede-4877-8e0c-9859de57ee97 at term 1 for becomeLeader, leader elected after 1221ms
2019-06-13 23:44:02,513 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 23:44:02,513 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 23:44:02,515 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 23:44:02,515 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 23:44:02,522 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97: start LeaderState
2019-06-13 23:44:02,534 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97-RaftLogWorker: Starting segment from index:0
2019-06-13 23:44:02,541 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97:group-2703F0BF4336 set configuration 0: [7cb5d03a-4ede-4877-8e0c-9859de57ee97:0.0.0.0:34009], old=null at 0
2019-06-13 23:44:02,665 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/7cb5d03a-4ede-4877-8e0c-9859de57ee97/43c98f73-6b89-4c16-93eb-2703f0bf4336/current/log_inprogress_0
2019-06-13 23:44:03,452 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-13 23:44:03,456 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-7B7F30A9EE05->7cb5d03a-4ede-4877-8e0c-9859de57ee97: receive RaftClientReply:client-7B7F30A9EE05->7cb5d03a-4ede-4877-8e0c-9859de57ee97@group-2703F0BF4336, cid=1, SUCCESS, logIndex=1, commits[7cb5d03a-4ede-4877-8e0c-9859de57ee97:c2]
2019-06-13 23:44:03,458 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-13 23:44:03,475 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-4B1B015EBF86->7cb5d03a-4ede-4877-8e0c-9859de57ee97: receive RaftClientReply:client-4B1B015EBF86->7cb5d03a-4ede-4877-8e0c-9859de57ee97@group-2703F0BF4336, cid=2, SUCCESS, logIndex=3, commits[7cb5d03a-4ede-4877-8e0c-9859de57ee97:c3]
2019-06-13 23:44:03,478 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97: close
2019-06-13 23:44:03,479 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97: shutdown group-2703F0BF4336
2019-06-13 23:44:03,480 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-2703F0BF4336,id=7cb5d03a-4ede-4877-8e0c-9859de57ee97
2019-06-13 23:44:03,480 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 23:44:03,481 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97: shutdown LeaderState
2019-06-13 23:44:03,481 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 23:44:03,481 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97-PendingRequests: sendNotLeaderResponses
2019-06-13 23:44:03,484 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-7cb5d03a-4ede-4877-8e0c-9859de57ee97-group-2703F0BF4336: set stopIndex = 4
2019-06-13 23:44:03,484 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-13 23:44:03,484 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/7cb5d03a-4ede-4877-8e0c-9859de57ee97/43c98f73-6b89-4c16-93eb-2703f0bf4336/sm/snapshot.1_4
2019-06-13 23:44:03,490 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97:group-2703F0BF4336 closes. The last applied log index is 4
2019-06-13 23:44:03,491 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 23:44:03,492 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97-RaftLogWorker close()
2019-06-13 23:44:03,493 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97: shutdown server with port 34009 now
2019-06-13 23:44:03,494 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 7cb5d03a-4ede-4877-8e0c-9859de57ee97: shutdown server with port 34009 successfully
2019-06-13 23:44:03,525 INFO  ozone.RatisTestHelper (RatisTestHelper.java:initRatisConf(109)) - dfs.container.ratis.rpc.type = GRPC
2019-06-13 23:44:03,527 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 23:44:03,527 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 40401 (custom)
2019-06-13 23:44:03,527 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 23:44:03,528 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 23:44:03,528 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 23:44:03,528 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 23:44:03,529 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/942aa5d8-f8a8-496f-a9bd-0caa1ca91201] (custom)
2019-06-13 23:44:03,530 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 942aa5d8-f8a8-496f-a9bd-0caa1ca91201 at port 40401
2019-06-13 23:44:03,538 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201: start RPC server
2019-06-13 23:44:03,539 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201: GrpcService started, listening on 0.0.0.0/0.0.0.0:40401
Jun 13, 2019 11:44:03 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=17, target=0.0.0.0:34009} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:130)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 13, 2019 11:44:03 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=9, target=0.0.0.0:38085} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connectToDatanode(XceiverClientGrpc.java:163)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connect(XceiverClientGrpc.java:120)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:227)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServer(TestSecureContainerServer.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-13 23:44:03,566 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201: addNew group-996CF2610353:[5543420f-b2e8-4ceb-be6e-1137a3c424cf:0.0.0.0:39267, a9913dac-a426-49f4-8975-23bc7c1fe456:0.0.0.0:35905, 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:0.0.0.0:40401] returns group-996CF2610353:java.util.concurrent.CompletableFuture@53ff1878[Not completed]
2019-06-13 23:44:03,566 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201: new RaftServerImpl for group-996CF2610353:[5543420f-b2e8-4ceb-be6e-1137a3c424cf:0.0.0.0:39267, a9913dac-a426-49f4-8975-23bc7c1fe456:0.0.0.0:35905, 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:0.0.0.0:40401] with ContainerStateMachine:uninitialized
2019-06-13 23:44:03,567 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 23:44:03,567 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 23:44:03,567 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 23:44:03,567 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 23:44:03,568 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:group-996CF2610353 ConfigurationManager, init=-1: [5543420f-b2e8-4ceb-be6e-1137a3c424cf:0.0.0.0:39267, a9913dac-a426-49f4-8975-23bc7c1fe456:0.0.0.0:35905, 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:0.0.0.0:40401], old=null, confs=<EMPTY_MAP>
2019-06-13 23:44:03,568 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/942aa5d8-f8a8-496f-a9bd-0caa1ca91201] (custom)
2019-06-13 23:44:03,568 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/942aa5d8-f8a8-496f-a9bd-0caa1ca91201/cfa56456-d76f-417c-9ca2-996cf2610353 does not exist. Creating ...
2019-06-13 23:44:03,571 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/942aa5d8-f8a8-496f-a9bd-0caa1ca91201/cfa56456-d76f-417c-9ca2-996cf2610353/in_use.lock acquired by nodename 4219@ozone-g79bc-2755786375
2019-06-13 23:44:03,573 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/942aa5d8-f8a8-496f-a9bd-0caa1ca91201/cfa56456-d76f-417c-9ca2-996cf2610353 has been successfully formatted.
2019-06-13 23:44:03,574 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 23:44:03,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 23:44:03,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 23:44:03,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 23:44:03,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 23:44:03,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 23:44:03,574 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 942aa5d8-f8a8-496f-a9bd-0caa1ca91201-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/942aa5d8-f8a8-496f-a9bd-0caa1ca91201/cfa56456-d76f-417c-9ca2-996cf2610353
2019-06-13 23:44:03,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 23:44:03,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 23:44:03,575 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 23:44:03,575 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 23:44:03,575 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 23:44:03,575 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 23:44:03,575 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 23:44:03,575 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 23:44:03,575 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 23:44:03,575 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 23:44:03,576 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 23:44:03,576 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 23:44:03,576 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 23:44:03,576 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201: start group-996CF2610353
2019-06-13 23:44:03,576 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:group-996CF2610353 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 23:44:03,577 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201: start FollowerState
2019-06-13 23:44:03,577 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-996CF2610353,id=942aa5d8-f8a8-496f-a9bd-0caa1ca91201
2019-06-13 23:44:03,583 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 23:44:03,583 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 39267 (custom)
2019-06-13 23:44:03,583 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 23:44:03,584 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 23:44:03,584 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 23:44:03,584 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 23:44:03,585 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/5543420f-b2e8-4ceb-be6e-1137a3c424cf] (custom)
2019-06-13 23:44:03,585 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 5543420f-b2e8-4ceb-be6e-1137a3c424cf at port 39267
2019-06-13 23:44:03,594 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf: start RPC server
2019-06-13 23:44:03,596 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf: GrpcService started, listening on 0.0.0.0/0.0.0.0:39267
2019-06-13 23:44:03,620 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf: addNew group-996CF2610353:[5543420f-b2e8-4ceb-be6e-1137a3c424cf:0.0.0.0:39267, a9913dac-a426-49f4-8975-23bc7c1fe456:0.0.0.0:35905, 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:0.0.0.0:40401] returns group-996CF2610353:java.util.concurrent.CompletableFuture@74922d52[Not completed]
2019-06-13 23:44:03,620 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf: new RaftServerImpl for group-996CF2610353:[5543420f-b2e8-4ceb-be6e-1137a3c424cf:0.0.0.0:39267, a9913dac-a426-49f4-8975-23bc7c1fe456:0.0.0.0:35905, 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:0.0.0.0:40401] with ContainerStateMachine:uninitialized
2019-06-13 23:44:03,621 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 23:44:03,621 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 23:44:03,621 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 23:44:03,621 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 23:44:03,622 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf:group-996CF2610353 ConfigurationManager, init=-1: [5543420f-b2e8-4ceb-be6e-1137a3c424cf:0.0.0.0:39267, a9913dac-a426-49f4-8975-23bc7c1fe456:0.0.0.0:35905, 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:0.0.0.0:40401], old=null, confs=<EMPTY_MAP>
2019-06-13 23:44:03,622 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/5543420f-b2e8-4ceb-be6e-1137a3c424cf] (custom)
2019-06-13 23:44:03,622 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/5543420f-b2e8-4ceb-be6e-1137a3c424cf/cfa56456-d76f-417c-9ca2-996cf2610353 does not exist. Creating ...
2019-06-13 23:44:03,624 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/5543420f-b2e8-4ceb-be6e-1137a3c424cf/cfa56456-d76f-417c-9ca2-996cf2610353/in_use.lock acquired by nodename 4219@ozone-g79bc-2755786375
2019-06-13 23:44:03,627 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/5543420f-b2e8-4ceb-be6e-1137a3c424cf/cfa56456-d76f-417c-9ca2-996cf2610353 has been successfully formatted.
2019-06-13 23:44:03,627 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 23:44:03,627 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 23:44:03,627 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 23:44:03,627 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 23:44:03,628 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 23:44:03,628 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 23:44:03,628 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 5543420f-b2e8-4ceb-be6e-1137a3c424cf-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/5543420f-b2e8-4ceb-be6e-1137a3c424cf/cfa56456-d76f-417c-9ca2-996cf2610353
2019-06-13 23:44:03,628 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 23:44:03,628 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 23:44:03,628 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 23:44:03,628 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 23:44:03,629 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 23:44:03,629 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 23:44:03,629 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 23:44:03,629 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 23:44:03,629 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 23:44:03,629 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 23:44:03,630 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 23:44:03,630 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 23:44:03,630 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 23:44:03,630 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf: start group-996CF2610353
2019-06-13 23:44:03,631 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf:group-996CF2610353 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 23:44:03,631 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf: start FollowerState
2019-06-13 23:44:03,631 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-996CF2610353,id=5543420f-b2e8-4ceb-be6e-1137a3c424cf
2019-06-13 23:44:03,638 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 23:44:03,639 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 35905 (custom)
2019-06-13 23:44:03,639 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 23:44:03,639 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 23:44:03,640 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 23:44:03,640 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 23:44:03,641 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/a9913dac-a426-49f4-8975-23bc7c1fe456] (custom)
2019-06-13 23:44:03,641 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis a9913dac-a426-49f4-8975-23bc7c1fe456 at port 35905
2019-06-13 23:44:03,646 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - a9913dac-a426-49f4-8975-23bc7c1fe456: start RPC server
2019-06-13 23:44:03,648 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - a9913dac-a426-49f4-8975-23bc7c1fe456: GrpcService started, listening on 0.0.0.0/0.0.0.0:35905
2019-06-13 23:44:03,669 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - a9913dac-a426-49f4-8975-23bc7c1fe456: addNew group-996CF2610353:[5543420f-b2e8-4ceb-be6e-1137a3c424cf:0.0.0.0:39267, a9913dac-a426-49f4-8975-23bc7c1fe456:0.0.0.0:35905, 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:0.0.0.0:40401] returns group-996CF2610353:java.util.concurrent.CompletableFuture@19c9d4bd[Not completed]
2019-06-13 23:44:03,669 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - a9913dac-a426-49f4-8975-23bc7c1fe456: new RaftServerImpl for group-996CF2610353:[5543420f-b2e8-4ceb-be6e-1137a3c424cf:0.0.0.0:39267, a9913dac-a426-49f4-8975-23bc7c1fe456:0.0.0.0:35905, 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:0.0.0.0:40401] with ContainerStateMachine:uninitialized
2019-06-13 23:44:03,670 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 23:44:03,670 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 23:44:03,670 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 23:44:03,670 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 23:44:03,670 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - a9913dac-a426-49f4-8975-23bc7c1fe456:group-996CF2610353 ConfigurationManager, init=-1: [5543420f-b2e8-4ceb-be6e-1137a3c424cf:0.0.0.0:39267, a9913dac-a426-49f4-8975-23bc7c1fe456:0.0.0.0:35905, 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:0.0.0.0:40401], old=null, confs=<EMPTY_MAP>
2019-06-13 23:44:03,670 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/a9913dac-a426-49f4-8975-23bc7c1fe456] (custom)
2019-06-13 23:44:03,671 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/a9913dac-a426-49f4-8975-23bc7c1fe456/cfa56456-d76f-417c-9ca2-996cf2610353 does not exist. Creating ...
2019-06-13 23:44:03,673 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/a9913dac-a426-49f4-8975-23bc7c1fe456/cfa56456-d76f-417c-9ca2-996cf2610353/in_use.lock acquired by nodename 4219@ozone-g79bc-2755786375
2019-06-13 23:44:03,675 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/a9913dac-a426-49f4-8975-23bc7c1fe456/cfa56456-d76f-417c-9ca2-996cf2610353 has been successfully formatted.
2019-06-13 23:44:03,676 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 23:44:03,676 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 23:44:03,676 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 23:44:03,676 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 23:44:03,676 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 23:44:03,676 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 23:44:03,676 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new a9913dac-a426-49f4-8975-23bc7c1fe456-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/a9913dac-a426-49f4-8975-23bc7c1fe456/cfa56456-d76f-417c-9ca2-996cf2610353
2019-06-13 23:44:03,676 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 23:44:03,677 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 23:44:03,677 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 23:44:03,677 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 23:44:03,677 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 23:44:03,677 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 23:44:03,677 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 23:44:03,677 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 23:44:03,677 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 23:44:03,677 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 23:44:03,678 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 23:44:03,678 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 23:44:03,678 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 23:44:03,678 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - a9913dac-a426-49f4-8975-23bc7c1fe456: start group-996CF2610353
2019-06-13 23:44:03,678 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a9913dac-a426-49f4-8975-23bc7c1fe456:group-996CF2610353 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 23:44:03,679 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a9913dac-a426-49f4-8975-23bc7c1fe456: start FollowerState
2019-06-13 23:44:03,679 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-996CF2610353,id=a9913dac-a426-49f4-8975-23bc7c1fe456
2019-06-13 23:44:03,692 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-188277AAB369->942aa5d8-f8a8-496f-a9bd-0caa1ca91201: receive RaftClientReply:client-188277AAB369->942aa5d8-f8a8-496f-a9bd-0caa1ca91201@group-996CF2610353, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server 942aa5d8-f8a8-496f-a9bd-0caa1ca91201 is not the leader (a9913dac-a426-49f4-8975-23bc7c1fe456:0.0.0.0:35905). Request must be sent to leader., logIndex=0, commits[942aa5d8-f8a8-496f-a9bd-0caa1ca91201:c-1]
2019-06-13 23:44:03,694 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 23:44:04,697 INFO  impl.FollowerState (FollowerState.java:run(101)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:group-996CF2610353 changes to CANDIDATE, lastRpcTime:1120, electionTimeout:1120ms
2019-06-13 23:44:04,697 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201: shutdown FollowerState
2019-06-13 23:44:04,698 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:group-996CF2610353 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 23:44:04,698 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201: start LeaderElection
2019-06-13 23:44:04,706 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-188277AAB369->5543420f-b2e8-4ceb-be6e-1137a3c424cf: receive RaftClientReply:client-188277AAB369->5543420f-b2e8-4ceb-be6e-1137a3c424cf@group-996CF2610353, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server 5543420f-b2e8-4ceb-be6e-1137a3c424cf is not the leader (942aa5d8-f8a8-496f-a9bd-0caa1ca91201:0.0.0.0:40401). Request must be sent to leader., logIndex=0, commits[5543420f-b2e8-4ceb-be6e-1137a3c424cf:c-1]
2019-06-13 23:44:04,706 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:group-996CF2610353:LeaderElection2: begin an election at term 1 for -1: [5543420f-b2e8-4ceb-be6e-1137a3c424cf:0.0.0.0:39267, a9913dac-a426-49f4-8975-23bc7c1fe456:0.0.0.0:35905, 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:0.0.0.0:40401], old=null
2019-06-13 23:44:04,709 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 23:44:04,724 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf:group-996CF2610353 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:942aa5d8-f8a8-496f-a9bd-0caa1ca91201
2019-06-13 23:44:04,724 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a9913dac-a426-49f4-8975-23bc7c1fe456:group-996CF2610353 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:942aa5d8-f8a8-496f-a9bd-0caa1ca91201
2019-06-13 23:44:04,724 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf: shutdown FollowerState
2019-06-13 23:44:04,724 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a9913dac-a426-49f4-8975-23bc7c1fe456: shutdown FollowerState
2019-06-13 23:44:04,724 INFO  impl.FollowerState (FollowerState.java:run(109)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 23:44:04,724 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf: start FollowerState
2019-06-13 23:44:04,724 INFO  impl.FollowerState (FollowerState.java:run(109)) - a9913dac-a426-49f4-8975-23bc7c1fe456: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 23:44:04,724 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a9913dac-a426-49f4-8975-23bc7c1fe456: start FollowerState
2019-06-13 23:44:04,735 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:group-996CF2610353:LeaderElection2: Election PASSED; received 1 response(s) [942aa5d8-f8a8-496f-a9bd-0caa1ca91201->a9913dac-a426-49f4-8975-23bc7c1fe456,true-t1] and 0 exception(s); 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:t1, leader=null, voted=942aa5d8-f8a8-496f-a9bd-0caa1ca91201, raftlog=942aa5d8-f8a8-496f-a9bd-0caa1ca91201-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [5543420f-b2e8-4ceb-be6e-1137a3c424cf:0.0.0.0:39267, a9913dac-a426-49f4-8975-23bc7c1fe456:0.0.0.0:35905, 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:0.0.0.0:40401], old=null
2019-06-13 23:44:04,735 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201: shutdown LeaderElection
2019-06-13 23:44:04,735 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:group-996CF2610353 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 23:44:04,735 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:group-996CF2610353 change Leader from null to 942aa5d8-f8a8-496f-a9bd-0caa1ca91201 at term 1 for becomeLeader, leader elected after 1161ms
2019-06-13 23:44:04,735 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 23:44:04,736 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 23:44:04,736 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 23:44:04,736 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 23:44:04,738 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 23:44:04,738 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 23:44:04,738 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 23:44:04,802 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 23:44:04,803 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 23:44:04,803 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 23:44:04,803 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 23:44:04,803 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 23:44:04,803 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 23:44:04,803 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 23:44:04,804 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 23:44:04,804 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 23:44:04,804 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201: start LeaderState
2019-06-13 23:44:04,804 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201-RaftLogWorker: Starting segment from index:0
2019-06-13 23:44:04,810 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:group-996CF2610353 set configuration 0: [5543420f-b2e8-4ceb-be6e-1137a3c424cf:0.0.0.0:39267, a9913dac-a426-49f4-8975-23bc7c1fe456:0.0.0.0:35905, 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:0.0.0.0:40401], old=null at 0
2019-06-13 23:44:04,826 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf:group-996CF2610353 change Leader from null to 942aa5d8-f8a8-496f-a9bd-0caa1ca91201 at term 1 for appendEntries, leader elected after 1199ms
2019-06-13 23:44:04,827 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - a9913dac-a426-49f4-8975-23bc7c1fe456:group-996CF2610353 change Leader from null to 942aa5d8-f8a8-496f-a9bd-0caa1ca91201 at term 1 for appendEntries, leader elected after 1150ms
2019-06-13 23:44:04,844 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/942aa5d8-f8a8-496f-a9bd-0caa1ca91201/cfa56456-d76f-417c-9ca2-996cf2610353/current/log_inprogress_0
2019-06-13 23:44:04,862 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf:group-996CF2610353 set configuration 0: [5543420f-b2e8-4ceb-be6e-1137a3c424cf:0.0.0.0:39267, a9913dac-a426-49f4-8975-23bc7c1fe456:0.0.0.0:35905, 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:0.0.0.0:40401], old=null at 0
2019-06-13 23:44:04,862 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - a9913dac-a426-49f4-8975-23bc7c1fe456:group-996CF2610353 set configuration 0: [5543420f-b2e8-4ceb-be6e-1137a3c424cf:0.0.0.0:39267, a9913dac-a426-49f4-8975-23bc7c1fe456:0.0.0.0:35905, 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:0.0.0.0:40401], old=null at 0
2019-06-13 23:44:04,862 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - a9913dac-a426-49f4-8975-23bc7c1fe456-RaftLogWorker: Starting segment from index:0
2019-06-13 23:44:04,862 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf-RaftLogWorker: Starting segment from index:0
2019-06-13 23:44:04,900 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - a9913dac-a426-49f4-8975-23bc7c1fe456-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/a9913dac-a426-49f4-8975-23bc7c1fe456/cfa56456-d76f-417c-9ca2-996cf2610353/current/log_inprogress_0
2019-06-13 23:44:04,902 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/5543420f-b2e8-4ceb-be6e-1137a3c424cf/cfa56456-d76f-417c-9ca2-996cf2610353/current/log_inprogress_0
Jun 13, 2019 11:44:05 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=43, target=0.0.0.0:39267} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:131)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 13, 2019 11:44:05 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=51, target=0.0.0.0:35905} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:131)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 13, 2019 11:44:05 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=35, target=0.0.0.0:40401} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:131)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-13 23:44:05,720 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-188277AAB369->a9913dac-a426-49f4-8975-23bc7c1fe456: receive RaftClientReply:client-188277AAB369->a9913dac-a426-49f4-8975-23bc7c1fe456@group-996CF2610353, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server a9913dac-a426-49f4-8975-23bc7c1fe456 is not the leader (942aa5d8-f8a8-496f-a9bd-0caa1ca91201:0.0.0.0:40401). Request must be sent to leader., logIndex=0, commits[a9913dac-a426-49f4-8975-23bc7c1fe456:c0, 5543420f-b2e8-4ceb-be6e-1137a3c424cf:c0, 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:c0]
2019-06-13 23:44:05,723 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 23:44:06,733 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-13 23:44:06,739 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-188277AAB369->942aa5d8-f8a8-496f-a9bd-0caa1ca91201: receive RaftClientReply:client-188277AAB369->942aa5d8-f8a8-496f-a9bd-0caa1ca91201@group-996CF2610353, cid=6, SUCCESS, logIndex=1, commits[942aa5d8-f8a8-496f-a9bd-0caa1ca91201:c1, 5543420f-b2e8-4ceb-be6e-1137a3c424cf:c0, a9913dac-a426-49f4-8975-23bc7c1fe456:c0]
2019-06-13 23:44:06,740 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-13 23:44:06,740 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-13 23:44:06,746 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-13 23:44:06,776 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-954564FC1A39->942aa5d8-f8a8-496f-a9bd-0caa1ca91201: receive RaftClientReply:client-954564FC1A39->942aa5d8-f8a8-496f-a9bd-0caa1ca91201@group-996CF2610353, cid=7, SUCCESS, logIndex=3, commits[942aa5d8-f8a8-496f-a9bd-0caa1ca91201:c3, 5543420f-b2e8-4ceb-be6e-1137a3c424cf:c2, a9913dac-a426-49f4-8975-23bc7c1fe456:c2]
2019-06-13 23:44:06,780 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201: close
2019-06-13 23:44:06,781 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201: shutdown group-996CF2610353
2019-06-13 23:44:06,781 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-996CF2610353,id=942aa5d8-f8a8-496f-a9bd-0caa1ca91201
2019-06-13 23:44:06,781 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201: shutdown LeaderState
2019-06-13 23:44:06,782 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201-PendingRequests: sendNotLeaderResponses
2019-06-13 23:44:06,782 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(942aa5d8-f8a8-496f-a9bd-0caa1ca91201 -> a9913dac-a426-49f4-8975-23bc7c1fe456): Wait interrupted by java.lang.InterruptedException
2019-06-13 23:44:06,782 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(942aa5d8-f8a8-496f-a9bd-0caa1ca91201 -> 5543420f-b2e8-4ceb-be6e-1137a3c424cf): Wait interrupted by java.lang.InterruptedException
2019-06-13 23:44:06,783 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-942aa5d8-f8a8-496f-a9bd-0caa1ca91201-group-996CF2610353: set stopIndex = 4
2019-06-13 23:44:06,783 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-13 23:44:06,783 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/942aa5d8-f8a8-496f-a9bd-0caa1ca91201/cfa56456-d76f-417c-9ca2-996cf2610353/sm/snapshot.1_3
2019-06-13 23:44:06,784 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201:group-996CF2610353 closes. The last applied log index is 4
2019-06-13 23:44:06,784 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf: appendEntries completed
2019-06-13 23:44:06,785 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 23:44:06,786 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201-RaftLogWorker close()
2019-06-13 23:44:06,787 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201: shutdown server with port 40401 now
2019-06-13 23:44:06,788 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(266)) - GrpcLogAppender(942aa5d8-f8a8-496f-a9bd-0caa1ca91201 -> a9913dac-a426-49f4-8975-23bc7c1fe456) is stopped
2019-06-13 23:44:06,789 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 942aa5d8-f8a8-496f-a9bd-0caa1ca91201: shutdown server with port 40401 successfully
2019-06-13 23:44:06,789 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(266)) - GrpcLogAppender(942aa5d8-f8a8-496f-a9bd-0caa1ca91201 -> 5543420f-b2e8-4ceb-be6e-1137a3c424cf) is stopped
2019-06-13 23:44:06,794 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf: close
2019-06-13 23:44:06,795 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf: shutdown group-996CF2610353
2019-06-13 23:44:06,795 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-996CF2610353,id=5543420f-b2e8-4ceb-be6e-1137a3c424cf
2019-06-13 23:44:06,796 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf: shutdown FollowerState
2019-06-13 23:44:06,796 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-5543420f-b2e8-4ceb-be6e-1137a3c424cf-group-996CF2610353: set stopIndex = 3
2019-06-13 23:44:06,795 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - a9913dac-a426-49f4-8975-23bc7c1fe456: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 23:44:06,796 INFO  impl.FollowerState (FollowerState.java:run(109)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 23:44:06,796 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-13 23:44:06,797 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/5543420f-b2e8-4ceb-be6e-1137a3c424cf/cfa56456-d76f-417c-9ca2-996cf2610353/sm/snapshot.1_3
2019-06-13 23:44:06,798 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf:group-996CF2610353 closes. The last applied log index is 3
2019-06-13 23:44:06,798 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 23:44:06,799 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf-RaftLogWorker close()
2019-06-13 23:44:06,799 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf: shutdown server with port 39267 now
2019-06-13 23:44:06,799 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 5543420f-b2e8-4ceb-be6e-1137a3c424cf: shutdown server with port 39267 successfully
2019-06-13 23:44:06,802 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - a9913dac-a426-49f4-8975-23bc7c1fe456: close
2019-06-13 23:44:06,803 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - a9913dac-a426-49f4-8975-23bc7c1fe456: shutdown group-996CF2610353
2019-06-13 23:44:06,803 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-996CF2610353,id=a9913dac-a426-49f4-8975-23bc7c1fe456
2019-06-13 23:44:06,804 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a9913dac-a426-49f4-8975-23bc7c1fe456: shutdown FollowerState
2019-06-13 23:44:06,804 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-a9913dac-a426-49f4-8975-23bc7c1fe456-group-996CF2610353: set stopIndex = 3
2019-06-13 23:44:06,804 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-13 23:44:06,804 INFO  impl.FollowerState (FollowerState.java:run(109)) - a9913dac-a426-49f4-8975-23bc7c1fe456: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 23:44:06,804 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/a9913dac-a426-49f4-8975-23bc7c1fe456/cfa56456-d76f-417c-9ca2-996cf2610353/sm/snapshot.1_3
2019-06-13 23:44:06,805 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - a9913dac-a426-49f4-8975-23bc7c1fe456:group-996CF2610353 closes. The last applied log index is 3
2019-06-13 23:44:06,805 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - a9913dac-a426-49f4-8975-23bc7c1fe456-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 23:44:06,807 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - a9913dac-a426-49f4-8975-23bc7c1fe456-RaftLogWorker close()
2019-06-13 23:44:06,807 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - a9913dac-a426-49f4-8975-23bc7c1fe456: shutdown server with port 35905 now
2019-06-13 23:44:06,808 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - a9913dac-a426-49f4-8975-23bc7c1fe456: shutdown server with port 35905 successfully
