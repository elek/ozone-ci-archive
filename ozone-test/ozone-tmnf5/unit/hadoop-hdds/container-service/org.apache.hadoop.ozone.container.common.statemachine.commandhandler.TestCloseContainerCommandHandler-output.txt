2019-06-12 23:40:57,768 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler514aaa4e-fb71-4d91-933e-6c38e286a084/hdds of  storage type : DISK and capacity : 104021790720
2019-06-12 23:40:57,772 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler514aaa4e-fb71-4d91-933e-6c38e286a084/hdds to VolumeSet
2019-06-12 23:40:57,782 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-12 23:40:57,807 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-12 23:40:58,168 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 42975
2019-06-12 23:40:58,600 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-12 23:40:58,626 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-12 23:40:58,637 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42975 (custom)
2019-06-12 23:40:58,638 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-12 23:40:58,640 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-12 23:40:58,641 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-12 23:40:58,642 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-12 23:40:58,797 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler514aaa4e-fb71-4d91-933e-6c38e286a084/ratis] (custom)
2019-06-12 23:40:58,810 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 39663
2019-06-12 23:40:58,833 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-12 23:40:58,834 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-12 23:40:58,834 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 57793be6-16c6-4c1d-ae3b-82f6613280bb at port 42975
2019-06-12 23:40:58,847 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb: start RPC server
2019-06-12 23:40:58,991 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb: GrpcService started, listening on 0.0.0.0/0.0.0.0:42975
2019-06-12 23:40:59,348 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb: addNew group-3709B770049D:[57793be6-16c6-4c1d-ae3b-82f6613280bb:127.0.0.1:42975] returns group-3709B770049D:java.util.concurrent.CompletableFuture@3d7c71d2[Not completed]
2019-06-12 23:40:59,391 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb: new RaftServerImpl for group-3709B770049D:[57793be6-16c6-4c1d-ae3b-82f6613280bb:127.0.0.1:42975] with ContainerStateMachine:uninitialized
2019-06-12 23:40:59,392 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-12 23:40:59,392 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-12 23:40:59,392 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-12 23:40:59,393 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-12 23:40:59,399 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb:group-3709B770049D ConfigurationManager, init=-1: [57793be6-16c6-4c1d-ae3b-82f6613280bb:127.0.0.1:42975], old=null, confs=<EMPTY_MAP>
2019-06-12 23:40:59,399 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler514aaa4e-fb71-4d91-933e-6c38e286a084/ratis] (custom)
2019-06-12 23:40:59,406 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler514aaa4e-fb71-4d91-933e-6c38e286a084/ratis/abf2cf59-ea31-4ec8-b352-3709b770049d does not exist. Creating ...
2019-06-12 23:40:59,415 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler514aaa4e-fb71-4d91-933e-6c38e286a084/ratis/abf2cf59-ea31-4ec8-b352-3709b770049d/in_use.lock acquired by nodename 4179@ozone-tmnf5-1699643913
2019-06-12 23:40:59,424 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler514aaa4e-fb71-4d91-933e-6c38e286a084/ratis/abf2cf59-ea31-4ec8-b352-3709b770049d has been successfully formatted.
2019-06-12 23:40:59,426 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-12 23:40:59,426 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-12 23:40:59,428 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-12 23:40:59,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-12 23:40:59,433 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-12 23:40:59,438 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-12 23:40:59,440 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 57793be6-16c6-4c1d-ae3b-82f6613280bb-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler514aaa4e-fb71-4d91-933e-6c38e286a084/ratis/abf2cf59-ea31-4ec8-b352-3709b770049d
2019-06-12 23:40:59,441 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-12 23:40:59,441 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-12 23:40:59,443 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-12 23:40:59,444 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-12 23:40:59,444 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-12 23:40:59,445 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-12 23:40:59,446 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-12 23:40:59,446 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-12 23:40:59,447 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-12 23:40:59,449 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-12 23:40:59,454 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-12 23:40:59,455 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-12 23:40:59,456 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-12 23:40:59,547 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb: start group-3709B770049D
2019-06-12 23:40:59,548 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb:group-3709B770049D changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-12 23:40:59,549 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb: start FollowerState
2019-06-12 23:40:59,550 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-3709B770049D,id=57793be6-16c6-4c1d-ae3b-82f6613280bb
2019-06-12 23:41:00,728 INFO  impl.FollowerState (FollowerState.java:run(101)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb:group-3709B770049D changes to CANDIDATE, lastRpcTime:1179, electionTimeout:1179ms
2019-06-12 23:41:00,729 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb: shutdown FollowerState
2019-06-12 23:41:00,729 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb:group-3709B770049D changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-12 23:41:00,730 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb: start LeaderElection
2019-06-12 23:41:00,734 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb:group-3709B770049D:LeaderElection1: begin an election at term 1 for -1: [57793be6-16c6-4c1d-ae3b-82f6613280bb:127.0.0.1:42975], old=null
2019-06-12 23:41:00,735 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb: shutdown LeaderElection
2019-06-12 23:41:00,735 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb:group-3709B770049D changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-12 23:41:00,735 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb:group-3709B770049D change Leader from null to 57793be6-16c6-4c1d-ae3b-82f6613280bb at term 1 for becomeLeader, leader elected after 1309ms
2019-06-12 23:41:00,739 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-12 23:41:00,739 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-12 23:41:00,741 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-12 23:41:00,741 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-12 23:41:00,748 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb: start LeaderState
2019-06-12 23:41:00,760 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb-RaftLogWorker: Starting segment from index:0
2019-06-12 23:41:00,767 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb:group-3709B770049D set configuration 0: [57793be6-16c6-4c1d-ae3b-82f6613280bb:127.0.0.1:42975], old=null at 0
2019-06-12 23:41:00,889 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler514aaa4e-fb71-4d91-933e-6c38e286a084/ratis/abf2cf59-ea31-4ec8-b352-3709b770049d/current/log_inprogress_0
2019-06-12 23:41:01,775 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-12 23:41:01,830 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 3654485185882956560 is closed with bcsId 0.
2019-06-12 23:41:01,831 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-12 23:41:01,832 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb: close
2019-06-12 23:41:01,833 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb: shutdown group-3709B770049D
2019-06-12 23:41:01,834 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-3709B770049D,id=57793be6-16c6-4c1d-ae3b-82f6613280bb
2019-06-12 23:41:01,834 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb: shutdown LeaderState
2019-06-12 23:41:01,834 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb-PendingRequests: sendNotLeaderResponses
2019-06-12 23:41:01,837 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-57793be6-16c6-4c1d-ae3b-82f6613280bb-group-3709B770049D: set stopIndex = 4
2019-06-12 23:41:01,837 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-12 23:41:01,837 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler514aaa4e-fb71-4d91-933e-6c38e286a084/ratis/abf2cf59-ea31-4ec8-b352-3709b770049d/sm/snapshot.1_4
2019-06-12 23:41:01,844 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb:group-3709B770049D closes. The last applied log index is 4
2019-06-12 23:41:01,845 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-12 23:41:01,846 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb-RaftLogWorker close()
2019-06-12 23:41:01,847 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb: shutdown server with port 42975 now
2019-06-12 23:41:01,850 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 57793be6-16c6-4c1d-ae3b-82f6613280bb: shutdown server with port 42975 successfully
2019-06-12 23:41:01,858 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-12 23:41:01,880 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler34f084c0-0076-475c-b768-227f90f26a63/hdds of  storage type : DISK and capacity : 104021790720
2019-06-12 23:41:01,880 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler34f084c0-0076-475c-b768-227f90f26a63/hdds to VolumeSet
2019-06-12 23:41:01,880 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3a2b2322
2019-06-12 23:41:01,881 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3a2b2322
2019-06-12 23:41:01,895 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 35121
2019-06-12 23:41:01,896 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-12 23:41:01,897 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-12 23:41:01,897 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 35121 (custom)
2019-06-12 23:41:01,897 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-12 23:41:01,898 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-12 23:41:01,898 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-12 23:41:01,898 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-12 23:41:01,899 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler34f084c0-0076-475c-b768-227f90f26a63/ratis] (custom)
2019-06-12 23:41:01,899 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 37705
2019-06-12 23:41:01,900 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-12 23:41:01,900 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-12 23:41:01,900 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 1a2f0796-7202-4d12-bbbb-5acfee242801 at port 35121
2019-06-12 23:41:01,910 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 1a2f0796-7202-4d12-bbbb-5acfee242801: start RPC server
2019-06-12 23:41:01,912 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 1a2f0796-7202-4d12-bbbb-5acfee242801: GrpcService started, listening on 0.0.0.0/0.0.0.0:35121
2019-06-12 23:41:01,921 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 1a2f0796-7202-4d12-bbbb-5acfee242801: addNew group-0F4D8902974E:[1a2f0796-7202-4d12-bbbb-5acfee242801:127.0.0.1:35121] returns group-0F4D8902974E:java.util.concurrent.CompletableFuture@57d238d[Not completed]
2019-06-12 23:41:01,921 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 1a2f0796-7202-4d12-bbbb-5acfee242801: new RaftServerImpl for group-0F4D8902974E:[1a2f0796-7202-4d12-bbbb-5acfee242801:127.0.0.1:35121] with ContainerStateMachine:uninitialized
2019-06-12 23:41:01,922 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-12 23:41:01,922 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-12 23:41:01,922 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-12 23:41:01,922 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-12 23:41:01,922 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 1a2f0796-7202-4d12-bbbb-5acfee242801:group-0F4D8902974E ConfigurationManager, init=-1: [1a2f0796-7202-4d12-bbbb-5acfee242801:127.0.0.1:35121], old=null, confs=<EMPTY_MAP>
2019-06-12 23:41:01,922 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler34f084c0-0076-475c-b768-227f90f26a63/ratis] (custom)
2019-06-12 23:41:01,923 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler34f084c0-0076-475c-b768-227f90f26a63/ratis/8123f343-48d1-47ba-9bde-0f4d8902974e does not exist. Creating ...
2019-06-12 23:41:01,925 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler34f084c0-0076-475c-b768-227f90f26a63/ratis/8123f343-48d1-47ba-9bde-0f4d8902974e/in_use.lock acquired by nodename 4179@ozone-tmnf5-1699643913
2019-06-12 23:41:01,928 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler34f084c0-0076-475c-b768-227f90f26a63/ratis/8123f343-48d1-47ba-9bde-0f4d8902974e has been successfully formatted.
2019-06-12 23:41:01,928 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-12 23:41:01,928 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-12 23:41:01,928 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-12 23:41:01,929 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-12 23:41:01,929 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-12 23:41:01,929 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-12 23:41:01,929 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 1a2f0796-7202-4d12-bbbb-5acfee242801-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler34f084c0-0076-475c-b768-227f90f26a63/ratis/8123f343-48d1-47ba-9bde-0f4d8902974e
2019-06-12 23:41:01,929 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-12 23:41:01,929 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-12 23:41:01,929 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-12 23:41:01,930 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-12 23:41:01,930 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-12 23:41:01,930 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-12 23:41:01,930 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-12 23:41:01,930 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-12 23:41:01,930 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-12 23:41:01,931 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-12 23:41:01,931 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-12 23:41:01,931 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-12 23:41:01,931 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-12 23:41:01,932 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 1a2f0796-7202-4d12-bbbb-5acfee242801: start group-0F4D8902974E
2019-06-12 23:41:01,932 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1a2f0796-7202-4d12-bbbb-5acfee242801:group-0F4D8902974E changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-12 23:41:01,932 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1a2f0796-7202-4d12-bbbb-5acfee242801: start FollowerState
2019-06-12 23:41:01,932 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-0F4D8902974E,id=1a2f0796-7202-4d12-bbbb-5acfee242801
2019-06-12 23:41:03,063 INFO  impl.FollowerState (FollowerState.java:run(101)) - 1a2f0796-7202-4d12-bbbb-5acfee242801:group-0F4D8902974E changes to CANDIDATE, lastRpcTime:1131, electionTimeout:1131ms
2019-06-12 23:41:03,064 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 1a2f0796-7202-4d12-bbbb-5acfee242801: shutdown FollowerState
2019-06-12 23:41:03,064 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1a2f0796-7202-4d12-bbbb-5acfee242801:group-0F4D8902974E changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-12 23:41:03,064 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1a2f0796-7202-4d12-bbbb-5acfee242801: start LeaderElection
2019-06-12 23:41:03,067 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 1a2f0796-7202-4d12-bbbb-5acfee242801:group-0F4D8902974E:LeaderElection2: begin an election at term 1 for -1: [1a2f0796-7202-4d12-bbbb-5acfee242801:127.0.0.1:35121], old=null
2019-06-12 23:41:03,067 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 1a2f0796-7202-4d12-bbbb-5acfee242801: shutdown LeaderElection
2019-06-12 23:41:03,067 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1a2f0796-7202-4d12-bbbb-5acfee242801:group-0F4D8902974E changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-12 23:41:03,067 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 1a2f0796-7202-4d12-bbbb-5acfee242801:group-0F4D8902974E change Leader from null to 1a2f0796-7202-4d12-bbbb-5acfee242801 at term 1 for becomeLeader, leader elected after 1138ms
2019-06-12 23:41:03,067 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-12 23:41:03,067 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-12 23:41:03,068 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-12 23:41:03,068 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-12 23:41:03,068 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1a2f0796-7202-4d12-bbbb-5acfee242801: start LeaderState
2019-06-12 23:41:03,068 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 1a2f0796-7202-4d12-bbbb-5acfee242801-RaftLogWorker: Starting segment from index:0
2019-06-12 23:41:03,068 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 1a2f0796-7202-4d12-bbbb-5acfee242801:group-0F4D8902974E set configuration 0: [1a2f0796-7202-4d12-bbbb-5acfee242801:127.0.0.1:35121], old=null at 0
2019-06-12 23:41:03,104 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 1a2f0796-7202-4d12-bbbb-5acfee242801-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler34f084c0-0076-475c-b768-227f90f26a63/ratis/8123f343-48d1-47ba-9bde-0f4d8902974e/current/log_inprogress_0
2019-06-12 23:41:03,963 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-12 23:41:03,964 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 1a2f0796-7202-4d12-bbbb-5acfee242801: close
2019-06-12 23:41:03,964 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 1a2f0796-7202-4d12-bbbb-5acfee242801: shutdown group-0F4D8902974E
2019-06-12 23:41:03,964 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-0F4D8902974E,id=1a2f0796-7202-4d12-bbbb-5acfee242801
2019-06-12 23:41:03,965 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 1a2f0796-7202-4d12-bbbb-5acfee242801: shutdown LeaderState
2019-06-12 23:41:03,965 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 1a2f0796-7202-4d12-bbbb-5acfee242801-PendingRequests: sendNotLeaderResponses
2019-06-12 23:41:03,965 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-1a2f0796-7202-4d12-bbbb-5acfee242801-group-0F4D8902974E: set stopIndex = 2
2019-06-12 23:41:03,965 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-12 23:41:03,966 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler34f084c0-0076-475c-b768-227f90f26a63/ratis/8123f343-48d1-47ba-9bde-0f4d8902974e/sm/snapshot.1_2
2019-06-12 23:41:03,966 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 1a2f0796-7202-4d12-bbbb-5acfee242801:group-0F4D8902974E closes. The last applied log index is 2
2019-06-12 23:41:03,967 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 1a2f0796-7202-4d12-bbbb-5acfee242801-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-12 23:41:03,967 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 1a2f0796-7202-4d12-bbbb-5acfee242801-RaftLogWorker close()
2019-06-12 23:41:03,968 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 1a2f0796-7202-4d12-bbbb-5acfee242801: shutdown server with port 35121 now
2019-06-12 23:41:03,968 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 1a2f0796-7202-4d12-bbbb-5acfee242801: shutdown server with port 35121 successfully
2019-06-12 23:41:03,972 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-12 23:41:03,993 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler54dcc640-165d-4830-8bab-06833234e16b/hdds of  storage type : DISK and capacity : 104021790720
2019-06-12 23:41:03,993 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler54dcc640-165d-4830-8bab-06833234e16b/hdds to VolumeSet
2019-06-12 23:41:03,993 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@26a2f7f9
2019-06-12 23:41:03,994 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@26a2f7f9
2019-06-12 23:41:04,004 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 44377
2019-06-12 23:41:04,005 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-12 23:41:04,005 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-12 23:41:04,006 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 44377 (custom)
2019-06-12 23:41:04,006 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-12 23:41:04,006 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-12 23:41:04,006 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-12 23:41:04,007 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-12 23:41:04,007 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler54dcc640-165d-4830-8bab-06833234e16b/ratis] (custom)
2019-06-12 23:41:04,008 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 35369
2019-06-12 23:41:04,008 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-12 23:41:04,008 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-12 23:41:04,008 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 0697668e-766a-4d93-8e83-fb0ca31c49ff at port 44377
2019-06-12 23:41:04,021 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff: start RPC server
2019-06-12 23:41:04,022 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff: GrpcService started, listening on 0.0.0.0/0.0.0.0:44377
2019-06-12 23:41:04,029 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff: addNew group-09E6CDF053C7:[0697668e-766a-4d93-8e83-fb0ca31c49ff:127.0.0.1:44377] returns group-09E6CDF053C7:java.util.concurrent.CompletableFuture@ee41ae8[Not completed]
2019-06-12 23:41:04,030 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff: new RaftServerImpl for group-09E6CDF053C7:[0697668e-766a-4d93-8e83-fb0ca31c49ff:127.0.0.1:44377] with ContainerStateMachine:uninitialized
2019-06-12 23:41:04,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-12 23:41:04,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-12 23:41:04,031 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-12 23:41:04,031 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-12 23:41:04,031 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff:group-09E6CDF053C7 ConfigurationManager, init=-1: [0697668e-766a-4d93-8e83-fb0ca31c49ff:127.0.0.1:44377], old=null, confs=<EMPTY_MAP>
2019-06-12 23:41:04,031 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler54dcc640-165d-4830-8bab-06833234e16b/ratis] (custom)
2019-06-12 23:41:04,031 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler54dcc640-165d-4830-8bab-06833234e16b/ratis/8e0d2e6e-49c5-4b3b-a0b6-09e6cdf053c7 does not exist. Creating ...
2019-06-12 23:41:04,034 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler54dcc640-165d-4830-8bab-06833234e16b/ratis/8e0d2e6e-49c5-4b3b-a0b6-09e6cdf053c7/in_use.lock acquired by nodename 4179@ozone-tmnf5-1699643913
2019-06-12 23:41:04,036 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler54dcc640-165d-4830-8bab-06833234e16b/ratis/8e0d2e6e-49c5-4b3b-a0b6-09e6cdf053c7 has been successfully formatted.
2019-06-12 23:41:04,036 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-12 23:41:04,036 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-12 23:41:04,037 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-12 23:41:04,037 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-12 23:41:04,037 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-12 23:41:04,037 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-12 23:41:04,037 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 0697668e-766a-4d93-8e83-fb0ca31c49ff-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler54dcc640-165d-4830-8bab-06833234e16b/ratis/8e0d2e6e-49c5-4b3b-a0b6-09e6cdf053c7
2019-06-12 23:41:04,037 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-12 23:41:04,037 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-12 23:41:04,037 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-12 23:41:04,037 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-12 23:41:04,037 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-12 23:41:04,038 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-12 23:41:04,038 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-12 23:41:04,038 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-12 23:41:04,038 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-12 23:41:04,038 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-12 23:41:04,039 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-12 23:41:04,039 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-12 23:41:04,039 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-12 23:41:04,039 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff: start group-09E6CDF053C7
2019-06-12 23:41:04,039 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff:group-09E6CDF053C7 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-12 23:41:04,039 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff: start FollowerState
2019-06-12 23:41:04,040 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-09E6CDF053C7,id=0697668e-766a-4d93-8e83-fb0ca31c49ff
2019-06-12 23:41:05,193 INFO  impl.FollowerState (FollowerState.java:run(101)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff:group-09E6CDF053C7 changes to CANDIDATE, lastRpcTime:1153, electionTimeout:1153ms
2019-06-12 23:41:05,193 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff: shutdown FollowerState
2019-06-12 23:41:05,193 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff:group-09E6CDF053C7 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-12 23:41:05,193 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff: start LeaderElection
2019-06-12 23:41:05,196 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff:group-09E6CDF053C7:LeaderElection3: begin an election at term 1 for -1: [0697668e-766a-4d93-8e83-fb0ca31c49ff:127.0.0.1:44377], old=null
2019-06-12 23:41:05,196 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff: shutdown LeaderElection
2019-06-12 23:41:05,197 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff:group-09E6CDF053C7 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-12 23:41:05,197 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff:group-09E6CDF053C7 change Leader from null to 0697668e-766a-4d93-8e83-fb0ca31c49ff at term 1 for becomeLeader, leader elected after 1160ms
2019-06-12 23:41:05,197 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-12 23:41:05,197 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-12 23:41:05,197 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-12 23:41:05,197 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-12 23:41:05,198 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff: start LeaderState
2019-06-12 23:41:05,198 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff-RaftLogWorker: Starting segment from index:0
2019-06-12 23:41:05,199 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff:group-09E6CDF053C7 set configuration 0: [0697668e-766a-4d93-8e83-fb0ca31c49ff:127.0.0.1:44377], old=null at 0
2019-06-12 23:41:05,234 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler54dcc640-165d-4830-8bab-06833234e16b/ratis/8e0d2e6e-49c5-4b3b-a0b6-09e6cdf053c7/current/log_inprogress_0
2019-06-12 23:41:06,080 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 8744920309143722673 is closed with bcsId 0.
2019-06-12 23:41:06,081 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-12 23:41:06,081 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff: close
2019-06-12 23:41:06,081 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff: shutdown group-09E6CDF053C7
2019-06-12 23:41:06,082 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-09E6CDF053C7,id=0697668e-766a-4d93-8e83-fb0ca31c49ff
2019-06-12 23:41:06,082 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff: shutdown LeaderState
2019-06-12 23:41:06,082 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff-PendingRequests: sendNotLeaderResponses
2019-06-12 23:41:06,083 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-0697668e-766a-4d93-8e83-fb0ca31c49ff-group-09E6CDF053C7: set stopIndex = 2
2019-06-12 23:41:06,083 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-12 23:41:06,083 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler54dcc640-165d-4830-8bab-06833234e16b/ratis/8e0d2e6e-49c5-4b3b-a0b6-09e6cdf053c7/sm/snapshot.1_2
2019-06-12 23:41:06,084 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff:group-09E6CDF053C7 closes. The last applied log index is 2
2019-06-12 23:41:06,084 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-12 23:41:06,085 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff-RaftLogWorker close()
2019-06-12 23:41:06,086 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff: shutdown server with port 44377 now
2019-06-12 23:41:06,087 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 0697668e-766a-4d93-8e83-fb0ca31c49ff: shutdown server with port 44377 successfully
2019-06-12 23:41:06,113 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-12 23:41:06,136 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6046ca51-2a7d-4a35-9f9b-44038ef8d438/hdds of  storage type : DISK and capacity : 104021790720
2019-06-12 23:41:06,136 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6046ca51-2a7d-4a35-9f9b-44038ef8d438/hdds to VolumeSet
2019-06-12 23:41:06,137 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@66153688
2019-06-12 23:41:06,137 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@66153688
2019-06-12 23:41:06,147 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 35415
2019-06-12 23:41:06,147 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-12 23:41:06,148 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-12 23:41:06,148 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 35415 (custom)
2019-06-12 23:41:06,149 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-12 23:41:06,149 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-12 23:41:06,149 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-12 23:41:06,149 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-12 23:41:06,150 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6046ca51-2a7d-4a35-9f9b-44038ef8d438/ratis] (custom)
2019-06-12 23:41:06,150 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 44725
2019-06-12 23:41:06,151 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-12 23:41:06,151 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-12 23:41:06,151 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 707805c0-9d07-4b4f-aee6-a0c56634ac1b at port 35415
2019-06-12 23:41:06,166 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b: start RPC server
2019-06-12 23:41:06,167 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b: GrpcService started, listening on 0.0.0.0/0.0.0.0:35415
Jun 12, 2019 11:41:06 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:35121} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 12, 2019 11:41:06 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:44377} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-12 23:41:06,183 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b: addNew group-BDA36420762B:[707805c0-9d07-4b4f-aee6-a0c56634ac1b:127.0.0.1:35415] returns group-BDA36420762B:java.util.concurrent.CompletableFuture@6355a2c7[Not completed]
2019-06-12 23:41:06,183 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b: new RaftServerImpl for group-BDA36420762B:[707805c0-9d07-4b4f-aee6-a0c56634ac1b:127.0.0.1:35415] with ContainerStateMachine:uninitialized
2019-06-12 23:41:06,184 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-12 23:41:06,184 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-12 23:41:06,184 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-12 23:41:06,184 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-12 23:41:06,184 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b:group-BDA36420762B ConfigurationManager, init=-1: [707805c0-9d07-4b4f-aee6-a0c56634ac1b:127.0.0.1:35415], old=null, confs=<EMPTY_MAP>
2019-06-12 23:41:06,184 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6046ca51-2a7d-4a35-9f9b-44038ef8d438/ratis] (custom)
2019-06-12 23:41:06,185 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6046ca51-2a7d-4a35-9f9b-44038ef8d438/ratis/2c9a160a-0116-452d-b7cd-bda36420762b does not exist. Creating ...
2019-06-12 23:41:06,188 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6046ca51-2a7d-4a35-9f9b-44038ef8d438/ratis/2c9a160a-0116-452d-b7cd-bda36420762b/in_use.lock acquired by nodename 4179@ozone-tmnf5-1699643913
2019-06-12 23:41:06,190 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6046ca51-2a7d-4a35-9f9b-44038ef8d438/ratis/2c9a160a-0116-452d-b7cd-bda36420762b has been successfully formatted.
2019-06-12 23:41:06,190 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-12 23:41:06,190 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-12 23:41:06,190 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-12 23:41:06,190 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-12 23:41:06,190 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-12 23:41:06,190 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-12 23:41:06,191 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 707805c0-9d07-4b4f-aee6-a0c56634ac1b-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6046ca51-2a7d-4a35-9f9b-44038ef8d438/ratis/2c9a160a-0116-452d-b7cd-bda36420762b
2019-06-12 23:41:06,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-12 23:41:06,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-12 23:41:06,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-12 23:41:06,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-12 23:41:06,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-12 23:41:06,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-12 23:41:06,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-12 23:41:06,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-12 23:41:06,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-12 23:41:06,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-12 23:41:06,192 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-12 23:41:06,192 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-12 23:41:06,192 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-12 23:41:06,192 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b: start group-BDA36420762B
2019-06-12 23:41:06,193 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b:group-BDA36420762B changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-12 23:41:06,193 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b: start FollowerState
2019-06-12 23:41:06,194 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-BDA36420762B,id=707805c0-9d07-4b4f-aee6-a0c56634ac1b
2019-06-12 23:41:07,321 INFO  impl.FollowerState (FollowerState.java:run(101)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b:group-BDA36420762B changes to CANDIDATE, lastRpcTime:1128, electionTimeout:1128ms
2019-06-12 23:41:07,321 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b: shutdown FollowerState
2019-06-12 23:41:07,321 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b:group-BDA36420762B changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-12 23:41:07,321 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b: start LeaderElection
2019-06-12 23:41:07,324 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b:group-BDA36420762B:LeaderElection4: begin an election at term 1 for -1: [707805c0-9d07-4b4f-aee6-a0c56634ac1b:127.0.0.1:35415], old=null
2019-06-12 23:41:07,324 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b: shutdown LeaderElection
2019-06-12 23:41:07,325 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b:group-BDA36420762B changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-12 23:41:07,325 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b:group-BDA36420762B change Leader from null to 707805c0-9d07-4b4f-aee6-a0c56634ac1b at term 1 for becomeLeader, leader elected after 1134ms
2019-06-12 23:41:07,325 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-12 23:41:07,325 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-12 23:41:07,325 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-12 23:41:07,325 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-12 23:41:07,326 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b: start LeaderState
2019-06-12 23:41:07,326 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b-RaftLogWorker: Starting segment from index:0
2019-06-12 23:41:07,326 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b:group-BDA36420762B set configuration 0: [707805c0-9d07-4b4f-aee6-a0c56634ac1b:127.0.0.1:35415], old=null at 0
2019-06-12 23:41:07,362 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6046ca51-2a7d-4a35-9f9b-44038ef8d438/ratis/2c9a160a-0116-452d-b7cd-bda36420762b/current/log_inprogress_0
2019-06-12 23:41:08,232 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 7268850816986270465 is closed with bcsId 0.
2019-06-12 23:41:08,232 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-12 23:41:08,233 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b: close
2019-06-12 23:41:08,233 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b: shutdown group-BDA36420762B
2019-06-12 23:41:08,233 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-BDA36420762B,id=707805c0-9d07-4b4f-aee6-a0c56634ac1b
2019-06-12 23:41:08,233 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b: shutdown LeaderState
2019-06-12 23:41:08,234 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b-PendingRequests: sendNotLeaderResponses
2019-06-12 23:41:08,234 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-707805c0-9d07-4b4f-aee6-a0c56634ac1b-group-BDA36420762B: set stopIndex = 2
2019-06-12 23:41:08,234 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-12 23:41:08,235 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6046ca51-2a7d-4a35-9f9b-44038ef8d438/ratis/2c9a160a-0116-452d-b7cd-bda36420762b/sm/snapshot.1_2
2019-06-12 23:41:08,235 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b:group-BDA36420762B closes. The last applied log index is 2
2019-06-12 23:41:08,235 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-12 23:41:08,236 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b-RaftLogWorker close()
2019-06-12 23:41:08,236 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b: shutdown server with port 35415 now
2019-06-12 23:41:08,238 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 707805c0-9d07-4b4f-aee6-a0c56634ac1b: shutdown server with port 35415 successfully
2019-06-12 23:41:08,240 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-12 23:41:08,260 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfb7b1606-650b-4b2a-82d4-5ea1d961d6a2/hdds of  storage type : DISK and capacity : 104021790720
2019-06-12 23:41:08,260 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfb7b1606-650b-4b2a-82d4-5ea1d961d6a2/hdds to VolumeSet
2019-06-12 23:41:08,260 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@68217d41
2019-06-12 23:41:08,260 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@68217d41
2019-06-12 23:41:08,268 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 45939
2019-06-12 23:41:08,269 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-12 23:41:08,270 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-12 23:41:08,270 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 45939 (custom)
2019-06-12 23:41:08,270 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-12 23:41:08,270 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-12 23:41:08,270 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-12 23:41:08,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-12 23:41:08,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfb7b1606-650b-4b2a-82d4-5ea1d961d6a2/ratis] (custom)
2019-06-12 23:41:08,271 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 33421
2019-06-12 23:41:08,272 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-12 23:41:08,272 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-12 23:41:08,272 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 395693b8-bafd-46ed-9962-a0cd39f00fda at port 45939
2019-06-12 23:41:08,296 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 395693b8-bafd-46ed-9962-a0cd39f00fda: start RPC server
2019-06-12 23:41:08,297 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 395693b8-bafd-46ed-9962-a0cd39f00fda: GrpcService started, listening on 0.0.0.0/0.0.0.0:45939
2019-06-12 23:41:08,305 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 395693b8-bafd-46ed-9962-a0cd39f00fda: addNew group-56D2A2ECCA39:[395693b8-bafd-46ed-9962-a0cd39f00fda:127.0.0.1:45939] returns group-56D2A2ECCA39:java.util.concurrent.CompletableFuture@54081b51[Not completed]
2019-06-12 23:41:08,305 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 395693b8-bafd-46ed-9962-a0cd39f00fda: new RaftServerImpl for group-56D2A2ECCA39:[395693b8-bafd-46ed-9962-a0cd39f00fda:127.0.0.1:45939] with ContainerStateMachine:uninitialized
2019-06-12 23:41:08,306 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-12 23:41:08,306 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-12 23:41:08,306 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-12 23:41:08,306 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-12 23:41:08,306 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 395693b8-bafd-46ed-9962-a0cd39f00fda:group-56D2A2ECCA39 ConfigurationManager, init=-1: [395693b8-bafd-46ed-9962-a0cd39f00fda:127.0.0.1:45939], old=null, confs=<EMPTY_MAP>
2019-06-12 23:41:08,306 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfb7b1606-650b-4b2a-82d4-5ea1d961d6a2/ratis] (custom)
2019-06-12 23:41:08,307 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfb7b1606-650b-4b2a-82d4-5ea1d961d6a2/ratis/2e0125a2-6fca-4a52-95c4-56d2a2ecca39 does not exist. Creating ...
2019-06-12 23:41:08,309 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfb7b1606-650b-4b2a-82d4-5ea1d961d6a2/ratis/2e0125a2-6fca-4a52-95c4-56d2a2ecca39/in_use.lock acquired by nodename 4179@ozone-tmnf5-1699643913
2019-06-12 23:41:08,311 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfb7b1606-650b-4b2a-82d4-5ea1d961d6a2/ratis/2e0125a2-6fca-4a52-95c4-56d2a2ecca39 has been successfully formatted.
2019-06-12 23:41:08,312 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-12 23:41:08,312 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-12 23:41:08,312 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-12 23:41:08,312 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-12 23:41:08,312 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-12 23:41:08,312 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-12 23:41:08,312 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 395693b8-bafd-46ed-9962-a0cd39f00fda-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfb7b1606-650b-4b2a-82d4-5ea1d961d6a2/ratis/2e0125a2-6fca-4a52-95c4-56d2a2ecca39
2019-06-12 23:41:08,312 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-12 23:41:08,312 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-12 23:41:08,312 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-12 23:41:08,313 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-12 23:41:08,313 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-12 23:41:08,313 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-12 23:41:08,313 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-12 23:41:08,313 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-12 23:41:08,313 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-12 23:41:08,313 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-12 23:41:08,313 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-12 23:41:08,313 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-12 23:41:08,314 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-12 23:41:08,314 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 395693b8-bafd-46ed-9962-a0cd39f00fda: start group-56D2A2ECCA39
2019-06-12 23:41:08,314 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 395693b8-bafd-46ed-9962-a0cd39f00fda:group-56D2A2ECCA39 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-12 23:41:08,314 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 395693b8-bafd-46ed-9962-a0cd39f00fda: start FollowerState
2019-06-12 23:41:08,314 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-56D2A2ECCA39,id=395693b8-bafd-46ed-9962-a0cd39f00fda
2019-06-12 23:41:09,388 INFO  impl.FollowerState (FollowerState.java:run(101)) - 395693b8-bafd-46ed-9962-a0cd39f00fda:group-56D2A2ECCA39 changes to CANDIDATE, lastRpcTime:1073, electionTimeout:1073ms
2019-06-12 23:41:09,388 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 395693b8-bafd-46ed-9962-a0cd39f00fda: shutdown FollowerState
2019-06-12 23:41:09,388 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 395693b8-bafd-46ed-9962-a0cd39f00fda:group-56D2A2ECCA39 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-12 23:41:09,388 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 395693b8-bafd-46ed-9962-a0cd39f00fda: start LeaderElection
2019-06-12 23:41:09,391 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 395693b8-bafd-46ed-9962-a0cd39f00fda:group-56D2A2ECCA39:LeaderElection5: begin an election at term 1 for -1: [395693b8-bafd-46ed-9962-a0cd39f00fda:127.0.0.1:45939], old=null
2019-06-12 23:41:09,391 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 395693b8-bafd-46ed-9962-a0cd39f00fda: shutdown LeaderElection
2019-06-12 23:41:09,391 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 395693b8-bafd-46ed-9962-a0cd39f00fda:group-56D2A2ECCA39 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-12 23:41:09,391 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 395693b8-bafd-46ed-9962-a0cd39f00fda:group-56D2A2ECCA39 change Leader from null to 395693b8-bafd-46ed-9962-a0cd39f00fda at term 1 for becomeLeader, leader elected after 1079ms
2019-06-12 23:41:09,391 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-12 23:41:09,392 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-12 23:41:09,392 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-12 23:41:09,392 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-12 23:41:09,392 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 395693b8-bafd-46ed-9962-a0cd39f00fda: start LeaderState
2019-06-12 23:41:09,392 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 395693b8-bafd-46ed-9962-a0cd39f00fda-RaftLogWorker: Starting segment from index:0
2019-06-12 23:41:09,392 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 395693b8-bafd-46ed-9962-a0cd39f00fda:group-56D2A2ECCA39 set configuration 0: [395693b8-bafd-46ed-9962-a0cd39f00fda:127.0.0.1:45939], old=null at 0
2019-06-12 23:41:09,428 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 395693b8-bafd-46ed-9962-a0cd39f00fda-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfb7b1606-650b-4b2a-82d4-5ea1d961d6a2/ratis/2e0125a2-6fca-4a52-95c4-56d2a2ecca39/current/log_inprogress_0
2019-06-12 23:41:10,354 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 3671187454774531682 is closed with bcsId 0.
2019-06-12 23:41:10,355 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-12 23:41:10,355 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 395693b8-bafd-46ed-9962-a0cd39f00fda: close
2019-06-12 23:41:10,355 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 395693b8-bafd-46ed-9962-a0cd39f00fda: shutdown group-56D2A2ECCA39
2019-06-12 23:41:10,355 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-56D2A2ECCA39,id=395693b8-bafd-46ed-9962-a0cd39f00fda
2019-06-12 23:41:10,355 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 395693b8-bafd-46ed-9962-a0cd39f00fda: shutdown LeaderState
2019-06-12 23:41:10,356 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 395693b8-bafd-46ed-9962-a0cd39f00fda-PendingRequests: sendNotLeaderResponses
2019-06-12 23:41:10,357 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-395693b8-bafd-46ed-9962-a0cd39f00fda-group-56D2A2ECCA39: set stopIndex = 4
2019-06-12 23:41:10,357 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-12 23:41:10,358 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfb7b1606-650b-4b2a-82d4-5ea1d961d6a2/ratis/2e0125a2-6fca-4a52-95c4-56d2a2ecca39/sm/snapshot.1_4
2019-06-12 23:41:10,358 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 395693b8-bafd-46ed-9962-a0cd39f00fda:group-56D2A2ECCA39 closes. The last applied log index is 4
2019-06-12 23:41:10,358 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 395693b8-bafd-46ed-9962-a0cd39f00fda-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-12 23:41:10,359 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 395693b8-bafd-46ed-9962-a0cd39f00fda-RaftLogWorker close()
2019-06-12 23:41:10,359 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 395693b8-bafd-46ed-9962-a0cd39f00fda: shutdown server with port 45939 now
2019-06-12 23:41:10,360 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 395693b8-bafd-46ed-9962-a0cd39f00fda: shutdown server with port 45939 successfully
2019-06-12 23:41:10,365 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
