2019-06-13 11:03:16,594 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-13 11:03:16,675 INFO  ozone.RatisTestHelper (RatisTestHelper.java:initRatisConf(109)) - dfs.container.ratis.rpc.type = GRPC
2019-06-13 11:03:16,728 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 11:03:16,736 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 36497 (custom)
2019-06-13 11:03:16,737 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 11:03:16,739 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 11:03:16,740 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 11:03:16,740 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 11:03:16,783 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/2380feb7-ff48-4586-8473-adabb518f419] (custom)
2019-06-13 11:03:16,787 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 2380feb7-ff48-4586-8473-adabb518f419 at port 36497
2019-06-13 11:03:16,800 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 2380feb7-ff48-4586-8473-adabb518f419: start RPC server
2019-06-13 11:03:16,802 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 2380feb7-ff48-4586-8473-adabb518f419: GrpcService started, listening on 0.0.0.0/0.0.0.0:36497
2019-06-13 11:03:16,883 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 2380feb7-ff48-4586-8473-adabb518f419: addNew group-7424F115F4B1:[2380feb7-ff48-4586-8473-adabb518f419:0.0.0.0:36497] returns group-7424F115F4B1:java.util.concurrent.CompletableFuture@313e6dec[Not completed]
2019-06-13 11:03:16,890 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 2380feb7-ff48-4586-8473-adabb518f419: new RaftServerImpl for group-7424F115F4B1:[2380feb7-ff48-4586-8473-adabb518f419:0.0.0.0:36497] with ContainerStateMachine:uninitialized
2019-06-13 11:03:16,891 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 11:03:16,891 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 11:03:16,892 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 11:03:16,893 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 11:03:16,899 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 2380feb7-ff48-4586-8473-adabb518f419:group-7424F115F4B1 ConfigurationManager, init=-1: [2380feb7-ff48-4586-8473-adabb518f419:0.0.0.0:36497], old=null, confs=<EMPTY_MAP>
2019-06-13 11:03:16,899 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/2380feb7-ff48-4586-8473-adabb518f419] (custom)
2019-06-13 11:03:16,905 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/2380feb7-ff48-4586-8473-adabb518f419/8447f05a-3ba6-423a-8071-7424f115f4b1 does not exist. Creating ...
2019-06-13 11:03:16,915 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/2380feb7-ff48-4586-8473-adabb518f419/8447f05a-3ba6-423a-8071-7424f115f4b1/in_use.lock acquired by nodename 30348@ozone-5n8bq-3406807641
2019-06-13 11:03:16,923 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/2380feb7-ff48-4586-8473-adabb518f419/8447f05a-3ba6-423a-8071-7424f115f4b1 has been successfully formatted.
2019-06-13 11:03:16,925 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 11:03:16,925 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 11:03:16,926 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 11:03:16,928 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 11:03:16,930 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 11:03:16,933 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 11:03:16,935 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 2380feb7-ff48-4586-8473-adabb518f419-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/2380feb7-ff48-4586-8473-adabb518f419/8447f05a-3ba6-423a-8071-7424f115f4b1
2019-06-13 11:03:16,935 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 11:03:16,936 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 11:03:16,937 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 11:03:16,937 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 11:03:16,938 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 11:03:16,938 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 11:03:16,939 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 11:03:16,939 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 11:03:16,940 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 11:03:16,941 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 11:03:16,947 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 11:03:16,947 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 11:03:16,948 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 11:03:16,960 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 2380feb7-ff48-4586-8473-adabb518f419: start group-7424F115F4B1
2019-06-13 11:03:16,960 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2380feb7-ff48-4586-8473-adabb518f419:group-7424F115F4B1 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 11:03:16,961 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2380feb7-ff48-4586-8473-adabb518f419: start FollowerState
2019-06-13 11:03:17,004 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-7424F115F4B1,id=2380feb7-ff48-4586-8473-adabb518f419
2019-06-13 11:03:17,050 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-931C95869EF5->2380feb7-ff48-4586-8473-adabb518f419: receive RaftClientReply:client-931C95869EF5->2380feb7-ff48-4586-8473-adabb518f419@group-7424F115F4B1, cid=1, FAILED org.apache.ratis.protocol.NotLeaderException: Server 2380feb7-ff48-4586-8473-adabb518f419 is not the leader (null). Request must be sent to leader., logIndex=0, commits[2380feb7-ff48-4586-8473-adabb518f419:c-1]
2019-06-13 11:03:18,058 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-931C95869EF5->2380feb7-ff48-4586-8473-adabb518f419: receive RaftClientReply:client-931C95869EF5->2380feb7-ff48-4586-8473-adabb518f419@group-7424F115F4B1, cid=1, FAILED org.apache.ratis.protocol.NotLeaderException: Server 2380feb7-ff48-4586-8473-adabb518f419 is not the leader (null). Request must be sent to leader., logIndex=0, commits[2380feb7-ff48-4586-8473-adabb518f419:c-1]
2019-06-13 11:03:18,156 INFO  impl.FollowerState (FollowerState.java:run(101)) - 2380feb7-ff48-4586-8473-adabb518f419:group-7424F115F4B1 changes to CANDIDATE, lastRpcTime:1194, electionTimeout:1194ms
2019-06-13 11:03:18,156 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 2380feb7-ff48-4586-8473-adabb518f419: shutdown FollowerState
2019-06-13 11:03:18,156 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2380feb7-ff48-4586-8473-adabb518f419:group-7424F115F4B1 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 11:03:18,157 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2380feb7-ff48-4586-8473-adabb518f419: start LeaderElection
2019-06-13 11:03:18,160 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 2380feb7-ff48-4586-8473-adabb518f419:group-7424F115F4B1:LeaderElection1: begin an election at term 1 for -1: [2380feb7-ff48-4586-8473-adabb518f419:0.0.0.0:36497], old=null
2019-06-13 11:03:18,161 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 2380feb7-ff48-4586-8473-adabb518f419: shutdown LeaderElection
2019-06-13 11:03:18,162 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2380feb7-ff48-4586-8473-adabb518f419:group-7424F115F4B1 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 11:03:18,162 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 2380feb7-ff48-4586-8473-adabb518f419:group-7424F115F4B1 change Leader from null to 2380feb7-ff48-4586-8473-adabb518f419 at term 1 for becomeLeader, leader elected after 1236ms
2019-06-13 11:03:18,165 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 11:03:18,165 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 11:03:18,167 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 11:03:18,167 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 11:03:18,175 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2380feb7-ff48-4586-8473-adabb518f419: start LeaderState
2019-06-13 11:03:18,189 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 2380feb7-ff48-4586-8473-adabb518f419-RaftLogWorker: Starting segment from index:0
2019-06-13 11:03:18,196 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 2380feb7-ff48-4586-8473-adabb518f419:group-7424F115F4B1 set configuration 0: [2380feb7-ff48-4586-8473-adabb518f419:0.0.0.0:36497], old=null at 0
2019-06-13 11:03:18,316 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 2380feb7-ff48-4586-8473-adabb518f419-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/2380feb7-ff48-4586-8473-adabb518f419/8447f05a-3ba6-423a-8071-7424f115f4b1/current/log_inprogress_0
2019-06-13 11:03:19,072 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-13 11:03:19,076 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-931C95869EF5->2380feb7-ff48-4586-8473-adabb518f419: receive RaftClientReply:client-931C95869EF5->2380feb7-ff48-4586-8473-adabb518f419@group-7424F115F4B1, cid=1, SUCCESS, logIndex=1, commits[2380feb7-ff48-4586-8473-adabb518f419:c2]
2019-06-13 11:03:19,078 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-13 11:03:19,091 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-6095194DA452->2380feb7-ff48-4586-8473-adabb518f419: receive RaftClientReply:client-6095194DA452->2380feb7-ff48-4586-8473-adabb518f419@group-7424F115F4B1, cid=2, SUCCESS, logIndex=3, commits[2380feb7-ff48-4586-8473-adabb518f419:c3]
2019-06-13 11:03:19,094 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 2380feb7-ff48-4586-8473-adabb518f419: close
2019-06-13 11:03:19,095 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 2380feb7-ff48-4586-8473-adabb518f419: shutdown group-7424F115F4B1
2019-06-13 11:03:19,096 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-7424F115F4B1,id=2380feb7-ff48-4586-8473-adabb518f419
2019-06-13 11:03:19,096 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 2380feb7-ff48-4586-8473-adabb518f419: shutdown LeaderState
2019-06-13 11:03:19,097 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 2380feb7-ff48-4586-8473-adabb518f419-PendingRequests: sendNotLeaderResponses
2019-06-13 11:03:19,098 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 11:03:19,098 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 11:03:19,099 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-13 11:03:19,099 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-2380feb7-ff48-4586-8473-adabb518f419-group-7424F115F4B1: set stopIndex = 4
2019-06-13 11:03:19,099 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/2380feb7-ff48-4586-8473-adabb518f419/8447f05a-3ba6-423a-8071-7424f115f4b1/sm/snapshot.1_3
2019-06-13 11:03:19,106 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 2380feb7-ff48-4586-8473-adabb518f419:group-7424F115F4B1 closes. The last applied log index is 4
2019-06-13 11:03:19,106 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 2380feb7-ff48-4586-8473-adabb518f419-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 11:03:19,107 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 2380feb7-ff48-4586-8473-adabb518f419-RaftLogWorker close()
2019-06-13 11:03:19,107 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 2380feb7-ff48-4586-8473-adabb518f419: shutdown server with port 36497 now
2019-06-13 11:03:19,109 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 2380feb7-ff48-4586-8473-adabb518f419: shutdown server with port 36497 successfully
2019-06-13 11:03:19,111 INFO  ozone.RatisTestHelper (RatisTestHelper.java:initRatisConf(109)) - dfs.container.ratis.rpc.type = GRPC
2019-06-13 11:03:19,113 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 11:03:19,113 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 39593 (custom)
2019-06-13 11:03:19,113 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 11:03:19,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 11:03:19,114 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 11:03:19,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 11:03:19,115 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5] (custom)
2019-06-13 11:03:19,131 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5 at port 39593
2019-06-13 11:03:19,143 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5: start RPC server
2019-06-13 11:03:19,145 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5: GrpcService started, listening on 0.0.0.0/0.0.0.0:39593
Jun 13, 2019 11:03:19 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=17, target=0.0.0.0:36497} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:130)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 13, 2019 11:03:19 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=9, target=0.0.0.0:35287} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connectToDatanode(XceiverClientGrpc.java:163)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connect(XceiverClientGrpc.java:120)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:227)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServer(TestSecureContainerServer.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-13 11:03:19,167 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5: addNew group-73D9A1724FF4:[dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:0.0.0.0:39593, a986c32d-0a5b-4e54-814a-bfc3a08544f1:0.0.0.0:37429, 2f7e0b02-46b6-436f-820b-0a557ecacba8:0.0.0.0:40949] returns group-73D9A1724FF4:java.util.concurrent.CompletableFuture@4a1ef1f4[Not completed]
2019-06-13 11:03:19,170 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5: new RaftServerImpl for group-73D9A1724FF4:[dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:0.0.0.0:39593, a986c32d-0a5b-4e54-814a-bfc3a08544f1:0.0.0.0:37429, 2f7e0b02-46b6-436f-820b-0a557ecacba8:0.0.0.0:40949] with ContainerStateMachine:uninitialized
2019-06-13 11:03:19,170 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 11:03:19,170 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 11:03:19,171 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 11:03:19,171 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 11:03:19,171 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:group-73D9A1724FF4 ConfigurationManager, init=-1: [dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:0.0.0.0:39593, a986c32d-0a5b-4e54-814a-bfc3a08544f1:0.0.0.0:37429, 2f7e0b02-46b6-436f-820b-0a557ecacba8:0.0.0.0:40949], old=null, confs=<EMPTY_MAP>
2019-06-13 11:03:19,171 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5] (custom)
2019-06-13 11:03:19,171 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5/f1a83840-8886-4b3a-833c-73d9a1724ff4 does not exist. Creating ...
2019-06-13 11:03:19,174 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5/f1a83840-8886-4b3a-833c-73d9a1724ff4/in_use.lock acquired by nodename 30348@ozone-5n8bq-3406807641
2019-06-13 11:03:19,176 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5/f1a83840-8886-4b3a-833c-73d9a1724ff4 has been successfully formatted.
2019-06-13 11:03:19,176 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 11:03:19,176 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 11:03:19,176 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 11:03:19,177 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 11:03:19,177 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 11:03:19,177 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 11:03:19,177 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5/f1a83840-8886-4b3a-833c-73d9a1724ff4
2019-06-13 11:03:19,177 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 11:03:19,177 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 11:03:19,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 11:03:19,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 11:03:19,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 11:03:19,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 11:03:19,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 11:03:19,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 11:03:19,179 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 11:03:19,179 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 11:03:19,181 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 11:03:19,182 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 11:03:19,182 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 11:03:19,182 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5: start group-73D9A1724FF4
2019-06-13 11:03:19,182 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:group-73D9A1724FF4 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 11:03:19,182 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5: start FollowerState
2019-06-13 11:03:19,183 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-73D9A1724FF4,id=dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5
2019-06-13 11:03:19,188 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 11:03:19,189 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 40949 (custom)
2019-06-13 11:03:19,189 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 11:03:19,189 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 11:03:19,189 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 11:03:19,189 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 11:03:19,190 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/2f7e0b02-46b6-436f-820b-0a557ecacba8] (custom)
2019-06-13 11:03:19,190 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 2f7e0b02-46b6-436f-820b-0a557ecacba8 at port 40949
2019-06-13 11:03:19,195 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8: start RPC server
2019-06-13 11:03:19,196 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8: GrpcService started, listening on 0.0.0.0/0.0.0.0:40949
2019-06-13 11:03:19,219 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8: addNew group-73D9A1724FF4:[dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:0.0.0.0:39593, a986c32d-0a5b-4e54-814a-bfc3a08544f1:0.0.0.0:37429, 2f7e0b02-46b6-436f-820b-0a557ecacba8:0.0.0.0:40949] returns group-73D9A1724FF4:java.util.concurrent.CompletableFuture@1faadc62[Not completed]
2019-06-13 11:03:19,220 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8: new RaftServerImpl for group-73D9A1724FF4:[dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:0.0.0.0:39593, a986c32d-0a5b-4e54-814a-bfc3a08544f1:0.0.0.0:37429, 2f7e0b02-46b6-436f-820b-0a557ecacba8:0.0.0.0:40949] with ContainerStateMachine:uninitialized
2019-06-13 11:03:19,220 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 11:03:19,220 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 11:03:19,221 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 11:03:19,221 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 11:03:19,221 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8:group-73D9A1724FF4 ConfigurationManager, init=-1: [dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:0.0.0.0:39593, a986c32d-0a5b-4e54-814a-bfc3a08544f1:0.0.0.0:37429, 2f7e0b02-46b6-436f-820b-0a557ecacba8:0.0.0.0:40949], old=null, confs=<EMPTY_MAP>
2019-06-13 11:03:19,221 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/2f7e0b02-46b6-436f-820b-0a557ecacba8] (custom)
2019-06-13 11:03:19,221 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/2f7e0b02-46b6-436f-820b-0a557ecacba8/f1a83840-8886-4b3a-833c-73d9a1724ff4 does not exist. Creating ...
2019-06-13 11:03:19,223 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/2f7e0b02-46b6-436f-820b-0a557ecacba8/f1a83840-8886-4b3a-833c-73d9a1724ff4/in_use.lock acquired by nodename 30348@ozone-5n8bq-3406807641
2019-06-13 11:03:19,226 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/2f7e0b02-46b6-436f-820b-0a557ecacba8/f1a83840-8886-4b3a-833c-73d9a1724ff4 has been successfully formatted.
2019-06-13 11:03:19,226 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 11:03:19,226 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 11:03:19,226 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 11:03:19,226 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 11:03:19,226 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 11:03:19,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 11:03:19,227 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 2f7e0b02-46b6-436f-820b-0a557ecacba8-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/2f7e0b02-46b6-436f-820b-0a557ecacba8/f1a83840-8886-4b3a-833c-73d9a1724ff4
2019-06-13 11:03:19,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 11:03:19,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 11:03:19,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 11:03:19,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 11:03:19,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 11:03:19,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 11:03:19,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 11:03:19,228 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 11:03:19,228 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 11:03:19,228 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 11:03:19,228 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 11:03:19,228 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 11:03:19,228 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 11:03:19,229 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8: start group-73D9A1724FF4
2019-06-13 11:03:19,229 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8:group-73D9A1724FF4 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 11:03:19,229 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8: start FollowerState
2019-06-13 11:03:19,229 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-73D9A1724FF4,id=2f7e0b02-46b6-436f-820b-0a557ecacba8
2019-06-13 11:03:19,232 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 11:03:19,233 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 37429 (custom)
2019-06-13 11:03:19,233 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 11:03:19,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 11:03:19,233 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 11:03:19,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 11:03:19,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/a986c32d-0a5b-4e54-814a-bfc3a08544f1] (custom)
2019-06-13 11:03:19,234 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis a986c32d-0a5b-4e54-814a-bfc3a08544f1 at port 37429
2019-06-13 11:03:19,240 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1: start RPC server
2019-06-13 11:03:19,241 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1: GrpcService started, listening on 0.0.0.0/0.0.0.0:37429
2019-06-13 11:03:19,257 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1: addNew group-73D9A1724FF4:[dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:0.0.0.0:39593, a986c32d-0a5b-4e54-814a-bfc3a08544f1:0.0.0.0:37429, 2f7e0b02-46b6-436f-820b-0a557ecacba8:0.0.0.0:40949] returns group-73D9A1724FF4:java.util.concurrent.CompletableFuture@217ef597[Not completed]
2019-06-13 11:03:19,258 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1: new RaftServerImpl for group-73D9A1724FF4:[dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:0.0.0.0:39593, a986c32d-0a5b-4e54-814a-bfc3a08544f1:0.0.0.0:37429, 2f7e0b02-46b6-436f-820b-0a557ecacba8:0.0.0.0:40949] with ContainerStateMachine:uninitialized
2019-06-13 11:03:19,258 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 11:03:19,258 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 11:03:19,258 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 11:03:19,258 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 11:03:19,259 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1:group-73D9A1724FF4 ConfigurationManager, init=-1: [dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:0.0.0.0:39593, a986c32d-0a5b-4e54-814a-bfc3a08544f1:0.0.0.0:37429, 2f7e0b02-46b6-436f-820b-0a557ecacba8:0.0.0.0:40949], old=null, confs=<EMPTY_MAP>
2019-06-13 11:03:19,259 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/a986c32d-0a5b-4e54-814a-bfc3a08544f1] (custom)
2019-06-13 11:03:19,259 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/a986c32d-0a5b-4e54-814a-bfc3a08544f1/f1a83840-8886-4b3a-833c-73d9a1724ff4 does not exist. Creating ...
2019-06-13 11:03:19,261 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/a986c32d-0a5b-4e54-814a-bfc3a08544f1/f1a83840-8886-4b3a-833c-73d9a1724ff4/in_use.lock acquired by nodename 30348@ozone-5n8bq-3406807641
2019-06-13 11:03:19,263 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/a986c32d-0a5b-4e54-814a-bfc3a08544f1/f1a83840-8886-4b3a-833c-73d9a1724ff4 has been successfully formatted.
2019-06-13 11:03:19,263 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 11:03:19,264 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 11:03:19,264 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 11:03:19,264 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 11:03:19,264 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 11:03:19,264 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 11:03:19,264 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new a986c32d-0a5b-4e54-814a-bfc3a08544f1-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/a986c32d-0a5b-4e54-814a-bfc3a08544f1/f1a83840-8886-4b3a-833c-73d9a1724ff4
2019-06-13 11:03:19,264 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 11:03:19,264 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 11:03:19,264 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 11:03:19,264 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 11:03:19,265 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 11:03:19,265 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 11:03:19,265 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 11:03:19,265 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 11:03:19,265 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 11:03:19,265 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 11:03:19,265 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 11:03:19,266 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 11:03:19,266 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 11:03:19,266 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1: start group-73D9A1724FF4
2019-06-13 11:03:19,266 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1:group-73D9A1724FF4 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 11:03:19,266 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1: start FollowerState
2019-06-13 11:03:19,266 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-73D9A1724FF4,id=a986c32d-0a5b-4e54-814a-bfc3a08544f1
2019-06-13 11:03:19,281 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-264388EA92A8->dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5: receive RaftClientReply:client-264388EA92A8->dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5@group-73D9A1724FF4, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5 is not the leader (2f7e0b02-46b6-436f-820b-0a557ecacba8:0.0.0.0:40949). Request must be sent to leader., logIndex=0, commits[dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:c-1]
2019-06-13 11:03:19,284 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 11:03:20,195 INFO  impl.FollowerState (FollowerState.java:run(101)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:group-73D9A1724FF4 changes to CANDIDATE, lastRpcTime:1012, electionTimeout:1012ms
2019-06-13 11:03:20,195 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5: shutdown FollowerState
2019-06-13 11:03:20,195 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:group-73D9A1724FF4 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 11:03:20,196 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5: start LeaderElection
2019-06-13 11:03:20,198 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:group-73D9A1724FF4:LeaderElection2: begin an election at term 1 for -1: [dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:0.0.0.0:39593, a986c32d-0a5b-4e54-814a-bfc3a08544f1:0.0.0.0:37429, 2f7e0b02-46b6-436f-820b-0a557ecacba8:0.0.0.0:40949], old=null
2019-06-13 11:03:20,216 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1:group-73D9A1724FF4 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5
2019-06-13 11:03:20,216 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8:group-73D9A1724FF4 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5
2019-06-13 11:03:20,216 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1: shutdown FollowerState
2019-06-13 11:03:20,216 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8: shutdown FollowerState
2019-06-13 11:03:20,217 INFO  impl.FollowerState (FollowerState.java:run(109)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 11:03:20,217 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1: start FollowerState
2019-06-13 11:03:20,217 INFO  impl.FollowerState (FollowerState.java:run(109)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 11:03:20,217 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8: start FollowerState
2019-06-13 11:03:20,226 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:group-73D9A1724FF4:LeaderElection2: Election PASSED; received 1 response(s) [dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5->a986c32d-0a5b-4e54-814a-bfc3a08544f1,true-t1] and 0 exception(s); dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:t1, leader=null, voted=dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5, raftlog=dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:0.0.0.0:39593, a986c32d-0a5b-4e54-814a-bfc3a08544f1:0.0.0.0:37429, 2f7e0b02-46b6-436f-820b-0a557ecacba8:0.0.0.0:40949], old=null
2019-06-13 11:03:20,226 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5: shutdown LeaderElection
2019-06-13 11:03:20,226 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:group-73D9A1724FF4 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 11:03:20,226 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:group-73D9A1724FF4 change Leader from null to dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5 at term 1 for becomeLeader, leader elected after 1050ms
2019-06-13 11:03:20,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 11:03:20,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 11:03:20,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 11:03:20,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 11:03:20,228 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 11:03:20,229 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 11:03:20,229 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 11:03:20,230 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 11:03:20,230 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 11:03:20,230 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 11:03:20,230 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 11:03:20,230 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 11:03:20,231 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 11:03:20,231 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 11:03:20,231 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 11:03:20,231 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 11:03:20,231 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5: start LeaderState
2019-06-13 11:03:20,231 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5-RaftLogWorker: Starting segment from index:0
2019-06-13 11:03:20,265 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:group-73D9A1724FF4 set configuration 0: [dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:0.0.0.0:39593, a986c32d-0a5b-4e54-814a-bfc3a08544f1:0.0.0.0:37429, 2f7e0b02-46b6-436f-820b-0a557ecacba8:0.0.0.0:40949], old=null at 0
2019-06-13 11:03:20,267 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5/f1a83840-8886-4b3a-833c-73d9a1724ff4/current/log_inprogress_0
2019-06-13 11:03:20,333 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8:group-73D9A1724FF4 change Leader from null to dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5 at term 1 for appendEntries, leader elected after 1106ms
Jun 13, 2019 11:03:20 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=43, target=0.0.0.0:40949} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:131)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-13 11:03:20,335 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1:group-73D9A1724FF4 change Leader from null to dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5 at term 1 for appendEntries, leader elected after 1071ms
Jun 13, 2019 11:03:20 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=51, target=0.0.0.0:37429} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:131)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 13, 2019 11:03:20 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=35, target=0.0.0.0:39593} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:131)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-13 11:03:20,354 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-264388EA92A8->2f7e0b02-46b6-436f-820b-0a557ecacba8: receive RaftClientReply:client-264388EA92A8->2f7e0b02-46b6-436f-820b-0a557ecacba8@group-73D9A1724FF4, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server 2f7e0b02-46b6-436f-820b-0a557ecacba8 is not the leader (dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:0.0.0.0:39593). Request must be sent to leader., logIndex=0, commits[2f7e0b02-46b6-436f-820b-0a557ecacba8:c-1, dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:c-1, a986c32d-0a5b-4e54-814a-bfc3a08544f1:c-1]
2019-06-13 11:03:20,356 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1:group-73D9A1724FF4 set configuration 0: [dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:0.0.0.0:39593, a986c32d-0a5b-4e54-814a-bfc3a08544f1:0.0.0.0:37429, 2f7e0b02-46b6-436f-820b-0a557ecacba8:0.0.0.0:40949], old=null at 0
2019-06-13 11:03:20,356 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1-RaftLogWorker: Starting segment from index:0
2019-06-13 11:03:20,356 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8:group-73D9A1724FF4 set configuration 0: [dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:0.0.0.0:39593, a986c32d-0a5b-4e54-814a-bfc3a08544f1:0.0.0.0:37429, 2f7e0b02-46b6-436f-820b-0a557ecacba8:0.0.0.0:40949], old=null at 0
2019-06-13 11:03:20,390 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8-RaftLogWorker: Starting segment from index:0
2019-06-13 11:03:20,407 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/a986c32d-0a5b-4e54-814a-bfc3a08544f1/f1a83840-8886-4b3a-833c-73d9a1724ff4/current/log_inprogress_0
2019-06-13 11:03:20,424 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 11:03:20,425 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/2f7e0b02-46b6-436f-820b-0a557ecacba8/f1a83840-8886-4b3a-833c-73d9a1724ff4/current/log_inprogress_0
2019-06-13 11:03:21,432 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-264388EA92A8->a986c32d-0a5b-4e54-814a-bfc3a08544f1: receive RaftClientReply:client-264388EA92A8->a986c32d-0a5b-4e54-814a-bfc3a08544f1@group-73D9A1724FF4, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server a986c32d-0a5b-4e54-814a-bfc3a08544f1 is not the leader (dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:0.0.0.0:39593). Request must be sent to leader., logIndex=0, commits[a986c32d-0a5b-4e54-814a-bfc3a08544f1:c0, dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:c0, 2f7e0b02-46b6-436f-820b-0a557ecacba8:c0]
2019-06-13 11:03:21,435 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 11:03:22,441 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-264388EA92A8->2f7e0b02-46b6-436f-820b-0a557ecacba8: receive RaftClientReply:client-264388EA92A8->2f7e0b02-46b6-436f-820b-0a557ecacba8@group-73D9A1724FF4, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server 2f7e0b02-46b6-436f-820b-0a557ecacba8 is not the leader (dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:0.0.0.0:39593). Request must be sent to leader., logIndex=0, commits[2f7e0b02-46b6-436f-820b-0a557ecacba8:c0, dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:c0, a986c32d-0a5b-4e54-814a-bfc3a08544f1:c0]
2019-06-13 11:03:22,444 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 11:03:23,457 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-264388EA92A8->a986c32d-0a5b-4e54-814a-bfc3a08544f1: receive RaftClientReply:client-264388EA92A8->a986c32d-0a5b-4e54-814a-bfc3a08544f1@group-73D9A1724FF4, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server a986c32d-0a5b-4e54-814a-bfc3a08544f1 is not the leader (dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:0.0.0.0:39593). Request must be sent to leader., logIndex=0, commits[a986c32d-0a5b-4e54-814a-bfc3a08544f1:c0, dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:c0, 2f7e0b02-46b6-436f-820b-0a557ecacba8:c0]
2019-06-13 11:03:23,459 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 11:03:24,469 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-13 11:03:24,473 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-13 11:03:24,474 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-264388EA92A8->dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5: receive RaftClientReply:client-264388EA92A8->dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5@group-73D9A1724FF4, cid=6, SUCCESS, logIndex=1, commits[dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:c1, a986c32d-0a5b-4e54-814a-bfc3a08544f1:c0, 2f7e0b02-46b6-436f-820b-0a557ecacba8:c0]
2019-06-13 11:03:24,474 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-13 11:03:24,475 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-13 11:03:24,500 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-726E7A21BB40->dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5: receive RaftClientReply:client-726E7A21BB40->dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5@group-73D9A1724FF4, cid=7, SUCCESS, logIndex=3, commits[dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:c3, a986c32d-0a5b-4e54-814a-bfc3a08544f1:c2, 2f7e0b02-46b6-436f-820b-0a557ecacba8:c2]
2019-06-13 11:03:24,504 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5: close
2019-06-13 11:03:24,504 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5: shutdown group-73D9A1724FF4
2019-06-13 11:03:24,505 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-73D9A1724FF4,id=dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5
2019-06-13 11:03:24,505 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5: shutdown LeaderState
2019-06-13 11:03:24,505 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5-PendingRequests: sendNotLeaderResponses
2019-06-13 11:03:24,505 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5 -> a986c32d-0a5b-4e54-814a-bfc3a08544f1): Wait interrupted by java.lang.InterruptedException
2019-06-13 11:03:24,506 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5 -> 2f7e0b02-46b6-436f-820b-0a557ecacba8): Wait interrupted by java.lang.InterruptedException
2019-06-13 11:03:24,507 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1: appendEntries completed
2019-06-13 11:03:24,508 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8: appendEntries completed
2019-06-13 11:03:24,508 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-13 11:03:24,508 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5/f1a83840-8886-4b3a-833c-73d9a1724ff4/sm/snapshot.1_3
2019-06-13 11:03:24,508 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5-group-73D9A1724FF4: set stopIndex = 4
2019-06-13 11:03:24,509 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5:group-73D9A1724FF4 closes. The last applied log index is 4
2019-06-13 11:03:24,509 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 11:03:24,509 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5: follower dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5->a986c32d-0a5b-4e54-814a-bfc3a08544f1(c3,m4,n5, attendVote=true, lastRpcSendTime=24, lastRpcResponseTime=14) response Completed
2019-06-13 11:03:24,510 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5: follower dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5->2f7e0b02-46b6-436f-820b-0a557ecacba8(c3,m4,n5, attendVote=true, lastRpcSendTime=24, lastRpcResponseTime=18) response Completed
2019-06-13 11:03:24,511 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5->a986c32d-0a5b-4e54-814a-bfc3a08544f1: nextIndex: updateUnconditionally 5 -> -1
2019-06-13 11:03:24,511 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5->2f7e0b02-46b6-436f-820b-0a557ecacba8: nextIndex: updateUnconditionally 5 -> -1
2019-06-13 11:03:24,512 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5-RaftLogWorker close()
2019-06-13 11:03:24,512 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5: shutdown server with port 39593 now
2019-06-13 11:03:24,513 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - dd080ccb-04f0-4ff9-9fc9-06fb860dd8c5: shutdown server with port 39593 successfully
2019-06-13 11:03:24,514 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8: close
2019-06-13 11:03:24,514 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8: shutdown group-73D9A1724FF4
2019-06-13 11:03:24,515 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-73D9A1724FF4,id=2f7e0b02-46b6-436f-820b-0a557ecacba8
2019-06-13 11:03:24,515 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8: shutdown FollowerState
2019-06-13 11:03:24,515 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-2f7e0b02-46b6-436f-820b-0a557ecacba8-group-73D9A1724FF4: set stopIndex = 3
2019-06-13 11:03:24,516 INFO  impl.FollowerState (FollowerState.java:run(109)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 11:03:24,515 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-13 11:03:24,516 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/2f7e0b02-46b6-436f-820b-0a557ecacba8/f1a83840-8886-4b3a-833c-73d9a1724ff4/sm/snapshot.1_3
2019-06-13 11:03:24,516 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8:group-73D9A1724FF4 closes. The last applied log index is 3
2019-06-13 11:03:24,516 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 11:03:24,518 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8-RaftLogWorker close()
2019-06-13 11:03:24,518 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8: shutdown server with port 40949 now
2019-06-13 11:03:24,519 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 2f7e0b02-46b6-436f-820b-0a557ecacba8: shutdown server with port 40949 successfully
2019-06-13 11:03:24,521 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1: close
2019-06-13 11:03:24,521 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1: shutdown group-73D9A1724FF4
2019-06-13 11:03:24,521 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-73D9A1724FF4,id=a986c32d-0a5b-4e54-814a-bfc3a08544f1
2019-06-13 11:03:24,522 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1: shutdown FollowerState
2019-06-13 11:03:24,522 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-13 11:03:24,522 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/a986c32d-0a5b-4e54-814a-bfc3a08544f1/f1a83840-8886-4b3a-833c-73d9a1724ff4/sm/snapshot.1_3
2019-06-13 11:03:24,522 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-a986c32d-0a5b-4e54-814a-bfc3a08544f1-group-73D9A1724FF4: set stopIndex = 3
2019-06-13 11:03:24,522 INFO  impl.FollowerState (FollowerState.java:run(109)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 11:03:24,523 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1:group-73D9A1724FF4 closes. The last applied log index is 3
2019-06-13 11:03:24,523 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 11:03:24,525 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1-RaftLogWorker close()
2019-06-13 11:03:24,525 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1: shutdown server with port 37429 now
2019-06-13 11:03:24,525 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - a986c32d-0a5b-4e54-814a-bfc3a08544f1: shutdown server with port 37429 successfully
