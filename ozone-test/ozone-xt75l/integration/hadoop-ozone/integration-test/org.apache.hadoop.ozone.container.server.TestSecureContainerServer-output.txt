2019-06-13 21:03:33,886 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-13 21:03:33,980 INFO  ozone.RatisTestHelper (RatisTestHelper.java:initRatisConf(109)) - dfs.container.ratis.rpc.type = GRPC
2019-06-13 21:03:34,045 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 21:03:34,056 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 40427 (custom)
2019-06-13 21:03:34,057 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 21:03:34,059 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 21:03:34,059 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 21:03:34,060 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 21:03:34,107 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5] (custom)
2019-06-13 21:03:34,112 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5 at port 40427
2019-06-13 21:03:34,124 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5: start RPC server
2019-06-13 21:03:34,125 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5: GrpcService started, listening on 0.0.0.0/0.0.0.0:40427
2019-06-13 21:03:34,196 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5: addNew group-8A83DCD6D3FB:[7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5:0.0.0.0:40427] returns group-8A83DCD6D3FB:java.util.concurrent.CompletableFuture@2a44200[Not completed]
2019-06-13 21:03:34,201 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5: new RaftServerImpl for group-8A83DCD6D3FB:[7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5:0.0.0.0:40427] with ContainerStateMachine:uninitialized
2019-06-13 21:03:34,203 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 21:03:34,203 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 21:03:34,204 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 21:03:34,204 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 21:03:34,209 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5:group-8A83DCD6D3FB ConfigurationManager, init=-1: [7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5:0.0.0.0:40427], old=null, confs=<EMPTY_MAP>
2019-06-13 21:03:34,209 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5] (custom)
2019-06-13 21:03:34,214 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5/92e0c3c5-5ceb-46ec-9db0-8a83dcd6d3fb does not exist. Creating ...
2019-06-13 21:03:34,221 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5/92e0c3c5-5ceb-46ec-9db0-8a83dcd6d3fb/in_use.lock acquired by nodename 7254@ozone-xt75l-2456167409
2019-06-13 21:03:34,228 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5/92e0c3c5-5ceb-46ec-9db0-8a83dcd6d3fb has been successfully formatted.
2019-06-13 21:03:34,230 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 21:03:34,230 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 21:03:34,231 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 21:03:34,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 21:03:34,235 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 21:03:34,238 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 21:03:34,241 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5/92e0c3c5-5ceb-46ec-9db0-8a83dcd6d3fb
2019-06-13 21:03:34,241 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 21:03:34,241 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 21:03:34,243 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 21:03:34,243 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 21:03:34,243 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 21:03:34,244 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 21:03:34,245 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 21:03:34,245 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 21:03:34,245 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 21:03:34,247 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 21:03:34,252 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 21:03:34,253 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 21:03:34,253 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 21:03:34,266 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5: start group-8A83DCD6D3FB
2019-06-13 21:03:34,267 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5:group-8A83DCD6D3FB changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 21:03:34,268 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5: start FollowerState
2019-06-13 21:03:34,307 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-8A83DCD6D3FB,id=7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5
2019-06-13 21:03:34,359 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-328340FB1620->7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5: receive RaftClientReply:client-328340FB1620->7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5@group-8A83DCD6D3FB, cid=1, FAILED org.apache.ratis.protocol.NotLeaderException: Server 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5 is not the leader (null). Request must be sent to leader., logIndex=0, commits[7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5:c-1]
2019-06-13 21:03:35,351 INFO  impl.FollowerState (FollowerState.java:run(101)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5:group-8A83DCD6D3FB changes to CANDIDATE, lastRpcTime:1083, electionTimeout:1083ms
2019-06-13 21:03:35,351 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5: shutdown FollowerState
2019-06-13 21:03:35,351 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5:group-8A83DCD6D3FB changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 21:03:35,353 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5: start LeaderElection
2019-06-13 21:03:35,356 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5:group-8A83DCD6D3FB:LeaderElection1: begin an election at term 1 for -1: [7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5:0.0.0.0:40427], old=null
2019-06-13 21:03:35,357 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5: shutdown LeaderElection
2019-06-13 21:03:35,358 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5:group-8A83DCD6D3FB changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 21:03:35,358 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5:group-8A83DCD6D3FB change Leader from null to 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5 at term 1 for becomeLeader, leader elected after 1127ms
2019-06-13 21:03:35,361 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 21:03:35,361 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 21:03:35,363 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 21:03:35,363 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 21:03:35,371 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5: start LeaderState
2019-06-13 21:03:35,385 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5-RaftLogWorker: Starting segment from index:0
2019-06-13 21:03:35,403 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5:group-8A83DCD6D3FB set configuration 0: [7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5:0.0.0.0:40427], old=null at 0
2019-06-13 21:03:35,520 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5/92e0c3c5-5ceb-46ec-9db0-8a83dcd6d3fb/current/log_inprogress_0
2019-06-13 21:03:36,409 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-13 21:03:36,414 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-328340FB1620->7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5: receive RaftClientReply:client-328340FB1620->7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5@group-8A83DCD6D3FB, cid=1, SUCCESS, logIndex=1, commits[7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5:c2]
2019-06-13 21:03:36,416 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-13 21:03:36,432 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-E5B2717ECFF4->7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5: receive RaftClientReply:client-E5B2717ECFF4->7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5@group-8A83DCD6D3FB, cid=2, SUCCESS, logIndex=3, commits[7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5:c3]
2019-06-13 21:03:36,436 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5: close
2019-06-13 21:03:36,437 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5: shutdown group-8A83DCD6D3FB
2019-06-13 21:03:36,438 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-8A83DCD6D3FB,id=7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5
2019-06-13 21:03:36,438 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5: shutdown LeaderState
2019-06-13 21:03:36,438 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5-PendingRequests: sendNotLeaderResponses
2019-06-13 21:03:36,441 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-13 21:03:36,442 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5/92e0c3c5-5ceb-46ec-9db0-8a83dcd6d3fb/sm/snapshot.1_4
2019-06-13 21:03:36,445 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5-group-8A83DCD6D3FB: set stopIndex = 4
2019-06-13 21:03:36,449 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5:group-8A83DCD6D3FB closes. The last applied log index is 4
2019-06-13 21:03:36,450 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 21:03:36,450 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5-RaftLogWorker close()
2019-06-13 21:03:36,451 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5: shutdown server with port 40427 now
2019-06-13 21:03:36,534 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 7f07cd4c-25d9-4fcc-b3be-0a50031ea3f5: shutdown server with port 40427 successfully
2019-06-13 21:03:36,537 INFO  ozone.RatisTestHelper (RatisTestHelper.java:initRatisConf(109)) - dfs.container.ratis.rpc.type = GRPC
2019-06-13 21:03:36,539 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 21:03:36,539 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43395 (custom)
2019-06-13 21:03:36,539 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 21:03:36,540 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 21:03:36,540 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 21:03:36,540 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 21:03:36,541 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/fe679b3a-33e0-4b43-a7b8-addcaa85e8cd] (custom)
2019-06-13 21:03:36,541 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis fe679b3a-33e0-4b43-a7b8-addcaa85e8cd at port 43395
2019-06-13 21:03:36,553 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: start RPC server
2019-06-13 21:03:36,555 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: GrpcService started, listening on 0.0.0.0/0.0.0.0:43395
Jun 13, 2019 9:03:36 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=9, target=0.0.0.0:32849} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connectToDatanode(XceiverClientGrpc.java:163)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connect(XceiverClientGrpc.java:120)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:227)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServer(TestSecureContainerServer.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 13, 2019 9:03:36 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=17, target=0.0.0.0:40427} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:130)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-13 21:03:36,583 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: addNew group-24F987A0ADEA:[1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:0.0.0.0:36323, fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395, 10be946b-404d-46c2-a65d-dd614e82b8dc:0.0.0.0:46273] returns group-24F987A0ADEA:java.util.concurrent.CompletableFuture@1fd42101[Not completed]
2019-06-13 21:03:36,583 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: new RaftServerImpl for group-24F987A0ADEA:[1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:0.0.0.0:36323, fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395, 10be946b-404d-46c2-a65d-dd614e82b8dc:0.0.0.0:46273] with ContainerStateMachine:uninitialized
2019-06-13 21:03:36,584 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 21:03:36,584 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 21:03:36,584 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 21:03:36,584 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 21:03:36,585 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:group-24F987A0ADEA ConfigurationManager, init=-1: [1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:0.0.0.0:36323, fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395, 10be946b-404d-46c2-a65d-dd614e82b8dc:0.0.0.0:46273], old=null, confs=<EMPTY_MAP>
2019-06-13 21:03:36,585 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/fe679b3a-33e0-4b43-a7b8-addcaa85e8cd] (custom)
2019-06-13 21:03:36,585 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/fe679b3a-33e0-4b43-a7b8-addcaa85e8cd/448e59a9-9031-484f-813c-24f987a0adea does not exist. Creating ...
2019-06-13 21:03:36,588 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/fe679b3a-33e0-4b43-a7b8-addcaa85e8cd/448e59a9-9031-484f-813c-24f987a0adea/in_use.lock acquired by nodename 7254@ozone-xt75l-2456167409
2019-06-13 21:03:36,590 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/fe679b3a-33e0-4b43-a7b8-addcaa85e8cd/448e59a9-9031-484f-813c-24f987a0adea has been successfully formatted.
2019-06-13 21:03:36,590 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 21:03:36,591 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 21:03:36,591 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 21:03:36,591 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 21:03:36,591 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 21:03:36,591 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 21:03:36,591 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new fe679b3a-33e0-4b43-a7b8-addcaa85e8cd-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/fe679b3a-33e0-4b43-a7b8-addcaa85e8cd/448e59a9-9031-484f-813c-24f987a0adea
2019-06-13 21:03:36,591 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 21:03:36,591 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 21:03:36,591 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 21:03:36,592 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 21:03:36,592 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 21:03:36,592 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 21:03:36,592 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 21:03:36,592 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 21:03:36,592 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 21:03:36,593 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 21:03:36,593 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 21:03:36,593 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 21:03:36,594 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 21:03:36,594 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: start group-24F987A0ADEA
2019-06-13 21:03:36,594 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:group-24F987A0ADEA changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 21:03:36,594 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: start FollowerState
2019-06-13 21:03:36,595 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-24F987A0ADEA,id=fe679b3a-33e0-4b43-a7b8-addcaa85e8cd
2019-06-13 21:03:36,600 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 21:03:36,600 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 36323 (custom)
2019-06-13 21:03:36,601 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 21:03:36,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 21:03:36,601 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 21:03:36,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 21:03:36,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f] (custom)
2019-06-13 21:03:36,602 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f at port 36323
2019-06-13 21:03:36,607 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: start RPC server
2019-06-13 21:03:36,608 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: GrpcService started, listening on 0.0.0.0/0.0.0.0:36323
2019-06-13 21:03:36,629 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: addNew group-24F987A0ADEA:[1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:0.0.0.0:36323, fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395, 10be946b-404d-46c2-a65d-dd614e82b8dc:0.0.0.0:46273] returns group-24F987A0ADEA:java.util.concurrent.CompletableFuture@5e0e42c1[Not completed]
2019-06-13 21:03:36,634 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: new RaftServerImpl for group-24F987A0ADEA:[1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:0.0.0.0:36323, fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395, 10be946b-404d-46c2-a65d-dd614e82b8dc:0.0.0.0:46273] with ContainerStateMachine:uninitialized
2019-06-13 21:03:36,634 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 21:03:36,634 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 21:03:36,634 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 21:03:36,634 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 21:03:36,635 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:group-24F987A0ADEA ConfigurationManager, init=-1: [1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:0.0.0.0:36323, fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395, 10be946b-404d-46c2-a65d-dd614e82b8dc:0.0.0.0:46273], old=null, confs=<EMPTY_MAP>
2019-06-13 21:03:36,635 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f] (custom)
2019-06-13 21:03:36,635 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f/448e59a9-9031-484f-813c-24f987a0adea does not exist. Creating ...
2019-06-13 21:03:36,637 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f/448e59a9-9031-484f-813c-24f987a0adea/in_use.lock acquired by nodename 7254@ozone-xt75l-2456167409
2019-06-13 21:03:36,639 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f/448e59a9-9031-484f-813c-24f987a0adea has been successfully formatted.
2019-06-13 21:03:36,640 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 21:03:36,640 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 21:03:36,640 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 21:03:36,640 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 21:03:36,640 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 21:03:36,640 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 21:03:36,640 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f/448e59a9-9031-484f-813c-24f987a0adea
2019-06-13 21:03:36,640 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 21:03:36,640 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 21:03:36,641 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 21:03:36,641 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 21:03:36,641 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 21:03:36,641 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 21:03:36,641 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 21:03:36,641 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 21:03:36,641 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 21:03:36,642 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 21:03:36,642 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 21:03:36,642 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 21:03:36,642 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 21:03:36,643 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: start group-24F987A0ADEA
2019-06-13 21:03:36,643 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:group-24F987A0ADEA changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 21:03:36,643 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: start FollowerState
2019-06-13 21:03:36,643 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-24F987A0ADEA,id=1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f
2019-06-13 21:03:36,649 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 21:03:36,649 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 46273 (custom)
2019-06-13 21:03:36,649 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 21:03:36,649 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 21:03:36,649 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 21:03:36,650 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 21:03:36,650 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/10be946b-404d-46c2-a65d-dd614e82b8dc] (custom)
2019-06-13 21:03:36,650 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 10be946b-404d-46c2-a65d-dd614e82b8dc at port 46273
2019-06-13 21:03:36,661 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 10be946b-404d-46c2-a65d-dd614e82b8dc: start RPC server
2019-06-13 21:03:36,663 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 10be946b-404d-46c2-a65d-dd614e82b8dc: GrpcService started, listening on 0.0.0.0/0.0.0.0:46273
2019-06-13 21:03:36,683 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 10be946b-404d-46c2-a65d-dd614e82b8dc: addNew group-24F987A0ADEA:[1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:0.0.0.0:36323, fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395, 10be946b-404d-46c2-a65d-dd614e82b8dc:0.0.0.0:46273] returns group-24F987A0ADEA:java.util.concurrent.CompletableFuture@1aa48b27[Not completed]
2019-06-13 21:03:36,684 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 10be946b-404d-46c2-a65d-dd614e82b8dc: new RaftServerImpl for group-24F987A0ADEA:[1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:0.0.0.0:36323, fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395, 10be946b-404d-46c2-a65d-dd614e82b8dc:0.0.0.0:46273] with ContainerStateMachine:uninitialized
2019-06-13 21:03:36,684 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 21:03:36,685 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 21:03:36,685 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 21:03:36,685 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 21:03:36,685 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 10be946b-404d-46c2-a65d-dd614e82b8dc:group-24F987A0ADEA ConfigurationManager, init=-1: [1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:0.0.0.0:36323, fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395, 10be946b-404d-46c2-a65d-dd614e82b8dc:0.0.0.0:46273], old=null, confs=<EMPTY_MAP>
2019-06-13 21:03:36,685 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/10be946b-404d-46c2-a65d-dd614e82b8dc] (custom)
2019-06-13 21:03:36,686 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/10be946b-404d-46c2-a65d-dd614e82b8dc/448e59a9-9031-484f-813c-24f987a0adea does not exist. Creating ...
2019-06-13 21:03:36,688 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/10be946b-404d-46c2-a65d-dd614e82b8dc/448e59a9-9031-484f-813c-24f987a0adea/in_use.lock acquired by nodename 7254@ozone-xt75l-2456167409
2019-06-13 21:03:36,690 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/10be946b-404d-46c2-a65d-dd614e82b8dc/448e59a9-9031-484f-813c-24f987a0adea has been successfully formatted.
2019-06-13 21:03:36,691 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 21:03:36,691 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 21:03:36,691 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 21:03:36,691 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 21:03:36,691 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 21:03:36,691 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 21:03:36,691 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 10be946b-404d-46c2-a65d-dd614e82b8dc-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/10be946b-404d-46c2-a65d-dd614e82b8dc/448e59a9-9031-484f-813c-24f987a0adea
2019-06-13 21:03:36,691 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 21:03:36,691 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 21:03:36,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 21:03:36,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 21:03:36,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 21:03:36,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 21:03:36,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 21:03:36,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 21:03:36,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 21:03:36,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 21:03:36,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 21:03:36,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 21:03:36,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 21:03:36,693 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 10be946b-404d-46c2-a65d-dd614e82b8dc: start group-24F987A0ADEA
2019-06-13 21:03:36,693 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 10be946b-404d-46c2-a65d-dd614e82b8dc:group-24F987A0ADEA changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 21:03:36,693 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 10be946b-404d-46c2-a65d-dd614e82b8dc: start FollowerState
2019-06-13 21:03:36,694 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-24F987A0ADEA,id=10be946b-404d-46c2-a65d-dd614e82b8dc
2019-06-13 21:03:36,706 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-0937BA5D6C18->fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: receive RaftClientReply:client-0937BA5D6C18->fe679b3a-33e0-4b43-a7b8-addcaa85e8cd@group-24F987A0ADEA, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server fe679b3a-33e0-4b43-a7b8-addcaa85e8cd is not the leader (1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:0.0.0.0:36323). Request must be sent to leader., logIndex=0, commits[fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:c-1]
2019-06-13 21:03:36,710 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 21:03:37,719 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-0937BA5D6C18->10be946b-404d-46c2-a65d-dd614e82b8dc: receive RaftClientReply:client-0937BA5D6C18->10be946b-404d-46c2-a65d-dd614e82b8dc@group-24F987A0ADEA, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server 10be946b-404d-46c2-a65d-dd614e82b8dc is not the leader (fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395). Request must be sent to leader., logIndex=0, commits[10be946b-404d-46c2-a65d-dd614e82b8dc:c-1]
2019-06-13 21:03:37,722 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 21:03:37,752 INFO  impl.FollowerState (FollowerState.java:run(101)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:group-24F987A0ADEA changes to CANDIDATE, lastRpcTime:1157, electionTimeout:1157ms
2019-06-13 21:03:37,753 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: shutdown FollowerState
2019-06-13 21:03:37,753 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:group-24F987A0ADEA changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 21:03:37,753 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: start LeaderElection
2019-06-13 21:03:37,756 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:group-24F987A0ADEA:LeaderElection2: begin an election at term 1 for -1: [1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:0.0.0.0:36323, fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395, 10be946b-404d-46c2-a65d-dd614e82b8dc:0.0.0.0:46273], old=null
2019-06-13 21:03:37,771 INFO  impl.FollowerState (FollowerState.java:run(101)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:group-24F987A0ADEA changes to CANDIDATE, lastRpcTime:1128, electionTimeout:1128ms
2019-06-13 21:03:37,772 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: shutdown FollowerState
2019-06-13 21:03:37,772 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:group-24F987A0ADEA changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 21:03:37,772 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: start LeaderElection
2019-06-13 21:03:37,772 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 10be946b-404d-46c2-a65d-dd614e82b8dc:group-24F987A0ADEA changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:fe679b3a-33e0-4b43-a7b8-addcaa85e8cd
2019-06-13 21:03:37,772 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 10be946b-404d-46c2-a65d-dd614e82b8dc: shutdown FollowerState
2019-06-13 21:03:37,774 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 10be946b-404d-46c2-a65d-dd614e82b8dc: start FollowerState
2019-06-13 21:03:37,774 INFO  impl.FollowerState (FollowerState.java:run(109)) - 10be946b-404d-46c2-a65d-dd614e82b8dc: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 21:03:37,774 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:group-24F987A0ADEA changes role from CANDIDATE to FOLLOWER at term 1 for recognizeCandidate:fe679b3a-33e0-4b43-a7b8-addcaa85e8cd
2019-06-13 21:03:37,775 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: shutdown LeaderElection
2019-06-13 21:03:37,775 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: start FollowerState
2019-06-13 21:03:37,780 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:group-24F987A0ADEA:LeaderElection3: begin an election at term 2 for -1: [1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:0.0.0.0:36323, fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395, 10be946b-404d-46c2-a65d-dd614e82b8dc:0.0.0.0:46273], old=null
2019-06-13 21:03:37,782 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:group-24F987A0ADEA:LeaderElection2: Election PASSED; received 1 response(s) [fe679b3a-33e0-4b43-a7b8-addcaa85e8cd->10be946b-404d-46c2-a65d-dd614e82b8dc,true-t1] and 0 exception(s); fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:t1, leader=null, voted=fe679b3a-33e0-4b43-a7b8-addcaa85e8cd, raftlog=fe679b3a-33e0-4b43-a7b8-addcaa85e8cd-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:0.0.0.0:36323, fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395, 10be946b-404d-46c2-a65d-dd614e82b8dc:0.0.0.0:46273], old=null
2019-06-13 21:03:37,788 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: shutdown LeaderElection
2019-06-13 21:03:37,790 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:group-24F987A0ADEA changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 21:03:37,790 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:group-24F987A0ADEA change Leader from null to fe679b3a-33e0-4b43-a7b8-addcaa85e8cd at term 1 for becomeLeader, leader elected after 1199ms
2019-06-13 21:03:37,790 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 21:03:37,790 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 21:03:37,791 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:group-24F987A0ADEA:LeaderElection3: Election REJECTED; received 0 response(s) [] and 0 exception(s); 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:t2, leader=null, voted=1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f, raftlog=1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:0.0.0.0:36323, fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395, 10be946b-404d-46c2-a65d-dd614e82b8dc:0.0.0.0:46273], old=null
2019-06-13 21:03:37,791 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 21:03:37,792 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 21:03:37,795 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 21:03:37,795 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 21:03:37,795 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 21:03:37,797 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 21:03:37,797 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 21:03:37,797 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 21:03:37,797 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 21:03:37,797 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 21:03:37,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 21:03:37,798 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 21:03:37,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 21:03:37,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 21:03:37,798 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: start LeaderState
2019-06-13 21:03:37,799 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd-RaftLogWorker: Starting segment from index:0
2019-06-13 21:03:37,817 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:group-24F987A0ADEA set configuration 0: [1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:0.0.0.0:36323, fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395, 10be946b-404d-46c2-a65d-dd614e82b8dc:0.0.0.0:46273], old=null at 0
2019-06-13 21:03:37,837 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/fe679b3a-33e0-4b43-a7b8-addcaa85e8cd/448e59a9-9031-484f-813c-24f987a0adea/current/log_inprogress_0
2019-06-13 21:03:37,841 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:group-24F987A0ADEA change Leader from fe679b3a-33e0-4b43-a7b8-addcaa85e8cd to null at term 2 for updateCurrentTerm
2019-06-13 21:03:37,842 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:group-24F987A0ADEA changes role from LEADER to FOLLOWER at term 2 for recognizeCandidate:1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f
2019-06-13 21:03:37,842 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: shutdown LeaderState
2019-06-13 21:03:37,842 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd-PendingRequests: sendNotLeaderResponses
2019-06-13 21:03:37,843 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: start FollowerState
2019-06-13 21:03:37,843 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(fe679b3a-33e0-4b43-a7b8-addcaa85e8cd -> 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f): Wait interrupted by java.lang.InterruptedException
2019-06-13 21:03:37,846 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(fe679b3a-33e0-4b43-a7b8-addcaa85e8cd -> 10be946b-404d-46c2-a65d-dd614e82b8dc): Wait interrupted by java.lang.InterruptedException
2019-06-13 21:03:37,857 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: appendEntries completed
2019-06-13 21:03:37,857 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 10be946b-404d-46c2-a65d-dd614e82b8dc:group-24F987A0ADEA changes role from FOLLOWER to FOLLOWER at term 2 for recognizeCandidate:1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f
2019-06-13 21:03:37,858 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 10be946b-404d-46c2-a65d-dd614e82b8dc: shutdown FollowerState
2019-06-13 21:03:37,858 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 10be946b-404d-46c2-a65d-dd614e82b8dc: start FollowerState
2019-06-13 21:03:37,858 INFO  impl.FollowerState (FollowerState.java:run(109)) - 10be946b-404d-46c2-a65d-dd614e82b8dc: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 21:03:37,866 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 10be946b-404d-46c2-a65d-dd614e82b8dc: appendEntries completed
2019-06-13 21:03:37,867 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: follower fe679b3a-33e0-4b43-a7b8-addcaa85e8cd->1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f(c-1,m0,n0, attendVote=true, lastRpcSendTime=24, lastRpcResponseTime=3) response Completed
2019-06-13 21:03:37,869 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: follower fe679b3a-33e0-4b43-a7b8-addcaa85e8cd->10be946b-404d-46c2-a65d-dd614e82b8dc(c-1,m0,n0, attendVote=true, lastRpcSendTime=1276, lastRpcResponseTime=1276) response Completed
2019-06-13 21:03:37,874 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd->1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 21:03:37,875 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd->10be946b-404d-46c2-a65d-dd614e82b8dc: nextIndex: updateUnconditionally 0 -> 0
2019-06-13 21:03:38,730 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-0937BA5D6C18->fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: receive RaftClientReply:client-0937BA5D6C18->fe679b3a-33e0-4b43-a7b8-addcaa85e8cd@group-24F987A0ADEA, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server fe679b3a-33e0-4b43-a7b8-addcaa85e8cd is not the leader (10be946b-404d-46c2-a65d-dd614e82b8dc:0.0.0.0:46273). Request must be sent to leader., logIndex=0, commits[fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:c-1, 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:c-1, 10be946b-404d-46c2-a65d-dd614e82b8dc:c-1]
2019-06-13 21:03:38,732 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 21:03:38,890 INFO  impl.FollowerState (FollowerState.java:run(101)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:group-24F987A0ADEA changes to CANDIDATE, lastRpcTime:1047, electionTimeout:1047ms
2019-06-13 21:03:38,891 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: shutdown FollowerState
2019-06-13 21:03:38,891 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:group-24F987A0ADEA changes role from FOLLOWER to CANDIDATE at term 2 for changeToCandidate
2019-06-13 21:03:38,891 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: start LeaderElection
2019-06-13 21:03:38,894 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:group-24F987A0ADEA:LeaderElection4: begin an election at term 3 for 0: [1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:0.0.0.0:36323, fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395, 10be946b-404d-46c2-a65d-dd614e82b8dc:0.0.0.0:46273], old=null
2019-06-13 21:03:38,903 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:group-24F987A0ADEA changes role from FOLLOWER to FOLLOWER at term 3 for recognizeCandidate:fe679b3a-33e0-4b43-a7b8-addcaa85e8cd
2019-06-13 21:03:38,903 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: shutdown FollowerState
2019-06-13 21:03:38,903 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 10be946b-404d-46c2-a65d-dd614e82b8dc:group-24F987A0ADEA changes role from FOLLOWER to FOLLOWER at term 3 for recognizeCandidate:fe679b3a-33e0-4b43-a7b8-addcaa85e8cd
2019-06-13 21:03:38,904 INFO  impl.FollowerState (FollowerState.java:run(109)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 21:03:38,903 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: start FollowerState
2019-06-13 21:03:38,904 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 10be946b-404d-46c2-a65d-dd614e82b8dc: shutdown FollowerState
2019-06-13 21:03:38,904 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 10be946b-404d-46c2-a65d-dd614e82b8dc: start FollowerState
2019-06-13 21:03:38,904 INFO  impl.FollowerState (FollowerState.java:run(109)) - 10be946b-404d-46c2-a65d-dd614e82b8dc: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 21:03:38,909 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:group-24F987A0ADEA:LeaderElection4: Election PASSED; received 1 response(s) [fe679b3a-33e0-4b43-a7b8-addcaa85e8cd->10be946b-404d-46c2-a65d-dd614e82b8dc,true-t3] and 0 exception(s); fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:t3, leader=null, voted=fe679b3a-33e0-4b43-a7b8-addcaa85e8cd, raftlog=fe679b3a-33e0-4b43-a7b8-addcaa85e8cd-SegmentedRaftLog:OPENED:c-1,f0,i0, conf=0: [1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:0.0.0.0:36323, fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395, 10be946b-404d-46c2-a65d-dd614e82b8dc:0.0.0.0:46273], old=null
2019-06-13 21:03:38,910 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: shutdown LeaderElection
2019-06-13 21:03:38,910 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:group-24F987A0ADEA changes role from CANDIDATE to LEADER at term 3 for changeToLeader
2019-06-13 21:03:38,911 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:group-24F987A0ADEA change Leader from null to fe679b3a-33e0-4b43-a7b8-addcaa85e8cd at term 3 for becomeLeader, leader elected after 1069ms
2019-06-13 21:03:38,911 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 21:03:38,911 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 21:03:38,912 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 21:03:38,912 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 21:03:38,912 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 21:03:38,913 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 21:03:38,913 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 21:03:38,913 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 21:03:38,913 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 21:03:38,913 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 21:03:38,913 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 21:03:38,914 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 21:03:38,914 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 21:03:38,914 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 21:03:38,914 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 21:03:38,914 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 21:03:38,914 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: start LeaderState
2019-06-13 21:03:38,915 INFO  storage.RaftLogWorker (RaftLogWorker.java:rollLogSegment(303)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd-RaftLogWorker: Rolling segment log-0_0 to index:0
2019-06-13 21:03:38,918 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(433)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd-RaftLogWorker: Rolled log segment from /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/fe679b3a-33e0-4b43-a7b8-addcaa85e8cd/448e59a9-9031-484f-813c-24f987a0adea/current/log_inprogress_0 to /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/fe679b3a-33e0-4b43-a7b8-addcaa85e8cd/448e59a9-9031-484f-813c-24f987a0adea/current/log_0-0
2019-06-13 21:03:38,959 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 10be946b-404d-46c2-a65d-dd614e82b8dc:group-24F987A0ADEA change Leader from null to fe679b3a-33e0-4b43-a7b8-addcaa85e8cd at term 3 for appendEntries, leader elected after 2268ms
2019-06-13 21:03:38,959 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:group-24F987A0ADEA change Leader from null to fe679b3a-33e0-4b43-a7b8-addcaa85e8cd at term 3 for appendEntries, leader elected after 2319ms
2019-06-13 21:03:38,959 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/fe679b3a-33e0-4b43-a7b8-addcaa85e8cd/448e59a9-9031-484f-813c-24f987a0adea/current/log_inprogress_1
2019-06-13 21:03:38,961 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd->1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: nextIndex: updateUnconditionally 1 -> 0
2019-06-13 21:03:38,961 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd->10be946b-404d-46c2-a65d-dd614e82b8dc: nextIndex: updateUnconditionally 1 -> 0
2019-06-13 21:03:38,961 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:group-24F987A0ADEA set configuration 1: [1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:0.0.0.0:36323, fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395, 10be946b-404d-46c2-a65d-dd614e82b8dc:0.0.0.0:46273], old=null at 1
2019-06-13 21:03:38,973 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 10be946b-404d-46c2-a65d-dd614e82b8dc:group-24F987A0ADEA set configuration 0: [1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:0.0.0.0:36323, fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395, 10be946b-404d-46c2-a65d-dd614e82b8dc:0.0.0.0:46273], old=null at 0
2019-06-13 21:03:38,973 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:group-24F987A0ADEA set configuration 0: [1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:0.0.0.0:36323, fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395, 10be946b-404d-46c2-a65d-dd614e82b8dc:0.0.0.0:46273], old=null at 0
2019-06-13 21:03:38,973 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 10be946b-404d-46c2-a65d-dd614e82b8dc-RaftLogWorker: Starting segment from index:0
2019-06-13 21:03:38,973 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f-RaftLogWorker: Starting segment from index:0
2019-06-13 21:03:38,996 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:group-24F987A0ADEA set configuration 1: [1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:0.0.0.0:36323, fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395, 10be946b-404d-46c2-a65d-dd614e82b8dc:0.0.0.0:46273], old=null at 1
2019-06-13 21:03:38,997 INFO  storage.RaftLogWorker (RaftLogWorker.java:rollLogSegment(303)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f-RaftLogWorker: Rolling segment log-0_0 to index:0
2019-06-13 21:03:38,997 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 10be946b-404d-46c2-a65d-dd614e82b8dc:group-24F987A0ADEA set configuration 1: [1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:0.0.0.0:36323, fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395, 10be946b-404d-46c2-a65d-dd614e82b8dc:0.0.0.0:46273], old=null at 1
2019-06-13 21:03:38,998 INFO  storage.RaftLogWorker (RaftLogWorker.java:rollLogSegment(303)) - 10be946b-404d-46c2-a65d-dd614e82b8dc-RaftLogWorker: Rolling segment log-0_0 to index:0
2019-06-13 21:03:39,016 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 10be946b-404d-46c2-a65d-dd614e82b8dc-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/10be946b-404d-46c2-a65d-dd614e82b8dc/448e59a9-9031-484f-813c-24f987a0adea/current/log_inprogress_0
2019-06-13 21:03:39,017 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(433)) - 10be946b-404d-46c2-a65d-dd614e82b8dc-RaftLogWorker: Rolled log segment from /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/10be946b-404d-46c2-a65d-dd614e82b8dc/448e59a9-9031-484f-813c-24f987a0adea/current/log_inprogress_0 to /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/10be946b-404d-46c2-a65d-dd614e82b8dc/448e59a9-9031-484f-813c-24f987a0adea/current/log_0-0
2019-06-13 21:03:39,054 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f/448e59a9-9031-484f-813c-24f987a0adea/current/log_inprogress_0
2019-06-13 21:03:39,055 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(433)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f-RaftLogWorker: Rolled log segment from /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f/448e59a9-9031-484f-813c-24f987a0adea/current/log_inprogress_0 to /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f/448e59a9-9031-484f-813c-24f987a0adea/current/log_0-0
2019-06-13 21:03:39,056 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 10be946b-404d-46c2-a65d-dd614e82b8dc-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/10be946b-404d-46c2-a65d-dd614e82b8dc/448e59a9-9031-484f-813c-24f987a0adea/current/log_inprogress_1
2019-06-13 21:03:39,099 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f/448e59a9-9031-484f-813c-24f987a0adea/current/log_inprogress_1
2019-06-13 21:03:39,739 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-0937BA5D6C18->10be946b-404d-46c2-a65d-dd614e82b8dc: receive RaftClientReply:client-0937BA5D6C18->10be946b-404d-46c2-a65d-dd614e82b8dc@group-24F987A0ADEA, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server 10be946b-404d-46c2-a65d-dd614e82b8dc is not the leader (fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395). Request must be sent to leader., logIndex=0, commits[10be946b-404d-46c2-a65d-dd614e82b8dc:c2, 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:c1, fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:c2]
2019-06-13 21:03:39,742 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 21:03:40,749 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-0937BA5D6C18->1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: receive RaftClientReply:client-0937BA5D6C18->1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f@group-24F987A0ADEA, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f is not the leader (fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395). Request must be sent to leader., logIndex=0, commits[1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:c2, fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:c2, 10be946b-404d-46c2-a65d-dd614e82b8dc:c2]
2019-06-13 21:03:40,751 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 21:03:41,762 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-0937BA5D6C18->10be946b-404d-46c2-a65d-dd614e82b8dc: receive RaftClientReply:client-0937BA5D6C18->10be946b-404d-46c2-a65d-dd614e82b8dc@group-24F987A0ADEA, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server 10be946b-404d-46c2-a65d-dd614e82b8dc is not the leader (fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:0.0.0.0:43395). Request must be sent to leader., logIndex=0, commits[10be946b-404d-46c2-a65d-dd614e82b8dc:c2, 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:c2, fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:c2]
2019-06-13 21:03:41,765 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 2-OrderedRequestStreamObserver2: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 21:03:42,776 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-13 21:03:42,783 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-0937BA5D6C18->fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: receive RaftClientReply:client-0937BA5D6C18->fe679b3a-33e0-4b43-a7b8-addcaa85e8cd@group-24F987A0ADEA, cid=6, SUCCESS, logIndex=3, commits[fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:c3, 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:c2, 10be946b-404d-46c2-a65d-dd614e82b8dc:c2]
2019-06-13 21:03:42,783 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-13 21:03:42,783 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-13 21:03:42,784 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-13 21:03:42,802 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-EF6705DA4299->fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: receive RaftClientReply:client-EF6705DA4299->fe679b3a-33e0-4b43-a7b8-addcaa85e8cd@group-24F987A0ADEA, cid=7, SUCCESS, logIndex=5, commits[fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:c5, 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:c4, 10be946b-404d-46c2-a65d-dd614e82b8dc:c4]
2019-06-13 21:03:42,806 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: close
2019-06-13 21:03:42,807 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: shutdown group-24F987A0ADEA
2019-06-13 21:03:42,808 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-24F987A0ADEA,id=fe679b3a-33e0-4b43-a7b8-addcaa85e8cd
2019-06-13 21:03:42,807 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 2-OrderedRequestStreamObserver2: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 21:03:42,808 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: shutdown LeaderState
2019-06-13 21:03:42,809 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(fe679b3a-33e0-4b43-a7b8-addcaa85e8cd -> 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f): Wait interrupted by java.lang.InterruptedException
2019-06-13 21:03:42,809 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(fe679b3a-33e0-4b43-a7b8-addcaa85e8cd -> 10be946b-404d-46c2-a65d-dd614e82b8dc): Wait interrupted by java.lang.InterruptedException
2019-06-13 21:03:42,809 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 10be946b-404d-46c2-a65d-dd614e82b8dc: appendEntries completed
2019-06-13 21:03:42,809 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd-PendingRequests: sendNotLeaderResponses
2019-06-13 21:03:42,810 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: appendEntries completed
2019-06-13 21:03:42,811 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: follower fe679b3a-33e0-4b43-a7b8-addcaa85e8cd->10be946b-404d-46c2-a65d-dd614e82b8dc(c5,m6,n7, attendVote=true, lastRpcSendTime=11, lastRpcResponseTime=2) response Completed
2019-06-13 21:03:42,811 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: follower fe679b3a-33e0-4b43-a7b8-addcaa85e8cd->1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f(c5,m6,n7, attendVote=true, lastRpcSendTime=11, lastRpcResponseTime=7) response Completed
2019-06-13 21:03:42,812 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd->10be946b-404d-46c2-a65d-dd614e82b8dc: nextIndex: updateUnconditionally 7 -> 0
2019-06-13 21:03:42,812 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd->1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: nextIndex: updateUnconditionally 7 -> 0
2019-06-13 21:03:42,815 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-fe679b3a-33e0-4b43-a7b8-addcaa85e8cd-group-24F987A0ADEA: set stopIndex = 6
2019-06-13 21:03:42,815 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:3, i:5)
2019-06-13 21:03:42,816 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/fe679b3a-33e0-4b43-a7b8-addcaa85e8cd/448e59a9-9031-484f-813c-24f987a0adea/sm/snapshot.3_5
2019-06-13 21:03:42,817 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd:group-24F987A0ADEA closes. The last applied log index is 6
2019-06-13 21:03:42,819 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd-RaftLogWorker close()
2019-06-13 21:03:42,820 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: shutdown server with port 43395 now
2019-06-13 21:03:42,822 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - fe679b3a-33e0-4b43-a7b8-addcaa85e8cd: shutdown server with port 43395 successfully
2019-06-13 21:03:42,824 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: close
2019-06-13 21:03:42,824 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: shutdown group-24F987A0ADEA
2019-06-13 21:03:42,824 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-24F987A0ADEA,id=1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f
2019-06-13 21:03:42,825 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: shutdown FollowerState
2019-06-13 21:03:42,840 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:3, i:5)
2019-06-13 21:03:42,840 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f-group-24F987A0ADEA: set stopIndex = 5
2019-06-13 21:03:42,840 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f/448e59a9-9031-484f-813c-24f987a0adea/sm/snapshot.3_5
2019-06-13 21:03:42,845 INFO  impl.FollowerState (FollowerState.java:run(109)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 21:03:42,846 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f:group-24F987A0ADEA closes. The last applied log index is 5
2019-06-13 21:03:42,850 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 21:03:42,858 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f-RaftLogWorker close()
2019-06-13 21:03:42,868 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: shutdown server with port 36323 now
2019-06-13 21:03:42,872 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 1700a6cc-1ffc-4a9c-a92c-bd9d41ba695f: shutdown server with port 36323 successfully
2019-06-13 21:03:42,875 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 10be946b-404d-46c2-a65d-dd614e82b8dc: close
2019-06-13 21:03:42,875 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 10be946b-404d-46c2-a65d-dd614e82b8dc: shutdown group-24F987A0ADEA
2019-06-13 21:03:42,875 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-24F987A0ADEA,id=10be946b-404d-46c2-a65d-dd614e82b8dc
2019-06-13 21:03:42,876 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 10be946b-404d-46c2-a65d-dd614e82b8dc: shutdown FollowerState
2019-06-13 21:03:42,876 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-10be946b-404d-46c2-a65d-dd614e82b8dc-group-24F987A0ADEA: set stopIndex = 5
2019-06-13 21:03:42,876 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:3, i:5)
2019-06-13 21:03:42,877 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/10be946b-404d-46c2-a65d-dd614e82b8dc/448e59a9-9031-484f-813c-24f987a0adea/sm/snapshot.3_5
2019-06-13 21:03:42,877 INFO  impl.FollowerState (FollowerState.java:run(109)) - 10be946b-404d-46c2-a65d-dd614e82b8dc: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 21:03:42,880 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 10be946b-404d-46c2-a65d-dd614e82b8dc:group-24F987A0ADEA closes. The last applied log index is 5
2019-06-13 21:03:42,881 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 10be946b-404d-46c2-a65d-dd614e82b8dc-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 21:03:42,882 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 10be946b-404d-46c2-a65d-dd614e82b8dc-RaftLogWorker close()
2019-06-13 21:03:42,884 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 10be946b-404d-46c2-a65d-dd614e82b8dc: shutdown server with port 46273 now
2019-06-13 21:03:42,885 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 10be946b-404d-46c2-a65d-dd614e82b8dc: shutdown server with port 46273 successfully
