2019-06-14 04:02:18,151 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler84d78b98-2877-4010-8283-6dc3e5210cc7/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 04:02:18,157 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler84d78b98-2877-4010-8283-6dc3e5210cc7/hdds to VolumeSet
2019-06-14 04:02:18,172 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-14 04:02:18,220 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-14 04:02:18,809 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 46027
2019-06-14 04:02:19,334 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 04:02:19,353 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 04:02:19,360 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 46027 (custom)
2019-06-14 04:02:19,361 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 04:02:19,362 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 04:02:19,363 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 04:02:19,364 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 04:02:19,480 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler84d78b98-2877-4010-8283-6dc3e5210cc7/ratis] (custom)
2019-06-14 04:02:19,489 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 46213
2019-06-14 04:02:19,508 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 04:02:19,508 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 04:02:19,509 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc at port 46027
2019-06-14 04:02:19,520 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc: start RPC server
2019-06-14 04:02:19,654 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc: GrpcService started, listening on 0.0.0.0/0.0.0.0:46027
2019-06-14 04:02:19,914 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc: addNew group-D759DA88A9D4:[f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc:127.0.0.1:46027] returns group-D759DA88A9D4:java.util.concurrent.CompletableFuture@2ec0ce8e[Not completed]
2019-06-14 04:02:19,942 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc: new RaftServerImpl for group-D759DA88A9D4:[f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc:127.0.0.1:46027] with ContainerStateMachine:uninitialized
2019-06-14 04:02:19,943 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 04:02:19,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 04:02:19,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 04:02:19,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 04:02:19,949 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc:group-D759DA88A9D4 ConfigurationManager, init=-1: [f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc:127.0.0.1:46027], old=null, confs=<EMPTY_MAP>
2019-06-14 04:02:19,949 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler84d78b98-2877-4010-8283-6dc3e5210cc7/ratis] (custom)
2019-06-14 04:02:19,956 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler84d78b98-2877-4010-8283-6dc3e5210cc7/ratis/67de6a73-aab0-4e5e-813d-d759da88a9d4 does not exist. Creating ...
2019-06-14 04:02:19,964 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler84d78b98-2877-4010-8283-6dc3e5210cc7/ratis/67de6a73-aab0-4e5e-813d-d759da88a9d4/in_use.lock acquired by nodename 4190@ozone-959hs-829180307
2019-06-14 04:02:19,971 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler84d78b98-2877-4010-8283-6dc3e5210cc7/ratis/67de6a73-aab0-4e5e-813d-d759da88a9d4 has been successfully formatted.
2019-06-14 04:02:19,973 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 04:02:19,974 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 04:02:19,975 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 04:02:19,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 04:02:19,980 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 04:02:19,984 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 04:02:19,986 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler84d78b98-2877-4010-8283-6dc3e5210cc7/ratis/67de6a73-aab0-4e5e-813d-d759da88a9d4
2019-06-14 04:02:19,986 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 04:02:19,987 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 04:02:19,989 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 04:02:19,989 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 04:02:19,989 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 04:02:19,990 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 04:02:19,990 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 04:02:19,991 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 04:02:19,991 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 04:02:19,993 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 04:02:19,998 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 04:02:19,998 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 04:02:19,999 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 04:02:20,097 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc: start group-D759DA88A9D4
2019-06-14 04:02:20,098 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc:group-D759DA88A9D4 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 04:02:20,099 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc: start FollowerState
2019-06-14 04:02:20,101 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D759DA88A9D4,id=f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc
2019-06-14 04:02:21,208 INFO  impl.FollowerState (FollowerState.java:run(101)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc:group-D759DA88A9D4 changes to CANDIDATE, lastRpcTime:1109, electionTimeout:1108ms
2019-06-14 04:02:21,208 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc: shutdown FollowerState
2019-06-14 04:02:21,208 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc:group-D759DA88A9D4 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 04:02:21,210 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc: start LeaderElection
2019-06-14 04:02:21,213 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc:group-D759DA88A9D4:LeaderElection1: begin an election at term 1 for -1: [f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc:127.0.0.1:46027], old=null
2019-06-14 04:02:21,214 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc: shutdown LeaderElection
2019-06-14 04:02:21,215 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc:group-D759DA88A9D4 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 04:02:21,215 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc:group-D759DA88A9D4 change Leader from null to f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc at term 1 for becomeLeader, leader elected after 1241ms
2019-06-14 04:02:21,219 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 04:02:21,219 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 04:02:21,222 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 04:02:21,222 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 04:02:21,231 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc: start LeaderState
2019-06-14 04:02:21,247 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc-RaftLogWorker: Starting segment from index:0
2019-06-14 04:02:21,264 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc:group-D759DA88A9D4 set configuration 0: [f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc:127.0.0.1:46027], old=null at 0
2019-06-14 04:02:21,397 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler84d78b98-2877-4010-8283-6dc3e5210cc7/ratis/67de6a73-aab0-4e5e-813d-d759da88a9d4/current/log_inprogress_0
2019-06-14 04:02:22,362 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-14 04:02:22,449 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 8908773752445638358 is closed with bcsId 0.
2019-06-14 04:02:22,450 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 04:02:22,451 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc: close
2019-06-14 04:02:22,453 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc: shutdown group-D759DA88A9D4
2019-06-14 04:02:22,454 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D759DA88A9D4,id=f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc
2019-06-14 04:02:22,454 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc: shutdown LeaderState
2019-06-14 04:02:22,455 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc-PendingRequests: sendNotLeaderResponses
2019-06-14 04:02:22,458 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc-group-D759DA88A9D4: set stopIndex = 4
2019-06-14 04:02:22,458 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-14 04:02:22,458 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler84d78b98-2877-4010-8283-6dc3e5210cc7/ratis/67de6a73-aab0-4e5e-813d-d759da88a9d4/sm/snapshot.1_4
2019-06-14 04:02:22,468 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc:group-D759DA88A9D4 closes. The last applied log index is 4
2019-06-14 04:02:22,470 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 04:02:22,475 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc-RaftLogWorker close()
2019-06-14 04:02:22,477 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc: shutdown server with port 46027 now
2019-06-14 04:02:22,485 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - f2c70f8b-98f3-4e9d-b25f-40c1ff1c78cc: shutdown server with port 46027 successfully
2019-06-14 04:02:22,508 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 04:02:22,550 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera75ffb44-cc8b-4e19-98ed-59cbb5c378ba/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 04:02:22,550 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera75ffb44-cc8b-4e19-98ed-59cbb5c378ba/hdds to VolumeSet
2019-06-14 04:02:22,550 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@6f0cb5a1
2019-06-14 04:02:22,558 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@6f0cb5a1
2019-06-14 04:02:22,582 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 34831
2019-06-14 04:02:22,582 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 04:02:22,583 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 04:02:22,583 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 34831 (custom)
2019-06-14 04:02:22,584 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 04:02:22,584 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 04:02:22,584 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 04:02:22,584 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 04:02:22,589 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera75ffb44-cc8b-4e19-98ed-59cbb5c378ba/ratis] (custom)
2019-06-14 04:02:22,589 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 44235
2019-06-14 04:02:22,590 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 04:02:22,590 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 04:02:22,590 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis c7e3c4fb-cae5-436b-b4d0-1409be4db492 at port 34831
2019-06-14 04:02:22,605 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492: start RPC server
2019-06-14 04:02:22,613 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492: GrpcService started, listening on 0.0.0.0/0.0.0.0:34831
2019-06-14 04:02:22,633 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492: addNew group-CC4C06C86BE3:[c7e3c4fb-cae5-436b-b4d0-1409be4db492:127.0.0.1:34831] returns group-CC4C06C86BE3:java.util.concurrent.CompletableFuture@ab5dbd1[Not completed]
2019-06-14 04:02:22,634 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492: new RaftServerImpl for group-CC4C06C86BE3:[c7e3c4fb-cae5-436b-b4d0-1409be4db492:127.0.0.1:34831] with ContainerStateMachine:uninitialized
2019-06-14 04:02:22,634 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 04:02:22,634 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 04:02:22,634 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 04:02:22,635 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 04:02:22,635 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492:group-CC4C06C86BE3 ConfigurationManager, init=-1: [c7e3c4fb-cae5-436b-b4d0-1409be4db492:127.0.0.1:34831], old=null, confs=<EMPTY_MAP>
2019-06-14 04:02:22,635 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera75ffb44-cc8b-4e19-98ed-59cbb5c378ba/ratis] (custom)
2019-06-14 04:02:22,635 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera75ffb44-cc8b-4e19-98ed-59cbb5c378ba/ratis/26e4992a-3ba8-4cab-85de-cc4c06c86be3 does not exist. Creating ...
2019-06-14 04:02:22,638 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera75ffb44-cc8b-4e19-98ed-59cbb5c378ba/ratis/26e4992a-3ba8-4cab-85de-cc4c06c86be3/in_use.lock acquired by nodename 4190@ozone-959hs-829180307
2019-06-14 04:02:22,640 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera75ffb44-cc8b-4e19-98ed-59cbb5c378ba/ratis/26e4992a-3ba8-4cab-85de-cc4c06c86be3 has been successfully formatted.
2019-06-14 04:02:22,640 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 04:02:22,640 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 04:02:22,641 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 04:02:22,641 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 04:02:22,641 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 04:02:22,641 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 04:02:22,641 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new c7e3c4fb-cae5-436b-b4d0-1409be4db492-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera75ffb44-cc8b-4e19-98ed-59cbb5c378ba/ratis/26e4992a-3ba8-4cab-85de-cc4c06c86be3
2019-06-14 04:02:22,641 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 04:02:22,641 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 04:02:22,642 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 04:02:22,642 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 04:02:22,642 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 04:02:22,642 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 04:02:22,642 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 04:02:22,642 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 04:02:22,642 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 04:02:22,643 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 04:02:22,643 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 04:02:22,643 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 04:02:22,644 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 04:02:22,644 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492: start group-CC4C06C86BE3
2019-06-14 04:02:22,644 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492:group-CC4C06C86BE3 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 04:02:22,644 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492: start FollowerState
2019-06-14 04:02:22,645 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-CC4C06C86BE3,id=c7e3c4fb-cae5-436b-b4d0-1409be4db492
2019-06-14 04:02:23,674 INFO  impl.FollowerState (FollowerState.java:run(101)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492:group-CC4C06C86BE3 changes to CANDIDATE, lastRpcTime:1029, electionTimeout:1029ms
2019-06-14 04:02:23,674 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492: shutdown FollowerState
2019-06-14 04:02:23,674 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492:group-CC4C06C86BE3 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 04:02:23,674 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492: start LeaderElection
2019-06-14 04:02:23,678 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492:group-CC4C06C86BE3:LeaderElection2: begin an election at term 1 for -1: [c7e3c4fb-cae5-436b-b4d0-1409be4db492:127.0.0.1:34831], old=null
2019-06-14 04:02:23,679 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492: shutdown LeaderElection
2019-06-14 04:02:23,679 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492:group-CC4C06C86BE3 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 04:02:23,679 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492:group-CC4C06C86BE3 change Leader from null to c7e3c4fb-cae5-436b-b4d0-1409be4db492 at term 1 for becomeLeader, leader elected after 1038ms
2019-06-14 04:02:23,679 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 04:02:23,679 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 04:02:23,680 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 04:02:23,680 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 04:02:23,680 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492: start LeaderState
2019-06-14 04:02:23,680 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492-RaftLogWorker: Starting segment from index:0
2019-06-14 04:02:23,681 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492:group-CC4C06C86BE3 set configuration 0: [c7e3c4fb-cae5-436b-b4d0-1409be4db492:127.0.0.1:34831], old=null at 0
2019-06-14 04:02:23,723 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera75ffb44-cc8b-4e19-98ed-59cbb5c378ba/ratis/26e4992a-3ba8-4cab-85de-cc4c06c86be3/current/log_inprogress_0
2019-06-14 04:02:24,678 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 04:02:24,679 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492: close
2019-06-14 04:02:24,679 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492: shutdown group-CC4C06C86BE3
2019-06-14 04:02:24,679 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-CC4C06C86BE3,id=c7e3c4fb-cae5-436b-b4d0-1409be4db492
2019-06-14 04:02:24,680 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492: shutdown LeaderState
2019-06-14 04:02:24,680 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492-PendingRequests: sendNotLeaderResponses
2019-06-14 04:02:24,681 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-c7e3c4fb-cae5-436b-b4d0-1409be4db492-group-CC4C06C86BE3: set stopIndex = 2
2019-06-14 04:02:24,681 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-14 04:02:24,681 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera75ffb44-cc8b-4e19-98ed-59cbb5c378ba/ratis/26e4992a-3ba8-4cab-85de-cc4c06c86be3/sm/snapshot.1_2
2019-06-14 04:02:24,682 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492:group-CC4C06C86BE3 closes. The last applied log index is 2
2019-06-14 04:02:24,682 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 04:02:24,683 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492-RaftLogWorker close()
2019-06-14 04:02:24,684 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492: shutdown server with port 34831 now
2019-06-14 04:02:24,685 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - c7e3c4fb-cae5-436b-b4d0-1409be4db492: shutdown server with port 34831 successfully
2019-06-14 04:02:24,690 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 04:02:24,716 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1813284f-1cbc-478d-bee8-067d7a9a336e/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 04:02:24,717 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1813284f-1cbc-478d-bee8-067d7a9a336e/hdds to VolumeSet
2019-06-14 04:02:24,717 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@5e2f3be5
2019-06-14 04:02:24,721 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@5e2f3be5
2019-06-14 04:02:24,735 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 42569
2019-06-14 04:02:24,736 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 04:02:24,736 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 04:02:24,737 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42569 (custom)
2019-06-14 04:02:24,737 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 04:02:24,737 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 04:02:24,737 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 04:02:24,738 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 04:02:24,738 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1813284f-1cbc-478d-bee8-067d7a9a336e/ratis] (custom)
2019-06-14 04:02:24,739 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 46713
2019-06-14 04:02:24,739 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 04:02:24,739 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 04:02:24,739 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 1bb22d82-5b05-43f4-aafc-21aab85107a6 at port 42569
2019-06-14 04:02:24,752 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6: start RPC server
2019-06-14 04:02:24,753 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6: GrpcService started, listening on 0.0.0.0/0.0.0.0:42569
2019-06-14 04:02:24,765 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6: addNew group-70C80C4504A0:[1bb22d82-5b05-43f4-aafc-21aab85107a6:127.0.0.1:42569] returns group-70C80C4504A0:java.util.concurrent.CompletableFuture@6a986cdc[Not completed]
2019-06-14 04:02:24,766 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6: new RaftServerImpl for group-70C80C4504A0:[1bb22d82-5b05-43f4-aafc-21aab85107a6:127.0.0.1:42569] with ContainerStateMachine:uninitialized
2019-06-14 04:02:24,766 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 04:02:24,766 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 04:02:24,767 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 04:02:24,767 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 04:02:24,767 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6:group-70C80C4504A0 ConfigurationManager, init=-1: [1bb22d82-5b05-43f4-aafc-21aab85107a6:127.0.0.1:42569], old=null, confs=<EMPTY_MAP>
2019-06-14 04:02:24,767 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1813284f-1cbc-478d-bee8-067d7a9a336e/ratis] (custom)
2019-06-14 04:02:24,767 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1813284f-1cbc-478d-bee8-067d7a9a336e/ratis/0c78852b-a457-4fac-ade6-70c80c4504a0 does not exist. Creating ...
2019-06-14 04:02:24,772 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1813284f-1cbc-478d-bee8-067d7a9a336e/ratis/0c78852b-a457-4fac-ade6-70c80c4504a0/in_use.lock acquired by nodename 4190@ozone-959hs-829180307
2019-06-14 04:02:24,775 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1813284f-1cbc-478d-bee8-067d7a9a336e/ratis/0c78852b-a457-4fac-ade6-70c80c4504a0 has been successfully formatted.
2019-06-14 04:02:24,775 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 04:02:24,775 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 04:02:24,775 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 04:02:24,775 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 04:02:24,775 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 04:02:24,776 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 04:02:24,776 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 1bb22d82-5b05-43f4-aafc-21aab85107a6-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1813284f-1cbc-478d-bee8-067d7a9a336e/ratis/0c78852b-a457-4fac-ade6-70c80c4504a0
2019-06-14 04:02:24,776 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 04:02:24,776 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 04:02:24,776 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 04:02:24,776 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 04:02:24,776 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 04:02:24,776 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 04:02:24,776 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 04:02:24,776 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 04:02:24,776 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 04:02:24,776 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 04:02:24,777 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 04:02:24,777 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 04:02:24,777 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 04:02:24,777 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6: start group-70C80C4504A0
2019-06-14 04:02:24,777 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6:group-70C80C4504A0 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 04:02:24,778 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6: start FollowerState
2019-06-14 04:02:24,778 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-70C80C4504A0,id=1bb22d82-5b05-43f4-aafc-21aab85107a6
2019-06-14 04:02:25,955 INFO  impl.FollowerState (FollowerState.java:run(101)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6:group-70C80C4504A0 changes to CANDIDATE, lastRpcTime:1177, electionTimeout:1177ms
2019-06-14 04:02:25,955 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6: shutdown FollowerState
2019-06-14 04:02:25,955 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6:group-70C80C4504A0 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 04:02:25,955 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6: start LeaderElection
2019-06-14 04:02:25,959 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6:group-70C80C4504A0:LeaderElection3: begin an election at term 1 for -1: [1bb22d82-5b05-43f4-aafc-21aab85107a6:127.0.0.1:42569], old=null
2019-06-14 04:02:25,959 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6: shutdown LeaderElection
2019-06-14 04:02:25,960 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6:group-70C80C4504A0 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 04:02:25,960 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6:group-70C80C4504A0 change Leader from null to 1bb22d82-5b05-43f4-aafc-21aab85107a6 at term 1 for becomeLeader, leader elected after 1184ms
2019-06-14 04:02:25,960 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 04:02:25,960 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 04:02:25,960 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 04:02:25,960 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 04:02:25,961 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6: start LeaderState
2019-06-14 04:02:25,961 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6-RaftLogWorker: Starting segment from index:0
2019-06-14 04:02:25,963 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6:group-70C80C4504A0 set configuration 0: [1bb22d82-5b05-43f4-aafc-21aab85107a6:127.0.0.1:42569], old=null at 0
2019-06-14 04:02:26,005 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1813284f-1cbc-478d-bee8-067d7a9a336e/ratis/0c78852b-a457-4fac-ade6-70c80c4504a0/current/log_inprogress_0
2019-06-14 04:02:26,834 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 1431146871317063197 is closed with bcsId 0.
2019-06-14 04:02:26,835 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 04:02:26,836 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6: close
2019-06-14 04:02:26,836 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6: shutdown group-70C80C4504A0
2019-06-14 04:02:26,837 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-70C80C4504A0,id=1bb22d82-5b05-43f4-aafc-21aab85107a6
2019-06-14 04:02:26,837 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6: shutdown LeaderState
2019-06-14 04:02:26,838 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6-PendingRequests: sendNotLeaderResponses
2019-06-14 04:02:26,839 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-1bb22d82-5b05-43f4-aafc-21aab85107a6-group-70C80C4504A0: set stopIndex = 2
2019-06-14 04:02:26,839 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-14 04:02:26,839 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1813284f-1cbc-478d-bee8-067d7a9a336e/ratis/0c78852b-a457-4fac-ade6-70c80c4504a0/sm/snapshot.1_2
2019-06-14 04:02:26,839 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6:group-70C80C4504A0 closes. The last applied log index is 2
2019-06-14 04:02:26,840 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 04:02:26,841 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6-RaftLogWorker close()
2019-06-14 04:02:26,844 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6: shutdown server with port 42569 now
2019-06-14 04:02:26,849 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 1bb22d82-5b05-43f4-aafc-21aab85107a6: shutdown server with port 42569 successfully
2019-06-14 04:02:26,876 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 04:02:26,914 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler27ada852-05fd-4dea-bc9f-be25fe6d4b8d/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 04:02:26,915 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler27ada852-05fd-4dea-bc9f-be25fe6d4b8d/hdds to VolumeSet
2019-06-14 04:02:26,915 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@7c84195
2019-06-14 04:02:26,916 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@7c84195
2019-06-14 04:02:26,930 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 35019
2019-06-14 04:02:26,931 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 04:02:26,932 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 04:02:26,932 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 35019 (custom)
2019-06-14 04:02:26,932 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 04:02:26,933 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 04:02:26,933 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 04:02:26,933 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 04:02:26,935 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler27ada852-05fd-4dea-bc9f-be25fe6d4b8d/ratis] (custom)
2019-06-14 04:02:26,935 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 44579
2019-06-14 04:02:26,936 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 04:02:26,936 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 04:02:26,936 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 3540c599-f2f8-4ff7-b5a7-df69d2f2a589 at port 35019
2019-06-14 04:02:26,965 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589: start RPC server
2019-06-14 04:02:26,968 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589: GrpcService started, listening on 0.0.0.0/0.0.0.0:35019
Jun 14, 2019 4:02:26 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:42569} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 14, 2019 4:02:26 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:34831} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-14 04:02:26,991 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589: addNew group-D3F8D0D396EE:[3540c599-f2f8-4ff7-b5a7-df69d2f2a589:127.0.0.1:35019] returns group-D3F8D0D396EE:java.util.concurrent.CompletableFuture@3adb7e86[Not completed]
2019-06-14 04:02:26,998 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589: new RaftServerImpl for group-D3F8D0D396EE:[3540c599-f2f8-4ff7-b5a7-df69d2f2a589:127.0.0.1:35019] with ContainerStateMachine:uninitialized
2019-06-14 04:02:26,998 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 04:02:26,998 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 04:02:26,999 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 04:02:26,999 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 04:02:26,999 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589:group-D3F8D0D396EE ConfigurationManager, init=-1: [3540c599-f2f8-4ff7-b5a7-df69d2f2a589:127.0.0.1:35019], old=null, confs=<EMPTY_MAP>
2019-06-14 04:02:26,999 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler27ada852-05fd-4dea-bc9f-be25fe6d4b8d/ratis] (custom)
2019-06-14 04:02:26,999 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler27ada852-05fd-4dea-bc9f-be25fe6d4b8d/ratis/824d126a-9539-4e88-9796-d3f8d0d396ee does not exist. Creating ...
2019-06-14 04:02:27,003 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler27ada852-05fd-4dea-bc9f-be25fe6d4b8d/ratis/824d126a-9539-4e88-9796-d3f8d0d396ee/in_use.lock acquired by nodename 4190@ozone-959hs-829180307
2019-06-14 04:02:27,006 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler27ada852-05fd-4dea-bc9f-be25fe6d4b8d/ratis/824d126a-9539-4e88-9796-d3f8d0d396ee has been successfully formatted.
2019-06-14 04:02:27,007 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 04:02:27,007 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 04:02:27,007 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 04:02:27,007 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 04:02:27,007 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 04:02:27,007 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 04:02:27,008 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 3540c599-f2f8-4ff7-b5a7-df69d2f2a589-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler27ada852-05fd-4dea-bc9f-be25fe6d4b8d/ratis/824d126a-9539-4e88-9796-d3f8d0d396ee
2019-06-14 04:02:27,008 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 04:02:27,008 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 04:02:27,008 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 04:02:27,008 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 04:02:27,008 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 04:02:27,008 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 04:02:27,008 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 04:02:27,009 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 04:02:27,009 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 04:02:27,009 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 04:02:27,009 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 04:02:27,009 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 04:02:27,010 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 04:02:27,010 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589: start group-D3F8D0D396EE
2019-06-14 04:02:27,010 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589:group-D3F8D0D396EE changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 04:02:27,010 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589: start FollowerState
2019-06-14 04:02:27,012 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D3F8D0D396EE,id=3540c599-f2f8-4ff7-b5a7-df69d2f2a589
2019-06-14 04:02:28,191 INFO  impl.FollowerState (FollowerState.java:run(101)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589:group-D3F8D0D396EE changes to CANDIDATE, lastRpcTime:1181, electionTimeout:1180ms
2019-06-14 04:02:28,192 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589: shutdown FollowerState
2019-06-14 04:02:28,192 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589:group-D3F8D0D396EE changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 04:02:28,192 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589: start LeaderElection
2019-06-14 04:02:28,196 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589:group-D3F8D0D396EE:LeaderElection4: begin an election at term 1 for -1: [3540c599-f2f8-4ff7-b5a7-df69d2f2a589:127.0.0.1:35019], old=null
2019-06-14 04:02:28,196 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589: shutdown LeaderElection
2019-06-14 04:02:28,197 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589:group-D3F8D0D396EE changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 04:02:28,197 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589:group-D3F8D0D396EE change Leader from null to 3540c599-f2f8-4ff7-b5a7-df69d2f2a589 at term 1 for becomeLeader, leader elected after 1189ms
2019-06-14 04:02:28,197 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 04:02:28,197 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 04:02:28,197 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 04:02:28,197 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 04:02:28,198 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589: start LeaderState
2019-06-14 04:02:28,198 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589-RaftLogWorker: Starting segment from index:0
2019-06-14 04:02:28,210 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589:group-D3F8D0D396EE set configuration 0: [3540c599-f2f8-4ff7-b5a7-df69d2f2a589:127.0.0.1:35019], old=null at 0
2019-06-14 04:02:28,261 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler27ada852-05fd-4dea-bc9f-be25fe6d4b8d/ratis/824d126a-9539-4e88-9796-d3f8d0d396ee/current/log_inprogress_0
2019-06-14 04:02:29,077 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 4633226285926522995 is closed with bcsId 0.
2019-06-14 04:02:29,078 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 04:02:29,078 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589: close
2019-06-14 04:02:29,078 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589: shutdown group-D3F8D0D396EE
2019-06-14 04:02:29,079 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D3F8D0D396EE,id=3540c599-f2f8-4ff7-b5a7-df69d2f2a589
2019-06-14 04:02:29,079 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589: shutdown LeaderState
2019-06-14 04:02:29,079 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589-PendingRequests: sendNotLeaderResponses
2019-06-14 04:02:29,080 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-3540c599-f2f8-4ff7-b5a7-df69d2f2a589-group-D3F8D0D396EE: set stopIndex = 2
2019-06-14 04:02:29,081 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-14 04:02:29,081 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler27ada852-05fd-4dea-bc9f-be25fe6d4b8d/ratis/824d126a-9539-4e88-9796-d3f8d0d396ee/sm/snapshot.1_2
2019-06-14 04:02:29,082 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589:group-D3F8D0D396EE closes. The last applied log index is 2
2019-06-14 04:02:29,082 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 04:02:29,082 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589-RaftLogWorker close()
2019-06-14 04:02:29,083 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589: shutdown server with port 35019 now
2019-06-14 04:02:29,085 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 3540c599-f2f8-4ff7-b5a7-df69d2f2a589: shutdown server with port 35019 successfully
2019-06-14 04:02:29,089 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 04:02:29,111 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerac52ba2d-b023-4719-8590-22f25cd9c71b/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 04:02:29,111 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerac52ba2d-b023-4719-8590-22f25cd9c71b/hdds to VolumeSet
2019-06-14 04:02:29,112 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@43f61afb
2019-06-14 04:02:29,112 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@43f61afb
2019-06-14 04:02:29,123 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 46391
2019-06-14 04:02:29,124 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 04:02:29,124 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 04:02:29,125 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 46391 (custom)
2019-06-14 04:02:29,125 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 04:02:29,125 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 04:02:29,125 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 04:02:29,125 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 04:02:29,126 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerac52ba2d-b023-4719-8590-22f25cd9c71b/ratis] (custom)
2019-06-14 04:02:29,126 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 36163
2019-06-14 04:02:29,127 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 04:02:29,127 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 04:02:29,127 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 3e436b2b-87d5-413e-924f-1f6eb060ba13 at port 46391
2019-06-14 04:02:29,135 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13: start RPC server
2019-06-14 04:02:29,138 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13: GrpcService started, listening on 0.0.0.0/0.0.0.0:46391
2019-06-14 04:02:29,158 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13: addNew group-667A0C21710E:[3e436b2b-87d5-413e-924f-1f6eb060ba13:127.0.0.1:46391] returns group-667A0C21710E:java.util.concurrent.CompletableFuture@1164cd22[Not completed]
2019-06-14 04:02:29,163 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13: new RaftServerImpl for group-667A0C21710E:[3e436b2b-87d5-413e-924f-1f6eb060ba13:127.0.0.1:46391] with ContainerStateMachine:uninitialized
2019-06-14 04:02:29,164 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 04:02:29,165 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 04:02:29,165 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 04:02:29,165 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 04:02:29,165 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13:group-667A0C21710E ConfigurationManager, init=-1: [3e436b2b-87d5-413e-924f-1f6eb060ba13:127.0.0.1:46391], old=null, confs=<EMPTY_MAP>
2019-06-14 04:02:29,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerac52ba2d-b023-4719-8590-22f25cd9c71b/ratis] (custom)
2019-06-14 04:02:29,166 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerac52ba2d-b023-4719-8590-22f25cd9c71b/ratis/9e7ee0a2-5ee3-456b-b811-667a0c21710e does not exist. Creating ...
2019-06-14 04:02:29,171 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerac52ba2d-b023-4719-8590-22f25cd9c71b/ratis/9e7ee0a2-5ee3-456b-b811-667a0c21710e/in_use.lock acquired by nodename 4190@ozone-959hs-829180307
2019-06-14 04:02:29,173 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerac52ba2d-b023-4719-8590-22f25cd9c71b/ratis/9e7ee0a2-5ee3-456b-b811-667a0c21710e has been successfully formatted.
2019-06-14 04:02:29,174 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 04:02:29,174 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 04:02:29,174 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 04:02:29,174 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 04:02:29,174 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 04:02:29,174 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 04:02:29,175 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 3e436b2b-87d5-413e-924f-1f6eb060ba13-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerac52ba2d-b023-4719-8590-22f25cd9c71b/ratis/9e7ee0a2-5ee3-456b-b811-667a0c21710e
2019-06-14 04:02:29,175 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 04:02:29,175 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 04:02:29,175 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 04:02:29,186 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 04:02:29,187 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 04:02:29,187 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 04:02:29,187 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 04:02:29,187 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 04:02:29,187 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 04:02:29,188 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 04:02:29,189 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 04:02:29,189 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 04:02:29,189 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 04:02:29,190 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13: start group-667A0C21710E
2019-06-14 04:02:29,191 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13:group-667A0C21710E changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 04:02:29,197 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13: start FollowerState
2019-06-14 04:02:29,198 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-667A0C21710E,id=3e436b2b-87d5-413e-924f-1f6eb060ba13
2019-06-14 04:02:30,316 INFO  impl.FollowerState (FollowerState.java:run(101)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13:group-667A0C21710E changes to CANDIDATE, lastRpcTime:1118, electionTimeout:1118ms
2019-06-14 04:02:30,316 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13: shutdown FollowerState
2019-06-14 04:02:30,316 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13:group-667A0C21710E changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 04:02:30,316 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13: start LeaderElection
2019-06-14 04:02:30,323 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13:group-667A0C21710E:LeaderElection5: begin an election at term 1 for -1: [3e436b2b-87d5-413e-924f-1f6eb060ba13:127.0.0.1:46391], old=null
2019-06-14 04:02:30,323 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13: shutdown LeaderElection
2019-06-14 04:02:30,323 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13:group-667A0C21710E changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 04:02:30,323 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13:group-667A0C21710E change Leader from null to 3e436b2b-87d5-413e-924f-1f6eb060ba13 at term 1 for becomeLeader, leader elected after 1149ms
2019-06-14 04:02:30,324 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 04:02:30,324 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 04:02:30,324 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 04:02:30,324 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 04:02:30,324 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13: start LeaderState
2019-06-14 04:02:30,325 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13-RaftLogWorker: Starting segment from index:0
2019-06-14 04:02:30,330 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13:group-667A0C21710E set configuration 0: [3e436b2b-87d5-413e-924f-1f6eb060ba13:127.0.0.1:46391], old=null at 0
2019-06-14 04:02:30,369 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerac52ba2d-b023-4719-8590-22f25cd9c71b/ratis/9e7ee0a2-5ee3-456b-b811-667a0c21710e/current/log_inprogress_0
2019-06-14 04:02:31,251 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 127821006865366203 is closed with bcsId 0.
2019-06-14 04:02:31,252 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 04:02:31,252 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13: close
2019-06-14 04:02:31,252 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13: shutdown group-667A0C21710E
2019-06-14 04:02:31,253 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-667A0C21710E,id=3e436b2b-87d5-413e-924f-1f6eb060ba13
2019-06-14 04:02:31,253 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13: shutdown LeaderState
2019-06-14 04:02:31,253 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13-PendingRequests: sendNotLeaderResponses
2019-06-14 04:02:31,255 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-3e436b2b-87d5-413e-924f-1f6eb060ba13-group-667A0C21710E: set stopIndex = 4
2019-06-14 04:02:31,255 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-14 04:02:31,255 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerac52ba2d-b023-4719-8590-22f25cd9c71b/ratis/9e7ee0a2-5ee3-456b-b811-667a0c21710e/sm/snapshot.1_4
2019-06-14 04:02:31,255 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13:group-667A0C21710E closes. The last applied log index is 4
2019-06-14 04:02:31,256 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 04:02:31,257 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13-RaftLogWorker close()
2019-06-14 04:02:31,258 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13: shutdown server with port 46391 now
2019-06-14 04:02:31,259 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 3e436b2b-87d5-413e-924f-1f6eb060ba13: shutdown server with port 46391 successfully
2019-06-14 04:02:31,263 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
