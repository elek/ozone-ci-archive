2019-06-14 00:42:29,677 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler889c0df5-afe5-46d4-b0e5-309f883a27f8/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 00:42:29,681 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler889c0df5-afe5-46d4-b0e5-309f883a27f8/hdds to VolumeSet
2019-06-14 00:42:29,691 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-14 00:42:29,718 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-14 00:42:30,088 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 39083
2019-06-14 00:42:30,478 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 00:42:30,501 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 00:42:30,509 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 39083 (custom)
2019-06-14 00:42:30,510 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 00:42:30,512 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 00:42:30,513 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 00:42:30,514 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 00:42:30,638 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler889c0df5-afe5-46d4-b0e5-309f883a27f8/ratis] (custom)
2019-06-14 00:42:30,647 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 45407
2019-06-14 00:42:30,666 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 00:42:30,666 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 00:42:30,667 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea at port 39083
2019-06-14 00:42:30,683 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea: start RPC server
2019-06-14 00:42:30,810 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea: GrpcService started, listening on 0.0.0.0/0.0.0.0:39083
2019-06-14 00:42:31,111 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea: addNew group-1A0E7CF8E628:[7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea:127.0.0.1:39083] returns group-1A0E7CF8E628:java.util.concurrent.CompletableFuture@3d7c71d2[Not completed]
2019-06-14 00:42:31,137 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea: new RaftServerImpl for group-1A0E7CF8E628:[7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea:127.0.0.1:39083] with ContainerStateMachine:uninitialized
2019-06-14 00:42:31,138 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 00:42:31,138 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 00:42:31,138 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 00:42:31,139 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 00:42:31,143 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea:group-1A0E7CF8E628 ConfigurationManager, init=-1: [7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea:127.0.0.1:39083], old=null, confs=<EMPTY_MAP>
2019-06-14 00:42:31,144 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler889c0df5-afe5-46d4-b0e5-309f883a27f8/ratis] (custom)
2019-06-14 00:42:31,149 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler889c0df5-afe5-46d4-b0e5-309f883a27f8/ratis/8030f4f3-84a5-443c-b616-1a0e7cf8e628 does not exist. Creating ...
2019-06-14 00:42:31,156 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler889c0df5-afe5-46d4-b0e5-309f883a27f8/ratis/8030f4f3-84a5-443c-b616-1a0e7cf8e628/in_use.lock acquired by nodename 4187@ozone-z78dj-92495746
2019-06-14 00:42:31,162 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler889c0df5-afe5-46d4-b0e5-309f883a27f8/ratis/8030f4f3-84a5-443c-b616-1a0e7cf8e628 has been successfully formatted.
2019-06-14 00:42:31,164 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 00:42:31,164 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 00:42:31,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 00:42:31,167 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 00:42:31,170 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 00:42:31,174 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 00:42:31,177 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler889c0df5-afe5-46d4-b0e5-309f883a27f8/ratis/8030f4f3-84a5-443c-b616-1a0e7cf8e628
2019-06-14 00:42:31,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 00:42:31,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 00:42:31,180 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 00:42:31,181 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 00:42:31,181 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 00:42:31,181 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 00:42:31,182 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 00:42:31,182 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 00:42:31,183 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 00:42:31,185 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 00:42:31,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 00:42:31,192 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 00:42:31,192 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 00:42:31,279 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea: start group-1A0E7CF8E628
2019-06-14 00:42:31,280 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea:group-1A0E7CF8E628 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 00:42:31,281 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea: start FollowerState
2019-06-14 00:42:31,283 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-1A0E7CF8E628,id=7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea
2019-06-14 00:42:32,404 INFO  impl.FollowerState (FollowerState.java:run(101)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea:group-1A0E7CF8E628 changes to CANDIDATE, lastRpcTime:1122, electionTimeout:1122ms
2019-06-14 00:42:32,404 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea: shutdown FollowerState
2019-06-14 00:42:32,404 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea:group-1A0E7CF8E628 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 00:42:32,406 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea: start LeaderElection
2019-06-14 00:42:32,409 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea:group-1A0E7CF8E628:LeaderElection1: begin an election at term 1 for -1: [7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea:127.0.0.1:39083], old=null
2019-06-14 00:42:32,410 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea: shutdown LeaderElection
2019-06-14 00:42:32,410 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea:group-1A0E7CF8E628 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 00:42:32,410 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea:group-1A0E7CF8E628 change Leader from null to 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea at term 1 for becomeLeader, leader elected after 1246ms
2019-06-14 00:42:32,414 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 00:42:32,414 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 00:42:32,416 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 00:42:32,416 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 00:42:32,423 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea: start LeaderState
2019-06-14 00:42:32,434 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea-RaftLogWorker: Starting segment from index:0
2019-06-14 00:42:32,442 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea:group-1A0E7CF8E628 set configuration 0: [7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea:127.0.0.1:39083], old=null at 0
2019-06-14 00:42:32,566 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler889c0df5-afe5-46d4-b0e5-309f883a27f8/ratis/8030f4f3-84a5-443c-b616-1a0e7cf8e628/current/log_inprogress_0
2019-06-14 00:42:33,503 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-14 00:42:33,557 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 5701748349233591489 is closed with bcsId 0.
2019-06-14 00:42:33,558 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 00:42:33,559 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea: close
2019-06-14 00:42:33,560 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea: shutdown group-1A0E7CF8E628
2019-06-14 00:42:33,560 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-1A0E7CF8E628,id=7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea
2019-06-14 00:42:33,561 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea: shutdown LeaderState
2019-06-14 00:42:33,561 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea-PendingRequests: sendNotLeaderResponses
2019-06-14 00:42:33,563 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea-group-1A0E7CF8E628: set stopIndex = 4
2019-06-14 00:42:33,563 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-14 00:42:33,563 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler889c0df5-afe5-46d4-b0e5-309f883a27f8/ratis/8030f4f3-84a5-443c-b616-1a0e7cf8e628/sm/snapshot.1_4
2019-06-14 00:42:33,572 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea:group-1A0E7CF8E628 closes. The last applied log index is 4
2019-06-14 00:42:33,573 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 00:42:33,573 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea-RaftLogWorker close()
2019-06-14 00:42:33,574 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea: shutdown server with port 39083 now
2019-06-14 00:42:33,577 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 7f14a36d-22b8-4ba0-b7fc-5cd5f01848ea: shutdown server with port 39083 successfully
2019-06-14 00:42:33,583 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 00:42:33,606 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd102abe2-becb-4f02-b04a-09d48e6c99fc/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 00:42:33,606 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd102abe2-becb-4f02-b04a-09d48e6c99fc/hdds to VolumeSet
2019-06-14 00:42:33,606 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@6f0cb5a1
2019-06-14 00:42:33,612 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@6f0cb5a1
2019-06-14 00:42:33,623 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 37021
2019-06-14 00:42:33,624 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 00:42:33,625 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 00:42:33,626 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 37021 (custom)
2019-06-14 00:42:33,626 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 00:42:33,626 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 00:42:33,626 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 00:42:33,627 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 00:42:33,628 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd102abe2-becb-4f02-b04a-09d48e6c99fc/ratis] (custom)
2019-06-14 00:42:33,628 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 43519
2019-06-14 00:42:33,628 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 00:42:33,629 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 00:42:33,629 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11 at port 37021
2019-06-14 00:42:33,666 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11: start RPC server
2019-06-14 00:42:33,667 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11: GrpcService started, listening on 0.0.0.0/0.0.0.0:37021
2019-06-14 00:42:33,678 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11: addNew group-984EDC40154D:[4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11:127.0.0.1:37021] returns group-984EDC40154D:java.util.concurrent.CompletableFuture@626931f2[Not completed]
2019-06-14 00:42:33,682 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11: new RaftServerImpl for group-984EDC40154D:[4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11:127.0.0.1:37021] with ContainerStateMachine:uninitialized
2019-06-14 00:42:33,682 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 00:42:33,682 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 00:42:33,682 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 00:42:33,683 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 00:42:33,683 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11:group-984EDC40154D ConfigurationManager, init=-1: [4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11:127.0.0.1:37021], old=null, confs=<EMPTY_MAP>
2019-06-14 00:42:33,683 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd102abe2-becb-4f02-b04a-09d48e6c99fc/ratis] (custom)
2019-06-14 00:42:33,683 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd102abe2-becb-4f02-b04a-09d48e6c99fc/ratis/27f82a51-ce40-4c89-b5b2-984edc40154d does not exist. Creating ...
2019-06-14 00:42:33,686 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd102abe2-becb-4f02-b04a-09d48e6c99fc/ratis/27f82a51-ce40-4c89-b5b2-984edc40154d/in_use.lock acquired by nodename 4187@ozone-z78dj-92495746
2019-06-14 00:42:33,688 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd102abe2-becb-4f02-b04a-09d48e6c99fc/ratis/27f82a51-ce40-4c89-b5b2-984edc40154d has been successfully formatted.
2019-06-14 00:42:33,688 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 00:42:33,689 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 00:42:33,689 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 00:42:33,689 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 00:42:33,689 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 00:42:33,689 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 00:42:33,689 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd102abe2-becb-4f02-b04a-09d48e6c99fc/ratis/27f82a51-ce40-4c89-b5b2-984edc40154d
2019-06-14 00:42:33,689 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 00:42:33,690 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 00:42:33,690 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 00:42:33,690 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 00:42:33,690 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 00:42:33,690 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 00:42:33,690 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 00:42:33,691 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 00:42:33,691 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 00:42:33,691 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 00:42:33,691 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 00:42:33,691 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 00:42:33,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 00:42:33,692 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11: start group-984EDC40154D
2019-06-14 00:42:33,692 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11:group-984EDC40154D changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 00:42:33,692 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11: start FollowerState
2019-06-14 00:42:33,693 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-984EDC40154D,id=4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11
2019-06-14 00:42:34,718 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11:group-984EDC40154D changes to CANDIDATE, lastRpcTime:1025, electionTimeout:1025ms
2019-06-14 00:42:34,718 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11: shutdown FollowerState
2019-06-14 00:42:34,718 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11:group-984EDC40154D changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 00:42:34,718 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11: start LeaderElection
2019-06-14 00:42:34,721 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11:group-984EDC40154D:LeaderElection2: begin an election at term 1 for -1: [4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11:127.0.0.1:37021], old=null
2019-06-14 00:42:34,721 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11: shutdown LeaderElection
2019-06-14 00:42:34,721 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11:group-984EDC40154D changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 00:42:34,722 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11:group-984EDC40154D change Leader from null to 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11 at term 1 for becomeLeader, leader elected after 1032ms
2019-06-14 00:42:34,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 00:42:34,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 00:42:34,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 00:42:34,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 00:42:34,722 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11: start LeaderState
2019-06-14 00:42:34,723 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11-RaftLogWorker: Starting segment from index:0
2019-06-14 00:42:34,726 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11:group-984EDC40154D set configuration 0: [4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11:127.0.0.1:37021], old=null at 0
2019-06-14 00:42:34,760 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd102abe2-becb-4f02-b04a-09d48e6c99fc/ratis/27f82a51-ce40-4c89-b5b2-984edc40154d/current/log_inprogress_0
2019-06-14 00:42:35,726 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 00:42:35,728 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11: close
2019-06-14 00:42:35,728 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11: shutdown group-984EDC40154D
2019-06-14 00:42:35,729 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-984EDC40154D,id=4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11
2019-06-14 00:42:35,729 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11: shutdown LeaderState
2019-06-14 00:42:35,730 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11-PendingRequests: sendNotLeaderResponses
2019-06-14 00:42:35,731 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11-group-984EDC40154D: set stopIndex = 2
2019-06-14 00:42:35,731 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-14 00:42:35,731 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd102abe2-becb-4f02-b04a-09d48e6c99fc/ratis/27f82a51-ce40-4c89-b5b2-984edc40154d/sm/snapshot.1_2
2019-06-14 00:42:35,731 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11:group-984EDC40154D closes. The last applied log index is 2
2019-06-14 00:42:35,732 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 00:42:35,733 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11-RaftLogWorker close()
2019-06-14 00:42:35,734 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11: shutdown server with port 37021 now
2019-06-14 00:42:35,735 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 4a7a7dc8-26e0-4a01-b9a5-6ada37d65e11: shutdown server with port 37021 successfully
2019-06-14 00:42:35,737 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 00:42:35,764 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6464ddad-1fed-4821-94e7-4257cd70f8e4/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 00:42:35,764 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6464ddad-1fed-4821-94e7-4257cd70f8e4/hdds to VolumeSet
2019-06-14 00:42:35,764 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@25c53f74
2019-06-14 00:42:35,765 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@25c53f74
2019-06-14 00:42:35,778 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 45479
2019-06-14 00:42:35,779 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 00:42:35,780 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 00:42:35,780 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 45479 (custom)
2019-06-14 00:42:35,780 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 00:42:35,781 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 00:42:35,781 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 00:42:35,781 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 00:42:35,782 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6464ddad-1fed-4821-94e7-4257cd70f8e4/ratis] (custom)
2019-06-14 00:42:35,782 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 43417
2019-06-14 00:42:35,783 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 00:42:35,783 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 00:42:35,783 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis c4e38bef-bfa1-4944-b727-413dfc498862 at port 45479
2019-06-14 00:42:35,789 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - c4e38bef-bfa1-4944-b727-413dfc498862: start RPC server
2019-06-14 00:42:35,790 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - c4e38bef-bfa1-4944-b727-413dfc498862: GrpcService started, listening on 0.0.0.0/0.0.0.0:45479
2019-06-14 00:42:35,797 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - c4e38bef-bfa1-4944-b727-413dfc498862: addNew group-07C5606BE3E7:[c4e38bef-bfa1-4944-b727-413dfc498862:127.0.0.1:45479] returns group-07C5606BE3E7:java.util.concurrent.CompletableFuture@4d48c71f[Not completed]
2019-06-14 00:42:35,797 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - c4e38bef-bfa1-4944-b727-413dfc498862: new RaftServerImpl for group-07C5606BE3E7:[c4e38bef-bfa1-4944-b727-413dfc498862:127.0.0.1:45479] with ContainerStateMachine:uninitialized
2019-06-14 00:42:35,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 00:42:35,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 00:42:35,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 00:42:35,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 00:42:35,798 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - c4e38bef-bfa1-4944-b727-413dfc498862:group-07C5606BE3E7 ConfigurationManager, init=-1: [c4e38bef-bfa1-4944-b727-413dfc498862:127.0.0.1:45479], old=null, confs=<EMPTY_MAP>
2019-06-14 00:42:35,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6464ddad-1fed-4821-94e7-4257cd70f8e4/ratis] (custom)
2019-06-14 00:42:35,799 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6464ddad-1fed-4821-94e7-4257cd70f8e4/ratis/09dfa5d5-ea2b-498e-b817-07c5606be3e7 does not exist. Creating ...
2019-06-14 00:42:35,802 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6464ddad-1fed-4821-94e7-4257cd70f8e4/ratis/09dfa5d5-ea2b-498e-b817-07c5606be3e7/in_use.lock acquired by nodename 4187@ozone-z78dj-92495746
2019-06-14 00:42:35,804 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6464ddad-1fed-4821-94e7-4257cd70f8e4/ratis/09dfa5d5-ea2b-498e-b817-07c5606be3e7 has been successfully formatted.
2019-06-14 00:42:35,804 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 00:42:35,804 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 00:42:35,804 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 00:42:35,805 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 00:42:35,805 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 00:42:35,805 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 00:42:35,805 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new c4e38bef-bfa1-4944-b727-413dfc498862-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6464ddad-1fed-4821-94e7-4257cd70f8e4/ratis/09dfa5d5-ea2b-498e-b817-07c5606be3e7
2019-06-14 00:42:35,805 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 00:42:35,805 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 00:42:35,805 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 00:42:35,805 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 00:42:35,805 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 00:42:35,805 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 00:42:35,805 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 00:42:35,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 00:42:35,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 00:42:35,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 00:42:35,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 00:42:35,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 00:42:35,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 00:42:35,807 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - c4e38bef-bfa1-4944-b727-413dfc498862: start group-07C5606BE3E7
2019-06-14 00:42:35,807 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - c4e38bef-bfa1-4944-b727-413dfc498862:group-07C5606BE3E7 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 00:42:35,807 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c4e38bef-bfa1-4944-b727-413dfc498862: start FollowerState
2019-06-14 00:42:35,807 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-07C5606BE3E7,id=c4e38bef-bfa1-4944-b727-413dfc498862
2019-06-14 00:42:36,936 INFO  impl.FollowerState (FollowerState.java:run(101)) - c4e38bef-bfa1-4944-b727-413dfc498862:group-07C5606BE3E7 changes to CANDIDATE, lastRpcTime:1129, electionTimeout:1129ms
2019-06-14 00:42:36,937 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - c4e38bef-bfa1-4944-b727-413dfc498862: shutdown FollowerState
2019-06-14 00:42:36,937 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - c4e38bef-bfa1-4944-b727-413dfc498862:group-07C5606BE3E7 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 00:42:36,937 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c4e38bef-bfa1-4944-b727-413dfc498862: start LeaderElection
2019-06-14 00:42:36,940 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - c4e38bef-bfa1-4944-b727-413dfc498862:group-07C5606BE3E7:LeaderElection3: begin an election at term 1 for -1: [c4e38bef-bfa1-4944-b727-413dfc498862:127.0.0.1:45479], old=null
2019-06-14 00:42:36,940 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - c4e38bef-bfa1-4944-b727-413dfc498862: shutdown LeaderElection
2019-06-14 00:42:36,940 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - c4e38bef-bfa1-4944-b727-413dfc498862:group-07C5606BE3E7 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 00:42:36,940 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - c4e38bef-bfa1-4944-b727-413dfc498862:group-07C5606BE3E7 change Leader from null to c4e38bef-bfa1-4944-b727-413dfc498862 at term 1 for becomeLeader, leader elected after 1135ms
2019-06-14 00:42:36,940 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 00:42:36,941 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 00:42:36,941 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 00:42:36,941 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 00:42:36,941 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c4e38bef-bfa1-4944-b727-413dfc498862: start LeaderState
2019-06-14 00:42:36,941 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - c4e38bef-bfa1-4944-b727-413dfc498862-RaftLogWorker: Starting segment from index:0
2019-06-14 00:42:36,943 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - c4e38bef-bfa1-4944-b727-413dfc498862:group-07C5606BE3E7 set configuration 0: [c4e38bef-bfa1-4944-b727-413dfc498862:127.0.0.1:45479], old=null at 0
2019-06-14 00:42:36,979 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - c4e38bef-bfa1-4944-b727-413dfc498862-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6464ddad-1fed-4821-94e7-4257cd70f8e4/ratis/09dfa5d5-ea2b-498e-b817-07c5606be3e7/current/log_inprogress_0
2019-06-14 00:42:37,850 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 853609043143997563 is closed with bcsId 0.
2019-06-14 00:42:37,851 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 00:42:37,851 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - c4e38bef-bfa1-4944-b727-413dfc498862: close
2019-06-14 00:42:37,851 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - c4e38bef-bfa1-4944-b727-413dfc498862: shutdown group-07C5606BE3E7
2019-06-14 00:42:37,852 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-07C5606BE3E7,id=c4e38bef-bfa1-4944-b727-413dfc498862
2019-06-14 00:42:37,852 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - c4e38bef-bfa1-4944-b727-413dfc498862: shutdown LeaderState
2019-06-14 00:42:37,852 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - c4e38bef-bfa1-4944-b727-413dfc498862-PendingRequests: sendNotLeaderResponses
2019-06-14 00:42:37,853 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-c4e38bef-bfa1-4944-b727-413dfc498862-group-07C5606BE3E7: set stopIndex = 2
2019-06-14 00:42:37,853 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-14 00:42:37,854 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6464ddad-1fed-4821-94e7-4257cd70f8e4/ratis/09dfa5d5-ea2b-498e-b817-07c5606be3e7/sm/snapshot.1_2
2019-06-14 00:42:37,854 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - c4e38bef-bfa1-4944-b727-413dfc498862:group-07C5606BE3E7 closes. The last applied log index is 2
2019-06-14 00:42:37,855 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - c4e38bef-bfa1-4944-b727-413dfc498862-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 00:42:37,855 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - c4e38bef-bfa1-4944-b727-413dfc498862-RaftLogWorker close()
2019-06-14 00:42:37,856 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - c4e38bef-bfa1-4944-b727-413dfc498862: shutdown server with port 45479 now
2019-06-14 00:42:37,858 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - c4e38bef-bfa1-4944-b727-413dfc498862: shutdown server with port 45479 successfully
2019-06-14 00:42:37,888 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 00:42:37,908 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc70a5a24-4a4f-4529-80c4-f670624a9864/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 00:42:37,909 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc70a5a24-4a4f-4529-80c4-f670624a9864/hdds to VolumeSet
2019-06-14 00:42:37,909 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@12010fd1
2019-06-14 00:42:37,909 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@12010fd1
2019-06-14 00:42:37,925 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 41847
2019-06-14 00:42:37,926 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 00:42:37,927 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 00:42:37,927 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 41847 (custom)
2019-06-14 00:42:37,927 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 00:42:37,927 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 00:42:37,928 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 00:42:37,928 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 00:42:37,928 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc70a5a24-4a4f-4529-80c4-f670624a9864/ratis] (custom)
2019-06-14 00:42:37,929 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42763
2019-06-14 00:42:37,929 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 00:42:37,929 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 00:42:37,929 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 910065d3-86b9-444f-b8ef-324414a6e966 at port 41847
2019-06-14 00:42:37,936 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 910065d3-86b9-444f-b8ef-324414a6e966: start RPC server
2019-06-14 00:42:37,938 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 910065d3-86b9-444f-b8ef-324414a6e966: GrpcService started, listening on 0.0.0.0/0.0.0.0:41847
Jun 14, 2019 12:42:37 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:37021} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 14, 2019 12:42:37 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:45479} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-14 00:42:37,950 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 910065d3-86b9-444f-b8ef-324414a6e966: addNew group-FBDF17F7EBB4:[910065d3-86b9-444f-b8ef-324414a6e966:127.0.0.1:41847] returns group-FBDF17F7EBB4:java.util.concurrent.CompletableFuture@1a85c88d[Not completed]
2019-06-14 00:42:37,951 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 910065d3-86b9-444f-b8ef-324414a6e966: new RaftServerImpl for group-FBDF17F7EBB4:[910065d3-86b9-444f-b8ef-324414a6e966:127.0.0.1:41847] with ContainerStateMachine:uninitialized
2019-06-14 00:42:37,951 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 00:42:37,951 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 00:42:37,951 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 00:42:37,951 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 00:42:37,951 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 910065d3-86b9-444f-b8ef-324414a6e966:group-FBDF17F7EBB4 ConfigurationManager, init=-1: [910065d3-86b9-444f-b8ef-324414a6e966:127.0.0.1:41847], old=null, confs=<EMPTY_MAP>
2019-06-14 00:42:37,952 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc70a5a24-4a4f-4529-80c4-f670624a9864/ratis] (custom)
2019-06-14 00:42:37,952 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc70a5a24-4a4f-4529-80c4-f670624a9864/ratis/ef569f53-5768-45fa-83ed-fbdf17f7ebb4 does not exist. Creating ...
2019-06-14 00:42:37,954 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc70a5a24-4a4f-4529-80c4-f670624a9864/ratis/ef569f53-5768-45fa-83ed-fbdf17f7ebb4/in_use.lock acquired by nodename 4187@ozone-z78dj-92495746
2019-06-14 00:42:37,956 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc70a5a24-4a4f-4529-80c4-f670624a9864/ratis/ef569f53-5768-45fa-83ed-fbdf17f7ebb4 has been successfully formatted.
2019-06-14 00:42:37,956 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 00:42:37,956 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 00:42:37,957 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 00:42:37,957 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 00:42:37,957 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 00:42:37,957 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 00:42:37,957 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 910065d3-86b9-444f-b8ef-324414a6e966-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc70a5a24-4a4f-4529-80c4-f670624a9864/ratis/ef569f53-5768-45fa-83ed-fbdf17f7ebb4
2019-06-14 00:42:37,957 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 00:42:37,957 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 00:42:37,957 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 00:42:37,957 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 00:42:37,957 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 00:42:37,957 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 00:42:37,958 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 00:42:37,958 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 00:42:37,958 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 00:42:37,958 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 00:42:37,958 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 00:42:37,958 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 00:42:37,958 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 00:42:37,958 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 910065d3-86b9-444f-b8ef-324414a6e966: start group-FBDF17F7EBB4
2019-06-14 00:42:37,959 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 910065d3-86b9-444f-b8ef-324414a6e966:group-FBDF17F7EBB4 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 00:42:37,959 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 910065d3-86b9-444f-b8ef-324414a6e966: start FollowerState
2019-06-14 00:42:37,959 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-FBDF17F7EBB4,id=910065d3-86b9-444f-b8ef-324414a6e966
2019-06-14 00:42:39,095 INFO  impl.FollowerState (FollowerState.java:run(101)) - 910065d3-86b9-444f-b8ef-324414a6e966:group-FBDF17F7EBB4 changes to CANDIDATE, lastRpcTime:1136, electionTimeout:1136ms
2019-06-14 00:42:39,095 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 910065d3-86b9-444f-b8ef-324414a6e966: shutdown FollowerState
2019-06-14 00:42:39,095 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 910065d3-86b9-444f-b8ef-324414a6e966:group-FBDF17F7EBB4 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 00:42:39,095 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 910065d3-86b9-444f-b8ef-324414a6e966: start LeaderElection
2019-06-14 00:42:39,098 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 910065d3-86b9-444f-b8ef-324414a6e966:group-FBDF17F7EBB4:LeaderElection4: begin an election at term 1 for -1: [910065d3-86b9-444f-b8ef-324414a6e966:127.0.0.1:41847], old=null
2019-06-14 00:42:39,098 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 910065d3-86b9-444f-b8ef-324414a6e966: shutdown LeaderElection
2019-06-14 00:42:39,099 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 910065d3-86b9-444f-b8ef-324414a6e966:group-FBDF17F7EBB4 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 00:42:39,099 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 910065d3-86b9-444f-b8ef-324414a6e966:group-FBDF17F7EBB4 change Leader from null to 910065d3-86b9-444f-b8ef-324414a6e966 at term 1 for becomeLeader, leader elected after 1142ms
2019-06-14 00:42:39,099 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 00:42:39,099 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 00:42:39,099 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 00:42:39,099 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 00:42:39,099 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 910065d3-86b9-444f-b8ef-324414a6e966: start LeaderState
2019-06-14 00:42:39,100 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 910065d3-86b9-444f-b8ef-324414a6e966-RaftLogWorker: Starting segment from index:0
2019-06-14 00:42:39,101 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 910065d3-86b9-444f-b8ef-324414a6e966:group-FBDF17F7EBB4 set configuration 0: [910065d3-86b9-444f-b8ef-324414a6e966:127.0.0.1:41847], old=null at 0
2019-06-14 00:42:39,137 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 910065d3-86b9-444f-b8ef-324414a6e966-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc70a5a24-4a4f-4529-80c4-f670624a9864/ratis/ef569f53-5768-45fa-83ed-fbdf17f7ebb4/current/log_inprogress_0
2019-06-14 00:42:39,998 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 5880261084455475403 is closed with bcsId 0.
2019-06-14 00:42:39,998 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 00:42:39,999 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 910065d3-86b9-444f-b8ef-324414a6e966: close
2019-06-14 00:42:39,999 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 910065d3-86b9-444f-b8ef-324414a6e966: shutdown group-FBDF17F7EBB4
2019-06-14 00:42:39,999 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-FBDF17F7EBB4,id=910065d3-86b9-444f-b8ef-324414a6e966
2019-06-14 00:42:39,999 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 910065d3-86b9-444f-b8ef-324414a6e966: shutdown LeaderState
2019-06-14 00:42:40,000 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 910065d3-86b9-444f-b8ef-324414a6e966-PendingRequests: sendNotLeaderResponses
2019-06-14 00:42:40,001 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-910065d3-86b9-444f-b8ef-324414a6e966-group-FBDF17F7EBB4: set stopIndex = 2
2019-06-14 00:42:40,001 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-14 00:42:40,001 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc70a5a24-4a4f-4529-80c4-f670624a9864/ratis/ef569f53-5768-45fa-83ed-fbdf17f7ebb4/sm/snapshot.1_2
2019-06-14 00:42:40,001 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 910065d3-86b9-444f-b8ef-324414a6e966:group-FBDF17F7EBB4 closes. The last applied log index is 2
2019-06-14 00:42:40,002 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 910065d3-86b9-444f-b8ef-324414a6e966-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 00:42:40,002 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 910065d3-86b9-444f-b8ef-324414a6e966-RaftLogWorker close()
2019-06-14 00:42:40,003 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 910065d3-86b9-444f-b8ef-324414a6e966: shutdown server with port 41847 now
2019-06-14 00:42:40,004 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 910065d3-86b9-444f-b8ef-324414a6e966: shutdown server with port 41847 successfully
2019-06-14 00:42:40,006 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-14 00:42:40,029 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera668862f-82b9-4378-82e2-22e00b635afe/hdds of  storage type : DISK and capacity : 104021790720
2019-06-14 00:42:40,029 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera668862f-82b9-4378-82e2-22e00b635afe/hdds to VolumeSet
2019-06-14 00:42:40,029 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@62a4417
2019-06-14 00:42:40,030 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@62a4417
2019-06-14 00:42:40,041 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 45909
2019-06-14 00:42:40,042 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-14 00:42:40,043 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-14 00:42:40,043 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 45909 (custom)
2019-06-14 00:42:40,043 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-14 00:42:40,043 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 00:42:40,044 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-14 00:42:40,044 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-14 00:42:40,044 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera668862f-82b9-4378-82e2-22e00b635afe/ratis] (custom)
2019-06-14 00:42:40,045 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 40511
2019-06-14 00:42:40,045 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-14 00:42:40,045 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-14 00:42:40,045 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 7517f4d9-211c-4437-96c2-d7f5c0838991 at port 45909
2019-06-14 00:42:40,068 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 7517f4d9-211c-4437-96c2-d7f5c0838991: start RPC server
2019-06-14 00:42:40,069 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 7517f4d9-211c-4437-96c2-d7f5c0838991: GrpcService started, listening on 0.0.0.0/0.0.0.0:45909
2019-06-14 00:42:40,080 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 7517f4d9-211c-4437-96c2-d7f5c0838991: addNew group-4C3FE3E73163:[7517f4d9-211c-4437-96c2-d7f5c0838991:127.0.0.1:45909] returns group-4C3FE3E73163:java.util.concurrent.CompletableFuture@4fb8272b[Not completed]
2019-06-14 00:42:40,081 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 7517f4d9-211c-4437-96c2-d7f5c0838991: new RaftServerImpl for group-4C3FE3E73163:[7517f4d9-211c-4437-96c2-d7f5c0838991:127.0.0.1:45909] with ContainerStateMachine:uninitialized
2019-06-14 00:42:40,081 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-14 00:42:40,081 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-14 00:42:40,081 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-14 00:42:40,082 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-14 00:42:40,082 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 7517f4d9-211c-4437-96c2-d7f5c0838991:group-4C3FE3E73163 ConfigurationManager, init=-1: [7517f4d9-211c-4437-96c2-d7f5c0838991:127.0.0.1:45909], old=null, confs=<EMPTY_MAP>
2019-06-14 00:42:40,082 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera668862f-82b9-4378-82e2-22e00b635afe/ratis] (custom)
2019-06-14 00:42:40,082 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera668862f-82b9-4378-82e2-22e00b635afe/ratis/c44b86ce-f20f-4784-98c5-4c3fe3e73163 does not exist. Creating ...
2019-06-14 00:42:40,085 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera668862f-82b9-4378-82e2-22e00b635afe/ratis/c44b86ce-f20f-4784-98c5-4c3fe3e73163/in_use.lock acquired by nodename 4187@ozone-z78dj-92495746
2019-06-14 00:42:40,087 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera668862f-82b9-4378-82e2-22e00b635afe/ratis/c44b86ce-f20f-4784-98c5-4c3fe3e73163 has been successfully formatted.
2019-06-14 00:42:40,087 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-14 00:42:40,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-14 00:42:40,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-14 00:42:40,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-14 00:42:40,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 00:42:40,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-14 00:42:40,088 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 7517f4d9-211c-4437-96c2-d7f5c0838991-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera668862f-82b9-4378-82e2-22e00b635afe/ratis/c44b86ce-f20f-4784-98c5-4c3fe3e73163
2019-06-14 00:42:40,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-14 00:42:40,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-14 00:42:40,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-14 00:42:40,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-14 00:42:40,089 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-14 00:42:40,089 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-14 00:42:40,089 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-14 00:42:40,089 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-14 00:42:40,089 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-14 00:42:40,089 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-14 00:42:40,090 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-14 00:42:40,090 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-14 00:42:40,090 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-14 00:42:40,090 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 7517f4d9-211c-4437-96c2-d7f5c0838991: start group-4C3FE3E73163
2019-06-14 00:42:40,090 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7517f4d9-211c-4437-96c2-d7f5c0838991:group-4C3FE3E73163 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-14 00:42:40,090 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7517f4d9-211c-4437-96c2-d7f5c0838991: start FollowerState
2019-06-14 00:42:40,091 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-4C3FE3E73163,id=7517f4d9-211c-4437-96c2-d7f5c0838991
2019-06-14 00:42:41,202 INFO  impl.FollowerState (FollowerState.java:run(101)) - 7517f4d9-211c-4437-96c2-d7f5c0838991:group-4C3FE3E73163 changes to CANDIDATE, lastRpcTime:1111, electionTimeout:1111ms
2019-06-14 00:42:41,202 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 7517f4d9-211c-4437-96c2-d7f5c0838991: shutdown FollowerState
2019-06-14 00:42:41,202 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7517f4d9-211c-4437-96c2-d7f5c0838991:group-4C3FE3E73163 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-14 00:42:41,202 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7517f4d9-211c-4437-96c2-d7f5c0838991: start LeaderElection
2019-06-14 00:42:41,205 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 7517f4d9-211c-4437-96c2-d7f5c0838991:group-4C3FE3E73163:LeaderElection5: begin an election at term 1 for -1: [7517f4d9-211c-4437-96c2-d7f5c0838991:127.0.0.1:45909], old=null
2019-06-14 00:42:41,206 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 7517f4d9-211c-4437-96c2-d7f5c0838991: shutdown LeaderElection
2019-06-14 00:42:41,206 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7517f4d9-211c-4437-96c2-d7f5c0838991:group-4C3FE3E73163 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-14 00:42:41,206 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 7517f4d9-211c-4437-96c2-d7f5c0838991:group-4C3FE3E73163 change Leader from null to 7517f4d9-211c-4437-96c2-d7f5c0838991 at term 1 for becomeLeader, leader elected after 1118ms
2019-06-14 00:42:41,206 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-14 00:42:41,206 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-14 00:42:41,206 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-14 00:42:41,206 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-14 00:42:41,206 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7517f4d9-211c-4437-96c2-d7f5c0838991: start LeaderState
2019-06-14 00:42:41,207 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 7517f4d9-211c-4437-96c2-d7f5c0838991-RaftLogWorker: Starting segment from index:0
2019-06-14 00:42:41,208 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 7517f4d9-211c-4437-96c2-d7f5c0838991:group-4C3FE3E73163 set configuration 0: [7517f4d9-211c-4437-96c2-d7f5c0838991:127.0.0.1:45909], old=null at 0
2019-06-14 00:42:41,245 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 7517f4d9-211c-4437-96c2-d7f5c0838991-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera668862f-82b9-4378-82e2-22e00b635afe/ratis/c44b86ce-f20f-4784-98c5-4c3fe3e73163/current/log_inprogress_0
2019-06-14 00:42:42,128 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 6614751715665927445 is closed with bcsId 0.
2019-06-14 00:42:42,129 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-14 00:42:42,129 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 7517f4d9-211c-4437-96c2-d7f5c0838991: close
2019-06-14 00:42:42,129 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 7517f4d9-211c-4437-96c2-d7f5c0838991: shutdown group-4C3FE3E73163
2019-06-14 00:42:42,129 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-4C3FE3E73163,id=7517f4d9-211c-4437-96c2-d7f5c0838991
2019-06-14 00:42:42,130 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 7517f4d9-211c-4437-96c2-d7f5c0838991: shutdown LeaderState
2019-06-14 00:42:42,130 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 7517f4d9-211c-4437-96c2-d7f5c0838991-PendingRequests: sendNotLeaderResponses
2019-06-14 00:42:42,131 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-7517f4d9-211c-4437-96c2-d7f5c0838991-group-4C3FE3E73163: set stopIndex = 4
2019-06-14 00:42:42,131 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-14 00:42:42,131 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera668862f-82b9-4378-82e2-22e00b635afe/ratis/c44b86ce-f20f-4784-98c5-4c3fe3e73163/sm/snapshot.1_4
2019-06-14 00:42:42,131 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 7517f4d9-211c-4437-96c2-d7f5c0838991:group-4C3FE3E73163 closes. The last applied log index is 4
2019-06-14 00:42:42,132 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 7517f4d9-211c-4437-96c2-d7f5c0838991-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-14 00:42:42,132 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 7517f4d9-211c-4437-96c2-d7f5c0838991-RaftLogWorker close()
2019-06-14 00:42:42,133 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 7517f4d9-211c-4437-96c2-d7f5c0838991: shutdown server with port 45909 now
2019-06-14 00:42:42,134 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 7517f4d9-211c-4437-96c2-d7f5c0838991: shutdown server with port 45909 successfully
2019-06-14 00:42:42,137 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
