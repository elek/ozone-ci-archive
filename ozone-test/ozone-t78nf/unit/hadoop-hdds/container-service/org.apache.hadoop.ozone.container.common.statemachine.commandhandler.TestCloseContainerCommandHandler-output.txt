2019-06-13 22:29:44,195 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerba5cbc80-978b-4029-9da1-f4961cc40909/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 22:29:44,199 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerba5cbc80-978b-4029-9da1-f4961cc40909/hdds to VolumeSet
2019-06-13 22:29:44,209 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-13 22:29:44,234 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-13 22:29:44,568 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 39109
2019-06-13 22:29:44,951 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 22:29:44,972 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 22:29:44,980 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 39109 (custom)
2019-06-13 22:29:44,981 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 22:29:44,983 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 22:29:44,984 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 22:29:44,985 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 22:29:45,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerba5cbc80-978b-4029-9da1-f4961cc40909/ratis] (custom)
2019-06-13 22:29:45,113 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 34557
2019-06-13 22:29:45,131 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 22:29:45,131 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 22:29:45,133 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 5ad8555f-2d62-4498-97c2-81d2be228528 at port 39109
2019-06-13 22:29:45,144 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 5ad8555f-2d62-4498-97c2-81d2be228528: start RPC server
2019-06-13 22:29:45,268 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 5ad8555f-2d62-4498-97c2-81d2be228528: GrpcService started, listening on 0.0.0.0/0.0.0.0:39109
2019-06-13 22:29:45,555 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 5ad8555f-2d62-4498-97c2-81d2be228528: addNew group-F40982857B62:[5ad8555f-2d62-4498-97c2-81d2be228528:127.0.0.1:39109] returns group-F40982857B62:java.util.concurrent.CompletableFuture@4a458ea6[Not completed]
2019-06-13 22:29:45,580 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 5ad8555f-2d62-4498-97c2-81d2be228528: new RaftServerImpl for group-F40982857B62:[5ad8555f-2d62-4498-97c2-81d2be228528:127.0.0.1:39109] with ContainerStateMachine:uninitialized
2019-06-13 22:29:45,581 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 22:29:45,581 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 22:29:45,581 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 22:29:45,582 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 22:29:45,587 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 5ad8555f-2d62-4498-97c2-81d2be228528:group-F40982857B62 ConfigurationManager, init=-1: [5ad8555f-2d62-4498-97c2-81d2be228528:127.0.0.1:39109], old=null, confs=<EMPTY_MAP>
2019-06-13 22:29:45,587 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerba5cbc80-978b-4029-9da1-f4961cc40909/ratis] (custom)
2019-06-13 22:29:45,593 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerba5cbc80-978b-4029-9da1-f4961cc40909/ratis/03a024b4-ef08-49cd-a25e-f40982857b62 does not exist. Creating ...
2019-06-13 22:29:45,601 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerba5cbc80-978b-4029-9da1-f4961cc40909/ratis/03a024b4-ef08-49cd-a25e-f40982857b62/in_use.lock acquired by nodename 4178@ozone-t78nf-1192151138
2019-06-13 22:29:45,607 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerba5cbc80-978b-4029-9da1-f4961cc40909/ratis/03a024b4-ef08-49cd-a25e-f40982857b62 has been successfully formatted.
2019-06-13 22:29:45,609 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 22:29:45,609 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 22:29:45,611 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 22:29:45,612 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 22:29:45,615 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 22:29:45,618 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 22:29:45,620 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 5ad8555f-2d62-4498-97c2-81d2be228528-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerba5cbc80-978b-4029-9da1-f4961cc40909/ratis/03a024b4-ef08-49cd-a25e-f40982857b62
2019-06-13 22:29:45,620 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 22:29:45,620 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 22:29:45,622 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 22:29:45,622 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 22:29:45,623 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 22:29:45,623 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 22:29:45,624 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 22:29:45,624 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 22:29:45,624 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 22:29:45,626 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 22:29:45,630 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 22:29:45,631 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 22:29:45,632 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 22:29:45,727 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 5ad8555f-2d62-4498-97c2-81d2be228528: start group-F40982857B62
2019-06-13 22:29:45,728 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5ad8555f-2d62-4498-97c2-81d2be228528:group-F40982857B62 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 22:29:45,729 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5ad8555f-2d62-4498-97c2-81d2be228528: start FollowerState
2019-06-13 22:29:45,731 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-F40982857B62,id=5ad8555f-2d62-4498-97c2-81d2be228528
2019-06-13 22:29:46,897 INFO  impl.FollowerState (FollowerState.java:run(101)) - 5ad8555f-2d62-4498-97c2-81d2be228528:group-F40982857B62 changes to CANDIDATE, lastRpcTime:1168, electionTimeout:1167ms
2019-06-13 22:29:46,897 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 5ad8555f-2d62-4498-97c2-81d2be228528: shutdown FollowerState
2019-06-13 22:29:46,897 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5ad8555f-2d62-4498-97c2-81d2be228528:group-F40982857B62 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 22:29:46,899 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5ad8555f-2d62-4498-97c2-81d2be228528: start LeaderElection
2019-06-13 22:29:46,902 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 5ad8555f-2d62-4498-97c2-81d2be228528:group-F40982857B62:LeaderElection1: begin an election at term 1 for -1: [5ad8555f-2d62-4498-97c2-81d2be228528:127.0.0.1:39109], old=null
2019-06-13 22:29:46,903 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 5ad8555f-2d62-4498-97c2-81d2be228528: shutdown LeaderElection
2019-06-13 22:29:46,903 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5ad8555f-2d62-4498-97c2-81d2be228528:group-F40982857B62 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 22:29:46,903 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 5ad8555f-2d62-4498-97c2-81d2be228528:group-F40982857B62 change Leader from null to 5ad8555f-2d62-4498-97c2-81d2be228528 at term 1 for becomeLeader, leader elected after 1293ms
2019-06-13 22:29:46,906 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 22:29:46,907 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 22:29:46,908 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 22:29:46,908 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 22:29:46,915 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5ad8555f-2d62-4498-97c2-81d2be228528: start LeaderState
2019-06-13 22:29:46,926 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 5ad8555f-2d62-4498-97c2-81d2be228528-RaftLogWorker: Starting segment from index:0
2019-06-13 22:29:46,934 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 5ad8555f-2d62-4498-97c2-81d2be228528:group-F40982857B62 set configuration 0: [5ad8555f-2d62-4498-97c2-81d2be228528:127.0.0.1:39109], old=null at 0
2019-06-13 22:29:47,055 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 5ad8555f-2d62-4498-97c2-81d2be228528-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerba5cbc80-978b-4029-9da1-f4961cc40909/ratis/03a024b4-ef08-49cd-a25e-f40982857b62/current/log_inprogress_0
2019-06-13 22:29:47,943 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-13 22:29:48,001 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 5326017971548396282 is closed with bcsId 0.
2019-06-13 22:29:48,001 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 22:29:48,002 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 5ad8555f-2d62-4498-97c2-81d2be228528: close
2019-06-13 22:29:48,003 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 5ad8555f-2d62-4498-97c2-81d2be228528: shutdown group-F40982857B62
2019-06-13 22:29:48,004 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-F40982857B62,id=5ad8555f-2d62-4498-97c2-81d2be228528
2019-06-13 22:29:48,004 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 5ad8555f-2d62-4498-97c2-81d2be228528: shutdown LeaderState
2019-06-13 22:29:48,004 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 5ad8555f-2d62-4498-97c2-81d2be228528-PendingRequests: sendNotLeaderResponses
2019-06-13 22:29:48,006 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-5ad8555f-2d62-4498-97c2-81d2be228528-group-F40982857B62: set stopIndex = 4
2019-06-13 22:29:48,006 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-13 22:29:48,007 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerba5cbc80-978b-4029-9da1-f4961cc40909/ratis/03a024b4-ef08-49cd-a25e-f40982857b62/sm/snapshot.1_4
2019-06-13 22:29:48,014 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 5ad8555f-2d62-4498-97c2-81d2be228528:group-F40982857B62 closes. The last applied log index is 4
2019-06-13 22:29:48,015 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 5ad8555f-2d62-4498-97c2-81d2be228528-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 22:29:48,016 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 5ad8555f-2d62-4498-97c2-81d2be228528-RaftLogWorker close()
2019-06-13 22:29:48,017 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 5ad8555f-2d62-4498-97c2-81d2be228528: shutdown server with port 39109 now
2019-06-13 22:29:48,020 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 5ad8555f-2d62-4498-97c2-81d2be228528: shutdown server with port 39109 successfully
2019-06-13 22:29:48,027 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 22:29:48,057 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4af42b82-5879-422d-869b-f972c9775c19/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 22:29:48,057 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4af42b82-5879-422d-869b-f972c9775c19/hdds to VolumeSet
2019-06-13 22:29:48,057 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1b29d52b
2019-06-13 22:29:48,059 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1b29d52b
2019-06-13 22:29:48,071 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 37247
2019-06-13 22:29:48,072 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 22:29:48,073 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 22:29:48,073 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 37247 (custom)
2019-06-13 22:29:48,073 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 22:29:48,074 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 22:29:48,074 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 22:29:48,074 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 22:29:48,075 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4af42b82-5879-422d-869b-f972c9775c19/ratis] (custom)
2019-06-13 22:29:48,076 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 37439
2019-06-13 22:29:48,076 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 22:29:48,076 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 22:29:48,076 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis b737f5eb-1efd-4676-bc63-6468d56cbac2 at port 37247
2019-06-13 22:29:48,095 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - b737f5eb-1efd-4676-bc63-6468d56cbac2: start RPC server
2019-06-13 22:29:48,096 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - b737f5eb-1efd-4676-bc63-6468d56cbac2: GrpcService started, listening on 0.0.0.0/0.0.0.0:37247
2019-06-13 22:29:48,107 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - b737f5eb-1efd-4676-bc63-6468d56cbac2: addNew group-861398211041:[b737f5eb-1efd-4676-bc63-6468d56cbac2:127.0.0.1:37247] returns group-861398211041:java.util.concurrent.CompletableFuture@3951cb5f[Not completed]
2019-06-13 22:29:48,108 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - b737f5eb-1efd-4676-bc63-6468d56cbac2: new RaftServerImpl for group-861398211041:[b737f5eb-1efd-4676-bc63-6468d56cbac2:127.0.0.1:37247] with ContainerStateMachine:uninitialized
2019-06-13 22:29:48,108 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 22:29:48,108 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 22:29:48,108 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 22:29:48,108 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 22:29:48,109 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - b737f5eb-1efd-4676-bc63-6468d56cbac2:group-861398211041 ConfigurationManager, init=-1: [b737f5eb-1efd-4676-bc63-6468d56cbac2:127.0.0.1:37247], old=null, confs=<EMPTY_MAP>
2019-06-13 22:29:48,109 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4af42b82-5879-422d-869b-f972c9775c19/ratis] (custom)
2019-06-13 22:29:48,109 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4af42b82-5879-422d-869b-f972c9775c19/ratis/33f62113-31c9-4093-8a43-861398211041 does not exist. Creating ...
2019-06-13 22:29:48,112 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4af42b82-5879-422d-869b-f972c9775c19/ratis/33f62113-31c9-4093-8a43-861398211041/in_use.lock acquired by nodename 4178@ozone-t78nf-1192151138
2019-06-13 22:29:48,114 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4af42b82-5879-422d-869b-f972c9775c19/ratis/33f62113-31c9-4093-8a43-861398211041 has been successfully formatted.
2019-06-13 22:29:48,114 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 22:29:48,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 22:29:48,115 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 22:29:48,115 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 22:29:48,115 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 22:29:48,115 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 22:29:48,115 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new b737f5eb-1efd-4676-bc63-6468d56cbac2-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4af42b82-5879-422d-869b-f972c9775c19/ratis/33f62113-31c9-4093-8a43-861398211041
2019-06-13 22:29:48,115 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 22:29:48,115 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 22:29:48,116 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 22:29:48,116 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 22:29:48,116 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 22:29:48,116 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 22:29:48,116 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 22:29:48,116 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 22:29:48,117 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 22:29:48,117 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 22:29:48,117 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 22:29:48,117 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 22:29:48,117 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 22:29:48,118 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - b737f5eb-1efd-4676-bc63-6468d56cbac2: start group-861398211041
2019-06-13 22:29:48,118 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b737f5eb-1efd-4676-bc63-6468d56cbac2:group-861398211041 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 22:29:48,118 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b737f5eb-1efd-4676-bc63-6468d56cbac2: start FollowerState
2019-06-13 22:29:48,119 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-861398211041,id=b737f5eb-1efd-4676-bc63-6468d56cbac2
2019-06-13 22:29:49,313 INFO  impl.FollowerState (FollowerState.java:run(101)) - b737f5eb-1efd-4676-bc63-6468d56cbac2:group-861398211041 changes to CANDIDATE, lastRpcTime:1195, electionTimeout:1194ms
2019-06-13 22:29:49,313 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b737f5eb-1efd-4676-bc63-6468d56cbac2: shutdown FollowerState
2019-06-13 22:29:49,314 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b737f5eb-1efd-4676-bc63-6468d56cbac2:group-861398211041 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 22:29:49,314 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b737f5eb-1efd-4676-bc63-6468d56cbac2: start LeaderElection
2019-06-13 22:29:49,317 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b737f5eb-1efd-4676-bc63-6468d56cbac2:group-861398211041:LeaderElection2: begin an election at term 1 for -1: [b737f5eb-1efd-4676-bc63-6468d56cbac2:127.0.0.1:37247], old=null
2019-06-13 22:29:49,317 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b737f5eb-1efd-4676-bc63-6468d56cbac2: shutdown LeaderElection
2019-06-13 22:29:49,317 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b737f5eb-1efd-4676-bc63-6468d56cbac2:group-861398211041 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 22:29:49,317 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - b737f5eb-1efd-4676-bc63-6468d56cbac2:group-861398211041 change Leader from null to b737f5eb-1efd-4676-bc63-6468d56cbac2 at term 1 for becomeLeader, leader elected after 1202ms
2019-06-13 22:29:49,317 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 22:29:49,317 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 22:29:49,318 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 22:29:49,318 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 22:29:49,318 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b737f5eb-1efd-4676-bc63-6468d56cbac2: start LeaderState
2019-06-13 22:29:49,318 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - b737f5eb-1efd-4676-bc63-6468d56cbac2-RaftLogWorker: Starting segment from index:0
2019-06-13 22:29:49,319 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - b737f5eb-1efd-4676-bc63-6468d56cbac2:group-861398211041 set configuration 0: [b737f5eb-1efd-4676-bc63-6468d56cbac2:127.0.0.1:37247], old=null at 0
2019-06-13 22:29:49,353 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - b737f5eb-1efd-4676-bc63-6468d56cbac2-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4af42b82-5879-422d-869b-f972c9775c19/ratis/33f62113-31c9-4093-8a43-861398211041/current/log_inprogress_0
2019-06-13 22:29:50,151 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 22:29:50,152 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - b737f5eb-1efd-4676-bc63-6468d56cbac2: close
2019-06-13 22:29:50,152 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - b737f5eb-1efd-4676-bc63-6468d56cbac2: shutdown group-861398211041
2019-06-13 22:29:50,153 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-861398211041,id=b737f5eb-1efd-4676-bc63-6468d56cbac2
2019-06-13 22:29:50,153 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - b737f5eb-1efd-4676-bc63-6468d56cbac2: shutdown LeaderState
2019-06-13 22:29:50,153 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - b737f5eb-1efd-4676-bc63-6468d56cbac2-PendingRequests: sendNotLeaderResponses
2019-06-13 22:29:50,154 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-b737f5eb-1efd-4676-bc63-6468d56cbac2-group-861398211041: set stopIndex = 2
2019-06-13 22:29:50,154 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-13 22:29:50,154 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4af42b82-5879-422d-869b-f972c9775c19/ratis/33f62113-31c9-4093-8a43-861398211041/sm/snapshot.1_2
2019-06-13 22:29:50,155 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - b737f5eb-1efd-4676-bc63-6468d56cbac2:group-861398211041 closes. The last applied log index is 2
2019-06-13 22:29:50,155 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - b737f5eb-1efd-4676-bc63-6468d56cbac2-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 22:29:50,156 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - b737f5eb-1efd-4676-bc63-6468d56cbac2-RaftLogWorker close()
2019-06-13 22:29:50,157 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - b737f5eb-1efd-4676-bc63-6468d56cbac2: shutdown server with port 37247 now
2019-06-13 22:29:50,158 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - b737f5eb-1efd-4676-bc63-6468d56cbac2: shutdown server with port 37247 successfully
2019-06-13 22:29:50,163 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 22:29:50,191 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb1abcb02-4cf1-4a5a-a14a-f5384bcc93e3/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 22:29:50,191 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb1abcb02-4cf1-4a5a-a14a-f5384bcc93e3/hdds to VolumeSet
2019-06-13 22:29:50,191 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@5e2f3be5
2019-06-13 22:29:50,192 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@5e2f3be5
2019-06-13 22:29:50,204 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 45995
2019-06-13 22:29:50,205 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 22:29:50,205 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 22:29:50,206 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 45995 (custom)
2019-06-13 22:29:50,206 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 22:29:50,206 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 22:29:50,206 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 22:29:50,206 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 22:29:50,207 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb1abcb02-4cf1-4a5a-a14a-f5384bcc93e3/ratis] (custom)
2019-06-13 22:29:50,207 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 37471
2019-06-13 22:29:50,207 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 22:29:50,207 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 22:29:50,208 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 35abba89-abc6-4670-9060-857dc3ad9419 at port 45995
2019-06-13 22:29:50,216 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 35abba89-abc6-4670-9060-857dc3ad9419: start RPC server
2019-06-13 22:29:50,216 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 35abba89-abc6-4670-9060-857dc3ad9419: GrpcService started, listening on 0.0.0.0/0.0.0.0:45995
2019-06-13 22:29:50,225 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 35abba89-abc6-4670-9060-857dc3ad9419: addNew group-B5E11ED2EA26:[35abba89-abc6-4670-9060-857dc3ad9419:127.0.0.1:45995] returns group-B5E11ED2EA26:java.util.concurrent.CompletableFuture@62c57e21[Not completed]
2019-06-13 22:29:50,226 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 35abba89-abc6-4670-9060-857dc3ad9419: new RaftServerImpl for group-B5E11ED2EA26:[35abba89-abc6-4670-9060-857dc3ad9419:127.0.0.1:45995] with ContainerStateMachine:uninitialized
2019-06-13 22:29:50,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 22:29:50,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 22:29:50,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 22:29:50,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 22:29:50,227 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 35abba89-abc6-4670-9060-857dc3ad9419:group-B5E11ED2EA26 ConfigurationManager, init=-1: [35abba89-abc6-4670-9060-857dc3ad9419:127.0.0.1:45995], old=null, confs=<EMPTY_MAP>
2019-06-13 22:29:50,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb1abcb02-4cf1-4a5a-a14a-f5384bcc93e3/ratis] (custom)
2019-06-13 22:29:50,227 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb1abcb02-4cf1-4a5a-a14a-f5384bcc93e3/ratis/e6bfe176-6e9d-45a5-af9b-b5e11ed2ea26 does not exist. Creating ...
2019-06-13 22:29:50,230 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb1abcb02-4cf1-4a5a-a14a-f5384bcc93e3/ratis/e6bfe176-6e9d-45a5-af9b-b5e11ed2ea26/in_use.lock acquired by nodename 4178@ozone-t78nf-1192151138
2019-06-13 22:29:50,233 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb1abcb02-4cf1-4a5a-a14a-f5384bcc93e3/ratis/e6bfe176-6e9d-45a5-af9b-b5e11ed2ea26 has been successfully formatted.
2019-06-13 22:29:50,233 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 22:29:50,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 22:29:50,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 22:29:50,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 22:29:50,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 22:29:50,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 22:29:50,233 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 35abba89-abc6-4670-9060-857dc3ad9419-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb1abcb02-4cf1-4a5a-a14a-f5384bcc93e3/ratis/e6bfe176-6e9d-45a5-af9b-b5e11ed2ea26
2019-06-13 22:29:50,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 22:29:50,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 22:29:50,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 22:29:50,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 22:29:50,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 22:29:50,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 22:29:50,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 22:29:50,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 22:29:50,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 22:29:50,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 22:29:50,235 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 22:29:50,235 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 22:29:50,235 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 22:29:50,235 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 35abba89-abc6-4670-9060-857dc3ad9419: start group-B5E11ED2EA26
2019-06-13 22:29:50,235 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 35abba89-abc6-4670-9060-857dc3ad9419:group-B5E11ED2EA26 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 22:29:50,235 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 35abba89-abc6-4670-9060-857dc3ad9419: start FollowerState
2019-06-13 22:29:50,236 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-B5E11ED2EA26,id=35abba89-abc6-4670-9060-857dc3ad9419
2019-06-13 22:29:51,245 INFO  impl.FollowerState (FollowerState.java:run(101)) - 35abba89-abc6-4670-9060-857dc3ad9419:group-B5E11ED2EA26 changes to CANDIDATE, lastRpcTime:1009, electionTimeout:1009ms
2019-06-13 22:29:51,245 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 35abba89-abc6-4670-9060-857dc3ad9419: shutdown FollowerState
2019-06-13 22:29:51,245 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 35abba89-abc6-4670-9060-857dc3ad9419:group-B5E11ED2EA26 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 22:29:51,245 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 35abba89-abc6-4670-9060-857dc3ad9419: start LeaderElection
2019-06-13 22:29:51,248 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 35abba89-abc6-4670-9060-857dc3ad9419:group-B5E11ED2EA26:LeaderElection3: begin an election at term 1 for -1: [35abba89-abc6-4670-9060-857dc3ad9419:127.0.0.1:45995], old=null
2019-06-13 22:29:51,248 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 35abba89-abc6-4670-9060-857dc3ad9419: shutdown LeaderElection
2019-06-13 22:29:51,248 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 35abba89-abc6-4670-9060-857dc3ad9419:group-B5E11ED2EA26 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 22:29:51,249 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 35abba89-abc6-4670-9060-857dc3ad9419:group-B5E11ED2EA26 change Leader from null to 35abba89-abc6-4670-9060-857dc3ad9419 at term 1 for becomeLeader, leader elected after 1015ms
2019-06-13 22:29:51,249 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 22:29:51,249 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 22:29:51,249 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 22:29:51,249 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 22:29:51,249 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 35abba89-abc6-4670-9060-857dc3ad9419: start LeaderState
2019-06-13 22:29:51,250 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 35abba89-abc6-4670-9060-857dc3ad9419-RaftLogWorker: Starting segment from index:0
2019-06-13 22:29:51,251 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 35abba89-abc6-4670-9060-857dc3ad9419:group-B5E11ED2EA26 set configuration 0: [35abba89-abc6-4670-9060-857dc3ad9419:127.0.0.1:45995], old=null at 0
2019-06-13 22:29:51,286 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 35abba89-abc6-4670-9060-857dc3ad9419-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb1abcb02-4cf1-4a5a-a14a-f5384bcc93e3/ratis/e6bfe176-6e9d-45a5-af9b-b5e11ed2ea26/current/log_inprogress_0
2019-06-13 22:29:52,275 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 570187796134735294 is closed with bcsId 0.
2019-06-13 22:29:52,275 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 22:29:52,276 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 35abba89-abc6-4670-9060-857dc3ad9419: close
2019-06-13 22:29:52,276 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 35abba89-abc6-4670-9060-857dc3ad9419: shutdown group-B5E11ED2EA26
2019-06-13 22:29:52,276 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-B5E11ED2EA26,id=35abba89-abc6-4670-9060-857dc3ad9419
2019-06-13 22:29:52,276 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 35abba89-abc6-4670-9060-857dc3ad9419: shutdown LeaderState
2019-06-13 22:29:52,277 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 35abba89-abc6-4670-9060-857dc3ad9419-PendingRequests: sendNotLeaderResponses
2019-06-13 22:29:52,277 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-35abba89-abc6-4670-9060-857dc3ad9419-group-B5E11ED2EA26: set stopIndex = 2
2019-06-13 22:29:52,277 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-13 22:29:52,278 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb1abcb02-4cf1-4a5a-a14a-f5384bcc93e3/ratis/e6bfe176-6e9d-45a5-af9b-b5e11ed2ea26/sm/snapshot.1_2
2019-06-13 22:29:52,278 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 35abba89-abc6-4670-9060-857dc3ad9419:group-B5E11ED2EA26 closes. The last applied log index is 2
2019-06-13 22:29:52,278 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 35abba89-abc6-4670-9060-857dc3ad9419-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 22:29:52,279 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 35abba89-abc6-4670-9060-857dc3ad9419-RaftLogWorker close()
2019-06-13 22:29:52,280 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 35abba89-abc6-4670-9060-857dc3ad9419: shutdown server with port 45995 now
2019-06-13 22:29:52,282 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 35abba89-abc6-4670-9060-857dc3ad9419: shutdown server with port 45995 successfully
2019-06-13 22:29:52,284 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 22:29:52,322 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8c2c301f-2f9f-4b5b-aebd-7739c8e0e8b3/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 22:29:52,322 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8c2c301f-2f9f-4b5b-aebd-7739c8e0e8b3/hdds to VolumeSet
2019-06-13 22:29:52,322 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@7c84195
2019-06-13 22:29:52,323 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@7c84195
2019-06-13 22:29:52,332 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 46373
2019-06-13 22:29:52,333 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 22:29:52,334 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 22:29:52,334 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 46373 (custom)
2019-06-13 22:29:52,334 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 22:29:52,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 22:29:52,335 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 22:29:52,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 22:29:52,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8c2c301f-2f9f-4b5b-aebd-7739c8e0e8b3/ratis] (custom)
2019-06-13 22:29:52,336 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 37151
2019-06-13 22:29:52,337 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 22:29:52,337 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 22:29:52,337 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 2a300bca-99e7-4c56-813e-3037542f8e98 at port 46373
2019-06-13 22:29:52,347 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 2a300bca-99e7-4c56-813e-3037542f8e98: start RPC server
2019-06-13 22:29:52,348 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 2a300bca-99e7-4c56-813e-3037542f8e98: GrpcService started, listening on 0.0.0.0/0.0.0.0:46373
Jun 13, 2019 10:29:52 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:45995} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 13, 2019 10:29:52 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:37247} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-13 22:29:52,362 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 2a300bca-99e7-4c56-813e-3037542f8e98: addNew group-13915EA00C7B:[2a300bca-99e7-4c56-813e-3037542f8e98:127.0.0.1:46373] returns group-13915EA00C7B:java.util.concurrent.CompletableFuture@506b16ac[Not completed]
2019-06-13 22:29:52,363 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 2a300bca-99e7-4c56-813e-3037542f8e98: new RaftServerImpl for group-13915EA00C7B:[2a300bca-99e7-4c56-813e-3037542f8e98:127.0.0.1:46373] with ContainerStateMachine:uninitialized
2019-06-13 22:29:52,363 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 22:29:52,363 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 22:29:52,363 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 22:29:52,363 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 22:29:52,363 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 2a300bca-99e7-4c56-813e-3037542f8e98:group-13915EA00C7B ConfigurationManager, init=-1: [2a300bca-99e7-4c56-813e-3037542f8e98:127.0.0.1:46373], old=null, confs=<EMPTY_MAP>
2019-06-13 22:29:52,363 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8c2c301f-2f9f-4b5b-aebd-7739c8e0e8b3/ratis] (custom)
2019-06-13 22:29:52,364 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8c2c301f-2f9f-4b5b-aebd-7739c8e0e8b3/ratis/dfac7421-2ef0-4a25-9b0c-13915ea00c7b does not exist. Creating ...
2019-06-13 22:29:52,366 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8c2c301f-2f9f-4b5b-aebd-7739c8e0e8b3/ratis/dfac7421-2ef0-4a25-9b0c-13915ea00c7b/in_use.lock acquired by nodename 4178@ozone-t78nf-1192151138
2019-06-13 22:29:52,368 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8c2c301f-2f9f-4b5b-aebd-7739c8e0e8b3/ratis/dfac7421-2ef0-4a25-9b0c-13915ea00c7b has been successfully formatted.
2019-06-13 22:29:52,368 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 22:29:52,368 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 22:29:52,368 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 22:29:52,368 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 22:29:52,368 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 22:29:52,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 22:29:52,369 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 2a300bca-99e7-4c56-813e-3037542f8e98-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8c2c301f-2f9f-4b5b-aebd-7739c8e0e8b3/ratis/dfac7421-2ef0-4a25-9b0c-13915ea00c7b
2019-06-13 22:29:52,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 22:29:52,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 22:29:52,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 22:29:52,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 22:29:52,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 22:29:52,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 22:29:52,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 22:29:52,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 22:29:52,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 22:29:52,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 22:29:52,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 22:29:52,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 22:29:52,370 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 22:29:52,371 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 2a300bca-99e7-4c56-813e-3037542f8e98: start group-13915EA00C7B
2019-06-13 22:29:52,371 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2a300bca-99e7-4c56-813e-3037542f8e98:group-13915EA00C7B changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 22:29:52,371 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2a300bca-99e7-4c56-813e-3037542f8e98: start FollowerState
2019-06-13 22:29:52,371 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-13915EA00C7B,id=2a300bca-99e7-4c56-813e-3037542f8e98
2019-06-13 22:29:53,500 INFO  impl.FollowerState (FollowerState.java:run(101)) - 2a300bca-99e7-4c56-813e-3037542f8e98:group-13915EA00C7B changes to CANDIDATE, lastRpcTime:1129, electionTimeout:1129ms
2019-06-13 22:29:53,500 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 2a300bca-99e7-4c56-813e-3037542f8e98: shutdown FollowerState
2019-06-13 22:29:53,500 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2a300bca-99e7-4c56-813e-3037542f8e98:group-13915EA00C7B changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 22:29:53,500 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2a300bca-99e7-4c56-813e-3037542f8e98: start LeaderElection
2019-06-13 22:29:53,503 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 2a300bca-99e7-4c56-813e-3037542f8e98:group-13915EA00C7B:LeaderElection4: begin an election at term 1 for -1: [2a300bca-99e7-4c56-813e-3037542f8e98:127.0.0.1:46373], old=null
2019-06-13 22:29:53,504 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 2a300bca-99e7-4c56-813e-3037542f8e98: shutdown LeaderElection
2019-06-13 22:29:53,504 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2a300bca-99e7-4c56-813e-3037542f8e98:group-13915EA00C7B changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 22:29:53,504 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 2a300bca-99e7-4c56-813e-3037542f8e98:group-13915EA00C7B change Leader from null to 2a300bca-99e7-4c56-813e-3037542f8e98 at term 1 for becomeLeader, leader elected after 1135ms
2019-06-13 22:29:53,504 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 22:29:53,504 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 22:29:53,504 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 22:29:53,504 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 22:29:53,504 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2a300bca-99e7-4c56-813e-3037542f8e98: start LeaderState
2019-06-13 22:29:53,505 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 2a300bca-99e7-4c56-813e-3037542f8e98-RaftLogWorker: Starting segment from index:0
2019-06-13 22:29:53,505 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 2a300bca-99e7-4c56-813e-3037542f8e98:group-13915EA00C7B set configuration 0: [2a300bca-99e7-4c56-813e-3037542f8e98:127.0.0.1:46373], old=null at 0
2019-06-13 22:29:53,541 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 2a300bca-99e7-4c56-813e-3037542f8e98-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8c2c301f-2f9f-4b5b-aebd-7739c8e0e8b3/ratis/dfac7421-2ef0-4a25-9b0c-13915ea00c7b/current/log_inprogress_0
2019-06-13 22:29:54,407 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 1704964469226875475 is closed with bcsId 0.
2019-06-13 22:29:54,408 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 22:29:54,408 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 2a300bca-99e7-4c56-813e-3037542f8e98: close
2019-06-13 22:29:54,408 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 2a300bca-99e7-4c56-813e-3037542f8e98: shutdown group-13915EA00C7B
2019-06-13 22:29:54,409 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-13915EA00C7B,id=2a300bca-99e7-4c56-813e-3037542f8e98
2019-06-13 22:29:54,409 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 2a300bca-99e7-4c56-813e-3037542f8e98: shutdown LeaderState
2019-06-13 22:29:54,409 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 2a300bca-99e7-4c56-813e-3037542f8e98-PendingRequests: sendNotLeaderResponses
2019-06-13 22:29:54,410 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-2a300bca-99e7-4c56-813e-3037542f8e98-group-13915EA00C7B: set stopIndex = 2
2019-06-13 22:29:54,410 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-13 22:29:54,410 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8c2c301f-2f9f-4b5b-aebd-7739c8e0e8b3/ratis/dfac7421-2ef0-4a25-9b0c-13915ea00c7b/sm/snapshot.1_2
2019-06-13 22:29:54,411 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 2a300bca-99e7-4c56-813e-3037542f8e98:group-13915EA00C7B closes. The last applied log index is 2
2019-06-13 22:29:54,411 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 2a300bca-99e7-4c56-813e-3037542f8e98-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 22:29:54,411 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 2a300bca-99e7-4c56-813e-3037542f8e98-RaftLogWorker close()
2019-06-13 22:29:54,412 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 2a300bca-99e7-4c56-813e-3037542f8e98: shutdown server with port 46373 now
2019-06-13 22:29:54,413 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 2a300bca-99e7-4c56-813e-3037542f8e98: shutdown server with port 46373 successfully
2019-06-13 22:29:54,416 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 22:29:54,437 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler998d1591-88e1-4878-aa22-1669e6bc5be9/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 22:29:54,438 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler998d1591-88e1-4878-aa22-1669e6bc5be9/hdds to VolumeSet
2019-06-13 22:29:54,438 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@43f61afb
2019-06-13 22:29:54,438 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@43f61afb
2019-06-13 22:29:54,449 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 38577
2019-06-13 22:29:54,449 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 22:29:54,450 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 22:29:54,450 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 38577 (custom)
2019-06-13 22:29:54,451 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 22:29:54,451 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 22:29:54,451 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 22:29:54,451 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 22:29:54,452 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler998d1591-88e1-4878-aa22-1669e6bc5be9/ratis] (custom)
2019-06-13 22:29:54,452 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 40269
2019-06-13 22:29:54,453 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 22:29:54,453 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 22:29:54,454 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis b86b60d9-7a05-4825-9bf2-660f4b830589 at port 38577
2019-06-13 22:29:54,459 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - b86b60d9-7a05-4825-9bf2-660f4b830589: start RPC server
2019-06-13 22:29:54,460 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - b86b60d9-7a05-4825-9bf2-660f4b830589: GrpcService started, listening on 0.0.0.0/0.0.0.0:38577
2019-06-13 22:29:54,471 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - b86b60d9-7a05-4825-9bf2-660f4b830589: addNew group-2ED423E4D0C5:[b86b60d9-7a05-4825-9bf2-660f4b830589:127.0.0.1:38577] returns group-2ED423E4D0C5:java.util.concurrent.CompletableFuture@70b4011a[Not completed]
2019-06-13 22:29:54,471 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - b86b60d9-7a05-4825-9bf2-660f4b830589: new RaftServerImpl for group-2ED423E4D0C5:[b86b60d9-7a05-4825-9bf2-660f4b830589:127.0.0.1:38577] with ContainerStateMachine:uninitialized
2019-06-13 22:29:54,471 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 22:29:54,472 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 22:29:54,472 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 22:29:54,472 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 22:29:54,472 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - b86b60d9-7a05-4825-9bf2-660f4b830589:group-2ED423E4D0C5 ConfigurationManager, init=-1: [b86b60d9-7a05-4825-9bf2-660f4b830589:127.0.0.1:38577], old=null, confs=<EMPTY_MAP>
2019-06-13 22:29:54,472 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler998d1591-88e1-4878-aa22-1669e6bc5be9/ratis] (custom)
2019-06-13 22:29:54,472 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler998d1591-88e1-4878-aa22-1669e6bc5be9/ratis/ca7b2182-2742-4bea-8c21-2ed423e4d0c5 does not exist. Creating ...
2019-06-13 22:29:54,475 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler998d1591-88e1-4878-aa22-1669e6bc5be9/ratis/ca7b2182-2742-4bea-8c21-2ed423e4d0c5/in_use.lock acquired by nodename 4178@ozone-t78nf-1192151138
2019-06-13 22:29:54,477 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler998d1591-88e1-4878-aa22-1669e6bc5be9/ratis/ca7b2182-2742-4bea-8c21-2ed423e4d0c5 has been successfully formatted.
2019-06-13 22:29:54,477 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 22:29:54,477 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 22:29:54,477 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 22:29:54,477 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 22:29:54,477 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 22:29:54,478 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 22:29:54,478 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new b86b60d9-7a05-4825-9bf2-660f4b830589-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler998d1591-88e1-4878-aa22-1669e6bc5be9/ratis/ca7b2182-2742-4bea-8c21-2ed423e4d0c5
2019-06-13 22:29:54,478 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 22:29:54,478 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 22:29:54,478 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 22:29:54,478 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 22:29:54,478 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 22:29:54,478 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 22:29:54,479 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 22:29:54,479 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 22:29:54,479 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 22:29:54,479 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 22:29:54,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 22:29:54,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 22:29:54,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 22:29:54,482 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - b86b60d9-7a05-4825-9bf2-660f4b830589: start group-2ED423E4D0C5
2019-06-13 22:29:54,483 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b86b60d9-7a05-4825-9bf2-660f4b830589:group-2ED423E4D0C5 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 22:29:54,483 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b86b60d9-7a05-4825-9bf2-660f4b830589: start FollowerState
2019-06-13 22:29:54,483 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-2ED423E4D0C5,id=b86b60d9-7a05-4825-9bf2-660f4b830589
2019-06-13 22:29:55,681 INFO  impl.FollowerState (FollowerState.java:run(101)) - b86b60d9-7a05-4825-9bf2-660f4b830589:group-2ED423E4D0C5 changes to CANDIDATE, lastRpcTime:1198, electionTimeout:1198ms
2019-06-13 22:29:55,681 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b86b60d9-7a05-4825-9bf2-660f4b830589: shutdown FollowerState
2019-06-13 22:29:55,681 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b86b60d9-7a05-4825-9bf2-660f4b830589:group-2ED423E4D0C5 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 22:29:55,681 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b86b60d9-7a05-4825-9bf2-660f4b830589: start LeaderElection
2019-06-13 22:29:55,684 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b86b60d9-7a05-4825-9bf2-660f4b830589:group-2ED423E4D0C5:LeaderElection5: begin an election at term 1 for -1: [b86b60d9-7a05-4825-9bf2-660f4b830589:127.0.0.1:38577], old=null
2019-06-13 22:29:55,685 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b86b60d9-7a05-4825-9bf2-660f4b830589: shutdown LeaderElection
2019-06-13 22:29:55,685 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b86b60d9-7a05-4825-9bf2-660f4b830589:group-2ED423E4D0C5 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 22:29:55,685 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - b86b60d9-7a05-4825-9bf2-660f4b830589:group-2ED423E4D0C5 change Leader from null to b86b60d9-7a05-4825-9bf2-660f4b830589 at term 1 for becomeLeader, leader elected after 1207ms
2019-06-13 22:29:55,685 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 22:29:55,685 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 22:29:55,685 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 22:29:55,685 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 22:29:55,686 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b86b60d9-7a05-4825-9bf2-660f4b830589: start LeaderState
2019-06-13 22:29:55,686 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - b86b60d9-7a05-4825-9bf2-660f4b830589-RaftLogWorker: Starting segment from index:0
2019-06-13 22:29:55,687 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - b86b60d9-7a05-4825-9bf2-660f4b830589:group-2ED423E4D0C5 set configuration 0: [b86b60d9-7a05-4825-9bf2-660f4b830589:127.0.0.1:38577], old=null at 0
2019-06-13 22:29:55,721 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - b86b60d9-7a05-4825-9bf2-660f4b830589-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler998d1591-88e1-4878-aa22-1669e6bc5be9/ratis/ca7b2182-2742-4bea-8c21-2ed423e4d0c5/current/log_inprogress_0
2019-06-13 22:29:56,522 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 6936505329571793759 is closed with bcsId 0.
2019-06-13 22:29:56,523 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 22:29:56,523 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - b86b60d9-7a05-4825-9bf2-660f4b830589: close
2019-06-13 22:29:56,523 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - b86b60d9-7a05-4825-9bf2-660f4b830589: shutdown group-2ED423E4D0C5
2019-06-13 22:29:56,523 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-2ED423E4D0C5,id=b86b60d9-7a05-4825-9bf2-660f4b830589
2019-06-13 22:29:56,523 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - b86b60d9-7a05-4825-9bf2-660f4b830589: shutdown LeaderState
2019-06-13 22:29:56,524 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - b86b60d9-7a05-4825-9bf2-660f4b830589-PendingRequests: sendNotLeaderResponses
2019-06-13 22:29:56,524 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-b86b60d9-7a05-4825-9bf2-660f4b830589-group-2ED423E4D0C5: set stopIndex = 4
2019-06-13 22:29:56,524 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-13 22:29:56,525 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler998d1591-88e1-4878-aa22-1669e6bc5be9/ratis/ca7b2182-2742-4bea-8c21-2ed423e4d0c5/sm/snapshot.1_4
2019-06-13 22:29:56,525 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - b86b60d9-7a05-4825-9bf2-660f4b830589:group-2ED423E4D0C5 closes. The last applied log index is 4
2019-06-13 22:29:56,525 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - b86b60d9-7a05-4825-9bf2-660f4b830589-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 22:29:56,526 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - b86b60d9-7a05-4825-9bf2-660f4b830589-RaftLogWorker close()
2019-06-13 22:29:56,526 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - b86b60d9-7a05-4825-9bf2-660f4b830589: shutdown server with port 38577 now
2019-06-13 22:29:56,527 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - b86b60d9-7a05-4825-9bf2-660f4b830589: shutdown server with port 38577 successfully
2019-06-13 22:29:56,530 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
