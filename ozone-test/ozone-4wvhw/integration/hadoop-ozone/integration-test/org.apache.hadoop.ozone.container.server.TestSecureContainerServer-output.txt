2019-06-13 01:58:43,333 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-13 01:58:43,408 INFO  ozone.RatisTestHelper (RatisTestHelper.java:initRatisConf(109)) - dfs.container.ratis.rpc.type = GRPC
2019-06-13 01:58:43,464 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 01:58:43,473 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 41445 (custom)
2019-06-13 01:58:43,474 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 01:58:43,477 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 01:58:43,477 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 01:58:43,478 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 01:58:43,531 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/931bb78e-819e-49ba-a28f-78af76b538ef] (custom)
2019-06-13 01:58:43,537 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 931bb78e-819e-49ba-a28f-78af76b538ef at port 41445
2019-06-13 01:58:43,557 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 931bb78e-819e-49ba-a28f-78af76b538ef: start RPC server
2019-06-13 01:58:43,559 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 931bb78e-819e-49ba-a28f-78af76b538ef: GrpcService started, listening on 0.0.0.0/0.0.0.0:41445
2019-06-13 01:58:43,641 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 931bb78e-819e-49ba-a28f-78af76b538ef: addNew group-6F92EB2925D2:[931bb78e-819e-49ba-a28f-78af76b538ef:0.0.0.0:41445] returns group-6F92EB2925D2:java.util.concurrent.CompletableFuture@1d3470ce[Not completed]
2019-06-13 01:58:43,647 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 931bb78e-819e-49ba-a28f-78af76b538ef: new RaftServerImpl for group-6F92EB2925D2:[931bb78e-819e-49ba-a28f-78af76b538ef:0.0.0.0:41445] with ContainerStateMachine:uninitialized
2019-06-13 01:58:43,648 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 01:58:43,649 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 01:58:43,650 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 01:58:43,650 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 01:58:43,655 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 931bb78e-819e-49ba-a28f-78af76b538ef:group-6F92EB2925D2 ConfigurationManager, init=-1: [931bb78e-819e-49ba-a28f-78af76b538ef:0.0.0.0:41445], old=null, confs=<EMPTY_MAP>
2019-06-13 01:58:43,655 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/931bb78e-819e-49ba-a28f-78af76b538ef] (custom)
2019-06-13 01:58:43,660 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/931bb78e-819e-49ba-a28f-78af76b538ef/de2b48b6-0219-4ec8-b38f-6f92eb2925d2 does not exist. Creating ...
2019-06-13 01:58:43,668 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/931bb78e-819e-49ba-a28f-78af76b538ef/de2b48b6-0219-4ec8-b38f-6f92eb2925d2/in_use.lock acquired by nodename 26442@ozone-4wvhw-1461943245
2019-06-13 01:58:43,674 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/931bb78e-819e-49ba-a28f-78af76b538ef/de2b48b6-0219-4ec8-b38f-6f92eb2925d2 has been successfully formatted.
2019-06-13 01:58:43,675 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 01:58:43,676 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 01:58:43,677 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 01:58:43,679 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 01:58:43,681 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 01:58:43,684 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 01:58:43,686 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 931bb78e-819e-49ba-a28f-78af76b538ef-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/931bb78e-819e-49ba-a28f-78af76b538ef/de2b48b6-0219-4ec8-b38f-6f92eb2925d2
2019-06-13 01:58:43,686 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 01:58:43,687 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 01:58:43,688 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 01:58:43,688 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 01:58:43,689 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 01:58:43,689 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 01:58:43,690 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 01:58:43,690 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 01:58:43,691 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 01:58:43,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 01:58:43,697 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 01:58:43,698 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 01:58:43,698 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 01:58:43,711 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 931bb78e-819e-49ba-a28f-78af76b538ef: start group-6F92EB2925D2
2019-06-13 01:58:43,711 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 931bb78e-819e-49ba-a28f-78af76b538ef:group-6F92EB2925D2 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 01:58:43,712 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 931bb78e-819e-49ba-a28f-78af76b538ef: start FollowerState
2019-06-13 01:58:43,758 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-6F92EB2925D2,id=931bb78e-819e-49ba-a28f-78af76b538ef
2019-06-13 01:58:43,811 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-34D8F23A210B->931bb78e-819e-49ba-a28f-78af76b538ef: receive RaftClientReply:client-34D8F23A210B->931bb78e-819e-49ba-a28f-78af76b538ef@group-6F92EB2925D2, cid=1, FAILED org.apache.ratis.protocol.NotLeaderException: Server 931bb78e-819e-49ba-a28f-78af76b538ef is not the leader (null). Request must be sent to leader., logIndex=0, commits[931bb78e-819e-49ba-a28f-78af76b538ef:c-1]
2019-06-13 01:58:44,819 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-34D8F23A210B->931bb78e-819e-49ba-a28f-78af76b538ef: receive RaftClientReply:client-34D8F23A210B->931bb78e-819e-49ba-a28f-78af76b538ef@group-6F92EB2925D2, cid=1, FAILED org.apache.ratis.protocol.NotLeaderException: Server 931bb78e-819e-49ba-a28f-78af76b538ef is not the leader (null). Request must be sent to leader., logIndex=0, commits[931bb78e-819e-49ba-a28f-78af76b538ef:c-1]
2019-06-13 01:58:44,884 INFO  impl.FollowerState (FollowerState.java:run(101)) - 931bb78e-819e-49ba-a28f-78af76b538ef:group-6F92EB2925D2 changes to CANDIDATE, lastRpcTime:1171, electionTimeout:1171ms
2019-06-13 01:58:44,884 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 931bb78e-819e-49ba-a28f-78af76b538ef: shutdown FollowerState
2019-06-13 01:58:44,884 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 931bb78e-819e-49ba-a28f-78af76b538ef:group-6F92EB2925D2 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 01:58:44,885 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 931bb78e-819e-49ba-a28f-78af76b538ef: start LeaderElection
2019-06-13 01:58:44,888 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 931bb78e-819e-49ba-a28f-78af76b538ef:group-6F92EB2925D2:LeaderElection1: begin an election at term 1 for -1: [931bb78e-819e-49ba-a28f-78af76b538ef:0.0.0.0:41445], old=null
2019-06-13 01:58:44,889 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 931bb78e-819e-49ba-a28f-78af76b538ef: shutdown LeaderElection
2019-06-13 01:58:44,889 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 931bb78e-819e-49ba-a28f-78af76b538ef:group-6F92EB2925D2 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 01:58:44,889 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 931bb78e-819e-49ba-a28f-78af76b538ef:group-6F92EB2925D2 change Leader from null to 931bb78e-819e-49ba-a28f-78af76b538ef at term 1 for becomeLeader, leader elected after 1213ms
2019-06-13 01:58:44,893 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 01:58:44,893 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 01:58:44,895 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 01:58:44,895 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 01:58:44,901 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 931bb78e-819e-49ba-a28f-78af76b538ef: start LeaderState
2019-06-13 01:58:44,912 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 931bb78e-819e-49ba-a28f-78af76b538ef-RaftLogWorker: Starting segment from index:0
2019-06-13 01:58:44,920 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 931bb78e-819e-49ba-a28f-78af76b538ef:group-6F92EB2925D2 set configuration 0: [931bb78e-819e-49ba-a28f-78af76b538ef:0.0.0.0:41445], old=null at 0
2019-06-13 01:58:45,047 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 931bb78e-819e-49ba-a28f-78af76b538ef-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/931bb78e-819e-49ba-a28f-78af76b538ef/de2b48b6-0219-4ec8-b38f-6f92eb2925d2/current/log_inprogress_0
2019-06-13 01:58:45,834 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-13 01:58:45,838 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-34D8F23A210B->931bb78e-819e-49ba-a28f-78af76b538ef: receive RaftClientReply:client-34D8F23A210B->931bb78e-819e-49ba-a28f-78af76b538ef@group-6F92EB2925D2, cid=1, SUCCESS, logIndex=1, commits[931bb78e-819e-49ba-a28f-78af76b538ef:c2]
2019-06-13 01:58:45,839 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-13 01:58:45,855 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-56EE26DB1193->931bb78e-819e-49ba-a28f-78af76b538ef: receive RaftClientReply:client-56EE26DB1193->931bb78e-819e-49ba-a28f-78af76b538ef@group-6F92EB2925D2, cid=2, SUCCESS, logIndex=3, commits[931bb78e-819e-49ba-a28f-78af76b538ef:c3]
2019-06-13 01:58:45,858 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 931bb78e-819e-49ba-a28f-78af76b538ef: close
2019-06-13 01:58:45,859 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 931bb78e-819e-49ba-a28f-78af76b538ef: shutdown group-6F92EB2925D2
2019-06-13 01:58:45,860 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-6F92EB2925D2,id=931bb78e-819e-49ba-a28f-78af76b538ef
2019-06-13 01:58:45,860 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 01:58:45,860 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 931bb78e-819e-49ba-a28f-78af76b538ef: shutdown LeaderState
2019-06-13 01:58:45,860 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 01:58:45,861 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 931bb78e-819e-49ba-a28f-78af76b538ef-PendingRequests: sendNotLeaderResponses
2019-06-13 01:58:45,864 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-13 01:58:45,866 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/931bb78e-819e-49ba-a28f-78af76b538ef/de2b48b6-0219-4ec8-b38f-6f92eb2925d2/sm/snapshot.1_3
2019-06-13 01:58:45,866 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-931bb78e-819e-49ba-a28f-78af76b538ef-group-6F92EB2925D2: set stopIndex = 4
2019-06-13 01:58:45,874 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 931bb78e-819e-49ba-a28f-78af76b538ef:group-6F92EB2925D2 closes. The last applied log index is 4
2019-06-13 01:58:45,875 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 931bb78e-819e-49ba-a28f-78af76b538ef-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 01:58:45,875 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 931bb78e-819e-49ba-a28f-78af76b538ef-RaftLogWorker close()
2019-06-13 01:58:45,876 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 931bb78e-819e-49ba-a28f-78af76b538ef: shutdown server with port 41445 now
2019-06-13 01:58:45,877 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 931bb78e-819e-49ba-a28f-78af76b538ef: shutdown server with port 41445 successfully
2019-06-13 01:58:45,904 INFO  ozone.RatisTestHelper (RatisTestHelper.java:initRatisConf(109)) - dfs.container.ratis.rpc.type = GRPC
2019-06-13 01:58:45,905 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 01:58:45,906 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43671 (custom)
2019-06-13 01:58:45,906 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 01:58:45,907 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 01:58:45,907 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 01:58:45,907 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 01:58:45,908 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/bbdd9373-7b20-4539-9e16-925db84db283] (custom)
2019-06-13 01:58:45,908 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis bbdd9373-7b20-4539-9e16-925db84db283 at port 43671
2019-06-13 01:58:45,919 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - bbdd9373-7b20-4539-9e16-925db84db283: start RPC server
2019-06-13 01:58:45,920 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - bbdd9373-7b20-4539-9e16-925db84db283: GrpcService started, listening on 0.0.0.0/0.0.0.0:43671
Jun 13, 2019 1:58:45 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=17, target=0.0.0.0:41445} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:130)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 13, 2019 1:58:45 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=9, target=0.0.0.0:44565} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connectToDatanode(XceiverClientGrpc.java:163)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connect(XceiverClientGrpc.java:120)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:227)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServer(TestSecureContainerServer.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-13 01:58:45,947 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - bbdd9373-7b20-4539-9e16-925db84db283: addNew group-D64D73DF3432:[2259f741-e8ca-4761-8b4f-763deedf3225:0.0.0.0:44103, 44a380f1-0667-49f9-b95f-17bef801b1c0:0.0.0.0:40333, bbdd9373-7b20-4539-9e16-925db84db283:0.0.0.0:43671] returns group-D64D73DF3432:java.util.concurrent.CompletableFuture@4761cfbf[Not completed]
2019-06-13 01:58:45,947 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - bbdd9373-7b20-4539-9e16-925db84db283: new RaftServerImpl for group-D64D73DF3432:[2259f741-e8ca-4761-8b4f-763deedf3225:0.0.0.0:44103, 44a380f1-0667-49f9-b95f-17bef801b1c0:0.0.0.0:40333, bbdd9373-7b20-4539-9e16-925db84db283:0.0.0.0:43671] with ContainerStateMachine:uninitialized
2019-06-13 01:58:45,948 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 01:58:45,948 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 01:58:45,948 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 01:58:45,948 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 01:58:45,948 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - bbdd9373-7b20-4539-9e16-925db84db283:group-D64D73DF3432 ConfigurationManager, init=-1: [2259f741-e8ca-4761-8b4f-763deedf3225:0.0.0.0:44103, 44a380f1-0667-49f9-b95f-17bef801b1c0:0.0.0.0:40333, bbdd9373-7b20-4539-9e16-925db84db283:0.0.0.0:43671], old=null, confs=<EMPTY_MAP>
2019-06-13 01:58:45,948 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/bbdd9373-7b20-4539-9e16-925db84db283] (custom)
2019-06-13 01:58:45,948 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/bbdd9373-7b20-4539-9e16-925db84db283/b560ed33-e7ae-4c9f-b4c2-d64d73df3432 does not exist. Creating ...
2019-06-13 01:58:45,951 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/bbdd9373-7b20-4539-9e16-925db84db283/b560ed33-e7ae-4c9f-b4c2-d64d73df3432/in_use.lock acquired by nodename 26442@ozone-4wvhw-1461943245
2019-06-13 01:58:45,953 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/bbdd9373-7b20-4539-9e16-925db84db283/b560ed33-e7ae-4c9f-b4c2-d64d73df3432 has been successfully formatted.
2019-06-13 01:58:45,953 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 01:58:45,953 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 01:58:45,953 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 01:58:45,954 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 01:58:45,954 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 01:58:45,954 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 01:58:45,954 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new bbdd9373-7b20-4539-9e16-925db84db283-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/bbdd9373-7b20-4539-9e16-925db84db283/b560ed33-e7ae-4c9f-b4c2-d64d73df3432
2019-06-13 01:58:45,954 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 01:58:45,954 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 01:58:45,954 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 01:58:45,954 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 01:58:45,954 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 01:58:45,955 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 01:58:45,955 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 01:58:45,955 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 01:58:45,955 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 01:58:45,955 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 01:58:45,955 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 01:58:45,956 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 01:58:45,956 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 01:58:45,956 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - bbdd9373-7b20-4539-9e16-925db84db283: start group-D64D73DF3432
2019-06-13 01:58:45,956 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bbdd9373-7b20-4539-9e16-925db84db283:group-D64D73DF3432 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 01:58:45,956 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bbdd9373-7b20-4539-9e16-925db84db283: start FollowerState
2019-06-13 01:58:45,957 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D64D73DF3432,id=bbdd9373-7b20-4539-9e16-925db84db283
2019-06-13 01:58:45,961 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 01:58:45,961 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 44103 (custom)
2019-06-13 01:58:45,961 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 01:58:45,961 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 01:58:45,962 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 01:58:45,962 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 01:58:45,963 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/2259f741-e8ca-4761-8b4f-763deedf3225] (custom)
2019-06-13 01:58:45,963 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 2259f741-e8ca-4761-8b4f-763deedf3225 at port 44103
2019-06-13 01:58:45,970 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 2259f741-e8ca-4761-8b4f-763deedf3225: start RPC server
2019-06-13 01:58:45,971 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 2259f741-e8ca-4761-8b4f-763deedf3225: GrpcService started, listening on 0.0.0.0/0.0.0.0:44103
2019-06-13 01:58:45,990 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 2259f741-e8ca-4761-8b4f-763deedf3225: addNew group-D64D73DF3432:[2259f741-e8ca-4761-8b4f-763deedf3225:0.0.0.0:44103, 44a380f1-0667-49f9-b95f-17bef801b1c0:0.0.0.0:40333, bbdd9373-7b20-4539-9e16-925db84db283:0.0.0.0:43671] returns group-D64D73DF3432:java.util.concurrent.CompletableFuture@4361d1c2[Not completed]
2019-06-13 01:58:45,991 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 2259f741-e8ca-4761-8b4f-763deedf3225: new RaftServerImpl for group-D64D73DF3432:[2259f741-e8ca-4761-8b4f-763deedf3225:0.0.0.0:44103, 44a380f1-0667-49f9-b95f-17bef801b1c0:0.0.0.0:40333, bbdd9373-7b20-4539-9e16-925db84db283:0.0.0.0:43671] with ContainerStateMachine:uninitialized
2019-06-13 01:58:45,991 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 01:58:45,991 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 01:58:45,991 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 01:58:45,992 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 01:58:45,992 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 2259f741-e8ca-4761-8b4f-763deedf3225:group-D64D73DF3432 ConfigurationManager, init=-1: [2259f741-e8ca-4761-8b4f-763deedf3225:0.0.0.0:44103, 44a380f1-0667-49f9-b95f-17bef801b1c0:0.0.0.0:40333, bbdd9373-7b20-4539-9e16-925db84db283:0.0.0.0:43671], old=null, confs=<EMPTY_MAP>
2019-06-13 01:58:45,992 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/2259f741-e8ca-4761-8b4f-763deedf3225] (custom)
2019-06-13 01:58:45,992 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/2259f741-e8ca-4761-8b4f-763deedf3225/b560ed33-e7ae-4c9f-b4c2-d64d73df3432 does not exist. Creating ...
2019-06-13 01:58:45,994 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/2259f741-e8ca-4761-8b4f-763deedf3225/b560ed33-e7ae-4c9f-b4c2-d64d73df3432/in_use.lock acquired by nodename 26442@ozone-4wvhw-1461943245
2019-06-13 01:58:45,996 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/2259f741-e8ca-4761-8b4f-763deedf3225/b560ed33-e7ae-4c9f-b4c2-d64d73df3432 has been successfully formatted.
2019-06-13 01:58:45,996 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 01:58:45,997 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 01:58:45,997 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 01:58:45,997 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 01:58:45,997 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 01:58:45,997 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 01:58:45,997 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 2259f741-e8ca-4761-8b4f-763deedf3225-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/2259f741-e8ca-4761-8b4f-763deedf3225/b560ed33-e7ae-4c9f-b4c2-d64d73df3432
2019-06-13 01:58:45,997 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 01:58:45,997 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 01:58:45,997 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 01:58:45,997 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 01:58:45,998 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 01:58:45,998 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 01:58:45,998 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 01:58:45,998 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 01:58:45,998 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 01:58:45,998 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 01:58:45,998 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 01:58:45,999 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 01:58:45,999 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 01:58:45,999 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 2259f741-e8ca-4761-8b4f-763deedf3225: start group-D64D73DF3432
2019-06-13 01:58:45,999 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2259f741-e8ca-4761-8b4f-763deedf3225:group-D64D73DF3432 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 01:58:45,999 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2259f741-e8ca-4761-8b4f-763deedf3225: start FollowerState
2019-06-13 01:58:45,999 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D64D73DF3432,id=2259f741-e8ca-4761-8b4f-763deedf3225
2019-06-13 01:58:46,003 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 01:58:46,003 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 40333 (custom)
2019-06-13 01:58:46,004 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 01:58:46,004 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 01:58:46,004 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 01:58:46,004 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 01:58:46,005 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/44a380f1-0667-49f9-b95f-17bef801b1c0] (custom)
2019-06-13 01:58:46,005 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 44a380f1-0667-49f9-b95f-17bef801b1c0 at port 40333
2019-06-13 01:58:46,013 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 44a380f1-0667-49f9-b95f-17bef801b1c0: start RPC server
2019-06-13 01:58:46,014 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 44a380f1-0667-49f9-b95f-17bef801b1c0: GrpcService started, listening on 0.0.0.0/0.0.0.0:40333
2019-06-13 01:58:46,033 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 44a380f1-0667-49f9-b95f-17bef801b1c0: addNew group-D64D73DF3432:[2259f741-e8ca-4761-8b4f-763deedf3225:0.0.0.0:44103, 44a380f1-0667-49f9-b95f-17bef801b1c0:0.0.0.0:40333, bbdd9373-7b20-4539-9e16-925db84db283:0.0.0.0:43671] returns group-D64D73DF3432:java.util.concurrent.CompletableFuture@7537a938[Not completed]
2019-06-13 01:58:46,034 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 44a380f1-0667-49f9-b95f-17bef801b1c0: new RaftServerImpl for group-D64D73DF3432:[2259f741-e8ca-4761-8b4f-763deedf3225:0.0.0.0:44103, 44a380f1-0667-49f9-b95f-17bef801b1c0:0.0.0.0:40333, bbdd9373-7b20-4539-9e16-925db84db283:0.0.0.0:43671] with ContainerStateMachine:uninitialized
2019-06-13 01:58:46,034 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 01:58:46,034 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 01:58:46,034 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 01:58:46,035 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 01:58:46,035 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 44a380f1-0667-49f9-b95f-17bef801b1c0:group-D64D73DF3432 ConfigurationManager, init=-1: [2259f741-e8ca-4761-8b4f-763deedf3225:0.0.0.0:44103, 44a380f1-0667-49f9-b95f-17bef801b1c0:0.0.0.0:40333, bbdd9373-7b20-4539-9e16-925db84db283:0.0.0.0:43671], old=null, confs=<EMPTY_MAP>
2019-06-13 01:58:46,035 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/44a380f1-0667-49f9-b95f-17bef801b1c0] (custom)
2019-06-13 01:58:46,035 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/44a380f1-0667-49f9-b95f-17bef801b1c0/b560ed33-e7ae-4c9f-b4c2-d64d73df3432 does not exist. Creating ...
2019-06-13 01:58:46,037 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/44a380f1-0667-49f9-b95f-17bef801b1c0/b560ed33-e7ae-4c9f-b4c2-d64d73df3432/in_use.lock acquired by nodename 26442@ozone-4wvhw-1461943245
2019-06-13 01:58:46,039 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/44a380f1-0667-49f9-b95f-17bef801b1c0/b560ed33-e7ae-4c9f-b4c2-d64d73df3432 has been successfully formatted.
2019-06-13 01:58:46,040 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 01:58:46,040 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 01:58:46,040 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 01:58:46,040 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 01:58:46,040 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 01:58:46,040 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 01:58:46,040 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 44a380f1-0667-49f9-b95f-17bef801b1c0-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/44a380f1-0667-49f9-b95f-17bef801b1c0/b560ed33-e7ae-4c9f-b4c2-d64d73df3432
2019-06-13 01:58:46,040 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 01:58:46,040 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 01:58:46,041 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 01:58:46,041 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 01:58:46,041 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 01:58:46,041 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 01:58:46,041 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 01:58:46,041 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 01:58:46,041 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 01:58:46,041 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 01:58:46,042 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 01:58:46,042 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 01:58:46,042 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 01:58:46,042 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 44a380f1-0667-49f9-b95f-17bef801b1c0: start group-D64D73DF3432
2019-06-13 01:58:46,042 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 44a380f1-0667-49f9-b95f-17bef801b1c0:group-D64D73DF3432 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 01:58:46,042 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 44a380f1-0667-49f9-b95f-17bef801b1c0: start FollowerState
2019-06-13 01:58:46,043 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D64D73DF3432,id=44a380f1-0667-49f9-b95f-17bef801b1c0
2019-06-13 01:58:46,055 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-CE4B8533D99B->bbdd9373-7b20-4539-9e16-925db84db283: receive RaftClientReply:client-CE4B8533D99B->bbdd9373-7b20-4539-9e16-925db84db283@group-D64D73DF3432, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server bbdd9373-7b20-4539-9e16-925db84db283 is not the leader (2259f741-e8ca-4761-8b4f-763deedf3225:0.0.0.0:44103). Request must be sent to leader., logIndex=0, commits[bbdd9373-7b20-4539-9e16-925db84db283:c-1]
2019-06-13 01:58:46,057 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 01:58:47,067 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-CE4B8533D99B->2259f741-e8ca-4761-8b4f-763deedf3225: receive RaftClientReply:client-CE4B8533D99B->2259f741-e8ca-4761-8b4f-763deedf3225@group-D64D73DF3432, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server 2259f741-e8ca-4761-8b4f-763deedf3225 is not the leader (44a380f1-0667-49f9-b95f-17bef801b1c0:0.0.0.0:40333). Request must be sent to leader., logIndex=0, commits[2259f741-e8ca-4761-8b4f-763deedf3225:c-1]
2019-06-13 01:58:47,069 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 01:58:47,087 INFO  impl.FollowerState (FollowerState.java:run(101)) - 44a380f1-0667-49f9-b95f-17bef801b1c0:group-D64D73DF3432 changes to CANDIDATE, lastRpcTime:1044, electionTimeout:1044ms
2019-06-13 01:58:47,087 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 44a380f1-0667-49f9-b95f-17bef801b1c0: shutdown FollowerState
2019-06-13 01:58:47,088 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 44a380f1-0667-49f9-b95f-17bef801b1c0:group-D64D73DF3432 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 01:58:47,088 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 44a380f1-0667-49f9-b95f-17bef801b1c0: start LeaderElection
2019-06-13 01:58:47,091 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 44a380f1-0667-49f9-b95f-17bef801b1c0:group-D64D73DF3432:LeaderElection2: begin an election at term 1 for -1: [2259f741-e8ca-4761-8b4f-763deedf3225:0.0.0.0:44103, 44a380f1-0667-49f9-b95f-17bef801b1c0:0.0.0.0:40333, bbdd9373-7b20-4539-9e16-925db84db283:0.0.0.0:43671], old=null
2019-06-13 01:58:47,107 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bbdd9373-7b20-4539-9e16-925db84db283:group-D64D73DF3432 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:44a380f1-0667-49f9-b95f-17bef801b1c0
2019-06-13 01:58:47,107 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2259f741-e8ca-4761-8b4f-763deedf3225:group-D64D73DF3432 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:44a380f1-0667-49f9-b95f-17bef801b1c0
2019-06-13 01:58:47,107 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - bbdd9373-7b20-4539-9e16-925db84db283: shutdown FollowerState
2019-06-13 01:58:47,108 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 2259f741-e8ca-4761-8b4f-763deedf3225: shutdown FollowerState
2019-06-13 01:58:47,108 INFO  impl.FollowerState (FollowerState.java:run(109)) - bbdd9373-7b20-4539-9e16-925db84db283: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 01:58:47,108 INFO  impl.FollowerState (FollowerState.java:run(109)) - 2259f741-e8ca-4761-8b4f-763deedf3225: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 01:58:47,108 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2259f741-e8ca-4761-8b4f-763deedf3225: start FollowerState
2019-06-13 01:58:47,108 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bbdd9373-7b20-4539-9e16-925db84db283: start FollowerState
2019-06-13 01:58:47,175 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 44a380f1-0667-49f9-b95f-17bef801b1c0:group-D64D73DF3432:LeaderElection2: Election PASSED; received 1 response(s) [44a380f1-0667-49f9-b95f-17bef801b1c0->2259f741-e8ca-4761-8b4f-763deedf3225,true-t1] and 0 exception(s); 44a380f1-0667-49f9-b95f-17bef801b1c0:t1, leader=null, voted=44a380f1-0667-49f9-b95f-17bef801b1c0, raftlog=44a380f1-0667-49f9-b95f-17bef801b1c0-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [2259f741-e8ca-4761-8b4f-763deedf3225:0.0.0.0:44103, 44a380f1-0667-49f9-b95f-17bef801b1c0:0.0.0.0:40333, bbdd9373-7b20-4539-9e16-925db84db283:0.0.0.0:43671], old=null
2019-06-13 01:58:47,175 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 44a380f1-0667-49f9-b95f-17bef801b1c0: shutdown LeaderElection
2019-06-13 01:58:47,175 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 44a380f1-0667-49f9-b95f-17bef801b1c0:group-D64D73DF3432 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 01:58:47,175 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 44a380f1-0667-49f9-b95f-17bef801b1c0:group-D64D73DF3432 change Leader from null to 44a380f1-0667-49f9-b95f-17bef801b1c0 at term 1 for becomeLeader, leader elected after 1135ms
2019-06-13 01:58:47,175 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 01:58:47,176 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 01:58:47,176 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 01:58:47,176 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 01:58:47,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 01:58:47,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 01:58:47,179 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 01:58:47,180 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 01:58:47,180 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 01:58:47,180 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 01:58:47,180 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 01:58:47,181 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 01:58:47,181 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 01:58:47,181 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 01:58:47,181 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 01:58:47,182 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 01:58:47,182 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 44a380f1-0667-49f9-b95f-17bef801b1c0: start LeaderState
2019-06-13 01:58:47,182 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 44a380f1-0667-49f9-b95f-17bef801b1c0-RaftLogWorker: Starting segment from index:0
2019-06-13 01:58:47,190 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 44a380f1-0667-49f9-b95f-17bef801b1c0:group-D64D73DF3432 set configuration 0: [2259f741-e8ca-4761-8b4f-763deedf3225:0.0.0.0:44103, 44a380f1-0667-49f9-b95f-17bef801b1c0:0.0.0.0:40333, bbdd9373-7b20-4539-9e16-925db84db283:0.0.0.0:43671], old=null at 0
2019-06-13 01:58:47,219 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 2259f741-e8ca-4761-8b4f-763deedf3225:group-D64D73DF3432 change Leader from null to 44a380f1-0667-49f9-b95f-17bef801b1c0 at term 1 for appendEntries, leader elected after 1222ms
2019-06-13 01:58:47,220 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 44a380f1-0667-49f9-b95f-17bef801b1c0-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/44a380f1-0667-49f9-b95f-17bef801b1c0/b560ed33-e7ae-4c9f-b4c2-d64d73df3432/current/log_inprogress_0
2019-06-13 01:58:47,220 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - bbdd9373-7b20-4539-9e16-925db84db283:group-D64D73DF3432 change Leader from null to 44a380f1-0667-49f9-b95f-17bef801b1c0 at term 1 for appendEntries, leader elected after 1266ms
2019-06-13 01:58:47,237 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 2259f741-e8ca-4761-8b4f-763deedf3225:group-D64D73DF3432 set configuration 0: [2259f741-e8ca-4761-8b4f-763deedf3225:0.0.0.0:44103, 44a380f1-0667-49f9-b95f-17bef801b1c0:0.0.0.0:40333, bbdd9373-7b20-4539-9e16-925db84db283:0.0.0.0:43671], old=null at 0
2019-06-13 01:58:47,237 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - bbdd9373-7b20-4539-9e16-925db84db283:group-D64D73DF3432 set configuration 0: [2259f741-e8ca-4761-8b4f-763deedf3225:0.0.0.0:44103, 44a380f1-0667-49f9-b95f-17bef801b1c0:0.0.0.0:40333, bbdd9373-7b20-4539-9e16-925db84db283:0.0.0.0:43671], old=null at 0
2019-06-13 01:58:47,238 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 2259f741-e8ca-4761-8b4f-763deedf3225-RaftLogWorker: Starting segment from index:0
2019-06-13 01:58:47,238 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - bbdd9373-7b20-4539-9e16-925db84db283-RaftLogWorker: Starting segment from index:0
2019-06-13 01:58:47,279 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 2259f741-e8ca-4761-8b4f-763deedf3225-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/2259f741-e8ca-4761-8b4f-763deedf3225/b560ed33-e7ae-4c9f-b4c2-d64d73df3432/current/log_inprogress_0
2019-06-13 01:58:47,279 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - bbdd9373-7b20-4539-9e16-925db84db283-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/bbdd9373-7b20-4539-9e16-925db84db283/b560ed33-e7ae-4c9f-b4c2-d64d73df3432/current/log_inprogress_0
Jun 13, 2019 1:58:48 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=43, target=0.0.0.0:44103} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:131)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 13, 2019 1:58:48 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=51, target=0.0.0.0:40333} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:131)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 13, 2019 1:58:48 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=35, target=0.0.0.0:43671} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:131)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-13 01:58:48,090 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-13 01:58:48,095 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-13 01:58:48,097 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-13 01:58:48,099 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-CE4B8533D99B->44a380f1-0667-49f9-b95f-17bef801b1c0: receive RaftClientReply:client-CE4B8533D99B->44a380f1-0667-49f9-b95f-17bef801b1c0@group-D64D73DF3432, cid=6, SUCCESS, logIndex=1, commits[44a380f1-0667-49f9-b95f-17bef801b1c0:c1, 2259f741-e8ca-4761-8b4f-763deedf3225:c0, bbdd9373-7b20-4539-9e16-925db84db283:c0]
2019-06-13 01:58:48,100 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-13 01:58:48,111 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8F3A6DB544F3->bbdd9373-7b20-4539-9e16-925db84db283: receive RaftClientReply:client-8F3A6DB544F3->bbdd9373-7b20-4539-9e16-925db84db283@group-D64D73DF3432, cid=7, FAILED org.apache.ratis.protocol.NotLeaderException: Server bbdd9373-7b20-4539-9e16-925db84db283 is not the leader (44a380f1-0667-49f9-b95f-17bef801b1c0:0.0.0.0:40333). Request must be sent to leader., logIndex=0, commits[bbdd9373-7b20-4539-9e16-925db84db283:c1, 2259f741-e8ca-4761-8b4f-763deedf3225:c0, 44a380f1-0667-49f9-b95f-17bef801b1c0:c1]
2019-06-13 01:58:48,113 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 01:58:49,120 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8F3A6DB544F3->2259f741-e8ca-4761-8b4f-763deedf3225: receive RaftClientReply:client-8F3A6DB544F3->2259f741-e8ca-4761-8b4f-763deedf3225@group-D64D73DF3432, cid=7, FAILED org.apache.ratis.protocol.NotLeaderException: Server 2259f741-e8ca-4761-8b4f-763deedf3225 is not the leader (44a380f1-0667-49f9-b95f-17bef801b1c0:0.0.0.0:40333). Request must be sent to leader., logIndex=0, commits[2259f741-e8ca-4761-8b4f-763deedf3225:c2, 44a380f1-0667-49f9-b95f-17bef801b1c0:c2, bbdd9373-7b20-4539-9e16-925db84db283:c2]
2019-06-13 01:58:49,122 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 01:58:50,130 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8F3A6DB544F3->bbdd9373-7b20-4539-9e16-925db84db283: receive RaftClientReply:client-8F3A6DB544F3->bbdd9373-7b20-4539-9e16-925db84db283@group-D64D73DF3432, cid=7, FAILED org.apache.ratis.protocol.NotLeaderException: Server bbdd9373-7b20-4539-9e16-925db84db283 is not the leader (44a380f1-0667-49f9-b95f-17bef801b1c0:0.0.0.0:40333). Request must be sent to leader., logIndex=0, commits[bbdd9373-7b20-4539-9e16-925db84db283:c2, 2259f741-e8ca-4761-8b4f-763deedf3225:c2, 44a380f1-0667-49f9-b95f-17bef801b1c0:c2]
2019-06-13 01:58:50,132 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 2-OrderedRequestStreamObserver2: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 01:58:51,141 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8F3A6DB544F3->2259f741-e8ca-4761-8b4f-763deedf3225: receive RaftClientReply:client-8F3A6DB544F3->2259f741-e8ca-4761-8b4f-763deedf3225@group-D64D73DF3432, cid=7, FAILED org.apache.ratis.protocol.NotLeaderException: Server 2259f741-e8ca-4761-8b4f-763deedf3225 is not the leader (44a380f1-0667-49f9-b95f-17bef801b1c0:0.0.0.0:40333). Request must be sent to leader., logIndex=0, commits[2259f741-e8ca-4761-8b4f-763deedf3225:c2, 44a380f1-0667-49f9-b95f-17bef801b1c0:c2, bbdd9373-7b20-4539-9e16-925db84db283:c2]
2019-06-13 01:58:51,143 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 2-OrderedRequestStreamObserver2: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 01:58:52,150 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8F3A6DB544F3->bbdd9373-7b20-4539-9e16-925db84db283: receive RaftClientReply:client-8F3A6DB544F3->bbdd9373-7b20-4539-9e16-925db84db283@group-D64D73DF3432, cid=7, FAILED org.apache.ratis.protocol.NotLeaderException: Server bbdd9373-7b20-4539-9e16-925db84db283 is not the leader (44a380f1-0667-49f9-b95f-17bef801b1c0:0.0.0.0:40333). Request must be sent to leader., logIndex=0, commits[bbdd9373-7b20-4539-9e16-925db84db283:c2, 2259f741-e8ca-4761-8b4f-763deedf3225:c2, 44a380f1-0667-49f9-b95f-17bef801b1c0:c2]
2019-06-13 01:58:52,158 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 3-OrderedRequestStreamObserver3: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 01:58:53,159 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8F3A6DB544F3->2259f741-e8ca-4761-8b4f-763deedf3225: receive RaftClientReply:client-8F3A6DB544F3->2259f741-e8ca-4761-8b4f-763deedf3225@group-D64D73DF3432, cid=7, FAILED org.apache.ratis.protocol.NotLeaderException: Server 2259f741-e8ca-4761-8b4f-763deedf3225 is not the leader (44a380f1-0667-49f9-b95f-17bef801b1c0:0.0.0.0:40333). Request must be sent to leader., logIndex=0, commits[2259f741-e8ca-4761-8b4f-763deedf3225:c2, 44a380f1-0667-49f9-b95f-17bef801b1c0:c2, bbdd9373-7b20-4539-9e16-925db84db283:c2]
2019-06-13 01:58:53,161 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 3-OrderedRequestStreamObserver3: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 01:58:54,178 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8F3A6DB544F3->44a380f1-0667-49f9-b95f-17bef801b1c0: receive RaftClientReply:client-8F3A6DB544F3->44a380f1-0667-49f9-b95f-17bef801b1c0@group-D64D73DF3432, cid=7, SUCCESS, logIndex=3, commits[44a380f1-0667-49f9-b95f-17bef801b1c0:c3, 2259f741-e8ca-4761-8b4f-763deedf3225:c2, bbdd9373-7b20-4539-9e16-925db84db283:c2]
2019-06-13 01:58:54,180 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - bbdd9373-7b20-4539-9e16-925db84db283: close
2019-06-13 01:58:54,181 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - bbdd9373-7b20-4539-9e16-925db84db283: shutdown group-D64D73DF3432
2019-06-13 01:58:54,181 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D64D73DF3432,id=bbdd9373-7b20-4539-9e16-925db84db283
2019-06-13 01:58:54,181 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - bbdd9373-7b20-4539-9e16-925db84db283: shutdown FollowerState
2019-06-13 01:58:54,182 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-bbdd9373-7b20-4539-9e16-925db84db283-group-D64D73DF3432: set stopIndex = 3
2019-06-13 01:58:54,182 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-13 01:58:54,182 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/bbdd9373-7b20-4539-9e16-925db84db283/b560ed33-e7ae-4c9f-b4c2-d64d73df3432/sm/snapshot.1_3
2019-06-13 01:58:54,182 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - bbdd9373-7b20-4539-9e16-925db84db283:group-D64D73DF3432 closes. The last applied log index is 3
2019-06-13 01:58:54,182 INFO  impl.FollowerState (FollowerState.java:run(109)) - bbdd9373-7b20-4539-9e16-925db84db283: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 01:58:54,183 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - bbdd9373-7b20-4539-9e16-925db84db283-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 01:58:54,184 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - bbdd9373-7b20-4539-9e16-925db84db283-RaftLogWorker close()
2019-06-13 01:58:54,184 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - bbdd9373-7b20-4539-9e16-925db84db283: shutdown server with port 43671 now
2019-06-13 01:58:54,186 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - bbdd9373-7b20-4539-9e16-925db84db283: shutdown server with port 43671 successfully
2019-06-13 01:58:54,186 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 44a380f1-0667-49f9-b95f-17bef801b1c0: Failed appendEntries to bbdd9373-7b20-4539-9e16-925db84db283:0.0.0.0:43671: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-13 01:58:54,187 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 44a380f1-0667-49f9-b95f-17bef801b1c0->bbdd9373-7b20-4539-9e16-925db84db283: nextIndex: updateUnconditionally 5 -> 0
2019-06-13 01:58:54,187 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 2259f741-e8ca-4761-8b4f-763deedf3225: close
2019-06-13 01:58:54,189 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - bbdd9373-7b20-4539-9e16-925db84db283: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 01:58:54,189 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 2259f741-e8ca-4761-8b4f-763deedf3225: shutdown group-D64D73DF3432
2019-06-13 01:58:54,189 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D64D73DF3432,id=2259f741-e8ca-4761-8b4f-763deedf3225
2019-06-13 01:58:54,190 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 2259f741-e8ca-4761-8b4f-763deedf3225: shutdown FollowerState
2019-06-13 01:58:54,190 INFO  impl.FollowerState (FollowerState.java:run(109)) - 2259f741-e8ca-4761-8b4f-763deedf3225: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 01:58:54,190 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-2259f741-e8ca-4761-8b4f-763deedf3225-group-D64D73DF3432: set stopIndex = 3
2019-06-13 01:58:54,190 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-13 01:58:54,191 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/2259f741-e8ca-4761-8b4f-763deedf3225/b560ed33-e7ae-4c9f-b4c2-d64d73df3432/sm/snapshot.1_3
2019-06-13 01:58:54,191 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 2259f741-e8ca-4761-8b4f-763deedf3225:group-D64D73DF3432 closes. The last applied log index is 3
2019-06-13 01:58:54,191 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 2259f741-e8ca-4761-8b4f-763deedf3225-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 01:58:54,193 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 2259f741-e8ca-4761-8b4f-763deedf3225-RaftLogWorker close()
2019-06-13 01:58:54,193 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 2259f741-e8ca-4761-8b4f-763deedf3225: shutdown server with port 44103 now
2019-06-13 01:58:54,194 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - 2259f741-e8ca-4761-8b4f-763deedf3225: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 01:58:54,195 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 2259f741-e8ca-4761-8b4f-763deedf3225: shutdown server with port 44103 successfully
2019-06-13 01:58:54,195 WARN  server.GrpcLogAppender (LogUtils.java:warn(134)) - 44a380f1-0667-49f9-b95f-17bef801b1c0: Failed appendEntries to 2259f741-e8ca-4761-8b4f-763deedf3225:0.0.0.0:44103: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: HTTP/2 error code: CANCEL
Received Rst Stream
2019-06-13 01:58:54,196 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 44a380f1-0667-49f9-b95f-17bef801b1c0->2259f741-e8ca-4761-8b4f-763deedf3225: nextIndex: updateUnconditionally 5 -> 0
2019-06-13 01:58:54,197 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 44a380f1-0667-49f9-b95f-17bef801b1c0: close
2019-06-13 01:58:54,197 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 44a380f1-0667-49f9-b95f-17bef801b1c0: shutdown group-D64D73DF3432
2019-06-13 01:58:54,198 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D64D73DF3432,id=44a380f1-0667-49f9-b95f-17bef801b1c0
2019-06-13 01:58:54,198 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 44a380f1-0667-49f9-b95f-17bef801b1c0: shutdown LeaderState
2019-06-13 01:58:54,198 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 44a380f1-0667-49f9-b95f-17bef801b1c0-PendingRequests: sendNotLeaderResponses
2019-06-13 01:58:54,198 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(44a380f1-0667-49f9-b95f-17bef801b1c0 -> bbdd9373-7b20-4539-9e16-925db84db283): Wait interrupted by java.lang.InterruptedException
2019-06-13 01:58:54,198 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(44a380f1-0667-49f9-b95f-17bef801b1c0 -> 2259f741-e8ca-4761-8b4f-763deedf3225): Wait interrupted by java.lang.InterruptedException
2019-06-13 01:58:54,200 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-44a380f1-0667-49f9-b95f-17bef801b1c0-group-D64D73DF3432: set stopIndex = 4
2019-06-13 01:58:54,200 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-13 01:58:54,201 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/44a380f1-0667-49f9-b95f-17bef801b1c0/b560ed33-e7ae-4c9f-b4c2-d64d73df3432/sm/snapshot.1_3
2019-06-13 01:58:54,201 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 44a380f1-0667-49f9-b95f-17bef801b1c0:group-D64D73DF3432 closes. The last applied log index is 4
2019-06-13 01:58:54,202 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 44a380f1-0667-49f9-b95f-17bef801b1c0-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 01:58:54,203 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 44a380f1-0667-49f9-b95f-17bef801b1c0-RaftLogWorker close()
2019-06-13 01:58:54,203 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 44a380f1-0667-49f9-b95f-17bef801b1c0: shutdown server with port 40333 now
2019-06-13 01:58:54,203 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 44a380f1-0667-49f9-b95f-17bef801b1c0: shutdown server with port 40333 successfully
