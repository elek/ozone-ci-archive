2019-06-13 00:09:13,825 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-13 00:09:13,910 INFO  ozone.RatisTestHelper (RatisTestHelper.java:initRatisConf(109)) - dfs.container.ratis.rpc.type = GRPC
2019-06-13 00:09:13,957 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 00:09:13,966 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 46789 (custom)
2019-06-13 00:09:13,967 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 00:09:13,970 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 00:09:13,970 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 00:09:13,971 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 00:09:14,023 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/52931c61-165f-4cf0-b484-20fe9ca4f18d] (custom)
2019-06-13 00:09:14,027 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 52931c61-165f-4cf0-b484-20fe9ca4f18d at port 46789
2019-06-13 00:09:14,041 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d: start RPC server
2019-06-13 00:09:14,042 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d: GrpcService started, listening on 0.0.0.0/0.0.0.0:46789
2019-06-13 00:09:14,103 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d: addNew group-16BC654FDBE1:[52931c61-165f-4cf0-b484-20fe9ca4f18d:0.0.0.0:46789] returns group-16BC654FDBE1:java.util.concurrent.CompletableFuture@2d8f8979[Not completed]
2019-06-13 00:09:14,110 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d: new RaftServerImpl for group-16BC654FDBE1:[52931c61-165f-4cf0-b484-20fe9ca4f18d:0.0.0.0:46789] with ContainerStateMachine:uninitialized
2019-06-13 00:09:14,111 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 00:09:14,111 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 00:09:14,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 00:09:14,113 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 00:09:14,119 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d:group-16BC654FDBE1 ConfigurationManager, init=-1: [52931c61-165f-4cf0-b484-20fe9ca4f18d:0.0.0.0:46789], old=null, confs=<EMPTY_MAP>
2019-06-13 00:09:14,119 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/52931c61-165f-4cf0-b484-20fe9ca4f18d] (custom)
2019-06-13 00:09:14,126 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/52931c61-165f-4cf0-b484-20fe9ca4f18d/39e13d9e-7564-4279-9984-16bc654fdbe1 does not exist. Creating ...
2019-06-13 00:09:14,135 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/52931c61-165f-4cf0-b484-20fe9ca4f18d/39e13d9e-7564-4279-9984-16bc654fdbe1/in_use.lock acquired by nodename 24839@ozone-b88sd-4274418788
2019-06-13 00:09:14,143 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/52931c61-165f-4cf0-b484-20fe9ca4f18d/39e13d9e-7564-4279-9984-16bc654fdbe1 has been successfully formatted.
2019-06-13 00:09:14,145 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 00:09:14,146 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 00:09:14,147 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 00:09:14,150 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 00:09:14,153 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 00:09:14,157 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 00:09:14,160 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 52931c61-165f-4cf0-b484-20fe9ca4f18d-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/52931c61-165f-4cf0-b484-20fe9ca4f18d/39e13d9e-7564-4279-9984-16bc654fdbe1
2019-06-13 00:09:14,160 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 00:09:14,161 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 00:09:14,163 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 00:09:14,163 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 00:09:14,164 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 00:09:14,164 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 00:09:14,165 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 00:09:14,165 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 00:09:14,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 00:09:14,168 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 00:09:14,174 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 00:09:14,175 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 00:09:14,175 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 00:09:14,190 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d: start group-16BC654FDBE1
2019-06-13 00:09:14,191 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d:group-16BC654FDBE1 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 00:09:14,192 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d: start FollowerState
2019-06-13 00:09:14,231 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-16BC654FDBE1,id=52931c61-165f-4cf0-b484-20fe9ca4f18d
2019-06-13 00:09:14,274 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-DA88B88D7623->52931c61-165f-4cf0-b484-20fe9ca4f18d: receive RaftClientReply:client-DA88B88D7623->52931c61-165f-4cf0-b484-20fe9ca4f18d@group-16BC654FDBE1, cid=1, FAILED org.apache.ratis.protocol.NotLeaderException: Server 52931c61-165f-4cf0-b484-20fe9ca4f18d is not the leader (null). Request must be sent to leader., logIndex=0, commits[52931c61-165f-4cf0-b484-20fe9ca4f18d:c-1]
2019-06-13 00:09:15,282 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-DA88B88D7623->52931c61-165f-4cf0-b484-20fe9ca4f18d: receive RaftClientReply:client-DA88B88D7623->52931c61-165f-4cf0-b484-20fe9ca4f18d@group-16BC654FDBE1, cid=1, FAILED org.apache.ratis.protocol.NotLeaderException: Server 52931c61-165f-4cf0-b484-20fe9ca4f18d is not the leader (null). Request must be sent to leader., logIndex=0, commits[52931c61-165f-4cf0-b484-20fe9ca4f18d:c-1]
2019-06-13 00:09:15,390 INFO  impl.FollowerState (FollowerState.java:run(101)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d:group-16BC654FDBE1 changes to CANDIDATE, lastRpcTime:1198, electionTimeout:1198ms
2019-06-13 00:09:15,390 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d: shutdown FollowerState
2019-06-13 00:09:15,390 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d:group-16BC654FDBE1 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 00:09:15,392 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d: start LeaderElection
2019-06-13 00:09:15,395 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d:group-16BC654FDBE1:LeaderElection1: begin an election at term 1 for -1: [52931c61-165f-4cf0-b484-20fe9ca4f18d:0.0.0.0:46789], old=null
2019-06-13 00:09:15,395 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d: shutdown LeaderElection
2019-06-13 00:09:15,396 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d:group-16BC654FDBE1 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 00:09:15,396 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d:group-16BC654FDBE1 change Leader from null to 52931c61-165f-4cf0-b484-20fe9ca4f18d at term 1 for becomeLeader, leader elected after 1250ms
2019-06-13 00:09:15,399 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 00:09:15,399 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 00:09:15,401 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 00:09:15,401 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 00:09:15,407 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d: start LeaderState
2019-06-13 00:09:15,418 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d-RaftLogWorker: Starting segment from index:0
2019-06-13 00:09:15,424 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d:group-16BC654FDBE1 set configuration 0: [52931c61-165f-4cf0-b484-20fe9ca4f18d:0.0.0.0:46789], old=null at 0
2019-06-13 00:09:15,550 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/52931c61-165f-4cf0-b484-20fe9ca4f18d/39e13d9e-7564-4279-9984-16bc654fdbe1/current/log_inprogress_0
2019-06-13 00:09:16,296 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-13 00:09:16,300 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-DA88B88D7623->52931c61-165f-4cf0-b484-20fe9ca4f18d: receive RaftClientReply:client-DA88B88D7623->52931c61-165f-4cf0-b484-20fe9ca4f18d@group-16BC654FDBE1, cid=1, SUCCESS, logIndex=1, commits[52931c61-165f-4cf0-b484-20fe9ca4f18d:c2]
2019-06-13 00:09:16,302 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-13 00:09:16,315 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-257C4F5C7053->52931c61-165f-4cf0-b484-20fe9ca4f18d: receive RaftClientReply:client-257C4F5C7053->52931c61-165f-4cf0-b484-20fe9ca4f18d@group-16BC654FDBE1, cid=2, SUCCESS, logIndex=3, commits[52931c61-165f-4cf0-b484-20fe9ca4f18d:c4]
2019-06-13 00:09:16,319 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d: close
2019-06-13 00:09:16,321 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d: shutdown group-16BC654FDBE1
2019-06-13 00:09:16,321 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-16BC654FDBE1,id=52931c61-165f-4cf0-b484-20fe9ca4f18d
2019-06-13 00:09:16,322 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d: shutdown LeaderState
2019-06-13 00:09:16,322 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d-PendingRequests: sendNotLeaderResponses
2019-06-13 00:09:16,323 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 00:09:16,323 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 00:09:16,324 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-52931c61-165f-4cf0-b484-20fe9ca4f18d-group-16BC654FDBE1: set stopIndex = 4
2019-06-13 00:09:16,325 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-13 00:09:16,325 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/52931c61-165f-4cf0-b484-20fe9ca4f18d/39e13d9e-7564-4279-9984-16bc654fdbe1/sm/snapshot.1_4
2019-06-13 00:09:16,333 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d:group-16BC654FDBE1 closes. The last applied log index is 4
2019-06-13 00:09:16,334 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 00:09:16,334 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d-RaftLogWorker close()
2019-06-13 00:09:16,335 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d: shutdown server with port 46789 now
2019-06-13 00:09:16,336 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 52931c61-165f-4cf0-b484-20fe9ca4f18d: shutdown server with port 46789 successfully
2019-06-13 00:09:16,339 INFO  ozone.RatisTestHelper (RatisTestHelper.java:initRatisConf(109)) - dfs.container.ratis.rpc.type = GRPC
2019-06-13 00:09:16,358 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 00:09:16,358 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 46725 (custom)
2019-06-13 00:09:16,359 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 00:09:16,359 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 00:09:16,359 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 00:09:16,359 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 00:09:16,360 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/cd83d216-268f-44eb-af82-8751a7de77b6] (custom)
2019-06-13 00:09:16,360 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis cd83d216-268f-44eb-af82-8751a7de77b6 at port 46725
2019-06-13 00:09:16,390 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - cd83d216-268f-44eb-af82-8751a7de77b6: start RPC server
2019-06-13 00:09:16,391 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - cd83d216-268f-44eb-af82-8751a7de77b6: GrpcService started, listening on 0.0.0.0/0.0.0.0:46725
Jun 13, 2019 12:09:16 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=17, target=0.0.0.0:46789} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:130)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 13, 2019 12:09:16 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=9, target=0.0.0.0:40759} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connectToDatanode(XceiverClientGrpc.java:163)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connect(XceiverClientGrpc.java:120)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:227)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServer(TestSecureContainerServer.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-13 00:09:16,420 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - cd83d216-268f-44eb-af82-8751a7de77b6: addNew group-ED1F654CBBC3:[d42d4c04-107e-4116-a408-849bb560fd23:0.0.0.0:45509, 21fba8ae-ac5c-4985-bae4-174c78587ec9:0.0.0.0:37871, cd83d216-268f-44eb-af82-8751a7de77b6:0.0.0.0:46725] returns group-ED1F654CBBC3:java.util.concurrent.CompletableFuture@1e36da6e[Not completed]
2019-06-13 00:09:16,422 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - cd83d216-268f-44eb-af82-8751a7de77b6: new RaftServerImpl for group-ED1F654CBBC3:[d42d4c04-107e-4116-a408-849bb560fd23:0.0.0.0:45509, 21fba8ae-ac5c-4985-bae4-174c78587ec9:0.0.0.0:37871, cd83d216-268f-44eb-af82-8751a7de77b6:0.0.0.0:46725] with ContainerStateMachine:uninitialized
2019-06-13 00:09:16,422 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 00:09:16,422 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 00:09:16,422 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 00:09:16,422 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 00:09:16,423 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - cd83d216-268f-44eb-af82-8751a7de77b6:group-ED1F654CBBC3 ConfigurationManager, init=-1: [d42d4c04-107e-4116-a408-849bb560fd23:0.0.0.0:45509, 21fba8ae-ac5c-4985-bae4-174c78587ec9:0.0.0.0:37871, cd83d216-268f-44eb-af82-8751a7de77b6:0.0.0.0:46725], old=null, confs=<EMPTY_MAP>
2019-06-13 00:09:16,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/cd83d216-268f-44eb-af82-8751a7de77b6] (custom)
2019-06-13 00:09:16,423 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/cd83d216-268f-44eb-af82-8751a7de77b6/daae99ed-f632-421c-b6ac-ed1f654cbbc3 does not exist. Creating ...
2019-06-13 00:09:16,425 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/cd83d216-268f-44eb-af82-8751a7de77b6/daae99ed-f632-421c-b6ac-ed1f654cbbc3/in_use.lock acquired by nodename 24839@ozone-b88sd-4274418788
2019-06-13 00:09:16,427 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/cd83d216-268f-44eb-af82-8751a7de77b6/daae99ed-f632-421c-b6ac-ed1f654cbbc3 has been successfully formatted.
2019-06-13 00:09:16,428 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 00:09:16,428 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 00:09:16,428 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 00:09:16,428 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 00:09:16,428 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 00:09:16,428 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 00:09:16,428 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new cd83d216-268f-44eb-af82-8751a7de77b6-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/cd83d216-268f-44eb-af82-8751a7de77b6/daae99ed-f632-421c-b6ac-ed1f654cbbc3
2019-06-13 00:09:16,428 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 00:09:16,428 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 00:09:16,428 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 00:09:16,429 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 00:09:16,429 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 00:09:16,429 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 00:09:16,429 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 00:09:16,429 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 00:09:16,429 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 00:09:16,429 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 00:09:16,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 00:09:16,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 00:09:16,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 00:09:16,430 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - cd83d216-268f-44eb-af82-8751a7de77b6: start group-ED1F654CBBC3
2019-06-13 00:09:16,430 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cd83d216-268f-44eb-af82-8751a7de77b6:group-ED1F654CBBC3 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 00:09:16,430 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cd83d216-268f-44eb-af82-8751a7de77b6: start FollowerState
2019-06-13 00:09:16,431 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-ED1F654CBBC3,id=cd83d216-268f-44eb-af82-8751a7de77b6
2019-06-13 00:09:16,434 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 00:09:16,434 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 37871 (custom)
2019-06-13 00:09:16,434 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 00:09:16,435 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 00:09:16,435 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 00:09:16,435 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 00:09:16,435 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/21fba8ae-ac5c-4985-bae4-174c78587ec9] (custom)
2019-06-13 00:09:16,436 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 21fba8ae-ac5c-4985-bae4-174c78587ec9 at port 37871
2019-06-13 00:09:16,444 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9: start RPC server
2019-06-13 00:09:16,445 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9: GrpcService started, listening on 0.0.0.0/0.0.0.0:37871
2019-06-13 00:09:16,465 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9: addNew group-ED1F654CBBC3:[d42d4c04-107e-4116-a408-849bb560fd23:0.0.0.0:45509, 21fba8ae-ac5c-4985-bae4-174c78587ec9:0.0.0.0:37871, cd83d216-268f-44eb-af82-8751a7de77b6:0.0.0.0:46725] returns group-ED1F654CBBC3:java.util.concurrent.CompletableFuture@3c5c35b4[Not completed]
2019-06-13 00:09:16,466 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9: new RaftServerImpl for group-ED1F654CBBC3:[d42d4c04-107e-4116-a408-849bb560fd23:0.0.0.0:45509, 21fba8ae-ac5c-4985-bae4-174c78587ec9:0.0.0.0:37871, cd83d216-268f-44eb-af82-8751a7de77b6:0.0.0.0:46725] with ContainerStateMachine:uninitialized
2019-06-13 00:09:16,466 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 00:09:16,466 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 00:09:16,466 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 00:09:16,466 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 00:09:16,466 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9:group-ED1F654CBBC3 ConfigurationManager, init=-1: [d42d4c04-107e-4116-a408-849bb560fd23:0.0.0.0:45509, 21fba8ae-ac5c-4985-bae4-174c78587ec9:0.0.0.0:37871, cd83d216-268f-44eb-af82-8751a7de77b6:0.0.0.0:46725], old=null, confs=<EMPTY_MAP>
2019-06-13 00:09:16,467 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/21fba8ae-ac5c-4985-bae4-174c78587ec9] (custom)
2019-06-13 00:09:16,467 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/21fba8ae-ac5c-4985-bae4-174c78587ec9/daae99ed-f632-421c-b6ac-ed1f654cbbc3 does not exist. Creating ...
2019-06-13 00:09:16,469 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/21fba8ae-ac5c-4985-bae4-174c78587ec9/daae99ed-f632-421c-b6ac-ed1f654cbbc3/in_use.lock acquired by nodename 24839@ozone-b88sd-4274418788
2019-06-13 00:09:16,471 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/21fba8ae-ac5c-4985-bae4-174c78587ec9/daae99ed-f632-421c-b6ac-ed1f654cbbc3 has been successfully formatted.
2019-06-13 00:09:16,471 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 00:09:16,471 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 00:09:16,471 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 00:09:16,471 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 00:09:16,471 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 00:09:16,471 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 00:09:16,472 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 21fba8ae-ac5c-4985-bae4-174c78587ec9-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/21fba8ae-ac5c-4985-bae4-174c78587ec9/daae99ed-f632-421c-b6ac-ed1f654cbbc3
2019-06-13 00:09:16,472 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 00:09:16,472 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 00:09:16,472 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 00:09:16,472 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 00:09:16,472 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 00:09:16,472 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 00:09:16,472 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 00:09:16,472 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 00:09:16,473 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 00:09:16,473 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 00:09:16,473 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 00:09:16,473 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 00:09:16,473 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 00:09:16,473 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9: start group-ED1F654CBBC3
2019-06-13 00:09:16,474 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9:group-ED1F654CBBC3 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 00:09:16,474 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9: start FollowerState
2019-06-13 00:09:16,474 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-ED1F654CBBC3,id=21fba8ae-ac5c-4985-bae4-174c78587ec9
2019-06-13 00:09:16,479 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 00:09:16,480 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 45509 (custom)
2019-06-13 00:09:16,480 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 00:09:16,480 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 00:09:16,480 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 00:09:16,481 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 00:09:16,481 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d42d4c04-107e-4116-a408-849bb560fd23] (custom)
2019-06-13 00:09:16,481 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis d42d4c04-107e-4116-a408-849bb560fd23 at port 45509
2019-06-13 00:09:16,488 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - d42d4c04-107e-4116-a408-849bb560fd23: start RPC server
2019-06-13 00:09:16,489 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - d42d4c04-107e-4116-a408-849bb560fd23: GrpcService started, listening on 0.0.0.0/0.0.0.0:45509
2019-06-13 00:09:16,503 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - d42d4c04-107e-4116-a408-849bb560fd23: addNew group-ED1F654CBBC3:[d42d4c04-107e-4116-a408-849bb560fd23:0.0.0.0:45509, 21fba8ae-ac5c-4985-bae4-174c78587ec9:0.0.0.0:37871, cd83d216-268f-44eb-af82-8751a7de77b6:0.0.0.0:46725] returns group-ED1F654CBBC3:java.util.concurrent.CompletableFuture@4b32957a[Not completed]
2019-06-13 00:09:16,504 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - d42d4c04-107e-4116-a408-849bb560fd23: new RaftServerImpl for group-ED1F654CBBC3:[d42d4c04-107e-4116-a408-849bb560fd23:0.0.0.0:45509, 21fba8ae-ac5c-4985-bae4-174c78587ec9:0.0.0.0:37871, cd83d216-268f-44eb-af82-8751a7de77b6:0.0.0.0:46725] with ContainerStateMachine:uninitialized
2019-06-13 00:09:16,505 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 00:09:16,505 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 00:09:16,505 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 00:09:16,505 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 00:09:16,505 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - d42d4c04-107e-4116-a408-849bb560fd23:group-ED1F654CBBC3 ConfigurationManager, init=-1: [d42d4c04-107e-4116-a408-849bb560fd23:0.0.0.0:45509, 21fba8ae-ac5c-4985-bae4-174c78587ec9:0.0.0.0:37871, cd83d216-268f-44eb-af82-8751a7de77b6:0.0.0.0:46725], old=null, confs=<EMPTY_MAP>
2019-06-13 00:09:16,505 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d42d4c04-107e-4116-a408-849bb560fd23] (custom)
2019-06-13 00:09:16,505 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d42d4c04-107e-4116-a408-849bb560fd23/daae99ed-f632-421c-b6ac-ed1f654cbbc3 does not exist. Creating ...
2019-06-13 00:09:16,508 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d42d4c04-107e-4116-a408-849bb560fd23/daae99ed-f632-421c-b6ac-ed1f654cbbc3/in_use.lock acquired by nodename 24839@ozone-b88sd-4274418788
2019-06-13 00:09:16,510 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d42d4c04-107e-4116-a408-849bb560fd23/daae99ed-f632-421c-b6ac-ed1f654cbbc3 has been successfully formatted.
2019-06-13 00:09:16,510 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 00:09:16,510 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 00:09:16,510 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 00:09:16,510 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 00:09:16,510 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 00:09:16,510 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 00:09:16,511 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new d42d4c04-107e-4116-a408-849bb560fd23-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d42d4c04-107e-4116-a408-849bb560fd23/daae99ed-f632-421c-b6ac-ed1f654cbbc3
2019-06-13 00:09:16,511 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 00:09:16,511 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 00:09:16,511 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 00:09:16,511 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 00:09:16,511 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 00:09:16,511 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 00:09:16,511 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 00:09:16,511 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 00:09:16,512 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 00:09:16,512 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 00:09:16,512 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 00:09:16,512 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 00:09:16,512 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 00:09:16,512 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - d42d4c04-107e-4116-a408-849bb560fd23: start group-ED1F654CBBC3
2019-06-13 00:09:16,513 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d42d4c04-107e-4116-a408-849bb560fd23:group-ED1F654CBBC3 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 00:09:16,513 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d42d4c04-107e-4116-a408-849bb560fd23: start FollowerState
2019-06-13 00:09:16,513 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-ED1F654CBBC3,id=d42d4c04-107e-4116-a408-849bb560fd23
2019-06-13 00:09:16,525 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-22B1B9E508AB->cd83d216-268f-44eb-af82-8751a7de77b6: receive RaftClientReply:client-22B1B9E508AB->cd83d216-268f-44eb-af82-8751a7de77b6@group-ED1F654CBBC3, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server cd83d216-268f-44eb-af82-8751a7de77b6 is not the leader (21fba8ae-ac5c-4985-bae4-174c78587ec9:0.0.0.0:37871). Request must be sent to leader., logIndex=0, commits[cd83d216-268f-44eb-af82-8751a7de77b6:c-1]
2019-06-13 00:09:16,528 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 00:09:17,534 INFO  impl.FollowerState (FollowerState.java:run(101)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9:group-ED1F654CBBC3 changes to CANDIDATE, lastRpcTime:1060, electionTimeout:1060ms
2019-06-13 00:09:17,535 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9: shutdown FollowerState
2019-06-13 00:09:17,535 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9:group-ED1F654CBBC3 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 00:09:17,535 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9: start LeaderElection
2019-06-13 00:09:17,540 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9:group-ED1F654CBBC3:LeaderElection2: begin an election at term 1 for -1: [d42d4c04-107e-4116-a408-849bb560fd23:0.0.0.0:45509, 21fba8ae-ac5c-4985-bae4-174c78587ec9:0.0.0.0:37871, cd83d216-268f-44eb-af82-8751a7de77b6:0.0.0.0:46725], old=null
2019-06-13 00:09:17,544 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-22B1B9E508AB->d42d4c04-107e-4116-a408-849bb560fd23: receive RaftClientReply:client-22B1B9E508AB->d42d4c04-107e-4116-a408-849bb560fd23@group-ED1F654CBBC3, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server d42d4c04-107e-4116-a408-849bb560fd23 is not the leader (21fba8ae-ac5c-4985-bae4-174c78587ec9:0.0.0.0:37871). Request must be sent to leader., logIndex=0, commits[d42d4c04-107e-4116-a408-849bb560fd23:c-1]
2019-06-13 00:09:17,546 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 00:09:17,547 INFO  impl.FollowerState (FollowerState.java:run(101)) - cd83d216-268f-44eb-af82-8751a7de77b6:group-ED1F654CBBC3 changes to CANDIDATE, lastRpcTime:1116, electionTimeout:1116ms
2019-06-13 00:09:17,549 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - cd83d216-268f-44eb-af82-8751a7de77b6: shutdown FollowerState
2019-06-13 00:09:17,549 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cd83d216-268f-44eb-af82-8751a7de77b6:group-ED1F654CBBC3 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 00:09:17,550 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cd83d216-268f-44eb-af82-8751a7de77b6: start LeaderElection
2019-06-13 00:09:17,553 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - cd83d216-268f-44eb-af82-8751a7de77b6:group-ED1F654CBBC3:LeaderElection3: begin an election at term 1 for -1: [d42d4c04-107e-4116-a408-849bb560fd23:0.0.0.0:45509, 21fba8ae-ac5c-4985-bae4-174c78587ec9:0.0.0.0:37871, cd83d216-268f-44eb-af82-8751a7de77b6:0.0.0.0:46725], old=null
2019-06-13 00:09:17,561 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d42d4c04-107e-4116-a408-849bb560fd23:group-ED1F654CBBC3 changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:21fba8ae-ac5c-4985-bae4-174c78587ec9
2019-06-13 00:09:17,561 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d42d4c04-107e-4116-a408-849bb560fd23: shutdown FollowerState
2019-06-13 00:09:17,562 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d42d4c04-107e-4116-a408-849bb560fd23: start FollowerState
2019-06-13 00:09:17,562 INFO  impl.FollowerState (FollowerState.java:run(109)) - d42d4c04-107e-4116-a408-849bb560fd23: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 00:09:17,628 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9:group-ED1F654CBBC3:LeaderElection2: Election PASSED; received 2 response(s) [21fba8ae-ac5c-4985-bae4-174c78587ec9->d42d4c04-107e-4116-a408-849bb560fd23,true-t1, 21fba8ae-ac5c-4985-bae4-174c78587ec9->cd83d216-268f-44eb-af82-8751a7de77b6,false-t1] and 0 exception(s); 21fba8ae-ac5c-4985-bae4-174c78587ec9:t1, leader=null, voted=21fba8ae-ac5c-4985-bae4-174c78587ec9, raftlog=21fba8ae-ac5c-4985-bae4-174c78587ec9-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [d42d4c04-107e-4116-a408-849bb560fd23:0.0.0.0:45509, 21fba8ae-ac5c-4985-bae4-174c78587ec9:0.0.0.0:37871, cd83d216-268f-44eb-af82-8751a7de77b6:0.0.0.0:46725], old=null
2019-06-13 00:09:17,628 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9: shutdown LeaderElection
2019-06-13 00:09:17,628 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9:group-ED1F654CBBC3 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 00:09:17,628 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9:group-ED1F654CBBC3 change Leader from null to 21fba8ae-ac5c-4985-bae4-174c78587ec9 at term 1 for becomeLeader, leader elected after 1156ms
2019-06-13 00:09:17,628 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 00:09:17,628 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 00:09:17,628 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 00:09:17,628 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 00:09:17,631 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 00:09:17,631 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 00:09:17,634 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 00:09:17,635 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 00:09:17,636 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 00:09:17,636 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 00:09:17,636 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-13 00:09:17,636 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 00:09:17,636 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-13 00:09:17,636 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-13 00:09:17,636 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 00:09:17,636 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 00:09:17,637 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9: start LeaderState
2019-06-13 00:09:17,637 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9-RaftLogWorker: Starting segment from index:0
2019-06-13 00:09:17,639 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9:group-ED1F654CBBC3 set configuration 0: [d42d4c04-107e-4116-a408-849bb560fd23:0.0.0.0:45509, 21fba8ae-ac5c-4985-bae4-174c78587ec9:0.0.0.0:37871, cd83d216-268f-44eb-af82-8751a7de77b6:0.0.0.0:46725], old=null at 0
2019-06-13 00:09:17,639 INFO  impl.RaftServerImpl (RaftServerImpl.java:requestVote(738)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9-LEADER: Withhold vote from candidate cd83d216-268f-44eb-af82-8751a7de77b6 with term 1. State: leader=21fba8ae-ac5c-4985-bae4-174c78587ec9, term=1, lastRpcElapsed=null
2019-06-13 00:09:17,673 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/21fba8ae-ac5c-4985-bae4-174c78587ec9/daae99ed-f632-421c-b6ac-ed1f654cbbc3/current/log_inprogress_0
2019-06-13 00:09:17,679 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - cd83d216-268f-44eb-af82-8751a7de77b6:group-ED1F654CBBC3:LeaderElection3: Election REJECTED; received 2 response(s) [cd83d216-268f-44eb-af82-8751a7de77b6->d42d4c04-107e-4116-a408-849bb560fd23,false-t1, cd83d216-268f-44eb-af82-8751a7de77b6->21fba8ae-ac5c-4985-bae4-174c78587ec9,false-t1] and 0 exception(s); cd83d216-268f-44eb-af82-8751a7de77b6:t1, leader=null, voted=cd83d216-268f-44eb-af82-8751a7de77b6, raftlog=cd83d216-268f-44eb-af82-8751a7de77b6-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [d42d4c04-107e-4116-a408-849bb560fd23:0.0.0.0:45509, 21fba8ae-ac5c-4985-bae4-174c78587ec9:0.0.0.0:37871, cd83d216-268f-44eb-af82-8751a7de77b6:0.0.0.0:46725], old=null
2019-06-13 00:09:17,679 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cd83d216-268f-44eb-af82-8751a7de77b6:group-ED1F654CBBC3 changes role from CANDIDATE to FOLLOWER at term 1 for DISCOVERED_A_NEW_TERM
2019-06-13 00:09:17,680 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - cd83d216-268f-44eb-af82-8751a7de77b6: shutdown LeaderElection
2019-06-13 00:09:17,680 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cd83d216-268f-44eb-af82-8751a7de77b6: start FollowerState
2019-06-13 00:09:17,680 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - d42d4c04-107e-4116-a408-849bb560fd23:group-ED1F654CBBC3 change Leader from null to 21fba8ae-ac5c-4985-bae4-174c78587ec9 at term 1 for appendEntries, leader elected after 1170ms
2019-06-13 00:09:17,682 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - cd83d216-268f-44eb-af82-8751a7de77b6:group-ED1F654CBBC3 change Leader from null to 21fba8ae-ac5c-4985-bae4-174c78587ec9 at term 1 for appendEntries, leader elected after 1254ms
2019-06-13 00:09:17,697 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - cd83d216-268f-44eb-af82-8751a7de77b6:group-ED1F654CBBC3 set configuration 0: [d42d4c04-107e-4116-a408-849bb560fd23:0.0.0.0:45509, 21fba8ae-ac5c-4985-bae4-174c78587ec9:0.0.0.0:37871, cd83d216-268f-44eb-af82-8751a7de77b6:0.0.0.0:46725], old=null at 0
2019-06-13 00:09:17,698 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - cd83d216-268f-44eb-af82-8751a7de77b6-RaftLogWorker: Starting segment from index:0
2019-06-13 00:09:17,699 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - d42d4c04-107e-4116-a408-849bb560fd23:group-ED1F654CBBC3 set configuration 0: [d42d4c04-107e-4116-a408-849bb560fd23:0.0.0.0:45509, 21fba8ae-ac5c-4985-bae4-174c78587ec9:0.0.0.0:37871, cd83d216-268f-44eb-af82-8751a7de77b6:0.0.0.0:46725], old=null at 0
2019-06-13 00:09:17,700 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - d42d4c04-107e-4116-a408-849bb560fd23-RaftLogWorker: Starting segment from index:0
2019-06-13 00:09:17,752 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - cd83d216-268f-44eb-af82-8751a7de77b6-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/cd83d216-268f-44eb-af82-8751a7de77b6/daae99ed-f632-421c-b6ac-ed1f654cbbc3/current/log_inprogress_0
2019-06-13 00:09:17,758 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - d42d4c04-107e-4116-a408-849bb560fd23-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d42d4c04-107e-4116-a408-849bb560fd23/daae99ed-f632-421c-b6ac-ed1f654cbbc3/current/log_inprogress_0
Jun 13, 2019 12:09:18 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=43, target=0.0.0.0:37871} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:131)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 13, 2019 12:09:18 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=51, target=0.0.0.0:45509} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:131)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 13, 2019 12:09:18 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=35, target=0.0.0.0:46725} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:131)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-13 00:09:18,561 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-13 00:09:18,563 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-13 00:09:18,565 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-13 00:09:18,568 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-22B1B9E508AB->21fba8ae-ac5c-4985-bae4-174c78587ec9: receive RaftClientReply:client-22B1B9E508AB->21fba8ae-ac5c-4985-bae4-174c78587ec9@group-ED1F654CBBC3, cid=6, SUCCESS, logIndex=1, commits[21fba8ae-ac5c-4985-bae4-174c78587ec9:c1, d42d4c04-107e-4116-a408-849bb560fd23:c0, cd83d216-268f-44eb-af82-8751a7de77b6:c0]
2019-06-13 00:09:18,568 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-13 00:09:18,578 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8682AE6544D3->cd83d216-268f-44eb-af82-8751a7de77b6: receive RaftClientReply:client-8682AE6544D3->cd83d216-268f-44eb-af82-8751a7de77b6@group-ED1F654CBBC3, cid=7, FAILED org.apache.ratis.protocol.NotLeaderException: Server cd83d216-268f-44eb-af82-8751a7de77b6 is not the leader (21fba8ae-ac5c-4985-bae4-174c78587ec9:0.0.0.0:37871). Request must be sent to leader., logIndex=0, commits[cd83d216-268f-44eb-af82-8751a7de77b6:c1, d42d4c04-107e-4116-a408-849bb560fd23:c0, 21fba8ae-ac5c-4985-bae4-174c78587ec9:c1]
2019-06-13 00:09:18,586 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 00:09:19,593 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-8682AE6544D3->21fba8ae-ac5c-4985-bae4-174c78587ec9: receive RaftClientReply:client-8682AE6544D3->21fba8ae-ac5c-4985-bae4-174c78587ec9@group-ED1F654CBBC3, cid=7, SUCCESS, logIndex=3, commits[21fba8ae-ac5c-4985-bae4-174c78587ec9:c3, d42d4c04-107e-4116-a408-849bb560fd23:c2, cd83d216-268f-44eb-af82-8751a7de77b6:c2]
2019-06-13 00:09:19,595 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - cd83d216-268f-44eb-af82-8751a7de77b6: close
2019-06-13 00:09:19,596 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - cd83d216-268f-44eb-af82-8751a7de77b6: shutdown group-ED1F654CBBC3
2019-06-13 00:09:19,596 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-ED1F654CBBC3,id=cd83d216-268f-44eb-af82-8751a7de77b6
2019-06-13 00:09:19,596 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - cd83d216-268f-44eb-af82-8751a7de77b6: shutdown FollowerState
2019-06-13 00:09:19,597 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-cd83d216-268f-44eb-af82-8751a7de77b6-group-ED1F654CBBC3: set stopIndex = 2
2019-06-13 00:09:19,597 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:1)
2019-06-13 00:09:19,597 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/cd83d216-268f-44eb-af82-8751a7de77b6/daae99ed-f632-421c-b6ac-ed1f654cbbc3/sm/snapshot.1_1
2019-06-13 00:09:19,597 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - cd83d216-268f-44eb-af82-8751a7de77b6:group-ED1F654CBBC3 closes. The last applied log index is 2
2019-06-13 00:09:19,597 INFO  impl.FollowerState (FollowerState.java:run(109)) - cd83d216-268f-44eb-af82-8751a7de77b6: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 00:09:19,598 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - cd83d216-268f-44eb-af82-8751a7de77b6-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 00:09:19,601 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - cd83d216-268f-44eb-af82-8751a7de77b6-RaftLogWorker close()
2019-06-13 00:09:19,601 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - cd83d216-268f-44eb-af82-8751a7de77b6: shutdown server with port 46725 now
2019-06-13 00:09:19,602 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - cd83d216-268f-44eb-af82-8751a7de77b6: shutdown server with port 46725 successfully
2019-06-13 00:09:19,602 WARN  server.GrpcServerProtocolService (LogUtils.java:warn(134)) - cd83d216-268f-44eb-af82-8751a7de77b6: appendEntries onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-13 00:09:19,604 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9: close
2019-06-13 00:09:19,604 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9: shutdown group-ED1F654CBBC3
2019-06-13 00:09:19,605 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-ED1F654CBBC3,id=21fba8ae-ac5c-4985-bae4-174c78587ec9
2019-06-13 00:09:19,605 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9: shutdown LeaderState
2019-06-13 00:09:19,605 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(21fba8ae-ac5c-4985-bae4-174c78587ec9 -> d42d4c04-107e-4116-a408-849bb560fd23): Wait interrupted by java.lang.InterruptedException
2019-06-13 00:09:19,606 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9-PendingRequests: sendNotLeaderResponses
2019-06-13 00:09:19,606 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(21fba8ae-ac5c-4985-bae4-174c78587ec9 -> cd83d216-268f-44eb-af82-8751a7de77b6): Wait interrupted by java.lang.InterruptedException
2019-06-13 00:09:19,608 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - d42d4c04-107e-4116-a408-849bb560fd23: appendEntries completed
2019-06-13 00:09:19,609 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9: follower 21fba8ae-ac5c-4985-bae4-174c78587ec9->d42d4c04-107e-4116-a408-849bb560fd23(c3,m4,n5, attendVote=true, lastRpcSendTime=18, lastRpcResponseTime=12) response Completed
2019-06-13 00:09:19,610 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9->d42d4c04-107e-4116-a408-849bb560fd23: nextIndex: updateUnconditionally 5 -> 0
2019-06-13 00:09:19,613 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-21fba8ae-ac5c-4985-bae4-174c78587ec9-group-ED1F654CBBC3: set stopIndex = 4
2019-06-13 00:09:19,613 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onError(266)) - GrpcLogAppender(21fba8ae-ac5c-4985-bae4-174c78587ec9 -> cd83d216-268f-44eb-af82-8751a7de77b6) is stopped
2019-06-13 00:09:19,613 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-13 00:09:19,615 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/21fba8ae-ac5c-4985-bae4-174c78587ec9/daae99ed-f632-421c-b6ac-ed1f654cbbc3/sm/snapshot.1_3
2019-06-13 00:09:19,615 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9:group-ED1F654CBBC3 closes. The last applied log index is 4
2019-06-13 00:09:19,615 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 00:09:19,616 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9-RaftLogWorker close()
2019-06-13 00:09:19,616 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9: shutdown server with port 37871 now
2019-06-13 00:09:19,618 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 21fba8ae-ac5c-4985-bae4-174c78587ec9: shutdown server with port 37871 successfully
2019-06-13 00:09:19,624 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - d42d4c04-107e-4116-a408-849bb560fd23: close
2019-06-13 00:09:19,624 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - d42d4c04-107e-4116-a408-849bb560fd23: shutdown group-ED1F654CBBC3
2019-06-13 00:09:19,624 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-ED1F654CBBC3,id=d42d4c04-107e-4116-a408-849bb560fd23
2019-06-13 00:09:19,624 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d42d4c04-107e-4116-a408-849bb560fd23: shutdown FollowerState
2019-06-13 00:09:19,625 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-d42d4c04-107e-4116-a408-849bb560fd23-group-ED1F654CBBC3: set stopIndex = 3
2019-06-13 00:09:19,625 INFO  impl.FollowerState (FollowerState.java:run(109)) - d42d4c04-107e-4116-a408-849bb560fd23: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-13 00:09:19,625 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-13 00:09:19,625 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d42d4c04-107e-4116-a408-849bb560fd23/daae99ed-f632-421c-b6ac-ed1f654cbbc3/sm/snapshot.1_3
2019-06-13 00:09:19,625 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - d42d4c04-107e-4116-a408-849bb560fd23:group-ED1F654CBBC3 closes. The last applied log index is 3
2019-06-13 00:09:19,626 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - d42d4c04-107e-4116-a408-849bb560fd23-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 00:09:19,626 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - d42d4c04-107e-4116-a408-849bb560fd23-RaftLogWorker close()
2019-06-13 00:09:19,626 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - d42d4c04-107e-4116-a408-849bb560fd23: shutdown server with port 45509 now
2019-06-13 00:09:19,627 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - d42d4c04-107e-4116-a408-849bb560fd23: shutdown server with port 45509 successfully
