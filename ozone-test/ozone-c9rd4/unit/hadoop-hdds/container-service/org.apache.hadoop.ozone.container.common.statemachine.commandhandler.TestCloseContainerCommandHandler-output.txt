2019-06-12 16:39:44,206 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler67f1b9a3-5867-47b3-9ae0-d4d0b357220f/hdds of  storage type : DISK and capacity : 104021790720
2019-06-12 16:39:44,210 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler67f1b9a3-5867-47b3-9ae0-d4d0b357220f/hdds to VolumeSet
2019-06-12 16:39:44,219 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-12 16:39:44,244 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-12 16:39:44,571 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 38425
2019-06-12 16:39:44,944 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-12 16:39:44,966 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-12 16:39:44,974 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 38425 (custom)
2019-06-12 16:39:44,975 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-12 16:39:44,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-12 16:39:44,978 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-12 16:39:44,979 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-12 16:39:45,094 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler67f1b9a3-5867-47b3-9ae0-d4d0b357220f/ratis] (custom)
2019-06-12 16:39:45,103 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 38283
2019-06-12 16:39:45,120 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-12 16:39:45,121 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-12 16:39:45,122 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 42188372-b872-41a2-97da-4c8bafef5213 at port 38425
2019-06-12 16:39:45,137 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 42188372-b872-41a2-97da-4c8bafef5213: start RPC server
2019-06-12 16:39:45,254 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 42188372-b872-41a2-97da-4c8bafef5213: GrpcService started, listening on 0.0.0.0/0.0.0.0:38425
2019-06-12 16:39:45,520 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 42188372-b872-41a2-97da-4c8bafef5213: addNew group-325D6780C38C:[42188372-b872-41a2-97da-4c8bafef5213:127.0.0.1:38425] returns group-325D6780C38C:java.util.concurrent.CompletableFuture@68fdff67[Not completed]
2019-06-12 16:39:45,544 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 42188372-b872-41a2-97da-4c8bafef5213: new RaftServerImpl for group-325D6780C38C:[42188372-b872-41a2-97da-4c8bafef5213:127.0.0.1:38425] with ContainerStateMachine:uninitialized
2019-06-12 16:39:45,545 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-12 16:39:45,545 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-12 16:39:45,545 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-12 16:39:45,546 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-12 16:39:45,550 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 42188372-b872-41a2-97da-4c8bafef5213:group-325D6780C38C ConfigurationManager, init=-1: [42188372-b872-41a2-97da-4c8bafef5213:127.0.0.1:38425], old=null, confs=<EMPTY_MAP>
2019-06-12 16:39:45,550 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler67f1b9a3-5867-47b3-9ae0-d4d0b357220f/ratis] (custom)
2019-06-12 16:39:45,555 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler67f1b9a3-5867-47b3-9ae0-d4d0b357220f/ratis/51382afa-1a08-483f-abc2-325d6780c38c does not exist. Creating ...
2019-06-12 16:39:45,564 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler67f1b9a3-5867-47b3-9ae0-d4d0b357220f/ratis/51382afa-1a08-483f-abc2-325d6780c38c/in_use.lock acquired by nodename 4189@ozone-c9rd4-1241589905
2019-06-12 16:39:45,571 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler67f1b9a3-5867-47b3-9ae0-d4d0b357220f/ratis/51382afa-1a08-483f-abc2-325d6780c38c has been successfully formatted.
2019-06-12 16:39:45,573 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-12 16:39:45,573 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-12 16:39:45,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-12 16:39:45,576 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-12 16:39:45,578 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-12 16:39:45,581 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-12 16:39:45,583 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 42188372-b872-41a2-97da-4c8bafef5213-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler67f1b9a3-5867-47b3-9ae0-d4d0b357220f/ratis/51382afa-1a08-483f-abc2-325d6780c38c
2019-06-12 16:39:45,583 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-12 16:39:45,584 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-12 16:39:45,585 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-12 16:39:45,585 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-12 16:39:45,586 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-12 16:39:45,586 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-12 16:39:45,587 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-12 16:39:45,587 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-12 16:39:45,587 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-12 16:39:45,589 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-12 16:39:45,593 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-12 16:39:45,594 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-12 16:39:45,594 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-12 16:39:45,684 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 42188372-b872-41a2-97da-4c8bafef5213: start group-325D6780C38C
2019-06-12 16:39:45,685 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 42188372-b872-41a2-97da-4c8bafef5213:group-325D6780C38C changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-12 16:39:45,686 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 42188372-b872-41a2-97da-4c8bafef5213: start FollowerState
2019-06-12 16:39:45,688 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-325D6780C38C,id=42188372-b872-41a2-97da-4c8bafef5213
2019-06-12 16:39:46,859 INFO  impl.FollowerState (FollowerState.java:run(101)) - 42188372-b872-41a2-97da-4c8bafef5213:group-325D6780C38C changes to CANDIDATE, lastRpcTime:1172, electionTimeout:1172ms
2019-06-12 16:39:46,859 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 42188372-b872-41a2-97da-4c8bafef5213: shutdown FollowerState
2019-06-12 16:39:46,859 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 42188372-b872-41a2-97da-4c8bafef5213:group-325D6780C38C changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-12 16:39:46,861 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 42188372-b872-41a2-97da-4c8bafef5213: start LeaderElection
2019-06-12 16:39:46,864 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 42188372-b872-41a2-97da-4c8bafef5213:group-325D6780C38C:LeaderElection1: begin an election at term 1 for -1: [42188372-b872-41a2-97da-4c8bafef5213:127.0.0.1:38425], old=null
2019-06-12 16:39:46,865 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 42188372-b872-41a2-97da-4c8bafef5213: shutdown LeaderElection
2019-06-12 16:39:46,866 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 42188372-b872-41a2-97da-4c8bafef5213:group-325D6780C38C changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-12 16:39:46,866 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 42188372-b872-41a2-97da-4c8bafef5213:group-325D6780C38C change Leader from null to 42188372-b872-41a2-97da-4c8bafef5213 at term 1 for becomeLeader, leader elected after 1292ms
2019-06-12 16:39:46,869 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-12 16:39:46,869 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-12 16:39:46,871 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-12 16:39:46,871 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-12 16:39:46,881 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 42188372-b872-41a2-97da-4c8bafef5213: start LeaderState
2019-06-12 16:39:46,895 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 42188372-b872-41a2-97da-4c8bafef5213-RaftLogWorker: Starting segment from index:0
2019-06-12 16:39:46,903 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 42188372-b872-41a2-97da-4c8bafef5213:group-325D6780C38C set configuration 0: [42188372-b872-41a2-97da-4c8bafef5213:127.0.0.1:38425], old=null at 0
2019-06-12 16:39:47,023 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 42188372-b872-41a2-97da-4c8bafef5213-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler67f1b9a3-5867-47b3-9ae0-d4d0b357220f/ratis/51382afa-1a08-483f-abc2-325d6780c38c/current/log_inprogress_0
2019-06-12 16:39:47,889 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-12 16:39:47,944 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 1075656018550391007 is closed with bcsId 0.
2019-06-12 16:39:47,944 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-12 16:39:47,945 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 42188372-b872-41a2-97da-4c8bafef5213: close
2019-06-12 16:39:47,946 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 42188372-b872-41a2-97da-4c8bafef5213: shutdown group-325D6780C38C
2019-06-12 16:39:47,947 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-325D6780C38C,id=42188372-b872-41a2-97da-4c8bafef5213
2019-06-12 16:39:47,947 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 42188372-b872-41a2-97da-4c8bafef5213: shutdown LeaderState
2019-06-12 16:39:47,947 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 42188372-b872-41a2-97da-4c8bafef5213-PendingRequests: sendNotLeaderResponses
2019-06-12 16:39:47,949 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-42188372-b872-41a2-97da-4c8bafef5213-group-325D6780C38C: set stopIndex = 4
2019-06-12 16:39:47,949 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-12 16:39:47,949 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler67f1b9a3-5867-47b3-9ae0-d4d0b357220f/ratis/51382afa-1a08-483f-abc2-325d6780c38c/sm/snapshot.1_4
2019-06-12 16:39:47,957 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 42188372-b872-41a2-97da-4c8bafef5213:group-325D6780C38C closes. The last applied log index is 4
2019-06-12 16:39:47,958 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 42188372-b872-41a2-97da-4c8bafef5213-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-12 16:39:47,958 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 42188372-b872-41a2-97da-4c8bafef5213-RaftLogWorker close()
2019-06-12 16:39:47,959 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 42188372-b872-41a2-97da-4c8bafef5213: shutdown server with port 38425 now
2019-06-12 16:39:47,963 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 42188372-b872-41a2-97da-4c8bafef5213: shutdown server with port 38425 successfully
2019-06-12 16:39:47,971 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-12 16:39:48,003 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2573413e-e016-4ee2-a917-ae95073c0e28/hdds of  storage type : DISK and capacity : 104021790720
2019-06-12 16:39:48,004 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2573413e-e016-4ee2-a917-ae95073c0e28/hdds to VolumeSet
2019-06-12 16:39:48,004 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@47547132
2019-06-12 16:39:48,004 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@47547132
2019-06-12 16:39:48,014 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 41093
2019-06-12 16:39:48,015 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-12 16:39:48,016 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-12 16:39:48,016 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 41093 (custom)
2019-06-12 16:39:48,016 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-12 16:39:48,017 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-12 16:39:48,017 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-12 16:39:48,017 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-12 16:39:48,018 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2573413e-e016-4ee2-a917-ae95073c0e28/ratis] (custom)
2019-06-12 16:39:48,018 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42661
2019-06-12 16:39:48,019 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-12 16:39:48,019 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-12 16:39:48,019 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 529a3322-1bea-4566-bde1-feb7cc9f0f87 at port 41093
2019-06-12 16:39:48,045 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87: start RPC server
2019-06-12 16:39:48,047 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87: GrpcService started, listening on 0.0.0.0/0.0.0.0:41093
2019-06-12 16:39:48,060 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87: addNew group-ACD4F2D8D745:[529a3322-1bea-4566-bde1-feb7cc9f0f87:127.0.0.1:41093] returns group-ACD4F2D8D745:java.util.concurrent.CompletableFuture@7ab4c968[Not completed]
2019-06-12 16:39:48,062 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87: new RaftServerImpl for group-ACD4F2D8D745:[529a3322-1bea-4566-bde1-feb7cc9f0f87:127.0.0.1:41093] with ContainerStateMachine:uninitialized
2019-06-12 16:39:48,062 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-12 16:39:48,062 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-12 16:39:48,062 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-12 16:39:48,062 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-12 16:39:48,063 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87:group-ACD4F2D8D745 ConfigurationManager, init=-1: [529a3322-1bea-4566-bde1-feb7cc9f0f87:127.0.0.1:41093], old=null, confs=<EMPTY_MAP>
2019-06-12 16:39:48,063 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2573413e-e016-4ee2-a917-ae95073c0e28/ratis] (custom)
2019-06-12 16:39:48,063 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2573413e-e016-4ee2-a917-ae95073c0e28/ratis/75013aed-c7a6-4e45-aead-acd4f2d8d745 does not exist. Creating ...
2019-06-12 16:39:48,066 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2573413e-e016-4ee2-a917-ae95073c0e28/ratis/75013aed-c7a6-4e45-aead-acd4f2d8d745/in_use.lock acquired by nodename 4189@ozone-c9rd4-1241589905
2019-06-12 16:39:48,068 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2573413e-e016-4ee2-a917-ae95073c0e28/ratis/75013aed-c7a6-4e45-aead-acd4f2d8d745 has been successfully formatted.
2019-06-12 16:39:48,068 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-12 16:39:48,068 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-12 16:39:48,068 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-12 16:39:48,068 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-12 16:39:48,068 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-12 16:39:48,068 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-12 16:39:48,068 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 529a3322-1bea-4566-bde1-feb7cc9f0f87-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2573413e-e016-4ee2-a917-ae95073c0e28/ratis/75013aed-c7a6-4e45-aead-acd4f2d8d745
2019-06-12 16:39:48,069 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-12 16:39:48,069 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-12 16:39:48,069 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-12 16:39:48,069 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-12 16:39:48,069 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-12 16:39:48,070 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-12 16:39:48,070 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-12 16:39:48,070 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-12 16:39:48,070 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-12 16:39:48,070 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-12 16:39:48,071 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-12 16:39:48,071 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-12 16:39:48,071 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-12 16:39:48,071 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87: start group-ACD4F2D8D745
2019-06-12 16:39:48,071 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87:group-ACD4F2D8D745 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-12 16:39:48,071 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87: start FollowerState
2019-06-12 16:39:48,072 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-ACD4F2D8D745,id=529a3322-1bea-4566-bde1-feb7cc9f0f87
2019-06-12 16:39:49,244 INFO  impl.FollowerState (FollowerState.java:run(101)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87:group-ACD4F2D8D745 changes to CANDIDATE, lastRpcTime:1172, electionTimeout:1172ms
2019-06-12 16:39:49,244 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87: shutdown FollowerState
2019-06-12 16:39:49,244 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87:group-ACD4F2D8D745 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-12 16:39:49,244 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87: start LeaderElection
2019-06-12 16:39:49,247 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87:group-ACD4F2D8D745:LeaderElection2: begin an election at term 1 for -1: [529a3322-1bea-4566-bde1-feb7cc9f0f87:127.0.0.1:41093], old=null
2019-06-12 16:39:49,247 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87: shutdown LeaderElection
2019-06-12 16:39:49,247 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87:group-ACD4F2D8D745 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-12 16:39:49,247 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87:group-ACD4F2D8D745 change Leader from null to 529a3322-1bea-4566-bde1-feb7cc9f0f87 at term 1 for becomeLeader, leader elected after 1179ms
2019-06-12 16:39:49,247 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-12 16:39:49,247 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-12 16:39:49,248 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-12 16:39:49,248 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-12 16:39:49,248 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87: start LeaderState
2019-06-12 16:39:49,248 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87-RaftLogWorker: Starting segment from index:0
2019-06-12 16:39:49,249 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87:group-ACD4F2D8D745 set configuration 0: [529a3322-1bea-4566-bde1-feb7cc9f0f87:127.0.0.1:41093], old=null at 0
2019-06-12 16:39:49,286 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2573413e-e016-4ee2-a917-ae95073c0e28/ratis/75013aed-c7a6-4e45-aead-acd4f2d8d745/current/log_inprogress_0
2019-06-12 16:39:50,102 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-12 16:39:50,103 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87: close
2019-06-12 16:39:50,103 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87: shutdown group-ACD4F2D8D745
2019-06-12 16:39:50,104 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-ACD4F2D8D745,id=529a3322-1bea-4566-bde1-feb7cc9f0f87
2019-06-12 16:39:50,104 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87: shutdown LeaderState
2019-06-12 16:39:50,104 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87-PendingRequests: sendNotLeaderResponses
2019-06-12 16:39:50,105 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-529a3322-1bea-4566-bde1-feb7cc9f0f87-group-ACD4F2D8D745: set stopIndex = 2
2019-06-12 16:39:50,105 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-12 16:39:50,106 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2573413e-e016-4ee2-a917-ae95073c0e28/ratis/75013aed-c7a6-4e45-aead-acd4f2d8d745/sm/snapshot.1_2
2019-06-12 16:39:50,106 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87:group-ACD4F2D8D745 closes. The last applied log index is 2
2019-06-12 16:39:50,106 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-12 16:39:50,107 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87-RaftLogWorker close()
2019-06-12 16:39:50,108 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87: shutdown server with port 41093 now
2019-06-12 16:39:50,109 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 529a3322-1bea-4566-bde1-feb7cc9f0f87: shutdown server with port 41093 successfully
2019-06-12 16:39:50,116 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-12 16:39:50,144 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5e3b2785-c7aa-4805-b03c-802adbf157c7/hdds of  storage type : DISK and capacity : 104021790720
2019-06-12 16:39:50,144 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5e3b2785-c7aa-4805-b03c-802adbf157c7/hdds to VolumeSet
2019-06-12 16:39:50,144 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1bd0b0e5
2019-06-12 16:39:50,145 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1bd0b0e5
2019-06-12 16:39:50,157 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 39633
2019-06-12 16:39:50,158 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-12 16:39:50,158 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-12 16:39:50,159 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 39633 (custom)
2019-06-12 16:39:50,159 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-12 16:39:50,159 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-12 16:39:50,160 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-12 16:39:50,160 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-12 16:39:50,160 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5e3b2785-c7aa-4805-b03c-802adbf157c7/ratis] (custom)
2019-06-12 16:39:50,161 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 45517
2019-06-12 16:39:50,161 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-12 16:39:50,161 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-12 16:39:50,162 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 00c6595e-3e1b-41a0-a39b-420ed27053c5 at port 39633
2019-06-12 16:39:50,167 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5: start RPC server
2019-06-12 16:39:50,168 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5: GrpcService started, listening on 0.0.0.0/0.0.0.0:39633
2019-06-12 16:39:50,177 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5: addNew group-CB87105BAFA6:[00c6595e-3e1b-41a0-a39b-420ed27053c5:127.0.0.1:39633] returns group-CB87105BAFA6:java.util.concurrent.CompletableFuture@54784d8f[Not completed]
2019-06-12 16:39:50,177 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5: new RaftServerImpl for group-CB87105BAFA6:[00c6595e-3e1b-41a0-a39b-420ed27053c5:127.0.0.1:39633] with ContainerStateMachine:uninitialized
2019-06-12 16:39:50,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-12 16:39:50,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-12 16:39:50,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-12 16:39:50,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-12 16:39:50,178 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5:group-CB87105BAFA6 ConfigurationManager, init=-1: [00c6595e-3e1b-41a0-a39b-420ed27053c5:127.0.0.1:39633], old=null, confs=<EMPTY_MAP>
2019-06-12 16:39:50,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5e3b2785-c7aa-4805-b03c-802adbf157c7/ratis] (custom)
2019-06-12 16:39:50,178 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5e3b2785-c7aa-4805-b03c-802adbf157c7/ratis/c923f1c3-f276-4df1-ab12-cb87105bafa6 does not exist. Creating ...
2019-06-12 16:39:50,181 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5e3b2785-c7aa-4805-b03c-802adbf157c7/ratis/c923f1c3-f276-4df1-ab12-cb87105bafa6/in_use.lock acquired by nodename 4189@ozone-c9rd4-1241589905
2019-06-12 16:39:50,183 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5e3b2785-c7aa-4805-b03c-802adbf157c7/ratis/c923f1c3-f276-4df1-ab12-cb87105bafa6 has been successfully formatted.
2019-06-12 16:39:50,183 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-12 16:39:50,183 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-12 16:39:50,183 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-12 16:39:50,183 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-12 16:39:50,183 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-12 16:39:50,184 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-12 16:39:50,184 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 00c6595e-3e1b-41a0-a39b-420ed27053c5-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5e3b2785-c7aa-4805-b03c-802adbf157c7/ratis/c923f1c3-f276-4df1-ab12-cb87105bafa6
2019-06-12 16:39:50,184 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-12 16:39:50,184 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-12 16:39:50,184 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-12 16:39:50,184 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-12 16:39:50,184 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-12 16:39:50,184 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-12 16:39:50,184 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-12 16:39:50,184 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-12 16:39:50,184 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-12 16:39:50,184 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-12 16:39:50,185 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-12 16:39:50,185 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-12 16:39:50,185 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-12 16:39:50,185 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5: start group-CB87105BAFA6
2019-06-12 16:39:50,185 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5:group-CB87105BAFA6 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-12 16:39:50,185 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5: start FollowerState
2019-06-12 16:39:50,186 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-CB87105BAFA6,id=00c6595e-3e1b-41a0-a39b-420ed27053c5
2019-06-12 16:39:51,254 INFO  impl.FollowerState (FollowerState.java:run(101)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5:group-CB87105BAFA6 changes to CANDIDATE, lastRpcTime:1068, electionTimeout:1068ms
2019-06-12 16:39:51,254 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5: shutdown FollowerState
2019-06-12 16:39:51,254 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5:group-CB87105BAFA6 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-12 16:39:51,254 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5: start LeaderElection
2019-06-12 16:39:51,257 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5:group-CB87105BAFA6:LeaderElection3: begin an election at term 1 for -1: [00c6595e-3e1b-41a0-a39b-420ed27053c5:127.0.0.1:39633], old=null
2019-06-12 16:39:51,257 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5: shutdown LeaderElection
2019-06-12 16:39:51,257 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5:group-CB87105BAFA6 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-12 16:39:51,257 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5:group-CB87105BAFA6 change Leader from null to 00c6595e-3e1b-41a0-a39b-420ed27053c5 at term 1 for becomeLeader, leader elected after 1073ms
2019-06-12 16:39:51,257 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-12 16:39:51,257 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-12 16:39:51,257 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-12 16:39:51,257 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-12 16:39:51,258 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5: start LeaderState
2019-06-12 16:39:51,258 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5-RaftLogWorker: Starting segment from index:0
2019-06-12 16:39:51,261 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5:group-CB87105BAFA6 set configuration 0: [00c6595e-3e1b-41a0-a39b-420ed27053c5:127.0.0.1:39633], old=null at 0
2019-06-12 16:39:51,293 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5e3b2785-c7aa-4805-b03c-802adbf157c7/ratis/c923f1c3-f276-4df1-ab12-cb87105bafa6/current/log_inprogress_0
2019-06-12 16:39:52,225 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 1162233534581144340 is closed with bcsId 0.
2019-06-12 16:39:52,226 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-12 16:39:52,226 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5: close
2019-06-12 16:39:52,227 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5: shutdown group-CB87105BAFA6
2019-06-12 16:39:52,227 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-CB87105BAFA6,id=00c6595e-3e1b-41a0-a39b-420ed27053c5
2019-06-12 16:39:52,227 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5: shutdown LeaderState
2019-06-12 16:39:52,227 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5-PendingRequests: sendNotLeaderResponses
2019-06-12 16:39:52,228 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-00c6595e-3e1b-41a0-a39b-420ed27053c5-group-CB87105BAFA6: set stopIndex = 2
2019-06-12 16:39:52,228 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-12 16:39:52,229 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5e3b2785-c7aa-4805-b03c-802adbf157c7/ratis/c923f1c3-f276-4df1-ab12-cb87105bafa6/sm/snapshot.1_2
2019-06-12 16:39:52,229 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5:group-CB87105BAFA6 closes. The last applied log index is 2
2019-06-12 16:39:52,229 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-12 16:39:52,230 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5-RaftLogWorker close()
2019-06-12 16:39:52,231 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5: shutdown server with port 39633 now
2019-06-12 16:39:52,232 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 00c6595e-3e1b-41a0-a39b-420ed27053c5: shutdown server with port 39633 successfully
2019-06-12 16:39:52,233 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-12 16:39:52,278 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerbca40fa0-c05c-4fef-9fba-487f33124cea/hdds of  storage type : DISK and capacity : 104021790720
2019-06-12 16:39:52,278 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerbca40fa0-c05c-4fef-9fba-487f33124cea/hdds to VolumeSet
2019-06-12 16:39:52,278 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@552ed807
2019-06-12 16:39:52,278 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@552ed807
2019-06-12 16:39:52,287 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 34705
2019-06-12 16:39:52,288 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-12 16:39:52,289 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-12 16:39:52,289 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 34705 (custom)
2019-06-12 16:39:52,289 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-12 16:39:52,289 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-12 16:39:52,290 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-12 16:39:52,290 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-12 16:39:52,290 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerbca40fa0-c05c-4fef-9fba-487f33124cea/ratis] (custom)
2019-06-12 16:39:52,291 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 38731
2019-06-12 16:39:52,291 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-12 16:39:52,291 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-12 16:39:52,292 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 2ba3a0cb-239c-476b-900e-5edd8509a77f at port 34705
2019-06-12 16:39:52,302 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f: start RPC server
2019-06-12 16:39:52,303 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f: GrpcService started, listening on 0.0.0.0/0.0.0.0:34705
Jun 12, 2019 4:39:52 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:39633} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 12, 2019 4:39:52 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:41093} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-12 16:39:52,318 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f: addNew group-3CC5E596DEAB:[2ba3a0cb-239c-476b-900e-5edd8509a77f:127.0.0.1:34705] returns group-3CC5E596DEAB:java.util.concurrent.CompletableFuture@181c9b9f[Not completed]
2019-06-12 16:39:52,319 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f: new RaftServerImpl for group-3CC5E596DEAB:[2ba3a0cb-239c-476b-900e-5edd8509a77f:127.0.0.1:34705] with ContainerStateMachine:uninitialized
2019-06-12 16:39:52,319 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-12 16:39:52,319 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-12 16:39:52,319 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-12 16:39:52,319 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-12 16:39:52,320 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f:group-3CC5E596DEAB ConfigurationManager, init=-1: [2ba3a0cb-239c-476b-900e-5edd8509a77f:127.0.0.1:34705], old=null, confs=<EMPTY_MAP>
2019-06-12 16:39:52,320 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerbca40fa0-c05c-4fef-9fba-487f33124cea/ratis] (custom)
2019-06-12 16:39:52,320 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerbca40fa0-c05c-4fef-9fba-487f33124cea/ratis/81c49493-b6b5-4c38-8d88-3cc5e596deab does not exist. Creating ...
2019-06-12 16:39:52,322 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerbca40fa0-c05c-4fef-9fba-487f33124cea/ratis/81c49493-b6b5-4c38-8d88-3cc5e596deab/in_use.lock acquired by nodename 4189@ozone-c9rd4-1241589905
2019-06-12 16:39:52,324 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerbca40fa0-c05c-4fef-9fba-487f33124cea/ratis/81c49493-b6b5-4c38-8d88-3cc5e596deab has been successfully formatted.
2019-06-12 16:39:52,324 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-12 16:39:52,324 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-12 16:39:52,324 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-12 16:39:52,324 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-12 16:39:52,324 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-12 16:39:52,325 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-12 16:39:52,325 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 2ba3a0cb-239c-476b-900e-5edd8509a77f-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerbca40fa0-c05c-4fef-9fba-487f33124cea/ratis/81c49493-b6b5-4c38-8d88-3cc5e596deab
2019-06-12 16:39:52,325 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-12 16:39:52,325 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-12 16:39:52,325 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-12 16:39:52,325 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-12 16:39:52,325 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-12 16:39:52,325 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-12 16:39:52,325 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-12 16:39:52,325 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-12 16:39:52,325 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-12 16:39:52,326 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-12 16:39:52,326 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-12 16:39:52,326 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-12 16:39:52,326 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-12 16:39:52,326 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f: start group-3CC5E596DEAB
2019-06-12 16:39:52,326 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f:group-3CC5E596DEAB changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-12 16:39:52,326 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f: start FollowerState
2019-06-12 16:39:52,327 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-3CC5E596DEAB,id=2ba3a0cb-239c-476b-900e-5edd8509a77f
2019-06-12 16:39:53,372 INFO  impl.FollowerState (FollowerState.java:run(101)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f:group-3CC5E596DEAB changes to CANDIDATE, lastRpcTime:1045, electionTimeout:1045ms
2019-06-12 16:39:53,372 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f: shutdown FollowerState
2019-06-12 16:39:53,372 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f:group-3CC5E596DEAB changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-12 16:39:53,372 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f: start LeaderElection
2019-06-12 16:39:53,383 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f:group-3CC5E596DEAB:LeaderElection4: begin an election at term 1 for -1: [2ba3a0cb-239c-476b-900e-5edd8509a77f:127.0.0.1:34705], old=null
2019-06-12 16:39:53,384 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f: shutdown LeaderElection
2019-06-12 16:39:53,384 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f:group-3CC5E596DEAB changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-12 16:39:53,384 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f:group-3CC5E596DEAB change Leader from null to 2ba3a0cb-239c-476b-900e-5edd8509a77f at term 1 for becomeLeader, leader elected after 1059ms
2019-06-12 16:39:53,384 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-12 16:39:53,384 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-12 16:39:53,384 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-12 16:39:53,384 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-12 16:39:53,385 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f: start LeaderState
2019-06-12 16:39:53,385 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f-RaftLogWorker: Starting segment from index:0
2019-06-12 16:39:53,385 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f:group-3CC5E596DEAB set configuration 0: [2ba3a0cb-239c-476b-900e-5edd8509a77f:127.0.0.1:34705], old=null at 0
2019-06-12 16:39:53,428 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerbca40fa0-c05c-4fef-9fba-487f33124cea/ratis/81c49493-b6b5-4c38-8d88-3cc5e596deab/current/log_inprogress_0
2019-06-12 16:39:54,381 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 7027231459617672763 is closed with bcsId 0.
2019-06-12 16:39:54,381 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-12 16:39:54,382 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f: close
2019-06-12 16:39:54,382 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f: shutdown group-3CC5E596DEAB
2019-06-12 16:39:54,382 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-3CC5E596DEAB,id=2ba3a0cb-239c-476b-900e-5edd8509a77f
2019-06-12 16:39:54,382 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f: shutdown LeaderState
2019-06-12 16:39:54,383 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f-PendingRequests: sendNotLeaderResponses
2019-06-12 16:39:54,383 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-2ba3a0cb-239c-476b-900e-5edd8509a77f-group-3CC5E596DEAB: set stopIndex = 2
2019-06-12 16:39:54,383 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-12 16:39:54,384 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerbca40fa0-c05c-4fef-9fba-487f33124cea/ratis/81c49493-b6b5-4c38-8d88-3cc5e596deab/sm/snapshot.1_2
2019-06-12 16:39:54,384 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f:group-3CC5E596DEAB closes. The last applied log index is 2
2019-06-12 16:39:54,384 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-12 16:39:54,385 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f-RaftLogWorker close()
2019-06-12 16:39:54,386 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f: shutdown server with port 34705 now
2019-06-12 16:39:54,389 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 2ba3a0cb-239c-476b-900e-5edd8509a77f: shutdown server with port 34705 successfully
2019-06-12 16:39:54,394 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-12 16:39:54,424 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3729c0b1-f91f-426a-a3b4-38ed9109fd08/hdds of  storage type : DISK and capacity : 104021790720
2019-06-12 16:39:54,425 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3729c0b1-f91f-426a-a3b4-38ed9109fd08/hdds to VolumeSet
2019-06-12 16:39:54,425 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@4fad6218
2019-06-12 16:39:54,433 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@4fad6218
2019-06-12 16:39:54,459 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 42833
2019-06-12 16:39:54,460 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-12 16:39:54,461 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-12 16:39:54,461 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42833 (custom)
2019-06-12 16:39:54,461 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-12 16:39:54,462 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-12 16:39:54,462 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-12 16:39:54,462 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-12 16:39:54,463 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3729c0b1-f91f-426a-a3b4-38ed9109fd08/ratis] (custom)
2019-06-12 16:39:54,463 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 38381
2019-06-12 16:39:54,463 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-12 16:39:54,464 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-12 16:39:54,464 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 985e7784-7df6-47ef-8c6e-1b882d1002d3 at port 42833
2019-06-12 16:39:54,557 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3: start RPC server
2019-06-12 16:39:54,559 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3: GrpcService started, listening on 0.0.0.0/0.0.0.0:42833
2019-06-12 16:39:54,577 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3: addNew group-DBF01D0ABA4D:[985e7784-7df6-47ef-8c6e-1b882d1002d3:127.0.0.1:42833] returns group-DBF01D0ABA4D:java.util.concurrent.CompletableFuture@3b5710d6[Not completed]
2019-06-12 16:39:54,577 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3: new RaftServerImpl for group-DBF01D0ABA4D:[985e7784-7df6-47ef-8c6e-1b882d1002d3:127.0.0.1:42833] with ContainerStateMachine:uninitialized
2019-06-12 16:39:54,578 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-12 16:39:54,578 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-12 16:39:54,578 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-12 16:39:54,578 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-12 16:39:54,578 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3:group-DBF01D0ABA4D ConfigurationManager, init=-1: [985e7784-7df6-47ef-8c6e-1b882d1002d3:127.0.0.1:42833], old=null, confs=<EMPTY_MAP>
2019-06-12 16:39:54,579 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3729c0b1-f91f-426a-a3b4-38ed9109fd08/ratis] (custom)
2019-06-12 16:39:54,579 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3729c0b1-f91f-426a-a3b4-38ed9109fd08/ratis/48c8e846-b1e3-4f6e-beeb-dbf01d0aba4d does not exist. Creating ...
2019-06-12 16:39:54,582 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3729c0b1-f91f-426a-a3b4-38ed9109fd08/ratis/48c8e846-b1e3-4f6e-beeb-dbf01d0aba4d/in_use.lock acquired by nodename 4189@ozone-c9rd4-1241589905
2019-06-12 16:39:54,584 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3729c0b1-f91f-426a-a3b4-38ed9109fd08/ratis/48c8e846-b1e3-4f6e-beeb-dbf01d0aba4d has been successfully formatted.
2019-06-12 16:39:54,584 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-12 16:39:54,584 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-12 16:39:54,584 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-12 16:39:54,584 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-12 16:39:54,584 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-12 16:39:54,585 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-12 16:39:54,585 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 985e7784-7df6-47ef-8c6e-1b882d1002d3-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3729c0b1-f91f-426a-a3b4-38ed9109fd08/ratis/48c8e846-b1e3-4f6e-beeb-dbf01d0aba4d
2019-06-12 16:39:54,585 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-12 16:39:54,585 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-12 16:39:54,585 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-12 16:39:54,585 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-12 16:39:54,585 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-12 16:39:54,586 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-12 16:39:54,586 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-12 16:39:54,586 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-12 16:39:54,586 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-12 16:39:54,586 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-12 16:39:54,587 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-12 16:39:54,587 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-12 16:39:54,587 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-12 16:39:54,587 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3: start group-DBF01D0ABA4D
2019-06-12 16:39:54,588 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3:group-DBF01D0ABA4D changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-12 16:39:54,588 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3: start FollowerState
2019-06-12 16:39:54,589 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-DBF01D0ABA4D,id=985e7784-7df6-47ef-8c6e-1b882d1002d3
2019-06-12 16:39:55,646 INFO  impl.FollowerState (FollowerState.java:run(101)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3:group-DBF01D0ABA4D changes to CANDIDATE, lastRpcTime:1057, electionTimeout:1057ms
2019-06-12 16:39:55,646 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3: shutdown FollowerState
2019-06-12 16:39:55,646 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3:group-DBF01D0ABA4D changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-12 16:39:55,646 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3: start LeaderElection
2019-06-12 16:39:55,650 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3:group-DBF01D0ABA4D:LeaderElection5: begin an election at term 1 for -1: [985e7784-7df6-47ef-8c6e-1b882d1002d3:127.0.0.1:42833], old=null
2019-06-12 16:39:55,650 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3: shutdown LeaderElection
2019-06-12 16:39:55,650 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3:group-DBF01D0ABA4D changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-12 16:39:55,651 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3:group-DBF01D0ABA4D change Leader from null to 985e7784-7df6-47ef-8c6e-1b882d1002d3 at term 1 for becomeLeader, leader elected after 1066ms
2019-06-12 16:39:55,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-12 16:39:55,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-12 16:39:55,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-12 16:39:55,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-12 16:39:55,651 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3: start LeaderState
2019-06-12 16:39:55,652 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3-RaftLogWorker: Starting segment from index:0
2019-06-12 16:39:55,652 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3:group-DBF01D0ABA4D set configuration 0: [985e7784-7df6-47ef-8c6e-1b882d1002d3:127.0.0.1:42833], old=null at 0
2019-06-12 16:39:55,687 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3729c0b1-f91f-426a-a3b4-38ed9109fd08/ratis/48c8e846-b1e3-4f6e-beeb-dbf01d0aba4d/current/log_inprogress_0
2019-06-12 16:39:56,630 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 3612662185525019789 is closed with bcsId 0.
2019-06-12 16:39:56,631 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-12 16:39:56,631 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3: close
2019-06-12 16:39:56,631 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3: shutdown group-DBF01D0ABA4D
2019-06-12 16:39:56,631 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-DBF01D0ABA4D,id=985e7784-7df6-47ef-8c6e-1b882d1002d3
2019-06-12 16:39:56,631 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3: shutdown LeaderState
2019-06-12 16:39:56,632 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3-PendingRequests: sendNotLeaderResponses
2019-06-12 16:39:56,632 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-985e7784-7df6-47ef-8c6e-1b882d1002d3-group-DBF01D0ABA4D: set stopIndex = 4
2019-06-12 16:39:56,632 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-12 16:39:56,633 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3729c0b1-f91f-426a-a3b4-38ed9109fd08/ratis/48c8e846-b1e3-4f6e-beeb-dbf01d0aba4d/sm/snapshot.1_4
2019-06-12 16:39:56,633 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3:group-DBF01D0ABA4D closes. The last applied log index is 4
2019-06-12 16:39:56,633 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-12 16:39:56,634 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3-RaftLogWorker close()
2019-06-12 16:39:56,634 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3: shutdown server with port 42833 now
2019-06-12 16:39:56,635 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 985e7784-7df6-47ef-8c6e-1b882d1002d3: shutdown server with port 42833 successfully
2019-06-12 16:39:56,636 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
