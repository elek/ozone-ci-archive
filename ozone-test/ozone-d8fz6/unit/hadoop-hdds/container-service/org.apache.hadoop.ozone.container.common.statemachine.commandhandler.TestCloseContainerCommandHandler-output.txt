2019-06-13 19:21:58,087 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9f480f7b-2832-4e26-83ce-41b0f7e83bea/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 19:21:58,093 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9f480f7b-2832-4e26-83ce-41b0f7e83bea/hdds to VolumeSet
2019-06-13 19:21:58,108 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-13 19:21:58,145 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-13 19:21:58,539 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 45759
2019-06-13 19:21:58,948 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 19:21:58,969 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 19:21:58,977 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 45759 (custom)
2019-06-13 19:21:58,978 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 19:21:58,980 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 19:21:58,981 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 19:21:58,982 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 19:21:59,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9f480f7b-2832-4e26-83ce-41b0f7e83bea/ratis] (custom)
2019-06-13 19:21:59,113 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 38131
2019-06-13 19:21:59,134 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 19:21:59,134 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 19:21:59,136 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 1b7b4d7c-cf02-4504-987f-c8ca98da8b41 at port 45759
2019-06-13 19:21:59,148 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41: start RPC server
2019-06-13 19:21:59,278 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41: GrpcService started, listening on 0.0.0.0/0.0.0.0:45759
2019-06-13 19:21:59,564 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41: addNew group-CD2C4EC1FE70:[1b7b4d7c-cf02-4504-987f-c8ca98da8b41:127.0.0.1:45759] returns group-CD2C4EC1FE70:java.util.concurrent.CompletableFuture@3d7c71d2[Not completed]
2019-06-13 19:21:59,590 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41: new RaftServerImpl for group-CD2C4EC1FE70:[1b7b4d7c-cf02-4504-987f-c8ca98da8b41:127.0.0.1:45759] with ContainerStateMachine:uninitialized
2019-06-13 19:21:59,591 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 19:21:59,591 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 19:21:59,591 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 19:21:59,592 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 19:21:59,597 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41:group-CD2C4EC1FE70 ConfigurationManager, init=-1: [1b7b4d7c-cf02-4504-987f-c8ca98da8b41:127.0.0.1:45759], old=null, confs=<EMPTY_MAP>
2019-06-13 19:21:59,597 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9f480f7b-2832-4e26-83ce-41b0f7e83bea/ratis] (custom)
2019-06-13 19:21:59,603 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9f480f7b-2832-4e26-83ce-41b0f7e83bea/ratis/313e8680-312a-4308-8aae-cd2c4ec1fe70 does not exist. Creating ...
2019-06-13 19:21:59,611 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9f480f7b-2832-4e26-83ce-41b0f7e83bea/ratis/313e8680-312a-4308-8aae-cd2c4ec1fe70/in_use.lock acquired by nodename 4187@ozone-d8fz6-366598861
2019-06-13 19:21:59,618 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9f480f7b-2832-4e26-83ce-41b0f7e83bea/ratis/313e8680-312a-4308-8aae-cd2c4ec1fe70 has been successfully formatted.
2019-06-13 19:21:59,620 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 19:21:59,620 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 19:21:59,622 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 19:21:59,623 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 19:21:59,626 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 19:21:59,629 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 19:21:59,631 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 1b7b4d7c-cf02-4504-987f-c8ca98da8b41-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9f480f7b-2832-4e26-83ce-41b0f7e83bea/ratis/313e8680-312a-4308-8aae-cd2c4ec1fe70
2019-06-13 19:21:59,632 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 19:21:59,632 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 19:21:59,633 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 19:21:59,634 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 19:21:59,634 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 19:21:59,634 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 19:21:59,635 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 19:21:59,635 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 19:21:59,636 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 19:21:59,637 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 19:21:59,642 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 19:21:59,643 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 19:21:59,643 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 19:21:59,745 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41: start group-CD2C4EC1FE70
2019-06-13 19:21:59,746 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41:group-CD2C4EC1FE70 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 19:21:59,747 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41: start FollowerState
2019-06-13 19:21:59,749 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-CD2C4EC1FE70,id=1b7b4d7c-cf02-4504-987f-c8ca98da8b41
2019-06-13 19:22:00,851 INFO  impl.FollowerState (FollowerState.java:run(101)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41:group-CD2C4EC1FE70 changes to CANDIDATE, lastRpcTime:1103, electionTimeout:1103ms
2019-06-13 19:22:00,851 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41: shutdown FollowerState
2019-06-13 19:22:00,851 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41:group-CD2C4EC1FE70 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 19:22:00,853 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41: start LeaderElection
2019-06-13 19:22:00,856 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41:group-CD2C4EC1FE70:LeaderElection1: begin an election at term 1 for -1: [1b7b4d7c-cf02-4504-987f-c8ca98da8b41:127.0.0.1:45759], old=null
2019-06-13 19:22:00,857 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41: shutdown LeaderElection
2019-06-13 19:22:00,857 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41:group-CD2C4EC1FE70 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 19:22:00,858 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41:group-CD2C4EC1FE70 change Leader from null to 1b7b4d7c-cf02-4504-987f-c8ca98da8b41 at term 1 for becomeLeader, leader elected after 1237ms
2019-06-13 19:22:00,861 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 19:22:00,861 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 19:22:00,863 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 19:22:00,863 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 19:22:00,872 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41: start LeaderState
2019-06-13 19:22:00,886 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41-RaftLogWorker: Starting segment from index:0
2019-06-13 19:22:00,894 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41:group-CD2C4EC1FE70 set configuration 0: [1b7b4d7c-cf02-4504-987f-c8ca98da8b41:127.0.0.1:45759], old=null at 0
2019-06-13 19:22:01,021 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9f480f7b-2832-4e26-83ce-41b0f7e83bea/ratis/313e8680-312a-4308-8aae-cd2c4ec1fe70/current/log_inprogress_0
2019-06-13 19:22:01,960 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-13 19:22:02,019 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 5302182570368218632 is closed with bcsId 0.
2019-06-13 19:22:02,020 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 19:22:02,021 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41: close
2019-06-13 19:22:02,022 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41: shutdown group-CD2C4EC1FE70
2019-06-13 19:22:02,023 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-CD2C4EC1FE70,id=1b7b4d7c-cf02-4504-987f-c8ca98da8b41
2019-06-13 19:22:02,023 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41: shutdown LeaderState
2019-06-13 19:22:02,023 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41-PendingRequests: sendNotLeaderResponses
2019-06-13 19:22:02,026 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-1b7b4d7c-cf02-4504-987f-c8ca98da8b41-group-CD2C4EC1FE70: set stopIndex = 4
2019-06-13 19:22:02,026 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-13 19:22:02,026 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9f480f7b-2832-4e26-83ce-41b0f7e83bea/ratis/313e8680-312a-4308-8aae-cd2c4ec1fe70/sm/snapshot.1_4
2019-06-13 19:22:02,034 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41:group-CD2C4EC1FE70 closes. The last applied log index is 4
2019-06-13 19:22:02,035 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 19:22:02,036 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41-RaftLogWorker close()
2019-06-13 19:22:02,037 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41: shutdown server with port 45759 now
2019-06-13 19:22:02,040 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 1b7b4d7c-cf02-4504-987f-c8ca98da8b41: shutdown server with port 45759 successfully
2019-06-13 19:22:02,049 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 19:22:02,079 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c0205ce-114a-40fb-b36e-bfe7e1ff20a6/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 19:22:02,080 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c0205ce-114a-40fb-b36e-bfe7e1ff20a6/hdds to VolumeSet
2019-06-13 19:22:02,080 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@6f0cb5a1
2019-06-13 19:22:02,081 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@6f0cb5a1
2019-06-13 19:22:02,092 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 42031
2019-06-13 19:22:02,093 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 19:22:02,094 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 19:22:02,094 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42031 (custom)
2019-06-13 19:22:02,094 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 19:22:02,094 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 19:22:02,095 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 19:22:02,095 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 19:22:02,096 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c0205ce-114a-40fb-b36e-bfe7e1ff20a6/ratis] (custom)
2019-06-13 19:22:02,096 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 40181
2019-06-13 19:22:02,097 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 19:22:02,097 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 19:22:02,097 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 80be23fb-a0cd-4d66-b129-1c1fa9963397 at port 42031
2019-06-13 19:22:02,104 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397: start RPC server
2019-06-13 19:22:02,106 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397: GrpcService started, listening on 0.0.0.0/0.0.0.0:42031
2019-06-13 19:22:02,118 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397: addNew group-C46B8C88AA75:[80be23fb-a0cd-4d66-b129-1c1fa9963397:127.0.0.1:42031] returns group-C46B8C88AA75:java.util.concurrent.CompletableFuture@626931f2[Not completed]
2019-06-13 19:22:02,121 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397: new RaftServerImpl for group-C46B8C88AA75:[80be23fb-a0cd-4d66-b129-1c1fa9963397:127.0.0.1:42031] with ContainerStateMachine:uninitialized
2019-06-13 19:22:02,121 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 19:22:02,121 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 19:22:02,121 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 19:22:02,121 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 19:22:02,121 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397:group-C46B8C88AA75 ConfigurationManager, init=-1: [80be23fb-a0cd-4d66-b129-1c1fa9963397:127.0.0.1:42031], old=null, confs=<EMPTY_MAP>
2019-06-13 19:22:02,122 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c0205ce-114a-40fb-b36e-bfe7e1ff20a6/ratis] (custom)
2019-06-13 19:22:02,122 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c0205ce-114a-40fb-b36e-bfe7e1ff20a6/ratis/371074d4-b2ed-431e-b96b-c46b8c88aa75 does not exist. Creating ...
2019-06-13 19:22:02,125 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c0205ce-114a-40fb-b36e-bfe7e1ff20a6/ratis/371074d4-b2ed-431e-b96b-c46b8c88aa75/in_use.lock acquired by nodename 4187@ozone-d8fz6-366598861
2019-06-13 19:22:02,127 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c0205ce-114a-40fb-b36e-bfe7e1ff20a6/ratis/371074d4-b2ed-431e-b96b-c46b8c88aa75 has been successfully formatted.
2019-06-13 19:22:02,128 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 19:22:02,128 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 19:22:02,128 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 19:22:02,128 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 19:22:02,128 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 19:22:02,128 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 19:22:02,128 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 80be23fb-a0cd-4d66-b129-1c1fa9963397-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c0205ce-114a-40fb-b36e-bfe7e1ff20a6/ratis/371074d4-b2ed-431e-b96b-c46b8c88aa75
2019-06-13 19:22:02,128 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 19:22:02,128 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 19:22:02,129 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 19:22:02,129 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 19:22:02,129 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 19:22:02,129 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 19:22:02,129 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 19:22:02,129 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 19:22:02,130 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 19:22:02,130 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 19:22:02,130 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 19:22:02,130 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 19:22:02,131 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 19:22:02,131 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397: start group-C46B8C88AA75
2019-06-13 19:22:02,131 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397:group-C46B8C88AA75 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 19:22:02,131 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397: start FollowerState
2019-06-13 19:22:02,132 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C46B8C88AA75,id=80be23fb-a0cd-4d66-b129-1c1fa9963397
2019-06-13 19:22:03,232 INFO  impl.FollowerState (FollowerState.java:run(101)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397:group-C46B8C88AA75 changes to CANDIDATE, lastRpcTime:1100, electionTimeout:1100ms
2019-06-13 19:22:03,232 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397: shutdown FollowerState
2019-06-13 19:22:03,232 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397:group-C46B8C88AA75 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 19:22:03,232 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397: start LeaderElection
2019-06-13 19:22:03,236 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397:group-C46B8C88AA75:LeaderElection2: begin an election at term 1 for -1: [80be23fb-a0cd-4d66-b129-1c1fa9963397:127.0.0.1:42031], old=null
2019-06-13 19:22:03,236 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397: shutdown LeaderElection
2019-06-13 19:22:03,236 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397:group-C46B8C88AA75 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 19:22:03,236 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397:group-C46B8C88AA75 change Leader from null to 80be23fb-a0cd-4d66-b129-1c1fa9963397 at term 1 for becomeLeader, leader elected after 1108ms
2019-06-13 19:22:03,236 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 19:22:03,236 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 19:22:03,237 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 19:22:03,237 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 19:22:03,237 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397: start LeaderState
2019-06-13 19:22:03,237 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397-RaftLogWorker: Starting segment from index:0
2019-06-13 19:22:03,240 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397:group-C46B8C88AA75 set configuration 0: [80be23fb-a0cd-4d66-b129-1c1fa9963397:127.0.0.1:42031], old=null at 0
2019-06-13 19:22:03,273 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c0205ce-114a-40fb-b36e-bfe7e1ff20a6/ratis/371074d4-b2ed-431e-b96b-c46b8c88aa75/current/log_inprogress_0
2019-06-13 19:22:04,165 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 19:22:04,166 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397: close
2019-06-13 19:22:04,166 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397: shutdown group-C46B8C88AA75
2019-06-13 19:22:04,167 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C46B8C88AA75,id=80be23fb-a0cd-4d66-b129-1c1fa9963397
2019-06-13 19:22:04,167 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397: shutdown LeaderState
2019-06-13 19:22:04,168 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397-PendingRequests: sendNotLeaderResponses
2019-06-13 19:22:04,168 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-80be23fb-a0cd-4d66-b129-1c1fa9963397-group-C46B8C88AA75: set stopIndex = 2
2019-06-13 19:22:04,168 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-13 19:22:04,169 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5c0205ce-114a-40fb-b36e-bfe7e1ff20a6/ratis/371074d4-b2ed-431e-b96b-c46b8c88aa75/sm/snapshot.1_2
2019-06-13 19:22:04,169 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397:group-C46B8C88AA75 closes. The last applied log index is 2
2019-06-13 19:22:04,170 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 19:22:04,172 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397-RaftLogWorker close()
2019-06-13 19:22:04,173 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397: shutdown server with port 42031 now
2019-06-13 19:22:04,174 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 80be23fb-a0cd-4d66-b129-1c1fa9963397: shutdown server with port 42031 successfully
2019-06-13 19:22:04,176 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 19:22:04,202 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerccd76f81-3eda-4255-9854-8eb2858ed073/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 19:22:04,203 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerccd76f81-3eda-4255-9854-8eb2858ed073/hdds to VolumeSet
2019-06-13 19:22:04,203 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@5e2f3be5
2019-06-13 19:22:04,209 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@5e2f3be5
2019-06-13 19:22:04,219 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 35565
2019-06-13 19:22:04,222 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 19:22:04,222 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 19:22:04,223 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 35565 (custom)
2019-06-13 19:22:04,223 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 19:22:04,223 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 19:22:04,223 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 19:22:04,224 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 19:22:04,224 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerccd76f81-3eda-4255-9854-8eb2858ed073/ratis] (custom)
2019-06-13 19:22:04,225 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 36847
2019-06-13 19:22:04,225 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 19:22:04,225 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 19:22:04,225 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 96dbdb08-3467-474c-b828-b4b089e391c0 at port 35565
2019-06-13 19:22:04,236 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 96dbdb08-3467-474c-b828-b4b089e391c0: start RPC server
2019-06-13 19:22:04,237 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 96dbdb08-3467-474c-b828-b4b089e391c0: GrpcService started, listening on 0.0.0.0/0.0.0.0:35565
2019-06-13 19:22:04,249 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 96dbdb08-3467-474c-b828-b4b089e391c0: addNew group-BC497ABA28AB:[96dbdb08-3467-474c-b828-b4b089e391c0:127.0.0.1:35565] returns group-BC497ABA28AB:java.util.concurrent.CompletableFuture@4d48c71f[Not completed]
2019-06-13 19:22:04,250 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 96dbdb08-3467-474c-b828-b4b089e391c0: new RaftServerImpl for group-BC497ABA28AB:[96dbdb08-3467-474c-b828-b4b089e391c0:127.0.0.1:35565] with ContainerStateMachine:uninitialized
2019-06-13 19:22:04,251 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 19:22:04,251 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 19:22:04,251 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 19:22:04,251 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 19:22:04,251 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 96dbdb08-3467-474c-b828-b4b089e391c0:group-BC497ABA28AB ConfigurationManager, init=-1: [96dbdb08-3467-474c-b828-b4b089e391c0:127.0.0.1:35565], old=null, confs=<EMPTY_MAP>
2019-06-13 19:22:04,251 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerccd76f81-3eda-4255-9854-8eb2858ed073/ratis] (custom)
2019-06-13 19:22:04,252 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerccd76f81-3eda-4255-9854-8eb2858ed073/ratis/1b15dc99-a14a-4c61-890b-bc497aba28ab does not exist. Creating ...
2019-06-13 19:22:04,254 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerccd76f81-3eda-4255-9854-8eb2858ed073/ratis/1b15dc99-a14a-4c61-890b-bc497aba28ab/in_use.lock acquired by nodename 4187@ozone-d8fz6-366598861
2019-06-13 19:22:04,257 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerccd76f81-3eda-4255-9854-8eb2858ed073/ratis/1b15dc99-a14a-4c61-890b-bc497aba28ab has been successfully formatted.
2019-06-13 19:22:04,257 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 19:22:04,258 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 19:22:04,258 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 19:22:04,258 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 19:22:04,258 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 19:22:04,258 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 19:22:04,258 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 96dbdb08-3467-474c-b828-b4b089e391c0-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerccd76f81-3eda-4255-9854-8eb2858ed073/ratis/1b15dc99-a14a-4c61-890b-bc497aba28ab
2019-06-13 19:22:04,258 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 19:22:04,258 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 19:22:04,258 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 19:22:04,258 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 19:22:04,259 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 19:22:04,259 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 19:22:04,259 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 19:22:04,259 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 19:22:04,259 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 19:22:04,259 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 19:22:04,260 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 19:22:04,260 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 19:22:04,260 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 19:22:04,260 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 96dbdb08-3467-474c-b828-b4b089e391c0: start group-BC497ABA28AB
2019-06-13 19:22:04,260 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 96dbdb08-3467-474c-b828-b4b089e391c0:group-BC497ABA28AB changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 19:22:04,260 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 96dbdb08-3467-474c-b828-b4b089e391c0: start FollowerState
2019-06-13 19:22:04,261 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-BC497ABA28AB,id=96dbdb08-3467-474c-b828-b4b089e391c0
2019-06-13 19:22:05,265 INFO  impl.FollowerState (FollowerState.java:run(101)) - 96dbdb08-3467-474c-b828-b4b089e391c0:group-BC497ABA28AB changes to CANDIDATE, lastRpcTime:1004, electionTimeout:1004ms
2019-06-13 19:22:05,265 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 96dbdb08-3467-474c-b828-b4b089e391c0: shutdown FollowerState
2019-06-13 19:22:05,265 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 96dbdb08-3467-474c-b828-b4b089e391c0:group-BC497ABA28AB changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 19:22:05,265 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 96dbdb08-3467-474c-b828-b4b089e391c0: start LeaderElection
2019-06-13 19:22:05,268 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 96dbdb08-3467-474c-b828-b4b089e391c0:group-BC497ABA28AB:LeaderElection3: begin an election at term 1 for -1: [96dbdb08-3467-474c-b828-b4b089e391c0:127.0.0.1:35565], old=null
2019-06-13 19:22:05,268 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 96dbdb08-3467-474c-b828-b4b089e391c0: shutdown LeaderElection
2019-06-13 19:22:05,268 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 96dbdb08-3467-474c-b828-b4b089e391c0:group-BC497ABA28AB changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 19:22:05,268 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 96dbdb08-3467-474c-b828-b4b089e391c0:group-BC497ABA28AB change Leader from null to 96dbdb08-3467-474c-b828-b4b089e391c0 at term 1 for becomeLeader, leader elected after 1010ms
2019-06-13 19:22:05,269 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 19:22:05,269 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 19:22:05,269 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 19:22:05,269 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 19:22:05,269 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 96dbdb08-3467-474c-b828-b4b089e391c0: start LeaderState
2019-06-13 19:22:05,269 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 96dbdb08-3467-474c-b828-b4b089e391c0-RaftLogWorker: Starting segment from index:0
2019-06-13 19:22:05,274 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 96dbdb08-3467-474c-b828-b4b089e391c0:group-BC497ABA28AB set configuration 0: [96dbdb08-3467-474c-b828-b4b089e391c0:127.0.0.1:35565], old=null at 0
2019-06-13 19:22:05,306 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 96dbdb08-3467-474c-b828-b4b089e391c0-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerccd76f81-3eda-4255-9854-8eb2858ed073/ratis/1b15dc99-a14a-4c61-890b-bc497aba28ab/current/log_inprogress_0
2019-06-13 19:22:06,307 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 1119218303681359035 is closed with bcsId 0.
2019-06-13 19:22:06,308 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 19:22:06,309 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 96dbdb08-3467-474c-b828-b4b089e391c0: close
2019-06-13 19:22:06,309 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 96dbdb08-3467-474c-b828-b4b089e391c0: shutdown group-BC497ABA28AB
2019-06-13 19:22:06,309 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-BC497ABA28AB,id=96dbdb08-3467-474c-b828-b4b089e391c0
2019-06-13 19:22:06,309 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 96dbdb08-3467-474c-b828-b4b089e391c0: shutdown LeaderState
2019-06-13 19:22:06,310 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 96dbdb08-3467-474c-b828-b4b089e391c0-PendingRequests: sendNotLeaderResponses
2019-06-13 19:22:06,310 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-96dbdb08-3467-474c-b828-b4b089e391c0-group-BC497ABA28AB: set stopIndex = 2
2019-06-13 19:22:06,310 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-13 19:22:06,311 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerccd76f81-3eda-4255-9854-8eb2858ed073/ratis/1b15dc99-a14a-4c61-890b-bc497aba28ab/sm/snapshot.1_2
2019-06-13 19:22:06,311 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 96dbdb08-3467-474c-b828-b4b089e391c0:group-BC497ABA28AB closes. The last applied log index is 2
2019-06-13 19:22:06,311 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 96dbdb08-3467-474c-b828-b4b089e391c0-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 19:22:06,312 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 96dbdb08-3467-474c-b828-b4b089e391c0-RaftLogWorker close()
2019-06-13 19:22:06,315 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 96dbdb08-3467-474c-b828-b4b089e391c0: shutdown server with port 35565 now
2019-06-13 19:22:06,320 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 96dbdb08-3467-474c-b828-b4b089e391c0: shutdown server with port 35565 successfully
2019-06-13 19:22:06,346 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 19:22:06,372 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler04e21ffe-6f34-40b4-a749-40db3e90ea5b/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 19:22:06,373 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler04e21ffe-6f34-40b4-a749-40db3e90ea5b/hdds to VolumeSet
2019-06-13 19:22:06,373 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@7c84195
2019-06-13 19:22:06,374 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@7c84195
2019-06-13 19:22:06,386 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 44227
2019-06-13 19:22:06,387 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 19:22:06,387 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 19:22:06,388 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 44227 (custom)
2019-06-13 19:22:06,388 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 19:22:06,388 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 19:22:06,388 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 19:22:06,388 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 19:22:06,389 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler04e21ffe-6f34-40b4-a749-40db3e90ea5b/ratis] (custom)
2019-06-13 19:22:06,389 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 33719
2019-06-13 19:22:06,389 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 19:22:06,389 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 19:22:06,390 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis b443acf1-1f1b-4b1e-bfe0-c1472e8099bd at port 44227
2019-06-13 19:22:06,401 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd: start RPC server
2019-06-13 19:22:06,402 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd: GrpcService started, listening on 0.0.0.0/0.0.0.0:44227
Jun 13, 2019 7:22:06 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:35565} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 13, 2019 7:22:06 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:42031} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-13 19:22:06,416 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd: addNew group-D7BA8D780B9D:[b443acf1-1f1b-4b1e-bfe0-c1472e8099bd:127.0.0.1:44227] returns group-D7BA8D780B9D:java.util.concurrent.CompletableFuture@1a85c88d[Not completed]
2019-06-13 19:22:06,416 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd: new RaftServerImpl for group-D7BA8D780B9D:[b443acf1-1f1b-4b1e-bfe0-c1472e8099bd:127.0.0.1:44227] with ContainerStateMachine:uninitialized
2019-06-13 19:22:06,417 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 19:22:06,417 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 19:22:06,417 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 19:22:06,417 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 19:22:06,417 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd:group-D7BA8D780B9D ConfigurationManager, init=-1: [b443acf1-1f1b-4b1e-bfe0-c1472e8099bd:127.0.0.1:44227], old=null, confs=<EMPTY_MAP>
2019-06-13 19:22:06,417 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler04e21ffe-6f34-40b4-a749-40db3e90ea5b/ratis] (custom)
2019-06-13 19:22:06,418 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler04e21ffe-6f34-40b4-a749-40db3e90ea5b/ratis/c636584a-b75f-4103-816d-d7ba8d780b9d does not exist. Creating ...
2019-06-13 19:22:06,420 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler04e21ffe-6f34-40b4-a749-40db3e90ea5b/ratis/c636584a-b75f-4103-816d-d7ba8d780b9d/in_use.lock acquired by nodename 4187@ozone-d8fz6-366598861
2019-06-13 19:22:06,422 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler04e21ffe-6f34-40b4-a749-40db3e90ea5b/ratis/c636584a-b75f-4103-816d-d7ba8d780b9d has been successfully formatted.
2019-06-13 19:22:06,422 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 19:22:06,422 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 19:22:06,422 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 19:22:06,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 19:22:06,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 19:22:06,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 19:22:06,423 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new b443acf1-1f1b-4b1e-bfe0-c1472e8099bd-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler04e21ffe-6f34-40b4-a749-40db3e90ea5b/ratis/c636584a-b75f-4103-816d-d7ba8d780b9d
2019-06-13 19:22:06,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 19:22:06,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 19:22:06,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 19:22:06,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 19:22:06,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 19:22:06,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 19:22:06,423 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 19:22:06,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 19:22:06,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 19:22:06,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 19:22:06,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 19:22:06,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 19:22:06,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 19:22:06,425 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd: start group-D7BA8D780B9D
2019-06-13 19:22:06,425 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd:group-D7BA8D780B9D changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 19:22:06,425 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd: start FollowerState
2019-06-13 19:22:06,425 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D7BA8D780B9D,id=b443acf1-1f1b-4b1e-bfe0-c1472e8099bd
2019-06-13 19:22:07,467 INFO  impl.FollowerState (FollowerState.java:run(101)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd:group-D7BA8D780B9D changes to CANDIDATE, lastRpcTime:1042, electionTimeout:1042ms
2019-06-13 19:22:07,467 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd: shutdown FollowerState
2019-06-13 19:22:07,468 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd:group-D7BA8D780B9D changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 19:22:07,468 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd: start LeaderElection
2019-06-13 19:22:07,471 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd:group-D7BA8D780B9D:LeaderElection4: begin an election at term 1 for -1: [b443acf1-1f1b-4b1e-bfe0-c1472e8099bd:127.0.0.1:44227], old=null
2019-06-13 19:22:07,471 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd: shutdown LeaderElection
2019-06-13 19:22:07,471 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd:group-D7BA8D780B9D changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 19:22:07,471 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd:group-D7BA8D780B9D change Leader from null to b443acf1-1f1b-4b1e-bfe0-c1472e8099bd at term 1 for becomeLeader, leader elected after 1048ms
2019-06-13 19:22:07,471 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 19:22:07,471 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 19:22:07,471 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 19:22:07,471 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 19:22:07,471 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd: start LeaderState
2019-06-13 19:22:07,471 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd-RaftLogWorker: Starting segment from index:0
2019-06-13 19:22:07,472 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd:group-D7BA8D780B9D set configuration 0: [b443acf1-1f1b-4b1e-bfe0-c1472e8099bd:127.0.0.1:44227], old=null at 0
2019-06-13 19:22:07,507 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler04e21ffe-6f34-40b4-a749-40db3e90ea5b/ratis/c636584a-b75f-4103-816d-d7ba8d780b9d/current/log_inprogress_0
2019-06-13 19:22:08,462 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 5747019985601136085 is closed with bcsId 0.
2019-06-13 19:22:08,463 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 19:22:08,463 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd: close
2019-06-13 19:22:08,463 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd: shutdown group-D7BA8D780B9D
2019-06-13 19:22:08,464 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D7BA8D780B9D,id=b443acf1-1f1b-4b1e-bfe0-c1472e8099bd
2019-06-13 19:22:08,464 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd: shutdown LeaderState
2019-06-13 19:22:08,464 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd-PendingRequests: sendNotLeaderResponses
2019-06-13 19:22:08,465 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-b443acf1-1f1b-4b1e-bfe0-c1472e8099bd-group-D7BA8D780B9D: set stopIndex = 2
2019-06-13 19:22:08,465 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-13 19:22:08,466 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler04e21ffe-6f34-40b4-a749-40db3e90ea5b/ratis/c636584a-b75f-4103-816d-d7ba8d780b9d/sm/snapshot.1_2
2019-06-13 19:22:08,466 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd:group-D7BA8D780B9D closes. The last applied log index is 2
2019-06-13 19:22:08,466 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 19:22:08,467 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd-RaftLogWorker close()
2019-06-13 19:22:08,467 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd: shutdown server with port 44227 now
2019-06-13 19:22:08,468 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - b443acf1-1f1b-4b1e-bfe0-c1472e8099bd: shutdown server with port 44227 successfully
2019-06-13 19:22:08,471 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 19:22:08,491 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9b143e4b-51f1-4371-802b-f6772dc9fe6a/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 19:22:08,491 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9b143e4b-51f1-4371-802b-f6772dc9fe6a/hdds to VolumeSet
2019-06-13 19:22:08,492 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@43f61afb
2019-06-13 19:22:08,492 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@43f61afb
2019-06-13 19:22:08,500 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 36733
2019-06-13 19:22:08,501 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 19:22:08,501 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 19:22:08,501 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 36733 (custom)
2019-06-13 19:22:08,502 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 19:22:08,502 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 19:22:08,502 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 19:22:08,502 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 19:22:08,502 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9b143e4b-51f1-4371-802b-f6772dc9fe6a/ratis] (custom)
2019-06-13 19:22:08,503 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 44075
2019-06-13 19:22:08,503 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 19:22:08,503 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 19:22:08,503 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 551d3393-4671-4671-bbc9-e2d75562ee9c at port 36733
2019-06-13 19:22:08,517 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 551d3393-4671-4671-bbc9-e2d75562ee9c: start RPC server
2019-06-13 19:22:08,518 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 551d3393-4671-4671-bbc9-e2d75562ee9c: GrpcService started, listening on 0.0.0.0/0.0.0.0:36733
2019-06-13 19:22:08,529 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 551d3393-4671-4671-bbc9-e2d75562ee9c: addNew group-DF7D592EC3E9:[551d3393-4671-4671-bbc9-e2d75562ee9c:127.0.0.1:36733] returns group-DF7D592EC3E9:java.util.concurrent.CompletableFuture@4fb8272b[Not completed]
2019-06-13 19:22:08,529 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 551d3393-4671-4671-bbc9-e2d75562ee9c: new RaftServerImpl for group-DF7D592EC3E9:[551d3393-4671-4671-bbc9-e2d75562ee9c:127.0.0.1:36733] with ContainerStateMachine:uninitialized
2019-06-13 19:22:08,530 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 19:22:08,530 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 19:22:08,530 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 19:22:08,530 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 19:22:08,530 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 551d3393-4671-4671-bbc9-e2d75562ee9c:group-DF7D592EC3E9 ConfigurationManager, init=-1: [551d3393-4671-4671-bbc9-e2d75562ee9c:127.0.0.1:36733], old=null, confs=<EMPTY_MAP>
2019-06-13 19:22:08,530 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9b143e4b-51f1-4371-802b-f6772dc9fe6a/ratis] (custom)
2019-06-13 19:22:08,530 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9b143e4b-51f1-4371-802b-f6772dc9fe6a/ratis/fed208d8-de7c-4f59-ba09-df7d592ec3e9 does not exist. Creating ...
2019-06-13 19:22:08,533 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9b143e4b-51f1-4371-802b-f6772dc9fe6a/ratis/fed208d8-de7c-4f59-ba09-df7d592ec3e9/in_use.lock acquired by nodename 4187@ozone-d8fz6-366598861
2019-06-13 19:22:08,535 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9b143e4b-51f1-4371-802b-f6772dc9fe6a/ratis/fed208d8-de7c-4f59-ba09-df7d592ec3e9 has been successfully formatted.
2019-06-13 19:22:08,535 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 19:22:08,535 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 19:22:08,535 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 19:22:08,535 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 19:22:08,535 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 19:22:08,536 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 19:22:08,536 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 551d3393-4671-4671-bbc9-e2d75562ee9c-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9b143e4b-51f1-4371-802b-f6772dc9fe6a/ratis/fed208d8-de7c-4f59-ba09-df7d592ec3e9
2019-06-13 19:22:08,536 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 19:22:08,536 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 19:22:08,536 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 19:22:08,536 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 19:22:08,536 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 19:22:08,536 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 19:22:08,536 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 19:22:08,536 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 19:22:08,537 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 19:22:08,537 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 19:22:08,537 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 19:22:08,537 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 19:22:08,537 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 19:22:08,537 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 551d3393-4671-4671-bbc9-e2d75562ee9c: start group-DF7D592EC3E9
2019-06-13 19:22:08,537 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 551d3393-4671-4671-bbc9-e2d75562ee9c:group-DF7D592EC3E9 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 19:22:08,538 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 551d3393-4671-4671-bbc9-e2d75562ee9c: start FollowerState
2019-06-13 19:22:08,538 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-DF7D592EC3E9,id=551d3393-4671-4671-bbc9-e2d75562ee9c
2019-06-13 19:22:09,696 INFO  impl.FollowerState (FollowerState.java:run(101)) - 551d3393-4671-4671-bbc9-e2d75562ee9c:group-DF7D592EC3E9 changes to CANDIDATE, lastRpcTime:1158, electionTimeout:1158ms
2019-06-13 19:22:09,696 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 551d3393-4671-4671-bbc9-e2d75562ee9c: shutdown FollowerState
2019-06-13 19:22:09,696 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 551d3393-4671-4671-bbc9-e2d75562ee9c:group-DF7D592EC3E9 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 19:22:09,696 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 551d3393-4671-4671-bbc9-e2d75562ee9c: start LeaderElection
2019-06-13 19:22:09,700 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 551d3393-4671-4671-bbc9-e2d75562ee9c:group-DF7D592EC3E9:LeaderElection5: begin an election at term 1 for -1: [551d3393-4671-4671-bbc9-e2d75562ee9c:127.0.0.1:36733], old=null
2019-06-13 19:22:09,700 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 551d3393-4671-4671-bbc9-e2d75562ee9c: shutdown LeaderElection
2019-06-13 19:22:09,700 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 551d3393-4671-4671-bbc9-e2d75562ee9c:group-DF7D592EC3E9 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 19:22:09,700 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 551d3393-4671-4671-bbc9-e2d75562ee9c:group-DF7D592EC3E9 change Leader from null to 551d3393-4671-4671-bbc9-e2d75562ee9c at term 1 for becomeLeader, leader elected after 1164ms
2019-06-13 19:22:09,700 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 19:22:09,700 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 19:22:09,700 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 19:22:09,700 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 19:22:09,701 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 551d3393-4671-4671-bbc9-e2d75562ee9c: start LeaderState
2019-06-13 19:22:09,701 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 551d3393-4671-4671-bbc9-e2d75562ee9c-RaftLogWorker: Starting segment from index:0
2019-06-13 19:22:09,702 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 551d3393-4671-4671-bbc9-e2d75562ee9c:group-DF7D592EC3E9 set configuration 0: [551d3393-4671-4671-bbc9-e2d75562ee9c:127.0.0.1:36733], old=null at 0
2019-06-13 19:22:09,736 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 551d3393-4671-4671-bbc9-e2d75562ee9c-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9b143e4b-51f1-4371-802b-f6772dc9fe6a/ratis/fed208d8-de7c-4f59-ba09-df7d592ec3e9/current/log_inprogress_0
2019-06-13 19:22:10,577 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 3619111429306894601 is closed with bcsId 0.
2019-06-13 19:22:10,577 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 19:22:10,578 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 551d3393-4671-4671-bbc9-e2d75562ee9c: close
2019-06-13 19:22:10,578 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 551d3393-4671-4671-bbc9-e2d75562ee9c: shutdown group-DF7D592EC3E9
2019-06-13 19:22:10,578 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-DF7D592EC3E9,id=551d3393-4671-4671-bbc9-e2d75562ee9c
2019-06-13 19:22:10,578 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 551d3393-4671-4671-bbc9-e2d75562ee9c: shutdown LeaderState
2019-06-13 19:22:10,579 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 551d3393-4671-4671-bbc9-e2d75562ee9c-PendingRequests: sendNotLeaderResponses
2019-06-13 19:22:10,580 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-551d3393-4671-4671-bbc9-e2d75562ee9c-group-DF7D592EC3E9: set stopIndex = 4
2019-06-13 19:22:10,580 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-13 19:22:10,580 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9b143e4b-51f1-4371-802b-f6772dc9fe6a/ratis/fed208d8-de7c-4f59-ba09-df7d592ec3e9/sm/snapshot.1_4
2019-06-13 19:22:10,580 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 551d3393-4671-4671-bbc9-e2d75562ee9c:group-DF7D592EC3E9 closes. The last applied log index is 4
2019-06-13 19:22:10,581 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 551d3393-4671-4671-bbc9-e2d75562ee9c-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 19:22:10,581 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 551d3393-4671-4671-bbc9-e2d75562ee9c-RaftLogWorker close()
2019-06-13 19:22:10,582 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 551d3393-4671-4671-bbc9-e2d75562ee9c: shutdown server with port 36733 now
2019-06-13 19:22:10,583 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 551d3393-4671-4671-bbc9-e2d75562ee9c: shutdown server with port 36733 successfully
2019-06-13 19:22:10,585 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
