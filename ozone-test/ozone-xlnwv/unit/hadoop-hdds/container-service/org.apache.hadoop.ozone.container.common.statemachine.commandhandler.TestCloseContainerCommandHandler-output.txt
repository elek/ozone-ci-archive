2019-06-13 10:31:56,028 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler904451c8-cbf1-4666-af6a-c4b1674da132/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 10:31:56,033 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler904451c8-cbf1-4666-af6a-c4b1674da132/hdds to VolumeSet
2019-06-13 10:31:56,046 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@7eecb5b8
2019-06-13 10:31:56,098 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@7eecb5b8
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-13 10:31:56,572 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43441
2019-06-13 10:31:57,163 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 10:31:57,188 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 10:31:57,199 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43441 (custom)
2019-06-13 10:31:57,200 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 10:31:57,202 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 10:31:57,203 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 10:31:57,204 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 10:31:57,364 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler904451c8-cbf1-4666-af6a-c4b1674da132/ratis] (custom)
2019-06-13 10:31:57,375 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 38847
2019-06-13 10:31:57,398 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 10:31:57,399 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 10:31:57,400 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 223c35aa-6bc5-4725-8fc1-8203699e670b at port 43441
2019-06-13 10:31:57,418 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 223c35aa-6bc5-4725-8fc1-8203699e670b: start RPC server
2019-06-13 10:31:57,578 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 223c35aa-6bc5-4725-8fc1-8203699e670b: GrpcService started, listening on 0.0.0.0/0.0.0.0:43441
2019-06-13 10:31:57,907 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 223c35aa-6bc5-4725-8fc1-8203699e670b: addNew group-33FD969FF3EE:[223c35aa-6bc5-4725-8fc1-8203699e670b:127.0.0.1:43441] returns group-33FD969FF3EE:java.util.concurrent.CompletableFuture@68fdff67[Not completed]
2019-06-13 10:31:57,948 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 223c35aa-6bc5-4725-8fc1-8203699e670b: new RaftServerImpl for group-33FD969FF3EE:[223c35aa-6bc5-4725-8fc1-8203699e670b:127.0.0.1:43441] with ContainerStateMachine:uninitialized
2019-06-13 10:31:57,950 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 10:31:57,950 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 10:31:57,950 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 10:31:57,951 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 10:31:57,958 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 223c35aa-6bc5-4725-8fc1-8203699e670b:group-33FD969FF3EE ConfigurationManager, init=-1: [223c35aa-6bc5-4725-8fc1-8203699e670b:127.0.0.1:43441], old=null, confs=<EMPTY_MAP>
2019-06-13 10:31:57,958 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler904451c8-cbf1-4666-af6a-c4b1674da132/ratis] (custom)
2019-06-13 10:31:57,968 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler904451c8-cbf1-4666-af6a-c4b1674da132/ratis/6fd8bb3d-6481-4546-84e5-33fd969ff3ee does not exist. Creating ...
2019-06-13 10:31:57,980 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler904451c8-cbf1-4666-af6a-c4b1674da132/ratis/6fd8bb3d-6481-4546-84e5-33fd969ff3ee/in_use.lock acquired by nodename 4198@ozone-xlnwv-3323971802
2019-06-13 10:31:57,989 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler904451c8-cbf1-4666-af6a-c4b1674da132/ratis/6fd8bb3d-6481-4546-84e5-33fd969ff3ee has been successfully formatted.
2019-06-13 10:31:57,993 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 10:31:57,994 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 10:31:57,996 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 10:31:57,998 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 10:31:58,003 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 10:31:58,007 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 10:31:58,010 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 223c35aa-6bc5-4725-8fc1-8203699e670b-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler904451c8-cbf1-4666-af6a-c4b1674da132/ratis/6fd8bb3d-6481-4546-84e5-33fd969ff3ee
2019-06-13 10:31:58,012 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 10:31:58,013 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 10:31:58,016 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 10:31:58,016 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 10:31:58,016 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 10:31:58,017 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 10:31:58,018 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 10:31:58,018 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 10:31:58,019 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 10:31:58,022 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 10:31:58,039 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 10:31:58,040 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 10:31:58,040 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 10:31:58,159 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 223c35aa-6bc5-4725-8fc1-8203699e670b: start group-33FD969FF3EE
2019-06-13 10:31:58,160 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 223c35aa-6bc5-4725-8fc1-8203699e670b:group-33FD969FF3EE changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 10:31:58,162 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 223c35aa-6bc5-4725-8fc1-8203699e670b: start FollowerState
2019-06-13 10:31:58,164 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-33FD969FF3EE,id=223c35aa-6bc5-4725-8fc1-8203699e670b
2019-06-13 10:31:59,286 INFO  impl.FollowerState (FollowerState.java:run(101)) - 223c35aa-6bc5-4725-8fc1-8203699e670b:group-33FD969FF3EE changes to CANDIDATE, lastRpcTime:1125, electionTimeout:1122ms
2019-06-13 10:31:59,287 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 223c35aa-6bc5-4725-8fc1-8203699e670b: shutdown FollowerState
2019-06-13 10:31:59,287 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 223c35aa-6bc5-4725-8fc1-8203699e670b:group-33FD969FF3EE changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 10:31:59,289 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 223c35aa-6bc5-4725-8fc1-8203699e670b: start LeaderElection
2019-06-13 10:31:59,294 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 223c35aa-6bc5-4725-8fc1-8203699e670b:group-33FD969FF3EE:LeaderElection1: begin an election at term 1 for -1: [223c35aa-6bc5-4725-8fc1-8203699e670b:127.0.0.1:43441], old=null
2019-06-13 10:31:59,295 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 223c35aa-6bc5-4725-8fc1-8203699e670b: shutdown LeaderElection
2019-06-13 10:31:59,295 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 223c35aa-6bc5-4725-8fc1-8203699e670b:group-33FD969FF3EE changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 10:31:59,296 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 223c35aa-6bc5-4725-8fc1-8203699e670b:group-33FD969FF3EE change Leader from null to 223c35aa-6bc5-4725-8fc1-8203699e670b at term 1 for becomeLeader, leader elected after 1301ms
2019-06-13 10:31:59,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 10:31:59,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 10:31:59,304 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 10:31:59,305 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 10:31:59,314 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 223c35aa-6bc5-4725-8fc1-8203699e670b: start LeaderState
2019-06-13 10:31:59,330 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 223c35aa-6bc5-4725-8fc1-8203699e670b-RaftLogWorker: Starting segment from index:0
2019-06-13 10:31:59,338 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 223c35aa-6bc5-4725-8fc1-8203699e670b:group-33FD969FF3EE set configuration 0: [223c35aa-6bc5-4725-8fc1-8203699e670b:127.0.0.1:43441], old=null at 0
2019-06-13 10:31:59,536 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 223c35aa-6bc5-4725-8fc1-8203699e670b-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler904451c8-cbf1-4666-af6a-c4b1674da132/ratis/6fd8bb3d-6481-4546-84e5-33fd969ff3ee/current/log_inprogress_0
2019-06-13 10:32:00,468 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-13 10:32:00,544 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 6250293391131328928 is closed with bcsId 0.
2019-06-13 10:32:00,545 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 10:32:00,549 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 223c35aa-6bc5-4725-8fc1-8203699e670b: close
2019-06-13 10:32:00,551 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 223c35aa-6bc5-4725-8fc1-8203699e670b: shutdown group-33FD969FF3EE
2019-06-13 10:32:00,551 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-33FD969FF3EE,id=223c35aa-6bc5-4725-8fc1-8203699e670b
2019-06-13 10:32:00,552 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 223c35aa-6bc5-4725-8fc1-8203699e670b: shutdown LeaderState
2019-06-13 10:32:00,552 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 223c35aa-6bc5-4725-8fc1-8203699e670b-PendingRequests: sendNotLeaderResponses
2019-06-13 10:32:00,555 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-223c35aa-6bc5-4725-8fc1-8203699e670b-group-33FD969FF3EE: set stopIndex = 4
2019-06-13 10:32:00,556 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-13 10:32:00,556 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler904451c8-cbf1-4666-af6a-c4b1674da132/ratis/6fd8bb3d-6481-4546-84e5-33fd969ff3ee/sm/snapshot.1_4
2019-06-13 10:32:00,568 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 223c35aa-6bc5-4725-8fc1-8203699e670b:group-33FD969FF3EE closes. The last applied log index is 4
2019-06-13 10:32:00,569 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 223c35aa-6bc5-4725-8fc1-8203699e670b-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 10:32:00,573 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 223c35aa-6bc5-4725-8fc1-8203699e670b-RaftLogWorker close()
2019-06-13 10:32:00,575 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 223c35aa-6bc5-4725-8fc1-8203699e670b: shutdown server with port 43441 now
2019-06-13 10:32:00,580 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 223c35aa-6bc5-4725-8fc1-8203699e670b: shutdown server with port 43441 successfully
2019-06-13 10:32:00,603 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 10:32:00,665 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere7daf995-16ee-43c8-863a-3d08d57c364b/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 10:32:00,666 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere7daf995-16ee-43c8-863a-3d08d57c364b/hdds to VolumeSet
2019-06-13 10:32:00,666 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3a2b2322
2019-06-13 10:32:00,676 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3a2b2322
2019-06-13 10:32:00,703 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 40203
2019-06-13 10:32:00,705 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 10:32:00,706 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 10:32:00,706 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 40203 (custom)
2019-06-13 10:32:00,707 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 10:32:00,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 10:32:00,707 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 10:32:00,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 10:32:00,709 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere7daf995-16ee-43c8-863a-3d08d57c364b/ratis] (custom)
2019-06-13 10:32:00,710 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 33885
2019-06-13 10:32:00,712 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 10:32:00,712 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 10:32:00,712 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c at port 40203
2019-06-13 10:32:00,731 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c: start RPC server
2019-06-13 10:32:00,733 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c: GrpcService started, listening on 0.0.0.0/0.0.0.0:40203
2019-06-13 10:32:00,756 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c: addNew group-7F39E7CF99C5:[9c8751b7-7c15-4ed1-a57d-b6b4f023b07c:127.0.0.1:40203] returns group-7F39E7CF99C5:java.util.concurrent.CompletableFuture@45c1b855[Not completed]
2019-06-13 10:32:00,760 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c: new RaftServerImpl for group-7F39E7CF99C5:[9c8751b7-7c15-4ed1-a57d-b6b4f023b07c:127.0.0.1:40203] with ContainerStateMachine:uninitialized
2019-06-13 10:32:00,761 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 10:32:00,761 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 10:32:00,761 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 10:32:00,761 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 10:32:00,761 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c:group-7F39E7CF99C5 ConfigurationManager, init=-1: [9c8751b7-7c15-4ed1-a57d-b6b4f023b07c:127.0.0.1:40203], old=null, confs=<EMPTY_MAP>
2019-06-13 10:32:00,762 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere7daf995-16ee-43c8-863a-3d08d57c364b/ratis] (custom)
2019-06-13 10:32:00,768 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere7daf995-16ee-43c8-863a-3d08d57c364b/ratis/c0a99032-ce0c-433a-9eba-7f39e7cf99c5 does not exist. Creating ...
2019-06-13 10:32:00,771 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere7daf995-16ee-43c8-863a-3d08d57c364b/ratis/c0a99032-ce0c-433a-9eba-7f39e7cf99c5/in_use.lock acquired by nodename 4198@ozone-xlnwv-3323971802
2019-06-13 10:32:00,773 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere7daf995-16ee-43c8-863a-3d08d57c364b/ratis/c0a99032-ce0c-433a-9eba-7f39e7cf99c5 has been successfully formatted.
2019-06-13 10:32:00,774 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 10:32:00,774 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 10:32:00,774 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 10:32:00,774 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 10:32:00,774 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 10:32:00,775 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 10:32:00,775 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere7daf995-16ee-43c8-863a-3d08d57c364b/ratis/c0a99032-ce0c-433a-9eba-7f39e7cf99c5
2019-06-13 10:32:00,775 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 10:32:00,775 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 10:32:00,775 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 10:32:00,775 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 10:32:00,776 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 10:32:00,776 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 10:32:00,776 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 10:32:00,776 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 10:32:00,776 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 10:32:00,776 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 10:32:00,781 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 10:32:00,782 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 10:32:00,782 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 10:32:00,782 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c: start group-7F39E7CF99C5
2019-06-13 10:32:00,782 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c:group-7F39E7CF99C5 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 10:32:00,782 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c: start FollowerState
2019-06-13 10:32:00,782 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-7F39E7CF99C5,id=9c8751b7-7c15-4ed1-a57d-b6b4f023b07c
2019-06-13 10:32:01,899 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c:group-7F39E7CF99C5 changes to CANDIDATE, lastRpcTime:1117, electionTimeout:1117ms
2019-06-13 10:32:01,900 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c: shutdown FollowerState
2019-06-13 10:32:01,900 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c:group-7F39E7CF99C5 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 10:32:01,900 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c: start LeaderElection
2019-06-13 10:32:01,905 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c:group-7F39E7CF99C5:LeaderElection2: begin an election at term 1 for -1: [9c8751b7-7c15-4ed1-a57d-b6b4f023b07c:127.0.0.1:40203], old=null
2019-06-13 10:32:01,906 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c: shutdown LeaderElection
2019-06-13 10:32:01,906 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c:group-7F39E7CF99C5 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 10:32:01,906 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c:group-7F39E7CF99C5 change Leader from null to 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c at term 1 for becomeLeader, leader elected after 1132ms
2019-06-13 10:32:01,906 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 10:32:01,906 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 10:32:01,907 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 10:32:01,907 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 10:32:01,907 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c: start LeaderState
2019-06-13 10:32:01,907 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c-RaftLogWorker: Starting segment from index:0
2019-06-13 10:32:01,908 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c:group-7F39E7CF99C5 set configuration 0: [9c8751b7-7c15-4ed1-a57d-b6b4f023b07c:127.0.0.1:40203], old=null at 0
2019-06-13 10:32:01,948 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere7daf995-16ee-43c8-863a-3d08d57c364b/ratis/c0a99032-ce0c-433a-9eba-7f39e7cf99c5/current/log_inprogress_0
2019-06-13 10:32:02,822 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 10:32:02,824 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c: close
2019-06-13 10:32:02,824 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c: shutdown group-7F39E7CF99C5
2019-06-13 10:32:02,824 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-7F39E7CF99C5,id=9c8751b7-7c15-4ed1-a57d-b6b4f023b07c
2019-06-13 10:32:02,825 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c: shutdown LeaderState
2019-06-13 10:32:02,825 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c-PendingRequests: sendNotLeaderResponses
2019-06-13 10:32:02,826 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-9c8751b7-7c15-4ed1-a57d-b6b4f023b07c-group-7F39E7CF99C5: set stopIndex = 2
2019-06-13 10:32:02,826 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-13 10:32:02,826 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere7daf995-16ee-43c8-863a-3d08d57c364b/ratis/c0a99032-ce0c-433a-9eba-7f39e7cf99c5/sm/snapshot.1_2
2019-06-13 10:32:02,827 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c:group-7F39E7CF99C5 closes. The last applied log index is 2
2019-06-13 10:32:02,827 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 10:32:02,828 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c-RaftLogWorker close()
2019-06-13 10:32:02,829 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c: shutdown server with port 40203 now
2019-06-13 10:32:02,831 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 9c8751b7-7c15-4ed1-a57d-b6b4f023b07c: shutdown server with port 40203 successfully
2019-06-13 10:32:02,840 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 10:32:02,892 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2cb81295-7324-4b8d-bf71-49baccee2da5/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 10:32:02,893 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2cb81295-7324-4b8d-bf71-49baccee2da5/hdds to VolumeSet
2019-06-13 10:32:02,893 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@38eb2c50
2019-06-13 10:32:02,897 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@38eb2c50
2019-06-13 10:32:02,913 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 41743
2019-06-13 10:32:02,914 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 10:32:02,915 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 10:32:02,916 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 41743 (custom)
2019-06-13 10:32:02,916 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 10:32:02,916 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 10:32:02,916 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 10:32:02,916 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 10:32:02,917 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2cb81295-7324-4b8d-bf71-49baccee2da5/ratis] (custom)
2019-06-13 10:32:02,918 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42445
2019-06-13 10:32:02,918 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 10:32:02,918 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 10:32:02,918 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32 at port 41743
2019-06-13 10:32:02,927 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32: start RPC server
2019-06-13 10:32:02,928 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32: GrpcService started, listening on 0.0.0.0/0.0.0.0:41743
2019-06-13 10:32:02,942 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32: addNew group-8905F4397AB4:[00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32:127.0.0.1:41743] returns group-8905F4397AB4:java.util.concurrent.CompletableFuture@6c6c6d2[Not completed]
2019-06-13 10:32:02,945 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32: new RaftServerImpl for group-8905F4397AB4:[00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32:127.0.0.1:41743] with ContainerStateMachine:uninitialized
2019-06-13 10:32:02,945 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 10:32:02,945 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 10:32:02,946 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 10:32:02,946 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 10:32:02,946 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32:group-8905F4397AB4 ConfigurationManager, init=-1: [00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32:127.0.0.1:41743], old=null, confs=<EMPTY_MAP>
2019-06-13 10:32:02,946 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2cb81295-7324-4b8d-bf71-49baccee2da5/ratis] (custom)
2019-06-13 10:32:02,946 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2cb81295-7324-4b8d-bf71-49baccee2da5/ratis/6c30cff3-2d6e-4b74-947d-8905f4397ab4 does not exist. Creating ...
2019-06-13 10:32:02,949 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2cb81295-7324-4b8d-bf71-49baccee2da5/ratis/6c30cff3-2d6e-4b74-947d-8905f4397ab4/in_use.lock acquired by nodename 4198@ozone-xlnwv-3323971802
2019-06-13 10:32:02,952 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2cb81295-7324-4b8d-bf71-49baccee2da5/ratis/6c30cff3-2d6e-4b74-947d-8905f4397ab4 has been successfully formatted.
2019-06-13 10:32:02,952 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 10:32:02,952 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 10:32:02,952 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 10:32:02,952 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 10:32:02,953 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 10:32:02,953 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 10:32:02,953 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2cb81295-7324-4b8d-bf71-49baccee2da5/ratis/6c30cff3-2d6e-4b74-947d-8905f4397ab4
2019-06-13 10:32:02,953 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 10:32:02,953 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 10:32:02,953 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 10:32:02,953 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 10:32:02,953 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 10:32:02,953 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 10:32:02,954 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 10:32:02,954 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 10:32:02,954 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 10:32:02,954 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 10:32:02,955 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 10:32:02,955 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 10:32:02,955 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 10:32:02,956 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32: start group-8905F4397AB4
2019-06-13 10:32:02,956 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32:group-8905F4397AB4 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 10:32:02,956 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32: start FollowerState
2019-06-13 10:32:02,958 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-8905F4397AB4,id=00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32
2019-06-13 10:32:04,153 INFO  impl.FollowerState (FollowerState.java:run(101)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32:group-8905F4397AB4 changes to CANDIDATE, lastRpcTime:1196, electionTimeout:1195ms
2019-06-13 10:32:04,153 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32: shutdown FollowerState
2019-06-13 10:32:04,153 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32:group-8905F4397AB4 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 10:32:04,153 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32: start LeaderElection
2019-06-13 10:32:04,158 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32:group-8905F4397AB4:LeaderElection3: begin an election at term 1 for -1: [00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32:127.0.0.1:41743], old=null
2019-06-13 10:32:04,158 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32: shutdown LeaderElection
2019-06-13 10:32:04,158 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32:group-8905F4397AB4 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 10:32:04,158 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32:group-8905F4397AB4 change Leader from null to 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32 at term 1 for becomeLeader, leader elected after 1206ms
2019-06-13 10:32:04,159 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 10:32:04,159 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 10:32:04,159 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 10:32:04,159 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 10:32:04,159 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32: start LeaderState
2019-06-13 10:32:04,159 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32-RaftLogWorker: Starting segment from index:0
2019-06-13 10:32:04,168 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32:group-8905F4397AB4 set configuration 0: [00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32:127.0.0.1:41743], old=null at 0
2019-06-13 10:32:04,620 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2cb81295-7324-4b8d-bf71-49baccee2da5/ratis/6c30cff3-2d6e-4b74-947d-8905f4397ab4/current/log_inprogress_0
2019-06-13 10:32:05,029 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 8314209991804791827 is closed with bcsId 0.
2019-06-13 10:32:05,030 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 10:32:05,031 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32: close
2019-06-13 10:32:05,031 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32: shutdown group-8905F4397AB4
2019-06-13 10:32:05,032 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-8905F4397AB4,id=00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32
2019-06-13 10:32:05,032 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32: shutdown LeaderState
2019-06-13 10:32:05,032 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32-PendingRequests: sendNotLeaderResponses
2019-06-13 10:32:05,033 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-13 10:32:05,034 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2cb81295-7324-4b8d-bf71-49baccee2da5/ratis/6c30cff3-2d6e-4b74-947d-8905f4397ab4/sm/snapshot.1_2
2019-06-13 10:32:05,034 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32-group-8905F4397AB4: set stopIndex = 2
2019-06-13 10:32:05,035 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32:group-8905F4397AB4 closes. The last applied log index is 2
2019-06-13 10:32:05,035 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 10:32:05,036 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32-RaftLogWorker close()
2019-06-13 10:32:05,041 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32: shutdown server with port 41743 now
2019-06-13 10:32:05,047 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 00b86b6f-9ef4-4acb-b9b7-bfe5f7edde32: shutdown server with port 41743 successfully
2019-06-13 10:32:05,050 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 10:32:05,103 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5bbe1909-61f6-41d4-be33-6bb3b4086fbd/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 10:32:05,104 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5bbe1909-61f6-41d4-be33-6bb3b4086fbd/hdds to VolumeSet
2019-06-13 10:32:05,104 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@455824ad
2019-06-13 10:32:05,111 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@455824ad
2019-06-13 10:32:05,125 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43341
2019-06-13 10:32:05,126 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 10:32:05,127 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 10:32:05,133 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43341 (custom)
2019-06-13 10:32:05,133 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 10:32:05,134 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 10:32:05,134 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 10:32:05,134 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 10:32:05,135 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5bbe1909-61f6-41d4-be33-6bb3b4086fbd/ratis] (custom)
2019-06-13 10:32:05,136 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 34361
2019-06-13 10:32:05,136 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 10:32:05,136 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 10:32:05,136 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 28bb9e13-0331-4b9a-8043-e450275f42da at port 43341
2019-06-13 10:32:05,144 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 28bb9e13-0331-4b9a-8043-e450275f42da: start RPC server
2019-06-13 10:32:05,147 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 28bb9e13-0331-4b9a-8043-e450275f42da: GrpcService started, listening on 0.0.0.0/0.0.0.0:43341
Jun 13, 2019 10:32:05 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:41743} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 13, 2019 10:32:05 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:40203} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-13 10:32:05,176 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 28bb9e13-0331-4b9a-8043-e450275f42da: addNew group-DA2B3A2C20FA:[28bb9e13-0331-4b9a-8043-e450275f42da:127.0.0.1:43341] returns group-DA2B3A2C20FA:java.util.concurrent.CompletableFuture@8db31e1[Not completed]
2019-06-13 10:32:05,177 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 28bb9e13-0331-4b9a-8043-e450275f42da: new RaftServerImpl for group-DA2B3A2C20FA:[28bb9e13-0331-4b9a-8043-e450275f42da:127.0.0.1:43341] with ContainerStateMachine:uninitialized
2019-06-13 10:32:05,177 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 10:32:05,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 10:32:05,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 10:32:05,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 10:32:05,178 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 28bb9e13-0331-4b9a-8043-e450275f42da:group-DA2B3A2C20FA ConfigurationManager, init=-1: [28bb9e13-0331-4b9a-8043-e450275f42da:127.0.0.1:43341], old=null, confs=<EMPTY_MAP>
2019-06-13 10:32:05,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5bbe1909-61f6-41d4-be33-6bb3b4086fbd/ratis] (custom)
2019-06-13 10:32:05,179 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5bbe1909-61f6-41d4-be33-6bb3b4086fbd/ratis/064353ad-1007-44be-bf8b-da2b3a2c20fa does not exist. Creating ...
2019-06-13 10:32:05,182 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5bbe1909-61f6-41d4-be33-6bb3b4086fbd/ratis/064353ad-1007-44be-bf8b-da2b3a2c20fa/in_use.lock acquired by nodename 4198@ozone-xlnwv-3323971802
2019-06-13 10:32:05,184 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5bbe1909-61f6-41d4-be33-6bb3b4086fbd/ratis/064353ad-1007-44be-bf8b-da2b3a2c20fa has been successfully formatted.
2019-06-13 10:32:05,187 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 10:32:05,188 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 10:32:05,188 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 10:32:05,188 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 10:32:05,188 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 10:32:05,188 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 10:32:05,188 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 28bb9e13-0331-4b9a-8043-e450275f42da-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5bbe1909-61f6-41d4-be33-6bb3b4086fbd/ratis/064353ad-1007-44be-bf8b-da2b3a2c20fa
2019-06-13 10:32:05,188 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 10:32:05,188 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 10:32:05,189 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 10:32:05,189 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 10:32:05,189 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 10:32:05,189 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 10:32:05,189 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 10:32:05,189 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 10:32:05,190 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 10:32:05,190 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 10:32:05,190 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 10:32:05,190 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 10:32:05,190 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 10:32:05,190 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 28bb9e13-0331-4b9a-8043-e450275f42da: start group-DA2B3A2C20FA
2019-06-13 10:32:05,191 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 28bb9e13-0331-4b9a-8043-e450275f42da:group-DA2B3A2C20FA changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 10:32:05,191 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 28bb9e13-0331-4b9a-8043-e450275f42da: start FollowerState
2019-06-13 10:32:05,192 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-DA2B3A2C20FA,id=28bb9e13-0331-4b9a-8043-e450275f42da
2019-06-13 10:32:06,208 INFO  impl.FollowerState (FollowerState.java:run(101)) - 28bb9e13-0331-4b9a-8043-e450275f42da:group-DA2B3A2C20FA changes to CANDIDATE, lastRpcTime:1016, electionTimeout:1015ms
2019-06-13 10:32:06,208 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 28bb9e13-0331-4b9a-8043-e450275f42da: shutdown FollowerState
2019-06-13 10:32:06,208 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 28bb9e13-0331-4b9a-8043-e450275f42da:group-DA2B3A2C20FA changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 10:32:06,208 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 28bb9e13-0331-4b9a-8043-e450275f42da: start LeaderElection
2019-06-13 10:32:06,221 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 28bb9e13-0331-4b9a-8043-e450275f42da:group-DA2B3A2C20FA:LeaderElection4: begin an election at term 1 for -1: [28bb9e13-0331-4b9a-8043-e450275f42da:127.0.0.1:43341], old=null
2019-06-13 10:32:06,221 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 28bb9e13-0331-4b9a-8043-e450275f42da: shutdown LeaderElection
2019-06-13 10:32:06,221 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 28bb9e13-0331-4b9a-8043-e450275f42da:group-DA2B3A2C20FA changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 10:32:06,221 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 28bb9e13-0331-4b9a-8043-e450275f42da:group-DA2B3A2C20FA change Leader from null to 28bb9e13-0331-4b9a-8043-e450275f42da at term 1 for becomeLeader, leader elected after 1033ms
2019-06-13 10:32:06,221 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 10:32:06,222 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 10:32:06,222 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 10:32:06,222 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 10:32:06,222 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 28bb9e13-0331-4b9a-8043-e450275f42da: start LeaderState
2019-06-13 10:32:06,223 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 28bb9e13-0331-4b9a-8043-e450275f42da-RaftLogWorker: Starting segment from index:0
2019-06-13 10:32:06,233 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 28bb9e13-0331-4b9a-8043-e450275f42da:group-DA2B3A2C20FA set configuration 0: [28bb9e13-0331-4b9a-8043-e450275f42da:127.0.0.1:43341], old=null at 0
2019-06-13 10:32:06,263 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 28bb9e13-0331-4b9a-8043-e450275f42da-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5bbe1909-61f6-41d4-be33-6bb3b4086fbd/ratis/064353ad-1007-44be-bf8b-da2b3a2c20fa/current/log_inprogress_0
2019-06-13 10:32:07,261 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 2099555135631334143 is closed with bcsId 0.
2019-06-13 10:32:07,262 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 10:32:07,263 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 28bb9e13-0331-4b9a-8043-e450275f42da: close
2019-06-13 10:32:07,263 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 28bb9e13-0331-4b9a-8043-e450275f42da: shutdown group-DA2B3A2C20FA
2019-06-13 10:32:07,263 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-DA2B3A2C20FA,id=28bb9e13-0331-4b9a-8043-e450275f42da
2019-06-13 10:32:07,263 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 28bb9e13-0331-4b9a-8043-e450275f42da: shutdown LeaderState
2019-06-13 10:32:07,264 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 28bb9e13-0331-4b9a-8043-e450275f42da-PendingRequests: sendNotLeaderResponses
2019-06-13 10:32:07,265 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-28bb9e13-0331-4b9a-8043-e450275f42da-group-DA2B3A2C20FA: set stopIndex = 2
2019-06-13 10:32:07,265 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-13 10:32:07,265 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5bbe1909-61f6-41d4-be33-6bb3b4086fbd/ratis/064353ad-1007-44be-bf8b-da2b3a2c20fa/sm/snapshot.1_2
2019-06-13 10:32:07,266 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 28bb9e13-0331-4b9a-8043-e450275f42da:group-DA2B3A2C20FA closes. The last applied log index is 2
2019-06-13 10:32:07,269 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 28bb9e13-0331-4b9a-8043-e450275f42da-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 10:32:07,270 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 28bb9e13-0331-4b9a-8043-e450275f42da-RaftLogWorker close()
2019-06-13 10:32:07,270 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 28bb9e13-0331-4b9a-8043-e450275f42da: shutdown server with port 43341 now
2019-06-13 10:32:07,272 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 28bb9e13-0331-4b9a-8043-e450275f42da: shutdown server with port 43341 successfully
2019-06-13 10:32:07,278 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-13 10:32:07,302 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3c95ed5f-c74c-4e97-a7fa-1ba916c211e7/hdds of  storage type : DISK and capacity : 104021790720
2019-06-13 10:32:07,302 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3c95ed5f-c74c-4e97-a7fa-1ba916c211e7/hdds to VolumeSet
2019-06-13 10:32:07,302 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1ac45389
2019-06-13 10:32:07,303 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1ac45389
2019-06-13 10:32:07,327 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 41787
2019-06-13 10:32:07,328 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-13 10:32:07,328 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-13 10:32:07,329 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 41787 (custom)
2019-06-13 10:32:07,329 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-13 10:32:07,329 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 10:32:07,329 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-13 10:32:07,330 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-13 10:32:07,330 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3c95ed5f-c74c-4e97-a7fa-1ba916c211e7/ratis] (custom)
2019-06-13 10:32:07,331 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 37959
2019-06-13 10:32:07,331 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-13 10:32:07,331 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-13 10:32:07,331 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis f1138a7e-c053-4bc4-9f22-123036cce101 at port 41787
2019-06-13 10:32:07,362 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - f1138a7e-c053-4bc4-9f22-123036cce101: start RPC server
2019-06-13 10:32:07,363 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - f1138a7e-c053-4bc4-9f22-123036cce101: GrpcService started, listening on 0.0.0.0/0.0.0.0:41787
2019-06-13 10:32:07,374 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - f1138a7e-c053-4bc4-9f22-123036cce101: addNew group-30F6C4AEAE79:[f1138a7e-c053-4bc4-9f22-123036cce101:127.0.0.1:41787] returns group-30F6C4AEAE79:java.util.concurrent.CompletableFuture@e9ea926[Not completed]
2019-06-13 10:32:07,374 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - f1138a7e-c053-4bc4-9f22-123036cce101: new RaftServerImpl for group-30F6C4AEAE79:[f1138a7e-c053-4bc4-9f22-123036cce101:127.0.0.1:41787] with ContainerStateMachine:uninitialized
2019-06-13 10:32:07,375 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-13 10:32:07,375 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-13 10:32:07,376 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-13 10:32:07,376 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-13 10:32:07,376 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - f1138a7e-c053-4bc4-9f22-123036cce101:group-30F6C4AEAE79 ConfigurationManager, init=-1: [f1138a7e-c053-4bc4-9f22-123036cce101:127.0.0.1:41787], old=null, confs=<EMPTY_MAP>
2019-06-13 10:32:07,376 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3c95ed5f-c74c-4e97-a7fa-1ba916c211e7/ratis] (custom)
2019-06-13 10:32:07,376 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3c95ed5f-c74c-4e97-a7fa-1ba916c211e7/ratis/b238d3ef-8fd7-4426-b035-30f6c4aeae79 does not exist. Creating ...
2019-06-13 10:32:07,380 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3c95ed5f-c74c-4e97-a7fa-1ba916c211e7/ratis/b238d3ef-8fd7-4426-b035-30f6c4aeae79/in_use.lock acquired by nodename 4198@ozone-xlnwv-3323971802
2019-06-13 10:32:07,382 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3c95ed5f-c74c-4e97-a7fa-1ba916c211e7/ratis/b238d3ef-8fd7-4426-b035-30f6c4aeae79 has been successfully formatted.
2019-06-13 10:32:07,383 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-13 10:32:07,383 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-13 10:32:07,383 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-13 10:32:07,383 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-13 10:32:07,383 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 10:32:07,383 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-13 10:32:07,383 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new f1138a7e-c053-4bc4-9f22-123036cce101-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3c95ed5f-c74c-4e97-a7fa-1ba916c211e7/ratis/b238d3ef-8fd7-4426-b035-30f6c4aeae79
2019-06-13 10:32:07,383 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-13 10:32:07,384 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-13 10:32:07,384 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-13 10:32:07,384 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-13 10:32:07,384 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-13 10:32:07,384 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-13 10:32:07,384 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-13 10:32:07,384 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-13 10:32:07,384 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-13 10:32:07,384 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-13 10:32:07,385 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-13 10:32:07,385 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-13 10:32:07,386 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-13 10:32:07,386 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - f1138a7e-c053-4bc4-9f22-123036cce101: start group-30F6C4AEAE79
2019-06-13 10:32:07,386 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f1138a7e-c053-4bc4-9f22-123036cce101:group-30F6C4AEAE79 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-13 10:32:07,386 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f1138a7e-c053-4bc4-9f22-123036cce101: start FollowerState
2019-06-13 10:32:07,386 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-30F6C4AEAE79,id=f1138a7e-c053-4bc4-9f22-123036cce101
2019-06-13 10:32:08,559 INFO  impl.FollowerState (FollowerState.java:run(101)) - f1138a7e-c053-4bc4-9f22-123036cce101:group-30F6C4AEAE79 changes to CANDIDATE, lastRpcTime:1172, electionTimeout:1172ms
2019-06-13 10:32:08,559 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - f1138a7e-c053-4bc4-9f22-123036cce101: shutdown FollowerState
2019-06-13 10:32:08,559 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f1138a7e-c053-4bc4-9f22-123036cce101:group-30F6C4AEAE79 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-13 10:32:08,559 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f1138a7e-c053-4bc4-9f22-123036cce101: start LeaderElection
2019-06-13 10:32:08,571 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - f1138a7e-c053-4bc4-9f22-123036cce101:group-30F6C4AEAE79:LeaderElection5: begin an election at term 1 for -1: [f1138a7e-c053-4bc4-9f22-123036cce101:127.0.0.1:41787], old=null
2019-06-13 10:32:08,571 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - f1138a7e-c053-4bc4-9f22-123036cce101: shutdown LeaderElection
2019-06-13 10:32:08,571 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f1138a7e-c053-4bc4-9f22-123036cce101:group-30F6C4AEAE79 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-13 10:32:08,571 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - f1138a7e-c053-4bc4-9f22-123036cce101:group-30F6C4AEAE79 change Leader from null to f1138a7e-c053-4bc4-9f22-123036cce101 at term 1 for becomeLeader, leader elected after 1188ms
2019-06-13 10:32:08,571 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-13 10:32:08,571 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-13 10:32:08,571 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-13 10:32:08,572 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-13 10:32:08,572 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f1138a7e-c053-4bc4-9f22-123036cce101: start LeaderState
2019-06-13 10:32:08,572 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - f1138a7e-c053-4bc4-9f22-123036cce101-RaftLogWorker: Starting segment from index:0
2019-06-13 10:32:08,573 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - f1138a7e-c053-4bc4-9f22-123036cce101:group-30F6C4AEAE79 set configuration 0: [f1138a7e-c053-4bc4-9f22-123036cce101:127.0.0.1:41787], old=null at 0
2019-06-13 10:32:08,612 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - f1138a7e-c053-4bc4-9f22-123036cce101-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3c95ed5f-c74c-4e97-a7fa-1ba916c211e7/ratis/b238d3ef-8fd7-4426-b035-30f6c4aeae79/current/log_inprogress_0
2019-06-13 10:32:09,437 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 648330053531668969 is closed with bcsId 0.
2019-06-13 10:32:09,438 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-13 10:32:09,438 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - f1138a7e-c053-4bc4-9f22-123036cce101: close
2019-06-13 10:32:09,438 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - f1138a7e-c053-4bc4-9f22-123036cce101: shutdown group-30F6C4AEAE79
2019-06-13 10:32:09,438 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-30F6C4AEAE79,id=f1138a7e-c053-4bc4-9f22-123036cce101
2019-06-13 10:32:09,439 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - f1138a7e-c053-4bc4-9f22-123036cce101: shutdown LeaderState
2019-06-13 10:32:09,439 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - f1138a7e-c053-4bc4-9f22-123036cce101-PendingRequests: sendNotLeaderResponses
2019-06-13 10:32:09,441 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-f1138a7e-c053-4bc4-9f22-123036cce101-group-30F6C4AEAE79: set stopIndex = 4
2019-06-13 10:32:09,441 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-13 10:32:09,442 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3c95ed5f-c74c-4e97-a7fa-1ba916c211e7/ratis/b238d3ef-8fd7-4426-b035-30f6c4aeae79/sm/snapshot.1_4
2019-06-13 10:32:09,442 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - f1138a7e-c053-4bc4-9f22-123036cce101:group-30F6C4AEAE79 closes. The last applied log index is 4
2019-06-13 10:32:09,442 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - f1138a7e-c053-4bc4-9f22-123036cce101-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-13 10:32:09,443 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - f1138a7e-c053-4bc4-9f22-123036cce101-RaftLogWorker close()
2019-06-13 10:32:09,444 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - f1138a7e-c053-4bc4-9f22-123036cce101: shutdown server with port 41787 now
2019-06-13 10:32:09,446 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - f1138a7e-c053-4bc4-9f22-123036cce101: shutdown server with port 41787 successfully
2019-06-13 10:32:09,449 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
