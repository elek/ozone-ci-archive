2019-06-16 19:46:01,097 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera4f747f0-35ed-48df-bed9-5c437c60e379/hdds of  storage type : DISK and capacity : 104021790720
2019-06-16 19:46:01,100 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera4f747f0-35ed-48df-bed9-5c437c60e379/hdds to VolumeSet
2019-06-16 19:46:01,126 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-16 19:46:01,155 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-16 19:46:01,546 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 45447
2019-06-16 19:46:02,017 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-16 19:46:02,039 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-16 19:46:02,047 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 45447 (custom)
2019-06-16 19:46:02,047 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-16 19:46:02,050 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-16 19:46:02,051 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-16 19:46:02,051 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-16 19:46:02,195 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera4f747f0-35ed-48df-bed9-5c437c60e379/ratis] (custom)
2019-06-16 19:46:02,208 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42363
2019-06-16 19:46:02,235 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-16 19:46:02,235 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-16 19:46:02,236 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588 at port 45447
2019-06-16 19:46:02,252 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588: start RPC server
2019-06-16 19:46:02,410 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588: GrpcService started, listening on 0.0.0.0/0.0.0.0:45447
2019-06-16 19:46:02,739 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588: addNew group-C4FC76C5BA13:[fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588:127.0.0.1:45447] returns group-C4FC76C5BA13:java.util.concurrent.CompletableFuture@5d6cd7f3[Not completed]
2019-06-16 19:46:02,771 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588: new RaftServerImpl for group-C4FC76C5BA13:[fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588:127.0.0.1:45447] with ContainerStateMachine:uninitialized
2019-06-16 19:46:02,772 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-16 19:46:02,773 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-16 19:46:02,773 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-16 19:46:02,774 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-16 19:46:02,779 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588:group-C4FC76C5BA13 ConfigurationManager, init=-1: [fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588:127.0.0.1:45447], old=null, confs=<EMPTY_MAP>
2019-06-16 19:46:02,780 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera4f747f0-35ed-48df-bed9-5c437c60e379/ratis] (custom)
2019-06-16 19:46:02,787 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera4f747f0-35ed-48df-bed9-5c437c60e379/ratis/76f5ea4b-5197-420f-80ca-c4fc76c5ba13 does not exist. Creating ...
2019-06-16 19:46:02,795 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera4f747f0-35ed-48df-bed9-5c437c60e379/ratis/76f5ea4b-5197-420f-80ca-c4fc76c5ba13/in_use.lock acquired by nodename 4314@ozone-unit-076618677d3xg9g4-2216415656
2019-06-16 19:46:02,804 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera4f747f0-35ed-48df-bed9-5c437c60e379/ratis/76f5ea4b-5197-420f-80ca-c4fc76c5ba13 has been successfully formatted.
2019-06-16 19:46:02,806 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-16 19:46:02,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-16 19:46:02,808 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-16 19:46:02,810 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-16 19:46:02,814 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-16 19:46:02,818 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-16 19:46:02,820 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera4f747f0-35ed-48df-bed9-5c437c60e379/ratis/76f5ea4b-5197-420f-80ca-c4fc76c5ba13
2019-06-16 19:46:02,821 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-16 19:46:02,821 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-16 19:46:02,823 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-16 19:46:02,824 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-16 19:46:02,824 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-16 19:46:02,825 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-16 19:46:02,826 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-16 19:46:02,826 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-16 19:46:02,827 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-16 19:46:02,829 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-16 19:46:02,834 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-16 19:46:02,835 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-16 19:46:02,836 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-16 19:46:03,033 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588: start group-C4FC76C5BA13
2019-06-16 19:46:03,034 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588:group-C4FC76C5BA13 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-16 19:46:03,035 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588: start FollowerState
2019-06-16 19:46:03,039 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C4FC76C5BA13,id=fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588
2019-06-16 19:46:04,038 INFO  impl.FollowerState (FollowerState.java:run(101)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588:group-C4FC76C5BA13 changes to CANDIDATE, lastRpcTime:1003, electionTimeout:1000ms
2019-06-16 19:46:04,039 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588: shutdown FollowerState
2019-06-16 19:46:04,039 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588:group-C4FC76C5BA13 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-16 19:46:04,041 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588: start LeaderElection
2019-06-16 19:46:04,044 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588:group-C4FC76C5BA13:LeaderElection1: begin an election at term 1 for -1: [fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588:127.0.0.1:45447], old=null
2019-06-16 19:46:04,045 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588: shutdown LeaderElection
2019-06-16 19:46:04,046 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588:group-C4FC76C5BA13 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-16 19:46:04,046 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588:group-C4FC76C5BA13 change Leader from null to fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588 at term 1 for becomeLeader, leader elected after 1239ms
2019-06-16 19:46:04,050 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-16 19:46:04,050 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-16 19:46:04,053 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-16 19:46:04,053 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-16 19:46:04,062 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588: start LeaderState
2019-06-16 19:46:04,076 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588-RaftLogWorker: Starting segment from index:0
2019-06-16 19:46:04,086 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588:group-C4FC76C5BA13 set configuration 0: [fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588:127.0.0.1:45447], old=null at 0
2019-06-16 19:46:04,229 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera4f747f0-35ed-48df-bed9-5c437c60e379/ratis/76f5ea4b-5197-420f-80ca-c4fc76c5ba13/current/log_inprogress_0
2019-06-16 19:46:05,289 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-16 19:46:05,352 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 9158492672036813707 is closed with bcsId 0.
2019-06-16 19:46:05,353 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-16 19:46:05,354 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588: close
2019-06-16 19:46:05,355 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588: shutdown group-C4FC76C5BA13
2019-06-16 19:46:05,356 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C4FC76C5BA13,id=fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588
2019-06-16 19:46:05,356 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588: shutdown LeaderState
2019-06-16 19:46:05,357 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588-PendingRequests: sendNotLeaderResponses
2019-06-16 19:46:05,360 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588-group-C4FC76C5BA13: set stopIndex = 4
2019-06-16 19:46:05,360 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-16 19:46:05,360 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera4f747f0-35ed-48df-bed9-5c437c60e379/ratis/76f5ea4b-5197-420f-80ca-c4fc76c5ba13/sm/snapshot.1_4
2019-06-16 19:46:05,372 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588:group-C4FC76C5BA13 closes. The last applied log index is 4
2019-06-16 19:46:05,373 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-16 19:46:05,377 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588-RaftLogWorker close()
2019-06-16 19:46:05,379 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588: shutdown server with port 45447 now
2019-06-16 19:46:05,385 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - fc3e8c30-df0e-4a7f-8a03-1ccd4ce8a588: shutdown server with port 45447 successfully
2019-06-16 19:46:05,393 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-16 19:46:05,422 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler07e6d4dc-af3f-4d25-8381-0c515abab876/hdds of  storage type : DISK and capacity : 104021790720
2019-06-16 19:46:05,423 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler07e6d4dc-af3f-4d25-8381-0c515abab876/hdds to VolumeSet
2019-06-16 19:46:05,423 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3a2b2322
2019-06-16 19:46:05,426 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3a2b2322
2019-06-16 19:46:05,437 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 40323
2019-06-16 19:46:05,438 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-16 19:46:05,439 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-16 19:46:05,439 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 40323 (custom)
2019-06-16 19:46:05,439 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-16 19:46:05,440 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-16 19:46:05,440 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-16 19:46:05,440 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-16 19:46:05,441 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler07e6d4dc-af3f-4d25-8381-0c515abab876/ratis] (custom)
2019-06-16 19:46:05,441 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 45087
2019-06-16 19:46:05,442 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-16 19:46:05,442 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-16 19:46:05,442 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 8c3a5f10-5f16-495f-ae85-3f224dda97cd at port 40323
2019-06-16 19:46:05,448 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd: start RPC server
2019-06-16 19:46:05,450 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd: GrpcService started, listening on 0.0.0.0/0.0.0.0:40323
2019-06-16 19:46:05,461 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd: addNew group-1BA5054484A3:[8c3a5f10-5f16-495f-ae85-3f224dda97cd:127.0.0.1:40323] returns group-1BA5054484A3:java.util.concurrent.CompletableFuture@72172251[Not completed]
2019-06-16 19:46:05,466 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd: new RaftServerImpl for group-1BA5054484A3:[8c3a5f10-5f16-495f-ae85-3f224dda97cd:127.0.0.1:40323] with ContainerStateMachine:uninitialized
2019-06-16 19:46:05,467 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-16 19:46:05,467 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-16 19:46:05,467 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-16 19:46:05,467 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-16 19:46:05,467 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd:group-1BA5054484A3 ConfigurationManager, init=-1: [8c3a5f10-5f16-495f-ae85-3f224dda97cd:127.0.0.1:40323], old=null, confs=<EMPTY_MAP>
2019-06-16 19:46:05,467 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler07e6d4dc-af3f-4d25-8381-0c515abab876/ratis] (custom)
2019-06-16 19:46:05,468 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler07e6d4dc-af3f-4d25-8381-0c515abab876/ratis/652d9754-e692-4af4-a831-1ba5054484a3 does not exist. Creating ...
2019-06-16 19:46:05,470 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler07e6d4dc-af3f-4d25-8381-0c515abab876/ratis/652d9754-e692-4af4-a831-1ba5054484a3/in_use.lock acquired by nodename 4314@ozone-unit-076618677d3xg9g4-2216415656
2019-06-16 19:46:05,473 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler07e6d4dc-af3f-4d25-8381-0c515abab876/ratis/652d9754-e692-4af4-a831-1ba5054484a3 has been successfully formatted.
2019-06-16 19:46:05,473 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-16 19:46:05,474 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-16 19:46:05,474 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-16 19:46:05,474 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-16 19:46:05,474 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-16 19:46:05,474 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-16 19:46:05,474 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 8c3a5f10-5f16-495f-ae85-3f224dda97cd-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler07e6d4dc-af3f-4d25-8381-0c515abab876/ratis/652d9754-e692-4af4-a831-1ba5054484a3
2019-06-16 19:46:05,474 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-16 19:46:05,475 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-16 19:46:05,475 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-16 19:46:05,475 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-16 19:46:05,475 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-16 19:46:05,475 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-16 19:46:05,475 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-16 19:46:05,476 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-16 19:46:05,476 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-16 19:46:05,476 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-16 19:46:05,476 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-16 19:46:05,477 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-16 19:46:05,477 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-16 19:46:05,479 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd: start group-1BA5054484A3
2019-06-16 19:46:05,479 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd:group-1BA5054484A3 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-16 19:46:05,479 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd: start FollowerState
2019-06-16 19:46:05,480 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-1BA5054484A3,id=8c3a5f10-5f16-495f-ae85-3f224dda97cd
2019-06-16 19:46:06,537 INFO  impl.FollowerState (FollowerState.java:run(101)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd:group-1BA5054484A3 changes to CANDIDATE, lastRpcTime:1057, electionTimeout:1057ms
2019-06-16 19:46:06,537 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd: shutdown FollowerState
2019-06-16 19:46:06,537 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd:group-1BA5054484A3 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-16 19:46:06,537 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd: start LeaderElection
2019-06-16 19:46:06,541 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd:group-1BA5054484A3:LeaderElection2: begin an election at term 1 for -1: [8c3a5f10-5f16-495f-ae85-3f224dda97cd:127.0.0.1:40323], old=null
2019-06-16 19:46:06,541 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd: shutdown LeaderElection
2019-06-16 19:46:06,541 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd:group-1BA5054484A3 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-16 19:46:06,541 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd:group-1BA5054484A3 change Leader from null to 8c3a5f10-5f16-495f-ae85-3f224dda97cd at term 1 for becomeLeader, leader elected after 1067ms
2019-06-16 19:46:06,541 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-16 19:46:06,542 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-16 19:46:06,542 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-16 19:46:06,542 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-16 19:46:06,542 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd: start LeaderState
2019-06-16 19:46:06,543 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd-RaftLogWorker: Starting segment from index:0
2019-06-16 19:46:06,543 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd:group-1BA5054484A3 set configuration 0: [8c3a5f10-5f16-495f-ae85-3f224dda97cd:127.0.0.1:40323], old=null at 0
2019-06-16 19:46:06,584 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler07e6d4dc-af3f-4d25-8381-0c515abab876/ratis/652d9754-e692-4af4-a831-1ba5054484a3/current/log_inprogress_0
2019-06-16 19:46:07,523 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-16 19:46:07,524 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd: close
2019-06-16 19:46:07,524 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd: shutdown group-1BA5054484A3
2019-06-16 19:46:07,524 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-1BA5054484A3,id=8c3a5f10-5f16-495f-ae85-3f224dda97cd
2019-06-16 19:46:07,525 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd: shutdown LeaderState
2019-06-16 19:46:07,525 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd-PendingRequests: sendNotLeaderResponses
2019-06-16 19:46:07,526 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-16 19:46:07,526 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler07e6d4dc-af3f-4d25-8381-0c515abab876/ratis/652d9754-e692-4af4-a831-1ba5054484a3/sm/snapshot.1_2
2019-06-16 19:46:07,527 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-8c3a5f10-5f16-495f-ae85-3f224dda97cd-group-1BA5054484A3: set stopIndex = 2
2019-06-16 19:46:07,527 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd:group-1BA5054484A3 closes. The last applied log index is 2
2019-06-16 19:46:07,528 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-16 19:46:07,528 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd-RaftLogWorker close()
2019-06-16 19:46:07,529 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd: shutdown server with port 40323 now
2019-06-16 19:46:07,530 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 8c3a5f10-5f16-495f-ae85-3f224dda97cd: shutdown server with port 40323 successfully
2019-06-16 19:46:07,534 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-16 19:46:07,570 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4ad6b60e-5dbd-4b4d-a9a9-3791f67c6136/hdds of  storage type : DISK and capacity : 104021790720
2019-06-16 19:46:07,570 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4ad6b60e-5dbd-4b4d-a9a9-3791f67c6136/hdds to VolumeSet
2019-06-16 19:46:07,571 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@26a2f7f9
2019-06-16 19:46:07,571 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@26a2f7f9
2019-06-16 19:46:07,585 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 35495
2019-06-16 19:46:07,586 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-16 19:46:07,587 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-16 19:46:07,587 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 35495 (custom)
2019-06-16 19:46:07,587 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-16 19:46:07,588 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-16 19:46:07,588 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-16 19:46:07,588 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-16 19:46:07,589 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4ad6b60e-5dbd-4b4d-a9a9-3791f67c6136/ratis] (custom)
2019-06-16 19:46:07,589 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 33577
2019-06-16 19:46:07,589 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-16 19:46:07,590 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-16 19:46:07,590 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 823a584a-1ad9-4b8b-a907-1bda4b1971fa at port 35495
2019-06-16 19:46:07,598 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa: start RPC server
2019-06-16 19:46:07,599 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa: GrpcService started, listening on 0.0.0.0/0.0.0.0:35495
2019-06-16 19:46:07,608 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa: addNew group-59F9C299F381:[823a584a-1ad9-4b8b-a907-1bda4b1971fa:127.0.0.1:35495] returns group-59F9C299F381:java.util.concurrent.CompletableFuture@38e1bf0e[Not completed]
2019-06-16 19:46:07,609 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa: new RaftServerImpl for group-59F9C299F381:[823a584a-1ad9-4b8b-a907-1bda4b1971fa:127.0.0.1:35495] with ContainerStateMachine:uninitialized
2019-06-16 19:46:07,609 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-16 19:46:07,609 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-16 19:46:07,610 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-16 19:46:07,610 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-16 19:46:07,610 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa:group-59F9C299F381 ConfigurationManager, init=-1: [823a584a-1ad9-4b8b-a907-1bda4b1971fa:127.0.0.1:35495], old=null, confs=<EMPTY_MAP>
2019-06-16 19:46:07,610 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4ad6b60e-5dbd-4b4d-a9a9-3791f67c6136/ratis] (custom)
2019-06-16 19:46:07,610 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4ad6b60e-5dbd-4b4d-a9a9-3791f67c6136/ratis/f8f3bc1f-ccb2-4359-96ac-59f9c299f381 does not exist. Creating ...
2019-06-16 19:46:07,613 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4ad6b60e-5dbd-4b4d-a9a9-3791f67c6136/ratis/f8f3bc1f-ccb2-4359-96ac-59f9c299f381/in_use.lock acquired by nodename 4314@ozone-unit-076618677d3xg9g4-2216415656
2019-06-16 19:46:07,615 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4ad6b60e-5dbd-4b4d-a9a9-3791f67c6136/ratis/f8f3bc1f-ccb2-4359-96ac-59f9c299f381 has been successfully formatted.
2019-06-16 19:46:07,616 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-16 19:46:07,616 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-16 19:46:07,616 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-16 19:46:07,616 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-16 19:46:07,616 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-16 19:46:07,616 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-16 19:46:07,616 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 823a584a-1ad9-4b8b-a907-1bda4b1971fa-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4ad6b60e-5dbd-4b4d-a9a9-3791f67c6136/ratis/f8f3bc1f-ccb2-4359-96ac-59f9c299f381
2019-06-16 19:46:07,616 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-16 19:46:07,616 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-16 19:46:07,617 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-16 19:46:07,617 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-16 19:46:07,617 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-16 19:46:07,617 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-16 19:46:07,617 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-16 19:46:07,617 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-16 19:46:07,617 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-16 19:46:07,617 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-16 19:46:07,618 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-16 19:46:07,618 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-16 19:46:07,618 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-16 19:46:07,618 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa: start group-59F9C299F381
2019-06-16 19:46:07,618 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa:group-59F9C299F381 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-16 19:46:07,619 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa: start FollowerState
2019-06-16 19:46:07,619 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-59F9C299F381,id=823a584a-1ad9-4b8b-a907-1bda4b1971fa
2019-06-16 19:46:08,808 INFO  impl.FollowerState (FollowerState.java:run(101)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa:group-59F9C299F381 changes to CANDIDATE, lastRpcTime:1189, electionTimeout:1189ms
2019-06-16 19:46:08,808 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa: shutdown FollowerState
2019-06-16 19:46:08,808 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa:group-59F9C299F381 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-16 19:46:08,808 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa: start LeaderElection
2019-06-16 19:46:08,812 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa:group-59F9C299F381:LeaderElection3: begin an election at term 1 for -1: [823a584a-1ad9-4b8b-a907-1bda4b1971fa:127.0.0.1:35495], old=null
2019-06-16 19:46:08,812 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa: shutdown LeaderElection
2019-06-16 19:46:08,813 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa:group-59F9C299F381 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-16 19:46:08,813 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa:group-59F9C299F381 change Leader from null to 823a584a-1ad9-4b8b-a907-1bda4b1971fa at term 1 for becomeLeader, leader elected after 1196ms
2019-06-16 19:46:08,813 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-16 19:46:08,813 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-16 19:46:08,813 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-16 19:46:08,814 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-16 19:46:08,814 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa: start LeaderState
2019-06-16 19:46:08,814 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa-RaftLogWorker: Starting segment from index:0
2019-06-16 19:46:08,816 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa:group-59F9C299F381 set configuration 0: [823a584a-1ad9-4b8b-a907-1bda4b1971fa:127.0.0.1:35495], old=null at 0
2019-06-16 19:46:08,858 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4ad6b60e-5dbd-4b4d-a9a9-3791f67c6136/ratis/f8f3bc1f-ccb2-4359-96ac-59f9c299f381/current/log_inprogress_0
2019-06-16 19:46:09,674 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 3259945400613037933 is closed with bcsId 0.
2019-06-16 19:46:09,674 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-16 19:46:09,675 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa: close
2019-06-16 19:46:09,675 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa: shutdown group-59F9C299F381
2019-06-16 19:46:09,675 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-59F9C299F381,id=823a584a-1ad9-4b8b-a907-1bda4b1971fa
2019-06-16 19:46:09,676 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa: shutdown LeaderState
2019-06-16 19:46:09,676 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa-PendingRequests: sendNotLeaderResponses
2019-06-16 19:46:09,677 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-823a584a-1ad9-4b8b-a907-1bda4b1971fa-group-59F9C299F381: set stopIndex = 2
2019-06-16 19:46:09,677 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-16 19:46:09,678 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4ad6b60e-5dbd-4b4d-a9a9-3791f67c6136/ratis/f8f3bc1f-ccb2-4359-96ac-59f9c299f381/sm/snapshot.1_2
2019-06-16 19:46:09,678 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa:group-59F9C299F381 closes. The last applied log index is 2
2019-06-16 19:46:09,678 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-16 19:46:09,679 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa-RaftLogWorker close()
2019-06-16 19:46:09,681 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa: shutdown server with port 35495 now
2019-06-16 19:46:09,683 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 823a584a-1ad9-4b8b-a907-1bda4b1971fa: shutdown server with port 35495 successfully
2019-06-16 19:46:09,690 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-16 19:46:09,732 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler612892d6-6bc0-4012-8b5c-968a6a849485/hdds of  storage type : DISK and capacity : 104021790720
2019-06-16 19:46:09,733 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler612892d6-6bc0-4012-8b5c-968a6a849485/hdds to VolumeSet
2019-06-16 19:46:09,733 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@66153688
2019-06-16 19:46:09,744 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@66153688
2019-06-16 19:46:09,755 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 41141
2019-06-16 19:46:09,756 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-16 19:46:09,756 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-16 19:46:09,757 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 41141 (custom)
2019-06-16 19:46:09,757 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-16 19:46:09,757 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-16 19:46:09,757 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-16 19:46:09,758 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-16 19:46:09,758 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler612892d6-6bc0-4012-8b5c-968a6a849485/ratis] (custom)
2019-06-16 19:46:09,759 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42559
2019-06-16 19:46:09,759 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-16 19:46:09,759 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-16 19:46:09,759 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 94060f90-bda3-4546-ab45-1b9238966f73 at port 41141
2019-06-16 19:46:09,776 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 94060f90-bda3-4546-ab45-1b9238966f73: start RPC server
2019-06-16 19:46:09,777 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 94060f90-bda3-4546-ab45-1b9238966f73: GrpcService started, listening on 0.0.0.0/0.0.0.0:41141
Jun 16, 2019 7:46:09 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:40323} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 16, 2019 7:46:09 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:35495} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-16 19:46:09,798 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 94060f90-bda3-4546-ab45-1b9238966f73: addNew group-6739D4AA1912:[94060f90-bda3-4546-ab45-1b9238966f73:127.0.0.1:41141] returns group-6739D4AA1912:java.util.concurrent.CompletableFuture@558739e[Not completed]
2019-06-16 19:46:09,799 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 94060f90-bda3-4546-ab45-1b9238966f73: new RaftServerImpl for group-6739D4AA1912:[94060f90-bda3-4546-ab45-1b9238966f73:127.0.0.1:41141] with ContainerStateMachine:uninitialized
2019-06-16 19:46:09,799 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-16 19:46:09,799 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-16 19:46:09,800 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-16 19:46:09,800 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-16 19:46:09,800 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 94060f90-bda3-4546-ab45-1b9238966f73:group-6739D4AA1912 ConfigurationManager, init=-1: [94060f90-bda3-4546-ab45-1b9238966f73:127.0.0.1:41141], old=null, confs=<EMPTY_MAP>
2019-06-16 19:46:09,800 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler612892d6-6bc0-4012-8b5c-968a6a849485/ratis] (custom)
2019-06-16 19:46:09,800 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler612892d6-6bc0-4012-8b5c-968a6a849485/ratis/aa10cbeb-acce-469b-a09f-6739d4aa1912 does not exist. Creating ...
2019-06-16 19:46:09,804 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler612892d6-6bc0-4012-8b5c-968a6a849485/ratis/aa10cbeb-acce-469b-a09f-6739d4aa1912/in_use.lock acquired by nodename 4314@ozone-unit-076618677d3xg9g4-2216415656
2019-06-16 19:46:09,806 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler612892d6-6bc0-4012-8b5c-968a6a849485/ratis/aa10cbeb-acce-469b-a09f-6739d4aa1912 has been successfully formatted.
2019-06-16 19:46:09,806 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-16 19:46:09,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-16 19:46:09,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-16 19:46:09,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-16 19:46:09,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-16 19:46:09,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-16 19:46:09,807 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 94060f90-bda3-4546-ab45-1b9238966f73-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler612892d6-6bc0-4012-8b5c-968a6a849485/ratis/aa10cbeb-acce-469b-a09f-6739d4aa1912
2019-06-16 19:46:09,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-16 19:46:09,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-16 19:46:09,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-16 19:46:09,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-16 19:46:09,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-16 19:46:09,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-16 19:46:09,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-16 19:46:09,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-16 19:46:09,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-16 19:46:09,808 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-16 19:46:09,808 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-16 19:46:09,808 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-16 19:46:09,808 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-16 19:46:09,808 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 94060f90-bda3-4546-ab45-1b9238966f73: start group-6739D4AA1912
2019-06-16 19:46:09,808 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 94060f90-bda3-4546-ab45-1b9238966f73:group-6739D4AA1912 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-16 19:46:09,809 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 94060f90-bda3-4546-ab45-1b9238966f73: start FollowerState
2019-06-16 19:46:09,809 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-6739D4AA1912,id=94060f90-bda3-4546-ab45-1b9238966f73
2019-06-16 19:46:10,912 INFO  impl.FollowerState (FollowerState.java:run(101)) - 94060f90-bda3-4546-ab45-1b9238966f73:group-6739D4AA1912 changes to CANDIDATE, lastRpcTime:1103, electionTimeout:1103ms
2019-06-16 19:46:10,912 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 94060f90-bda3-4546-ab45-1b9238966f73: shutdown FollowerState
2019-06-16 19:46:10,912 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 94060f90-bda3-4546-ab45-1b9238966f73:group-6739D4AA1912 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-16 19:46:10,912 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 94060f90-bda3-4546-ab45-1b9238966f73: start LeaderElection
2019-06-16 19:46:10,915 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 94060f90-bda3-4546-ab45-1b9238966f73:group-6739D4AA1912:LeaderElection4: begin an election at term 1 for -1: [94060f90-bda3-4546-ab45-1b9238966f73:127.0.0.1:41141], old=null
2019-06-16 19:46:10,915 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 94060f90-bda3-4546-ab45-1b9238966f73: shutdown LeaderElection
2019-06-16 19:46:10,916 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 94060f90-bda3-4546-ab45-1b9238966f73:group-6739D4AA1912 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-16 19:46:10,916 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 94060f90-bda3-4546-ab45-1b9238966f73:group-6739D4AA1912 change Leader from null to 94060f90-bda3-4546-ab45-1b9238966f73 at term 1 for becomeLeader, leader elected after 1109ms
2019-06-16 19:46:10,916 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-16 19:46:10,916 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-16 19:46:10,916 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-16 19:46:10,916 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-16 19:46:10,916 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 94060f90-bda3-4546-ab45-1b9238966f73: start LeaderState
2019-06-16 19:46:10,917 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 94060f90-bda3-4546-ab45-1b9238966f73-RaftLogWorker: Starting segment from index:0
2019-06-16 19:46:10,918 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 94060f90-bda3-4546-ab45-1b9238966f73:group-6739D4AA1912 set configuration 0: [94060f90-bda3-4546-ab45-1b9238966f73:127.0.0.1:41141], old=null at 0
2019-06-16 19:46:10,958 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 94060f90-bda3-4546-ab45-1b9238966f73-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler612892d6-6bc0-4012-8b5c-968a6a849485/ratis/aa10cbeb-acce-469b-a09f-6739d4aa1912/current/log_inprogress_0
2019-06-16 19:46:11,860 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 4801972905472292047 is closed with bcsId 0.
2019-06-16 19:46:11,860 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-16 19:46:11,861 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 94060f90-bda3-4546-ab45-1b9238966f73: close
2019-06-16 19:46:11,861 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 94060f90-bda3-4546-ab45-1b9238966f73: shutdown group-6739D4AA1912
2019-06-16 19:46:11,861 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-6739D4AA1912,id=94060f90-bda3-4546-ab45-1b9238966f73
2019-06-16 19:46:11,861 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 94060f90-bda3-4546-ab45-1b9238966f73: shutdown LeaderState
2019-06-16 19:46:11,862 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 94060f90-bda3-4546-ab45-1b9238966f73-PendingRequests: sendNotLeaderResponses
2019-06-16 19:46:11,863 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-94060f90-bda3-4546-ab45-1b9238966f73-group-6739D4AA1912: set stopIndex = 2
2019-06-16 19:46:11,863 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-16 19:46:11,863 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler612892d6-6bc0-4012-8b5c-968a6a849485/ratis/aa10cbeb-acce-469b-a09f-6739d4aa1912/sm/snapshot.1_2
2019-06-16 19:46:11,864 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 94060f90-bda3-4546-ab45-1b9238966f73:group-6739D4AA1912 closes. The last applied log index is 2
2019-06-16 19:46:11,864 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 94060f90-bda3-4546-ab45-1b9238966f73-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-16 19:46:11,865 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 94060f90-bda3-4546-ab45-1b9238966f73-RaftLogWorker close()
2019-06-16 19:46:11,865 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 94060f90-bda3-4546-ab45-1b9238966f73: shutdown server with port 41141 now
2019-06-16 19:46:11,867 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 94060f90-bda3-4546-ab45-1b9238966f73: shutdown server with port 41141 successfully
2019-06-16 19:46:11,872 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-16 19:46:11,895 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfbb905be-0163-4bb9-9c19-d3bf51d9a52b/hdds of  storage type : DISK and capacity : 104021790720
2019-06-16 19:46:11,895 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfbb905be-0163-4bb9-9c19-d3bf51d9a52b/hdds to VolumeSet
2019-06-16 19:46:11,896 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@68217d41
2019-06-16 19:46:11,898 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@68217d41
2019-06-16 19:46:11,908 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 33249
2019-06-16 19:46:11,909 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-16 19:46:11,909 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-16 19:46:11,909 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 33249 (custom)
2019-06-16 19:46:11,910 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-16 19:46:11,910 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-16 19:46:11,910 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-16 19:46:11,910 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-16 19:46:11,911 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfbb905be-0163-4bb9-9c19-d3bf51d9a52b/ratis] (custom)
2019-06-16 19:46:11,911 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 34379
2019-06-16 19:46:11,912 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-16 19:46:11,912 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-16 19:46:11,912 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 323862aa-ad63-4587-8083-74aa6d085447 at port 33249
2019-06-16 19:46:11,938 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 323862aa-ad63-4587-8083-74aa6d085447: start RPC server
2019-06-16 19:46:11,940 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 323862aa-ad63-4587-8083-74aa6d085447: GrpcService started, listening on 0.0.0.0/0.0.0.0:33249
2019-06-16 19:46:11,955 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 323862aa-ad63-4587-8083-74aa6d085447: addNew group-A5E3D57B836F:[323862aa-ad63-4587-8083-74aa6d085447:127.0.0.1:33249] returns group-A5E3D57B836F:java.util.concurrent.CompletableFuture@3c79a33[Not completed]
2019-06-16 19:46:11,955 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 323862aa-ad63-4587-8083-74aa6d085447: new RaftServerImpl for group-A5E3D57B836F:[323862aa-ad63-4587-8083-74aa6d085447:127.0.0.1:33249] with ContainerStateMachine:uninitialized
2019-06-16 19:46:11,956 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-16 19:46:11,956 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-16 19:46:11,956 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-16 19:46:11,956 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-16 19:46:11,956 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 323862aa-ad63-4587-8083-74aa6d085447:group-A5E3D57B836F ConfigurationManager, init=-1: [323862aa-ad63-4587-8083-74aa6d085447:127.0.0.1:33249], old=null, confs=<EMPTY_MAP>
2019-06-16 19:46:11,957 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfbb905be-0163-4bb9-9c19-d3bf51d9a52b/ratis] (custom)
2019-06-16 19:46:11,957 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfbb905be-0163-4bb9-9c19-d3bf51d9a52b/ratis/ec10aa0a-99f0-4a1e-a716-a5e3d57b836f does not exist. Creating ...
2019-06-16 19:46:11,959 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfbb905be-0163-4bb9-9c19-d3bf51d9a52b/ratis/ec10aa0a-99f0-4a1e-a716-a5e3d57b836f/in_use.lock acquired by nodename 4314@ozone-unit-076618677d3xg9g4-2216415656
2019-06-16 19:46:11,961 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfbb905be-0163-4bb9-9c19-d3bf51d9a52b/ratis/ec10aa0a-99f0-4a1e-a716-a5e3d57b836f has been successfully formatted.
2019-06-16 19:46:11,962 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-16 19:46:11,962 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-16 19:46:11,962 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-16 19:46:11,962 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-16 19:46:11,962 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-16 19:46:11,962 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-16 19:46:11,962 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 323862aa-ad63-4587-8083-74aa6d085447-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfbb905be-0163-4bb9-9c19-d3bf51d9a52b/ratis/ec10aa0a-99f0-4a1e-a716-a5e3d57b836f
2019-06-16 19:46:11,962 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-16 19:46:11,962 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-16 19:46:11,962 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-16 19:46:11,963 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-16 19:46:11,963 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-16 19:46:11,963 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-16 19:46:11,963 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-16 19:46:11,963 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-16 19:46:11,963 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-16 19:46:11,963 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-16 19:46:11,964 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-16 19:46:11,964 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-16 19:46:11,964 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-16 19:46:11,964 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 323862aa-ad63-4587-8083-74aa6d085447: start group-A5E3D57B836F
2019-06-16 19:46:11,964 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 323862aa-ad63-4587-8083-74aa6d085447:group-A5E3D57B836F changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-16 19:46:11,965 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 323862aa-ad63-4587-8083-74aa6d085447: start FollowerState
2019-06-16 19:46:11,965 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-A5E3D57B836F,id=323862aa-ad63-4587-8083-74aa6d085447
2019-06-16 19:46:13,085 INFO  impl.FollowerState (FollowerState.java:run(101)) - 323862aa-ad63-4587-8083-74aa6d085447:group-A5E3D57B836F changes to CANDIDATE, lastRpcTime:1120, electionTimeout:1120ms
2019-06-16 19:46:13,085 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 323862aa-ad63-4587-8083-74aa6d085447: shutdown FollowerState
2019-06-16 19:46:13,086 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 323862aa-ad63-4587-8083-74aa6d085447:group-A5E3D57B836F changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-16 19:46:13,086 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 323862aa-ad63-4587-8083-74aa6d085447: start LeaderElection
2019-06-16 19:46:13,091 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 323862aa-ad63-4587-8083-74aa6d085447:group-A5E3D57B836F:LeaderElection5: begin an election at term 1 for -1: [323862aa-ad63-4587-8083-74aa6d085447:127.0.0.1:33249], old=null
2019-06-16 19:46:13,091 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 323862aa-ad63-4587-8083-74aa6d085447: shutdown LeaderElection
2019-06-16 19:46:13,091 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 323862aa-ad63-4587-8083-74aa6d085447:group-A5E3D57B836F changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-16 19:46:13,091 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 323862aa-ad63-4587-8083-74aa6d085447:group-A5E3D57B836F change Leader from null to 323862aa-ad63-4587-8083-74aa6d085447 at term 1 for becomeLeader, leader elected after 1129ms
2019-06-16 19:46:13,091 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-16 19:46:13,091 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-16 19:46:13,091 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-16 19:46:13,092 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-16 19:46:13,092 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 323862aa-ad63-4587-8083-74aa6d085447: start LeaderState
2019-06-16 19:46:13,092 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 323862aa-ad63-4587-8083-74aa6d085447-RaftLogWorker: Starting segment from index:0
2019-06-16 19:46:13,092 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 323862aa-ad63-4587-8083-74aa6d085447:group-A5E3D57B836F set configuration 0: [323862aa-ad63-4587-8083-74aa6d085447:127.0.0.1:33249], old=null at 0
2019-06-16 19:46:13,132 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 323862aa-ad63-4587-8083-74aa6d085447-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfbb905be-0163-4bb9-9c19-d3bf51d9a52b/ratis/ec10aa0a-99f0-4a1e-a716-a5e3d57b836f/current/log_inprogress_0
2019-06-16 19:46:14,012 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 7838748369545678637 is closed with bcsId 0.
2019-06-16 19:46:14,012 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-16 19:46:14,013 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 323862aa-ad63-4587-8083-74aa6d085447: close
2019-06-16 19:46:14,013 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 323862aa-ad63-4587-8083-74aa6d085447: shutdown group-A5E3D57B836F
2019-06-16 19:46:14,013 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-A5E3D57B836F,id=323862aa-ad63-4587-8083-74aa6d085447
2019-06-16 19:46:14,013 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 323862aa-ad63-4587-8083-74aa6d085447: shutdown LeaderState
2019-06-16 19:46:14,014 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 323862aa-ad63-4587-8083-74aa6d085447-PendingRequests: sendNotLeaderResponses
2019-06-16 19:46:14,015 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-323862aa-ad63-4587-8083-74aa6d085447-group-A5E3D57B836F: set stopIndex = 4
2019-06-16 19:46:14,015 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-16 19:46:14,016 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfbb905be-0163-4bb9-9c19-d3bf51d9a52b/ratis/ec10aa0a-99f0-4a1e-a716-a5e3d57b836f/sm/snapshot.1_4
2019-06-16 19:46:14,016 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 323862aa-ad63-4587-8083-74aa6d085447:group-A5E3D57B836F closes. The last applied log index is 4
2019-06-16 19:46:14,016 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 323862aa-ad63-4587-8083-74aa6d085447-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-16 19:46:14,017 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 323862aa-ad63-4587-8083-74aa6d085447-RaftLogWorker close()
2019-06-16 19:46:14,018 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 323862aa-ad63-4587-8083-74aa6d085447: shutdown server with port 33249 now
2019-06-16 19:46:14,019 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 323862aa-ad63-4587-8083-74aa6d085447: shutdown server with port 33249 successfully
2019-06-16 19:46:14,024 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
