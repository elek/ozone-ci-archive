2019-06-18 12:37:01,566 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd8cb0c02-45e0-4a18-b665-95fc36c6529a/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 12:37:01,572 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd8cb0c02-45e0-4a18-b665-95fc36c6529a/hdds to VolumeSet
2019-06-18 12:37:01,600 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-18 12:37:01,628 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-18 12:37:01,970 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43307
2019-06-18 12:37:02,435 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 12:37:02,460 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 12:37:02,469 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43307 (custom)
2019-06-18 12:37:02,470 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 12:37:02,473 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 12:37:02,474 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 12:37:02,475 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 12:37:02,628 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd8cb0c02-45e0-4a18-b665-95fc36c6529a/ratis] (custom)
2019-06-18 12:37:02,642 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 36135
2019-06-18 12:37:02,669 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 12:37:02,669 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 12:37:02,670 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis b9b5fef7-9de1-4c33-9479-9e273474f5e8 at port 43307
2019-06-18 12:37:02,687 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8: start RPC server
2019-06-18 12:37:02,826 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8: GrpcService started, listening on 0.0.0.0/0.0.0.0:43307
2019-06-18 12:37:03,144 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8: addNew group-F1E5AAAC5009:[b9b5fef7-9de1-4c33-9479-9e273474f5e8:127.0.0.1:43307] returns group-F1E5AAAC5009:java.util.concurrent.CompletableFuture@5669f4e2[Not completed]
2019-06-18 12:37:03,176 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8: new RaftServerImpl for group-F1E5AAAC5009:[b9b5fef7-9de1-4c33-9479-9e273474f5e8:127.0.0.1:43307] with ContainerStateMachine:uninitialized
2019-06-18 12:37:03,177 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 12:37:03,177 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 12:37:03,177 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 12:37:03,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 12:37:03,182 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8:group-F1E5AAAC5009 ConfigurationManager, init=-1: [b9b5fef7-9de1-4c33-9479-9e273474f5e8:127.0.0.1:43307], old=null, confs=<EMPTY_MAP>
2019-06-18 12:37:03,183 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd8cb0c02-45e0-4a18-b665-95fc36c6529a/ratis] (custom)
2019-06-18 12:37:03,189 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd8cb0c02-45e0-4a18-b665-95fc36c6529a/ratis/16b13a5b-6aa0-4176-a12b-f1e5aaac5009 does not exist. Creating ...
2019-06-18 12:37:03,197 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd8cb0c02-45e0-4a18-b665-95fc36c6529a/ratis/16b13a5b-6aa0-4176-a12b-f1e5aaac5009/in_use.lock acquired by nodename 4304@ozone-unit-076618677d3z4mjz-3730877978
2019-06-18 12:37:03,205 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd8cb0c02-45e0-4a18-b665-95fc36c6529a/ratis/16b13a5b-6aa0-4176-a12b-f1e5aaac5009 has been successfully formatted.
2019-06-18 12:37:03,207 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 12:37:03,207 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 12:37:03,210 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 12:37:03,213 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 12:37:03,216 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 12:37:03,219 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 12:37:03,222 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new b9b5fef7-9de1-4c33-9479-9e273474f5e8-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd8cb0c02-45e0-4a18-b665-95fc36c6529a/ratis/16b13a5b-6aa0-4176-a12b-f1e5aaac5009
2019-06-18 12:37:03,222 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 12:37:03,223 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 12:37:03,224 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 12:37:03,225 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 12:37:03,225 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 12:37:03,226 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 12:37:03,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 12:37:03,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 12:37:03,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 12:37:03,229 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 12:37:03,235 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 12:37:03,236 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 12:37:03,236 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 12:37:03,335 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8: start group-F1E5AAAC5009
2019-06-18 12:37:03,336 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8:group-F1E5AAAC5009 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 12:37:03,337 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8: start FollowerState
2019-06-18 12:37:03,339 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-F1E5AAAC5009,id=b9b5fef7-9de1-4c33-9479-9e273474f5e8
2019-06-18 12:37:04,451 INFO  impl.FollowerState (FollowerState.java:run(101)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8:group-F1E5AAAC5009 changes to CANDIDATE, lastRpcTime:1114, electionTimeout:1113ms
2019-06-18 12:37:04,451 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8: shutdown FollowerState
2019-06-18 12:37:04,451 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8:group-F1E5AAAC5009 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 12:37:04,453 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8: start LeaderElection
2019-06-18 12:37:04,457 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8:group-F1E5AAAC5009:LeaderElection1: begin an election at term 1 for -1: [b9b5fef7-9de1-4c33-9479-9e273474f5e8:127.0.0.1:43307], old=null
2019-06-18 12:37:04,458 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8: shutdown LeaderElection
2019-06-18 12:37:04,458 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8:group-F1E5AAAC5009 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 12:37:04,458 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8:group-F1E5AAAC5009 change Leader from null to b9b5fef7-9de1-4c33-9479-9e273474f5e8 at term 1 for becomeLeader, leader elected after 1250ms
2019-06-18 12:37:04,462 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 12:37:04,462 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 12:37:04,464 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 12:37:04,464 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 12:37:04,471 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8: start LeaderState
2019-06-18 12:37:04,482 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8-RaftLogWorker: Starting segment from index:0
2019-06-18 12:37:04,488 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8:group-F1E5AAAC5009 set configuration 0: [b9b5fef7-9de1-4c33-9479-9e273474f5e8:127.0.0.1:43307], old=null at 0
2019-06-18 12:37:04,621 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd8cb0c02-45e0-4a18-b665-95fc36c6529a/ratis/16b13a5b-6aa0-4176-a12b-f1e5aaac5009/current/log_inprogress_0
2019-06-18 12:37:05,591 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-18 12:37:05,656 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 4807246047032998470 is closed with bcsId 0.
2019-06-18 12:37:05,657 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 12:37:05,658 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8: close
2019-06-18 12:37:05,660 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8: shutdown group-F1E5AAAC5009
2019-06-18 12:37:05,661 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-F1E5AAAC5009,id=b9b5fef7-9de1-4c33-9479-9e273474f5e8
2019-06-18 12:37:05,661 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8: shutdown LeaderState
2019-06-18 12:37:05,662 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8-PendingRequests: sendNotLeaderResponses
2019-06-18 12:37:05,664 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-b9b5fef7-9de1-4c33-9479-9e273474f5e8-group-F1E5AAAC5009: set stopIndex = 4
2019-06-18 12:37:05,664 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-18 12:37:05,665 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd8cb0c02-45e0-4a18-b665-95fc36c6529a/ratis/16b13a5b-6aa0-4176-a12b-f1e5aaac5009/sm/snapshot.1_4
2019-06-18 12:37:05,673 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8:group-F1E5AAAC5009 closes. The last applied log index is 4
2019-06-18 12:37:05,674 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 12:37:05,675 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8-RaftLogWorker close()
2019-06-18 12:37:05,676 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8: shutdown server with port 43307 now
2019-06-18 12:37:05,679 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - b9b5fef7-9de1-4c33-9479-9e273474f5e8: shutdown server with port 43307 successfully
2019-06-18 12:37:05,687 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-18 12:37:05,714 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler91a9ec64-fd0b-4570-a3bd-76e14810b27a/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 12:37:05,714 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler91a9ec64-fd0b-4570-a3bd-76e14810b27a/hdds to VolumeSet
2019-06-18 12:37:05,714 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@47547132
2019-06-18 12:37:05,715 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@47547132
2019-06-18 12:37:05,728 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 35349
2019-06-18 12:37:05,729 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 12:37:05,729 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 12:37:05,730 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 35349 (custom)
2019-06-18 12:37:05,730 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 12:37:05,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 12:37:05,730 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 12:37:05,731 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 12:37:05,732 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler91a9ec64-fd0b-4570-a3bd-76e14810b27a/ratis] (custom)
2019-06-18 12:37:05,732 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 40831
2019-06-18 12:37:05,732 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 12:37:05,732 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 12:37:05,732 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 58019ce9-614c-491d-b5f4-5f246719ae99 at port 35349
2019-06-18 12:37:05,768 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 58019ce9-614c-491d-b5f4-5f246719ae99: start RPC server
2019-06-18 12:37:05,770 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 58019ce9-614c-491d-b5f4-5f246719ae99: GrpcService started, listening on 0.0.0.0/0.0.0.0:35349
2019-06-18 12:37:05,778 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 58019ce9-614c-491d-b5f4-5f246719ae99: addNew group-86FCF4D09EBC:[58019ce9-614c-491d-b5f4-5f246719ae99:127.0.0.1:35349] returns group-86FCF4D09EBC:java.util.concurrent.CompletableFuture@5bf84dab[Not completed]
2019-06-18 12:37:05,779 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 58019ce9-614c-491d-b5f4-5f246719ae99: new RaftServerImpl for group-86FCF4D09EBC:[58019ce9-614c-491d-b5f4-5f246719ae99:127.0.0.1:35349] with ContainerStateMachine:uninitialized
2019-06-18 12:37:05,780 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 12:37:05,780 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 12:37:05,780 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 12:37:05,780 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 12:37:05,780 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 58019ce9-614c-491d-b5f4-5f246719ae99:group-86FCF4D09EBC ConfigurationManager, init=-1: [58019ce9-614c-491d-b5f4-5f246719ae99:127.0.0.1:35349], old=null, confs=<EMPTY_MAP>
2019-06-18 12:37:05,780 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler91a9ec64-fd0b-4570-a3bd-76e14810b27a/ratis] (custom)
2019-06-18 12:37:05,781 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler91a9ec64-fd0b-4570-a3bd-76e14810b27a/ratis/df5d6009-b09f-401f-ad74-86fcf4d09ebc does not exist. Creating ...
2019-06-18 12:37:05,785 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler91a9ec64-fd0b-4570-a3bd-76e14810b27a/ratis/df5d6009-b09f-401f-ad74-86fcf4d09ebc/in_use.lock acquired by nodename 4304@ozone-unit-076618677d3z4mjz-3730877978
2019-06-18 12:37:05,787 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler91a9ec64-fd0b-4570-a3bd-76e14810b27a/ratis/df5d6009-b09f-401f-ad74-86fcf4d09ebc has been successfully formatted.
2019-06-18 12:37:05,787 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 12:37:05,787 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 12:37:05,787 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 12:37:05,787 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 12:37:05,787 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 12:37:05,788 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 12:37:05,788 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 58019ce9-614c-491d-b5f4-5f246719ae99-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler91a9ec64-fd0b-4570-a3bd-76e14810b27a/ratis/df5d6009-b09f-401f-ad74-86fcf4d09ebc
2019-06-18 12:37:05,788 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 12:37:05,788 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 12:37:05,788 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 12:37:05,788 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 12:37:05,788 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 12:37:05,788 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 12:37:05,789 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 12:37:05,789 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 12:37:05,789 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 12:37:05,789 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 12:37:05,791 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 12:37:05,791 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 12:37:05,791 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 12:37:05,791 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 58019ce9-614c-491d-b5f4-5f246719ae99: start group-86FCF4D09EBC
2019-06-18 12:37:05,791 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 58019ce9-614c-491d-b5f4-5f246719ae99:group-86FCF4D09EBC changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 12:37:05,791 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 58019ce9-614c-491d-b5f4-5f246719ae99: start FollowerState
2019-06-18 12:37:05,792 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-86FCF4D09EBC,id=58019ce9-614c-491d-b5f4-5f246719ae99
2019-06-18 12:37:06,883 INFO  impl.FollowerState (FollowerState.java:run(101)) - 58019ce9-614c-491d-b5f4-5f246719ae99:group-86FCF4D09EBC changes to CANDIDATE, lastRpcTime:1091, electionTimeout:1091ms
2019-06-18 12:37:06,883 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 58019ce9-614c-491d-b5f4-5f246719ae99: shutdown FollowerState
2019-06-18 12:37:06,883 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 58019ce9-614c-491d-b5f4-5f246719ae99:group-86FCF4D09EBC changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 12:37:06,883 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 58019ce9-614c-491d-b5f4-5f246719ae99: start LeaderElection
2019-06-18 12:37:06,887 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 58019ce9-614c-491d-b5f4-5f246719ae99:group-86FCF4D09EBC:LeaderElection2: begin an election at term 1 for -1: [58019ce9-614c-491d-b5f4-5f246719ae99:127.0.0.1:35349], old=null
2019-06-18 12:37:06,887 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 58019ce9-614c-491d-b5f4-5f246719ae99: shutdown LeaderElection
2019-06-18 12:37:06,887 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 58019ce9-614c-491d-b5f4-5f246719ae99:group-86FCF4D09EBC changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 12:37:06,887 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 58019ce9-614c-491d-b5f4-5f246719ae99:group-86FCF4D09EBC change Leader from null to 58019ce9-614c-491d-b5f4-5f246719ae99 at term 1 for becomeLeader, leader elected after 1100ms
2019-06-18 12:37:06,888 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 12:37:06,888 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 12:37:06,888 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 12:37:06,888 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 12:37:06,889 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 58019ce9-614c-491d-b5f4-5f246719ae99: start LeaderState
2019-06-18 12:37:06,889 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 58019ce9-614c-491d-b5f4-5f246719ae99-RaftLogWorker: Starting segment from index:0
2019-06-18 12:37:06,893 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 58019ce9-614c-491d-b5f4-5f246719ae99:group-86FCF4D09EBC set configuration 0: [58019ce9-614c-491d-b5f4-5f246719ae99:127.0.0.1:35349], old=null at 0
2019-06-18 12:37:06,925 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 58019ce9-614c-491d-b5f4-5f246719ae99-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler91a9ec64-fd0b-4570-a3bd-76e14810b27a/ratis/df5d6009-b09f-401f-ad74-86fcf4d09ebc/current/log_inprogress_0
2019-06-18 12:37:07,827 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 12:37:07,828 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 58019ce9-614c-491d-b5f4-5f246719ae99: close
2019-06-18 12:37:07,828 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 58019ce9-614c-491d-b5f4-5f246719ae99: shutdown group-86FCF4D09EBC
2019-06-18 12:37:07,828 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-86FCF4D09EBC,id=58019ce9-614c-491d-b5f4-5f246719ae99
2019-06-18 12:37:07,829 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 58019ce9-614c-491d-b5f4-5f246719ae99: shutdown LeaderState
2019-06-18 12:37:07,829 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 58019ce9-614c-491d-b5f4-5f246719ae99-PendingRequests: sendNotLeaderResponses
2019-06-18 12:37:07,830 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-58019ce9-614c-491d-b5f4-5f246719ae99-group-86FCF4D09EBC: set stopIndex = 2
2019-06-18 12:37:07,830 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-18 12:37:07,831 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler91a9ec64-fd0b-4570-a3bd-76e14810b27a/ratis/df5d6009-b09f-401f-ad74-86fcf4d09ebc/sm/snapshot.1_2
2019-06-18 12:37:07,831 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 58019ce9-614c-491d-b5f4-5f246719ae99:group-86FCF4D09EBC closes. The last applied log index is 2
2019-06-18 12:37:07,831 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 58019ce9-614c-491d-b5f4-5f246719ae99-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 12:37:07,832 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 58019ce9-614c-491d-b5f4-5f246719ae99-RaftLogWorker close()
2019-06-18 12:37:07,833 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 58019ce9-614c-491d-b5f4-5f246719ae99: shutdown server with port 35349 now
2019-06-18 12:37:07,836 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 58019ce9-614c-491d-b5f4-5f246719ae99: shutdown server with port 35349 successfully
2019-06-18 12:37:07,837 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-18 12:37:07,865 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0fe1565a-af9b-4439-b79b-4baf9d72b645/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 12:37:07,866 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0fe1565a-af9b-4439-b79b-4baf9d72b645/hdds to VolumeSet
2019-06-18 12:37:07,866 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1bd0b0e5
2019-06-18 12:37:07,866 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1bd0b0e5
2019-06-18 12:37:07,877 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 38583
2019-06-18 12:37:07,878 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 12:37:07,879 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 12:37:07,879 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 38583 (custom)
2019-06-18 12:37:07,879 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 12:37:07,879 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 12:37:07,880 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 12:37:07,880 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 12:37:07,880 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0fe1565a-af9b-4439-b79b-4baf9d72b645/ratis] (custom)
2019-06-18 12:37:07,881 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 35653
2019-06-18 12:37:07,881 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 12:37:07,881 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 12:37:07,882 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis b0d03848-6af3-4efe-a182-169350066e02 at port 38583
2019-06-18 12:37:07,889 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - b0d03848-6af3-4efe-a182-169350066e02: start RPC server
2019-06-18 12:37:07,891 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - b0d03848-6af3-4efe-a182-169350066e02: GrpcService started, listening on 0.0.0.0/0.0.0.0:38583
2019-06-18 12:37:07,899 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - b0d03848-6af3-4efe-a182-169350066e02: addNew group-DD8AA0424407:[b0d03848-6af3-4efe-a182-169350066e02:127.0.0.1:38583] returns group-DD8AA0424407:java.util.concurrent.CompletableFuture@4e8a28ff[Not completed]
2019-06-18 12:37:07,899 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - b0d03848-6af3-4efe-a182-169350066e02: new RaftServerImpl for group-DD8AA0424407:[b0d03848-6af3-4efe-a182-169350066e02:127.0.0.1:38583] with ContainerStateMachine:uninitialized
2019-06-18 12:37:07,900 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 12:37:07,900 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 12:37:07,900 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 12:37:07,900 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 12:37:07,900 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - b0d03848-6af3-4efe-a182-169350066e02:group-DD8AA0424407 ConfigurationManager, init=-1: [b0d03848-6af3-4efe-a182-169350066e02:127.0.0.1:38583], old=null, confs=<EMPTY_MAP>
2019-06-18 12:37:07,901 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0fe1565a-af9b-4439-b79b-4baf9d72b645/ratis] (custom)
2019-06-18 12:37:07,901 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0fe1565a-af9b-4439-b79b-4baf9d72b645/ratis/79b2075c-8f1c-4950-8861-dd8aa0424407 does not exist. Creating ...
2019-06-18 12:37:07,904 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0fe1565a-af9b-4439-b79b-4baf9d72b645/ratis/79b2075c-8f1c-4950-8861-dd8aa0424407/in_use.lock acquired by nodename 4304@ozone-unit-076618677d3z4mjz-3730877978
2019-06-18 12:37:07,907 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0fe1565a-af9b-4439-b79b-4baf9d72b645/ratis/79b2075c-8f1c-4950-8861-dd8aa0424407 has been successfully formatted.
2019-06-18 12:37:07,907 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 12:37:07,907 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 12:37:07,907 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 12:37:07,907 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 12:37:07,907 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 12:37:07,907 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 12:37:07,907 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new b0d03848-6af3-4efe-a182-169350066e02-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0fe1565a-af9b-4439-b79b-4baf9d72b645/ratis/79b2075c-8f1c-4950-8861-dd8aa0424407
2019-06-18 12:37:07,907 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 12:37:07,907 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 12:37:07,908 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 12:37:07,908 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 12:37:07,908 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 12:37:07,908 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 12:37:07,908 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 12:37:07,908 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 12:37:07,908 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 12:37:07,908 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 12:37:07,909 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 12:37:07,909 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 12:37:07,909 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 12:37:07,909 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - b0d03848-6af3-4efe-a182-169350066e02: start group-DD8AA0424407
2019-06-18 12:37:07,909 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0d03848-6af3-4efe-a182-169350066e02:group-DD8AA0424407 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 12:37:07,909 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0d03848-6af3-4efe-a182-169350066e02: start FollowerState
2019-06-18 12:37:07,909 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-DD8AA0424407,id=b0d03848-6af3-4efe-a182-169350066e02
2019-06-18 12:37:09,032 INFO  impl.FollowerState (FollowerState.java:run(101)) - b0d03848-6af3-4efe-a182-169350066e02:group-DD8AA0424407 changes to CANDIDATE, lastRpcTime:1123, electionTimeout:1123ms
2019-06-18 12:37:09,033 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b0d03848-6af3-4efe-a182-169350066e02: shutdown FollowerState
2019-06-18 12:37:09,033 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0d03848-6af3-4efe-a182-169350066e02:group-DD8AA0424407 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 12:37:09,033 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0d03848-6af3-4efe-a182-169350066e02: start LeaderElection
2019-06-18 12:37:09,042 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b0d03848-6af3-4efe-a182-169350066e02:group-DD8AA0424407:LeaderElection3: begin an election at term 1 for -1: [b0d03848-6af3-4efe-a182-169350066e02:127.0.0.1:38583], old=null
2019-06-18 12:37:09,042 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b0d03848-6af3-4efe-a182-169350066e02: shutdown LeaderElection
2019-06-18 12:37:09,042 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b0d03848-6af3-4efe-a182-169350066e02:group-DD8AA0424407 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 12:37:09,042 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - b0d03848-6af3-4efe-a182-169350066e02:group-DD8AA0424407 change Leader from null to b0d03848-6af3-4efe-a182-169350066e02 at term 1 for becomeLeader, leader elected after 1135ms
2019-06-18 12:37:09,043 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 12:37:09,043 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 12:37:09,043 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 12:37:09,043 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 12:37:09,043 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b0d03848-6af3-4efe-a182-169350066e02: start LeaderState
2019-06-18 12:37:09,044 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - b0d03848-6af3-4efe-a182-169350066e02-RaftLogWorker: Starting segment from index:0
2019-06-18 12:37:09,053 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - b0d03848-6af3-4efe-a182-169350066e02:group-DD8AA0424407 set configuration 0: [b0d03848-6af3-4efe-a182-169350066e02:127.0.0.1:38583], old=null at 0
2019-06-18 12:37:09,086 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - b0d03848-6af3-4efe-a182-169350066e02-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0fe1565a-af9b-4439-b79b-4baf9d72b645/ratis/79b2075c-8f1c-4950-8861-dd8aa0424407/current/log_inprogress_0
2019-06-18 12:37:09,952 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 7820114535880674529 is closed with bcsId 0.
2019-06-18 12:37:09,952 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 12:37:09,953 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - b0d03848-6af3-4efe-a182-169350066e02: close
2019-06-18 12:37:09,954 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - b0d03848-6af3-4efe-a182-169350066e02: shutdown group-DD8AA0424407
2019-06-18 12:37:09,954 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-DD8AA0424407,id=b0d03848-6af3-4efe-a182-169350066e02
2019-06-18 12:37:09,954 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - b0d03848-6af3-4efe-a182-169350066e02: shutdown LeaderState
2019-06-18 12:37:09,954 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - b0d03848-6af3-4efe-a182-169350066e02-PendingRequests: sendNotLeaderResponses
2019-06-18 12:37:09,955 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-b0d03848-6af3-4efe-a182-169350066e02-group-DD8AA0424407: set stopIndex = 2
2019-06-18 12:37:09,955 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-18 12:37:09,956 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0fe1565a-af9b-4439-b79b-4baf9d72b645/ratis/79b2075c-8f1c-4950-8861-dd8aa0424407/sm/snapshot.1_2
2019-06-18 12:37:09,956 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - b0d03848-6af3-4efe-a182-169350066e02:group-DD8AA0424407 closes. The last applied log index is 2
2019-06-18 12:37:09,956 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - b0d03848-6af3-4efe-a182-169350066e02-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 12:37:09,957 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - b0d03848-6af3-4efe-a182-169350066e02-RaftLogWorker close()
2019-06-18 12:37:09,959 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - b0d03848-6af3-4efe-a182-169350066e02: shutdown server with port 38583 now
2019-06-18 12:37:09,960 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - b0d03848-6af3-4efe-a182-169350066e02: shutdown server with port 38583 successfully
2019-06-18 12:37:09,980 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-18 12:37:10,006 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0a4d2a87-fdca-427f-9a46-0061e4222442/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 12:37:10,007 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0a4d2a87-fdca-427f-9a46-0061e4222442/hdds to VolumeSet
2019-06-18 12:37:10,007 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@552ed807
2019-06-18 12:37:10,007 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@552ed807
2019-06-18 12:37:10,018 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 36469
2019-06-18 12:37:10,019 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 12:37:10,019 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 12:37:10,019 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 36469 (custom)
2019-06-18 12:37:10,020 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 12:37:10,020 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 12:37:10,020 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 12:37:10,020 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 12:37:10,020 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0a4d2a87-fdca-427f-9a46-0061e4222442/ratis] (custom)
2019-06-18 12:37:10,021 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 35501
2019-06-18 12:37:10,021 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 12:37:10,021 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 12:37:10,021 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 29fcf7f5-9891-4c71-993e-10fb9cd8033a at port 36469
2019-06-18 12:37:10,030 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a: start RPC server
2019-06-18 12:37:10,031 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a: GrpcService started, listening on 0.0.0.0/0.0.0.0:36469
Jun 18, 2019 12:37:10 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:35349} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 18, 2019 12:37:10 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:38583} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-18 12:37:10,045 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a: addNew group-2604377D6819:[29fcf7f5-9891-4c71-993e-10fb9cd8033a:127.0.0.1:36469] returns group-2604377D6819:java.util.concurrent.CompletableFuture@5d772e86[Not completed]
2019-06-18 12:37:10,046 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a: new RaftServerImpl for group-2604377D6819:[29fcf7f5-9891-4c71-993e-10fb9cd8033a:127.0.0.1:36469] with ContainerStateMachine:uninitialized
2019-06-18 12:37:10,046 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 12:37:10,046 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 12:37:10,047 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 12:37:10,047 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 12:37:10,047 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a:group-2604377D6819 ConfigurationManager, init=-1: [29fcf7f5-9891-4c71-993e-10fb9cd8033a:127.0.0.1:36469], old=null, confs=<EMPTY_MAP>
2019-06-18 12:37:10,047 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0a4d2a87-fdca-427f-9a46-0061e4222442/ratis] (custom)
2019-06-18 12:37:10,047 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0a4d2a87-fdca-427f-9a46-0061e4222442/ratis/713bf5c7-99dc-4189-9661-2604377d6819 does not exist. Creating ...
2019-06-18 12:37:10,050 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0a4d2a87-fdca-427f-9a46-0061e4222442/ratis/713bf5c7-99dc-4189-9661-2604377d6819/in_use.lock acquired by nodename 4304@ozone-unit-076618677d3z4mjz-3730877978
2019-06-18 12:37:10,052 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0a4d2a87-fdca-427f-9a46-0061e4222442/ratis/713bf5c7-99dc-4189-9661-2604377d6819 has been successfully formatted.
2019-06-18 12:37:10,052 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 12:37:10,052 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 12:37:10,053 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 12:37:10,053 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 12:37:10,053 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 12:37:10,053 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 12:37:10,053 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 29fcf7f5-9891-4c71-993e-10fb9cd8033a-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0a4d2a87-fdca-427f-9a46-0061e4222442/ratis/713bf5c7-99dc-4189-9661-2604377d6819
2019-06-18 12:37:10,053 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 12:37:10,053 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 12:37:10,053 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 12:37:10,054 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 12:37:10,054 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 12:37:10,054 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 12:37:10,054 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 12:37:10,054 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 12:37:10,054 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 12:37:10,054 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 12:37:10,057 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 12:37:10,057 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 12:37:10,058 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 12:37:10,058 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a: start group-2604377D6819
2019-06-18 12:37:10,058 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a:group-2604377D6819 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 12:37:10,058 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a: start FollowerState
2019-06-18 12:37:10,062 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-2604377D6819,id=29fcf7f5-9891-4c71-993e-10fb9cd8033a
2019-06-18 12:37:11,222 INFO  impl.FollowerState (FollowerState.java:run(101)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a:group-2604377D6819 changes to CANDIDATE, lastRpcTime:1164, electionTimeout:1161ms
2019-06-18 12:37:11,223 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a: shutdown FollowerState
2019-06-18 12:37:11,223 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a:group-2604377D6819 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 12:37:11,223 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a: start LeaderElection
2019-06-18 12:37:11,227 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a:group-2604377D6819:LeaderElection4: begin an election at term 1 for -1: [29fcf7f5-9891-4c71-993e-10fb9cd8033a:127.0.0.1:36469], old=null
2019-06-18 12:37:11,228 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a: shutdown LeaderElection
2019-06-18 12:37:11,228 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a:group-2604377D6819 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 12:37:11,228 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a:group-2604377D6819 change Leader from null to 29fcf7f5-9891-4c71-993e-10fb9cd8033a at term 1 for becomeLeader, leader elected after 1175ms
2019-06-18 12:37:11,228 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 12:37:11,228 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 12:37:11,228 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 12:37:11,228 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 12:37:11,228 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a: start LeaderState
2019-06-18 12:37:11,229 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a-RaftLogWorker: Starting segment from index:0
2019-06-18 12:37:11,229 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a:group-2604377D6819 set configuration 0: [29fcf7f5-9891-4c71-993e-10fb9cd8033a:127.0.0.1:36469], old=null at 0
2019-06-18 12:37:11,264 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0a4d2a87-fdca-427f-9a46-0061e4222442/ratis/713bf5c7-99dc-4189-9661-2604377d6819/current/log_inprogress_0
2019-06-18 12:37:12,109 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 8617383213113178251 is closed with bcsId 0.
2019-06-18 12:37:12,110 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 12:37:12,110 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a: close
2019-06-18 12:37:12,111 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a: shutdown group-2604377D6819
2019-06-18 12:37:12,111 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-2604377D6819,id=29fcf7f5-9891-4c71-993e-10fb9cd8033a
2019-06-18 12:37:12,111 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a: shutdown LeaderState
2019-06-18 12:37:12,112 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a-PendingRequests: sendNotLeaderResponses
2019-06-18 12:37:12,114 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-29fcf7f5-9891-4c71-993e-10fb9cd8033a-group-2604377D6819: set stopIndex = 2
2019-06-18 12:37:12,118 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-18 12:37:12,119 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0a4d2a87-fdca-427f-9a46-0061e4222442/ratis/713bf5c7-99dc-4189-9661-2604377d6819/sm/snapshot.1_2
2019-06-18 12:37:12,119 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a:group-2604377D6819 closes. The last applied log index is 2
2019-06-18 12:37:12,119 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 12:37:12,120 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a-RaftLogWorker close()
2019-06-18 12:37:12,121 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a: shutdown server with port 36469 now
2019-06-18 12:37:12,122 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 29fcf7f5-9891-4c71-993e-10fb9cd8033a: shutdown server with port 36469 successfully
2019-06-18 12:37:12,124 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-18 12:37:12,150 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00de089e-45f1-4834-8b60-7170550edf66/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 12:37:12,150 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00de089e-45f1-4834-8b60-7170550edf66/hdds to VolumeSet
2019-06-18 12:37:12,151 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@713064e8
2019-06-18 12:37:12,152 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@713064e8
2019-06-18 12:37:12,163 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 40953
2019-06-18 12:37:12,164 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 12:37:12,165 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 12:37:12,165 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 40953 (custom)
2019-06-18 12:37:12,165 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 12:37:12,165 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 12:37:12,166 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 12:37:12,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 12:37:12,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00de089e-45f1-4834-8b60-7170550edf66/ratis] (custom)
2019-06-18 12:37:12,167 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 43271
2019-06-18 12:37:12,167 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 12:37:12,167 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 12:37:12,167 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis d6db2d1e-6efb-4386-bf16-352ade172e37 at port 40953
2019-06-18 12:37:12,181 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - d6db2d1e-6efb-4386-bf16-352ade172e37: start RPC server
2019-06-18 12:37:12,182 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - d6db2d1e-6efb-4386-bf16-352ade172e37: GrpcService started, listening on 0.0.0.0/0.0.0.0:40953
2019-06-18 12:37:12,190 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - d6db2d1e-6efb-4386-bf16-352ade172e37: addNew group-BCADAC79283C:[d6db2d1e-6efb-4386-bf16-352ade172e37:127.0.0.1:40953] returns group-BCADAC79283C:java.util.concurrent.CompletableFuture@65afefc[Not completed]
2019-06-18 12:37:12,191 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - d6db2d1e-6efb-4386-bf16-352ade172e37: new RaftServerImpl for group-BCADAC79283C:[d6db2d1e-6efb-4386-bf16-352ade172e37:127.0.0.1:40953] with ContainerStateMachine:uninitialized
2019-06-18 12:37:12,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 12:37:12,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 12:37:12,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 12:37:12,193 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 12:37:12,194 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - d6db2d1e-6efb-4386-bf16-352ade172e37:group-BCADAC79283C ConfigurationManager, init=-1: [d6db2d1e-6efb-4386-bf16-352ade172e37:127.0.0.1:40953], old=null, confs=<EMPTY_MAP>
2019-06-18 12:37:12,194 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00de089e-45f1-4834-8b60-7170550edf66/ratis] (custom)
2019-06-18 12:37:12,194 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00de089e-45f1-4834-8b60-7170550edf66/ratis/ff27c0a3-314c-4a71-9fb9-bcadac79283c does not exist. Creating ...
2019-06-18 12:37:12,196 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00de089e-45f1-4834-8b60-7170550edf66/ratis/ff27c0a3-314c-4a71-9fb9-bcadac79283c/in_use.lock acquired by nodename 4304@ozone-unit-076618677d3z4mjz-3730877978
2019-06-18 12:37:12,198 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00de089e-45f1-4834-8b60-7170550edf66/ratis/ff27c0a3-314c-4a71-9fb9-bcadac79283c has been successfully formatted.
2019-06-18 12:37:12,199 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 12:37:12,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 12:37:12,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 12:37:12,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 12:37:12,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 12:37:12,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 12:37:12,199 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new d6db2d1e-6efb-4386-bf16-352ade172e37-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00de089e-45f1-4834-8b60-7170550edf66/ratis/ff27c0a3-314c-4a71-9fb9-bcadac79283c
2019-06-18 12:37:12,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 12:37:12,200 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 12:37:12,200 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 12:37:12,200 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 12:37:12,200 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 12:37:12,200 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 12:37:12,200 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 12:37:12,200 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 12:37:12,200 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 12:37:12,201 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 12:37:12,201 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 12:37:12,201 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 12:37:12,201 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 12:37:12,202 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - d6db2d1e-6efb-4386-bf16-352ade172e37: start group-BCADAC79283C
2019-06-18 12:37:12,202 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d6db2d1e-6efb-4386-bf16-352ade172e37:group-BCADAC79283C changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 12:37:12,202 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d6db2d1e-6efb-4386-bf16-352ade172e37: start FollowerState
2019-06-18 12:37:12,202 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-BCADAC79283C,id=d6db2d1e-6efb-4386-bf16-352ade172e37
2019-06-18 12:37:13,258 INFO  impl.FollowerState (FollowerState.java:run(101)) - d6db2d1e-6efb-4386-bf16-352ade172e37:group-BCADAC79283C changes to CANDIDATE, lastRpcTime:1056, electionTimeout:1056ms
2019-06-18 12:37:13,259 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d6db2d1e-6efb-4386-bf16-352ade172e37: shutdown FollowerState
2019-06-18 12:37:13,259 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d6db2d1e-6efb-4386-bf16-352ade172e37:group-BCADAC79283C changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 12:37:13,259 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d6db2d1e-6efb-4386-bf16-352ade172e37: start LeaderElection
2019-06-18 12:37:13,262 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - d6db2d1e-6efb-4386-bf16-352ade172e37:group-BCADAC79283C:LeaderElection5: begin an election at term 1 for -1: [d6db2d1e-6efb-4386-bf16-352ade172e37:127.0.0.1:40953], old=null
2019-06-18 12:37:13,262 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - d6db2d1e-6efb-4386-bf16-352ade172e37: shutdown LeaderElection
2019-06-18 12:37:13,262 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d6db2d1e-6efb-4386-bf16-352ade172e37:group-BCADAC79283C changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 12:37:13,262 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - d6db2d1e-6efb-4386-bf16-352ade172e37:group-BCADAC79283C change Leader from null to d6db2d1e-6efb-4386-bf16-352ade172e37 at term 1 for becomeLeader, leader elected after 1063ms
2019-06-18 12:37:13,262 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 12:37:13,262 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 12:37:13,263 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 12:37:13,263 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 12:37:13,263 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d6db2d1e-6efb-4386-bf16-352ade172e37: start LeaderState
2019-06-18 12:37:13,263 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - d6db2d1e-6efb-4386-bf16-352ade172e37-RaftLogWorker: Starting segment from index:0
2019-06-18 12:37:13,264 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - d6db2d1e-6efb-4386-bf16-352ade172e37:group-BCADAC79283C set configuration 0: [d6db2d1e-6efb-4386-bf16-352ade172e37:127.0.0.1:40953], old=null at 0
2019-06-18 12:37:13,300 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - d6db2d1e-6efb-4386-bf16-352ade172e37-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00de089e-45f1-4834-8b60-7170550edf66/ratis/ff27c0a3-314c-4a71-9fb9-bcadac79283c/current/log_inprogress_0
2019-06-18 12:37:14,254 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 2187051072999086977 is closed with bcsId 0.
2019-06-18 12:37:14,255 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 12:37:14,255 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - d6db2d1e-6efb-4386-bf16-352ade172e37: close
2019-06-18 12:37:14,256 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - d6db2d1e-6efb-4386-bf16-352ade172e37: shutdown group-BCADAC79283C
2019-06-18 12:37:14,256 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-BCADAC79283C,id=d6db2d1e-6efb-4386-bf16-352ade172e37
2019-06-18 12:37:14,256 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - d6db2d1e-6efb-4386-bf16-352ade172e37: shutdown LeaderState
2019-06-18 12:37:14,256 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - d6db2d1e-6efb-4386-bf16-352ade172e37-PendingRequests: sendNotLeaderResponses
2019-06-18 12:37:14,258 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-d6db2d1e-6efb-4386-bf16-352ade172e37-group-BCADAC79283C: set stopIndex = 4
2019-06-18 12:37:14,258 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-18 12:37:14,258 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00de089e-45f1-4834-8b60-7170550edf66/ratis/ff27c0a3-314c-4a71-9fb9-bcadac79283c/sm/snapshot.1_4
2019-06-18 12:37:14,258 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - d6db2d1e-6efb-4386-bf16-352ade172e37:group-BCADAC79283C closes. The last applied log index is 4
2019-06-18 12:37:14,261 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - d6db2d1e-6efb-4386-bf16-352ade172e37-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 12:37:14,262 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - d6db2d1e-6efb-4386-bf16-352ade172e37-RaftLogWorker close()
2019-06-18 12:37:14,263 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - d6db2d1e-6efb-4386-bf16-352ade172e37: shutdown server with port 40953 now
2019-06-18 12:37:14,264 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - d6db2d1e-6efb-4386-bf16-352ade172e37: shutdown server with port 40953 successfully
2019-06-18 12:37:14,268 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
