2019-06-15 13:10:50,647 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-15 13:10:50,748 INFO  ozone.RatisTestHelper (RatisTestHelper.java:initRatisConf(109)) - dfs.container.ratis.rpc.type = GRPC
2019-06-15 13:10:50,805 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-15 13:10:50,814 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 40105 (custom)
2019-06-15 13:10:50,814 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-15 13:10:50,817 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 13:10:50,818 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-15 13:10:50,819 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-15 13:10:50,868 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e] (custom)
2019-06-15 13:10:50,873 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e at port 40105
2019-06-15 13:10:50,893 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e: start RPC server
2019-06-15 13:10:50,895 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e: GrpcService started, listening on 0.0.0.0/0.0.0.0:40105
2019-06-15 13:10:50,959 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e: addNew group-8B7566EFDCB7:[cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e:0.0.0.0:40105] returns group-8B7566EFDCB7:java.util.concurrent.CompletableFuture@2d8f8979[Not completed]
2019-06-15 13:10:50,965 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e: new RaftServerImpl for group-8B7566EFDCB7:[cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e:0.0.0.0:40105] with ContainerStateMachine:uninitialized
2019-06-15 13:10:50,966 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-15 13:10:50,967 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-15 13:10:50,967 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-15 13:10:50,968 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-15 13:10:50,972 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e:group-8B7566EFDCB7 ConfigurationManager, init=-1: [cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e:0.0.0.0:40105], old=null, confs=<EMPTY_MAP>
2019-06-15 13:10:50,973 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e] (custom)
2019-06-15 13:10:50,978 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e/e5d482ed-ec04-4aef-b503-8b7566efdcb7 does not exist. Creating ...
2019-06-15 13:10:50,985 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e/e5d482ed-ec04-4aef-b503-8b7566efdcb7/in_use.lock acquired by nodename 29674@ozone-unit-076618677d3-6whwr-2921122196
2019-06-15 13:10:50,992 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e/e5d482ed-ec04-4aef-b503-8b7566efdcb7 has been successfully formatted.
2019-06-15 13:10:50,993 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-15 13:10:50,993 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-15 13:10:50,995 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-15 13:10:50,996 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 13:10:50,999 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 13:10:51,002 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-15 13:10:51,005 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e/e5d482ed-ec04-4aef-b503-8b7566efdcb7
2019-06-15 13:10:51,005 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-15 13:10:51,006 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-15 13:10:51,008 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 13:10:51,008 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-15 13:10:51,008 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-15 13:10:51,009 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-15 13:10:51,010 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-15 13:10:51,010 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-15 13:10:51,010 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-15 13:10:51,012 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-15 13:10:51,017 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-15 13:10:51,018 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-15 13:10:51,018 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-15 13:10:51,030 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e: start group-8B7566EFDCB7
2019-06-15 13:10:51,031 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e:group-8B7566EFDCB7 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-15 13:10:51,032 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e: start FollowerState
2019-06-15 13:10:51,075 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-8B7566EFDCB7,id=cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e
2019-06-15 13:10:51,128 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-331828A22DB0->cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e: receive RaftClientReply:client-331828A22DB0->cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e@group-8B7566EFDCB7, cid=1, FAILED org.apache.ratis.protocol.NotLeaderException: Server cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e is not the leader (null). Request must be sent to leader., logIndex=0, commits[cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e:c-1]
2019-06-15 13:10:52,102 INFO  impl.FollowerState (FollowerState.java:run(101)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e:group-8B7566EFDCB7 changes to CANDIDATE, lastRpcTime:1069, electionTimeout:1069ms
2019-06-15 13:10:52,102 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e: shutdown FollowerState
2019-06-15 13:10:52,102 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e:group-8B7566EFDCB7 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-15 13:10:52,103 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e: start LeaderElection
2019-06-15 13:10:52,107 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e:group-8B7566EFDCB7:LeaderElection1: begin an election at term 1 for -1: [cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e:0.0.0.0:40105], old=null
2019-06-15 13:10:52,108 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e: shutdown LeaderElection
2019-06-15 13:10:52,108 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e:group-8B7566EFDCB7 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-15 13:10:52,108 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e:group-8B7566EFDCB7 change Leader from null to cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e at term 1 for becomeLeader, leader elected after 1115ms
2019-06-15 13:10:52,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-15 13:10:52,112 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-15 13:10:52,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-15 13:10:52,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-15 13:10:52,121 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e: start LeaderState
2019-06-15 13:10:52,135 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e-RaftLogWorker: Starting segment from index:0
2019-06-15 13:10:52,162 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e:group-8B7566EFDCB7 set configuration 0: [cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e:0.0.0.0:40105], old=null at 0
2019-06-15 13:10:52,280 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e/e5d482ed-ec04-4aef-b503-8b7566efdcb7/current/log_inprogress_0
2019-06-15 13:10:53,186 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-15 13:10:53,190 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-331828A22DB0->cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e: receive RaftClientReply:client-331828A22DB0->cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e@group-8B7566EFDCB7, cid=1, SUCCESS, logIndex=1, commits[cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e:c2]
2019-06-15 13:10:53,191 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-15 13:10:53,208 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-85878223BF69->cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e: receive RaftClientReply:client-85878223BF69->cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e@group-8B7566EFDCB7, cid=2, SUCCESS, logIndex=3, commits[cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e:c3]
2019-06-15 13:10:53,214 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e: close
2019-06-15 13:10:53,214 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-15 13:10:53,215 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e: shutdown group-8B7566EFDCB7
2019-06-15 13:10:53,215 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-8B7566EFDCB7,id=cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e
2019-06-15 13:10:53,216 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e: shutdown LeaderState
2019-06-15 13:10:53,216 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e-PendingRequests: sendNotLeaderResponses
2019-06-15 13:10:53,219 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-15 13:10:53,219 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e/e5d482ed-ec04-4aef-b503-8b7566efdcb7/sm/snapshot.1_4
2019-06-15 13:10:53,220 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e-group-8B7566EFDCB7: set stopIndex = 4
2019-06-15 13:10:53,226 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e:group-8B7566EFDCB7 closes. The last applied log index is 4
2019-06-15 13:10:53,227 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-15 13:10:53,227 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e-RaftLogWorker close()
2019-06-15 13:10:53,228 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e: shutdown server with port 40105 now
2019-06-15 13:10:53,230 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - cd4e6bc6-ee0a-41e6-8c13-24ae68f0981e: shutdown server with port 40105 successfully
2019-06-15 13:10:53,259 INFO  ozone.RatisTestHelper (RatisTestHelper.java:initRatisConf(109)) - dfs.container.ratis.rpc.type = GRPC
2019-06-15 13:10:53,260 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-15 13:10:53,261 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 36087 (custom)
2019-06-15 13:10:53,261 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-15 13:10:53,261 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 13:10:53,261 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-15 13:10:53,262 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-15 13:10:53,262 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/cc14cce1-1149-4f4e-b439-0775b865a35a] (custom)
2019-06-15 13:10:53,263 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis cc14cce1-1149-4f4e-b439-0775b865a35a at port 36087
2019-06-15 13:10:53,271 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - cc14cce1-1149-4f4e-b439-0775b865a35a: start RPC server
2019-06-15 13:10:53,272 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - cc14cce1-1149-4f4e-b439-0775b865a35a: GrpcService started, listening on 0.0.0.0/0.0.0.0:36087
Jun 15, 2019 1:10:53 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=17, target=0.0.0.0:40105} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:130)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 15, 2019 1:10:53 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=9, target=0.0.0.0:40099} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connectToDatanode(XceiverClientGrpc.java:163)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connect(XceiverClientGrpc.java:120)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:227)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServer(TestSecureContainerServer.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-15 13:10:53,347 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - cc14cce1-1149-4f4e-b439-0775b865a35a: addNew group-BB0E68D0F15C:[af7a0a0b-01d6-45c4-ad5f-4c763c50e031:0.0.0.0:42369, 458aa990-6a4c-437f-ad52-3a7c1a1775fe:0.0.0.0:33751, cc14cce1-1149-4f4e-b439-0775b865a35a:0.0.0.0:36087] returns group-BB0E68D0F15C:java.util.concurrent.CompletableFuture@1c946b60[Not completed]
2019-06-15 13:10:53,348 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - cc14cce1-1149-4f4e-b439-0775b865a35a: new RaftServerImpl for group-BB0E68D0F15C:[af7a0a0b-01d6-45c4-ad5f-4c763c50e031:0.0.0.0:42369, 458aa990-6a4c-437f-ad52-3a7c1a1775fe:0.0.0.0:33751, cc14cce1-1149-4f4e-b439-0775b865a35a:0.0.0.0:36087] with ContainerStateMachine:uninitialized
2019-06-15 13:10:53,348 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-15 13:10:53,348 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-15 13:10:53,348 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-15 13:10:53,348 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-15 13:10:53,349 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - cc14cce1-1149-4f4e-b439-0775b865a35a:group-BB0E68D0F15C ConfigurationManager, init=-1: [af7a0a0b-01d6-45c4-ad5f-4c763c50e031:0.0.0.0:42369, 458aa990-6a4c-437f-ad52-3a7c1a1775fe:0.0.0.0:33751, cc14cce1-1149-4f4e-b439-0775b865a35a:0.0.0.0:36087], old=null, confs=<EMPTY_MAP>
2019-06-15 13:10:53,349 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/cc14cce1-1149-4f4e-b439-0775b865a35a] (custom)
2019-06-15 13:10:53,349 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/cc14cce1-1149-4f4e-b439-0775b865a35a/5c96ef3b-75ce-4a12-97d2-bb0e68d0f15c does not exist. Creating ...
2019-06-15 13:10:53,352 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/cc14cce1-1149-4f4e-b439-0775b865a35a/5c96ef3b-75ce-4a12-97d2-bb0e68d0f15c/in_use.lock acquired by nodename 29674@ozone-unit-076618677d3-6whwr-2921122196
2019-06-15 13:10:53,354 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/cc14cce1-1149-4f4e-b439-0775b865a35a/5c96ef3b-75ce-4a12-97d2-bb0e68d0f15c has been successfully formatted.
2019-06-15 13:10:53,354 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-15 13:10:53,354 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-15 13:10:53,354 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-15 13:10:53,354 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 13:10:53,355 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 13:10:53,355 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-15 13:10:53,355 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new cc14cce1-1149-4f4e-b439-0775b865a35a-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/cc14cce1-1149-4f4e-b439-0775b865a35a/5c96ef3b-75ce-4a12-97d2-bb0e68d0f15c
2019-06-15 13:10:53,355 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-15 13:10:53,355 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-15 13:10:53,355 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 13:10:53,356 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-15 13:10:53,356 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-15 13:10:53,356 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-15 13:10:53,356 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-15 13:10:53,356 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-15 13:10:53,356 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-15 13:10:53,356 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-15 13:10:53,357 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-15 13:10:53,357 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-15 13:10:53,357 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-15 13:10:53,358 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - cc14cce1-1149-4f4e-b439-0775b865a35a: start group-BB0E68D0F15C
2019-06-15 13:10:53,358 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cc14cce1-1149-4f4e-b439-0775b865a35a:group-BB0E68D0F15C changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-15 13:10:53,358 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cc14cce1-1149-4f4e-b439-0775b865a35a: start FollowerState
2019-06-15 13:10:53,359 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-BB0E68D0F15C,id=cc14cce1-1149-4f4e-b439-0775b865a35a
2019-06-15 13:10:53,366 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-15 13:10:53,366 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 33751 (custom)
2019-06-15 13:10:53,366 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-15 13:10:53,367 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 13:10:53,367 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-15 13:10:53,367 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-15 13:10:53,368 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/458aa990-6a4c-437f-ad52-3a7c1a1775fe] (custom)
2019-06-15 13:10:53,368 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 458aa990-6a4c-437f-ad52-3a7c1a1775fe at port 33751
2019-06-15 13:10:53,375 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe: start RPC server
2019-06-15 13:10:53,376 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe: GrpcService started, listening on 0.0.0.0/0.0.0.0:33751
2019-06-15 13:10:53,393 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe: addNew group-BB0E68D0F15C:[af7a0a0b-01d6-45c4-ad5f-4c763c50e031:0.0.0.0:42369, 458aa990-6a4c-437f-ad52-3a7c1a1775fe:0.0.0.0:33751, cc14cce1-1149-4f4e-b439-0775b865a35a:0.0.0.0:36087] returns group-BB0E68D0F15C:java.util.concurrent.CompletableFuture@5530aea9[Not completed]
2019-06-15 13:10:53,394 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe: new RaftServerImpl for group-BB0E68D0F15C:[af7a0a0b-01d6-45c4-ad5f-4c763c50e031:0.0.0.0:42369, 458aa990-6a4c-437f-ad52-3a7c1a1775fe:0.0.0.0:33751, cc14cce1-1149-4f4e-b439-0775b865a35a:0.0.0.0:36087] with ContainerStateMachine:uninitialized
2019-06-15 13:10:53,394 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-15 13:10:53,394 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-15 13:10:53,394 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-15 13:10:53,394 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-15 13:10:53,394 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe:group-BB0E68D0F15C ConfigurationManager, init=-1: [af7a0a0b-01d6-45c4-ad5f-4c763c50e031:0.0.0.0:42369, 458aa990-6a4c-437f-ad52-3a7c1a1775fe:0.0.0.0:33751, cc14cce1-1149-4f4e-b439-0775b865a35a:0.0.0.0:36087], old=null, confs=<EMPTY_MAP>
2019-06-15 13:10:53,395 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/458aa990-6a4c-437f-ad52-3a7c1a1775fe] (custom)
2019-06-15 13:10:53,395 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/458aa990-6a4c-437f-ad52-3a7c1a1775fe/5c96ef3b-75ce-4a12-97d2-bb0e68d0f15c does not exist. Creating ...
2019-06-15 13:10:53,397 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/458aa990-6a4c-437f-ad52-3a7c1a1775fe/5c96ef3b-75ce-4a12-97d2-bb0e68d0f15c/in_use.lock acquired by nodename 29674@ozone-unit-076618677d3-6whwr-2921122196
2019-06-15 13:10:53,399 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/458aa990-6a4c-437f-ad52-3a7c1a1775fe/5c96ef3b-75ce-4a12-97d2-bb0e68d0f15c has been successfully formatted.
2019-06-15 13:10:53,399 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-15 13:10:53,399 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-15 13:10:53,399 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-15 13:10:53,399 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 13:10:53,400 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 13:10:53,400 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-15 13:10:53,400 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 458aa990-6a4c-437f-ad52-3a7c1a1775fe-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/458aa990-6a4c-437f-ad52-3a7c1a1775fe/5c96ef3b-75ce-4a12-97d2-bb0e68d0f15c
2019-06-15 13:10:53,400 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-15 13:10:53,400 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-15 13:10:53,400 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 13:10:53,400 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-15 13:10:53,400 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-15 13:10:53,400 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-15 13:10:53,400 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-15 13:10:53,401 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-15 13:10:53,401 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-15 13:10:53,401 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-15 13:10:53,401 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-15 13:10:53,401 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-15 13:10:53,401 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-15 13:10:53,402 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe: start group-BB0E68D0F15C
2019-06-15 13:10:53,402 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe:group-BB0E68D0F15C changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-15 13:10:53,402 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe: start FollowerState
2019-06-15 13:10:53,402 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-BB0E68D0F15C,id=458aa990-6a4c-437f-ad52-3a7c1a1775fe
2019-06-15 13:10:53,405 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-15 13:10:53,405 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42369 (custom)
2019-06-15 13:10:53,406 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-15 13:10:53,406 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 13:10:53,406 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-15 13:10:53,406 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-15 13:10:53,407 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/af7a0a0b-01d6-45c4-ad5f-4c763c50e031] (custom)
2019-06-15 13:10:53,407 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis af7a0a0b-01d6-45c4-ad5f-4c763c50e031 at port 42369
2019-06-15 13:10:53,413 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031: start RPC server
2019-06-15 13:10:53,414 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031: GrpcService started, listening on 0.0.0.0/0.0.0.0:42369
2019-06-15 13:10:53,434 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031: addNew group-BB0E68D0F15C:[af7a0a0b-01d6-45c4-ad5f-4c763c50e031:0.0.0.0:42369, 458aa990-6a4c-437f-ad52-3a7c1a1775fe:0.0.0.0:33751, cc14cce1-1149-4f4e-b439-0775b865a35a:0.0.0.0:36087] returns group-BB0E68D0F15C:java.util.concurrent.CompletableFuture@49928467[Not completed]
2019-06-15 13:10:53,439 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031: new RaftServerImpl for group-BB0E68D0F15C:[af7a0a0b-01d6-45c4-ad5f-4c763c50e031:0.0.0.0:42369, 458aa990-6a4c-437f-ad52-3a7c1a1775fe:0.0.0.0:33751, cc14cce1-1149-4f4e-b439-0775b865a35a:0.0.0.0:36087] with ContainerStateMachine:uninitialized
2019-06-15 13:10:53,439 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-15 13:10:53,439 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-15 13:10:53,439 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-15 13:10:53,440 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-15 13:10:53,440 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031:group-BB0E68D0F15C ConfigurationManager, init=-1: [af7a0a0b-01d6-45c4-ad5f-4c763c50e031:0.0.0.0:42369, 458aa990-6a4c-437f-ad52-3a7c1a1775fe:0.0.0.0:33751, cc14cce1-1149-4f4e-b439-0775b865a35a:0.0.0.0:36087], old=null, confs=<EMPTY_MAP>
2019-06-15 13:10:53,440 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/af7a0a0b-01d6-45c4-ad5f-4c763c50e031] (custom)
2019-06-15 13:10:53,440 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/af7a0a0b-01d6-45c4-ad5f-4c763c50e031/5c96ef3b-75ce-4a12-97d2-bb0e68d0f15c does not exist. Creating ...
2019-06-15 13:10:53,442 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/af7a0a0b-01d6-45c4-ad5f-4c763c50e031/5c96ef3b-75ce-4a12-97d2-bb0e68d0f15c/in_use.lock acquired by nodename 29674@ozone-unit-076618677d3-6whwr-2921122196
2019-06-15 13:10:53,444 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/af7a0a0b-01d6-45c4-ad5f-4c763c50e031/5c96ef3b-75ce-4a12-97d2-bb0e68d0f15c has been successfully formatted.
2019-06-15 13:10:53,445 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-15 13:10:53,445 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-15 13:10:53,445 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-15 13:10:53,445 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 13:10:53,445 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 13:10:53,445 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-15 13:10:53,445 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new af7a0a0b-01d6-45c4-ad5f-4c763c50e031-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/af7a0a0b-01d6-45c4-ad5f-4c763c50e031/5c96ef3b-75ce-4a12-97d2-bb0e68d0f15c
2019-06-15 13:10:53,445 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-15 13:10:53,446 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-15 13:10:53,446 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 13:10:53,446 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-15 13:10:53,446 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-15 13:10:53,446 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-15 13:10:53,447 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-15 13:10:53,447 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-15 13:10:53,447 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-15 13:10:53,447 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-15 13:10:53,447 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-15 13:10:53,448 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-15 13:10:53,448 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-15 13:10:53,448 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031: start group-BB0E68D0F15C
2019-06-15 13:10:53,448 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031:group-BB0E68D0F15C changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-15 13:10:53,448 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031: start FollowerState
2019-06-15 13:10:53,448 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-BB0E68D0F15C,id=af7a0a0b-01d6-45c4-ad5f-4c763c50e031
2019-06-15 13:10:53,459 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F3836E2EBAA9->cc14cce1-1149-4f4e-b439-0775b865a35a: receive RaftClientReply:client-F3836E2EBAA9->cc14cce1-1149-4f4e-b439-0775b865a35a@group-BB0E68D0F15C, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server cc14cce1-1149-4f4e-b439-0775b865a35a is not the leader (458aa990-6a4c-437f-ad52-3a7c1a1775fe:0.0.0.0:33751). Request must be sent to leader., logIndex=0, commits[cc14cce1-1149-4f4e-b439-0775b865a35a:c-1]
2019-06-15 13:10:53,462 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-15 13:10:54,367 INFO  impl.FollowerState (FollowerState.java:run(101)) - cc14cce1-1149-4f4e-b439-0775b865a35a:group-BB0E68D0F15C changes to CANDIDATE, lastRpcTime:1009, electionTimeout:1009ms
2019-06-15 13:10:54,368 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - cc14cce1-1149-4f4e-b439-0775b865a35a: shutdown FollowerState
2019-06-15 13:10:54,368 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cc14cce1-1149-4f4e-b439-0775b865a35a:group-BB0E68D0F15C changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-15 13:10:54,368 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cc14cce1-1149-4f4e-b439-0775b865a35a: start LeaderElection
2019-06-15 13:10:54,372 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - cc14cce1-1149-4f4e-b439-0775b865a35a:group-BB0E68D0F15C:LeaderElection2: begin an election at term 1 for -1: [af7a0a0b-01d6-45c4-ad5f-4c763c50e031:0.0.0.0:42369, 458aa990-6a4c-437f-ad52-3a7c1a1775fe:0.0.0.0:33751, cc14cce1-1149-4f4e-b439-0775b865a35a:0.0.0.0:36087], old=null
2019-06-15 13:10:54,388 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031:group-BB0E68D0F15C changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:cc14cce1-1149-4f4e-b439-0775b865a35a
2019-06-15 13:10:54,388 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe:group-BB0E68D0F15C changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:cc14cce1-1149-4f4e-b439-0775b865a35a
2019-06-15 13:10:54,388 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031: shutdown FollowerState
2019-06-15 13:10:54,388 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe: shutdown FollowerState
2019-06-15 13:10:54,389 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe: start FollowerState
2019-06-15 13:10:54,388 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031: start FollowerState
2019-06-15 13:10:54,389 INFO  impl.FollowerState (FollowerState.java:run(109)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-15 13:10:54,389 INFO  impl.FollowerState (FollowerState.java:run(109)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-15 13:10:54,397 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - cc14cce1-1149-4f4e-b439-0775b865a35a:group-BB0E68D0F15C:LeaderElection2: Election PASSED; received 1 response(s) [cc14cce1-1149-4f4e-b439-0775b865a35a->af7a0a0b-01d6-45c4-ad5f-4c763c50e031,true-t1] and 0 exception(s); cc14cce1-1149-4f4e-b439-0775b865a35a:t1, leader=null, voted=cc14cce1-1149-4f4e-b439-0775b865a35a, raftlog=cc14cce1-1149-4f4e-b439-0775b865a35a-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [af7a0a0b-01d6-45c4-ad5f-4c763c50e031:0.0.0.0:42369, 458aa990-6a4c-437f-ad52-3a7c1a1775fe:0.0.0.0:33751, cc14cce1-1149-4f4e-b439-0775b865a35a:0.0.0.0:36087], old=null
2019-06-15 13:10:54,397 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - cc14cce1-1149-4f4e-b439-0775b865a35a: shutdown LeaderElection
2019-06-15 13:10:54,401 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - cc14cce1-1149-4f4e-b439-0775b865a35a:group-BB0E68D0F15C changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-15 13:10:54,401 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - cc14cce1-1149-4f4e-b439-0775b865a35a:group-BB0E68D0F15C change Leader from null to cc14cce1-1149-4f4e-b439-0775b865a35a at term 1 for becomeLeader, leader elected after 1046ms
2019-06-15 13:10:54,401 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-15 13:10:54,401 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-15 13:10:54,401 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-15 13:10:54,402 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-15 13:10:54,404 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-15 13:10:54,404 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 13:10:54,404 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-15 13:10:54,406 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-15 13:10:54,406 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-15 13:10:54,406 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-15 13:10:54,406 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-15 13:10:54,406 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 13:10:54,407 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-15 13:10:54,407 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-15 13:10:54,407 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-15 13:10:54,407 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-15 13:10:54,407 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - cc14cce1-1149-4f4e-b439-0775b865a35a: start LeaderState
2019-06-15 13:10:54,408 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - cc14cce1-1149-4f4e-b439-0775b865a35a-RaftLogWorker: Starting segment from index:0
2019-06-15 13:10:54,408 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - cc14cce1-1149-4f4e-b439-0775b865a35a:group-BB0E68D0F15C set configuration 0: [af7a0a0b-01d6-45c4-ad5f-4c763c50e031:0.0.0.0:42369, 458aa990-6a4c-437f-ad52-3a7c1a1775fe:0.0.0.0:33751, cc14cce1-1149-4f4e-b439-0775b865a35a:0.0.0.0:36087], old=null at 0
2019-06-15 13:10:54,447 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - cc14cce1-1149-4f4e-b439-0775b865a35a-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/cc14cce1-1149-4f4e-b439-0775b865a35a/5c96ef3b-75ce-4a12-97d2-bb0e68d0f15c/current/log_inprogress_0
2019-06-15 13:10:54,453 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe:group-BB0E68D0F15C change Leader from null to cc14cce1-1149-4f4e-b439-0775b865a35a at term 1 for appendEntries, leader elected after 1053ms
2019-06-15 13:10:54,453 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031:group-BB0E68D0F15C change Leader from null to cc14cce1-1149-4f4e-b439-0775b865a35a at term 1 for appendEntries, leader elected after 1008ms
2019-06-15 13:10:54,471 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031:group-BB0E68D0F15C set configuration 0: [af7a0a0b-01d6-45c4-ad5f-4c763c50e031:0.0.0.0:42369, 458aa990-6a4c-437f-ad52-3a7c1a1775fe:0.0.0.0:33751, cc14cce1-1149-4f4e-b439-0775b865a35a:0.0.0.0:36087], old=null at 0
2019-06-15 13:10:54,472 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031-RaftLogWorker: Starting segment from index:0
2019-06-15 13:10:54,473 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F3836E2EBAA9->458aa990-6a4c-437f-ad52-3a7c1a1775fe: receive RaftClientReply:client-F3836E2EBAA9->458aa990-6a4c-437f-ad52-3a7c1a1775fe@group-BB0E68D0F15C, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server 458aa990-6a4c-437f-ad52-3a7c1a1775fe is not the leader (cc14cce1-1149-4f4e-b439-0775b865a35a:0.0.0.0:36087). Request must be sent to leader., logIndex=0, commits[458aa990-6a4c-437f-ad52-3a7c1a1775fe:c-1, af7a0a0b-01d6-45c4-ad5f-4c763c50e031:c-1, cc14cce1-1149-4f4e-b439-0775b865a35a:c-1]
2019-06-15 13:10:54,491 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe:group-BB0E68D0F15C set configuration 0: [af7a0a0b-01d6-45c4-ad5f-4c763c50e031:0.0.0.0:42369, 458aa990-6a4c-437f-ad52-3a7c1a1775fe:0.0.0.0:33751, cc14cce1-1149-4f4e-b439-0775b865a35a:0.0.0.0:36087], old=null at 0
2019-06-15 13:10:54,492 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe-RaftLogWorker: Starting segment from index:0
2019-06-15 13:10:54,510 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-15 13:10:54,527 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/af7a0a0b-01d6-45c4-ad5f-4c763c50e031/5c96ef3b-75ce-4a12-97d2-bb0e68d0f15c/current/log_inprogress_0
2019-06-15 13:10:54,550 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/458aa990-6a4c-437f-ad52-3a7c1a1775fe/5c96ef3b-75ce-4a12-97d2-bb0e68d0f15c/current/log_inprogress_0
2019-06-15 13:10:55,500 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F3836E2EBAA9->af7a0a0b-01d6-45c4-ad5f-4c763c50e031: receive RaftClientReply:client-F3836E2EBAA9->af7a0a0b-01d6-45c4-ad5f-4c763c50e031@group-BB0E68D0F15C, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server af7a0a0b-01d6-45c4-ad5f-4c763c50e031 is not the leader (cc14cce1-1149-4f4e-b439-0775b865a35a:0.0.0.0:36087). Request must be sent to leader., logIndex=0, commits[af7a0a0b-01d6-45c4-ad5f-4c763c50e031:c0, 458aa990-6a4c-437f-ad52-3a7c1a1775fe:c0, cc14cce1-1149-4f4e-b439-0775b865a35a:c0]
2019-06-15 13:10:55,502 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-15 13:10:56,509 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F3836E2EBAA9->458aa990-6a4c-437f-ad52-3a7c1a1775fe: receive RaftClientReply:client-F3836E2EBAA9->458aa990-6a4c-437f-ad52-3a7c1a1775fe@group-BB0E68D0F15C, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server 458aa990-6a4c-437f-ad52-3a7c1a1775fe is not the leader (cc14cce1-1149-4f4e-b439-0775b865a35a:0.0.0.0:36087). Request must be sent to leader., logIndex=0, commits[458aa990-6a4c-437f-ad52-3a7c1a1775fe:c0, af7a0a0b-01d6-45c4-ad5f-4c763c50e031:c0, cc14cce1-1149-4f4e-b439-0775b865a35a:c0]
2019-06-15 13:10:56,511 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-15 13:10:57,519 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F3836E2EBAA9->af7a0a0b-01d6-45c4-ad5f-4c763c50e031: receive RaftClientReply:client-F3836E2EBAA9->af7a0a0b-01d6-45c4-ad5f-4c763c50e031@group-BB0E68D0F15C, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server af7a0a0b-01d6-45c4-ad5f-4c763c50e031 is not the leader (cc14cce1-1149-4f4e-b439-0775b865a35a:0.0.0.0:36087). Request must be sent to leader., logIndex=0, commits[af7a0a0b-01d6-45c4-ad5f-4c763c50e031:c0, 458aa990-6a4c-437f-ad52-3a7c1a1775fe:c0, cc14cce1-1149-4f4e-b439-0775b865a35a:c0]
2019-06-15 13:10:57,521 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-15 13:10:58,528 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F3836E2EBAA9->458aa990-6a4c-437f-ad52-3a7c1a1775fe: receive RaftClientReply:client-F3836E2EBAA9->458aa990-6a4c-437f-ad52-3a7c1a1775fe@group-BB0E68D0F15C, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server 458aa990-6a4c-437f-ad52-3a7c1a1775fe is not the leader (cc14cce1-1149-4f4e-b439-0775b865a35a:0.0.0.0:36087). Request must be sent to leader., logIndex=0, commits[458aa990-6a4c-437f-ad52-3a7c1a1775fe:c0, af7a0a0b-01d6-45c4-ad5f-4c763c50e031:c0, cc14cce1-1149-4f4e-b439-0775b865a35a:c0]
2019-06-15 13:10:58,531 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 2-OrderedRequestStreamObserver2: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-15 13:10:59,539 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F3836E2EBAA9->af7a0a0b-01d6-45c4-ad5f-4c763c50e031: receive RaftClientReply:client-F3836E2EBAA9->af7a0a0b-01d6-45c4-ad5f-4c763c50e031@group-BB0E68D0F15C, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server af7a0a0b-01d6-45c4-ad5f-4c763c50e031 is not the leader (cc14cce1-1149-4f4e-b439-0775b865a35a:0.0.0.0:36087). Request must be sent to leader., logIndex=0, commits[af7a0a0b-01d6-45c4-ad5f-4c763c50e031:c0, 458aa990-6a4c-437f-ad52-3a7c1a1775fe:c0, cc14cce1-1149-4f4e-b439-0775b865a35a:c0]
2019-06-15 13:10:59,541 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 2-OrderedRequestStreamObserver2: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-15 13:11:00,548 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F3836E2EBAA9->458aa990-6a4c-437f-ad52-3a7c1a1775fe: receive RaftClientReply:client-F3836E2EBAA9->458aa990-6a4c-437f-ad52-3a7c1a1775fe@group-BB0E68D0F15C, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server 458aa990-6a4c-437f-ad52-3a7c1a1775fe is not the leader (cc14cce1-1149-4f4e-b439-0775b865a35a:0.0.0.0:36087). Request must be sent to leader., logIndex=0, commits[458aa990-6a4c-437f-ad52-3a7c1a1775fe:c0, af7a0a0b-01d6-45c4-ad5f-4c763c50e031:c0, cc14cce1-1149-4f4e-b439-0775b865a35a:c0]
2019-06-15 13:11:00,551 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 3-OrderedRequestStreamObserver3: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-15 13:11:01,556 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F3836E2EBAA9->af7a0a0b-01d6-45c4-ad5f-4c763c50e031: receive RaftClientReply:client-F3836E2EBAA9->af7a0a0b-01d6-45c4-ad5f-4c763c50e031@group-BB0E68D0F15C, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server af7a0a0b-01d6-45c4-ad5f-4c763c50e031 is not the leader (cc14cce1-1149-4f4e-b439-0775b865a35a:0.0.0.0:36087). Request must be sent to leader., logIndex=0, commits[af7a0a0b-01d6-45c4-ad5f-4c763c50e031:c0, 458aa990-6a4c-437f-ad52-3a7c1a1775fe:c0, cc14cce1-1149-4f4e-b439-0775b865a35a:c0]
2019-06-15 13:11:01,558 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 3-OrderedRequestStreamObserver3: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-15 13:11:02,564 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F3836E2EBAA9->458aa990-6a4c-437f-ad52-3a7c1a1775fe: receive RaftClientReply:client-F3836E2EBAA9->458aa990-6a4c-437f-ad52-3a7c1a1775fe@group-BB0E68D0F15C, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server 458aa990-6a4c-437f-ad52-3a7c1a1775fe is not the leader (cc14cce1-1149-4f4e-b439-0775b865a35a:0.0.0.0:36087). Request must be sent to leader., logIndex=0, commits[458aa990-6a4c-437f-ad52-3a7c1a1775fe:c0, af7a0a0b-01d6-45c4-ad5f-4c763c50e031:c0, cc14cce1-1149-4f4e-b439-0775b865a35a:c0]
2019-06-15 13:11:02,567 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 4-OrderedRequestStreamObserver4: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-15 13:11:03,576 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-15 13:11:03,579 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-F3836E2EBAA9->cc14cce1-1149-4f4e-b439-0775b865a35a: receive RaftClientReply:client-F3836E2EBAA9->cc14cce1-1149-4f4e-b439-0775b865a35a@group-BB0E68D0F15C, cid=6, SUCCESS, logIndex=1, commits[cc14cce1-1149-4f4e-b439-0775b865a35a:c1, af7a0a0b-01d6-45c4-ad5f-4c763c50e031:c0, 458aa990-6a4c-437f-ad52-3a7c1a1775fe:c0]
2019-06-15 13:11:03,580 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-15 13:11:03,582 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-15 13:11:03,587 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-15 13:11:03,597 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-9FD14240B796->cc14cce1-1149-4f4e-b439-0775b865a35a: receive RaftClientReply:client-9FD14240B796->cc14cce1-1149-4f4e-b439-0775b865a35a@group-BB0E68D0F15C, cid=7, SUCCESS, logIndex=3, commits[cc14cce1-1149-4f4e-b439-0775b865a35a:c3, af7a0a0b-01d6-45c4-ad5f-4c763c50e031:c2, 458aa990-6a4c-437f-ad52-3a7c1a1775fe:c1]
2019-06-15 13:11:03,600 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - cc14cce1-1149-4f4e-b439-0775b865a35a: close
2019-06-15 13:11:03,600 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - cc14cce1-1149-4f4e-b439-0775b865a35a: shutdown group-BB0E68D0F15C
2019-06-15 13:11:03,601 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-BB0E68D0F15C,id=cc14cce1-1149-4f4e-b439-0775b865a35a
2019-06-15 13:11:03,601 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - cc14cce1-1149-4f4e-b439-0775b865a35a: shutdown LeaderState
2019-06-15 13:11:03,601 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - cc14cce1-1149-4f4e-b439-0775b865a35a-PendingRequests: sendNotLeaderResponses
2019-06-15 13:11:03,603 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(cc14cce1-1149-4f4e-b439-0775b865a35a -> 458aa990-6a4c-437f-ad52-3a7c1a1775fe): Wait interrupted by java.lang.InterruptedException
2019-06-15 13:11:03,603 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(cc14cce1-1149-4f4e-b439-0775b865a35a -> af7a0a0b-01d6-45c4-ad5f-4c763c50e031): Wait interrupted by java.lang.InterruptedException
2019-06-15 13:11:03,604 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-cc14cce1-1149-4f4e-b439-0775b865a35a-group-BB0E68D0F15C: set stopIndex = 4
2019-06-15 13:11:03,604 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-15 13:11:03,605 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/cc14cce1-1149-4f4e-b439-0775b865a35a/5c96ef3b-75ce-4a12-97d2-bb0e68d0f15c/sm/snapshot.1_3
2019-06-15 13:11:03,605 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe: appendEntries completed
2019-06-15 13:11:03,605 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - cc14cce1-1149-4f4e-b439-0775b865a35a: follower cc14cce1-1149-4f4e-b439-0775b865a35a->458aa990-6a4c-437f-ad52-3a7c1a1775fe(c3,m4,n5, attendVote=true, lastRpcSendTime=12, lastRpcResponseTime=8) response Completed
2019-06-15 13:11:03,612 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031: appendEntries completed
2019-06-15 13:11:03,613 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - cc14cce1-1149-4f4e-b439-0775b865a35a->458aa990-6a4c-437f-ad52-3a7c1a1775fe: nextIndex: updateUnconditionally 5 -> 0
2019-06-15 13:11:03,613 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - cc14cce1-1149-4f4e-b439-0775b865a35a:group-BB0E68D0F15C closes. The last applied log index is 4
2019-06-15 13:11:03,613 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - cc14cce1-1149-4f4e-b439-0775b865a35a: follower cc14cce1-1149-4f4e-b439-0775b865a35a->af7a0a0b-01d6-45c4-ad5f-4c763c50e031(c3,m4,n5, attendVote=true, lastRpcSendTime=20, lastRpcResponseTime=16) response Completed
2019-06-15 13:11:03,614 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - cc14cce1-1149-4f4e-b439-0775b865a35a-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-15 13:11:03,615 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - cc14cce1-1149-4f4e-b439-0775b865a35a->af7a0a0b-01d6-45c4-ad5f-4c763c50e031: nextIndex: updateUnconditionally 5 -> -1
2019-06-15 13:11:03,615 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - cc14cce1-1149-4f4e-b439-0775b865a35a-RaftLogWorker close()
2019-06-15 13:11:03,616 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - cc14cce1-1149-4f4e-b439-0775b865a35a: shutdown server with port 36087 now
2019-06-15 13:11:03,618 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - cc14cce1-1149-4f4e-b439-0775b865a35a: shutdown server with port 36087 successfully
2019-06-15 13:11:03,619 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe: close
2019-06-15 13:11:03,620 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe: shutdown group-BB0E68D0F15C
2019-06-15 13:11:03,620 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-BB0E68D0F15C,id=458aa990-6a4c-437f-ad52-3a7c1a1775fe
2019-06-15 13:11:03,620 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe: shutdown FollowerState
2019-06-15 13:11:03,621 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-15 13:11:03,621 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/458aa990-6a4c-437f-ad52-3a7c1a1775fe/5c96ef3b-75ce-4a12-97d2-bb0e68d0f15c/sm/snapshot.1_3
2019-06-15 13:11:03,621 INFO  impl.FollowerState (FollowerState.java:run(109)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-15 13:11:03,622 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-458aa990-6a4c-437f-ad52-3a7c1a1775fe-group-BB0E68D0F15C: set stopIndex = 3
2019-06-15 13:11:03,622 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe:group-BB0E68D0F15C closes. The last applied log index is 3
2019-06-15 13:11:03,623 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-15 13:11:03,625 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe-RaftLogWorker close()
2019-06-15 13:11:03,626 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe: shutdown server with port 33751 now
2019-06-15 13:11:03,626 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 458aa990-6a4c-437f-ad52-3a7c1a1775fe: shutdown server with port 33751 successfully
2019-06-15 13:11:03,628 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031: close
2019-06-15 13:11:03,629 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031: shutdown group-BB0E68D0F15C
2019-06-15 13:11:03,629 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-BB0E68D0F15C,id=af7a0a0b-01d6-45c4-ad5f-4c763c50e031
2019-06-15 13:11:03,630 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031: shutdown FollowerState
2019-06-15 13:11:03,630 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-af7a0a0b-01d6-45c4-ad5f-4c763c50e031-group-BB0E68D0F15C: set stopIndex = 3
2019-06-15 13:11:03,630 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-15 13:11:03,631 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/af7a0a0b-01d6-45c4-ad5f-4c763c50e031/5c96ef3b-75ce-4a12-97d2-bb0e68d0f15c/sm/snapshot.1_3
2019-06-15 13:11:03,631 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031:group-BB0E68D0F15C closes. The last applied log index is 3
2019-06-15 13:11:03,631 INFO  impl.FollowerState (FollowerState.java:run(109)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-15 13:11:03,632 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-15 13:11:03,632 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031-RaftLogWorker close()
2019-06-15 13:11:03,633 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031: shutdown server with port 42369 now
2019-06-15 13:11:03,633 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - af7a0a0b-01d6-45c4-ad5f-4c763c50e031: shutdown server with port 42369 successfully
