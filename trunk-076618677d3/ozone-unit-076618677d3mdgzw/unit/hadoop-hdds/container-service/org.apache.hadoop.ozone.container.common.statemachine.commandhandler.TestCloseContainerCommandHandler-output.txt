2019-06-17 04:34:24,707 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleref54e7b5-0400-4ff7-8630-2d53235a70b5/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 04:34:24,711 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleref54e7b5-0400-4ff7-8630-2d53235a70b5/hdds to VolumeSet
2019-06-17 04:34:24,721 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-17 04:34:24,760 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-17 04:34:25,093 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43305
2019-06-17 04:34:25,498 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 04:34:25,519 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 04:34:25,527 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43305 (custom)
2019-06-17 04:34:25,528 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 04:34:25,530 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 04:34:25,531 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 04:34:25,532 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 04:34:25,649 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleref54e7b5-0400-4ff7-8630-2d53235a70b5/ratis] (custom)
2019-06-17 04:34:25,658 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 36521
2019-06-17 04:34:25,675 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 04:34:25,675 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 04:34:25,676 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 9640afed-ac19-4152-a678-5c66f199b9d6 at port 43305
2019-06-17 04:34:25,686 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 9640afed-ac19-4152-a678-5c66f199b9d6: start RPC server
2019-06-17 04:34:25,799 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 9640afed-ac19-4152-a678-5c66f199b9d6: GrpcService started, listening on 0.0.0.0/0.0.0.0:43305
2019-06-17 04:34:26,067 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 9640afed-ac19-4152-a678-5c66f199b9d6: addNew group-D4152E3EA45A:[9640afed-ac19-4152-a678-5c66f199b9d6:127.0.0.1:43305] returns group-D4152E3EA45A:java.util.concurrent.CompletableFuture@5207c96a[Not completed]
2019-06-17 04:34:26,091 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 9640afed-ac19-4152-a678-5c66f199b9d6: new RaftServerImpl for group-D4152E3EA45A:[9640afed-ac19-4152-a678-5c66f199b9d6:127.0.0.1:43305] with ContainerStateMachine:uninitialized
2019-06-17 04:34:26,092 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 04:34:26,093 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 04:34:26,093 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 04:34:26,093 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 04:34:26,098 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 9640afed-ac19-4152-a678-5c66f199b9d6:group-D4152E3EA45A ConfigurationManager, init=-1: [9640afed-ac19-4152-a678-5c66f199b9d6:127.0.0.1:43305], old=null, confs=<EMPTY_MAP>
2019-06-17 04:34:26,098 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleref54e7b5-0400-4ff7-8630-2d53235a70b5/ratis] (custom)
2019-06-17 04:34:26,103 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleref54e7b5-0400-4ff7-8630-2d53235a70b5/ratis/9f8715dd-0baa-4751-9b40-d4152e3ea45a does not exist. Creating ...
2019-06-17 04:34:26,111 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleref54e7b5-0400-4ff7-8630-2d53235a70b5/ratis/9f8715dd-0baa-4751-9b40-d4152e3ea45a/in_use.lock acquired by nodename 4300@ozone-unit-076618677d3mdgzw-899644134
2019-06-17 04:34:26,117 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleref54e7b5-0400-4ff7-8630-2d53235a70b5/ratis/9f8715dd-0baa-4751-9b40-d4152e3ea45a has been successfully formatted.
2019-06-17 04:34:26,119 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 04:34:26,119 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 04:34:26,121 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 04:34:26,123 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 04:34:26,125 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 04:34:26,128 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 04:34:26,131 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 9640afed-ac19-4152-a678-5c66f199b9d6-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleref54e7b5-0400-4ff7-8630-2d53235a70b5/ratis/9f8715dd-0baa-4751-9b40-d4152e3ea45a
2019-06-17 04:34:26,131 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 04:34:26,132 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 04:34:26,133 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 04:34:26,133 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 04:34:26,134 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 04:34:26,134 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 04:34:26,135 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 04:34:26,135 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 04:34:26,135 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 04:34:26,137 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 04:34:26,141 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 04:34:26,142 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 04:34:26,142 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 04:34:26,233 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 9640afed-ac19-4152-a678-5c66f199b9d6: start group-D4152E3EA45A
2019-06-17 04:34:26,234 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9640afed-ac19-4152-a678-5c66f199b9d6:group-D4152E3EA45A changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 04:34:26,235 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9640afed-ac19-4152-a678-5c66f199b9d6: start FollowerState
2019-06-17 04:34:26,237 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D4152E3EA45A,id=9640afed-ac19-4152-a678-5c66f199b9d6
2019-06-17 04:34:27,319 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9640afed-ac19-4152-a678-5c66f199b9d6:group-D4152E3EA45A changes to CANDIDATE, lastRpcTime:1083, electionTimeout:1083ms
2019-06-17 04:34:27,319 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9640afed-ac19-4152-a678-5c66f199b9d6: shutdown FollowerState
2019-06-17 04:34:27,319 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9640afed-ac19-4152-a678-5c66f199b9d6:group-D4152E3EA45A changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 04:34:27,321 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9640afed-ac19-4152-a678-5c66f199b9d6: start LeaderElection
2019-06-17 04:34:27,323 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9640afed-ac19-4152-a678-5c66f199b9d6:group-D4152E3EA45A:LeaderElection1: begin an election at term 1 for -1: [9640afed-ac19-4152-a678-5c66f199b9d6:127.0.0.1:43305], old=null
2019-06-17 04:34:27,324 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9640afed-ac19-4152-a678-5c66f199b9d6: shutdown LeaderElection
2019-06-17 04:34:27,325 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9640afed-ac19-4152-a678-5c66f199b9d6:group-D4152E3EA45A changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 04:34:27,325 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 9640afed-ac19-4152-a678-5c66f199b9d6:group-D4152E3EA45A change Leader from null to 9640afed-ac19-4152-a678-5c66f199b9d6 at term 1 for becomeLeader, leader elected after 1205ms
2019-06-17 04:34:27,328 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 04:34:27,328 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 04:34:27,330 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 04:34:27,330 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 04:34:27,336 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9640afed-ac19-4152-a678-5c66f199b9d6: start LeaderState
2019-06-17 04:34:27,347 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 9640afed-ac19-4152-a678-5c66f199b9d6-RaftLogWorker: Starting segment from index:0
2019-06-17 04:34:27,354 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 9640afed-ac19-4152-a678-5c66f199b9d6:group-D4152E3EA45A set configuration 0: [9640afed-ac19-4152-a678-5c66f199b9d6:127.0.0.1:43305], old=null at 0
2019-06-17 04:34:27,473 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 9640afed-ac19-4152-a678-5c66f199b9d6-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleref54e7b5-0400-4ff7-8630-2d53235a70b5/ratis/9f8715dd-0baa-4751-9b40-d4152e3ea45a/current/log_inprogress_0
2019-06-17 04:34:28,438 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-17 04:34:28,488 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 2579052584634499616 is closed with bcsId 0.
2019-06-17 04:34:28,489 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 04:34:28,489 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 9640afed-ac19-4152-a678-5c66f199b9d6: close
2019-06-17 04:34:28,491 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 9640afed-ac19-4152-a678-5c66f199b9d6: shutdown group-D4152E3EA45A
2019-06-17 04:34:28,491 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D4152E3EA45A,id=9640afed-ac19-4152-a678-5c66f199b9d6
2019-06-17 04:34:28,491 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 9640afed-ac19-4152-a678-5c66f199b9d6: shutdown LeaderState
2019-06-17 04:34:28,492 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 9640afed-ac19-4152-a678-5c66f199b9d6-PendingRequests: sendNotLeaderResponses
2019-06-17 04:34:28,494 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-9640afed-ac19-4152-a678-5c66f199b9d6-group-D4152E3EA45A: set stopIndex = 4
2019-06-17 04:34:28,494 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 04:34:28,494 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleref54e7b5-0400-4ff7-8630-2d53235a70b5/ratis/9f8715dd-0baa-4751-9b40-d4152e3ea45a/sm/snapshot.1_4
2019-06-17 04:34:28,499 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 9640afed-ac19-4152-a678-5c66f199b9d6:group-D4152E3EA45A closes. The last applied log index is 4
2019-06-17 04:34:28,500 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 9640afed-ac19-4152-a678-5c66f199b9d6-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 04:34:28,501 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 9640afed-ac19-4152-a678-5c66f199b9d6-RaftLogWorker close()
2019-06-17 04:34:28,502 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 9640afed-ac19-4152-a678-5c66f199b9d6: shutdown server with port 43305 now
2019-06-17 04:34:28,505 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 9640afed-ac19-4152-a678-5c66f199b9d6: shutdown server with port 43305 successfully
2019-06-17 04:34:28,512 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 04:34:28,537 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleree4eed8b-6ab2-497c-a551-278010bfcd57/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 04:34:28,538 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleree4eed8b-6ab2-497c-a551-278010bfcd57/hdds to VolumeSet
2019-06-17 04:34:28,538 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@12958360
2019-06-17 04:34:28,539 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@12958360
2019-06-17 04:34:28,552 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 36155
2019-06-17 04:34:28,553 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 04:34:28,553 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 04:34:28,554 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 36155 (custom)
2019-06-17 04:34:28,554 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 04:34:28,554 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 04:34:28,555 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 04:34:28,555 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 04:34:28,556 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleree4eed8b-6ab2-497c-a551-278010bfcd57/ratis] (custom)
2019-06-17 04:34:28,556 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 40205
2019-06-17 04:34:28,557 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 04:34:28,557 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 04:34:28,557 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis bc817dde-6cc8-42f8-9d0f-65bdc0510a4c at port 36155
2019-06-17 04:34:28,578 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c: start RPC server
2019-06-17 04:34:28,580 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c: GrpcService started, listening on 0.0.0.0/0.0.0.0:36155
2019-06-17 04:34:28,591 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c: addNew group-5382E9455A77:[bc817dde-6cc8-42f8-9d0f-65bdc0510a4c:127.0.0.1:36155] returns group-5382E9455A77:java.util.concurrent.CompletableFuture@420bc864[Not completed]
2019-06-17 04:34:28,594 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c: new RaftServerImpl for group-5382E9455A77:[bc817dde-6cc8-42f8-9d0f-65bdc0510a4c:127.0.0.1:36155] with ContainerStateMachine:uninitialized
2019-06-17 04:34:28,595 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 04:34:28,595 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 04:34:28,595 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 04:34:28,595 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 04:34:28,595 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c:group-5382E9455A77 ConfigurationManager, init=-1: [bc817dde-6cc8-42f8-9d0f-65bdc0510a4c:127.0.0.1:36155], old=null, confs=<EMPTY_MAP>
2019-06-17 04:34:28,595 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleree4eed8b-6ab2-497c-a551-278010bfcd57/ratis] (custom)
2019-06-17 04:34:28,596 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleree4eed8b-6ab2-497c-a551-278010bfcd57/ratis/e65d7c23-2305-4e36-b0f7-5382e9455a77 does not exist. Creating ...
2019-06-17 04:34:28,598 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleree4eed8b-6ab2-497c-a551-278010bfcd57/ratis/e65d7c23-2305-4e36-b0f7-5382e9455a77/in_use.lock acquired by nodename 4300@ozone-unit-076618677d3mdgzw-899644134
2019-06-17 04:34:28,600 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleree4eed8b-6ab2-497c-a551-278010bfcd57/ratis/e65d7c23-2305-4e36-b0f7-5382e9455a77 has been successfully formatted.
2019-06-17 04:34:28,601 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 04:34:28,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 04:34:28,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 04:34:28,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 04:34:28,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 04:34:28,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 04:34:28,601 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new bc817dde-6cc8-42f8-9d0f-65bdc0510a4c-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleree4eed8b-6ab2-497c-a551-278010bfcd57/ratis/e65d7c23-2305-4e36-b0f7-5382e9455a77
2019-06-17 04:34:28,602 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 04:34:28,602 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 04:34:28,602 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 04:34:28,602 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 04:34:28,602 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 04:34:28,602 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 04:34:28,602 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 04:34:28,603 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 04:34:28,603 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 04:34:28,603 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 04:34:28,605 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 04:34:28,605 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 04:34:28,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 04:34:28,606 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c: start group-5382E9455A77
2019-06-17 04:34:28,606 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c:group-5382E9455A77 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 04:34:28,606 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c: start FollowerState
2019-06-17 04:34:28,606 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-5382E9455A77,id=bc817dde-6cc8-42f8-9d0f-65bdc0510a4c
2019-06-17 04:34:29,686 INFO  impl.FollowerState (FollowerState.java:run(101)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c:group-5382E9455A77 changes to CANDIDATE, lastRpcTime:1080, electionTimeout:1079ms
2019-06-17 04:34:29,687 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c: shutdown FollowerState
2019-06-17 04:34:29,687 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c:group-5382E9455A77 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 04:34:29,687 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c: start LeaderElection
2019-06-17 04:34:29,690 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c:group-5382E9455A77:LeaderElection2: begin an election at term 1 for -1: [bc817dde-6cc8-42f8-9d0f-65bdc0510a4c:127.0.0.1:36155], old=null
2019-06-17 04:34:29,690 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c: shutdown LeaderElection
2019-06-17 04:34:29,691 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c:group-5382E9455A77 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 04:34:29,691 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c:group-5382E9455A77 change Leader from null to bc817dde-6cc8-42f8-9d0f-65bdc0510a4c at term 1 for becomeLeader, leader elected after 1089ms
2019-06-17 04:34:29,691 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 04:34:29,691 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 04:34:29,691 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 04:34:29,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 04:34:29,692 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c: start LeaderState
2019-06-17 04:34:29,692 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c-RaftLogWorker: Starting segment from index:0
2019-06-17 04:34:29,698 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c:group-5382E9455A77 set configuration 0: [bc817dde-6cc8-42f8-9d0f-65bdc0510a4c:127.0.0.1:36155], old=null at 0
2019-06-17 04:34:29,728 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleree4eed8b-6ab2-497c-a551-278010bfcd57/ratis/e65d7c23-2305-4e36-b0f7-5382e9455a77/current/log_inprogress_0
2019-06-17 04:34:30,640 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 04:34:30,641 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c: close
2019-06-17 04:34:30,641 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c: shutdown group-5382E9455A77
2019-06-17 04:34:30,641 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-5382E9455A77,id=bc817dde-6cc8-42f8-9d0f-65bdc0510a4c
2019-06-17 04:34:30,642 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c: shutdown LeaderState
2019-06-17 04:34:30,642 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c-PendingRequests: sendNotLeaderResponses
2019-06-17 04:34:30,643 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-bc817dde-6cc8-42f8-9d0f-65bdc0510a4c-group-5382E9455A77: set stopIndex = 2
2019-06-17 04:34:30,643 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 04:34:30,643 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleree4eed8b-6ab2-497c-a551-278010bfcd57/ratis/e65d7c23-2305-4e36-b0f7-5382e9455a77/sm/snapshot.1_2
2019-06-17 04:34:30,643 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c:group-5382E9455A77 closes. The last applied log index is 2
2019-06-17 04:34:30,644 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 04:34:30,645 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c-RaftLogWorker close()
2019-06-17 04:34:30,645 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c: shutdown server with port 36155 now
2019-06-17 04:34:30,646 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - bc817dde-6cc8-42f8-9d0f-65bdc0510a4c: shutdown server with port 36155 successfully
2019-06-17 04:34:30,650 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 04:34:30,680 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3d564b6a-33e8-4a31-a875-913c7a9ef740/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 04:34:30,681 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3d564b6a-33e8-4a31-a875-913c7a9ef740/hdds to VolumeSet
2019-06-17 04:34:30,681 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@8bffb8b
2019-06-17 04:34:30,681 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@8bffb8b
2019-06-17 04:34:30,692 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 38043
2019-06-17 04:34:30,700 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 04:34:30,700 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 04:34:30,701 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 38043 (custom)
2019-06-17 04:34:30,701 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 04:34:30,701 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 04:34:30,702 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 04:34:30,702 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 04:34:30,702 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3d564b6a-33e8-4a31-a875-913c7a9ef740/ratis] (custom)
2019-06-17 04:34:30,703 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 43011
2019-06-17 04:34:30,703 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 04:34:30,703 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 04:34:30,704 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 03ce778e-e7e7-4bfd-9d77-d87d08859ad2 at port 38043
2019-06-17 04:34:30,713 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2: start RPC server
2019-06-17 04:34:30,714 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2: GrpcService started, listening on 0.0.0.0/0.0.0.0:38043
2019-06-17 04:34:30,722 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2: addNew group-829B85E37932:[03ce778e-e7e7-4bfd-9d77-d87d08859ad2:127.0.0.1:38043] returns group-829B85E37932:java.util.concurrent.CompletableFuture@ca1772a[Not completed]
2019-06-17 04:34:30,723 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2: new RaftServerImpl for group-829B85E37932:[03ce778e-e7e7-4bfd-9d77-d87d08859ad2:127.0.0.1:38043] with ContainerStateMachine:uninitialized
2019-06-17 04:34:30,723 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 04:34:30,723 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 04:34:30,723 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 04:34:30,724 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 04:34:30,724 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2:group-829B85E37932 ConfigurationManager, init=-1: [03ce778e-e7e7-4bfd-9d77-d87d08859ad2:127.0.0.1:38043], old=null, confs=<EMPTY_MAP>
2019-06-17 04:34:30,724 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3d564b6a-33e8-4a31-a875-913c7a9ef740/ratis] (custom)
2019-06-17 04:34:30,724 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3d564b6a-33e8-4a31-a875-913c7a9ef740/ratis/8b5e377a-3f85-4194-af91-829b85e37932 does not exist. Creating ...
2019-06-17 04:34:30,727 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3d564b6a-33e8-4a31-a875-913c7a9ef740/ratis/8b5e377a-3f85-4194-af91-829b85e37932/in_use.lock acquired by nodename 4300@ozone-unit-076618677d3mdgzw-899644134
2019-06-17 04:34:30,729 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3d564b6a-33e8-4a31-a875-913c7a9ef740/ratis/8b5e377a-3f85-4194-af91-829b85e37932 has been successfully formatted.
2019-06-17 04:34:30,729 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 04:34:30,729 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 04:34:30,729 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 04:34:30,729 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 04:34:30,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 04:34:30,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 04:34:30,730 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 03ce778e-e7e7-4bfd-9d77-d87d08859ad2-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3d564b6a-33e8-4a31-a875-913c7a9ef740/ratis/8b5e377a-3f85-4194-af91-829b85e37932
2019-06-17 04:34:30,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 04:34:30,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 04:34:30,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 04:34:30,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 04:34:30,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 04:34:30,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 04:34:30,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 04:34:30,731 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 04:34:30,731 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 04:34:30,731 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 04:34:30,731 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 04:34:30,731 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 04:34:30,731 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 04:34:30,732 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2: start group-829B85E37932
2019-06-17 04:34:30,732 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2:group-829B85E37932 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 04:34:30,732 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2: start FollowerState
2019-06-17 04:34:30,732 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-829B85E37932,id=03ce778e-e7e7-4bfd-9d77-d87d08859ad2
2019-06-17 04:34:31,858 INFO  impl.FollowerState (FollowerState.java:run(101)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2:group-829B85E37932 changes to CANDIDATE, lastRpcTime:1126, electionTimeout:1126ms
2019-06-17 04:34:31,858 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2: shutdown FollowerState
2019-06-17 04:34:31,858 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2:group-829B85E37932 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 04:34:31,858 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2: start LeaderElection
2019-06-17 04:34:31,861 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2:group-829B85E37932:LeaderElection3: begin an election at term 1 for -1: [03ce778e-e7e7-4bfd-9d77-d87d08859ad2:127.0.0.1:38043], old=null
2019-06-17 04:34:31,861 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2: shutdown LeaderElection
2019-06-17 04:34:31,862 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2:group-829B85E37932 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 04:34:31,862 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2:group-829B85E37932 change Leader from null to 03ce778e-e7e7-4bfd-9d77-d87d08859ad2 at term 1 for becomeLeader, leader elected after 1132ms
2019-06-17 04:34:31,862 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 04:34:31,862 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 04:34:31,862 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 04:34:31,862 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 04:34:31,863 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2: start LeaderState
2019-06-17 04:34:31,863 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2-RaftLogWorker: Starting segment from index:0
2019-06-17 04:34:31,866 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2:group-829B85E37932 set configuration 0: [03ce778e-e7e7-4bfd-9d77-d87d08859ad2:127.0.0.1:38043], old=null at 0
2019-06-17 04:34:31,899 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3d564b6a-33e8-4a31-a875-913c7a9ef740/ratis/8b5e377a-3f85-4194-af91-829b85e37932/current/log_inprogress_0
2019-06-17 04:34:32,773 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 1160529873388934729 is closed with bcsId 0.
2019-06-17 04:34:32,773 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 04:34:32,774 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2: close
2019-06-17 04:34:32,774 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2: shutdown group-829B85E37932
2019-06-17 04:34:32,774 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-829B85E37932,id=03ce778e-e7e7-4bfd-9d77-d87d08859ad2
2019-06-17 04:34:32,775 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2: shutdown LeaderState
2019-06-17 04:34:32,775 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2-PendingRequests: sendNotLeaderResponses
2019-06-17 04:34:32,776 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-03ce778e-e7e7-4bfd-9d77-d87d08859ad2-group-829B85E37932: set stopIndex = 2
2019-06-17 04:34:32,776 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 04:34:32,776 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3d564b6a-33e8-4a31-a875-913c7a9ef740/ratis/8b5e377a-3f85-4194-af91-829b85e37932/sm/snapshot.1_2
2019-06-17 04:34:32,776 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2:group-829B85E37932 closes. The last applied log index is 2
2019-06-17 04:34:32,777 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 04:34:32,777 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2-RaftLogWorker close()
2019-06-17 04:34:32,780 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2: shutdown server with port 38043 now
2019-06-17 04:34:32,781 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 03ce778e-e7e7-4bfd-9d77-d87d08859ad2: shutdown server with port 38043 successfully
2019-06-17 04:34:32,783 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 04:34:32,819 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6712230b-3afa-4a48-ab52-e1368926f270/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 04:34:32,819 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6712230b-3afa-4a48-ab52-e1368926f270/hdds to VolumeSet
2019-06-17 04:34:32,819 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@7318daf8
2019-06-17 04:34:32,820 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@7318daf8
2019-06-17 04:34:32,829 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 35353
2019-06-17 04:34:32,830 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 04:34:32,831 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 04:34:32,831 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 35353 (custom)
2019-06-17 04:34:32,831 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 04:34:32,831 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 04:34:32,832 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 04:34:32,832 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 04:34:32,832 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6712230b-3afa-4a48-ab52-e1368926f270/ratis] (custom)
2019-06-17 04:34:32,833 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 36661
2019-06-17 04:34:32,833 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 04:34:32,833 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 04:34:32,833 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 3ba2e994-f929-43ba-84ed-d81c79f159a0 at port 35353
2019-06-17 04:34:32,840 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0: start RPC server
2019-06-17 04:34:32,841 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0: GrpcService started, listening on 0.0.0.0/0.0.0.0:35353
Jun 17, 2019 4:34:32 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:38043} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 17, 2019 4:34:32 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:36155} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-17 04:34:32,854 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0: addNew group-DC968CC98134:[3ba2e994-f929-43ba-84ed-d81c79f159a0:127.0.0.1:35353] returns group-DC968CC98134:java.util.concurrent.CompletableFuture@6fbf0794[Not completed]
2019-06-17 04:34:32,854 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0: new RaftServerImpl for group-DC968CC98134:[3ba2e994-f929-43ba-84ed-d81c79f159a0:127.0.0.1:35353] with ContainerStateMachine:uninitialized
2019-06-17 04:34:32,855 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 04:34:32,855 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 04:34:32,855 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 04:34:32,855 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 04:34:32,855 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0:group-DC968CC98134 ConfigurationManager, init=-1: [3ba2e994-f929-43ba-84ed-d81c79f159a0:127.0.0.1:35353], old=null, confs=<EMPTY_MAP>
2019-06-17 04:34:32,855 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6712230b-3afa-4a48-ab52-e1368926f270/ratis] (custom)
2019-06-17 04:34:32,856 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6712230b-3afa-4a48-ab52-e1368926f270/ratis/e94f1702-bfaf-485d-9075-dc968cc98134 does not exist. Creating ...
2019-06-17 04:34:32,858 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6712230b-3afa-4a48-ab52-e1368926f270/ratis/e94f1702-bfaf-485d-9075-dc968cc98134/in_use.lock acquired by nodename 4300@ozone-unit-076618677d3mdgzw-899644134
2019-06-17 04:34:32,860 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6712230b-3afa-4a48-ab52-e1368926f270/ratis/e94f1702-bfaf-485d-9075-dc968cc98134 has been successfully formatted.
2019-06-17 04:34:32,860 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 04:34:32,860 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 04:34:32,860 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 04:34:32,860 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 04:34:32,861 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 04:34:32,861 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 04:34:32,861 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 3ba2e994-f929-43ba-84ed-d81c79f159a0-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6712230b-3afa-4a48-ab52-e1368926f270/ratis/e94f1702-bfaf-485d-9075-dc968cc98134
2019-06-17 04:34:32,861 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 04:34:32,861 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 04:34:32,861 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 04:34:32,861 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 04:34:32,861 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 04:34:32,861 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 04:34:32,861 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 04:34:32,861 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 04:34:32,861 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 04:34:32,862 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 04:34:32,863 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 04:34:32,863 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 04:34:32,863 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 04:34:32,863 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0: start group-DC968CC98134
2019-06-17 04:34:32,863 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0:group-DC968CC98134 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 04:34:32,863 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0: start FollowerState
2019-06-17 04:34:32,864 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-DC968CC98134,id=3ba2e994-f929-43ba-84ed-d81c79f159a0
2019-06-17 04:34:34,042 INFO  impl.FollowerState (FollowerState.java:run(101)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0:group-DC968CC98134 changes to CANDIDATE, lastRpcTime:1179, electionTimeout:1179ms
2019-06-17 04:34:34,042 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0: shutdown FollowerState
2019-06-17 04:34:34,043 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0:group-DC968CC98134 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 04:34:34,043 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0: start LeaderElection
2019-06-17 04:34:34,045 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0:group-DC968CC98134:LeaderElection4: begin an election at term 1 for -1: [3ba2e994-f929-43ba-84ed-d81c79f159a0:127.0.0.1:35353], old=null
2019-06-17 04:34:34,046 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0: shutdown LeaderElection
2019-06-17 04:34:34,046 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0:group-DC968CC98134 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 04:34:34,046 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0:group-DC968CC98134 change Leader from null to 3ba2e994-f929-43ba-84ed-d81c79f159a0 at term 1 for becomeLeader, leader elected after 1185ms
2019-06-17 04:34:34,046 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 04:34:34,046 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 04:34:34,046 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 04:34:34,046 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 04:34:34,046 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0: start LeaderState
2019-06-17 04:34:34,046 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0-RaftLogWorker: Starting segment from index:0
2019-06-17 04:34:34,047 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0:group-DC968CC98134 set configuration 0: [3ba2e994-f929-43ba-84ed-d81c79f159a0:127.0.0.1:35353], old=null at 0
2019-06-17 04:34:34,081 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6712230b-3afa-4a48-ab52-e1368926f270/ratis/e94f1702-bfaf-485d-9075-dc968cc98134/current/log_inprogress_0
2019-06-17 04:34:34,898 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 1494388923408979562 is closed with bcsId 0.
2019-06-17 04:34:34,898 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 04:34:34,898 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0: close
2019-06-17 04:34:34,898 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0: shutdown group-DC968CC98134
2019-06-17 04:34:34,899 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-DC968CC98134,id=3ba2e994-f929-43ba-84ed-d81c79f159a0
2019-06-17 04:34:34,899 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0: shutdown LeaderState
2019-06-17 04:34:34,899 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0-PendingRequests: sendNotLeaderResponses
2019-06-17 04:34:34,900 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-3ba2e994-f929-43ba-84ed-d81c79f159a0-group-DC968CC98134: set stopIndex = 2
2019-06-17 04:34:34,900 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 04:34:34,900 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6712230b-3afa-4a48-ab52-e1368926f270/ratis/e94f1702-bfaf-485d-9075-dc968cc98134/sm/snapshot.1_2
2019-06-17 04:34:34,901 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0:group-DC968CC98134 closes. The last applied log index is 2
2019-06-17 04:34:34,901 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 04:34:34,901 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0-RaftLogWorker close()
2019-06-17 04:34:34,902 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0: shutdown server with port 35353 now
2019-06-17 04:34:34,903 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 3ba2e994-f929-43ba-84ed-d81c79f159a0: shutdown server with port 35353 successfully
2019-06-17 04:34:34,905 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 04:34:34,924 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8ef7f63d-5c46-4216-bc6d-76aeb706b1e4/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 04:34:34,925 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8ef7f63d-5c46-4216-bc6d-76aeb706b1e4/hdds to VolumeSet
2019-06-17 04:34:34,925 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3e5d4f6b
2019-06-17 04:34:34,925 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3e5d4f6b
2019-06-17 04:34:34,937 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 41287
2019-06-17 04:34:34,938 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 04:34:34,939 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 04:34:34,939 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 41287 (custom)
2019-06-17 04:34:34,939 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 04:34:34,940 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 04:34:34,940 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 04:34:34,940 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 04:34:34,940 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8ef7f63d-5c46-4216-bc6d-76aeb706b1e4/ratis] (custom)
2019-06-17 04:34:34,941 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 34179
2019-06-17 04:34:34,941 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 04:34:34,941 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 04:34:34,941 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 1f0af34b-3cf9-4b20-a21b-697a984214bc at port 41287
2019-06-17 04:34:34,954 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc: start RPC server
2019-06-17 04:34:34,955 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc: GrpcService started, listening on 0.0.0.0/0.0.0.0:41287
2019-06-17 04:34:34,969 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc: addNew group-8EEC9A2C68D0:[1f0af34b-3cf9-4b20-a21b-697a984214bc:127.0.0.1:41287] returns group-8EEC9A2C68D0:java.util.concurrent.CompletableFuture@32a1053f[Not completed]
2019-06-17 04:34:34,969 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc: new RaftServerImpl for group-8EEC9A2C68D0:[1f0af34b-3cf9-4b20-a21b-697a984214bc:127.0.0.1:41287] with ContainerStateMachine:uninitialized
2019-06-17 04:34:34,970 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 04:34:34,970 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 04:34:34,970 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 04:34:34,970 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 04:34:34,970 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc:group-8EEC9A2C68D0 ConfigurationManager, init=-1: [1f0af34b-3cf9-4b20-a21b-697a984214bc:127.0.0.1:41287], old=null, confs=<EMPTY_MAP>
2019-06-17 04:34:34,970 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8ef7f63d-5c46-4216-bc6d-76aeb706b1e4/ratis] (custom)
2019-06-17 04:34:34,971 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8ef7f63d-5c46-4216-bc6d-76aeb706b1e4/ratis/b668c88a-9170-4143-9530-8eec9a2c68d0 does not exist. Creating ...
2019-06-17 04:34:34,973 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8ef7f63d-5c46-4216-bc6d-76aeb706b1e4/ratis/b668c88a-9170-4143-9530-8eec9a2c68d0/in_use.lock acquired by nodename 4300@ozone-unit-076618677d3mdgzw-899644134
2019-06-17 04:34:34,975 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8ef7f63d-5c46-4216-bc6d-76aeb706b1e4/ratis/b668c88a-9170-4143-9530-8eec9a2c68d0 has been successfully formatted.
2019-06-17 04:34:34,976 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 04:34:34,976 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 04:34:34,976 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 04:34:34,976 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 04:34:34,976 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 04:34:34,976 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 04:34:34,976 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 1f0af34b-3cf9-4b20-a21b-697a984214bc-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8ef7f63d-5c46-4216-bc6d-76aeb706b1e4/ratis/b668c88a-9170-4143-9530-8eec9a2c68d0
2019-06-17 04:34:34,976 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 04:34:34,976 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 04:34:34,976 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 04:34:34,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 04:34:34,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 04:34:34,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 04:34:34,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 04:34:34,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 04:34:34,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 04:34:34,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 04:34:34,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 04:34:34,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 04:34:34,978 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 04:34:34,978 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc: start group-8EEC9A2C68D0
2019-06-17 04:34:34,978 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc:group-8EEC9A2C68D0 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 04:34:34,978 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc: start FollowerState
2019-06-17 04:34:34,978 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-8EEC9A2C68D0,id=1f0af34b-3cf9-4b20-a21b-697a984214bc
2019-06-17 04:34:35,994 INFO  impl.FollowerState (FollowerState.java:run(101)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc:group-8EEC9A2C68D0 changes to CANDIDATE, lastRpcTime:1016, electionTimeout:1016ms
2019-06-17 04:34:35,994 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc: shutdown FollowerState
2019-06-17 04:34:35,995 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc:group-8EEC9A2C68D0 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 04:34:35,995 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc: start LeaderElection
2019-06-17 04:34:35,998 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc:group-8EEC9A2C68D0:LeaderElection5: begin an election at term 1 for -1: [1f0af34b-3cf9-4b20-a21b-697a984214bc:127.0.0.1:41287], old=null
2019-06-17 04:34:35,998 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc: shutdown LeaderElection
2019-06-17 04:34:35,998 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc:group-8EEC9A2C68D0 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 04:34:35,998 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc:group-8EEC9A2C68D0 change Leader from null to 1f0af34b-3cf9-4b20-a21b-697a984214bc at term 1 for becomeLeader, leader elected after 1022ms
2019-06-17 04:34:35,998 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 04:34:35,999 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 04:34:35,999 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 04:34:35,999 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 04:34:35,999 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc: start LeaderState
2019-06-17 04:34:35,999 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc-RaftLogWorker: Starting segment from index:0
2019-06-17 04:34:35,999 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc:group-8EEC9A2C68D0 set configuration 0: [1f0af34b-3cf9-4b20-a21b-697a984214bc:127.0.0.1:41287], old=null at 0
2019-06-17 04:34:36,034 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8ef7f63d-5c46-4216-bc6d-76aeb706b1e4/ratis/b668c88a-9170-4143-9530-8eec9a2c68d0/current/log_inprogress_0
2019-06-17 04:34:37,027 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 4307860129126815538 is closed with bcsId 0.
2019-06-17 04:34:37,027 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 04:34:37,028 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc: close
2019-06-17 04:34:37,028 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc: shutdown group-8EEC9A2C68D0
2019-06-17 04:34:37,028 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-8EEC9A2C68D0,id=1f0af34b-3cf9-4b20-a21b-697a984214bc
2019-06-17 04:34:37,028 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc: shutdown LeaderState
2019-06-17 04:34:37,028 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc-PendingRequests: sendNotLeaderResponses
2019-06-17 04:34:37,029 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-1f0af34b-3cf9-4b20-a21b-697a984214bc-group-8EEC9A2C68D0: set stopIndex = 4
2019-06-17 04:34:37,029 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 04:34:37,030 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8ef7f63d-5c46-4216-bc6d-76aeb706b1e4/ratis/b668c88a-9170-4143-9530-8eec9a2c68d0/sm/snapshot.1_4
2019-06-17 04:34:37,030 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc:group-8EEC9A2C68D0 closes. The last applied log index is 4
2019-06-17 04:34:37,030 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 04:34:37,031 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc-RaftLogWorker close()
2019-06-17 04:34:37,031 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc: shutdown server with port 41287 now
2019-06-17 04:34:37,032 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 1f0af34b-3cf9-4b20-a21b-697a984214bc: shutdown server with port 41287 successfully
2019-06-17 04:34:37,033 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
