2019-06-17 18:41:35,778 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler21a56320-17c6-482b-9038-4eb1cbfd6853/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 18:41:35,782 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler21a56320-17c6-482b-9038-4eb1cbfd6853/hdds to VolumeSet
2019-06-17 18:41:35,792 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-17 18:41:35,835 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-17 18:41:36,225 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 40229
2019-06-17 18:41:36,616 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 18:41:36,639 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 18:41:36,647 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 40229 (custom)
2019-06-17 18:41:36,648 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 18:41:36,650 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 18:41:36,651 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 18:41:36,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 18:41:36,778 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler21a56320-17c6-482b-9038-4eb1cbfd6853/ratis] (custom)
2019-06-17 18:41:36,788 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42413
2019-06-17 18:41:36,806 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 18:41:36,806 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 18:41:36,808 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis bc0af47a-e073-4ba6-a96e-bc44452e1919 at port 40229
2019-06-17 18:41:36,819 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - bc0af47a-e073-4ba6-a96e-bc44452e1919: start RPC server
2019-06-17 18:41:36,953 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - bc0af47a-e073-4ba6-a96e-bc44452e1919: GrpcService started, listening on 0.0.0.0/0.0.0.0:40229
2019-06-17 18:41:37,228 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - bc0af47a-e073-4ba6-a96e-bc44452e1919: addNew group-18AE0D92E09D:[bc0af47a-e073-4ba6-a96e-bc44452e1919:127.0.0.1:40229] returns group-18AE0D92E09D:java.util.concurrent.CompletableFuture@7015c50e[Not completed]
2019-06-17 18:41:37,254 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - bc0af47a-e073-4ba6-a96e-bc44452e1919: new RaftServerImpl for group-18AE0D92E09D:[bc0af47a-e073-4ba6-a96e-bc44452e1919:127.0.0.1:40229] with ContainerStateMachine:uninitialized
2019-06-17 18:41:37,255 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 18:41:37,255 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 18:41:37,255 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 18:41:37,256 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 18:41:37,261 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - bc0af47a-e073-4ba6-a96e-bc44452e1919:group-18AE0D92E09D ConfigurationManager, init=-1: [bc0af47a-e073-4ba6-a96e-bc44452e1919:127.0.0.1:40229], old=null, confs=<EMPTY_MAP>
2019-06-17 18:41:37,261 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler21a56320-17c6-482b-9038-4eb1cbfd6853/ratis] (custom)
2019-06-17 18:41:37,266 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler21a56320-17c6-482b-9038-4eb1cbfd6853/ratis/d26df555-5bba-4fd7-9635-18ae0d92e09d does not exist. Creating ...
2019-06-17 18:41:37,274 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler21a56320-17c6-482b-9038-4eb1cbfd6853/ratis/d26df555-5bba-4fd7-9635-18ae0d92e09d/in_use.lock acquired by nodename 4301@ozone-unit-076618677d3xkc5j-3772659146
2019-06-17 18:41:37,281 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler21a56320-17c6-482b-9038-4eb1cbfd6853/ratis/d26df555-5bba-4fd7-9635-18ae0d92e09d has been successfully formatted.
2019-06-17 18:41:37,283 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 18:41:37,283 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 18:41:37,285 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 18:41:37,287 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 18:41:37,290 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 18:41:37,293 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 18:41:37,295 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new bc0af47a-e073-4ba6-a96e-bc44452e1919-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler21a56320-17c6-482b-9038-4eb1cbfd6853/ratis/d26df555-5bba-4fd7-9635-18ae0d92e09d
2019-06-17 18:41:37,295 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 18:41:37,295 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 18:41:37,297 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 18:41:37,297 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 18:41:37,298 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 18:41:37,298 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 18:41:37,299 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 18:41:37,299 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 18:41:37,299 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 18:41:37,301 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 18:41:37,306 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 18:41:37,307 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 18:41:37,307 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 18:41:37,412 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - bc0af47a-e073-4ba6-a96e-bc44452e1919: start group-18AE0D92E09D
2019-06-17 18:41:37,413 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bc0af47a-e073-4ba6-a96e-bc44452e1919:group-18AE0D92E09D changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 18:41:37,414 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bc0af47a-e073-4ba6-a96e-bc44452e1919: start FollowerState
2019-06-17 18:41:37,415 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-18AE0D92E09D,id=bc0af47a-e073-4ba6-a96e-bc44452e1919
2019-06-17 18:41:38,550 INFO  impl.FollowerState (FollowerState.java:run(101)) - bc0af47a-e073-4ba6-a96e-bc44452e1919:group-18AE0D92E09D changes to CANDIDATE, lastRpcTime:1136, electionTimeout:1136ms
2019-06-17 18:41:38,551 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - bc0af47a-e073-4ba6-a96e-bc44452e1919: shutdown FollowerState
2019-06-17 18:41:38,551 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bc0af47a-e073-4ba6-a96e-bc44452e1919:group-18AE0D92E09D changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 18:41:38,552 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bc0af47a-e073-4ba6-a96e-bc44452e1919: start LeaderElection
2019-06-17 18:41:38,555 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - bc0af47a-e073-4ba6-a96e-bc44452e1919:group-18AE0D92E09D:LeaderElection1: begin an election at term 1 for -1: [bc0af47a-e073-4ba6-a96e-bc44452e1919:127.0.0.1:40229], old=null
2019-06-17 18:41:38,556 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - bc0af47a-e073-4ba6-a96e-bc44452e1919: shutdown LeaderElection
2019-06-17 18:41:38,557 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bc0af47a-e073-4ba6-a96e-bc44452e1919:group-18AE0D92E09D changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 18:41:38,557 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - bc0af47a-e073-4ba6-a96e-bc44452e1919:group-18AE0D92E09D change Leader from null to bc0af47a-e073-4ba6-a96e-bc44452e1919 at term 1 for becomeLeader, leader elected after 1273ms
2019-06-17 18:41:38,560 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 18:41:38,560 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 18:41:38,562 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 18:41:38,563 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 18:41:38,572 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bc0af47a-e073-4ba6-a96e-bc44452e1919: start LeaderState
2019-06-17 18:41:38,587 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - bc0af47a-e073-4ba6-a96e-bc44452e1919-RaftLogWorker: Starting segment from index:0
2019-06-17 18:41:38,595 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - bc0af47a-e073-4ba6-a96e-bc44452e1919:group-18AE0D92E09D set configuration 0: [bc0af47a-e073-4ba6-a96e-bc44452e1919:127.0.0.1:40229], old=null at 0
2019-06-17 18:41:38,717 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - bc0af47a-e073-4ba6-a96e-bc44452e1919-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler21a56320-17c6-482b-9038-4eb1cbfd6853/ratis/d26df555-5bba-4fd7-9635-18ae0d92e09d/current/log_inprogress_0
2019-06-17 18:41:39,631 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-17 18:41:39,686 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 7052570472281147661 is closed with bcsId 0.
2019-06-17 18:41:39,687 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 18:41:39,688 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - bc0af47a-e073-4ba6-a96e-bc44452e1919: close
2019-06-17 18:41:39,689 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - bc0af47a-e073-4ba6-a96e-bc44452e1919: shutdown group-18AE0D92E09D
2019-06-17 18:41:39,690 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-18AE0D92E09D,id=bc0af47a-e073-4ba6-a96e-bc44452e1919
2019-06-17 18:41:39,690 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - bc0af47a-e073-4ba6-a96e-bc44452e1919: shutdown LeaderState
2019-06-17 18:41:39,690 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - bc0af47a-e073-4ba6-a96e-bc44452e1919-PendingRequests: sendNotLeaderResponses
2019-06-17 18:41:39,693 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-bc0af47a-e073-4ba6-a96e-bc44452e1919-group-18AE0D92E09D: set stopIndex = 4
2019-06-17 18:41:39,693 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 18:41:39,693 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler21a56320-17c6-482b-9038-4eb1cbfd6853/ratis/d26df555-5bba-4fd7-9635-18ae0d92e09d/sm/snapshot.1_4
2019-06-17 18:41:39,701 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - bc0af47a-e073-4ba6-a96e-bc44452e1919:group-18AE0D92E09D closes. The last applied log index is 4
2019-06-17 18:41:39,702 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - bc0af47a-e073-4ba6-a96e-bc44452e1919-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 18:41:39,702 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - bc0af47a-e073-4ba6-a96e-bc44452e1919-RaftLogWorker close()
2019-06-17 18:41:39,703 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - bc0af47a-e073-4ba6-a96e-bc44452e1919: shutdown server with port 40229 now
2019-06-17 18:41:39,707 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - bc0af47a-e073-4ba6-a96e-bc44452e1919: shutdown server with port 40229 successfully
2019-06-17 18:41:39,719 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 18:41:39,744 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler93e6a527-f225-4241-8168-d6a395b6f4a7/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 18:41:39,744 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler93e6a527-f225-4241-8168-d6a395b6f4a7/hdds to VolumeSet
2019-06-17 18:41:39,744 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@6f7e336b
2019-06-17 18:41:39,745 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@6f7e336b
2019-06-17 18:41:39,759 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 37019
2019-06-17 18:41:39,760 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 18:41:39,761 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 18:41:39,761 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 37019 (custom)
2019-06-17 18:41:39,762 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 18:41:39,762 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 18:41:39,762 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 18:41:39,762 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 18:41:39,763 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler93e6a527-f225-4241-8168-d6a395b6f4a7/ratis] (custom)
2019-06-17 18:41:39,764 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 35173
2019-06-17 18:41:39,764 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 18:41:39,765 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 18:41:39,765 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 86a50e69-b422-4a47-9689-173cae564879 at port 37019
2019-06-17 18:41:39,781 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 86a50e69-b422-4a47-9689-173cae564879: start RPC server
2019-06-17 18:41:39,782 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 86a50e69-b422-4a47-9689-173cae564879: GrpcService started, listening on 0.0.0.0/0.0.0.0:37019
2019-06-17 18:41:39,791 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 86a50e69-b422-4a47-9689-173cae564879: addNew group-1957B43C7147:[86a50e69-b422-4a47-9689-173cae564879:127.0.0.1:37019] returns group-1957B43C7147:java.util.concurrent.CompletableFuture@518febee[Not completed]
2019-06-17 18:41:39,792 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 86a50e69-b422-4a47-9689-173cae564879: new RaftServerImpl for group-1957B43C7147:[86a50e69-b422-4a47-9689-173cae564879:127.0.0.1:37019] with ContainerStateMachine:uninitialized
2019-06-17 18:41:39,793 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 18:41:39,793 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 18:41:39,793 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 18:41:39,793 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 18:41:39,793 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 86a50e69-b422-4a47-9689-173cae564879:group-1957B43C7147 ConfigurationManager, init=-1: [86a50e69-b422-4a47-9689-173cae564879:127.0.0.1:37019], old=null, confs=<EMPTY_MAP>
2019-06-17 18:41:39,794 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler93e6a527-f225-4241-8168-d6a395b6f4a7/ratis] (custom)
2019-06-17 18:41:39,794 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler93e6a527-f225-4241-8168-d6a395b6f4a7/ratis/4c0dc2d1-15e0-4b16-90c1-1957b43c7147 does not exist. Creating ...
2019-06-17 18:41:39,796 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler93e6a527-f225-4241-8168-d6a395b6f4a7/ratis/4c0dc2d1-15e0-4b16-90c1-1957b43c7147/in_use.lock acquired by nodename 4301@ozone-unit-076618677d3xkc5j-3772659146
2019-06-17 18:41:39,799 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler93e6a527-f225-4241-8168-d6a395b6f4a7/ratis/4c0dc2d1-15e0-4b16-90c1-1957b43c7147 has been successfully formatted.
2019-06-17 18:41:39,799 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 18:41:39,799 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 18:41:39,799 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 18:41:39,799 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 18:41:39,799 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 18:41:39,800 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 18:41:39,800 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 86a50e69-b422-4a47-9689-173cae564879-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler93e6a527-f225-4241-8168-d6a395b6f4a7/ratis/4c0dc2d1-15e0-4b16-90c1-1957b43c7147
2019-06-17 18:41:39,800 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 18:41:39,800 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 18:41:39,800 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 18:41:39,800 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 18:41:39,801 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 18:41:39,801 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 18:41:39,801 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 18:41:39,801 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 18:41:39,801 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 18:41:39,801 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 18:41:39,802 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 18:41:39,802 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 18:41:39,803 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 18:41:39,803 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 86a50e69-b422-4a47-9689-173cae564879: start group-1957B43C7147
2019-06-17 18:41:39,803 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 86a50e69-b422-4a47-9689-173cae564879:group-1957B43C7147 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 18:41:39,803 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 86a50e69-b422-4a47-9689-173cae564879: start FollowerState
2019-06-17 18:41:39,804 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-1957B43C7147,id=86a50e69-b422-4a47-9689-173cae564879
2019-06-17 18:41:40,998 INFO  impl.FollowerState (FollowerState.java:run(101)) - 86a50e69-b422-4a47-9689-173cae564879:group-1957B43C7147 changes to CANDIDATE, lastRpcTime:1194, electionTimeout:1194ms
2019-06-17 18:41:40,998 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 86a50e69-b422-4a47-9689-173cae564879: shutdown FollowerState
2019-06-17 18:41:40,998 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 86a50e69-b422-4a47-9689-173cae564879:group-1957B43C7147 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 18:41:40,999 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 86a50e69-b422-4a47-9689-173cae564879: start LeaderElection
2019-06-17 18:41:41,002 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 86a50e69-b422-4a47-9689-173cae564879:group-1957B43C7147:LeaderElection2: begin an election at term 1 for -1: [86a50e69-b422-4a47-9689-173cae564879:127.0.0.1:37019], old=null
2019-06-17 18:41:41,002 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 86a50e69-b422-4a47-9689-173cae564879: shutdown LeaderElection
2019-06-17 18:41:41,002 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 86a50e69-b422-4a47-9689-173cae564879:group-1957B43C7147 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 18:41:41,002 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 86a50e69-b422-4a47-9689-173cae564879:group-1957B43C7147 change Leader from null to 86a50e69-b422-4a47-9689-173cae564879 at term 1 for becomeLeader, leader elected after 1203ms
2019-06-17 18:41:41,002 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 18:41:41,002 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 18:41:41,003 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 18:41:41,003 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 18:41:41,003 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 86a50e69-b422-4a47-9689-173cae564879: start LeaderState
2019-06-17 18:41:41,003 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 86a50e69-b422-4a47-9689-173cae564879-RaftLogWorker: Starting segment from index:0
2019-06-17 18:41:41,003 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 86a50e69-b422-4a47-9689-173cae564879:group-1957B43C7147 set configuration 0: [86a50e69-b422-4a47-9689-173cae564879:127.0.0.1:37019], old=null at 0
2019-06-17 18:41:41,040 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 86a50e69-b422-4a47-9689-173cae564879-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler93e6a527-f225-4241-8168-d6a395b6f4a7/ratis/4c0dc2d1-15e0-4b16-90c1-1957b43c7147/current/log_inprogress_0
2019-06-17 18:41:41,840 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 18:41:41,841 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 86a50e69-b422-4a47-9689-173cae564879: close
2019-06-17 18:41:41,841 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 86a50e69-b422-4a47-9689-173cae564879: shutdown group-1957B43C7147
2019-06-17 18:41:41,842 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-1957B43C7147,id=86a50e69-b422-4a47-9689-173cae564879
2019-06-17 18:41:41,842 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 86a50e69-b422-4a47-9689-173cae564879: shutdown LeaderState
2019-06-17 18:41:41,843 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 86a50e69-b422-4a47-9689-173cae564879-PendingRequests: sendNotLeaderResponses
2019-06-17 18:41:41,843 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-86a50e69-b422-4a47-9689-173cae564879-group-1957B43C7147: set stopIndex = 2
2019-06-17 18:41:41,843 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 18:41:41,844 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler93e6a527-f225-4241-8168-d6a395b6f4a7/ratis/4c0dc2d1-15e0-4b16-90c1-1957b43c7147/sm/snapshot.1_2
2019-06-17 18:41:41,844 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 86a50e69-b422-4a47-9689-173cae564879:group-1957B43C7147 closes. The last applied log index is 2
2019-06-17 18:41:41,845 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 86a50e69-b422-4a47-9689-173cae564879-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 18:41:41,845 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 86a50e69-b422-4a47-9689-173cae564879-RaftLogWorker close()
2019-06-17 18:41:41,846 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 86a50e69-b422-4a47-9689-173cae564879: shutdown server with port 37019 now
2019-06-17 18:41:41,847 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 86a50e69-b422-4a47-9689-173cae564879: shutdown server with port 37019 successfully
2019-06-17 18:41:41,852 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 18:41:41,878 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera8d83f9a-49f6-4649-8804-ab592df2faf8/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 18:41:41,878 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera8d83f9a-49f6-4649-8804-ab592df2faf8/hdds to VolumeSet
2019-06-17 18:41:41,879 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1f51431
2019-06-17 18:41:41,879 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1f51431
2019-06-17 18:41:41,894 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 41011
2019-06-17 18:41:41,898 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 18:41:41,899 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 18:41:41,899 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 41011 (custom)
2019-06-17 18:41:41,899 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 18:41:41,899 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 18:41:41,899 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 18:41:41,900 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 18:41:41,900 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera8d83f9a-49f6-4649-8804-ab592df2faf8/ratis] (custom)
2019-06-17 18:41:41,900 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42031
2019-06-17 18:41:41,901 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 18:41:41,901 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 18:41:41,901 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 18e53593-7c9b-4130-a61c-acffb90af93a at port 41011
2019-06-17 18:41:41,921 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 18e53593-7c9b-4130-a61c-acffb90af93a: start RPC server
2019-06-17 18:41:41,923 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 18e53593-7c9b-4130-a61c-acffb90af93a: GrpcService started, listening on 0.0.0.0/0.0.0.0:41011
2019-06-17 18:41:41,949 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 18e53593-7c9b-4130-a61c-acffb90af93a: addNew group-5B57609CEEDF:[18e53593-7c9b-4130-a61c-acffb90af93a:127.0.0.1:41011] returns group-5B57609CEEDF:java.util.concurrent.CompletableFuture@7c7997fe[Not completed]
2019-06-17 18:41:41,949 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 18e53593-7c9b-4130-a61c-acffb90af93a: new RaftServerImpl for group-5B57609CEEDF:[18e53593-7c9b-4130-a61c-acffb90af93a:127.0.0.1:41011] with ContainerStateMachine:uninitialized
2019-06-17 18:41:41,950 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 18:41:41,950 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 18:41:41,950 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 18:41:41,950 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 18:41:41,950 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 18e53593-7c9b-4130-a61c-acffb90af93a:group-5B57609CEEDF ConfigurationManager, init=-1: [18e53593-7c9b-4130-a61c-acffb90af93a:127.0.0.1:41011], old=null, confs=<EMPTY_MAP>
2019-06-17 18:41:41,950 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera8d83f9a-49f6-4649-8804-ab592df2faf8/ratis] (custom)
2019-06-17 18:41:41,951 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera8d83f9a-49f6-4649-8804-ab592df2faf8/ratis/d08b3689-07bd-493e-8216-5b57609ceedf does not exist. Creating ...
2019-06-17 18:41:41,954 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera8d83f9a-49f6-4649-8804-ab592df2faf8/ratis/d08b3689-07bd-493e-8216-5b57609ceedf/in_use.lock acquired by nodename 4301@ozone-unit-076618677d3xkc5j-3772659146
2019-06-17 18:41:41,956 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera8d83f9a-49f6-4649-8804-ab592df2faf8/ratis/d08b3689-07bd-493e-8216-5b57609ceedf has been successfully formatted.
2019-06-17 18:41:41,956 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 18:41:41,956 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 18:41:41,956 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 18:41:41,956 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 18:41:41,957 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 18:41:41,957 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 18:41:41,957 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 18e53593-7c9b-4130-a61c-acffb90af93a-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera8d83f9a-49f6-4649-8804-ab592df2faf8/ratis/d08b3689-07bd-493e-8216-5b57609ceedf
2019-06-17 18:41:41,957 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 18:41:41,957 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 18:41:41,957 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 18:41:41,957 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 18:41:41,957 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 18:41:41,957 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 18:41:41,957 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 18:41:41,958 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 18:41:41,958 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 18:41:41,958 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 18:41:41,958 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 18:41:41,958 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 18:41:41,958 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 18:41:41,959 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 18e53593-7c9b-4130-a61c-acffb90af93a: start group-5B57609CEEDF
2019-06-17 18:41:41,959 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 18e53593-7c9b-4130-a61c-acffb90af93a:group-5B57609CEEDF changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 18:41:41,959 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 18e53593-7c9b-4130-a61c-acffb90af93a: start FollowerState
2019-06-17 18:41:41,959 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-5B57609CEEDF,id=18e53593-7c9b-4130-a61c-acffb90af93a
2019-06-17 18:41:42,975 INFO  impl.FollowerState (FollowerState.java:run(101)) - 18e53593-7c9b-4130-a61c-acffb90af93a:group-5B57609CEEDF changes to CANDIDATE, lastRpcTime:1016, electionTimeout:1016ms
2019-06-17 18:41:42,975 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 18e53593-7c9b-4130-a61c-acffb90af93a: shutdown FollowerState
2019-06-17 18:41:42,975 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 18e53593-7c9b-4130-a61c-acffb90af93a:group-5B57609CEEDF changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 18:41:42,976 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 18e53593-7c9b-4130-a61c-acffb90af93a: start LeaderElection
2019-06-17 18:41:42,979 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 18e53593-7c9b-4130-a61c-acffb90af93a:group-5B57609CEEDF:LeaderElection3: begin an election at term 1 for -1: [18e53593-7c9b-4130-a61c-acffb90af93a:127.0.0.1:41011], old=null
2019-06-17 18:41:42,979 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 18e53593-7c9b-4130-a61c-acffb90af93a: shutdown LeaderElection
2019-06-17 18:41:42,979 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 18e53593-7c9b-4130-a61c-acffb90af93a:group-5B57609CEEDF changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 18:41:42,979 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 18e53593-7c9b-4130-a61c-acffb90af93a:group-5B57609CEEDF change Leader from null to 18e53593-7c9b-4130-a61c-acffb90af93a at term 1 for becomeLeader, leader elected after 1022ms
2019-06-17 18:41:42,979 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 18:41:42,979 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 18:41:42,980 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 18:41:42,980 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 18:41:42,980 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 18e53593-7c9b-4130-a61c-acffb90af93a: start LeaderState
2019-06-17 18:41:42,980 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 18e53593-7c9b-4130-a61c-acffb90af93a-RaftLogWorker: Starting segment from index:0
2019-06-17 18:41:42,984 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 18e53593-7c9b-4130-a61c-acffb90af93a:group-5B57609CEEDF set configuration 0: [18e53593-7c9b-4130-a61c-acffb90af93a:127.0.0.1:41011], old=null at 0
2019-06-17 18:41:43,018 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 18e53593-7c9b-4130-a61c-acffb90af93a-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera8d83f9a-49f6-4649-8804-ab592df2faf8/ratis/d08b3689-07bd-493e-8216-5b57609ceedf/current/log_inprogress_0
2019-06-17 18:41:44,001 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 4571743729944848551 is closed with bcsId 0.
2019-06-17 18:41:44,002 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 18:41:44,002 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 18e53593-7c9b-4130-a61c-acffb90af93a: close
2019-06-17 18:41:44,002 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 18e53593-7c9b-4130-a61c-acffb90af93a: shutdown group-5B57609CEEDF
2019-06-17 18:41:44,003 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-5B57609CEEDF,id=18e53593-7c9b-4130-a61c-acffb90af93a
2019-06-17 18:41:44,003 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 18e53593-7c9b-4130-a61c-acffb90af93a: shutdown LeaderState
2019-06-17 18:41:44,003 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 18e53593-7c9b-4130-a61c-acffb90af93a-PendingRequests: sendNotLeaderResponses
2019-06-17 18:41:44,004 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-18e53593-7c9b-4130-a61c-acffb90af93a-group-5B57609CEEDF: set stopIndex = 2
2019-06-17 18:41:44,004 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 18:41:44,004 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera8d83f9a-49f6-4649-8804-ab592df2faf8/ratis/d08b3689-07bd-493e-8216-5b57609ceedf/sm/snapshot.1_2
2019-06-17 18:41:44,005 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 18e53593-7c9b-4130-a61c-acffb90af93a:group-5B57609CEEDF closes. The last applied log index is 2
2019-06-17 18:41:44,006 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 18e53593-7c9b-4130-a61c-acffb90af93a-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 18:41:44,007 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 18e53593-7c9b-4130-a61c-acffb90af93a-RaftLogWorker close()
2019-06-17 18:41:44,007 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 18e53593-7c9b-4130-a61c-acffb90af93a: shutdown server with port 41011 now
2019-06-17 18:41:44,011 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 18e53593-7c9b-4130-a61c-acffb90af93a: shutdown server with port 41011 successfully
2019-06-17 18:41:44,013 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 18:41:44,049 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler30e5a7b3-3a62-4166-ba08-a39d36582ad2/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 18:41:44,050 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler30e5a7b3-3a62-4166-ba08-a39d36582ad2/hdds to VolumeSet
2019-06-17 18:41:44,050 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@23940f86
2019-06-17 18:41:44,050 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@23940f86
2019-06-17 18:41:44,058 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 45379
2019-06-17 18:41:44,059 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 18:41:44,060 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 18:41:44,060 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 45379 (custom)
2019-06-17 18:41:44,060 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 18:41:44,060 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 18:41:44,060 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 18:41:44,060 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 18:41:44,061 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler30e5a7b3-3a62-4166-ba08-a39d36582ad2/ratis] (custom)
2019-06-17 18:41:44,061 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 38075
2019-06-17 18:41:44,062 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 18:41:44,062 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 18:41:44,062 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 5c4789d4-2e53-406d-8374-4b2b3b6ee51a at port 45379
2019-06-17 18:41:44,076 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a: start RPC server
2019-06-17 18:41:44,077 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a: GrpcService started, listening on 0.0.0.0/0.0.0.0:45379
Jun 17, 2019 6:41:44 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:37019} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 17, 2019 6:41:44 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:41011} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-17 18:41:44,091 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a: addNew group-806DF4A743BE:[5c4789d4-2e53-406d-8374-4b2b3b6ee51a:127.0.0.1:45379] returns group-806DF4A743BE:java.util.concurrent.CompletableFuture@24129bd3[Not completed]
2019-06-17 18:41:44,091 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a: new RaftServerImpl for group-806DF4A743BE:[5c4789d4-2e53-406d-8374-4b2b3b6ee51a:127.0.0.1:45379] with ContainerStateMachine:uninitialized
2019-06-17 18:41:44,092 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 18:41:44,092 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 18:41:44,092 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 18:41:44,092 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 18:41:44,092 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a:group-806DF4A743BE ConfigurationManager, init=-1: [5c4789d4-2e53-406d-8374-4b2b3b6ee51a:127.0.0.1:45379], old=null, confs=<EMPTY_MAP>
2019-06-17 18:41:44,092 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler30e5a7b3-3a62-4166-ba08-a39d36582ad2/ratis] (custom)
2019-06-17 18:41:44,092 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler30e5a7b3-3a62-4166-ba08-a39d36582ad2/ratis/aff80037-428c-48a6-bcce-806df4a743be does not exist. Creating ...
2019-06-17 18:41:44,095 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler30e5a7b3-3a62-4166-ba08-a39d36582ad2/ratis/aff80037-428c-48a6-bcce-806df4a743be/in_use.lock acquired by nodename 4301@ozone-unit-076618677d3xkc5j-3772659146
2019-06-17 18:41:44,097 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler30e5a7b3-3a62-4166-ba08-a39d36582ad2/ratis/aff80037-428c-48a6-bcce-806df4a743be has been successfully formatted.
2019-06-17 18:41:44,097 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 18:41:44,097 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 18:41:44,097 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 18:41:44,097 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 18:41:44,098 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 18:41:44,098 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 18:41:44,098 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 5c4789d4-2e53-406d-8374-4b2b3b6ee51a-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler30e5a7b3-3a62-4166-ba08-a39d36582ad2/ratis/aff80037-428c-48a6-bcce-806df4a743be
2019-06-17 18:41:44,098 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 18:41:44,098 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 18:41:44,098 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 18:41:44,098 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 18:41:44,098 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 18:41:44,098 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 18:41:44,098 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 18:41:44,098 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 18:41:44,099 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 18:41:44,099 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 18:41:44,099 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 18:41:44,099 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 18:41:44,099 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 18:41:44,100 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a: start group-806DF4A743BE
2019-06-17 18:41:44,100 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a:group-806DF4A743BE changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 18:41:44,100 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a: start FollowerState
2019-06-17 18:41:44,101 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-806DF4A743BE,id=5c4789d4-2e53-406d-8374-4b2b3b6ee51a
2019-06-17 18:41:45,166 INFO  impl.FollowerState (FollowerState.java:run(101)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a:group-806DF4A743BE changes to CANDIDATE, lastRpcTime:1066, electionTimeout:1066ms
2019-06-17 18:41:45,166 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a: shutdown FollowerState
2019-06-17 18:41:45,166 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a:group-806DF4A743BE changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 18:41:45,166 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a: start LeaderElection
2019-06-17 18:41:45,170 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a:group-806DF4A743BE:LeaderElection4: begin an election at term 1 for -1: [5c4789d4-2e53-406d-8374-4b2b3b6ee51a:127.0.0.1:45379], old=null
2019-06-17 18:41:45,170 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a: shutdown LeaderElection
2019-06-17 18:41:45,170 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a:group-806DF4A743BE changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 18:41:45,170 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a:group-806DF4A743BE change Leader from null to 5c4789d4-2e53-406d-8374-4b2b3b6ee51a at term 1 for becomeLeader, leader elected after 1072ms
2019-06-17 18:41:45,170 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 18:41:45,170 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 18:41:45,171 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 18:41:45,171 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 18:41:45,171 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a: start LeaderState
2019-06-17 18:41:45,171 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a-RaftLogWorker: Starting segment from index:0
2019-06-17 18:41:45,172 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a:group-806DF4A743BE set configuration 0: [5c4789d4-2e53-406d-8374-4b2b3b6ee51a:127.0.0.1:45379], old=null at 0
2019-06-17 18:41:45,207 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler30e5a7b3-3a62-4166-ba08-a39d36582ad2/ratis/aff80037-428c-48a6-bcce-806df4a743be/current/log_inprogress_0
2019-06-17 18:41:46,153 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 6637972107063194400 is closed with bcsId 0.
2019-06-17 18:41:46,154 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 18:41:46,154 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a: close
2019-06-17 18:41:46,154 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a: shutdown group-806DF4A743BE
2019-06-17 18:41:46,155 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-806DF4A743BE,id=5c4789d4-2e53-406d-8374-4b2b3b6ee51a
2019-06-17 18:41:46,155 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a: shutdown LeaderState
2019-06-17 18:41:46,155 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a-PendingRequests: sendNotLeaderResponses
2019-06-17 18:41:46,156 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-5c4789d4-2e53-406d-8374-4b2b3b6ee51a-group-806DF4A743BE: set stopIndex = 2
2019-06-17 18:41:46,156 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 18:41:46,157 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler30e5a7b3-3a62-4166-ba08-a39d36582ad2/ratis/aff80037-428c-48a6-bcce-806df4a743be/sm/snapshot.1_2
2019-06-17 18:41:46,157 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a:group-806DF4A743BE closes. The last applied log index is 2
2019-06-17 18:41:46,157 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 18:41:46,158 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a-RaftLogWorker close()
2019-06-17 18:41:46,158 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a: shutdown server with port 45379 now
2019-06-17 18:41:46,160 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 5c4789d4-2e53-406d-8374-4b2b3b6ee51a: shutdown server with port 45379 successfully
2019-06-17 18:41:46,165 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 18:41:46,184 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5fcf2c83-5976-4f80-afbc-75baf4d0944f/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 18:41:46,185 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5fcf2c83-5976-4f80-afbc-75baf4d0944f/hdds to VolumeSet
2019-06-17 18:41:46,185 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1bf39d06
2019-06-17 18:41:46,185 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1bf39d06
2019-06-17 18:41:46,196 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 41403
2019-06-17 18:41:46,197 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 18:41:46,198 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 18:41:46,198 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 41403 (custom)
2019-06-17 18:41:46,198 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 18:41:46,198 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 18:41:46,198 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 18:41:46,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 18:41:46,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5fcf2c83-5976-4f80-afbc-75baf4d0944f/ratis] (custom)
2019-06-17 18:41:46,200 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 38795
2019-06-17 18:41:46,200 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 18:41:46,200 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 18:41:46,200 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 54a06e72-0552-49a7-9731-d26d44f47079 at port 41403
2019-06-17 18:41:46,214 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 54a06e72-0552-49a7-9731-d26d44f47079: start RPC server
2019-06-17 18:41:46,215 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 54a06e72-0552-49a7-9731-d26d44f47079: GrpcService started, listening on 0.0.0.0/0.0.0.0:41403
2019-06-17 18:41:46,223 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 54a06e72-0552-49a7-9731-d26d44f47079: addNew group-C6D2B890F847:[54a06e72-0552-49a7-9731-d26d44f47079:127.0.0.1:41403] returns group-C6D2B890F847:java.util.concurrent.CompletableFuture@7dfd61fa[Not completed]
2019-06-17 18:41:46,224 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 54a06e72-0552-49a7-9731-d26d44f47079: new RaftServerImpl for group-C6D2B890F847:[54a06e72-0552-49a7-9731-d26d44f47079:127.0.0.1:41403] with ContainerStateMachine:uninitialized
2019-06-17 18:41:46,224 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 18:41:46,224 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 18:41:46,224 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 18:41:46,224 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 18:41:46,225 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 54a06e72-0552-49a7-9731-d26d44f47079:group-C6D2B890F847 ConfigurationManager, init=-1: [54a06e72-0552-49a7-9731-d26d44f47079:127.0.0.1:41403], old=null, confs=<EMPTY_MAP>
2019-06-17 18:41:46,225 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5fcf2c83-5976-4f80-afbc-75baf4d0944f/ratis] (custom)
2019-06-17 18:41:46,225 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5fcf2c83-5976-4f80-afbc-75baf4d0944f/ratis/7d19177b-1f4c-489c-b8ed-c6d2b890f847 does not exist. Creating ...
2019-06-17 18:41:46,230 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5fcf2c83-5976-4f80-afbc-75baf4d0944f/ratis/7d19177b-1f4c-489c-b8ed-c6d2b890f847/in_use.lock acquired by nodename 4301@ozone-unit-076618677d3xkc5j-3772659146
2019-06-17 18:41:46,232 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5fcf2c83-5976-4f80-afbc-75baf4d0944f/ratis/7d19177b-1f4c-489c-b8ed-c6d2b890f847 has been successfully formatted.
2019-06-17 18:41:46,232 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 18:41:46,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 18:41:46,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 18:41:46,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 18:41:46,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 18:41:46,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 18:41:46,233 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 54a06e72-0552-49a7-9731-d26d44f47079-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5fcf2c83-5976-4f80-afbc-75baf4d0944f/ratis/7d19177b-1f4c-489c-b8ed-c6d2b890f847
2019-06-17 18:41:46,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 18:41:46,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 18:41:46,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 18:41:46,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 18:41:46,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 18:41:46,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 18:41:46,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 18:41:46,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 18:41:46,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 18:41:46,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 18:41:46,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 18:41:46,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 18:41:46,235 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 18:41:46,235 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 54a06e72-0552-49a7-9731-d26d44f47079: start group-C6D2B890F847
2019-06-17 18:41:46,235 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 54a06e72-0552-49a7-9731-d26d44f47079:group-C6D2B890F847 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 18:41:46,235 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 54a06e72-0552-49a7-9731-d26d44f47079: start FollowerState
2019-06-17 18:41:46,235 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C6D2B890F847,id=54a06e72-0552-49a7-9731-d26d44f47079
2019-06-17 18:41:47,304 INFO  impl.FollowerState (FollowerState.java:run(101)) - 54a06e72-0552-49a7-9731-d26d44f47079:group-C6D2B890F847 changes to CANDIDATE, lastRpcTime:1068, electionTimeout:1068ms
2019-06-17 18:41:47,304 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 54a06e72-0552-49a7-9731-d26d44f47079: shutdown FollowerState
2019-06-17 18:41:47,304 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 54a06e72-0552-49a7-9731-d26d44f47079:group-C6D2B890F847 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 18:41:47,304 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 54a06e72-0552-49a7-9731-d26d44f47079: start LeaderElection
2019-06-17 18:41:47,308 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 54a06e72-0552-49a7-9731-d26d44f47079:group-C6D2B890F847:LeaderElection5: begin an election at term 1 for -1: [54a06e72-0552-49a7-9731-d26d44f47079:127.0.0.1:41403], old=null
2019-06-17 18:41:47,308 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 54a06e72-0552-49a7-9731-d26d44f47079: shutdown LeaderElection
2019-06-17 18:41:47,308 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 54a06e72-0552-49a7-9731-d26d44f47079:group-C6D2B890F847 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 18:41:47,308 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 54a06e72-0552-49a7-9731-d26d44f47079:group-C6D2B890F847 change Leader from null to 54a06e72-0552-49a7-9731-d26d44f47079 at term 1 for becomeLeader, leader elected after 1075ms
2019-06-17 18:41:47,308 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 18:41:47,308 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 18:41:47,308 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 18:41:47,308 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 18:41:47,308 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 54a06e72-0552-49a7-9731-d26d44f47079: start LeaderState
2019-06-17 18:41:47,309 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 54a06e72-0552-49a7-9731-d26d44f47079-RaftLogWorker: Starting segment from index:0
2019-06-17 18:41:47,309 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 54a06e72-0552-49a7-9731-d26d44f47079:group-C6D2B890F847 set configuration 0: [54a06e72-0552-49a7-9731-d26d44f47079:127.0.0.1:41403], old=null at 0
2019-06-17 18:41:47,344 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 54a06e72-0552-49a7-9731-d26d44f47079-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5fcf2c83-5976-4f80-afbc-75baf4d0944f/ratis/7d19177b-1f4c-489c-b8ed-c6d2b890f847/current/log_inprogress_0
2019-06-17 18:41:48,278 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 8564164373005243083 is closed with bcsId 0.
2019-06-17 18:41:48,279 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 18:41:48,279 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 54a06e72-0552-49a7-9731-d26d44f47079: close
2019-06-17 18:41:48,280 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 54a06e72-0552-49a7-9731-d26d44f47079: shutdown group-C6D2B890F847
2019-06-17 18:41:48,280 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C6D2B890F847,id=54a06e72-0552-49a7-9731-d26d44f47079
2019-06-17 18:41:48,280 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 54a06e72-0552-49a7-9731-d26d44f47079: shutdown LeaderState
2019-06-17 18:41:48,280 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 54a06e72-0552-49a7-9731-d26d44f47079-PendingRequests: sendNotLeaderResponses
2019-06-17 18:41:48,281 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-54a06e72-0552-49a7-9731-d26d44f47079-group-C6D2B890F847: set stopIndex = 4
2019-06-17 18:41:48,281 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 18:41:48,282 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5fcf2c83-5976-4f80-afbc-75baf4d0944f/ratis/7d19177b-1f4c-489c-b8ed-c6d2b890f847/sm/snapshot.1_4
2019-06-17 18:41:48,282 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 54a06e72-0552-49a7-9731-d26d44f47079:group-C6D2B890F847 closes. The last applied log index is 4
2019-06-17 18:41:48,282 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 54a06e72-0552-49a7-9731-d26d44f47079-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 18:41:48,283 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 54a06e72-0552-49a7-9731-d26d44f47079-RaftLogWorker close()
2019-06-17 18:41:48,283 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 54a06e72-0552-49a7-9731-d26d44f47079: shutdown server with port 41403 now
2019-06-17 18:41:48,284 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 54a06e72-0552-49a7-9731-d26d44f47079: shutdown server with port 41403 successfully
2019-06-17 18:41:48,288 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
