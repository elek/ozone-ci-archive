2019-06-17 05:42:02,483 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9e356dd9-90af-469f-bbd5-861c693d5e6e/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 05:42:02,489 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9e356dd9-90af-469f-bbd5-861c693d5e6e/hdds to VolumeSet
2019-06-17 05:42:02,520 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-17 05:42:02,560 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-17 05:42:02,926 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 37643
2019-06-17 05:42:03,435 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 05:42:03,460 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 05:42:03,471 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 37643 (custom)
2019-06-17 05:42:03,472 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 05:42:03,474 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 05:42:03,475 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 05:42:03,476 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 05:42:03,638 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9e356dd9-90af-469f-bbd5-861c693d5e6e/ratis] (custom)
2019-06-17 05:42:03,649 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 41391
2019-06-17 05:42:03,674 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 05:42:03,675 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 05:42:03,676 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 179f868b-0a9d-4919-aa41-71c68e299d7a at port 37643
2019-06-17 05:42:03,691 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 179f868b-0a9d-4919-aa41-71c68e299d7a: start RPC server
2019-06-17 05:42:03,851 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 179f868b-0a9d-4919-aa41-71c68e299d7a: GrpcService started, listening on 0.0.0.0/0.0.0.0:37643
2019-06-17 05:42:04,149 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 179f868b-0a9d-4919-aa41-71c68e299d7a: addNew group-87370791D1ED:[179f868b-0a9d-4919-aa41-71c68e299d7a:127.0.0.1:37643] returns group-87370791D1ED:java.util.concurrent.CompletableFuture@2ad4f85b[Not completed]
2019-06-17 05:42:04,181 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 179f868b-0a9d-4919-aa41-71c68e299d7a: new RaftServerImpl for group-87370791D1ED:[179f868b-0a9d-4919-aa41-71c68e299d7a:127.0.0.1:37643] with ContainerStateMachine:uninitialized
2019-06-17 05:42:04,182 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 05:42:04,182 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 05:42:04,182 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 05:42:04,183 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 05:42:04,187 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 179f868b-0a9d-4919-aa41-71c68e299d7a:group-87370791D1ED ConfigurationManager, init=-1: [179f868b-0a9d-4919-aa41-71c68e299d7a:127.0.0.1:37643], old=null, confs=<EMPTY_MAP>
2019-06-17 05:42:04,188 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9e356dd9-90af-469f-bbd5-861c693d5e6e/ratis] (custom)
2019-06-17 05:42:04,194 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9e356dd9-90af-469f-bbd5-861c693d5e6e/ratis/a41aff18-03d1-4475-b6ec-87370791d1ed does not exist. Creating ...
2019-06-17 05:42:04,203 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9e356dd9-90af-469f-bbd5-861c693d5e6e/ratis/a41aff18-03d1-4475-b6ec-87370791d1ed/in_use.lock acquired by nodename 4314@ozone-unit-076618677d395s9f-1644176229
2019-06-17 05:42:04,211 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9e356dd9-90af-469f-bbd5-861c693d5e6e/ratis/a41aff18-03d1-4475-b6ec-87370791d1ed has been successfully formatted.
2019-06-17 05:42:04,213 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 05:42:04,213 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 05:42:04,215 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 05:42:04,217 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 05:42:04,221 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 05:42:04,224 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 05:42:04,227 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 179f868b-0a9d-4919-aa41-71c68e299d7a-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9e356dd9-90af-469f-bbd5-861c693d5e6e/ratis/a41aff18-03d1-4475-b6ec-87370791d1ed
2019-06-17 05:42:04,228 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 05:42:04,228 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 05:42:04,230 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 05:42:04,230 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 05:42:04,231 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 05:42:04,231 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 05:42:04,232 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 05:42:04,232 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 05:42:04,233 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 05:42:04,235 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 05:42:04,240 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 05:42:04,241 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 05:42:04,241 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 05:42:04,373 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 179f868b-0a9d-4919-aa41-71c68e299d7a: start group-87370791D1ED
2019-06-17 05:42:04,374 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 179f868b-0a9d-4919-aa41-71c68e299d7a:group-87370791D1ED changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 05:42:04,376 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 179f868b-0a9d-4919-aa41-71c68e299d7a: start FollowerState
2019-06-17 05:42:04,378 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-87370791D1ED,id=179f868b-0a9d-4919-aa41-71c68e299d7a
2019-06-17 05:42:05,381 INFO  impl.FollowerState (FollowerState.java:run(101)) - 179f868b-0a9d-4919-aa41-71c68e299d7a:group-87370791D1ED changes to CANDIDATE, lastRpcTime:1006, electionTimeout:1005ms
2019-06-17 05:42:05,382 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 179f868b-0a9d-4919-aa41-71c68e299d7a: shutdown FollowerState
2019-06-17 05:42:05,382 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 179f868b-0a9d-4919-aa41-71c68e299d7a:group-87370791D1ED changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 05:42:05,383 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 179f868b-0a9d-4919-aa41-71c68e299d7a: start LeaderElection
2019-06-17 05:42:05,387 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 179f868b-0a9d-4919-aa41-71c68e299d7a:group-87370791D1ED:LeaderElection1: begin an election at term 1 for -1: [179f868b-0a9d-4919-aa41-71c68e299d7a:127.0.0.1:37643], old=null
2019-06-17 05:42:05,388 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 179f868b-0a9d-4919-aa41-71c68e299d7a: shutdown LeaderElection
2019-06-17 05:42:05,389 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 179f868b-0a9d-4919-aa41-71c68e299d7a:group-87370791D1ED changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 05:42:05,389 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 179f868b-0a9d-4919-aa41-71c68e299d7a:group-87370791D1ED change Leader from null to 179f868b-0a9d-4919-aa41-71c68e299d7a at term 1 for becomeLeader, leader elected after 1175ms
2019-06-17 05:42:05,393 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 05:42:05,393 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 05:42:05,395 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 05:42:05,396 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 05:42:05,405 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 179f868b-0a9d-4919-aa41-71c68e299d7a: start LeaderState
2019-06-17 05:42:05,419 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 179f868b-0a9d-4919-aa41-71c68e299d7a-RaftLogWorker: Starting segment from index:0
2019-06-17 05:42:05,426 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 179f868b-0a9d-4919-aa41-71c68e299d7a:group-87370791D1ED set configuration 0: [179f868b-0a9d-4919-aa41-71c68e299d7a:127.0.0.1:37643], old=null at 0
2019-06-17 05:42:05,577 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 179f868b-0a9d-4919-aa41-71c68e299d7a-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9e356dd9-90af-469f-bbd5-861c693d5e6e/ratis/a41aff18-03d1-4475-b6ec-87370791d1ed/current/log_inprogress_0
2019-06-17 05:42:06,632 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-17 05:42:06,694 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 6739356605786628928 is closed with bcsId 0.
2019-06-17 05:42:06,695 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 05:42:06,697 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 179f868b-0a9d-4919-aa41-71c68e299d7a: close
2019-06-17 05:42:06,699 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 179f868b-0a9d-4919-aa41-71c68e299d7a: shutdown group-87370791D1ED
2019-06-17 05:42:06,699 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-87370791D1ED,id=179f868b-0a9d-4919-aa41-71c68e299d7a
2019-06-17 05:42:06,699 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 179f868b-0a9d-4919-aa41-71c68e299d7a: shutdown LeaderState
2019-06-17 05:42:06,700 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 179f868b-0a9d-4919-aa41-71c68e299d7a-PendingRequests: sendNotLeaderResponses
2019-06-17 05:42:06,703 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-179f868b-0a9d-4919-aa41-71c68e299d7a-group-87370791D1ED: set stopIndex = 4
2019-06-17 05:42:06,703 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 05:42:06,703 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9e356dd9-90af-469f-bbd5-861c693d5e6e/ratis/a41aff18-03d1-4475-b6ec-87370791d1ed/sm/snapshot.1_4
2019-06-17 05:42:06,710 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 179f868b-0a9d-4919-aa41-71c68e299d7a:group-87370791D1ED closes. The last applied log index is 4
2019-06-17 05:42:06,712 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 179f868b-0a9d-4919-aa41-71c68e299d7a-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 05:42:06,713 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 179f868b-0a9d-4919-aa41-71c68e299d7a-RaftLogWorker close()
2019-06-17 05:42:06,714 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 179f868b-0a9d-4919-aa41-71c68e299d7a: shutdown server with port 37643 now
2019-06-17 05:42:06,719 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 179f868b-0a9d-4919-aa41-71c68e299d7a: shutdown server with port 37643 successfully
2019-06-17 05:42:06,732 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 05:42:06,766 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb4051e33-fab5-4610-951a-0f36832c3a53/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 05:42:06,766 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb4051e33-fab5-4610-951a-0f36832c3a53/hdds to VolumeSet
2019-06-17 05:42:06,767 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@655523dd
2019-06-17 05:42:06,768 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@655523dd
2019-06-17 05:42:06,780 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 34345
2019-06-17 05:42:06,781 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 05:42:06,782 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 05:42:06,782 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 34345 (custom)
2019-06-17 05:42:06,782 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 05:42:06,783 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 05:42:06,783 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 05:42:06,783 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 05:42:06,784 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb4051e33-fab5-4610-951a-0f36832c3a53/ratis] (custom)
2019-06-17 05:42:06,785 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 33043
2019-06-17 05:42:06,785 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 05:42:06,785 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 05:42:06,785 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis b58fdc2d-04b4-4830-9ca3-fda19666c92a at port 34345
2019-06-17 05:42:06,832 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a: start RPC server
2019-06-17 05:42:06,833 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a: GrpcService started, listening on 0.0.0.0/0.0.0.0:34345
2019-06-17 05:42:06,849 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a: addNew group-6C18C5F5EB9F:[b58fdc2d-04b4-4830-9ca3-fda19666c92a:127.0.0.1:34345] returns group-6C18C5F5EB9F:java.util.concurrent.CompletableFuture@480df7d4[Not completed]
2019-06-17 05:42:06,850 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a: new RaftServerImpl for group-6C18C5F5EB9F:[b58fdc2d-04b4-4830-9ca3-fda19666c92a:127.0.0.1:34345] with ContainerStateMachine:uninitialized
2019-06-17 05:42:06,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 05:42:06,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 05:42:06,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 05:42:06,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 05:42:06,851 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a:group-6C18C5F5EB9F ConfigurationManager, init=-1: [b58fdc2d-04b4-4830-9ca3-fda19666c92a:127.0.0.1:34345], old=null, confs=<EMPTY_MAP>
2019-06-17 05:42:06,851 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb4051e33-fab5-4610-951a-0f36832c3a53/ratis] (custom)
2019-06-17 05:42:06,851 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb4051e33-fab5-4610-951a-0f36832c3a53/ratis/f7ea6a00-95f5-4c11-8a29-6c18c5f5eb9f does not exist. Creating ...
2019-06-17 05:42:06,854 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb4051e33-fab5-4610-951a-0f36832c3a53/ratis/f7ea6a00-95f5-4c11-8a29-6c18c5f5eb9f/in_use.lock acquired by nodename 4314@ozone-unit-076618677d395s9f-1644176229
2019-06-17 05:42:06,856 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb4051e33-fab5-4610-951a-0f36832c3a53/ratis/f7ea6a00-95f5-4c11-8a29-6c18c5f5eb9f has been successfully formatted.
2019-06-17 05:42:06,856 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 05:42:06,856 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 05:42:06,856 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 05:42:06,856 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 05:42:06,857 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 05:42:06,857 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 05:42:06,857 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new b58fdc2d-04b4-4830-9ca3-fda19666c92a-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb4051e33-fab5-4610-951a-0f36832c3a53/ratis/f7ea6a00-95f5-4c11-8a29-6c18c5f5eb9f
2019-06-17 05:42:06,857 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 05:42:06,857 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 05:42:06,857 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 05:42:06,858 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 05:42:06,858 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 05:42:06,858 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 05:42:06,858 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 05:42:06,858 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 05:42:06,858 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 05:42:06,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 05:42:06,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 05:42:06,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 05:42:06,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 05:42:06,860 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a: start group-6C18C5F5EB9F
2019-06-17 05:42:06,860 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a:group-6C18C5F5EB9F changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 05:42:06,860 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a: start FollowerState
2019-06-17 05:42:06,860 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-6C18C5F5EB9F,id=b58fdc2d-04b4-4830-9ca3-fda19666c92a
2019-06-17 05:42:07,934 INFO  impl.FollowerState (FollowerState.java:run(101)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a:group-6C18C5F5EB9F changes to CANDIDATE, lastRpcTime:1074, electionTimeout:1074ms
2019-06-17 05:42:07,935 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a: shutdown FollowerState
2019-06-17 05:42:07,935 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a:group-6C18C5F5EB9F changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 05:42:07,935 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a: start LeaderElection
2019-06-17 05:42:07,939 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a:group-6C18C5F5EB9F:LeaderElection2: begin an election at term 1 for -1: [b58fdc2d-04b4-4830-9ca3-fda19666c92a:127.0.0.1:34345], old=null
2019-06-17 05:42:07,939 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a: shutdown LeaderElection
2019-06-17 05:42:07,940 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a:group-6C18C5F5EB9F changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 05:42:07,940 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a:group-6C18C5F5EB9F change Leader from null to b58fdc2d-04b4-4830-9ca3-fda19666c92a at term 1 for becomeLeader, leader elected after 1083ms
2019-06-17 05:42:07,940 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 05:42:07,940 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 05:42:07,940 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 05:42:07,940 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 05:42:07,941 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a: start LeaderState
2019-06-17 05:42:07,941 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a-RaftLogWorker: Starting segment from index:0
2019-06-17 05:42:07,941 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a:group-6C18C5F5EB9F set configuration 0: [b58fdc2d-04b4-4830-9ca3-fda19666c92a:127.0.0.1:34345], old=null at 0
2019-06-17 05:42:07,987 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb4051e33-fab5-4610-951a-0f36832c3a53/ratis/f7ea6a00-95f5-4c11-8a29-6c18c5f5eb9f/current/log_inprogress_0
2019-06-17 05:42:08,899 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 05:42:08,902 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a: close
2019-06-17 05:42:08,902 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a: shutdown group-6C18C5F5EB9F
2019-06-17 05:42:08,903 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-6C18C5F5EB9F,id=b58fdc2d-04b4-4830-9ca3-fda19666c92a
2019-06-17 05:42:08,903 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a: shutdown LeaderState
2019-06-17 05:42:08,904 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a-PendingRequests: sendNotLeaderResponses
2019-06-17 05:42:08,905 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-b58fdc2d-04b4-4830-9ca3-fda19666c92a-group-6C18C5F5EB9F: set stopIndex = 2
2019-06-17 05:42:08,905 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 05:42:08,905 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb4051e33-fab5-4610-951a-0f36832c3a53/ratis/f7ea6a00-95f5-4c11-8a29-6c18c5f5eb9f/sm/snapshot.1_2
2019-06-17 05:42:08,906 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a:group-6C18C5F5EB9F closes. The last applied log index is 2
2019-06-17 05:42:08,906 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 05:42:08,907 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a-RaftLogWorker close()
2019-06-17 05:42:08,908 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a: shutdown server with port 34345 now
2019-06-17 05:42:08,909 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - b58fdc2d-04b4-4830-9ca3-fda19666c92a: shutdown server with port 34345 successfully
2019-06-17 05:42:08,912 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 05:42:08,950 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5449ed9b-a4da-4e7d-bab1-cd3a470919ac/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 05:42:08,950 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5449ed9b-a4da-4e7d-bab1-cd3a470919ac/hdds to VolumeSet
2019-06-17 05:42:08,950 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@dc7b462
2019-06-17 05:42:08,951 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@dc7b462
2019-06-17 05:42:08,969 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 44465
2019-06-17 05:42:08,970 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 05:42:08,970 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 05:42:08,971 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 44465 (custom)
2019-06-17 05:42:08,971 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 05:42:08,971 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 05:42:08,971 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 05:42:08,972 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 05:42:08,972 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5449ed9b-a4da-4e7d-bab1-cd3a470919ac/ratis] (custom)
2019-06-17 05:42:08,973 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 38167
2019-06-17 05:42:08,973 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 05:42:08,973 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 05:42:08,973 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 757b66e2-089d-48ba-a100-4d20a960034f at port 44465
2019-06-17 05:42:08,984 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 757b66e2-089d-48ba-a100-4d20a960034f: start RPC server
2019-06-17 05:42:08,985 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 757b66e2-089d-48ba-a100-4d20a960034f: GrpcService started, listening on 0.0.0.0/0.0.0.0:44465
2019-06-17 05:42:08,997 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 757b66e2-089d-48ba-a100-4d20a960034f: addNew group-C4B6AB5F7467:[757b66e2-089d-48ba-a100-4d20a960034f:127.0.0.1:44465] returns group-C4B6AB5F7467:java.util.concurrent.CompletableFuture@7b38dab8[Not completed]
2019-06-17 05:42:08,998 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 757b66e2-089d-48ba-a100-4d20a960034f: new RaftServerImpl for group-C4B6AB5F7467:[757b66e2-089d-48ba-a100-4d20a960034f:127.0.0.1:44465] with ContainerStateMachine:uninitialized
2019-06-17 05:42:08,999 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 05:42:08,999 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 05:42:08,999 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 05:42:08,999 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 05:42:08,999 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 757b66e2-089d-48ba-a100-4d20a960034f:group-C4B6AB5F7467 ConfigurationManager, init=-1: [757b66e2-089d-48ba-a100-4d20a960034f:127.0.0.1:44465], old=null, confs=<EMPTY_MAP>
2019-06-17 05:42:09,000 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5449ed9b-a4da-4e7d-bab1-cd3a470919ac/ratis] (custom)
2019-06-17 05:42:09,000 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5449ed9b-a4da-4e7d-bab1-cd3a470919ac/ratis/3982dc78-be72-479a-aec7-c4b6ab5f7467 does not exist. Creating ...
2019-06-17 05:42:09,003 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5449ed9b-a4da-4e7d-bab1-cd3a470919ac/ratis/3982dc78-be72-479a-aec7-c4b6ab5f7467/in_use.lock acquired by nodename 4314@ozone-unit-076618677d395s9f-1644176229
2019-06-17 05:42:09,005 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5449ed9b-a4da-4e7d-bab1-cd3a470919ac/ratis/3982dc78-be72-479a-aec7-c4b6ab5f7467 has been successfully formatted.
2019-06-17 05:42:09,005 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 05:42:09,005 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 05:42:09,005 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 05:42:09,006 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 05:42:09,006 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 05:42:09,006 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 05:42:09,006 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 757b66e2-089d-48ba-a100-4d20a960034f-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5449ed9b-a4da-4e7d-bab1-cd3a470919ac/ratis/3982dc78-be72-479a-aec7-c4b6ab5f7467
2019-06-17 05:42:09,006 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 05:42:09,006 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 05:42:09,006 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 05:42:09,006 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 05:42:09,007 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 05:42:09,007 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 05:42:09,007 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 05:42:09,007 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 05:42:09,007 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 05:42:09,007 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 05:42:09,010 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 05:42:09,010 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 05:42:09,011 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 05:42:09,011 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 757b66e2-089d-48ba-a100-4d20a960034f: start group-C4B6AB5F7467
2019-06-17 05:42:09,011 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 757b66e2-089d-48ba-a100-4d20a960034f:group-C4B6AB5F7467 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 05:42:09,011 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 757b66e2-089d-48ba-a100-4d20a960034f: start FollowerState
2019-06-17 05:42:09,011 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C4B6AB5F7467,id=757b66e2-089d-48ba-a100-4d20a960034f
2019-06-17 05:42:10,078 INFO  impl.FollowerState (FollowerState.java:run(101)) - 757b66e2-089d-48ba-a100-4d20a960034f:group-C4B6AB5F7467 changes to CANDIDATE, lastRpcTime:1067, electionTimeout:1067ms
2019-06-17 05:42:10,079 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 757b66e2-089d-48ba-a100-4d20a960034f: shutdown FollowerState
2019-06-17 05:42:10,079 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 757b66e2-089d-48ba-a100-4d20a960034f:group-C4B6AB5F7467 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 05:42:10,079 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 757b66e2-089d-48ba-a100-4d20a960034f: start LeaderElection
2019-06-17 05:42:10,082 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 757b66e2-089d-48ba-a100-4d20a960034f:group-C4B6AB5F7467:LeaderElection3: begin an election at term 1 for -1: [757b66e2-089d-48ba-a100-4d20a960034f:127.0.0.1:44465], old=null
2019-06-17 05:42:10,082 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 757b66e2-089d-48ba-a100-4d20a960034f: shutdown LeaderElection
2019-06-17 05:42:10,083 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 757b66e2-089d-48ba-a100-4d20a960034f:group-C4B6AB5F7467 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 05:42:10,083 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 757b66e2-089d-48ba-a100-4d20a960034f:group-C4B6AB5F7467 change Leader from null to 757b66e2-089d-48ba-a100-4d20a960034f at term 1 for becomeLeader, leader elected after 1077ms
2019-06-17 05:42:10,083 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 05:42:10,083 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 05:42:10,083 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 05:42:10,083 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 05:42:10,084 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 757b66e2-089d-48ba-a100-4d20a960034f: start LeaderState
2019-06-17 05:42:10,084 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 757b66e2-089d-48ba-a100-4d20a960034f-RaftLogWorker: Starting segment from index:0
2019-06-17 05:42:10,084 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 757b66e2-089d-48ba-a100-4d20a960034f:group-C4B6AB5F7467 set configuration 0: [757b66e2-089d-48ba-a100-4d20a960034f:127.0.0.1:44465], old=null at 0
2019-06-17 05:42:10,131 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 757b66e2-089d-48ba-a100-4d20a960034f-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5449ed9b-a4da-4e7d-bab1-cd3a470919ac/ratis/3982dc78-be72-479a-aec7-c4b6ab5f7467/current/log_inprogress_0
2019-06-17 05:42:11,060 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 3438967593271053389 is closed with bcsId 0.
2019-06-17 05:42:11,061 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 05:42:11,064 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 757b66e2-089d-48ba-a100-4d20a960034f: close
2019-06-17 05:42:11,065 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 757b66e2-089d-48ba-a100-4d20a960034f: shutdown group-C4B6AB5F7467
2019-06-17 05:42:11,065 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C4B6AB5F7467,id=757b66e2-089d-48ba-a100-4d20a960034f
2019-06-17 05:42:11,065 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 757b66e2-089d-48ba-a100-4d20a960034f: shutdown LeaderState
2019-06-17 05:42:11,066 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 757b66e2-089d-48ba-a100-4d20a960034f-PendingRequests: sendNotLeaderResponses
2019-06-17 05:42:11,067 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-757b66e2-089d-48ba-a100-4d20a960034f-group-C4B6AB5F7467: set stopIndex = 2
2019-06-17 05:42:11,067 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 05:42:11,067 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5449ed9b-a4da-4e7d-bab1-cd3a470919ac/ratis/3982dc78-be72-479a-aec7-c4b6ab5f7467/sm/snapshot.1_2
2019-06-17 05:42:11,068 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 757b66e2-089d-48ba-a100-4d20a960034f:group-C4B6AB5F7467 closes. The last applied log index is 2
2019-06-17 05:42:11,068 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 757b66e2-089d-48ba-a100-4d20a960034f-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 05:42:11,069 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 757b66e2-089d-48ba-a100-4d20a960034f-RaftLogWorker close()
2019-06-17 05:42:11,070 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 757b66e2-089d-48ba-a100-4d20a960034f: shutdown server with port 44465 now
2019-06-17 05:42:11,073 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 757b66e2-089d-48ba-a100-4d20a960034f: shutdown server with port 44465 successfully
2019-06-17 05:42:11,076 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 05:42:11,110 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleraec9b2ee-930a-40ff-acd0-3d562d40b7b2/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 05:42:11,110 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleraec9b2ee-930a-40ff-acd0-3d562d40b7b2/hdds to VolumeSet
2019-06-17 05:42:11,111 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3971f0fe
2019-06-17 05:42:11,111 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3971f0fe
2019-06-17 05:42:11,122 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 35103
2019-06-17 05:42:11,123 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 05:42:11,124 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 05:42:11,124 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 35103 (custom)
2019-06-17 05:42:11,124 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 05:42:11,125 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 05:42:11,125 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 05:42:11,125 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 05:42:11,126 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleraec9b2ee-930a-40ff-acd0-3d562d40b7b2/ratis] (custom)
2019-06-17 05:42:11,126 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 36027
2019-06-17 05:42:11,127 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 05:42:11,127 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 05:42:11,127 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis df9907a2-5880-449e-b20c-1c219947a300 at port 35103
2019-06-17 05:42:11,135 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - df9907a2-5880-449e-b20c-1c219947a300: start RPC server
2019-06-17 05:42:11,136 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - df9907a2-5880-449e-b20c-1c219947a300: GrpcService started, listening on 0.0.0.0/0.0.0.0:35103
Jun 17, 2019 5:42:11 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:34345} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 17, 2019 5:42:11 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:44465} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-17 05:42:11,153 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - df9907a2-5880-449e-b20c-1c219947a300: addNew group-3F947991AFCD:[df9907a2-5880-449e-b20c-1c219947a300:127.0.0.1:35103] returns group-3F947991AFCD:java.util.concurrent.CompletableFuture@1ca356c[Not completed]
2019-06-17 05:42:11,154 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - df9907a2-5880-449e-b20c-1c219947a300: new RaftServerImpl for group-3F947991AFCD:[df9907a2-5880-449e-b20c-1c219947a300:127.0.0.1:35103] with ContainerStateMachine:uninitialized
2019-06-17 05:42:11,154 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 05:42:11,154 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 05:42:11,155 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 05:42:11,155 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 05:42:11,155 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - df9907a2-5880-449e-b20c-1c219947a300:group-3F947991AFCD ConfigurationManager, init=-1: [df9907a2-5880-449e-b20c-1c219947a300:127.0.0.1:35103], old=null, confs=<EMPTY_MAP>
2019-06-17 05:42:11,155 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleraec9b2ee-930a-40ff-acd0-3d562d40b7b2/ratis] (custom)
2019-06-17 05:42:11,155 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleraec9b2ee-930a-40ff-acd0-3d562d40b7b2/ratis/02a8f2e1-07e7-43a3-bc04-3f947991afcd does not exist. Creating ...
2019-06-17 05:42:11,158 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleraec9b2ee-930a-40ff-acd0-3d562d40b7b2/ratis/02a8f2e1-07e7-43a3-bc04-3f947991afcd/in_use.lock acquired by nodename 4314@ozone-unit-076618677d395s9f-1644176229
2019-06-17 05:42:11,160 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleraec9b2ee-930a-40ff-acd0-3d562d40b7b2/ratis/02a8f2e1-07e7-43a3-bc04-3f947991afcd has been successfully formatted.
2019-06-17 05:42:11,160 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 05:42:11,161 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 05:42:11,161 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 05:42:11,161 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 05:42:11,161 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 05:42:11,161 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 05:42:11,161 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new df9907a2-5880-449e-b20c-1c219947a300-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleraec9b2ee-930a-40ff-acd0-3d562d40b7b2/ratis/02a8f2e1-07e7-43a3-bc04-3f947991afcd
2019-06-17 05:42:11,161 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 05:42:11,162 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 05:42:11,162 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 05:42:11,162 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 05:42:11,162 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 05:42:11,162 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 05:42:11,162 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 05:42:11,162 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 05:42:11,162 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 05:42:11,163 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 05:42:11,164 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 05:42:11,164 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 05:42:11,164 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 05:42:11,165 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - df9907a2-5880-449e-b20c-1c219947a300: start group-3F947991AFCD
2019-06-17 05:42:11,165 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - df9907a2-5880-449e-b20c-1c219947a300:group-3F947991AFCD changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 05:42:11,165 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - df9907a2-5880-449e-b20c-1c219947a300: start FollowerState
2019-06-17 05:42:11,166 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-3F947991AFCD,id=df9907a2-5880-449e-b20c-1c219947a300
2019-06-17 05:42:12,190 INFO  impl.FollowerState (FollowerState.java:run(101)) - df9907a2-5880-449e-b20c-1c219947a300:group-3F947991AFCD changes to CANDIDATE, lastRpcTime:1024, electionTimeout:1024ms
2019-06-17 05:42:12,190 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - df9907a2-5880-449e-b20c-1c219947a300: shutdown FollowerState
2019-06-17 05:42:12,190 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - df9907a2-5880-449e-b20c-1c219947a300:group-3F947991AFCD changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 05:42:12,190 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - df9907a2-5880-449e-b20c-1c219947a300: start LeaderElection
2019-06-17 05:42:12,193 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - df9907a2-5880-449e-b20c-1c219947a300:group-3F947991AFCD:LeaderElection4: begin an election at term 1 for -1: [df9907a2-5880-449e-b20c-1c219947a300:127.0.0.1:35103], old=null
2019-06-17 05:42:12,194 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - df9907a2-5880-449e-b20c-1c219947a300: shutdown LeaderElection
2019-06-17 05:42:12,194 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - df9907a2-5880-449e-b20c-1c219947a300:group-3F947991AFCD changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 05:42:12,194 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - df9907a2-5880-449e-b20c-1c219947a300:group-3F947991AFCD change Leader from null to df9907a2-5880-449e-b20c-1c219947a300 at term 1 for becomeLeader, leader elected after 1033ms
2019-06-17 05:42:12,194 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 05:42:12,194 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 05:42:12,194 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 05:42:12,194 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 05:42:12,195 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - df9907a2-5880-449e-b20c-1c219947a300: start LeaderState
2019-06-17 05:42:12,195 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - df9907a2-5880-449e-b20c-1c219947a300-RaftLogWorker: Starting segment from index:0
2019-06-17 05:42:12,195 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - df9907a2-5880-449e-b20c-1c219947a300:group-3F947991AFCD set configuration 0: [df9907a2-5880-449e-b20c-1c219947a300:127.0.0.1:35103], old=null at 0
2019-06-17 05:42:12,235 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - df9907a2-5880-449e-b20c-1c219947a300-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleraec9b2ee-930a-40ff-acd0-3d562d40b7b2/ratis/02a8f2e1-07e7-43a3-bc04-3f947991afcd/current/log_inprogress_0
2019-06-17 05:42:13,208 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 8247469397405965364 is closed with bcsId 0.
2019-06-17 05:42:13,208 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 05:42:13,209 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - df9907a2-5880-449e-b20c-1c219947a300: close
2019-06-17 05:42:13,209 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - df9907a2-5880-449e-b20c-1c219947a300: shutdown group-3F947991AFCD
2019-06-17 05:42:13,209 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-3F947991AFCD,id=df9907a2-5880-449e-b20c-1c219947a300
2019-06-17 05:42:13,209 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - df9907a2-5880-449e-b20c-1c219947a300: shutdown LeaderState
2019-06-17 05:42:13,210 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - df9907a2-5880-449e-b20c-1c219947a300-PendingRequests: sendNotLeaderResponses
2019-06-17 05:42:13,211 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-df9907a2-5880-449e-b20c-1c219947a300-group-3F947991AFCD: set stopIndex = 2
2019-06-17 05:42:13,211 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 05:42:13,212 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleraec9b2ee-930a-40ff-acd0-3d562d40b7b2/ratis/02a8f2e1-07e7-43a3-bc04-3f947991afcd/sm/snapshot.1_2
2019-06-17 05:42:13,212 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - df9907a2-5880-449e-b20c-1c219947a300:group-3F947991AFCD closes. The last applied log index is 2
2019-06-17 05:42:13,212 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - df9907a2-5880-449e-b20c-1c219947a300-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 05:42:13,213 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - df9907a2-5880-449e-b20c-1c219947a300-RaftLogWorker close()
2019-06-17 05:42:13,214 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - df9907a2-5880-449e-b20c-1c219947a300: shutdown server with port 35103 now
2019-06-17 05:42:13,215 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - df9907a2-5880-449e-b20c-1c219947a300: shutdown server with port 35103 successfully
2019-06-17 05:42:13,223 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 05:42:13,247 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler75f2bb75-9000-4a3b-9d06-c80b0c25feee/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 05:42:13,247 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler75f2bb75-9000-4a3b-9d06-c80b0c25feee/hdds to VolumeSet
2019-06-17 05:42:13,248 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@4fad6218
2019-06-17 05:42:13,248 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@4fad6218
2019-06-17 05:42:13,262 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 37327
2019-06-17 05:42:13,263 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 05:42:13,264 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 05:42:13,264 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 37327 (custom)
2019-06-17 05:42:13,264 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 05:42:13,264 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 05:42:13,265 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 05:42:13,265 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 05:42:13,265 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler75f2bb75-9000-4a3b-9d06-c80b0c25feee/ratis] (custom)
2019-06-17 05:42:13,266 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 45463
2019-06-17 05:42:13,266 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 05:42:13,266 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 05:42:13,266 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 9e34c53b-4a1b-4124-a89d-cd145a383c5f at port 37327
2019-06-17 05:42:13,276 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f: start RPC server
2019-06-17 05:42:13,278 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f: GrpcService started, listening on 0.0.0.0/0.0.0.0:37327
2019-06-17 05:42:13,288 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f: addNew group-D73C0DEA6459:[9e34c53b-4a1b-4124-a89d-cd145a383c5f:127.0.0.1:37327] returns group-D73C0DEA6459:java.util.concurrent.CompletableFuture@28e47e61[Not completed]
2019-06-17 05:42:13,288 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f: new RaftServerImpl for group-D73C0DEA6459:[9e34c53b-4a1b-4124-a89d-cd145a383c5f:127.0.0.1:37327] with ContainerStateMachine:uninitialized
2019-06-17 05:42:13,289 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 05:42:13,289 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 05:42:13,289 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 05:42:13,289 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 05:42:13,289 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f:group-D73C0DEA6459 ConfigurationManager, init=-1: [9e34c53b-4a1b-4124-a89d-cd145a383c5f:127.0.0.1:37327], old=null, confs=<EMPTY_MAP>
2019-06-17 05:42:13,290 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler75f2bb75-9000-4a3b-9d06-c80b0c25feee/ratis] (custom)
2019-06-17 05:42:13,290 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler75f2bb75-9000-4a3b-9d06-c80b0c25feee/ratis/5368a945-eac8-40ee-976f-d73c0dea6459 does not exist. Creating ...
2019-06-17 05:42:13,292 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler75f2bb75-9000-4a3b-9d06-c80b0c25feee/ratis/5368a945-eac8-40ee-976f-d73c0dea6459/in_use.lock acquired by nodename 4314@ozone-unit-076618677d395s9f-1644176229
2019-06-17 05:42:13,294 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler75f2bb75-9000-4a3b-9d06-c80b0c25feee/ratis/5368a945-eac8-40ee-976f-d73c0dea6459 has been successfully formatted.
2019-06-17 05:42:13,295 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 05:42:13,295 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 05:42:13,295 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 05:42:13,295 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 05:42:13,295 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 05:42:13,295 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 05:42:13,296 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 9e34c53b-4a1b-4124-a89d-cd145a383c5f-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler75f2bb75-9000-4a3b-9d06-c80b0c25feee/ratis/5368a945-eac8-40ee-976f-d73c0dea6459
2019-06-17 05:42:13,296 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 05:42:13,296 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 05:42:13,296 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 05:42:13,296 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 05:42:13,296 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 05:42:13,296 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 05:42:13,296 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 05:42:13,297 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 05:42:13,297 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 05:42:13,297 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 05:42:13,297 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 05:42:13,297 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 05:42:13,297 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 05:42:13,298 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f: start group-D73C0DEA6459
2019-06-17 05:42:13,298 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f:group-D73C0DEA6459 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 05:42:13,298 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f: start FollowerState
2019-06-17 05:42:13,298 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D73C0DEA6459,id=9e34c53b-4a1b-4124-a89d-cd145a383c5f
2019-06-17 05:42:14,436 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f:group-D73C0DEA6459 changes to CANDIDATE, lastRpcTime:1138, electionTimeout:1138ms
2019-06-17 05:42:14,437 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f: shutdown FollowerState
2019-06-17 05:42:14,437 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f:group-D73C0DEA6459 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 05:42:14,437 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f: start LeaderElection
2019-06-17 05:42:14,440 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f:group-D73C0DEA6459:LeaderElection5: begin an election at term 1 for -1: [9e34c53b-4a1b-4124-a89d-cd145a383c5f:127.0.0.1:37327], old=null
2019-06-17 05:42:14,440 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f: shutdown LeaderElection
2019-06-17 05:42:14,440 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f:group-D73C0DEA6459 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 05:42:14,440 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f:group-D73C0DEA6459 change Leader from null to 9e34c53b-4a1b-4124-a89d-cd145a383c5f at term 1 for becomeLeader, leader elected after 1145ms
2019-06-17 05:42:14,441 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 05:42:14,441 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 05:42:14,441 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 05:42:14,441 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 05:42:14,441 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f: start LeaderState
2019-06-17 05:42:14,441 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f-RaftLogWorker: Starting segment from index:0
2019-06-17 05:42:14,442 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f:group-D73C0DEA6459 set configuration 0: [9e34c53b-4a1b-4124-a89d-cd145a383c5f:127.0.0.1:37327], old=null at 0
2019-06-17 05:42:14,482 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler75f2bb75-9000-4a3b-9d06-c80b0c25feee/ratis/5368a945-eac8-40ee-976f-d73c0dea6459/current/log_inprogress_0
2019-06-17 05:42:15,342 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 8091194137021066614 is closed with bcsId 0.
2019-06-17 05:42:15,342 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 05:42:15,343 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f: close
2019-06-17 05:42:15,343 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f: shutdown group-D73C0DEA6459
2019-06-17 05:42:15,343 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D73C0DEA6459,id=9e34c53b-4a1b-4124-a89d-cd145a383c5f
2019-06-17 05:42:15,343 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f: shutdown LeaderState
2019-06-17 05:42:15,344 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f-PendingRequests: sendNotLeaderResponses
2019-06-17 05:42:15,345 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-9e34c53b-4a1b-4124-a89d-cd145a383c5f-group-D73C0DEA6459: set stopIndex = 4
2019-06-17 05:42:15,346 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 05:42:15,346 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler75f2bb75-9000-4a3b-9d06-c80b0c25feee/ratis/5368a945-eac8-40ee-976f-d73c0dea6459/sm/snapshot.1_4
2019-06-17 05:42:15,346 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f:group-D73C0DEA6459 closes. The last applied log index is 4
2019-06-17 05:42:15,346 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 05:42:15,347 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f-RaftLogWorker close()
2019-06-17 05:42:15,347 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f: shutdown server with port 37327 now
2019-06-17 05:42:15,349 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 9e34c53b-4a1b-4124-a89d-cd145a383c5f: shutdown server with port 37327 successfully
2019-06-17 05:42:15,353 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
