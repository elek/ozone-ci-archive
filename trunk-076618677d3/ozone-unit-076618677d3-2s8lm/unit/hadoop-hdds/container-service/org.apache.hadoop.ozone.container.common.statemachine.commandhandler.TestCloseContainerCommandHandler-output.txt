2019-06-15 14:56:57,651 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1cfc81b4-7d3f-438b-81d1-56308f12b67e/hdds of  storage type : DISK and capacity : 104021790720
2019-06-15 14:56:57,655 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1cfc81b4-7d3f-438b-81d1-56308f12b67e/hdds to VolumeSet
2019-06-15 14:56:57,665 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-15 14:56:57,707 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-15 14:56:58,031 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 37863
2019-06-15 14:56:58,421 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-15 14:56:58,443 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-15 14:56:58,451 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 37863 (custom)
2019-06-15 14:56:58,452 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-15 14:56:58,455 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 14:56:58,456 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-15 14:56:58,456 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-15 14:56:58,575 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1cfc81b4-7d3f-438b-81d1-56308f12b67e/ratis] (custom)
2019-06-15 14:56:58,585 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 39197
2019-06-15 14:56:58,603 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-15 14:56:58,603 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-15 14:56:58,604 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis e01de320-d394-4d44-bf22-124218123592 at port 37863
2019-06-15 14:56:58,615 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - e01de320-d394-4d44-bf22-124218123592: start RPC server
2019-06-15 14:56:58,735 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - e01de320-d394-4d44-bf22-124218123592: GrpcService started, listening on 0.0.0.0/0.0.0.0:37863
2019-06-15 14:56:59,019 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e01de320-d394-4d44-bf22-124218123592: addNew group-E69C1C55504C:[e01de320-d394-4d44-bf22-124218123592:127.0.0.1:37863] returns group-E69C1C55504C:java.util.concurrent.CompletableFuture@2ad4f85b[Not completed]
2019-06-15 14:56:59,047 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - e01de320-d394-4d44-bf22-124218123592: new RaftServerImpl for group-E69C1C55504C:[e01de320-d394-4d44-bf22-124218123592:127.0.0.1:37863] with ContainerStateMachine:uninitialized
2019-06-15 14:56:59,048 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-15 14:56:59,048 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-15 14:56:59,048 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-15 14:56:59,049 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-15 14:56:59,053 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - e01de320-d394-4d44-bf22-124218123592:group-E69C1C55504C ConfigurationManager, init=-1: [e01de320-d394-4d44-bf22-124218123592:127.0.0.1:37863], old=null, confs=<EMPTY_MAP>
2019-06-15 14:56:59,054 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1cfc81b4-7d3f-438b-81d1-56308f12b67e/ratis] (custom)
2019-06-15 14:56:59,060 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1cfc81b4-7d3f-438b-81d1-56308f12b67e/ratis/e8bb858b-1c65-4916-b36c-e69c1c55504c does not exist. Creating ...
2019-06-15 14:56:59,068 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1cfc81b4-7d3f-438b-81d1-56308f12b67e/ratis/e8bb858b-1c65-4916-b36c-e69c1c55504c/in_use.lock acquired by nodename 4301@ozone-unit-076618677d3-2s8lm-491337942
2019-06-15 14:56:59,074 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1cfc81b4-7d3f-438b-81d1-56308f12b67e/ratis/e8bb858b-1c65-4916-b36c-e69c1c55504c has been successfully formatted.
2019-06-15 14:56:59,076 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-15 14:56:59,077 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-15 14:56:59,078 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-15 14:56:59,080 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 14:56:59,083 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 14:56:59,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-15 14:56:59,088 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new e01de320-d394-4d44-bf22-124218123592-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1cfc81b4-7d3f-438b-81d1-56308f12b67e/ratis/e8bb858b-1c65-4916-b36c-e69c1c55504c
2019-06-15 14:56:59,089 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-15 14:56:59,089 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-15 14:56:59,091 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 14:56:59,091 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-15 14:56:59,091 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-15 14:56:59,092 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-15 14:56:59,092 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-15 14:56:59,093 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-15 14:56:59,093 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-15 14:56:59,095 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-15 14:56:59,100 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-15 14:56:59,101 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-15 14:56:59,101 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-15 14:56:59,209 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - e01de320-d394-4d44-bf22-124218123592: start group-E69C1C55504C
2019-06-15 14:56:59,209 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - e01de320-d394-4d44-bf22-124218123592:group-E69C1C55504C changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-15 14:56:59,210 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e01de320-d394-4d44-bf22-124218123592: start FollowerState
2019-06-15 14:56:59,212 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-E69C1C55504C,id=e01de320-d394-4d44-bf22-124218123592
2019-06-15 14:57:00,217 INFO  impl.FollowerState (FollowerState.java:run(101)) - e01de320-d394-4d44-bf22-124218123592:group-E69C1C55504C changes to CANDIDATE, lastRpcTime:1006, electionTimeout:1006ms
2019-06-15 14:57:00,217 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e01de320-d394-4d44-bf22-124218123592: shutdown FollowerState
2019-06-15 14:57:00,217 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - e01de320-d394-4d44-bf22-124218123592:group-E69C1C55504C changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-15 14:57:00,219 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e01de320-d394-4d44-bf22-124218123592: start LeaderElection
2019-06-15 14:57:00,222 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - e01de320-d394-4d44-bf22-124218123592:group-E69C1C55504C:LeaderElection1: begin an election at term 1 for -1: [e01de320-d394-4d44-bf22-124218123592:127.0.0.1:37863], old=null
2019-06-15 14:57:00,223 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e01de320-d394-4d44-bf22-124218123592: shutdown LeaderElection
2019-06-15 14:57:00,223 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - e01de320-d394-4d44-bf22-124218123592:group-E69C1C55504C changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-15 14:57:00,223 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - e01de320-d394-4d44-bf22-124218123592:group-E69C1C55504C change Leader from null to e01de320-d394-4d44-bf22-124218123592 at term 1 for becomeLeader, leader elected after 1146ms
2019-06-15 14:57:00,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-15 14:57:00,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-15 14:57:00,229 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-15 14:57:00,229 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-15 14:57:00,238 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e01de320-d394-4d44-bf22-124218123592: start LeaderState
2019-06-15 14:57:00,249 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - e01de320-d394-4d44-bf22-124218123592-RaftLogWorker: Starting segment from index:0
2019-06-15 14:57:00,256 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - e01de320-d394-4d44-bf22-124218123592:group-E69C1C55504C set configuration 0: [e01de320-d394-4d44-bf22-124218123592:127.0.0.1:37863], old=null at 0
2019-06-15 14:57:00,376 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - e01de320-d394-4d44-bf22-124218123592-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1cfc81b4-7d3f-438b-81d1-56308f12b67e/ratis/e8bb858b-1c65-4916-b36c-e69c1c55504c/current/log_inprogress_0
2019-06-15 14:57:01,423 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-15 14:57:01,479 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 6671019177030955246 is closed with bcsId 0.
2019-06-15 14:57:01,480 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-15 14:57:01,481 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - e01de320-d394-4d44-bf22-124218123592: close
2019-06-15 14:57:01,482 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - e01de320-d394-4d44-bf22-124218123592: shutdown group-E69C1C55504C
2019-06-15 14:57:01,483 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-E69C1C55504C,id=e01de320-d394-4d44-bf22-124218123592
2019-06-15 14:57:01,483 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e01de320-d394-4d44-bf22-124218123592: shutdown LeaderState
2019-06-15 14:57:01,483 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - e01de320-d394-4d44-bf22-124218123592-PendingRequests: sendNotLeaderResponses
2019-06-15 14:57:01,485 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-e01de320-d394-4d44-bf22-124218123592-group-E69C1C55504C: set stopIndex = 4
2019-06-15 14:57:01,485 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-15 14:57:01,486 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1cfc81b4-7d3f-438b-81d1-56308f12b67e/ratis/e8bb858b-1c65-4916-b36c-e69c1c55504c/sm/snapshot.1_4
2019-06-15 14:57:01,491 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - e01de320-d394-4d44-bf22-124218123592:group-E69C1C55504C closes. The last applied log index is 4
2019-06-15 14:57:01,492 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - e01de320-d394-4d44-bf22-124218123592-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-15 14:57:01,492 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - e01de320-d394-4d44-bf22-124218123592-RaftLogWorker close()
2019-06-15 14:57:01,493 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - e01de320-d394-4d44-bf22-124218123592: shutdown server with port 37863 now
2019-06-15 14:57:01,496 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - e01de320-d394-4d44-bf22-124218123592: shutdown server with port 37863 successfully
2019-06-15 14:57:01,504 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-15 14:57:01,535 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8fbed868-e32e-44ec-a1b9-ce406a9d87ee/hdds of  storage type : DISK and capacity : 104021790720
2019-06-15 14:57:01,535 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8fbed868-e32e-44ec-a1b9-ce406a9d87ee/hdds to VolumeSet
2019-06-15 14:57:01,535 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3a2b2322
2019-06-15 14:57:01,535 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3a2b2322
2019-06-15 14:57:01,549 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 45321
2019-06-15 14:57:01,550 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-15 14:57:01,551 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-15 14:57:01,551 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 45321 (custom)
2019-06-15 14:57:01,551 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-15 14:57:01,551 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 14:57:01,552 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-15 14:57:01,552 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-15 14:57:01,553 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8fbed868-e32e-44ec-a1b9-ce406a9d87ee/ratis] (custom)
2019-06-15 14:57:01,553 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42039
2019-06-15 14:57:01,553 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-15 14:57:01,554 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-15 14:57:01,554 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 1402daa8-9dfb-46ba-8880-4cf3e3614b27 at port 45321
2019-06-15 14:57:01,587 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27: start RPC server
2019-06-15 14:57:01,588 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27: GrpcService started, listening on 0.0.0.0/0.0.0.0:45321
2019-06-15 14:57:01,600 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27: addNew group-1325E6185E3D:[1402daa8-9dfb-46ba-8880-4cf3e3614b27:127.0.0.1:45321] returns group-1325E6185E3D:java.util.concurrent.CompletableFuture@f927ac1[Not completed]
2019-06-15 14:57:01,600 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27: new RaftServerImpl for group-1325E6185E3D:[1402daa8-9dfb-46ba-8880-4cf3e3614b27:127.0.0.1:45321] with ContainerStateMachine:uninitialized
2019-06-15 14:57:01,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-15 14:57:01,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-15 14:57:01,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-15 14:57:01,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-15 14:57:01,601 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27:group-1325E6185E3D ConfigurationManager, init=-1: [1402daa8-9dfb-46ba-8880-4cf3e3614b27:127.0.0.1:45321], old=null, confs=<EMPTY_MAP>
2019-06-15 14:57:01,601 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8fbed868-e32e-44ec-a1b9-ce406a9d87ee/ratis] (custom)
2019-06-15 14:57:01,602 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8fbed868-e32e-44ec-a1b9-ce406a9d87ee/ratis/371356f1-7583-4df1-9493-1325e6185e3d does not exist. Creating ...
2019-06-15 14:57:01,604 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8fbed868-e32e-44ec-a1b9-ce406a9d87ee/ratis/371356f1-7583-4df1-9493-1325e6185e3d/in_use.lock acquired by nodename 4301@ozone-unit-076618677d3-2s8lm-491337942
2019-06-15 14:57:01,606 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8fbed868-e32e-44ec-a1b9-ce406a9d87ee/ratis/371356f1-7583-4df1-9493-1325e6185e3d has been successfully formatted.
2019-06-15 14:57:01,606 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-15 14:57:01,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-15 14:57:01,607 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-15 14:57:01,607 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 14:57:01,607 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 14:57:01,607 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-15 14:57:01,607 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 1402daa8-9dfb-46ba-8880-4cf3e3614b27-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8fbed868-e32e-44ec-a1b9-ce406a9d87ee/ratis/371356f1-7583-4df1-9493-1325e6185e3d
2019-06-15 14:57:01,607 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-15 14:57:01,607 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-15 14:57:01,608 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 14:57:01,608 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-15 14:57:01,608 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-15 14:57:01,608 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-15 14:57:01,608 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-15 14:57:01,608 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-15 14:57:01,608 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-15 14:57:01,609 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-15 14:57:01,609 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-15 14:57:01,609 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-15 14:57:01,609 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-15 14:57:01,610 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27: start group-1325E6185E3D
2019-06-15 14:57:01,610 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27:group-1325E6185E3D changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-15 14:57:01,610 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27: start FollowerState
2019-06-15 14:57:01,610 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-1325E6185E3D,id=1402daa8-9dfb-46ba-8880-4cf3e3614b27
2019-06-15 14:57:02,787 INFO  impl.FollowerState (FollowerState.java:run(101)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27:group-1325E6185E3D changes to CANDIDATE, lastRpcTime:1177, electionTimeout:1177ms
2019-06-15 14:57:02,788 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27: shutdown FollowerState
2019-06-15 14:57:02,788 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27:group-1325E6185E3D changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-15 14:57:02,788 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27: start LeaderElection
2019-06-15 14:57:02,791 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27:group-1325E6185E3D:LeaderElection2: begin an election at term 1 for -1: [1402daa8-9dfb-46ba-8880-4cf3e3614b27:127.0.0.1:45321], old=null
2019-06-15 14:57:02,791 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27: shutdown LeaderElection
2019-06-15 14:57:02,791 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27:group-1325E6185E3D changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-15 14:57:02,791 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27:group-1325E6185E3D change Leader from null to 1402daa8-9dfb-46ba-8880-4cf3e3614b27 at term 1 for becomeLeader, leader elected after 1184ms
2019-06-15 14:57:02,792 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-15 14:57:02,792 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-15 14:57:02,792 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-15 14:57:02,792 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-15 14:57:02,792 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27: start LeaderState
2019-06-15 14:57:02,793 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27-RaftLogWorker: Starting segment from index:0
2019-06-15 14:57:02,793 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27:group-1325E6185E3D set configuration 0: [1402daa8-9dfb-46ba-8880-4cf3e3614b27:127.0.0.1:45321], old=null at 0
2019-06-15 14:57:02,830 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8fbed868-e32e-44ec-a1b9-ce406a9d87ee/ratis/371356f1-7583-4df1-9493-1325e6185e3d/current/log_inprogress_0
2019-06-15 14:57:03,641 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-15 14:57:03,642 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27: close
2019-06-15 14:57:03,642 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27: shutdown group-1325E6185E3D
2019-06-15 14:57:03,643 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-1325E6185E3D,id=1402daa8-9dfb-46ba-8880-4cf3e3614b27
2019-06-15 14:57:03,643 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27: shutdown LeaderState
2019-06-15 14:57:03,643 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27-PendingRequests: sendNotLeaderResponses
2019-06-15 14:57:03,644 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-1402daa8-9dfb-46ba-8880-4cf3e3614b27-group-1325E6185E3D: set stopIndex = 2
2019-06-15 14:57:03,644 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-15 14:57:03,644 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8fbed868-e32e-44ec-a1b9-ce406a9d87ee/ratis/371356f1-7583-4df1-9493-1325e6185e3d/sm/snapshot.1_2
2019-06-15 14:57:03,645 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27:group-1325E6185E3D closes. The last applied log index is 2
2019-06-15 14:57:03,645 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-15 14:57:03,646 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27-RaftLogWorker close()
2019-06-15 14:57:03,647 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27: shutdown server with port 45321 now
2019-06-15 14:57:03,648 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 1402daa8-9dfb-46ba-8880-4cf3e3614b27: shutdown server with port 45321 successfully
2019-06-15 14:57:03,650 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-15 14:57:03,677 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere3ea9e44-7b5b-44d2-a5fc-a59d37b3b191/hdds of  storage type : DISK and capacity : 104021790720
2019-06-15 14:57:03,678 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere3ea9e44-7b5b-44d2-a5fc-a59d37b3b191/hdds to VolumeSet
2019-06-15 14:57:03,678 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@26a2f7f9
2019-06-15 14:57:03,678 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@26a2f7f9
2019-06-15 14:57:03,688 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 37765
2019-06-15 14:57:03,688 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-15 14:57:03,689 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-15 14:57:03,689 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 37765 (custom)
2019-06-15 14:57:03,689 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-15 14:57:03,690 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 14:57:03,690 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-15 14:57:03,690 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-15 14:57:03,690 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere3ea9e44-7b5b-44d2-a5fc-a59d37b3b191/ratis] (custom)
2019-06-15 14:57:03,691 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42717
2019-06-15 14:57:03,691 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-15 14:57:03,691 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-15 14:57:03,691 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 4947a516-d42b-4699-9dc9-43167c98c7d0 at port 37765
2019-06-15 14:57:03,709 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 4947a516-d42b-4699-9dc9-43167c98c7d0: start RPC server
2019-06-15 14:57:03,710 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 4947a516-d42b-4699-9dc9-43167c98c7d0: GrpcService started, listening on 0.0.0.0/0.0.0.0:37765
2019-06-15 14:57:03,721 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 4947a516-d42b-4699-9dc9-43167c98c7d0: addNew group-6E33F71135C0:[4947a516-d42b-4699-9dc9-43167c98c7d0:127.0.0.1:37765] returns group-6E33F71135C0:java.util.concurrent.CompletableFuture@56192ce5[Not completed]
2019-06-15 14:57:03,721 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 4947a516-d42b-4699-9dc9-43167c98c7d0: new RaftServerImpl for group-6E33F71135C0:[4947a516-d42b-4699-9dc9-43167c98c7d0:127.0.0.1:37765] with ContainerStateMachine:uninitialized
2019-06-15 14:57:03,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-15 14:57:03,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-15 14:57:03,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-15 14:57:03,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-15 14:57:03,722 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 4947a516-d42b-4699-9dc9-43167c98c7d0:group-6E33F71135C0 ConfigurationManager, init=-1: [4947a516-d42b-4699-9dc9-43167c98c7d0:127.0.0.1:37765], old=null, confs=<EMPTY_MAP>
2019-06-15 14:57:03,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere3ea9e44-7b5b-44d2-a5fc-a59d37b3b191/ratis] (custom)
2019-06-15 14:57:03,722 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere3ea9e44-7b5b-44d2-a5fc-a59d37b3b191/ratis/e526fa62-cd7d-4019-93c0-6e33f71135c0 does not exist. Creating ...
2019-06-15 14:57:03,725 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere3ea9e44-7b5b-44d2-a5fc-a59d37b3b191/ratis/e526fa62-cd7d-4019-93c0-6e33f71135c0/in_use.lock acquired by nodename 4301@ozone-unit-076618677d3-2s8lm-491337942
2019-06-15 14:57:03,728 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere3ea9e44-7b5b-44d2-a5fc-a59d37b3b191/ratis/e526fa62-cd7d-4019-93c0-6e33f71135c0 has been successfully formatted.
2019-06-15 14:57:03,728 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-15 14:57:03,728 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-15 14:57:03,728 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-15 14:57:03,728 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 14:57:03,728 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 14:57:03,729 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-15 14:57:03,729 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 4947a516-d42b-4699-9dc9-43167c98c7d0-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere3ea9e44-7b5b-44d2-a5fc-a59d37b3b191/ratis/e526fa62-cd7d-4019-93c0-6e33f71135c0
2019-06-15 14:57:03,729 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-15 14:57:03,729 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-15 14:57:03,729 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 14:57:03,729 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-15 14:57:03,729 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-15 14:57:03,729 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-15 14:57:03,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-15 14:57:03,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-15 14:57:03,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-15 14:57:03,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-15 14:57:03,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-15 14:57:03,731 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-15 14:57:03,731 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-15 14:57:03,731 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 4947a516-d42b-4699-9dc9-43167c98c7d0: start group-6E33F71135C0
2019-06-15 14:57:03,731 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4947a516-d42b-4699-9dc9-43167c98c7d0:group-6E33F71135C0 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-15 14:57:03,731 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4947a516-d42b-4699-9dc9-43167c98c7d0: start FollowerState
2019-06-15 14:57:03,731 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-6E33F71135C0,id=4947a516-d42b-4699-9dc9-43167c98c7d0
2019-06-15 14:57:04,821 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4947a516-d42b-4699-9dc9-43167c98c7d0:group-6E33F71135C0 changes to CANDIDATE, lastRpcTime:1090, electionTimeout:1090ms
2019-06-15 14:57:04,822 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4947a516-d42b-4699-9dc9-43167c98c7d0: shutdown FollowerState
2019-06-15 14:57:04,822 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4947a516-d42b-4699-9dc9-43167c98c7d0:group-6E33F71135C0 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-15 14:57:04,822 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4947a516-d42b-4699-9dc9-43167c98c7d0: start LeaderElection
2019-06-15 14:57:04,825 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4947a516-d42b-4699-9dc9-43167c98c7d0:group-6E33F71135C0:LeaderElection3: begin an election at term 1 for -1: [4947a516-d42b-4699-9dc9-43167c98c7d0:127.0.0.1:37765], old=null
2019-06-15 14:57:04,825 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4947a516-d42b-4699-9dc9-43167c98c7d0: shutdown LeaderElection
2019-06-15 14:57:04,825 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4947a516-d42b-4699-9dc9-43167c98c7d0:group-6E33F71135C0 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-15 14:57:04,825 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 4947a516-d42b-4699-9dc9-43167c98c7d0:group-6E33F71135C0 change Leader from null to 4947a516-d42b-4699-9dc9-43167c98c7d0 at term 1 for becomeLeader, leader elected after 1097ms
2019-06-15 14:57:04,825 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-15 14:57:04,825 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-15 14:57:04,826 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-15 14:57:04,826 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-15 14:57:04,826 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4947a516-d42b-4699-9dc9-43167c98c7d0: start LeaderState
2019-06-15 14:57:04,826 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 4947a516-d42b-4699-9dc9-43167c98c7d0-RaftLogWorker: Starting segment from index:0
2019-06-15 14:57:04,829 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 4947a516-d42b-4699-9dc9-43167c98c7d0:group-6E33F71135C0 set configuration 0: [4947a516-d42b-4699-9dc9-43167c98c7d0:127.0.0.1:37765], old=null at 0
2019-06-15 14:57:04,863 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 4947a516-d42b-4699-9dc9-43167c98c7d0-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere3ea9e44-7b5b-44d2-a5fc-a59d37b3b191/ratis/e526fa62-cd7d-4019-93c0-6e33f71135c0/current/log_inprogress_0
2019-06-15 14:57:05,773 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 4915392918807945524 is closed with bcsId 0.
2019-06-15 14:57:05,773 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-15 14:57:05,774 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 4947a516-d42b-4699-9dc9-43167c98c7d0: close
2019-06-15 14:57:05,774 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 4947a516-d42b-4699-9dc9-43167c98c7d0: shutdown group-6E33F71135C0
2019-06-15 14:57:05,774 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-6E33F71135C0,id=4947a516-d42b-4699-9dc9-43167c98c7d0
2019-06-15 14:57:05,775 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 4947a516-d42b-4699-9dc9-43167c98c7d0: shutdown LeaderState
2019-06-15 14:57:05,775 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 4947a516-d42b-4699-9dc9-43167c98c7d0-PendingRequests: sendNotLeaderResponses
2019-06-15 14:57:05,776 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-4947a516-d42b-4699-9dc9-43167c98c7d0-group-6E33F71135C0: set stopIndex = 2
2019-06-15 14:57:05,776 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-15 14:57:05,776 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere3ea9e44-7b5b-44d2-a5fc-a59d37b3b191/ratis/e526fa62-cd7d-4019-93c0-6e33f71135c0/sm/snapshot.1_2
2019-06-15 14:57:05,777 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 4947a516-d42b-4699-9dc9-43167c98c7d0:group-6E33F71135C0 closes. The last applied log index is 2
2019-06-15 14:57:05,777 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 4947a516-d42b-4699-9dc9-43167c98c7d0-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-15 14:57:05,778 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 4947a516-d42b-4699-9dc9-43167c98c7d0-RaftLogWorker close()
2019-06-15 14:57:05,779 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 4947a516-d42b-4699-9dc9-43167c98c7d0: shutdown server with port 37765 now
2019-06-15 14:57:05,781 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 4947a516-d42b-4699-9dc9-43167c98c7d0: shutdown server with port 37765 successfully
2019-06-15 14:57:05,784 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-15 14:57:05,818 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler095acd00-1540-4213-9116-005271ebd08d/hdds of  storage type : DISK and capacity : 104021790720
2019-06-15 14:57:05,819 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler095acd00-1540-4213-9116-005271ebd08d/hdds to VolumeSet
2019-06-15 14:57:05,819 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@66153688
2019-06-15 14:57:05,821 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@66153688
2019-06-15 14:57:05,831 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 41833
2019-06-15 14:57:05,832 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-15 14:57:05,833 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-15 14:57:05,833 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 41833 (custom)
2019-06-15 14:57:05,833 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-15 14:57:05,833 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 14:57:05,833 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-15 14:57:05,834 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-15 14:57:05,834 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler095acd00-1540-4213-9116-005271ebd08d/ratis] (custom)
2019-06-15 14:57:05,834 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 38145
2019-06-15 14:57:05,835 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-15 14:57:05,835 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-15 14:57:05,835 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 9d75e369-aece-435c-8065-a6be9c4e4c6b at port 41833
2019-06-15 14:57:05,842 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b: start RPC server
2019-06-15 14:57:05,843 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b: GrpcService started, listening on 0.0.0.0/0.0.0.0:41833
Jun 15, 2019 2:57:05 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:45321} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 15, 2019 2:57:05 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:37765} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-15 14:57:05,858 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b: addNew group-3D67FD5CB01E:[9d75e369-aece-435c-8065-a6be9c4e4c6b:127.0.0.1:41833] returns group-3D67FD5CB01E:java.util.concurrent.CompletableFuture@5c2c215c[Not completed]
2019-06-15 14:57:05,859 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b: new RaftServerImpl for group-3D67FD5CB01E:[9d75e369-aece-435c-8065-a6be9c4e4c6b:127.0.0.1:41833] with ContainerStateMachine:uninitialized
2019-06-15 14:57:05,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-15 14:57:05,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-15 14:57:05,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-15 14:57:05,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-15 14:57:05,860 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b:group-3D67FD5CB01E ConfigurationManager, init=-1: [9d75e369-aece-435c-8065-a6be9c4e4c6b:127.0.0.1:41833], old=null, confs=<EMPTY_MAP>
2019-06-15 14:57:05,860 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler095acd00-1540-4213-9116-005271ebd08d/ratis] (custom)
2019-06-15 14:57:05,860 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler095acd00-1540-4213-9116-005271ebd08d/ratis/ea5cd2aa-c41e-4a63-9701-3d67fd5cb01e does not exist. Creating ...
2019-06-15 14:57:05,863 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler095acd00-1540-4213-9116-005271ebd08d/ratis/ea5cd2aa-c41e-4a63-9701-3d67fd5cb01e/in_use.lock acquired by nodename 4301@ozone-unit-076618677d3-2s8lm-491337942
2019-06-15 14:57:05,865 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler095acd00-1540-4213-9116-005271ebd08d/ratis/ea5cd2aa-c41e-4a63-9701-3d67fd5cb01e has been successfully formatted.
2019-06-15 14:57:05,865 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-15 14:57:05,865 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-15 14:57:05,865 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-15 14:57:05,865 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 14:57:05,865 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 14:57:05,865 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-15 14:57:05,865 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 9d75e369-aece-435c-8065-a6be9c4e4c6b-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler095acd00-1540-4213-9116-005271ebd08d/ratis/ea5cd2aa-c41e-4a63-9701-3d67fd5cb01e
2019-06-15 14:57:05,865 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-15 14:57:05,865 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-15 14:57:05,866 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 14:57:05,866 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-15 14:57:05,866 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-15 14:57:05,866 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-15 14:57:05,866 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-15 14:57:05,866 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-15 14:57:05,866 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-15 14:57:05,866 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-15 14:57:05,866 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-15 14:57:05,867 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-15 14:57:05,867 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-15 14:57:05,867 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b: start group-3D67FD5CB01E
2019-06-15 14:57:05,867 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b:group-3D67FD5CB01E changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-15 14:57:05,867 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b: start FollowerState
2019-06-15 14:57:05,868 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-3D67FD5CB01E,id=9d75e369-aece-435c-8065-a6be9c4e4c6b
2019-06-15 14:57:06,964 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b:group-3D67FD5CB01E changes to CANDIDATE, lastRpcTime:1097, electionTimeout:1097ms
2019-06-15 14:57:06,965 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b: shutdown FollowerState
2019-06-15 14:57:06,965 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b:group-3D67FD5CB01E changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-15 14:57:06,965 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b: start LeaderElection
2019-06-15 14:57:06,968 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b:group-3D67FD5CB01E:LeaderElection4: begin an election at term 1 for -1: [9d75e369-aece-435c-8065-a6be9c4e4c6b:127.0.0.1:41833], old=null
2019-06-15 14:57:06,968 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b: shutdown LeaderElection
2019-06-15 14:57:06,968 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b:group-3D67FD5CB01E changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-15 14:57:06,968 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b:group-3D67FD5CB01E change Leader from null to 9d75e369-aece-435c-8065-a6be9c4e4c6b at term 1 for becomeLeader, leader elected after 1103ms
2019-06-15 14:57:06,968 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-15 14:57:06,968 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-15 14:57:06,968 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-15 14:57:06,968 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-15 14:57:06,969 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b: start LeaderState
2019-06-15 14:57:06,969 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b-RaftLogWorker: Starting segment from index:0
2019-06-15 14:57:06,969 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b:group-3D67FD5CB01E set configuration 0: [9d75e369-aece-435c-8065-a6be9c4e4c6b:127.0.0.1:41833], old=null at 0
2019-06-15 14:57:07,005 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler095acd00-1540-4213-9116-005271ebd08d/ratis/ea5cd2aa-c41e-4a63-9701-3d67fd5cb01e/current/log_inprogress_0
2019-06-15 14:57:07,905 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 1033212197859180081 is closed with bcsId 0.
2019-06-15 14:57:07,906 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-15 14:57:07,906 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b: close
2019-06-15 14:57:07,906 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b: shutdown group-3D67FD5CB01E
2019-06-15 14:57:07,907 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-3D67FD5CB01E,id=9d75e369-aece-435c-8065-a6be9c4e4c6b
2019-06-15 14:57:07,907 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b: shutdown LeaderState
2019-06-15 14:57:07,907 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b-PendingRequests: sendNotLeaderResponses
2019-06-15 14:57:07,908 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-9d75e369-aece-435c-8065-a6be9c4e4c6b-group-3D67FD5CB01E: set stopIndex = 2
2019-06-15 14:57:07,908 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-15 14:57:07,909 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler095acd00-1540-4213-9116-005271ebd08d/ratis/ea5cd2aa-c41e-4a63-9701-3d67fd5cb01e/sm/snapshot.1_2
2019-06-15 14:57:07,909 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b:group-3D67FD5CB01E closes. The last applied log index is 2
2019-06-15 14:57:07,909 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-15 14:57:07,910 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b-RaftLogWorker close()
2019-06-15 14:57:07,910 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b: shutdown server with port 41833 now
2019-06-15 14:57:07,912 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 9d75e369-aece-435c-8065-a6be9c4e4c6b: shutdown server with port 41833 successfully
2019-06-15 14:57:07,917 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-15 14:57:07,937 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler054ef345-2a3b-4d3c-9342-be93b1b72a29/hdds of  storage type : DISK and capacity : 104021790720
2019-06-15 14:57:07,937 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler054ef345-2a3b-4d3c-9342-be93b1b72a29/hdds to VolumeSet
2019-06-15 14:57:07,937 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@68217d41
2019-06-15 14:57:07,937 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@68217d41
2019-06-15 14:57:07,946 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 37881
2019-06-15 14:57:07,947 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-15 14:57:07,947 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-15 14:57:07,948 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 37881 (custom)
2019-06-15 14:57:07,948 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-15 14:57:07,948 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 14:57:07,948 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-15 14:57:07,948 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-15 14:57:07,949 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler054ef345-2a3b-4d3c-9342-be93b1b72a29/ratis] (custom)
2019-06-15 14:57:07,949 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 39311
2019-06-15 14:57:07,950 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-15 14:57:07,950 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-15 14:57:07,950 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1 at port 37881
2019-06-15 14:57:07,969 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1: start RPC server
2019-06-15 14:57:07,971 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1: GrpcService started, listening on 0.0.0.0/0.0.0.0:37881
2019-06-15 14:57:07,979 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1: addNew group-4223140C12F4:[c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1:127.0.0.1:37881] returns group-4223140C12F4:java.util.concurrent.CompletableFuture@3c1ac2f7[Not completed]
2019-06-15 14:57:07,980 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1: new RaftServerImpl for group-4223140C12F4:[c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1:127.0.0.1:37881] with ContainerStateMachine:uninitialized
2019-06-15 14:57:07,980 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-15 14:57:07,980 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-15 14:57:07,980 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-15 14:57:07,980 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-15 14:57:07,981 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1:group-4223140C12F4 ConfigurationManager, init=-1: [c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1:127.0.0.1:37881], old=null, confs=<EMPTY_MAP>
2019-06-15 14:57:07,981 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler054ef345-2a3b-4d3c-9342-be93b1b72a29/ratis] (custom)
2019-06-15 14:57:07,981 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler054ef345-2a3b-4d3c-9342-be93b1b72a29/ratis/22fd7ef2-5d40-4844-8c3a-4223140c12f4 does not exist. Creating ...
2019-06-15 14:57:07,983 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler054ef345-2a3b-4d3c-9342-be93b1b72a29/ratis/22fd7ef2-5d40-4844-8c3a-4223140c12f4/in_use.lock acquired by nodename 4301@ozone-unit-076618677d3-2s8lm-491337942
2019-06-15 14:57:07,985 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler054ef345-2a3b-4d3c-9342-be93b1b72a29/ratis/22fd7ef2-5d40-4844-8c3a-4223140c12f4 has been successfully formatted.
2019-06-15 14:57:07,986 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-15 14:57:07,986 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-15 14:57:07,986 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-15 14:57:07,986 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 14:57:07,986 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 14:57:07,986 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-15 14:57:07,986 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler054ef345-2a3b-4d3c-9342-be93b1b72a29/ratis/22fd7ef2-5d40-4844-8c3a-4223140c12f4
2019-06-15 14:57:07,986 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-15 14:57:07,986 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-15 14:57:07,986 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 14:57:07,987 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-15 14:57:07,987 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-15 14:57:07,987 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-15 14:57:07,987 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-15 14:57:07,987 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-15 14:57:07,987 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-15 14:57:07,987 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-15 14:57:07,987 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-15 14:57:07,987 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-15 14:57:07,988 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-15 14:57:07,988 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1: start group-4223140C12F4
2019-06-15 14:57:07,988 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1:group-4223140C12F4 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-15 14:57:07,988 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1: start FollowerState
2019-06-15 14:57:07,991 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-4223140C12F4,id=c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1
2019-06-15 14:57:09,124 INFO  impl.FollowerState (FollowerState.java:run(101)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1:group-4223140C12F4 changes to CANDIDATE, lastRpcTime:1136, electionTimeout:1133ms
2019-06-15 14:57:09,124 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1: shutdown FollowerState
2019-06-15 14:57:09,124 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1:group-4223140C12F4 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-15 14:57:09,124 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1: start LeaderElection
2019-06-15 14:57:09,127 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1:group-4223140C12F4:LeaderElection5: begin an election at term 1 for -1: [c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1:127.0.0.1:37881], old=null
2019-06-15 14:57:09,127 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1: shutdown LeaderElection
2019-06-15 14:57:09,128 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1:group-4223140C12F4 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-15 14:57:09,128 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1:group-4223140C12F4 change Leader from null to c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1 at term 1 for becomeLeader, leader elected after 1141ms
2019-06-15 14:57:09,128 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-15 14:57:09,128 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-15 14:57:09,128 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-15 14:57:09,128 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-15 14:57:09,128 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1: start LeaderState
2019-06-15 14:57:09,129 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1-RaftLogWorker: Starting segment from index:0
2019-06-15 14:57:09,133 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1:group-4223140C12F4 set configuration 0: [c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1:127.0.0.1:37881], old=null at 0
2019-06-15 14:57:09,165 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler054ef345-2a3b-4d3c-9342-be93b1b72a29/ratis/22fd7ef2-5d40-4844-8c3a-4223140c12f4/current/log_inprogress_0
2019-06-15 14:57:10,048 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 1924717041524634946 is closed with bcsId 0.
2019-06-15 14:57:10,049 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-15 14:57:10,049 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1: close
2019-06-15 14:57:10,050 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1: shutdown group-4223140C12F4
2019-06-15 14:57:10,050 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-4223140C12F4,id=c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1
2019-06-15 14:57:10,050 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1: shutdown LeaderState
2019-06-15 14:57:10,051 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1-PendingRequests: sendNotLeaderResponses
2019-06-15 14:57:10,052 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1-group-4223140C12F4: set stopIndex = 4
2019-06-15 14:57:10,052 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-15 14:57:10,052 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler054ef345-2a3b-4d3c-9342-be93b1b72a29/ratis/22fd7ef2-5d40-4844-8c3a-4223140c12f4/sm/snapshot.1_4
2019-06-15 14:57:10,053 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1:group-4223140C12F4 closes. The last applied log index is 4
2019-06-15 14:57:10,053 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-15 14:57:10,054 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1-RaftLogWorker close()
2019-06-15 14:57:10,055 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1: shutdown server with port 37881 now
2019-06-15 14:57:10,056 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - c81fe1b8-ebf0-4ab9-abc9-9b9a97a2c3c1: shutdown server with port 37881 successfully
2019-06-15 14:57:10,058 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
