2019-06-17 00:15:22,191 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere8193900-b620-417e-bc1a-5ad48817c9cc/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 00:15:22,197 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere8193900-b620-417e-bc1a-5ad48817c9cc/hdds to VolumeSet
2019-06-17 00:15:22,231 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-17 00:15:22,264 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-17 00:15:22,733 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 40107
2019-06-17 00:15:23,294 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 00:15:23,321 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 00:15:23,332 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 40107 (custom)
2019-06-17 00:15:23,333 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 00:15:23,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 00:15:23,336 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 00:15:23,337 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 00:15:23,511 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere8193900-b620-417e-bc1a-5ad48817c9cc/ratis] (custom)
2019-06-17 00:15:23,524 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 39851
2019-06-17 00:15:23,550 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 00:15:23,550 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 00:15:23,551 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 39d69135-dcbf-4625-b6e8-b9c666b4339e at port 40107
2019-06-17 00:15:23,592 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e: start RPC server
2019-06-17 00:15:23,739 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e: GrpcService started, listening on 0.0.0.0/0.0.0.0:40107
2019-06-17 00:15:24,114 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e: addNew group-927A284797CC:[39d69135-dcbf-4625-b6e8-b9c666b4339e:127.0.0.1:40107] returns group-927A284797CC:java.util.concurrent.CompletableFuture@5669f4e2[Not completed]
2019-06-17 00:15:24,155 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e: new RaftServerImpl for group-927A284797CC:[39d69135-dcbf-4625-b6e8-b9c666b4339e:127.0.0.1:40107] with ContainerStateMachine:uninitialized
2019-06-17 00:15:24,156 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 00:15:24,156 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 00:15:24,157 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 00:15:24,158 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 00:15:24,163 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e:group-927A284797CC ConfigurationManager, init=-1: [39d69135-dcbf-4625-b6e8-b9c666b4339e:127.0.0.1:40107], old=null, confs=<EMPTY_MAP>
2019-06-17 00:15:24,164 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere8193900-b620-417e-bc1a-5ad48817c9cc/ratis] (custom)
2019-06-17 00:15:24,172 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere8193900-b620-417e-bc1a-5ad48817c9cc/ratis/e3b720fd-a43f-4fa4-aa73-927a284797cc does not exist. Creating ...
2019-06-17 00:15:24,180 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere8193900-b620-417e-bc1a-5ad48817c9cc/ratis/e3b720fd-a43f-4fa4-aa73-927a284797cc/in_use.lock acquired by nodename 4312@ozone-unit-076618677d39m8qw-2599800311
2019-06-17 00:15:24,190 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere8193900-b620-417e-bc1a-5ad48817c9cc/ratis/e3b720fd-a43f-4fa4-aa73-927a284797cc has been successfully formatted.
2019-06-17 00:15:24,192 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 00:15:24,193 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 00:15:24,195 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 00:15:24,197 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 00:15:24,201 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 00:15:24,205 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 00:15:24,208 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 39d69135-dcbf-4625-b6e8-b9c666b4339e-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere8193900-b620-417e-bc1a-5ad48817c9cc/ratis/e3b720fd-a43f-4fa4-aa73-927a284797cc
2019-06-17 00:15:24,209 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 00:15:24,209 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 00:15:24,211 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 00:15:24,212 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 00:15:24,212 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 00:15:24,217 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 00:15:24,218 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 00:15:24,218 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 00:15:24,219 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 00:15:24,221 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 00:15:24,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 00:15:24,228 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 00:15:24,228 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 00:15:24,354 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e: start group-927A284797CC
2019-06-17 00:15:24,355 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e:group-927A284797CC changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 00:15:24,357 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e: start FollowerState
2019-06-17 00:15:24,359 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-927A284797CC,id=39d69135-dcbf-4625-b6e8-b9c666b4339e
2019-06-17 00:15:25,467 INFO  impl.FollowerState (FollowerState.java:run(101)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e:group-927A284797CC changes to CANDIDATE, lastRpcTime:1111, electionTimeout:1110ms
2019-06-17 00:15:25,467 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e: shutdown FollowerState
2019-06-17 00:15:25,468 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e:group-927A284797CC changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 00:15:25,469 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e: start LeaderElection
2019-06-17 00:15:25,473 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e:group-927A284797CC:LeaderElection1: begin an election at term 1 for -1: [39d69135-dcbf-4625-b6e8-b9c666b4339e:127.0.0.1:40107], old=null
2019-06-17 00:15:25,474 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e: shutdown LeaderElection
2019-06-17 00:15:25,475 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e:group-927A284797CC changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 00:15:25,475 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e:group-927A284797CC change Leader from null to 39d69135-dcbf-4625-b6e8-b9c666b4339e at term 1 for becomeLeader, leader elected after 1282ms
2019-06-17 00:15:25,479 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 00:15:25,479 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 00:15:25,481 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 00:15:25,481 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 00:15:25,490 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e: start LeaderState
2019-06-17 00:15:25,502 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e-RaftLogWorker: Starting segment from index:0
2019-06-17 00:15:25,509 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e:group-927A284797CC set configuration 0: [39d69135-dcbf-4625-b6e8-b9c666b4339e:127.0.0.1:40107], old=null at 0
2019-06-17 00:15:25,639 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere8193900-b620-417e-bc1a-5ad48817c9cc/ratis/e3b720fd-a43f-4fa4-aa73-927a284797cc/current/log_inprogress_0
2019-06-17 00:15:26,604 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-17 00:15:26,668 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 3365272810370836145 is closed with bcsId 0.
2019-06-17 00:15:26,668 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 00:15:26,669 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e: close
2019-06-17 00:15:26,671 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e: shutdown group-927A284797CC
2019-06-17 00:15:26,671 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-927A284797CC,id=39d69135-dcbf-4625-b6e8-b9c666b4339e
2019-06-17 00:15:26,672 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e: shutdown LeaderState
2019-06-17 00:15:26,672 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e-PendingRequests: sendNotLeaderResponses
2019-06-17 00:15:26,675 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-39d69135-dcbf-4625-b6e8-b9c666b4339e-group-927A284797CC: set stopIndex = 4
2019-06-17 00:15:26,675 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 00:15:26,675 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere8193900-b620-417e-bc1a-5ad48817c9cc/ratis/e3b720fd-a43f-4fa4-aa73-927a284797cc/sm/snapshot.1_4
2019-06-17 00:15:26,683 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e:group-927A284797CC closes. The last applied log index is 4
2019-06-17 00:15:26,684 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 00:15:26,685 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e-RaftLogWorker close()
2019-06-17 00:15:26,686 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e: shutdown server with port 40107 now
2019-06-17 00:15:26,690 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 39d69135-dcbf-4625-b6e8-b9c666b4339e: shutdown server with port 40107 successfully
2019-06-17 00:15:26,699 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 00:15:26,738 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00669b57-aa12-483b-84a5-ac7267a67926/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 00:15:26,739 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00669b57-aa12-483b-84a5-ac7267a67926/hdds to VolumeSet
2019-06-17 00:15:26,739 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1f966492
2019-06-17 00:15:26,740 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1f966492
2019-06-17 00:15:26,755 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 33567
2019-06-17 00:15:26,756 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 00:15:26,756 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 00:15:26,757 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 33567 (custom)
2019-06-17 00:15:26,757 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 00:15:26,757 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 00:15:26,758 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 00:15:26,758 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 00:15:26,759 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00669b57-aa12-483b-84a5-ac7267a67926/ratis] (custom)
2019-06-17 00:15:26,759 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 44487
2019-06-17 00:15:26,760 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 00:15:26,760 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 00:15:26,760 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis d4213a09-ebce-4515-bad5-c3d168770d25 at port 33567
2019-06-17 00:15:26,770 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - d4213a09-ebce-4515-bad5-c3d168770d25: start RPC server
2019-06-17 00:15:26,774 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - d4213a09-ebce-4515-bad5-c3d168770d25: GrpcService started, listening on 0.0.0.0/0.0.0.0:33567
2019-06-17 00:15:26,797 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - d4213a09-ebce-4515-bad5-c3d168770d25: addNew group-0D77AF35F907:[d4213a09-ebce-4515-bad5-c3d168770d25:127.0.0.1:33567] returns group-0D77AF35F907:java.util.concurrent.CompletableFuture@72c74376[Not completed]
2019-06-17 00:15:26,798 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - d4213a09-ebce-4515-bad5-c3d168770d25: new RaftServerImpl for group-0D77AF35F907:[d4213a09-ebce-4515-bad5-c3d168770d25:127.0.0.1:33567] with ContainerStateMachine:uninitialized
2019-06-17 00:15:26,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 00:15:26,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 00:15:26,799 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 00:15:26,799 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 00:15:26,799 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - d4213a09-ebce-4515-bad5-c3d168770d25:group-0D77AF35F907 ConfigurationManager, init=-1: [d4213a09-ebce-4515-bad5-c3d168770d25:127.0.0.1:33567], old=null, confs=<EMPTY_MAP>
2019-06-17 00:15:26,799 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00669b57-aa12-483b-84a5-ac7267a67926/ratis] (custom)
2019-06-17 00:15:26,799 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00669b57-aa12-483b-84a5-ac7267a67926/ratis/04b97057-15e5-48f1-9bc0-0d77af35f907 does not exist. Creating ...
2019-06-17 00:15:26,803 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00669b57-aa12-483b-84a5-ac7267a67926/ratis/04b97057-15e5-48f1-9bc0-0d77af35f907/in_use.lock acquired by nodename 4312@ozone-unit-076618677d39m8qw-2599800311
2019-06-17 00:15:26,805 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00669b57-aa12-483b-84a5-ac7267a67926/ratis/04b97057-15e5-48f1-9bc0-0d77af35f907 has been successfully formatted.
2019-06-17 00:15:26,805 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 00:15:26,805 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 00:15:26,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 00:15:26,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 00:15:26,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 00:15:26,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 00:15:26,806 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new d4213a09-ebce-4515-bad5-c3d168770d25-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00669b57-aa12-483b-84a5-ac7267a67926/ratis/04b97057-15e5-48f1-9bc0-0d77af35f907
2019-06-17 00:15:26,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 00:15:26,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 00:15:26,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 00:15:26,807 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 00:15:26,808 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 00:15:26,808 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 00:15:26,808 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 00:15:26,808 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 00:15:26,808 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 00:15:26,809 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 00:15:26,809 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 00:15:26,809 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 00:15:26,810 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 00:15:26,810 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - d4213a09-ebce-4515-bad5-c3d168770d25: start group-0D77AF35F907
2019-06-17 00:15:26,810 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d4213a09-ebce-4515-bad5-c3d168770d25:group-0D77AF35F907 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 00:15:26,810 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d4213a09-ebce-4515-bad5-c3d168770d25: start FollowerState
2019-06-17 00:15:26,811 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-0D77AF35F907,id=d4213a09-ebce-4515-bad5-c3d168770d25
2019-06-17 00:15:27,895 INFO  impl.FollowerState (FollowerState.java:run(101)) - d4213a09-ebce-4515-bad5-c3d168770d25:group-0D77AF35F907 changes to CANDIDATE, lastRpcTime:1084, electionTimeout:1084ms
2019-06-17 00:15:27,895 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d4213a09-ebce-4515-bad5-c3d168770d25: shutdown FollowerState
2019-06-17 00:15:27,895 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d4213a09-ebce-4515-bad5-c3d168770d25:group-0D77AF35F907 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 00:15:27,895 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d4213a09-ebce-4515-bad5-c3d168770d25: start LeaderElection
2019-06-17 00:15:27,898 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - d4213a09-ebce-4515-bad5-c3d168770d25:group-0D77AF35F907:LeaderElection2: begin an election at term 1 for -1: [d4213a09-ebce-4515-bad5-c3d168770d25:127.0.0.1:33567], old=null
2019-06-17 00:15:27,899 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - d4213a09-ebce-4515-bad5-c3d168770d25: shutdown LeaderElection
2019-06-17 00:15:27,899 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d4213a09-ebce-4515-bad5-c3d168770d25:group-0D77AF35F907 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 00:15:27,899 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - d4213a09-ebce-4515-bad5-c3d168770d25:group-0D77AF35F907 change Leader from null to d4213a09-ebce-4515-bad5-c3d168770d25 at term 1 for becomeLeader, leader elected after 1093ms
2019-06-17 00:15:27,899 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 00:15:27,899 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 00:15:27,900 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 00:15:27,900 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 00:15:27,900 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d4213a09-ebce-4515-bad5-c3d168770d25: start LeaderState
2019-06-17 00:15:27,900 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - d4213a09-ebce-4515-bad5-c3d168770d25-RaftLogWorker: Starting segment from index:0
2019-06-17 00:15:27,901 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - d4213a09-ebce-4515-bad5-c3d168770d25:group-0D77AF35F907 set configuration 0: [d4213a09-ebce-4515-bad5-c3d168770d25:127.0.0.1:33567], old=null at 0
2019-06-17 00:15:27,936 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - d4213a09-ebce-4515-bad5-c3d168770d25-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00669b57-aa12-483b-84a5-ac7267a67926/ratis/04b97057-15e5-48f1-9bc0-0d77af35f907/current/log_inprogress_0
2019-06-17 00:15:28,852 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 00:15:28,853 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - d4213a09-ebce-4515-bad5-c3d168770d25: close
2019-06-17 00:15:28,853 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - d4213a09-ebce-4515-bad5-c3d168770d25: shutdown group-0D77AF35F907
2019-06-17 00:15:28,854 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-0D77AF35F907,id=d4213a09-ebce-4515-bad5-c3d168770d25
2019-06-17 00:15:28,854 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - d4213a09-ebce-4515-bad5-c3d168770d25: shutdown LeaderState
2019-06-17 00:15:28,854 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - d4213a09-ebce-4515-bad5-c3d168770d25-PendingRequests: sendNotLeaderResponses
2019-06-17 00:15:28,855 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-d4213a09-ebce-4515-bad5-c3d168770d25-group-0D77AF35F907: set stopIndex = 2
2019-06-17 00:15:28,855 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 00:15:28,855 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00669b57-aa12-483b-84a5-ac7267a67926/ratis/04b97057-15e5-48f1-9bc0-0d77af35f907/sm/snapshot.1_2
2019-06-17 00:15:28,856 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - d4213a09-ebce-4515-bad5-c3d168770d25:group-0D77AF35F907 closes. The last applied log index is 2
2019-06-17 00:15:28,856 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - d4213a09-ebce-4515-bad5-c3d168770d25-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 00:15:28,859 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - d4213a09-ebce-4515-bad5-c3d168770d25-RaftLogWorker close()
2019-06-17 00:15:28,860 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - d4213a09-ebce-4515-bad5-c3d168770d25: shutdown server with port 33567 now
2019-06-17 00:15:28,861 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - d4213a09-ebce-4515-bad5-c3d168770d25: shutdown server with port 33567 successfully
2019-06-17 00:15:28,867 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 00:15:28,902 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc516a6c1-f169-4b0f-b32c-bc0ab1a07de5/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 00:15:28,902 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc516a6c1-f169-4b0f-b32c-bc0ab1a07de5/hdds to VolumeSet
2019-06-17 00:15:28,902 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@36f1046f
2019-06-17 00:15:28,903 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@36f1046f
2019-06-17 00:15:28,917 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43487
2019-06-17 00:15:28,918 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 00:15:28,919 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 00:15:28,919 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43487 (custom)
2019-06-17 00:15:28,921 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 00:15:28,922 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 00:15:28,922 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 00:15:28,922 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 00:15:28,923 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc516a6c1-f169-4b0f-b32c-bc0ab1a07de5/ratis] (custom)
2019-06-17 00:15:28,923 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 33393
2019-06-17 00:15:28,924 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 00:15:28,924 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 00:15:28,924 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 016b7f35-b6c3-4698-9ea5-2929465bd394 at port 43487
2019-06-17 00:15:28,955 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 016b7f35-b6c3-4698-9ea5-2929465bd394: start RPC server
2019-06-17 00:15:28,957 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 016b7f35-b6c3-4698-9ea5-2929465bd394: GrpcService started, listening on 0.0.0.0/0.0.0.0:43487
2019-06-17 00:15:28,969 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 016b7f35-b6c3-4698-9ea5-2929465bd394: addNew group-81DE39B968B8:[016b7f35-b6c3-4698-9ea5-2929465bd394:127.0.0.1:43487] returns group-81DE39B968B8:java.util.concurrent.CompletableFuture@167543fd[Not completed]
2019-06-17 00:15:28,970 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 016b7f35-b6c3-4698-9ea5-2929465bd394: new RaftServerImpl for group-81DE39B968B8:[016b7f35-b6c3-4698-9ea5-2929465bd394:127.0.0.1:43487] with ContainerStateMachine:uninitialized
2019-06-17 00:15:28,971 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 00:15:28,971 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 00:15:28,971 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 00:15:28,971 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 00:15:28,971 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 016b7f35-b6c3-4698-9ea5-2929465bd394:group-81DE39B968B8 ConfigurationManager, init=-1: [016b7f35-b6c3-4698-9ea5-2929465bd394:127.0.0.1:43487], old=null, confs=<EMPTY_MAP>
2019-06-17 00:15:28,971 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc516a6c1-f169-4b0f-b32c-bc0ab1a07de5/ratis] (custom)
2019-06-17 00:15:28,972 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc516a6c1-f169-4b0f-b32c-bc0ab1a07de5/ratis/aa7f3c63-16d3-4cbe-8779-81de39b968b8 does not exist. Creating ...
2019-06-17 00:15:28,975 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc516a6c1-f169-4b0f-b32c-bc0ab1a07de5/ratis/aa7f3c63-16d3-4cbe-8779-81de39b968b8/in_use.lock acquired by nodename 4312@ozone-unit-076618677d39m8qw-2599800311
2019-06-17 00:15:28,977 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc516a6c1-f169-4b0f-b32c-bc0ab1a07de5/ratis/aa7f3c63-16d3-4cbe-8779-81de39b968b8 has been successfully formatted.
2019-06-17 00:15:28,977 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 00:15:28,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 00:15:28,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 00:15:28,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 00:15:28,978 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 00:15:28,978 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 00:15:28,978 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 016b7f35-b6c3-4698-9ea5-2929465bd394-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc516a6c1-f169-4b0f-b32c-bc0ab1a07de5/ratis/aa7f3c63-16d3-4cbe-8779-81de39b968b8
2019-06-17 00:15:28,978 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 00:15:28,978 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 00:15:28,978 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 00:15:28,978 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 00:15:28,978 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 00:15:28,978 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 00:15:28,978 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 00:15:28,979 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 00:15:28,979 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 00:15:28,979 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 00:15:28,979 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 00:15:28,980 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 00:15:28,980 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 00:15:28,980 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 016b7f35-b6c3-4698-9ea5-2929465bd394: start group-81DE39B968B8
2019-06-17 00:15:28,980 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 016b7f35-b6c3-4698-9ea5-2929465bd394:group-81DE39B968B8 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 00:15:28,980 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 016b7f35-b6c3-4698-9ea5-2929465bd394: start FollowerState
2019-06-17 00:15:28,980 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-81DE39B968B8,id=016b7f35-b6c3-4698-9ea5-2929465bd394
2019-06-17 00:15:30,121 INFO  impl.FollowerState (FollowerState.java:run(101)) - 016b7f35-b6c3-4698-9ea5-2929465bd394:group-81DE39B968B8 changes to CANDIDATE, lastRpcTime:1141, electionTimeout:1141ms
2019-06-17 00:15:30,122 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 016b7f35-b6c3-4698-9ea5-2929465bd394: shutdown FollowerState
2019-06-17 00:15:30,122 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 016b7f35-b6c3-4698-9ea5-2929465bd394:group-81DE39B968B8 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 00:15:30,122 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 016b7f35-b6c3-4698-9ea5-2929465bd394: start LeaderElection
2019-06-17 00:15:30,125 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 016b7f35-b6c3-4698-9ea5-2929465bd394:group-81DE39B968B8:LeaderElection3: begin an election at term 1 for -1: [016b7f35-b6c3-4698-9ea5-2929465bd394:127.0.0.1:43487], old=null
2019-06-17 00:15:30,126 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 016b7f35-b6c3-4698-9ea5-2929465bd394: shutdown LeaderElection
2019-06-17 00:15:30,126 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 016b7f35-b6c3-4698-9ea5-2929465bd394:group-81DE39B968B8 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 00:15:30,126 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 016b7f35-b6c3-4698-9ea5-2929465bd394:group-81DE39B968B8 change Leader from null to 016b7f35-b6c3-4698-9ea5-2929465bd394 at term 1 for becomeLeader, leader elected after 1148ms
2019-06-17 00:15:30,126 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 00:15:30,126 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 00:15:30,126 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 00:15:30,127 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 00:15:30,127 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 016b7f35-b6c3-4698-9ea5-2929465bd394: start LeaderState
2019-06-17 00:15:30,127 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 016b7f35-b6c3-4698-9ea5-2929465bd394-RaftLogWorker: Starting segment from index:0
2019-06-17 00:15:30,128 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 016b7f35-b6c3-4698-9ea5-2929465bd394:group-81DE39B968B8 set configuration 0: [016b7f35-b6c3-4698-9ea5-2929465bd394:127.0.0.1:43487], old=null at 0
2019-06-17 00:15:30,167 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 016b7f35-b6c3-4698-9ea5-2929465bd394-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc516a6c1-f169-4b0f-b32c-bc0ab1a07de5/ratis/aa7f3c63-16d3-4cbe-8779-81de39b968b8/current/log_inprogress_0
2019-06-17 00:15:31,031 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 6855153741856202400 is closed with bcsId 0.
2019-06-17 00:15:31,031 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 00:15:31,032 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 016b7f35-b6c3-4698-9ea5-2929465bd394: close
2019-06-17 00:15:31,032 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 016b7f35-b6c3-4698-9ea5-2929465bd394: shutdown group-81DE39B968B8
2019-06-17 00:15:31,032 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-81DE39B968B8,id=016b7f35-b6c3-4698-9ea5-2929465bd394
2019-06-17 00:15:31,033 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 016b7f35-b6c3-4698-9ea5-2929465bd394: shutdown LeaderState
2019-06-17 00:15:31,033 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 016b7f35-b6c3-4698-9ea5-2929465bd394-PendingRequests: sendNotLeaderResponses
2019-06-17 00:15:31,034 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-016b7f35-b6c3-4698-9ea5-2929465bd394-group-81DE39B968B8: set stopIndex = 2
2019-06-17 00:15:31,034 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 00:15:31,034 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc516a6c1-f169-4b0f-b32c-bc0ab1a07de5/ratis/aa7f3c63-16d3-4cbe-8779-81de39b968b8/sm/snapshot.1_2
2019-06-17 00:15:31,035 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 016b7f35-b6c3-4698-9ea5-2929465bd394:group-81DE39B968B8 closes. The last applied log index is 2
2019-06-17 00:15:31,035 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 016b7f35-b6c3-4698-9ea5-2929465bd394-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 00:15:31,036 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 016b7f35-b6c3-4698-9ea5-2929465bd394-RaftLogWorker close()
2019-06-17 00:15:31,037 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 016b7f35-b6c3-4698-9ea5-2929465bd394: shutdown server with port 43487 now
2019-06-17 00:15:31,038 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 016b7f35-b6c3-4698-9ea5-2929465bd394: shutdown server with port 43487 successfully
2019-06-17 00:15:31,042 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 00:15:31,077 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2417cba9-925c-4e78-9619-af044d0153ee/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 00:15:31,077 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2417cba9-925c-4e78-9619-af044d0153ee/hdds to VolumeSet
2019-06-17 00:15:31,077 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@37864b77
2019-06-17 00:15:31,078 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@37864b77
2019-06-17 00:15:31,087 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43801
2019-06-17 00:15:31,087 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 00:15:31,088 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 00:15:31,088 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43801 (custom)
2019-06-17 00:15:31,088 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 00:15:31,089 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 00:15:31,089 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 00:15:31,089 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 00:15:31,089 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2417cba9-925c-4e78-9619-af044d0153ee/ratis] (custom)
2019-06-17 00:15:31,090 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 46205
2019-06-17 00:15:31,090 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 00:15:31,090 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 00:15:31,090 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 78a16e4a-8800-4b68-bad6-e505263a3a2c at port 43801
2019-06-17 00:15:31,125 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c: start RPC server
2019-06-17 00:15:31,127 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c: GrpcService started, listening on 0.0.0.0/0.0.0.0:43801
Jun 17, 2019 12:15:31 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:43487} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 17, 2019 12:15:31 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:33567} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-17 00:15:31,148 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c: addNew group-329EA5AB4C06:[78a16e4a-8800-4b68-bad6-e505263a3a2c:127.0.0.1:43801] returns group-329EA5AB4C06:java.util.concurrent.CompletableFuture@271d345b[Not completed]
2019-06-17 00:15:31,148 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c: new RaftServerImpl for group-329EA5AB4C06:[78a16e4a-8800-4b68-bad6-e505263a3a2c:127.0.0.1:43801] with ContainerStateMachine:uninitialized
2019-06-17 00:15:31,149 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 00:15:31,149 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 00:15:31,149 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 00:15:31,149 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 00:15:31,149 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c:group-329EA5AB4C06 ConfigurationManager, init=-1: [78a16e4a-8800-4b68-bad6-e505263a3a2c:127.0.0.1:43801], old=null, confs=<EMPTY_MAP>
2019-06-17 00:15:31,150 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2417cba9-925c-4e78-9619-af044d0153ee/ratis] (custom)
2019-06-17 00:15:31,150 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2417cba9-925c-4e78-9619-af044d0153ee/ratis/5c8df149-4a35-4ed2-bd9d-329ea5ab4c06 does not exist. Creating ...
2019-06-17 00:15:31,153 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2417cba9-925c-4e78-9619-af044d0153ee/ratis/5c8df149-4a35-4ed2-bd9d-329ea5ab4c06/in_use.lock acquired by nodename 4312@ozone-unit-076618677d39m8qw-2599800311
2019-06-17 00:15:31,156 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2417cba9-925c-4e78-9619-af044d0153ee/ratis/5c8df149-4a35-4ed2-bd9d-329ea5ab4c06 has been successfully formatted.
2019-06-17 00:15:31,156 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 00:15:31,156 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 00:15:31,156 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 00:15:31,156 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 00:15:31,156 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 00:15:31,157 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 00:15:31,157 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 78a16e4a-8800-4b68-bad6-e505263a3a2c-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2417cba9-925c-4e78-9619-af044d0153ee/ratis/5c8df149-4a35-4ed2-bd9d-329ea5ab4c06
2019-06-17 00:15:31,157 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 00:15:31,157 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 00:15:31,157 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 00:15:31,157 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 00:15:31,157 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 00:15:31,158 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 00:15:31,158 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 00:15:31,158 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 00:15:31,158 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 00:15:31,158 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 00:15:31,159 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 00:15:31,159 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 00:15:31,159 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 00:15:31,159 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c: start group-329EA5AB4C06
2019-06-17 00:15:31,159 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c:group-329EA5AB4C06 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 00:15:31,160 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c: start FollowerState
2019-06-17 00:15:31,160 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-329EA5AB4C06,id=78a16e4a-8800-4b68-bad6-e505263a3a2c
2019-06-17 00:15:32,197 INFO  impl.FollowerState (FollowerState.java:run(101)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c:group-329EA5AB4C06 changes to CANDIDATE, lastRpcTime:1037, electionTimeout:1037ms
2019-06-17 00:15:32,197 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c: shutdown FollowerState
2019-06-17 00:15:32,197 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c:group-329EA5AB4C06 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 00:15:32,197 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c: start LeaderElection
2019-06-17 00:15:32,200 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c:group-329EA5AB4C06:LeaderElection4: begin an election at term 1 for -1: [78a16e4a-8800-4b68-bad6-e505263a3a2c:127.0.0.1:43801], old=null
2019-06-17 00:15:32,200 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c: shutdown LeaderElection
2019-06-17 00:15:32,201 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c:group-329EA5AB4C06 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 00:15:32,201 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c:group-329EA5AB4C06 change Leader from null to 78a16e4a-8800-4b68-bad6-e505263a3a2c at term 1 for becomeLeader, leader elected after 1044ms
2019-06-17 00:15:32,201 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 00:15:32,201 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 00:15:32,201 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 00:15:32,201 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 00:15:32,202 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c: start LeaderState
2019-06-17 00:15:32,202 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c-RaftLogWorker: Starting segment from index:0
2019-06-17 00:15:32,202 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c:group-329EA5AB4C06 set configuration 0: [78a16e4a-8800-4b68-bad6-e505263a3a2c:127.0.0.1:43801], old=null at 0
2019-06-17 00:15:32,247 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2417cba9-925c-4e78-9619-af044d0153ee/ratis/5c8df149-4a35-4ed2-bd9d-329ea5ab4c06/current/log_inprogress_0
2019-06-17 00:15:33,212 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 7403058594197841083 is closed with bcsId 0.
2019-06-17 00:15:33,212 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 00:15:33,213 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c: close
2019-06-17 00:15:33,213 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c: shutdown group-329EA5AB4C06
2019-06-17 00:15:33,214 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-329EA5AB4C06,id=78a16e4a-8800-4b68-bad6-e505263a3a2c
2019-06-17 00:15:33,214 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c: shutdown LeaderState
2019-06-17 00:15:33,216 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c-PendingRequests: sendNotLeaderResponses
2019-06-17 00:15:33,217 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-78a16e4a-8800-4b68-bad6-e505263a3a2c-group-329EA5AB4C06: set stopIndex = 2
2019-06-17 00:15:33,217 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 00:15:33,218 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2417cba9-925c-4e78-9619-af044d0153ee/ratis/5c8df149-4a35-4ed2-bd9d-329ea5ab4c06/sm/snapshot.1_2
2019-06-17 00:15:33,218 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c:group-329EA5AB4C06 closes. The last applied log index is 2
2019-06-17 00:15:33,218 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 00:15:33,219 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c-RaftLogWorker close()
2019-06-17 00:15:33,220 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c: shutdown server with port 43801 now
2019-06-17 00:15:33,222 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 78a16e4a-8800-4b68-bad6-e505263a3a2c: shutdown server with port 43801 successfully
2019-06-17 00:15:33,225 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 00:15:33,245 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3abb5789-6300-4814-8aae-45501e123ca6/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 00:15:33,245 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3abb5789-6300-4814-8aae-45501e123ca6/hdds to VolumeSet
2019-06-17 00:15:33,245 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@10bd9df0
2019-06-17 00:15:33,246 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@10bd9df0
2019-06-17 00:15:33,260 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 36971
2019-06-17 00:15:33,261 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 00:15:33,261 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 00:15:33,262 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 36971 (custom)
2019-06-17 00:15:33,262 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 00:15:33,262 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 00:15:33,263 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 00:15:33,263 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 00:15:33,263 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3abb5789-6300-4814-8aae-45501e123ca6/ratis] (custom)
2019-06-17 00:15:33,264 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 41919
2019-06-17 00:15:33,264 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 00:15:33,264 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 00:15:33,265 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis c70bb17d-4115-481b-afc8-0b3a110c3d47 at port 36971
2019-06-17 00:15:33,273 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - c70bb17d-4115-481b-afc8-0b3a110c3d47: start RPC server
2019-06-17 00:15:33,274 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - c70bb17d-4115-481b-afc8-0b3a110c3d47: GrpcService started, listening on 0.0.0.0/0.0.0.0:36971
2019-06-17 00:15:33,289 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - c70bb17d-4115-481b-afc8-0b3a110c3d47: addNew group-3D15F3450948:[c70bb17d-4115-481b-afc8-0b3a110c3d47:127.0.0.1:36971] returns group-3D15F3450948:java.util.concurrent.CompletableFuture@5706a190[Not completed]
2019-06-17 00:15:33,294 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - c70bb17d-4115-481b-afc8-0b3a110c3d47: new RaftServerImpl for group-3D15F3450948:[c70bb17d-4115-481b-afc8-0b3a110c3d47:127.0.0.1:36971] with ContainerStateMachine:uninitialized
2019-06-17 00:15:33,294 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 00:15:33,294 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 00:15:33,295 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 00:15:33,295 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 00:15:33,295 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - c70bb17d-4115-481b-afc8-0b3a110c3d47:group-3D15F3450948 ConfigurationManager, init=-1: [c70bb17d-4115-481b-afc8-0b3a110c3d47:127.0.0.1:36971], old=null, confs=<EMPTY_MAP>
2019-06-17 00:15:33,295 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3abb5789-6300-4814-8aae-45501e123ca6/ratis] (custom)
2019-06-17 00:15:33,295 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3abb5789-6300-4814-8aae-45501e123ca6/ratis/a6fda306-00fa-4796-ba3f-3d15f3450948 does not exist. Creating ...
2019-06-17 00:15:33,298 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3abb5789-6300-4814-8aae-45501e123ca6/ratis/a6fda306-00fa-4796-ba3f-3d15f3450948/in_use.lock acquired by nodename 4312@ozone-unit-076618677d39m8qw-2599800311
2019-06-17 00:15:33,300 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3abb5789-6300-4814-8aae-45501e123ca6/ratis/a6fda306-00fa-4796-ba3f-3d15f3450948 has been successfully formatted.
2019-06-17 00:15:33,301 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 00:15:33,301 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 00:15:33,301 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 00:15:33,301 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 00:15:33,301 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 00:15:33,301 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 00:15:33,301 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new c70bb17d-4115-481b-afc8-0b3a110c3d47-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3abb5789-6300-4814-8aae-45501e123ca6/ratis/a6fda306-00fa-4796-ba3f-3d15f3450948
2019-06-17 00:15:33,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 00:15:33,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 00:15:33,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 00:15:33,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 00:15:33,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 00:15:33,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 00:15:33,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 00:15:33,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 00:15:33,302 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 00:15:33,303 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 00:15:33,303 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 00:15:33,303 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 00:15:33,303 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 00:15:33,304 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - c70bb17d-4115-481b-afc8-0b3a110c3d47: start group-3D15F3450948
2019-06-17 00:15:33,304 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - c70bb17d-4115-481b-afc8-0b3a110c3d47:group-3D15F3450948 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 00:15:33,304 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c70bb17d-4115-481b-afc8-0b3a110c3d47: start FollowerState
2019-06-17 00:15:33,304 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-3D15F3450948,id=c70bb17d-4115-481b-afc8-0b3a110c3d47
2019-06-17 00:15:34,346 INFO  impl.FollowerState (FollowerState.java:run(101)) - c70bb17d-4115-481b-afc8-0b3a110c3d47:group-3D15F3450948 changes to CANDIDATE, lastRpcTime:1042, electionTimeout:1042ms
2019-06-17 00:15:34,347 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - c70bb17d-4115-481b-afc8-0b3a110c3d47: shutdown FollowerState
2019-06-17 00:15:34,347 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - c70bb17d-4115-481b-afc8-0b3a110c3d47:group-3D15F3450948 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 00:15:34,347 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c70bb17d-4115-481b-afc8-0b3a110c3d47: start LeaderElection
2019-06-17 00:15:34,350 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - c70bb17d-4115-481b-afc8-0b3a110c3d47:group-3D15F3450948:LeaderElection5: begin an election at term 1 for -1: [c70bb17d-4115-481b-afc8-0b3a110c3d47:127.0.0.1:36971], old=null
2019-06-17 00:15:34,350 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - c70bb17d-4115-481b-afc8-0b3a110c3d47: shutdown LeaderElection
2019-06-17 00:15:34,350 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - c70bb17d-4115-481b-afc8-0b3a110c3d47:group-3D15F3450948 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 00:15:34,351 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - c70bb17d-4115-481b-afc8-0b3a110c3d47:group-3D15F3450948 change Leader from null to c70bb17d-4115-481b-afc8-0b3a110c3d47 at term 1 for becomeLeader, leader elected after 1049ms
2019-06-17 00:15:34,351 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 00:15:34,351 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 00:15:34,351 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 00:15:34,351 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 00:15:34,351 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c70bb17d-4115-481b-afc8-0b3a110c3d47: start LeaderState
2019-06-17 00:15:34,352 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - c70bb17d-4115-481b-afc8-0b3a110c3d47-RaftLogWorker: Starting segment from index:0
2019-06-17 00:15:34,352 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - c70bb17d-4115-481b-afc8-0b3a110c3d47:group-3D15F3450948 set configuration 0: [c70bb17d-4115-481b-afc8-0b3a110c3d47:127.0.0.1:36971], old=null at 0
2019-06-17 00:15:34,394 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - c70bb17d-4115-481b-afc8-0b3a110c3d47-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3abb5789-6300-4814-8aae-45501e123ca6/ratis/a6fda306-00fa-4796-ba3f-3d15f3450948/current/log_inprogress_0
2019-06-17 00:15:35,350 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 8509529325040163652 is closed with bcsId 0.
2019-06-17 00:15:35,351 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 00:15:35,351 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - c70bb17d-4115-481b-afc8-0b3a110c3d47: close
2019-06-17 00:15:35,352 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - c70bb17d-4115-481b-afc8-0b3a110c3d47: shutdown group-3D15F3450948
2019-06-17 00:15:35,352 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-3D15F3450948,id=c70bb17d-4115-481b-afc8-0b3a110c3d47
2019-06-17 00:15:35,352 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - c70bb17d-4115-481b-afc8-0b3a110c3d47: shutdown LeaderState
2019-06-17 00:15:35,353 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - c70bb17d-4115-481b-afc8-0b3a110c3d47-PendingRequests: sendNotLeaderResponses
2019-06-17 00:15:35,354 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-c70bb17d-4115-481b-afc8-0b3a110c3d47-group-3D15F3450948: set stopIndex = 4
2019-06-17 00:15:35,354 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 00:15:35,354 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler3abb5789-6300-4814-8aae-45501e123ca6/ratis/a6fda306-00fa-4796-ba3f-3d15f3450948/sm/snapshot.1_4
2019-06-17 00:15:35,355 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - c70bb17d-4115-481b-afc8-0b3a110c3d47:group-3D15F3450948 closes. The last applied log index is 4
2019-06-17 00:15:35,355 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - c70bb17d-4115-481b-afc8-0b3a110c3d47-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 00:15:35,356 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - c70bb17d-4115-481b-afc8-0b3a110c3d47-RaftLogWorker close()
2019-06-17 00:15:35,356 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - c70bb17d-4115-481b-afc8-0b3a110c3d47: shutdown server with port 36971 now
2019-06-17 00:15:35,357 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - c70bb17d-4115-481b-afc8-0b3a110c3d47: shutdown server with port 36971 successfully
2019-06-17 00:15:35,362 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
