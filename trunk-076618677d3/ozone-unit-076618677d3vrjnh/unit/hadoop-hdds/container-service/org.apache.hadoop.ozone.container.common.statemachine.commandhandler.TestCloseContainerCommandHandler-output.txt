2019-06-17 06:03:39,514 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf2edc267-70ae-42de-b7ff-e25efbc4cfae/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 06:03:39,518 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf2edc267-70ae-42de-b7ff-e25efbc4cfae/hdds to VolumeSet
2019-06-17 06:03:39,543 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-17 06:03:39,568 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-17 06:03:39,880 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 37909
2019-06-17 06:03:40,281 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 06:03:40,300 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 06:03:40,307 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 37909 (custom)
2019-06-17 06:03:40,308 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 06:03:40,310 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 06:03:40,310 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 06:03:40,311 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 06:03:40,429 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf2edc267-70ae-42de-b7ff-e25efbc4cfae/ratis] (custom)
2019-06-17 06:03:40,438 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 38783
2019-06-17 06:03:40,457 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 06:03:40,457 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 06:03:40,458 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis e07ed512-46ee-4033-a0fc-6537c8545210 at port 37909
2019-06-17 06:03:40,469 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - e07ed512-46ee-4033-a0fc-6537c8545210: start RPC server
2019-06-17 06:03:40,590 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - e07ed512-46ee-4033-a0fc-6537c8545210: GrpcService started, listening on 0.0.0.0/0.0.0.0:37909
2019-06-17 06:03:40,907 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e07ed512-46ee-4033-a0fc-6537c8545210: addNew group-3514747F3AA9:[e07ed512-46ee-4033-a0fc-6537c8545210:127.0.0.1:37909] returns group-3514747F3AA9:java.util.concurrent.CompletableFuture@2c69a941[Not completed]
2019-06-17 06:03:40,938 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - e07ed512-46ee-4033-a0fc-6537c8545210: new RaftServerImpl for group-3514747F3AA9:[e07ed512-46ee-4033-a0fc-6537c8545210:127.0.0.1:37909] with ContainerStateMachine:uninitialized
2019-06-17 06:03:40,939 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 06:03:40,939 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 06:03:40,939 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 06:03:40,940 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 06:03:40,944 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - e07ed512-46ee-4033-a0fc-6537c8545210:group-3514747F3AA9 ConfigurationManager, init=-1: [e07ed512-46ee-4033-a0fc-6537c8545210:127.0.0.1:37909], old=null, confs=<EMPTY_MAP>
2019-06-17 06:03:40,945 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf2edc267-70ae-42de-b7ff-e25efbc4cfae/ratis] (custom)
2019-06-17 06:03:40,951 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf2edc267-70ae-42de-b7ff-e25efbc4cfae/ratis/c22a75bf-63ee-4a67-b62a-3514747f3aa9 does not exist. Creating ...
2019-06-17 06:03:40,960 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf2edc267-70ae-42de-b7ff-e25efbc4cfae/ratis/c22a75bf-63ee-4a67-b62a-3514747f3aa9/in_use.lock acquired by nodename 4302@ozone-unit-076618677d3vrjnh-228318701
2019-06-17 06:03:40,968 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf2edc267-70ae-42de-b7ff-e25efbc4cfae/ratis/c22a75bf-63ee-4a67-b62a-3514747f3aa9 has been successfully formatted.
2019-06-17 06:03:40,970 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 06:03:40,971 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 06:03:40,972 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 06:03:40,974 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 06:03:40,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 06:03:40,981 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 06:03:40,984 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new e07ed512-46ee-4033-a0fc-6537c8545210-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf2edc267-70ae-42de-b7ff-e25efbc4cfae/ratis/c22a75bf-63ee-4a67-b62a-3514747f3aa9
2019-06-17 06:03:40,985 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 06:03:40,985 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 06:03:40,987 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 06:03:40,987 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 06:03:40,987 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 06:03:40,988 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 06:03:40,989 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 06:03:40,989 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 06:03:40,989 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 06:03:40,991 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 06:03:40,996 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 06:03:40,997 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 06:03:40,997 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 06:03:41,093 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - e07ed512-46ee-4033-a0fc-6537c8545210: start group-3514747F3AA9
2019-06-17 06:03:41,094 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - e07ed512-46ee-4033-a0fc-6537c8545210:group-3514747F3AA9 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 06:03:41,095 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e07ed512-46ee-4033-a0fc-6537c8545210: start FollowerState
2019-06-17 06:03:41,097 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-3514747F3AA9,id=e07ed512-46ee-4033-a0fc-6537c8545210
2019-06-17 06:03:42,204 INFO  impl.FollowerState (FollowerState.java:run(101)) - e07ed512-46ee-4033-a0fc-6537c8545210:group-3514747F3AA9 changes to CANDIDATE, lastRpcTime:1108, electionTimeout:1108ms
2019-06-17 06:03:42,204 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e07ed512-46ee-4033-a0fc-6537c8545210: shutdown FollowerState
2019-06-17 06:03:42,204 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - e07ed512-46ee-4033-a0fc-6537c8545210:group-3514747F3AA9 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 06:03:42,206 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e07ed512-46ee-4033-a0fc-6537c8545210: start LeaderElection
2019-06-17 06:03:42,209 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - e07ed512-46ee-4033-a0fc-6537c8545210:group-3514747F3AA9:LeaderElection1: begin an election at term 1 for -1: [e07ed512-46ee-4033-a0fc-6537c8545210:127.0.0.1:37909], old=null
2019-06-17 06:03:42,210 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e07ed512-46ee-4033-a0fc-6537c8545210: shutdown LeaderElection
2019-06-17 06:03:42,210 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - e07ed512-46ee-4033-a0fc-6537c8545210:group-3514747F3AA9 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 06:03:42,210 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - e07ed512-46ee-4033-a0fc-6537c8545210:group-3514747F3AA9 change Leader from null to e07ed512-46ee-4033-a0fc-6537c8545210 at term 1 for becomeLeader, leader elected after 1239ms
2019-06-17 06:03:42,214 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 06:03:42,214 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 06:03:42,216 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 06:03:42,216 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 06:03:42,226 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e07ed512-46ee-4033-a0fc-6537c8545210: start LeaderState
2019-06-17 06:03:42,241 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - e07ed512-46ee-4033-a0fc-6537c8545210-RaftLogWorker: Starting segment from index:0
2019-06-17 06:03:42,249 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - e07ed512-46ee-4033-a0fc-6537c8545210:group-3514747F3AA9 set configuration 0: [e07ed512-46ee-4033-a0fc-6537c8545210:127.0.0.1:37909], old=null at 0
2019-06-17 06:03:42,369 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - e07ed512-46ee-4033-a0fc-6537c8545210-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf2edc267-70ae-42de-b7ff-e25efbc4cfae/ratis/c22a75bf-63ee-4a67-b62a-3514747f3aa9/current/log_inprogress_0
2019-06-17 06:03:43,310 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-17 06:03:43,362 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 8984436675199320196 is closed with bcsId 0.
2019-06-17 06:03:43,363 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 06:03:43,364 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - e07ed512-46ee-4033-a0fc-6537c8545210: close
2019-06-17 06:03:43,365 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - e07ed512-46ee-4033-a0fc-6537c8545210: shutdown group-3514747F3AA9
2019-06-17 06:03:43,366 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-3514747F3AA9,id=e07ed512-46ee-4033-a0fc-6537c8545210
2019-06-17 06:03:43,366 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e07ed512-46ee-4033-a0fc-6537c8545210: shutdown LeaderState
2019-06-17 06:03:43,366 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - e07ed512-46ee-4033-a0fc-6537c8545210-PendingRequests: sendNotLeaderResponses
2019-06-17 06:03:43,368 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-e07ed512-46ee-4033-a0fc-6537c8545210-group-3514747F3AA9: set stopIndex = 4
2019-06-17 06:03:43,368 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 06:03:43,369 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf2edc267-70ae-42de-b7ff-e25efbc4cfae/ratis/c22a75bf-63ee-4a67-b62a-3514747f3aa9/sm/snapshot.1_4
2019-06-17 06:03:43,377 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - e07ed512-46ee-4033-a0fc-6537c8545210:group-3514747F3AA9 closes. The last applied log index is 4
2019-06-17 06:03:43,378 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - e07ed512-46ee-4033-a0fc-6537c8545210-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 06:03:43,378 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - e07ed512-46ee-4033-a0fc-6537c8545210-RaftLogWorker close()
2019-06-17 06:03:43,379 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - e07ed512-46ee-4033-a0fc-6537c8545210: shutdown server with port 37909 now
2019-06-17 06:03:43,383 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - e07ed512-46ee-4033-a0fc-6537c8545210: shutdown server with port 37909 successfully
2019-06-17 06:03:43,391 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 06:03:43,421 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4e55ae63-387e-4c8c-a798-73426736916a/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 06:03:43,422 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4e55ae63-387e-4c8c-a798-73426736916a/hdds to VolumeSet
2019-06-17 06:03:43,422 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@6f7e336b
2019-06-17 06:03:43,423 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@6f7e336b
2019-06-17 06:03:43,437 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 33041
2019-06-17 06:03:43,438 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 06:03:43,439 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 06:03:43,439 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 33041 (custom)
2019-06-17 06:03:43,440 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 06:03:43,440 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 06:03:43,440 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 06:03:43,440 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 06:03:43,441 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4e55ae63-387e-4c8c-a798-73426736916a/ratis] (custom)
2019-06-17 06:03:43,442 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 39871
2019-06-17 06:03:43,442 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 06:03:43,442 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 06:03:43,443 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 33399643-c051-47ce-a4b3-b6835e4bdf9f at port 33041
2019-06-17 06:03:43,469 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f: start RPC server
2019-06-17 06:03:43,470 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f: GrpcService started, listening on 0.0.0.0/0.0.0.0:33041
2019-06-17 06:03:43,480 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f: addNew group-6DC8C4CF1766:[33399643-c051-47ce-a4b3-b6835e4bdf9f:127.0.0.1:33041] returns group-6DC8C4CF1766:java.util.concurrent.CompletableFuture@59488b08[Not completed]
2019-06-17 06:03:43,482 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f: new RaftServerImpl for group-6DC8C4CF1766:[33399643-c051-47ce-a4b3-b6835e4bdf9f:127.0.0.1:33041] with ContainerStateMachine:uninitialized
2019-06-17 06:03:43,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 06:03:43,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 06:03:43,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 06:03:43,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 06:03:43,482 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f:group-6DC8C4CF1766 ConfigurationManager, init=-1: [33399643-c051-47ce-a4b3-b6835e4bdf9f:127.0.0.1:33041], old=null, confs=<EMPTY_MAP>
2019-06-17 06:03:43,483 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4e55ae63-387e-4c8c-a798-73426736916a/ratis] (custom)
2019-06-17 06:03:43,483 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4e55ae63-387e-4c8c-a798-73426736916a/ratis/3baec37b-cdf1-4314-a734-6dc8c4cf1766 does not exist. Creating ...
2019-06-17 06:03:43,486 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4e55ae63-387e-4c8c-a798-73426736916a/ratis/3baec37b-cdf1-4314-a734-6dc8c4cf1766/in_use.lock acquired by nodename 4302@ozone-unit-076618677d3vrjnh-228318701
2019-06-17 06:03:43,488 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4e55ae63-387e-4c8c-a798-73426736916a/ratis/3baec37b-cdf1-4314-a734-6dc8c4cf1766 has been successfully formatted.
2019-06-17 06:03:43,488 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 06:03:43,488 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 06:03:43,488 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 06:03:43,488 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 06:03:43,489 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 06:03:43,489 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 06:03:43,489 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 33399643-c051-47ce-a4b3-b6835e4bdf9f-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4e55ae63-387e-4c8c-a798-73426736916a/ratis/3baec37b-cdf1-4314-a734-6dc8c4cf1766
2019-06-17 06:03:43,489 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 06:03:43,489 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 06:03:43,489 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 06:03:43,489 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 06:03:43,489 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 06:03:43,490 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 06:03:43,490 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 06:03:43,490 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 06:03:43,490 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 06:03:43,490 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 06:03:43,490 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 06:03:43,490 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 06:03:43,491 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 06:03:43,491 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f: start group-6DC8C4CF1766
2019-06-17 06:03:43,491 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f:group-6DC8C4CF1766 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 06:03:43,491 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f: start FollowerState
2019-06-17 06:03:43,491 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-6DC8C4CF1766,id=33399643-c051-47ce-a4b3-b6835e4bdf9f
2019-06-17 06:03:44,659 INFO  impl.FollowerState (FollowerState.java:run(101)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f:group-6DC8C4CF1766 changes to CANDIDATE, lastRpcTime:1168, electionTimeout:1168ms
2019-06-17 06:03:44,659 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f: shutdown FollowerState
2019-06-17 06:03:44,660 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f:group-6DC8C4CF1766 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 06:03:44,660 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f: start LeaderElection
2019-06-17 06:03:44,663 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f:group-6DC8C4CF1766:LeaderElection2: begin an election at term 1 for -1: [33399643-c051-47ce-a4b3-b6835e4bdf9f:127.0.0.1:33041], old=null
2019-06-17 06:03:44,663 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f: shutdown LeaderElection
2019-06-17 06:03:44,663 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f:group-6DC8C4CF1766 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 06:03:44,663 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f:group-6DC8C4CF1766 change Leader from null to 33399643-c051-47ce-a4b3-b6835e4bdf9f at term 1 for becomeLeader, leader elected after 1174ms
2019-06-17 06:03:44,663 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 06:03:44,663 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 06:03:44,663 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 06:03:44,664 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 06:03:44,664 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f: start LeaderState
2019-06-17 06:03:44,664 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f-RaftLogWorker: Starting segment from index:0
2019-06-17 06:03:44,664 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f:group-6DC8C4CF1766 set configuration 0: [33399643-c051-47ce-a4b3-b6835e4bdf9f:127.0.0.1:33041], old=null at 0
2019-06-17 06:03:44,701 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4e55ae63-387e-4c8c-a798-73426736916a/ratis/3baec37b-cdf1-4314-a734-6dc8c4cf1766/current/log_inprogress_0
2019-06-17 06:03:45,524 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 06:03:45,525 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f: close
2019-06-17 06:03:45,525 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f: shutdown group-6DC8C4CF1766
2019-06-17 06:03:45,525 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-6DC8C4CF1766,id=33399643-c051-47ce-a4b3-b6835e4bdf9f
2019-06-17 06:03:45,526 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f: shutdown LeaderState
2019-06-17 06:03:45,526 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f-PendingRequests: sendNotLeaderResponses
2019-06-17 06:03:45,527 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-33399643-c051-47ce-a4b3-b6835e4bdf9f-group-6DC8C4CF1766: set stopIndex = 2
2019-06-17 06:03:45,527 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 06:03:45,527 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4e55ae63-387e-4c8c-a798-73426736916a/ratis/3baec37b-cdf1-4314-a734-6dc8c4cf1766/sm/snapshot.1_2
2019-06-17 06:03:45,528 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f:group-6DC8C4CF1766 closes. The last applied log index is 2
2019-06-17 06:03:45,528 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 06:03:45,529 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f-RaftLogWorker close()
2019-06-17 06:03:45,530 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f: shutdown server with port 33041 now
2019-06-17 06:03:45,531 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 33399643-c051-47ce-a4b3-b6835e4bdf9f: shutdown server with port 33041 successfully
2019-06-17 06:03:45,536 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 06:03:45,567 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerbb37c215-ef30-4203-be6a-75d0d4ac494d/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 06:03:45,567 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerbb37c215-ef30-4203-be6a-75d0d4ac494d/hdds to VolumeSet
2019-06-17 06:03:45,567 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1f51431
2019-06-17 06:03:45,568 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1f51431
2019-06-17 06:03:45,581 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 44643
2019-06-17 06:03:45,582 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 06:03:45,582 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 06:03:45,583 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 44643 (custom)
2019-06-17 06:03:45,583 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 06:03:45,583 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 06:03:45,583 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 06:03:45,584 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 06:03:45,584 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerbb37c215-ef30-4203-be6a-75d0d4ac494d/ratis] (custom)
2019-06-17 06:03:45,585 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 40785
2019-06-17 06:03:45,585 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 06:03:45,585 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 06:03:45,585 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis d0b6488c-c3f0-445d-8a2f-49f34044da67 at port 44643
2019-06-17 06:03:45,594 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - d0b6488c-c3f0-445d-8a2f-49f34044da67: start RPC server
2019-06-17 06:03:45,595 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - d0b6488c-c3f0-445d-8a2f-49f34044da67: GrpcService started, listening on 0.0.0.0/0.0.0.0:44643
2019-06-17 06:03:45,604 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - d0b6488c-c3f0-445d-8a2f-49f34044da67: addNew group-08A20C1BBD5A:[d0b6488c-c3f0-445d-8a2f-49f34044da67:127.0.0.1:44643] returns group-08A20C1BBD5A:java.util.concurrent.CompletableFuture@141dd21b[Not completed]
2019-06-17 06:03:45,605 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - d0b6488c-c3f0-445d-8a2f-49f34044da67: new RaftServerImpl for group-08A20C1BBD5A:[d0b6488c-c3f0-445d-8a2f-49f34044da67:127.0.0.1:44643] with ContainerStateMachine:uninitialized
2019-06-17 06:03:45,605 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 06:03:45,605 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 06:03:45,605 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 06:03:45,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 06:03:45,606 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - d0b6488c-c3f0-445d-8a2f-49f34044da67:group-08A20C1BBD5A ConfigurationManager, init=-1: [d0b6488c-c3f0-445d-8a2f-49f34044da67:127.0.0.1:44643], old=null, confs=<EMPTY_MAP>
2019-06-17 06:03:45,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerbb37c215-ef30-4203-be6a-75d0d4ac494d/ratis] (custom)
2019-06-17 06:03:45,606 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerbb37c215-ef30-4203-be6a-75d0d4ac494d/ratis/f42d56c4-d404-45d3-9dd7-08a20c1bbd5a does not exist. Creating ...
2019-06-17 06:03:45,609 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerbb37c215-ef30-4203-be6a-75d0d4ac494d/ratis/f42d56c4-d404-45d3-9dd7-08a20c1bbd5a/in_use.lock acquired by nodename 4302@ozone-unit-076618677d3vrjnh-228318701
2019-06-17 06:03:45,611 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerbb37c215-ef30-4203-be6a-75d0d4ac494d/ratis/f42d56c4-d404-45d3-9dd7-08a20c1bbd5a has been successfully formatted.
2019-06-17 06:03:45,611 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 06:03:45,612 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 06:03:45,612 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 06:03:45,612 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 06:03:45,612 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 06:03:45,612 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 06:03:45,612 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new d0b6488c-c3f0-445d-8a2f-49f34044da67-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerbb37c215-ef30-4203-be6a-75d0d4ac494d/ratis/f42d56c4-d404-45d3-9dd7-08a20c1bbd5a
2019-06-17 06:03:45,612 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 06:03:45,612 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 06:03:45,613 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 06:03:45,613 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 06:03:45,613 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 06:03:45,613 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 06:03:45,613 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 06:03:45,613 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 06:03:45,613 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 06:03:45,613 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 06:03:45,614 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 06:03:45,614 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 06:03:45,614 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 06:03:45,614 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - d0b6488c-c3f0-445d-8a2f-49f34044da67: start group-08A20C1BBD5A
2019-06-17 06:03:45,614 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d0b6488c-c3f0-445d-8a2f-49f34044da67:group-08A20C1BBD5A changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 06:03:45,614 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d0b6488c-c3f0-445d-8a2f-49f34044da67: start FollowerState
2019-06-17 06:03:45,614 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-08A20C1BBD5A,id=d0b6488c-c3f0-445d-8a2f-49f34044da67
2019-06-17 06:03:46,650 INFO  impl.FollowerState (FollowerState.java:run(101)) - d0b6488c-c3f0-445d-8a2f-49f34044da67:group-08A20C1BBD5A changes to CANDIDATE, lastRpcTime:1036, electionTimeout:1036ms
2019-06-17 06:03:46,651 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d0b6488c-c3f0-445d-8a2f-49f34044da67: shutdown FollowerState
2019-06-17 06:03:46,651 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d0b6488c-c3f0-445d-8a2f-49f34044da67:group-08A20C1BBD5A changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 06:03:46,651 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d0b6488c-c3f0-445d-8a2f-49f34044da67: start LeaderElection
2019-06-17 06:03:46,654 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - d0b6488c-c3f0-445d-8a2f-49f34044da67:group-08A20C1BBD5A:LeaderElection3: begin an election at term 1 for -1: [d0b6488c-c3f0-445d-8a2f-49f34044da67:127.0.0.1:44643], old=null
2019-06-17 06:03:46,654 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - d0b6488c-c3f0-445d-8a2f-49f34044da67: shutdown LeaderElection
2019-06-17 06:03:46,654 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d0b6488c-c3f0-445d-8a2f-49f34044da67:group-08A20C1BBD5A changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 06:03:46,654 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - d0b6488c-c3f0-445d-8a2f-49f34044da67:group-08A20C1BBD5A change Leader from null to d0b6488c-c3f0-445d-8a2f-49f34044da67 at term 1 for becomeLeader, leader elected after 1042ms
2019-06-17 06:03:46,654 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 06:03:46,654 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 06:03:46,655 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 06:03:46,655 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 06:03:46,655 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d0b6488c-c3f0-445d-8a2f-49f34044da67: start LeaderState
2019-06-17 06:03:46,655 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - d0b6488c-c3f0-445d-8a2f-49f34044da67-RaftLogWorker: Starting segment from index:0
2019-06-17 06:03:46,661 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - d0b6488c-c3f0-445d-8a2f-49f34044da67:group-08A20C1BBD5A set configuration 0: [d0b6488c-c3f0-445d-8a2f-49f34044da67:127.0.0.1:44643], old=null at 0
2019-06-17 06:03:46,692 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - d0b6488c-c3f0-445d-8a2f-49f34044da67-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerbb37c215-ef30-4203-be6a-75d0d4ac494d/ratis/f42d56c4-d404-45d3-9dd7-08a20c1bbd5a/current/log_inprogress_0
2019-06-17 06:03:47,658 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 3940996160610840810 is closed with bcsId 0.
2019-06-17 06:03:47,659 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 06:03:47,659 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - d0b6488c-c3f0-445d-8a2f-49f34044da67: close
2019-06-17 06:03:47,659 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - d0b6488c-c3f0-445d-8a2f-49f34044da67: shutdown group-08A20C1BBD5A
2019-06-17 06:03:47,659 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-08A20C1BBD5A,id=d0b6488c-c3f0-445d-8a2f-49f34044da67
2019-06-17 06:03:47,660 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - d0b6488c-c3f0-445d-8a2f-49f34044da67: shutdown LeaderState
2019-06-17 06:03:47,660 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - d0b6488c-c3f0-445d-8a2f-49f34044da67-PendingRequests: sendNotLeaderResponses
2019-06-17 06:03:47,661 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-d0b6488c-c3f0-445d-8a2f-49f34044da67-group-08A20C1BBD5A: set stopIndex = 2
2019-06-17 06:03:47,661 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 06:03:47,661 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerbb37c215-ef30-4203-be6a-75d0d4ac494d/ratis/f42d56c4-d404-45d3-9dd7-08a20c1bbd5a/sm/snapshot.1_2
2019-06-17 06:03:47,661 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - d0b6488c-c3f0-445d-8a2f-49f34044da67:group-08A20C1BBD5A closes. The last applied log index is 2
2019-06-17 06:03:47,662 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - d0b6488c-c3f0-445d-8a2f-49f34044da67-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 06:03:47,662 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - d0b6488c-c3f0-445d-8a2f-49f34044da67-RaftLogWorker close()
2019-06-17 06:03:47,663 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - d0b6488c-c3f0-445d-8a2f-49f34044da67: shutdown server with port 44643 now
2019-06-17 06:03:47,665 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - d0b6488c-c3f0-445d-8a2f-49f34044da67: shutdown server with port 44643 successfully
2019-06-17 06:03:47,667 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 06:03:47,701 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2ab23b14-4dec-4188-80c5-cac05ac7f509/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 06:03:47,702 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2ab23b14-4dec-4188-80c5-cac05ac7f509/hdds to VolumeSet
2019-06-17 06:03:47,702 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@23940f86
2019-06-17 06:03:47,710 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@23940f86
2019-06-17 06:03:47,720 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 41451
2019-06-17 06:03:47,720 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 06:03:47,721 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 06:03:47,721 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 41451 (custom)
2019-06-17 06:03:47,722 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 06:03:47,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 06:03:47,722 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 06:03:47,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 06:03:47,723 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2ab23b14-4dec-4188-80c5-cac05ac7f509/ratis] (custom)
2019-06-17 06:03:47,723 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 39571
2019-06-17 06:03:47,724 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 06:03:47,724 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 06:03:47,724 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis e4db45c1-fdc7-4ad2-a851-419ded7eb039 at port 41451
2019-06-17 06:03:47,734 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039: start RPC server
2019-06-17 06:03:47,735 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039: GrpcService started, listening on 0.0.0.0/0.0.0.0:41451
Jun 17, 2019 6:03:47 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:33041} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 17, 2019 6:03:47 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:44643} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-17 06:03:47,756 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039: addNew group-3FA0B017E28E:[e4db45c1-fdc7-4ad2-a851-419ded7eb039:127.0.0.1:41451] returns group-3FA0B017E28E:java.util.concurrent.CompletableFuture@6eaf626[Not completed]
2019-06-17 06:03:47,757 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039: new RaftServerImpl for group-3FA0B017E28E:[e4db45c1-fdc7-4ad2-a851-419ded7eb039:127.0.0.1:41451] with ContainerStateMachine:uninitialized
2019-06-17 06:03:47,757 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 06:03:47,757 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 06:03:47,757 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 06:03:47,757 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 06:03:47,758 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039:group-3FA0B017E28E ConfigurationManager, init=-1: [e4db45c1-fdc7-4ad2-a851-419ded7eb039:127.0.0.1:41451], old=null, confs=<EMPTY_MAP>
2019-06-17 06:03:47,758 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2ab23b14-4dec-4188-80c5-cac05ac7f509/ratis] (custom)
2019-06-17 06:03:47,758 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2ab23b14-4dec-4188-80c5-cac05ac7f509/ratis/fc7bacce-e573-490d-9766-3fa0b017e28e does not exist. Creating ...
2019-06-17 06:03:47,761 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2ab23b14-4dec-4188-80c5-cac05ac7f509/ratis/fc7bacce-e573-490d-9766-3fa0b017e28e/in_use.lock acquired by nodename 4302@ozone-unit-076618677d3vrjnh-228318701
2019-06-17 06:03:47,763 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2ab23b14-4dec-4188-80c5-cac05ac7f509/ratis/fc7bacce-e573-490d-9766-3fa0b017e28e has been successfully formatted.
2019-06-17 06:03:47,763 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 06:03:47,763 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 06:03:47,764 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 06:03:47,764 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 06:03:47,764 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 06:03:47,764 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 06:03:47,764 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new e4db45c1-fdc7-4ad2-a851-419ded7eb039-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2ab23b14-4dec-4188-80c5-cac05ac7f509/ratis/fc7bacce-e573-490d-9766-3fa0b017e28e
2019-06-17 06:03:47,764 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 06:03:47,764 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 06:03:47,764 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 06:03:47,764 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 06:03:47,764 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 06:03:47,764 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 06:03:47,764 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 06:03:47,765 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 06:03:47,765 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 06:03:47,765 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 06:03:47,765 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 06:03:47,765 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 06:03:47,765 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 06:03:47,766 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039: start group-3FA0B017E28E
2019-06-17 06:03:47,766 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039:group-3FA0B017E28E changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 06:03:47,766 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039: start FollowerState
2019-06-17 06:03:47,766 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-3FA0B017E28E,id=e4db45c1-fdc7-4ad2-a851-419ded7eb039
2019-06-17 06:03:48,784 INFO  impl.FollowerState (FollowerState.java:run(101)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039:group-3FA0B017E28E changes to CANDIDATE, lastRpcTime:1018, electionTimeout:1018ms
2019-06-17 06:03:48,784 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039: shutdown FollowerState
2019-06-17 06:03:48,784 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039:group-3FA0B017E28E changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 06:03:48,784 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039: start LeaderElection
2019-06-17 06:03:48,787 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039:group-3FA0B017E28E:LeaderElection4: begin an election at term 1 for -1: [e4db45c1-fdc7-4ad2-a851-419ded7eb039:127.0.0.1:41451], old=null
2019-06-17 06:03:48,787 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039: shutdown LeaderElection
2019-06-17 06:03:48,788 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039:group-3FA0B017E28E changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 06:03:48,788 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039:group-3FA0B017E28E change Leader from null to e4db45c1-fdc7-4ad2-a851-419ded7eb039 at term 1 for becomeLeader, leader elected after 1024ms
2019-06-17 06:03:48,788 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 06:03:48,788 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 06:03:48,788 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 06:03:48,788 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 06:03:48,788 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039: start LeaderState
2019-06-17 06:03:48,788 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039-RaftLogWorker: Starting segment from index:0
2019-06-17 06:03:48,789 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039:group-3FA0B017E28E set configuration 0: [e4db45c1-fdc7-4ad2-a851-419ded7eb039:127.0.0.1:41451], old=null at 0
2019-06-17 06:03:48,828 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2ab23b14-4dec-4188-80c5-cac05ac7f509/ratis/fc7bacce-e573-490d-9766-3fa0b017e28e/current/log_inprogress_0
2019-06-17 06:03:49,807 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 2647714924786952100 is closed with bcsId 0.
2019-06-17 06:03:49,808 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 06:03:49,808 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039: close
2019-06-17 06:03:49,808 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039: shutdown group-3FA0B017E28E
2019-06-17 06:03:49,809 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-3FA0B017E28E,id=e4db45c1-fdc7-4ad2-a851-419ded7eb039
2019-06-17 06:03:49,809 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039: shutdown LeaderState
2019-06-17 06:03:49,809 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039-PendingRequests: sendNotLeaderResponses
2019-06-17 06:03:49,810 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-e4db45c1-fdc7-4ad2-a851-419ded7eb039-group-3FA0B017E28E: set stopIndex = 2
2019-06-17 06:03:49,810 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 06:03:49,811 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2ab23b14-4dec-4188-80c5-cac05ac7f509/ratis/fc7bacce-e573-490d-9766-3fa0b017e28e/sm/snapshot.1_2
2019-06-17 06:03:49,811 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039:group-3FA0B017E28E closes. The last applied log index is 2
2019-06-17 06:03:49,811 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 06:03:49,812 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039-RaftLogWorker close()
2019-06-17 06:03:49,812 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039: shutdown server with port 41451 now
2019-06-17 06:03:49,814 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - e4db45c1-fdc7-4ad2-a851-419ded7eb039: shutdown server with port 41451 successfully
2019-06-17 06:03:49,817 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 06:03:49,837 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere5247e3e-1148-46d3-84c9-670562a8eaad/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 06:03:49,837 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere5247e3e-1148-46d3-84c9-670562a8eaad/hdds to VolumeSet
2019-06-17 06:03:49,838 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1ac45389
2019-06-17 06:03:49,843 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1ac45389
2019-06-17 06:03:49,852 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 36009
2019-06-17 06:03:49,853 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 06:03:49,853 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 06:03:49,854 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 36009 (custom)
2019-06-17 06:03:49,854 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 06:03:49,854 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 06:03:49,854 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 06:03:49,854 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 06:03:49,855 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere5247e3e-1148-46d3-84c9-670562a8eaad/ratis] (custom)
2019-06-17 06:03:49,855 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 41563
2019-06-17 06:03:49,856 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 06:03:49,856 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 06:03:49,856 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed at port 36009
2019-06-17 06:03:49,867 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed: start RPC server
2019-06-17 06:03:49,868 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed: GrpcService started, listening on 0.0.0.0/0.0.0.0:36009
2019-06-17 06:03:49,879 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed: addNew group-A4D8D8539B17:[3510e5d1-17bf-48fe-8dfa-9ec35f9165ed:127.0.0.1:36009] returns group-A4D8D8539B17:java.util.concurrent.CompletableFuture@1dfc30d3[Not completed]
2019-06-17 06:03:49,879 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed: new RaftServerImpl for group-A4D8D8539B17:[3510e5d1-17bf-48fe-8dfa-9ec35f9165ed:127.0.0.1:36009] with ContainerStateMachine:uninitialized
2019-06-17 06:03:49,880 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 06:03:49,880 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 06:03:49,880 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 06:03:49,880 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 06:03:49,880 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed:group-A4D8D8539B17 ConfigurationManager, init=-1: [3510e5d1-17bf-48fe-8dfa-9ec35f9165ed:127.0.0.1:36009], old=null, confs=<EMPTY_MAP>
2019-06-17 06:03:49,880 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere5247e3e-1148-46d3-84c9-670562a8eaad/ratis] (custom)
2019-06-17 06:03:49,881 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere5247e3e-1148-46d3-84c9-670562a8eaad/ratis/c2992394-0f23-4994-91f5-a4d8d8539b17 does not exist. Creating ...
2019-06-17 06:03:49,883 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere5247e3e-1148-46d3-84c9-670562a8eaad/ratis/c2992394-0f23-4994-91f5-a4d8d8539b17/in_use.lock acquired by nodename 4302@ozone-unit-076618677d3vrjnh-228318701
2019-06-17 06:03:49,885 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere5247e3e-1148-46d3-84c9-670562a8eaad/ratis/c2992394-0f23-4994-91f5-a4d8d8539b17 has been successfully formatted.
2019-06-17 06:03:49,886 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 06:03:49,886 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 06:03:49,886 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 06:03:49,886 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 06:03:49,886 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 06:03:49,886 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 06:03:49,886 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere5247e3e-1148-46d3-84c9-670562a8eaad/ratis/c2992394-0f23-4994-91f5-a4d8d8539b17
2019-06-17 06:03:49,887 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 06:03:49,887 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 06:03:49,887 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 06:03:49,887 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 06:03:49,887 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 06:03:49,887 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 06:03:49,887 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 06:03:49,887 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 06:03:49,887 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 06:03:49,888 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 06:03:49,888 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 06:03:49,888 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 06:03:49,888 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 06:03:49,889 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed: start group-A4D8D8539B17
2019-06-17 06:03:49,889 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed:group-A4D8D8539B17 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 06:03:49,889 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed: start FollowerState
2019-06-17 06:03:49,889 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-A4D8D8539B17,id=3510e5d1-17bf-48fe-8dfa-9ec35f9165ed
2019-06-17 06:03:50,931 INFO  impl.FollowerState (FollowerState.java:run(101)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed:group-A4D8D8539B17 changes to CANDIDATE, lastRpcTime:1042, electionTimeout:1042ms
2019-06-17 06:03:50,932 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed: shutdown FollowerState
2019-06-17 06:03:50,932 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed:group-A4D8D8539B17 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 06:03:50,932 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed: start LeaderElection
2019-06-17 06:03:50,935 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed:group-A4D8D8539B17:LeaderElection5: begin an election at term 1 for -1: [3510e5d1-17bf-48fe-8dfa-9ec35f9165ed:127.0.0.1:36009], old=null
2019-06-17 06:03:50,935 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed: shutdown LeaderElection
2019-06-17 06:03:50,935 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed:group-A4D8D8539B17 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 06:03:50,935 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed:group-A4D8D8539B17 change Leader from null to 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed at term 1 for becomeLeader, leader elected after 1049ms
2019-06-17 06:03:50,936 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 06:03:50,936 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 06:03:50,936 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 06:03:50,936 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 06:03:50,936 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed: start LeaderState
2019-06-17 06:03:50,936 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed-RaftLogWorker: Starting segment from index:0
2019-06-17 06:03:50,937 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed:group-A4D8D8539B17 set configuration 0: [3510e5d1-17bf-48fe-8dfa-9ec35f9165ed:127.0.0.1:36009], old=null at 0
2019-06-17 06:03:50,976 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere5247e3e-1148-46d3-84c9-670562a8eaad/ratis/c2992394-0f23-4994-91f5-a4d8d8539b17/current/log_inprogress_0
2019-06-17 06:03:51,929 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 5308398309639745803 is closed with bcsId 0.
2019-06-17 06:03:51,930 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 06:03:51,930 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed: close
2019-06-17 06:03:51,930 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed: shutdown group-A4D8D8539B17
2019-06-17 06:03:51,930 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-A4D8D8539B17,id=3510e5d1-17bf-48fe-8dfa-9ec35f9165ed
2019-06-17 06:03:51,931 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed: shutdown LeaderState
2019-06-17 06:03:51,931 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed-PendingRequests: sendNotLeaderResponses
2019-06-17 06:03:51,932 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-3510e5d1-17bf-48fe-8dfa-9ec35f9165ed-group-A4D8D8539B17: set stopIndex = 4
2019-06-17 06:03:51,932 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 06:03:51,933 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere5247e3e-1148-46d3-84c9-670562a8eaad/ratis/c2992394-0f23-4994-91f5-a4d8d8539b17/sm/snapshot.1_4
2019-06-17 06:03:51,933 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed:group-A4D8D8539B17 closes. The last applied log index is 4
2019-06-17 06:03:51,933 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 06:03:51,938 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed-RaftLogWorker close()
2019-06-17 06:03:51,939 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed: shutdown server with port 36009 now
2019-06-17 06:03:51,940 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 3510e5d1-17bf-48fe-8dfa-9ec35f9165ed: shutdown server with port 36009 successfully
2019-06-17 06:03:51,941 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
