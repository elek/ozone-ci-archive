2019-06-17 14:26:15,383 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler41733a96-38a7-4ea4-a2b0-c94331fb6989/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 14:26:15,389 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler41733a96-38a7-4ea4-a2b0-c94331fb6989/hdds to VolumeSet
2019-06-17 14:26:15,403 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-17 14:26:15,457 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-17 14:26:15,877 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 42359
2019-06-17 14:26:16,381 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 14:26:16,403 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 14:26:16,412 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42359 (custom)
2019-06-17 14:26:16,413 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 14:26:16,415 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 14:26:16,416 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 14:26:16,417 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 14:26:16,537 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler41733a96-38a7-4ea4-a2b0-c94331fb6989/ratis] (custom)
2019-06-17 14:26:16,548 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 38959
2019-06-17 14:26:16,567 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 14:26:16,567 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 14:26:16,568 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 4e58e891-9367-413c-8641-7983c1624c1e at port 42359
2019-06-17 14:26:16,648 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 4e58e891-9367-413c-8641-7983c1624c1e: start RPC server
2019-06-17 14:26:16,771 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 4e58e891-9367-413c-8641-7983c1624c1e: GrpcService started, listening on 0.0.0.0/0.0.0.0:42359
2019-06-17 14:26:17,084 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 4e58e891-9367-413c-8641-7983c1624c1e: addNew group-C625D56BDF85:[4e58e891-9367-413c-8641-7983c1624c1e:127.0.0.1:42359] returns group-C625D56BDF85:java.util.concurrent.CompletableFuture@11b989c7[Not completed]
2019-06-17 14:26:17,113 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 4e58e891-9367-413c-8641-7983c1624c1e: new RaftServerImpl for group-C625D56BDF85:[4e58e891-9367-413c-8641-7983c1624c1e:127.0.0.1:42359] with ContainerStateMachine:uninitialized
2019-06-17 14:26:17,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 14:26:17,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 14:26:17,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 14:26:17,115 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 14:26:17,119 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 4e58e891-9367-413c-8641-7983c1624c1e:group-C625D56BDF85 ConfigurationManager, init=-1: [4e58e891-9367-413c-8641-7983c1624c1e:127.0.0.1:42359], old=null, confs=<EMPTY_MAP>
2019-06-17 14:26:17,119 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler41733a96-38a7-4ea4-a2b0-c94331fb6989/ratis] (custom)
2019-06-17 14:26:17,126 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler41733a96-38a7-4ea4-a2b0-c94331fb6989/ratis/19b4c36b-8674-4c37-8798-c625d56bdf85 does not exist. Creating ...
2019-06-17 14:26:17,134 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler41733a96-38a7-4ea4-a2b0-c94331fb6989/ratis/19b4c36b-8674-4c37-8798-c625d56bdf85/in_use.lock acquired by nodename 4305@ozone-unit-076618677d3xcbmk-1385799918
2019-06-17 14:26:17,141 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler41733a96-38a7-4ea4-a2b0-c94331fb6989/ratis/19b4c36b-8674-4c37-8798-c625d56bdf85 has been successfully formatted.
2019-06-17 14:26:17,143 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 14:26:17,143 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 14:26:17,145 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 14:26:17,147 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 14:26:17,149 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 14:26:17,152 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 14:26:17,155 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 4e58e891-9367-413c-8641-7983c1624c1e-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler41733a96-38a7-4ea4-a2b0-c94331fb6989/ratis/19b4c36b-8674-4c37-8798-c625d56bdf85
2019-06-17 14:26:17,155 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 14:26:17,156 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 14:26:17,157 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 14:26:17,158 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 14:26:17,158 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 14:26:17,158 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 14:26:17,159 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 14:26:17,159 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 14:26:17,160 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 14:26:17,161 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 14:26:17,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 14:26:17,167 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 14:26:17,167 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 14:26:17,287 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 4e58e891-9367-413c-8641-7983c1624c1e: start group-C625D56BDF85
2019-06-17 14:26:17,288 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4e58e891-9367-413c-8641-7983c1624c1e:group-C625D56BDF85 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 14:26:17,289 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4e58e891-9367-413c-8641-7983c1624c1e: start FollowerState
2019-06-17 14:26:17,290 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C625D56BDF85,id=4e58e891-9367-413c-8641-7983c1624c1e
2019-06-17 14:26:18,455 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4e58e891-9367-413c-8641-7983c1624c1e:group-C625D56BDF85 changes to CANDIDATE, lastRpcTime:1166, electionTimeout:1166ms
2019-06-17 14:26:18,456 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4e58e891-9367-413c-8641-7983c1624c1e: shutdown FollowerState
2019-06-17 14:26:18,456 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4e58e891-9367-413c-8641-7983c1624c1e:group-C625D56BDF85 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 14:26:18,457 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4e58e891-9367-413c-8641-7983c1624c1e: start LeaderElection
2019-06-17 14:26:18,460 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4e58e891-9367-413c-8641-7983c1624c1e:group-C625D56BDF85:LeaderElection1: begin an election at term 1 for -1: [4e58e891-9367-413c-8641-7983c1624c1e:127.0.0.1:42359], old=null
2019-06-17 14:26:18,461 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4e58e891-9367-413c-8641-7983c1624c1e: shutdown LeaderElection
2019-06-17 14:26:18,462 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4e58e891-9367-413c-8641-7983c1624c1e:group-C625D56BDF85 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 14:26:18,462 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 4e58e891-9367-413c-8641-7983c1624c1e:group-C625D56BDF85 change Leader from null to 4e58e891-9367-413c-8641-7983c1624c1e at term 1 for becomeLeader, leader elected after 1319ms
2019-06-17 14:26:18,466 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 14:26:18,466 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 14:26:18,469 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 14:26:18,469 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 14:26:18,479 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4e58e891-9367-413c-8641-7983c1624c1e: start LeaderState
2019-06-17 14:26:18,494 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 4e58e891-9367-413c-8641-7983c1624c1e-RaftLogWorker: Starting segment from index:0
2019-06-17 14:26:18,502 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 4e58e891-9367-413c-8641-7983c1624c1e:group-C625D56BDF85 set configuration 0: [4e58e891-9367-413c-8641-7983c1624c1e:127.0.0.1:42359], old=null at 0
2019-06-17 14:26:18,649 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 4e58e891-9367-413c-8641-7983c1624c1e-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler41733a96-38a7-4ea4-a2b0-c94331fb6989/ratis/19b4c36b-8674-4c37-8798-c625d56bdf85/current/log_inprogress_0
2019-06-17 14:26:19,511 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-17 14:26:19,569 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 2834635102909556205 is closed with bcsId 0.
2019-06-17 14:26:19,569 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 14:26:19,570 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 4e58e891-9367-413c-8641-7983c1624c1e: close
2019-06-17 14:26:19,571 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 4e58e891-9367-413c-8641-7983c1624c1e: shutdown group-C625D56BDF85
2019-06-17 14:26:19,572 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C625D56BDF85,id=4e58e891-9367-413c-8641-7983c1624c1e
2019-06-17 14:26:19,572 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 4e58e891-9367-413c-8641-7983c1624c1e: shutdown LeaderState
2019-06-17 14:26:19,573 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 4e58e891-9367-413c-8641-7983c1624c1e-PendingRequests: sendNotLeaderResponses
2019-06-17 14:26:19,575 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-4e58e891-9367-413c-8641-7983c1624c1e-group-C625D56BDF85: set stopIndex = 4
2019-06-17 14:26:19,575 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 14:26:19,576 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler41733a96-38a7-4ea4-a2b0-c94331fb6989/ratis/19b4c36b-8674-4c37-8798-c625d56bdf85/sm/snapshot.1_4
2019-06-17 14:26:19,583 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 4e58e891-9367-413c-8641-7983c1624c1e:group-C625D56BDF85 closes. The last applied log index is 4
2019-06-17 14:26:19,584 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 4e58e891-9367-413c-8641-7983c1624c1e-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 14:26:19,585 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 4e58e891-9367-413c-8641-7983c1624c1e-RaftLogWorker close()
2019-06-17 14:26:19,586 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 4e58e891-9367-413c-8641-7983c1624c1e: shutdown server with port 42359 now
2019-06-17 14:26:19,589 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 4e58e891-9367-413c-8641-7983c1624c1e: shutdown server with port 42359 successfully
2019-06-17 14:26:19,598 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 14:26:19,627 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfbd99448-fe81-46a0-b66d-0ffe54760557/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 14:26:19,627 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfbd99448-fe81-46a0-b66d-0ffe54760557/hdds to VolumeSet
2019-06-17 14:26:19,627 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3a2b2322
2019-06-17 14:26:19,629 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3a2b2322
2019-06-17 14:26:19,643 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 40633
2019-06-17 14:26:19,644 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 14:26:19,644 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 14:26:19,645 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 40633 (custom)
2019-06-17 14:26:19,645 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 14:26:19,645 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 14:26:19,646 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 14:26:19,646 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 14:26:19,647 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfbd99448-fe81-46a0-b66d-0ffe54760557/ratis] (custom)
2019-06-17 14:26:19,647 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 33521
2019-06-17 14:26:19,648 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 14:26:19,648 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 14:26:19,648 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 452d2541-dd3f-4c17-9de1-1a74f7845434 at port 40633
2019-06-17 14:26:19,673 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 452d2541-dd3f-4c17-9de1-1a74f7845434: start RPC server
2019-06-17 14:26:19,675 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 452d2541-dd3f-4c17-9de1-1a74f7845434: GrpcService started, listening on 0.0.0.0/0.0.0.0:40633
2019-06-17 14:26:19,689 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 452d2541-dd3f-4c17-9de1-1a74f7845434: addNew group-1EFCE6271FDD:[452d2541-dd3f-4c17-9de1-1a74f7845434:127.0.0.1:40633] returns group-1EFCE6271FDD:java.util.concurrent.CompletableFuture@217d2cea[Not completed]
2019-06-17 14:26:19,691 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 452d2541-dd3f-4c17-9de1-1a74f7845434: new RaftServerImpl for group-1EFCE6271FDD:[452d2541-dd3f-4c17-9de1-1a74f7845434:127.0.0.1:40633] with ContainerStateMachine:uninitialized
2019-06-17 14:26:19,691 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 14:26:19,691 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 14:26:19,691 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 14:26:19,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 14:26:19,692 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 452d2541-dd3f-4c17-9de1-1a74f7845434:group-1EFCE6271FDD ConfigurationManager, init=-1: [452d2541-dd3f-4c17-9de1-1a74f7845434:127.0.0.1:40633], old=null, confs=<EMPTY_MAP>
2019-06-17 14:26:19,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfbd99448-fe81-46a0-b66d-0ffe54760557/ratis] (custom)
2019-06-17 14:26:19,692 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfbd99448-fe81-46a0-b66d-0ffe54760557/ratis/7db4f629-bfc8-405d-8046-1efce6271fdd does not exist. Creating ...
2019-06-17 14:26:19,695 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfbd99448-fe81-46a0-b66d-0ffe54760557/ratis/7db4f629-bfc8-405d-8046-1efce6271fdd/in_use.lock acquired by nodename 4305@ozone-unit-076618677d3xcbmk-1385799918
2019-06-17 14:26:19,698 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfbd99448-fe81-46a0-b66d-0ffe54760557/ratis/7db4f629-bfc8-405d-8046-1efce6271fdd has been successfully formatted.
2019-06-17 14:26:19,698 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 14:26:19,698 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 14:26:19,698 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 14:26:19,699 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 14:26:19,701 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 14:26:19,701 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 14:26:19,702 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 452d2541-dd3f-4c17-9de1-1a74f7845434-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfbd99448-fe81-46a0-b66d-0ffe54760557/ratis/7db4f629-bfc8-405d-8046-1efce6271fdd
2019-06-17 14:26:19,702 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 14:26:19,702 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 14:26:19,702 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 14:26:19,702 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 14:26:19,703 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 14:26:19,703 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 14:26:19,703 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 14:26:19,703 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 14:26:19,703 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 14:26:19,703 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 14:26:19,705 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 14:26:19,705 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 14:26:19,705 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 14:26:19,705 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 452d2541-dd3f-4c17-9de1-1a74f7845434: start group-1EFCE6271FDD
2019-06-17 14:26:19,705 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 452d2541-dd3f-4c17-9de1-1a74f7845434:group-1EFCE6271FDD changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 14:26:19,706 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 452d2541-dd3f-4c17-9de1-1a74f7845434: start FollowerState
2019-06-17 14:26:19,709 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-1EFCE6271FDD,id=452d2541-dd3f-4c17-9de1-1a74f7845434
2019-06-17 14:26:20,897 INFO  impl.FollowerState (FollowerState.java:run(101)) - 452d2541-dd3f-4c17-9de1-1a74f7845434:group-1EFCE6271FDD changes to CANDIDATE, lastRpcTime:1191, electionTimeout:1188ms
2019-06-17 14:26:20,898 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 452d2541-dd3f-4c17-9de1-1a74f7845434: shutdown FollowerState
2019-06-17 14:26:20,898 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 452d2541-dd3f-4c17-9de1-1a74f7845434:group-1EFCE6271FDD changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 14:26:20,898 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 452d2541-dd3f-4c17-9de1-1a74f7845434: start LeaderElection
2019-06-17 14:26:20,902 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 452d2541-dd3f-4c17-9de1-1a74f7845434:group-1EFCE6271FDD:LeaderElection2: begin an election at term 1 for -1: [452d2541-dd3f-4c17-9de1-1a74f7845434:127.0.0.1:40633], old=null
2019-06-17 14:26:20,903 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 452d2541-dd3f-4c17-9de1-1a74f7845434: shutdown LeaderElection
2019-06-17 14:26:20,903 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 452d2541-dd3f-4c17-9de1-1a74f7845434:group-1EFCE6271FDD changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 14:26:20,903 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 452d2541-dd3f-4c17-9de1-1a74f7845434:group-1EFCE6271FDD change Leader from null to 452d2541-dd3f-4c17-9de1-1a74f7845434 at term 1 for becomeLeader, leader elected after 1205ms
2019-06-17 14:26:20,904 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 14:26:20,904 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 14:26:20,904 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 14:26:20,905 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 14:26:20,905 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 452d2541-dd3f-4c17-9de1-1a74f7845434: start LeaderState
2019-06-17 14:26:20,905 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 452d2541-dd3f-4c17-9de1-1a74f7845434-RaftLogWorker: Starting segment from index:0
2019-06-17 14:26:20,906 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 452d2541-dd3f-4c17-9de1-1a74f7845434:group-1EFCE6271FDD set configuration 0: [452d2541-dd3f-4c17-9de1-1a74f7845434:127.0.0.1:40633], old=null at 0
2019-06-17 14:26:20,953 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 452d2541-dd3f-4c17-9de1-1a74f7845434-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfbd99448-fe81-46a0-b66d-0ffe54760557/ratis/7db4f629-bfc8-405d-8046-1efce6271fdd/current/log_inprogress_0
2019-06-17 14:26:21,741 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 14:26:21,742 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 452d2541-dd3f-4c17-9de1-1a74f7845434: close
2019-06-17 14:26:21,742 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 452d2541-dd3f-4c17-9de1-1a74f7845434: shutdown group-1EFCE6271FDD
2019-06-17 14:26:21,743 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-1EFCE6271FDD,id=452d2541-dd3f-4c17-9de1-1a74f7845434
2019-06-17 14:26:21,743 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 452d2541-dd3f-4c17-9de1-1a74f7845434: shutdown LeaderState
2019-06-17 14:26:21,743 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 452d2541-dd3f-4c17-9de1-1a74f7845434-PendingRequests: sendNotLeaderResponses
2019-06-17 14:26:21,745 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 14:26:21,745 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfbd99448-fe81-46a0-b66d-0ffe54760557/ratis/7db4f629-bfc8-405d-8046-1efce6271fdd/sm/snapshot.1_2
2019-06-17 14:26:21,745 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-452d2541-dd3f-4c17-9de1-1a74f7845434-group-1EFCE6271FDD: set stopIndex = 2
2019-06-17 14:26:21,745 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 452d2541-dd3f-4c17-9de1-1a74f7845434:group-1EFCE6271FDD closes. The last applied log index is 2
2019-06-17 14:26:21,749 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 452d2541-dd3f-4c17-9de1-1a74f7845434-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 14:26:21,750 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 452d2541-dd3f-4c17-9de1-1a74f7845434-RaftLogWorker close()
2019-06-17 14:26:21,752 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 452d2541-dd3f-4c17-9de1-1a74f7845434: shutdown server with port 40633 now
2019-06-17 14:26:21,754 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 452d2541-dd3f-4c17-9de1-1a74f7845434: shutdown server with port 40633 successfully
2019-06-17 14:26:21,756 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 14:26:21,797 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0ffb788a-7356-490d-a33d-c0ddfa0c8f32/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 14:26:21,798 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0ffb788a-7356-490d-a33d-c0ddfa0c8f32/hdds to VolumeSet
2019-06-17 14:26:21,798 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@26a2f7f9
2019-06-17 14:26:21,798 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@26a2f7f9
2019-06-17 14:26:21,809 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 33203
2019-06-17 14:26:21,810 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 14:26:21,810 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 14:26:21,811 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 33203 (custom)
2019-06-17 14:26:21,811 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 14:26:21,811 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 14:26:21,811 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 14:26:21,812 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 14:26:21,812 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0ffb788a-7356-490d-a33d-c0ddfa0c8f32/ratis] (custom)
2019-06-17 14:26:21,813 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 45193
2019-06-17 14:26:21,813 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 14:26:21,813 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 14:26:21,813 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa at port 33203
2019-06-17 14:26:21,819 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa: start RPC server
2019-06-17 14:26:21,821 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa: GrpcService started, listening on 0.0.0.0/0.0.0.0:33203
2019-06-17 14:26:21,831 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa: addNew group-19F2E5DFB1BC:[4801b2a6-1d74-4f64-b04f-d983d3a1fbfa:127.0.0.1:33203] returns group-19F2E5DFB1BC:java.util.concurrent.CompletableFuture@30c06bf3[Not completed]
2019-06-17 14:26:21,831 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa: new RaftServerImpl for group-19F2E5DFB1BC:[4801b2a6-1d74-4f64-b04f-d983d3a1fbfa:127.0.0.1:33203] with ContainerStateMachine:uninitialized
2019-06-17 14:26:21,832 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 14:26:21,832 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 14:26:21,832 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 14:26:21,832 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 14:26:21,832 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa:group-19F2E5DFB1BC ConfigurationManager, init=-1: [4801b2a6-1d74-4f64-b04f-d983d3a1fbfa:127.0.0.1:33203], old=null, confs=<EMPTY_MAP>
2019-06-17 14:26:21,833 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0ffb788a-7356-490d-a33d-c0ddfa0c8f32/ratis] (custom)
2019-06-17 14:26:21,833 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0ffb788a-7356-490d-a33d-c0ddfa0c8f32/ratis/e3187842-fc09-4ede-9170-19f2e5dfb1bc does not exist. Creating ...
2019-06-17 14:26:21,836 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0ffb788a-7356-490d-a33d-c0ddfa0c8f32/ratis/e3187842-fc09-4ede-9170-19f2e5dfb1bc/in_use.lock acquired by nodename 4305@ozone-unit-076618677d3xcbmk-1385799918
2019-06-17 14:26:21,838 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0ffb788a-7356-490d-a33d-c0ddfa0c8f32/ratis/e3187842-fc09-4ede-9170-19f2e5dfb1bc has been successfully formatted.
2019-06-17 14:26:21,838 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 14:26:21,838 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 14:26:21,838 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 14:26:21,838 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 14:26:21,839 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 14:26:21,839 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 14:26:21,839 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0ffb788a-7356-490d-a33d-c0ddfa0c8f32/ratis/e3187842-fc09-4ede-9170-19f2e5dfb1bc
2019-06-17 14:26:21,839 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 14:26:21,839 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 14:26:21,839 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 14:26:21,839 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 14:26:21,839 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 14:26:21,839 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 14:26:21,840 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 14:26:21,840 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 14:26:21,840 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 14:26:21,840 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 14:26:21,840 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 14:26:21,841 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 14:26:21,841 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 14:26:21,841 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa: start group-19F2E5DFB1BC
2019-06-17 14:26:21,841 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa:group-19F2E5DFB1BC changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 14:26:21,841 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa: start FollowerState
2019-06-17 14:26:21,841 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-19F2E5DFB1BC,id=4801b2a6-1d74-4f64-b04f-d983d3a1fbfa
2019-06-17 14:26:22,995 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa:group-19F2E5DFB1BC changes to CANDIDATE, lastRpcTime:1154, electionTimeout:1154ms
2019-06-17 14:26:22,996 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa: shutdown FollowerState
2019-06-17 14:26:22,996 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa:group-19F2E5DFB1BC changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 14:26:22,996 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa: start LeaderElection
2019-06-17 14:26:22,999 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa:group-19F2E5DFB1BC:LeaderElection3: begin an election at term 1 for -1: [4801b2a6-1d74-4f64-b04f-d983d3a1fbfa:127.0.0.1:33203], old=null
2019-06-17 14:26:22,999 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa: shutdown LeaderElection
2019-06-17 14:26:22,999 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa:group-19F2E5DFB1BC changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 14:26:22,999 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa:group-19F2E5DFB1BC change Leader from null to 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa at term 1 for becomeLeader, leader elected after 1161ms
2019-06-17 14:26:22,999 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 14:26:23,000 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 14:26:23,000 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 14:26:23,000 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 14:26:23,000 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa: start LeaderState
2019-06-17 14:26:23,001 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa-RaftLogWorker: Starting segment from index:0
2019-06-17 14:26:23,007 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa:group-19F2E5DFB1BC set configuration 0: [4801b2a6-1d74-4f64-b04f-d983d3a1fbfa:127.0.0.1:33203], old=null at 0
2019-06-17 14:26:23,036 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0ffb788a-7356-490d-a33d-c0ddfa0c8f32/ratis/e3187842-fc09-4ede-9170-19f2e5dfb1bc/current/log_inprogress_0
2019-06-17 14:26:23,884 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 8862769605948874143 is closed with bcsId 0.
2019-06-17 14:26:23,885 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 14:26:23,885 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa: close
2019-06-17 14:26:23,886 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa: shutdown group-19F2E5DFB1BC
2019-06-17 14:26:23,886 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-19F2E5DFB1BC,id=4801b2a6-1d74-4f64-b04f-d983d3a1fbfa
2019-06-17 14:26:23,886 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa: shutdown LeaderState
2019-06-17 14:26:23,886 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa-PendingRequests: sendNotLeaderResponses
2019-06-17 14:26:23,887 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-4801b2a6-1d74-4f64-b04f-d983d3a1fbfa-group-19F2E5DFB1BC: set stopIndex = 2
2019-06-17 14:26:23,887 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 14:26:23,888 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler0ffb788a-7356-490d-a33d-c0ddfa0c8f32/ratis/e3187842-fc09-4ede-9170-19f2e5dfb1bc/sm/snapshot.1_2
2019-06-17 14:26:23,888 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa:group-19F2E5DFB1BC closes. The last applied log index is 2
2019-06-17 14:26:23,889 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 14:26:23,894 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa-RaftLogWorker close()
2019-06-17 14:26:23,895 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa: shutdown server with port 33203 now
2019-06-17 14:26:23,897 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 4801b2a6-1d74-4f64-b04f-d983d3a1fbfa: shutdown server with port 33203 successfully
2019-06-17 14:26:23,905 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 14:26:23,950 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf179237c-3e37-4c6d-80f4-f05a61fd62e1/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 14:26:23,950 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf179237c-3e37-4c6d-80f4-f05a61fd62e1/hdds to VolumeSet
2019-06-17 14:26:23,951 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@66153688
2019-06-17 14:26:23,953 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@66153688
2019-06-17 14:26:23,962 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 46297
2019-06-17 14:26:23,963 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 14:26:23,964 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 14:26:23,964 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 46297 (custom)
2019-06-17 14:26:23,964 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 14:26:23,965 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 14:26:23,965 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 14:26:23,965 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 14:26:23,966 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf179237c-3e37-4c6d-80f4-f05a61fd62e1/ratis] (custom)
2019-06-17 14:26:23,966 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 36217
2019-06-17 14:26:23,966 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 14:26:23,967 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 14:26:23,967 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 48842ae2-685f-40f6-a48a-e3ee8ff135a8 at port 46297
2019-06-17 14:26:23,998 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8: start RPC server
2019-06-17 14:26:24,000 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8: GrpcService started, listening on 0.0.0.0/0.0.0.0:46297
Jun 17, 2019 2:26:24 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:40633} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 17, 2019 2:26:24 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:33203} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-17 14:26:24,020 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8: addNew group-089E3C99D521:[48842ae2-685f-40f6-a48a-e3ee8ff135a8:127.0.0.1:46297] returns group-089E3C99D521:java.util.concurrent.CompletableFuture@53c8b5c6[Not completed]
2019-06-17 14:26:24,021 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8: new RaftServerImpl for group-089E3C99D521:[48842ae2-685f-40f6-a48a-e3ee8ff135a8:127.0.0.1:46297] with ContainerStateMachine:uninitialized
2019-06-17 14:26:24,022 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 14:26:24,022 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 14:26:24,022 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 14:26:24,022 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 14:26:24,022 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8:group-089E3C99D521 ConfigurationManager, init=-1: [48842ae2-685f-40f6-a48a-e3ee8ff135a8:127.0.0.1:46297], old=null, confs=<EMPTY_MAP>
2019-06-17 14:26:24,022 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf179237c-3e37-4c6d-80f4-f05a61fd62e1/ratis] (custom)
2019-06-17 14:26:24,023 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf179237c-3e37-4c6d-80f4-f05a61fd62e1/ratis/cb2c534f-9e38-448c-8c5f-089e3c99d521 does not exist. Creating ...
2019-06-17 14:26:24,025 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf179237c-3e37-4c6d-80f4-f05a61fd62e1/ratis/cb2c534f-9e38-448c-8c5f-089e3c99d521/in_use.lock acquired by nodename 4305@ozone-unit-076618677d3xcbmk-1385799918
2019-06-17 14:26:24,027 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf179237c-3e37-4c6d-80f4-f05a61fd62e1/ratis/cb2c534f-9e38-448c-8c5f-089e3c99d521 has been successfully formatted.
2019-06-17 14:26:24,028 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 14:26:24,028 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 14:26:24,028 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 14:26:24,028 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 14:26:24,028 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 14:26:24,028 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 14:26:24,028 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 48842ae2-685f-40f6-a48a-e3ee8ff135a8-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf179237c-3e37-4c6d-80f4-f05a61fd62e1/ratis/cb2c534f-9e38-448c-8c5f-089e3c99d521
2019-06-17 14:26:24,029 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 14:26:24,029 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 14:26:24,029 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 14:26:24,029 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 14:26:24,029 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 14:26:24,029 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 14:26:24,029 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 14:26:24,029 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 14:26:24,029 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 14:26:24,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 14:26:24,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 14:26:24,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 14:26:24,030 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 14:26:24,030 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8: start group-089E3C99D521
2019-06-17 14:26:24,031 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8:group-089E3C99D521 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 14:26:24,031 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8: start FollowerState
2019-06-17 14:26:24,031 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-089E3C99D521,id=48842ae2-685f-40f6-a48a-e3ee8ff135a8
2019-06-17 14:26:25,204 INFO  impl.FollowerState (FollowerState.java:run(101)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8:group-089E3C99D521 changes to CANDIDATE, lastRpcTime:1173, electionTimeout:1173ms
2019-06-17 14:26:25,204 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8: shutdown FollowerState
2019-06-17 14:26:25,204 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8:group-089E3C99D521 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 14:26:25,204 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8: start LeaderElection
2019-06-17 14:26:25,207 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8:group-089E3C99D521:LeaderElection4: begin an election at term 1 for -1: [48842ae2-685f-40f6-a48a-e3ee8ff135a8:127.0.0.1:46297], old=null
2019-06-17 14:26:25,208 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8: shutdown LeaderElection
2019-06-17 14:26:25,208 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8:group-089E3C99D521 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 14:26:25,208 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8:group-089E3C99D521 change Leader from null to 48842ae2-685f-40f6-a48a-e3ee8ff135a8 at term 1 for becomeLeader, leader elected after 1179ms
2019-06-17 14:26:25,208 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 14:26:25,208 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 14:26:25,208 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 14:26:25,208 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 14:26:25,208 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8: start LeaderState
2019-06-17 14:26:25,209 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8-RaftLogWorker: Starting segment from index:0
2019-06-17 14:26:25,209 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8:group-089E3C99D521 set configuration 0: [48842ae2-685f-40f6-a48a-e3ee8ff135a8:127.0.0.1:46297], old=null at 0
2019-06-17 14:26:25,244 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf179237c-3e37-4c6d-80f4-f05a61fd62e1/ratis/cb2c534f-9e38-448c-8c5f-089e3c99d521/current/log_inprogress_0
2019-06-17 14:26:26,077 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 2784171255506941903 is closed with bcsId 0.
2019-06-17 14:26:26,077 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 14:26:26,078 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8: close
2019-06-17 14:26:26,078 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8: shutdown group-089E3C99D521
2019-06-17 14:26:26,079 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-089E3C99D521,id=48842ae2-685f-40f6-a48a-e3ee8ff135a8
2019-06-17 14:26:26,079 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8: shutdown LeaderState
2019-06-17 14:26:26,080 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8-PendingRequests: sendNotLeaderResponses
2019-06-17 14:26:26,083 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-48842ae2-685f-40f6-a48a-e3ee8ff135a8-group-089E3C99D521: set stopIndex = 2
2019-06-17 14:26:26,084 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 14:26:26,084 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf179237c-3e37-4c6d-80f4-f05a61fd62e1/ratis/cb2c534f-9e38-448c-8c5f-089e3c99d521/sm/snapshot.1_2
2019-06-17 14:26:26,084 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8:group-089E3C99D521 closes. The last applied log index is 2
2019-06-17 14:26:26,085 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 14:26:26,086 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8-RaftLogWorker close()
2019-06-17 14:26:26,088 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8: shutdown server with port 46297 now
2019-06-17 14:26:26,089 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 48842ae2-685f-40f6-a48a-e3ee8ff135a8: shutdown server with port 46297 successfully
2019-06-17 14:26:26,096 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 14:26:26,125 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc8a4fd95-47d6-4551-a843-3b620057d37c/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 14:26:26,125 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc8a4fd95-47d6-4551-a843-3b620057d37c/hdds to VolumeSet
2019-06-17 14:26:26,126 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@68217d41
2019-06-17 14:26:26,126 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@68217d41
2019-06-17 14:26:26,147 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 33297
2019-06-17 14:26:26,147 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 14:26:26,148 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 14:26:26,148 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 33297 (custom)
2019-06-17 14:26:26,148 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 14:26:26,149 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 14:26:26,149 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 14:26:26,149 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 14:26:26,150 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc8a4fd95-47d6-4551-a843-3b620057d37c/ratis] (custom)
2019-06-17 14:26:26,150 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42339
2019-06-17 14:26:26,150 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 14:26:26,151 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 14:26:26,151 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 5c88cada-4c59-46a4-b672-fd0982ad754e at port 33297
2019-06-17 14:26:26,192 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 5c88cada-4c59-46a4-b672-fd0982ad754e: start RPC server
2019-06-17 14:26:26,200 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 5c88cada-4c59-46a4-b672-fd0982ad754e: GrpcService started, listening on 0.0.0.0/0.0.0.0:33297
2019-06-17 14:26:26,223 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 5c88cada-4c59-46a4-b672-fd0982ad754e: addNew group-D940112D80B1:[5c88cada-4c59-46a4-b672-fd0982ad754e:127.0.0.1:33297] returns group-D940112D80B1:java.util.concurrent.CompletableFuture@5d2255f8[Not completed]
2019-06-17 14:26:26,225 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 5c88cada-4c59-46a4-b672-fd0982ad754e: new RaftServerImpl for group-D940112D80B1:[5c88cada-4c59-46a4-b672-fd0982ad754e:127.0.0.1:33297] with ContainerStateMachine:uninitialized
2019-06-17 14:26:26,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 14:26:26,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 14:26:26,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 14:26:26,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 14:26:26,227 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 5c88cada-4c59-46a4-b672-fd0982ad754e:group-D940112D80B1 ConfigurationManager, init=-1: [5c88cada-4c59-46a4-b672-fd0982ad754e:127.0.0.1:33297], old=null, confs=<EMPTY_MAP>
2019-06-17 14:26:26,228 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc8a4fd95-47d6-4551-a843-3b620057d37c/ratis] (custom)
2019-06-17 14:26:26,228 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc8a4fd95-47d6-4551-a843-3b620057d37c/ratis/4c7fe810-afed-426c-9002-d940112d80b1 does not exist. Creating ...
2019-06-17 14:26:26,231 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc8a4fd95-47d6-4551-a843-3b620057d37c/ratis/4c7fe810-afed-426c-9002-d940112d80b1/in_use.lock acquired by nodename 4305@ozone-unit-076618677d3xcbmk-1385799918
2019-06-17 14:26:26,233 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc8a4fd95-47d6-4551-a843-3b620057d37c/ratis/4c7fe810-afed-426c-9002-d940112d80b1 has been successfully formatted.
2019-06-17 14:26:26,234 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 14:26:26,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 14:26:26,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 14:26:26,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 14:26:26,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 14:26:26,234 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 14:26:26,235 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 5c88cada-4c59-46a4-b672-fd0982ad754e-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc8a4fd95-47d6-4551-a843-3b620057d37c/ratis/4c7fe810-afed-426c-9002-d940112d80b1
2019-06-17 14:26:26,235 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 14:26:26,235 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 14:26:26,235 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 14:26:26,235 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 14:26:26,235 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 14:26:26,236 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 14:26:26,236 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 14:26:26,236 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 14:26:26,236 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 14:26:26,236 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 14:26:26,237 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 14:26:26,237 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 14:26:26,237 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 14:26:26,238 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 5c88cada-4c59-46a4-b672-fd0982ad754e: start group-D940112D80B1
2019-06-17 14:26:26,238 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5c88cada-4c59-46a4-b672-fd0982ad754e:group-D940112D80B1 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 14:26:26,238 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5c88cada-4c59-46a4-b672-fd0982ad754e: start FollowerState
2019-06-17 14:26:26,238 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D940112D80B1,id=5c88cada-4c59-46a4-b672-fd0982ad754e
2019-06-17 14:26:27,343 INFO  impl.FollowerState (FollowerState.java:run(101)) - 5c88cada-4c59-46a4-b672-fd0982ad754e:group-D940112D80B1 changes to CANDIDATE, lastRpcTime:1105, electionTimeout:1105ms
2019-06-17 14:26:27,344 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 5c88cada-4c59-46a4-b672-fd0982ad754e: shutdown FollowerState
2019-06-17 14:26:27,344 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5c88cada-4c59-46a4-b672-fd0982ad754e:group-D940112D80B1 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 14:26:27,344 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5c88cada-4c59-46a4-b672-fd0982ad754e: start LeaderElection
2019-06-17 14:26:27,348 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 5c88cada-4c59-46a4-b672-fd0982ad754e:group-D940112D80B1:LeaderElection5: begin an election at term 1 for -1: [5c88cada-4c59-46a4-b672-fd0982ad754e:127.0.0.1:33297], old=null
2019-06-17 14:26:27,349 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 5c88cada-4c59-46a4-b672-fd0982ad754e: shutdown LeaderElection
2019-06-17 14:26:27,349 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5c88cada-4c59-46a4-b672-fd0982ad754e:group-D940112D80B1 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 14:26:27,349 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 5c88cada-4c59-46a4-b672-fd0982ad754e:group-D940112D80B1 change Leader from null to 5c88cada-4c59-46a4-b672-fd0982ad754e at term 1 for becomeLeader, leader elected after 1115ms
2019-06-17 14:26:27,349 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 14:26:27,349 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 14:26:27,349 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 14:26:27,349 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 14:26:27,350 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5c88cada-4c59-46a4-b672-fd0982ad754e: start LeaderState
2019-06-17 14:26:27,350 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 5c88cada-4c59-46a4-b672-fd0982ad754e-RaftLogWorker: Starting segment from index:0
2019-06-17 14:26:27,350 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 5c88cada-4c59-46a4-b672-fd0982ad754e:group-D940112D80B1 set configuration 0: [5c88cada-4c59-46a4-b672-fd0982ad754e:127.0.0.1:33297], old=null at 0
2019-06-17 14:26:27,392 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 5c88cada-4c59-46a4-b672-fd0982ad754e-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc8a4fd95-47d6-4551-a843-3b620057d37c/ratis/4c7fe810-afed-426c-9002-d940112d80b1/current/log_inprogress_0
2019-06-17 14:26:28,279 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 588882921148237078 is closed with bcsId 0.
2019-06-17 14:26:28,279 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 14:26:28,280 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 5c88cada-4c59-46a4-b672-fd0982ad754e: close
2019-06-17 14:26:28,280 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 5c88cada-4c59-46a4-b672-fd0982ad754e: shutdown group-D940112D80B1
2019-06-17 14:26:28,280 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D940112D80B1,id=5c88cada-4c59-46a4-b672-fd0982ad754e
2019-06-17 14:26:28,280 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 5c88cada-4c59-46a4-b672-fd0982ad754e: shutdown LeaderState
2019-06-17 14:26:28,281 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 5c88cada-4c59-46a4-b672-fd0982ad754e-PendingRequests: sendNotLeaderResponses
2019-06-17 14:26:28,282 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-5c88cada-4c59-46a4-b672-fd0982ad754e-group-D940112D80B1: set stopIndex = 4
2019-06-17 14:26:28,282 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 14:26:28,282 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc8a4fd95-47d6-4551-a843-3b620057d37c/ratis/4c7fe810-afed-426c-9002-d940112d80b1/sm/snapshot.1_4
2019-06-17 14:26:28,282 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 5c88cada-4c59-46a4-b672-fd0982ad754e:group-D940112D80B1 closes. The last applied log index is 4
2019-06-17 14:26:28,283 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 5c88cada-4c59-46a4-b672-fd0982ad754e-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 14:26:28,284 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 5c88cada-4c59-46a4-b672-fd0982ad754e-RaftLogWorker close()
2019-06-17 14:26:28,284 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 5c88cada-4c59-46a4-b672-fd0982ad754e: shutdown server with port 33297 now
2019-06-17 14:26:28,286 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 5c88cada-4c59-46a4-b672-fd0982ad754e: shutdown server with port 33297 successfully
2019-06-17 14:26:28,293 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
