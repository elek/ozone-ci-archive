2019-06-18 08:35:06,554 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4b5500bc-7bf6-49ed-a85b-530bdd03f54c/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 08:35:06,559 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4b5500bc-7bf6-49ed-a85b-530bdd03f54c/hdds to VolumeSet
2019-06-18 08:35:06,590 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-18 08:35:06,624 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-18 08:35:06,979 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 37311
2019-06-18 08:35:07,520 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 08:35:07,545 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 08:35:07,556 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 37311 (custom)
2019-06-18 08:35:07,557 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 08:35:07,559 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 08:35:07,560 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 08:35:07,561 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 08:35:07,734 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4b5500bc-7bf6-49ed-a85b-530bdd03f54c/ratis] (custom)
2019-06-18 08:35:07,745 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 34499
2019-06-18 08:35:07,768 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 08:35:07,768 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 08:35:07,770 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis fe4ec505-2881-43b8-9327-67b3652122b6 at port 37311
2019-06-18 08:35:07,786 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - fe4ec505-2881-43b8-9327-67b3652122b6: start RPC server
2019-06-18 08:35:07,946 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - fe4ec505-2881-43b8-9327-67b3652122b6: GrpcService started, listening on 0.0.0.0/0.0.0.0:37311
2019-06-18 08:35:08,303 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - fe4ec505-2881-43b8-9327-67b3652122b6: addNew group-89CC9580EFB6:[fe4ec505-2881-43b8-9327-67b3652122b6:127.0.0.1:37311] returns group-89CC9580EFB6:java.util.concurrent.CompletableFuture@11b989c7[Not completed]
2019-06-18 08:35:08,339 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - fe4ec505-2881-43b8-9327-67b3652122b6: new RaftServerImpl for group-89CC9580EFB6:[fe4ec505-2881-43b8-9327-67b3652122b6:127.0.0.1:37311] with ContainerStateMachine:uninitialized
2019-06-18 08:35:08,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 08:35:08,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 08:35:08,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 08:35:08,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 08:35:08,348 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - fe4ec505-2881-43b8-9327-67b3652122b6:group-89CC9580EFB6 ConfigurationManager, init=-1: [fe4ec505-2881-43b8-9327-67b3652122b6:127.0.0.1:37311], old=null, confs=<EMPTY_MAP>
2019-06-18 08:35:08,349 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4b5500bc-7bf6-49ed-a85b-530bdd03f54c/ratis] (custom)
2019-06-18 08:35:08,356 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4b5500bc-7bf6-49ed-a85b-530bdd03f54c/ratis/1730a713-19f5-43b5-91f1-89cc9580efb6 does not exist. Creating ...
2019-06-18 08:35:08,366 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4b5500bc-7bf6-49ed-a85b-530bdd03f54c/ratis/1730a713-19f5-43b5-91f1-89cc9580efb6/in_use.lock acquired by nodename 4306@ozone-unit-076618677d3jt6tr-3854142395
2019-06-18 08:35:08,375 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4b5500bc-7bf6-49ed-a85b-530bdd03f54c/ratis/1730a713-19f5-43b5-91f1-89cc9580efb6 has been successfully formatted.
2019-06-18 08:35:08,377 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 08:35:08,377 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 08:35:08,379 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 08:35:08,381 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 08:35:08,385 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 08:35:08,389 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 08:35:08,392 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new fe4ec505-2881-43b8-9327-67b3652122b6-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4b5500bc-7bf6-49ed-a85b-530bdd03f54c/ratis/1730a713-19f5-43b5-91f1-89cc9580efb6
2019-06-18 08:35:08,392 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 08:35:08,393 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 08:35:08,395 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 08:35:08,395 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 08:35:08,396 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 08:35:08,396 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 08:35:08,397 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 08:35:08,397 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 08:35:08,398 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 08:35:08,400 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 08:35:08,405 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 08:35:08,406 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 08:35:08,407 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 08:35:08,529 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - fe4ec505-2881-43b8-9327-67b3652122b6: start group-89CC9580EFB6
2019-06-18 08:35:08,530 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fe4ec505-2881-43b8-9327-67b3652122b6:group-89CC9580EFB6 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 08:35:08,531 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fe4ec505-2881-43b8-9327-67b3652122b6: start FollowerState
2019-06-18 08:35:08,533 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-89CC9580EFB6,id=fe4ec505-2881-43b8-9327-67b3652122b6
2019-06-18 08:35:09,551 INFO  impl.FollowerState (FollowerState.java:run(101)) - fe4ec505-2881-43b8-9327-67b3652122b6:group-89CC9580EFB6 changes to CANDIDATE, lastRpcTime:1020, electionTimeout:1020ms
2019-06-18 08:35:09,552 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - fe4ec505-2881-43b8-9327-67b3652122b6: shutdown FollowerState
2019-06-18 08:35:09,552 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fe4ec505-2881-43b8-9327-67b3652122b6:group-89CC9580EFB6 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 08:35:09,553 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fe4ec505-2881-43b8-9327-67b3652122b6: start LeaderElection
2019-06-18 08:35:09,558 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - fe4ec505-2881-43b8-9327-67b3652122b6:group-89CC9580EFB6:LeaderElection1: begin an election at term 1 for -1: [fe4ec505-2881-43b8-9327-67b3652122b6:127.0.0.1:37311], old=null
2019-06-18 08:35:09,559 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - fe4ec505-2881-43b8-9327-67b3652122b6: shutdown LeaderElection
2019-06-18 08:35:09,560 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fe4ec505-2881-43b8-9327-67b3652122b6:group-89CC9580EFB6 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 08:35:09,560 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - fe4ec505-2881-43b8-9327-67b3652122b6:group-89CC9580EFB6 change Leader from null to fe4ec505-2881-43b8-9327-67b3652122b6 at term 1 for becomeLeader, leader elected after 1182ms
2019-06-18 08:35:09,564 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 08:35:09,564 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 08:35:09,566 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 08:35:09,566 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 08:35:09,576 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fe4ec505-2881-43b8-9327-67b3652122b6: start LeaderState
2019-06-18 08:35:09,588 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - fe4ec505-2881-43b8-9327-67b3652122b6-RaftLogWorker: Starting segment from index:0
2019-06-18 08:35:09,595 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - fe4ec505-2881-43b8-9327-67b3652122b6:group-89CC9580EFB6 set configuration 0: [fe4ec505-2881-43b8-9327-67b3652122b6:127.0.0.1:37311], old=null at 0
2019-06-18 08:35:09,727 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - fe4ec505-2881-43b8-9327-67b3652122b6-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4b5500bc-7bf6-49ed-a85b-530bdd03f54c/ratis/1730a713-19f5-43b5-91f1-89cc9580efb6/current/log_inprogress_0
2019-06-18 08:35:10,760 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-18 08:35:10,823 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 778225301554018676 is closed with bcsId 0.
2019-06-18 08:35:10,824 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 08:35:10,825 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - fe4ec505-2881-43b8-9327-67b3652122b6: close
2019-06-18 08:35:10,826 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - fe4ec505-2881-43b8-9327-67b3652122b6: shutdown group-89CC9580EFB6
2019-06-18 08:35:10,826 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-89CC9580EFB6,id=fe4ec505-2881-43b8-9327-67b3652122b6
2019-06-18 08:35:10,827 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - fe4ec505-2881-43b8-9327-67b3652122b6: shutdown LeaderState
2019-06-18 08:35:10,827 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - fe4ec505-2881-43b8-9327-67b3652122b6-PendingRequests: sendNotLeaderResponses
2019-06-18 08:35:10,829 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-fe4ec505-2881-43b8-9327-67b3652122b6-group-89CC9580EFB6: set stopIndex = 4
2019-06-18 08:35:10,829 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-18 08:35:10,830 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4b5500bc-7bf6-49ed-a85b-530bdd03f54c/ratis/1730a713-19f5-43b5-91f1-89cc9580efb6/sm/snapshot.1_4
2019-06-18 08:35:10,836 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - fe4ec505-2881-43b8-9327-67b3652122b6:group-89CC9580EFB6 closes. The last applied log index is 4
2019-06-18 08:35:10,837 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - fe4ec505-2881-43b8-9327-67b3652122b6-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 08:35:10,838 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - fe4ec505-2881-43b8-9327-67b3652122b6-RaftLogWorker close()
2019-06-18 08:35:10,839 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - fe4ec505-2881-43b8-9327-67b3652122b6: shutdown server with port 37311 now
2019-06-18 08:35:10,842 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - fe4ec505-2881-43b8-9327-67b3652122b6: shutdown server with port 37311 successfully
2019-06-18 08:35:10,850 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-18 08:35:10,875 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler542ad0f2-586c-4cca-ab33-e57edbcbd685/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 08:35:10,875 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler542ad0f2-586c-4cca-ab33-e57edbcbd685/hdds to VolumeSet
2019-06-18 08:35:10,876 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3a2b2322
2019-06-18 08:35:10,876 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3a2b2322
2019-06-18 08:35:10,891 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 38459
2019-06-18 08:35:10,892 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 08:35:10,892 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 08:35:10,893 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 38459 (custom)
2019-06-18 08:35:10,893 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 08:35:10,893 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 08:35:10,893 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 08:35:10,894 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 08:35:10,895 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler542ad0f2-586c-4cca-ab33-e57edbcbd685/ratis] (custom)
2019-06-18 08:35:10,895 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 33923
2019-06-18 08:35:10,895 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 08:35:10,896 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 08:35:10,896 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 8c8f0b87-8ad4-4490-a767-d51aad6533ec at port 38459
2019-06-18 08:35:10,917 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec: start RPC server
2019-06-18 08:35:10,919 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec: GrpcService started, listening on 0.0.0.0/0.0.0.0:38459
2019-06-18 08:35:10,932 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec: addNew group-0CFFC7A97C77:[8c8f0b87-8ad4-4490-a767-d51aad6533ec:127.0.0.1:38459] returns group-0CFFC7A97C77:java.util.concurrent.CompletableFuture@4dca07c1[Not completed]
2019-06-18 08:35:10,933 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec: new RaftServerImpl for group-0CFFC7A97C77:[8c8f0b87-8ad4-4490-a767-d51aad6533ec:127.0.0.1:38459] with ContainerStateMachine:uninitialized
2019-06-18 08:35:10,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 08:35:10,934 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 08:35:10,935 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 08:35:10,935 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 08:35:10,935 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec:group-0CFFC7A97C77 ConfigurationManager, init=-1: [8c8f0b87-8ad4-4490-a767-d51aad6533ec:127.0.0.1:38459], old=null, confs=<EMPTY_MAP>
2019-06-18 08:35:10,935 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler542ad0f2-586c-4cca-ab33-e57edbcbd685/ratis] (custom)
2019-06-18 08:35:10,935 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler542ad0f2-586c-4cca-ab33-e57edbcbd685/ratis/9dc44a68-42f6-4fd6-833d-0cffc7a97c77 does not exist. Creating ...
2019-06-18 08:35:10,938 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler542ad0f2-586c-4cca-ab33-e57edbcbd685/ratis/9dc44a68-42f6-4fd6-833d-0cffc7a97c77/in_use.lock acquired by nodename 4306@ozone-unit-076618677d3jt6tr-3854142395
2019-06-18 08:35:10,942 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler542ad0f2-586c-4cca-ab33-e57edbcbd685/ratis/9dc44a68-42f6-4fd6-833d-0cffc7a97c77 has been successfully formatted.
2019-06-18 08:35:10,942 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 08:35:10,942 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 08:35:10,942 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 08:35:10,942 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 08:35:10,943 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 08:35:10,943 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 08:35:10,943 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 8c8f0b87-8ad4-4490-a767-d51aad6533ec-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler542ad0f2-586c-4cca-ab33-e57edbcbd685/ratis/9dc44a68-42f6-4fd6-833d-0cffc7a97c77
2019-06-18 08:35:10,943 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 08:35:10,943 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 08:35:10,943 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 08:35:10,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 08:35:10,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 08:35:10,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 08:35:10,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 08:35:10,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 08:35:10,944 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 08:35:10,945 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 08:35:10,945 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 08:35:10,945 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 08:35:10,945 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 08:35:10,946 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec: start group-0CFFC7A97C77
2019-06-18 08:35:10,946 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec:group-0CFFC7A97C77 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 08:35:10,946 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec: start FollowerState
2019-06-18 08:35:10,947 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-0CFFC7A97C77,id=8c8f0b87-8ad4-4490-a767-d51aad6533ec
2019-06-18 08:35:11,989 INFO  impl.FollowerState (FollowerState.java:run(101)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec:group-0CFFC7A97C77 changes to CANDIDATE, lastRpcTime:1042, electionTimeout:1042ms
2019-06-18 08:35:11,989 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec: shutdown FollowerState
2019-06-18 08:35:11,989 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec:group-0CFFC7A97C77 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 08:35:11,989 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec: start LeaderElection
2019-06-18 08:35:11,994 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec:group-0CFFC7A97C77:LeaderElection2: begin an election at term 1 for -1: [8c8f0b87-8ad4-4490-a767-d51aad6533ec:127.0.0.1:38459], old=null
2019-06-18 08:35:11,994 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec: shutdown LeaderElection
2019-06-18 08:35:11,995 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec:group-0CFFC7A97C77 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 08:35:11,995 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec:group-0CFFC7A97C77 change Leader from null to 8c8f0b87-8ad4-4490-a767-d51aad6533ec at term 1 for becomeLeader, leader elected after 1052ms
2019-06-18 08:35:11,995 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 08:35:11,995 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 08:35:11,995 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 08:35:11,996 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 08:35:11,996 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec: start LeaderState
2019-06-18 08:35:11,996 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec-RaftLogWorker: Starting segment from index:0
2019-06-18 08:35:11,997 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec:group-0CFFC7A97C77 set configuration 0: [8c8f0b87-8ad4-4490-a767-d51aad6533ec:127.0.0.1:38459], old=null at 0
2019-06-18 08:35:12,032 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler542ad0f2-586c-4cca-ab33-e57edbcbd685/ratis/9dc44a68-42f6-4fd6-833d-0cffc7a97c77/current/log_inprogress_0
2019-06-18 08:35:12,986 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 08:35:12,987 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec: close
2019-06-18 08:35:12,987 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec: shutdown group-0CFFC7A97C77
2019-06-18 08:35:12,988 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-0CFFC7A97C77,id=8c8f0b87-8ad4-4490-a767-d51aad6533ec
2019-06-18 08:35:12,988 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec: shutdown LeaderState
2019-06-18 08:35:12,988 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec-PendingRequests: sendNotLeaderResponses
2019-06-18 08:35:12,989 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-8c8f0b87-8ad4-4490-a767-d51aad6533ec-group-0CFFC7A97C77: set stopIndex = 2
2019-06-18 08:35:12,989 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-18 08:35:12,989 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler542ad0f2-586c-4cca-ab33-e57edbcbd685/ratis/9dc44a68-42f6-4fd6-833d-0cffc7a97c77/sm/snapshot.1_2
2019-06-18 08:35:12,990 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec:group-0CFFC7A97C77 closes. The last applied log index is 2
2019-06-18 08:35:12,990 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 08:35:12,991 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec-RaftLogWorker close()
2019-06-18 08:35:12,991 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec: shutdown server with port 38459 now
2019-06-18 08:35:12,992 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 8c8f0b87-8ad4-4490-a767-d51aad6533ec: shutdown server with port 38459 successfully
2019-06-18 08:35:13,002 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-18 08:35:13,039 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler97374841-9f3d-4faf-9270-2778672661cf/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 08:35:13,039 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler97374841-9f3d-4faf-9270-2778672661cf/hdds to VolumeSet
2019-06-18 08:35:13,040 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@38eb2c50
2019-06-18 08:35:13,040 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@38eb2c50
2019-06-18 08:35:13,049 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 42885
2019-06-18 08:35:13,050 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 08:35:13,051 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 08:35:13,051 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42885 (custom)
2019-06-18 08:35:13,051 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 08:35:13,051 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 08:35:13,051 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 08:35:13,052 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 08:35:13,052 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler97374841-9f3d-4faf-9270-2778672661cf/ratis] (custom)
2019-06-18 08:35:13,052 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 44813
2019-06-18 08:35:13,053 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 08:35:13,053 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 08:35:13,053 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 441a133a-6471-44b7-b82b-70dc335d2558 at port 42885
2019-06-18 08:35:13,083 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 441a133a-6471-44b7-b82b-70dc335d2558: start RPC server
2019-06-18 08:35:13,085 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 441a133a-6471-44b7-b82b-70dc335d2558: GrpcService started, listening on 0.0.0.0/0.0.0.0:42885
2019-06-18 08:35:13,095 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 441a133a-6471-44b7-b82b-70dc335d2558: addNew group-1353344E3301:[441a133a-6471-44b7-b82b-70dc335d2558:127.0.0.1:42885] returns group-1353344E3301:java.util.concurrent.CompletableFuture@2da98588[Not completed]
2019-06-18 08:35:13,096 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 441a133a-6471-44b7-b82b-70dc335d2558: new RaftServerImpl for group-1353344E3301:[441a133a-6471-44b7-b82b-70dc335d2558:127.0.0.1:42885] with ContainerStateMachine:uninitialized
2019-06-18 08:35:13,096 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 08:35:13,096 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 08:35:13,097 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 08:35:13,097 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 08:35:13,097 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 441a133a-6471-44b7-b82b-70dc335d2558:group-1353344E3301 ConfigurationManager, init=-1: [441a133a-6471-44b7-b82b-70dc335d2558:127.0.0.1:42885], old=null, confs=<EMPTY_MAP>
2019-06-18 08:35:13,097 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler97374841-9f3d-4faf-9270-2778672661cf/ratis] (custom)
2019-06-18 08:35:13,097 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler97374841-9f3d-4faf-9270-2778672661cf/ratis/672d8400-a069-4085-8224-1353344e3301 does not exist. Creating ...
2019-06-18 08:35:13,101 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler97374841-9f3d-4faf-9270-2778672661cf/ratis/672d8400-a069-4085-8224-1353344e3301/in_use.lock acquired by nodename 4306@ozone-unit-076618677d3jt6tr-3854142395
2019-06-18 08:35:13,103 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler97374841-9f3d-4faf-9270-2778672661cf/ratis/672d8400-a069-4085-8224-1353344e3301 has been successfully formatted.
2019-06-18 08:35:13,104 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 08:35:13,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 08:35:13,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 08:35:13,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 08:35:13,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 08:35:13,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 08:35:13,104 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 441a133a-6471-44b7-b82b-70dc335d2558-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler97374841-9f3d-4faf-9270-2778672661cf/ratis/672d8400-a069-4085-8224-1353344e3301
2019-06-18 08:35:13,105 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 08:35:13,105 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 08:35:13,105 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 08:35:13,105 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 08:35:13,105 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 08:35:13,105 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 08:35:13,105 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 08:35:13,105 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 08:35:13,105 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 08:35:13,106 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 08:35:13,106 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 08:35:13,106 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 08:35:13,106 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 08:35:13,106 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 441a133a-6471-44b7-b82b-70dc335d2558: start group-1353344E3301
2019-06-18 08:35:13,107 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 441a133a-6471-44b7-b82b-70dc335d2558:group-1353344E3301 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 08:35:13,107 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 441a133a-6471-44b7-b82b-70dc335d2558: start FollowerState
2019-06-18 08:35:13,107 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-1353344E3301,id=441a133a-6471-44b7-b82b-70dc335d2558
2019-06-18 08:35:14,203 INFO  impl.FollowerState (FollowerState.java:run(101)) - 441a133a-6471-44b7-b82b-70dc335d2558:group-1353344E3301 changes to CANDIDATE, lastRpcTime:1096, electionTimeout:1096ms
2019-06-18 08:35:14,203 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 441a133a-6471-44b7-b82b-70dc335d2558: shutdown FollowerState
2019-06-18 08:35:14,204 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 441a133a-6471-44b7-b82b-70dc335d2558:group-1353344E3301 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 08:35:14,204 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 441a133a-6471-44b7-b82b-70dc335d2558: start LeaderElection
2019-06-18 08:35:14,210 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 441a133a-6471-44b7-b82b-70dc335d2558:group-1353344E3301:LeaderElection3: begin an election at term 1 for -1: [441a133a-6471-44b7-b82b-70dc335d2558:127.0.0.1:42885], old=null
2019-06-18 08:35:14,210 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 441a133a-6471-44b7-b82b-70dc335d2558: shutdown LeaderElection
2019-06-18 08:35:14,210 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 441a133a-6471-44b7-b82b-70dc335d2558:group-1353344E3301 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 08:35:14,210 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 441a133a-6471-44b7-b82b-70dc335d2558:group-1353344E3301 change Leader from null to 441a133a-6471-44b7-b82b-70dc335d2558 at term 1 for becomeLeader, leader elected after 1106ms
2019-06-18 08:35:14,211 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 08:35:14,211 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 08:35:14,211 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 08:35:14,211 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 08:35:14,211 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 441a133a-6471-44b7-b82b-70dc335d2558: start LeaderState
2019-06-18 08:35:14,211 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 441a133a-6471-44b7-b82b-70dc335d2558-RaftLogWorker: Starting segment from index:0
2019-06-18 08:35:14,214 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 441a133a-6471-44b7-b82b-70dc335d2558:group-1353344E3301 set configuration 0: [441a133a-6471-44b7-b82b-70dc335d2558:127.0.0.1:42885], old=null at 0
2019-06-18 08:35:14,248 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 441a133a-6471-44b7-b82b-70dc335d2558-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler97374841-9f3d-4faf-9270-2778672661cf/ratis/672d8400-a069-4085-8224-1353344e3301/current/log_inprogress_0
2019-06-18 08:35:15,153 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 5037158670498633940 is closed with bcsId 0.
2019-06-18 08:35:15,153 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 08:35:15,154 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 441a133a-6471-44b7-b82b-70dc335d2558: close
2019-06-18 08:35:15,154 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 441a133a-6471-44b7-b82b-70dc335d2558: shutdown group-1353344E3301
2019-06-18 08:35:15,154 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-1353344E3301,id=441a133a-6471-44b7-b82b-70dc335d2558
2019-06-18 08:35:15,155 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 441a133a-6471-44b7-b82b-70dc335d2558: shutdown LeaderState
2019-06-18 08:35:15,155 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 441a133a-6471-44b7-b82b-70dc335d2558-PendingRequests: sendNotLeaderResponses
2019-06-18 08:35:15,156 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-441a133a-6471-44b7-b82b-70dc335d2558-group-1353344E3301: set stopIndex = 2
2019-06-18 08:35:15,156 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-18 08:35:15,156 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler97374841-9f3d-4faf-9270-2778672661cf/ratis/672d8400-a069-4085-8224-1353344e3301/sm/snapshot.1_2
2019-06-18 08:35:15,157 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 441a133a-6471-44b7-b82b-70dc335d2558:group-1353344E3301 closes. The last applied log index is 2
2019-06-18 08:35:15,157 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 441a133a-6471-44b7-b82b-70dc335d2558-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 08:35:15,158 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 441a133a-6471-44b7-b82b-70dc335d2558-RaftLogWorker close()
2019-06-18 08:35:15,159 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 441a133a-6471-44b7-b82b-70dc335d2558: shutdown server with port 42885 now
2019-06-18 08:35:15,160 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 441a133a-6471-44b7-b82b-70dc335d2558: shutdown server with port 42885 successfully
2019-06-18 08:35:15,162 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-18 08:35:15,202 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler50845026-d99b-47be-aa1e-82fe5b16cfa2/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 08:35:15,202 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler50845026-d99b-47be-aa1e-82fe5b16cfa2/hdds to VolumeSet
2019-06-18 08:35:15,203 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@7318daf8
2019-06-18 08:35:15,204 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@7318daf8
2019-06-18 08:35:15,216 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 38387
2019-06-18 08:35:15,218 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 08:35:15,219 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 08:35:15,219 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 38387 (custom)
2019-06-18 08:35:15,219 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 08:35:15,220 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 08:35:15,220 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 08:35:15,220 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 08:35:15,220 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler50845026-d99b-47be-aa1e-82fe5b16cfa2/ratis] (custom)
2019-06-18 08:35:15,221 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 38497
2019-06-18 08:35:15,221 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 08:35:15,221 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 08:35:15,221 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 68f58d1d-cca6-4e80-a6af-ac891845ec52 at port 38387
2019-06-18 08:35:15,227 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52: start RPC server
2019-06-18 08:35:15,228 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52: GrpcService started, listening on 0.0.0.0/0.0.0.0:38387
Jun 18, 2019 8:35:15 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:38459} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 18, 2019 8:35:15 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:42885} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-18 08:35:15,245 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52: addNew group-750436995A5E:[68f58d1d-cca6-4e80-a6af-ac891845ec52:127.0.0.1:38387] returns group-750436995A5E:java.util.concurrent.CompletableFuture@32acf3de[Not completed]
2019-06-18 08:35:15,245 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52: new RaftServerImpl for group-750436995A5E:[68f58d1d-cca6-4e80-a6af-ac891845ec52:127.0.0.1:38387] with ContainerStateMachine:uninitialized
2019-06-18 08:35:15,246 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 08:35:15,246 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 08:35:15,246 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 08:35:15,246 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 08:35:15,246 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52:group-750436995A5E ConfigurationManager, init=-1: [68f58d1d-cca6-4e80-a6af-ac891845ec52:127.0.0.1:38387], old=null, confs=<EMPTY_MAP>
2019-06-18 08:35:15,246 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler50845026-d99b-47be-aa1e-82fe5b16cfa2/ratis] (custom)
2019-06-18 08:35:15,247 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler50845026-d99b-47be-aa1e-82fe5b16cfa2/ratis/e0b1de1d-1dc6-4cdc-a8b4-750436995a5e does not exist. Creating ...
2019-06-18 08:35:15,250 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler50845026-d99b-47be-aa1e-82fe5b16cfa2/ratis/e0b1de1d-1dc6-4cdc-a8b4-750436995a5e/in_use.lock acquired by nodename 4306@ozone-unit-076618677d3jt6tr-3854142395
2019-06-18 08:35:15,252 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler50845026-d99b-47be-aa1e-82fe5b16cfa2/ratis/e0b1de1d-1dc6-4cdc-a8b4-750436995a5e has been successfully formatted.
2019-06-18 08:35:15,253 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 08:35:15,253 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 08:35:15,253 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 08:35:15,253 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 08:35:15,253 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 08:35:15,253 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 08:35:15,254 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 68f58d1d-cca6-4e80-a6af-ac891845ec52-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler50845026-d99b-47be-aa1e-82fe5b16cfa2/ratis/e0b1de1d-1dc6-4cdc-a8b4-750436995a5e
2019-06-18 08:35:15,254 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 08:35:15,254 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 08:35:15,254 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 08:35:15,254 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 08:35:15,254 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 08:35:15,254 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 08:35:15,254 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 08:35:15,254 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 08:35:15,255 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 08:35:15,255 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 08:35:15,255 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 08:35:15,255 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 08:35:15,255 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 08:35:15,256 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52: start group-750436995A5E
2019-06-18 08:35:15,256 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52:group-750436995A5E changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 08:35:15,256 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52: start FollowerState
2019-06-18 08:35:15,257 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-750436995A5E,id=68f58d1d-cca6-4e80-a6af-ac891845ec52
2019-06-18 08:35:16,415 INFO  impl.FollowerState (FollowerState.java:run(101)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52:group-750436995A5E changes to CANDIDATE, lastRpcTime:1159, electionTimeout:1159ms
2019-06-18 08:35:16,415 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52: shutdown FollowerState
2019-06-18 08:35:16,415 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52:group-750436995A5E changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 08:35:16,416 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52: start LeaderElection
2019-06-18 08:35:16,421 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52:group-750436995A5E:LeaderElection4: begin an election at term 1 for -1: [68f58d1d-cca6-4e80-a6af-ac891845ec52:127.0.0.1:38387], old=null
2019-06-18 08:35:16,421 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52: shutdown LeaderElection
2019-06-18 08:35:16,421 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52:group-750436995A5E changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 08:35:16,421 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52:group-750436995A5E change Leader from null to 68f58d1d-cca6-4e80-a6af-ac891845ec52 at term 1 for becomeLeader, leader elected after 1168ms
2019-06-18 08:35:16,421 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 08:35:16,422 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 08:35:16,422 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 08:35:16,422 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 08:35:16,422 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52: start LeaderState
2019-06-18 08:35:16,422 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52-RaftLogWorker: Starting segment from index:0
2019-06-18 08:35:16,430 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52:group-750436995A5E set configuration 0: [68f58d1d-cca6-4e80-a6af-ac891845ec52:127.0.0.1:38387], old=null at 0
2019-06-18 08:35:16,462 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler50845026-d99b-47be-aa1e-82fe5b16cfa2/ratis/e0b1de1d-1dc6-4cdc-a8b4-750436995a5e/current/log_inprogress_0
2019-06-18 08:35:17,294 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 6048670105574638609 is closed with bcsId 0.
2019-06-18 08:35:17,295 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 08:35:17,295 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52: close
2019-06-18 08:35:17,295 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52: shutdown group-750436995A5E
2019-06-18 08:35:17,295 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-750436995A5E,id=68f58d1d-cca6-4e80-a6af-ac891845ec52
2019-06-18 08:35:17,296 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52: shutdown LeaderState
2019-06-18 08:35:17,296 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52-PendingRequests: sendNotLeaderResponses
2019-06-18 08:35:17,297 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-68f58d1d-cca6-4e80-a6af-ac891845ec52-group-750436995A5E: set stopIndex = 2
2019-06-18 08:35:17,297 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-18 08:35:17,297 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler50845026-d99b-47be-aa1e-82fe5b16cfa2/ratis/e0b1de1d-1dc6-4cdc-a8b4-750436995a5e/sm/snapshot.1_2
2019-06-18 08:35:17,298 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52:group-750436995A5E closes. The last applied log index is 2
2019-06-18 08:35:17,298 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 08:35:17,299 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52-RaftLogWorker close()
2019-06-18 08:35:17,300 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52: shutdown server with port 38387 now
2019-06-18 08:35:17,303 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 68f58d1d-cca6-4e80-a6af-ac891845ec52: shutdown server with port 38387 successfully
2019-06-18 08:35:17,307 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-18 08:35:17,326 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb1ddae91-01a7-4e88-8a14-3c4590080cea/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 08:35:17,327 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb1ddae91-01a7-4e88-8a14-3c4590080cea/hdds to VolumeSet
2019-06-18 08:35:17,327 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3e5d4f6b
2019-06-18 08:35:17,327 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3e5d4f6b
2019-06-18 08:35:17,339 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 37069
2019-06-18 08:35:17,339 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 08:35:17,340 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 08:35:17,340 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 37069 (custom)
2019-06-18 08:35:17,340 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 08:35:17,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 08:35:17,340 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 08:35:17,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 08:35:17,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb1ddae91-01a7-4e88-8a14-3c4590080cea/ratis] (custom)
2019-06-18 08:35:17,341 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 44911
2019-06-18 08:35:17,342 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 08:35:17,342 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 08:35:17,342 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d at port 37069
2019-06-18 08:35:17,372 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d: start RPC server
2019-06-18 08:35:17,373 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d: GrpcService started, listening on 0.0.0.0/0.0.0.0:37069
2019-06-18 08:35:17,381 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d: addNew group-D10D9F89C660:[4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d:127.0.0.1:37069] returns group-D10D9F89C660:java.util.concurrent.CompletableFuture@845752d[Not completed]
2019-06-18 08:35:17,382 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d: new RaftServerImpl for group-D10D9F89C660:[4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d:127.0.0.1:37069] with ContainerStateMachine:uninitialized
2019-06-18 08:35:17,382 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 08:35:17,382 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 08:35:17,382 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 08:35:17,382 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 08:35:17,383 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d:group-D10D9F89C660 ConfigurationManager, init=-1: [4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d:127.0.0.1:37069], old=null, confs=<EMPTY_MAP>
2019-06-18 08:35:17,383 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb1ddae91-01a7-4e88-8a14-3c4590080cea/ratis] (custom)
2019-06-18 08:35:17,383 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb1ddae91-01a7-4e88-8a14-3c4590080cea/ratis/fa6b674d-a5e3-4970-b76e-d10d9f89c660 does not exist. Creating ...
2019-06-18 08:35:17,387 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb1ddae91-01a7-4e88-8a14-3c4590080cea/ratis/fa6b674d-a5e3-4970-b76e-d10d9f89c660/in_use.lock acquired by nodename 4306@ozone-unit-076618677d3jt6tr-3854142395
2019-06-18 08:35:17,389 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb1ddae91-01a7-4e88-8a14-3c4590080cea/ratis/fa6b674d-a5e3-4970-b76e-d10d9f89c660 has been successfully formatted.
2019-06-18 08:35:17,389 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 08:35:17,389 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 08:35:17,389 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 08:35:17,389 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 08:35:17,389 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 08:35:17,389 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 08:35:17,390 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb1ddae91-01a7-4e88-8a14-3c4590080cea/ratis/fa6b674d-a5e3-4970-b76e-d10d9f89c660
2019-06-18 08:35:17,390 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 08:35:17,390 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 08:35:17,390 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 08:35:17,390 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 08:35:17,390 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 08:35:17,390 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 08:35:17,390 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 08:35:17,390 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 08:35:17,390 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 08:35:17,391 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 08:35:17,391 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 08:35:17,391 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 08:35:17,391 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 08:35:17,391 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d: start group-D10D9F89C660
2019-06-18 08:35:17,391 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d:group-D10D9F89C660 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 08:35:17,391 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d: start FollowerState
2019-06-18 08:35:17,392 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D10D9F89C660,id=4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d
2019-06-18 08:35:18,506 INFO  impl.FollowerState (FollowerState.java:run(101)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d:group-D10D9F89C660 changes to CANDIDATE, lastRpcTime:1114, electionTimeout:1114ms
2019-06-18 08:35:18,506 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d: shutdown FollowerState
2019-06-18 08:35:18,506 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d:group-D10D9F89C660 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 08:35:18,506 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d: start LeaderElection
2019-06-18 08:35:18,511 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d:group-D10D9F89C660:LeaderElection5: begin an election at term 1 for -1: [4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d:127.0.0.1:37069], old=null
2019-06-18 08:35:18,511 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d: shutdown LeaderElection
2019-06-18 08:35:18,511 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d:group-D10D9F89C660 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 08:35:18,511 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d:group-D10D9F89C660 change Leader from null to 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d at term 1 for becomeLeader, leader elected after 1121ms
2019-06-18 08:35:18,511 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 08:35:18,511 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 08:35:18,511 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 08:35:18,511 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 08:35:18,512 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d: start LeaderState
2019-06-18 08:35:18,512 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d-RaftLogWorker: Starting segment from index:0
2019-06-18 08:35:18,529 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d:group-D10D9F89C660 set configuration 0: [4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d:127.0.0.1:37069], old=null at 0
2019-06-18 08:35:18,547 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb1ddae91-01a7-4e88-8a14-3c4590080cea/ratis/fa6b674d-a5e3-4970-b76e-d10d9f89c660/current/log_inprogress_0
2019-06-18 08:35:19,428 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 2204885162453546939 is closed with bcsId 0.
2019-06-18 08:35:19,429 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 08:35:19,429 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d: close
2019-06-18 08:35:19,429 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d: shutdown group-D10D9F89C660
2019-06-18 08:35:19,429 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D10D9F89C660,id=4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d
2019-06-18 08:35:19,429 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d: shutdown LeaderState
2019-06-18 08:35:19,430 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d-PendingRequests: sendNotLeaderResponses
2019-06-18 08:35:19,431 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d-group-D10D9F89C660: set stopIndex = 4
2019-06-18 08:35:19,431 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-18 08:35:19,431 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb1ddae91-01a7-4e88-8a14-3c4590080cea/ratis/fa6b674d-a5e3-4970-b76e-d10d9f89c660/sm/snapshot.1_4
2019-06-18 08:35:19,431 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d:group-D10D9F89C660 closes. The last applied log index is 4
2019-06-18 08:35:19,431 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 08:35:19,432 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d-RaftLogWorker close()
2019-06-18 08:35:19,432 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d: shutdown server with port 37069 now
2019-06-18 08:35:19,433 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 4e915fa6-b17a-4e5d-bbb5-cbf7e8fdc42d: shutdown server with port 37069 successfully
2019-06-18 08:35:19,434 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
