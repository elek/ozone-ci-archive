2019-06-18 03:19:34,538 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere3a68ac8-bea5-44f7-b812-0114596403e7/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 03:19:34,545 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere3a68ac8-bea5-44f7-b812-0114596403e7/hdds to VolumeSet
2019-06-18 03:19:34,562 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-18 03:19:34,613 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-18 03:19:35,065 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 45035
2019-06-18 03:19:35,690 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 03:19:35,714 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 03:19:35,723 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 45035 (custom)
2019-06-18 03:19:35,724 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 03:19:35,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 03:19:35,727 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 03:19:35,728 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 03:19:35,910 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere3a68ac8-bea5-44f7-b812-0114596403e7/ratis] (custom)
2019-06-18 03:19:35,925 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 35363
2019-06-18 03:19:35,956 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 03:19:35,957 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 03:19:35,958 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 8ad883bb-b09f-453d-8f57-e9c29c7027da at port 45035
2019-06-18 03:19:36,004 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da: start RPC server
2019-06-18 03:19:36,192 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da: GrpcService started, listening on 0.0.0.0/0.0.0.0:45035
2019-06-18 03:19:36,592 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da: addNew group-DCF3B5790B5F:[8ad883bb-b09f-453d-8f57-e9c29c7027da:127.0.0.1:45035] returns group-DCF3B5790B5F:java.util.concurrent.CompletableFuture@6a65e08e[Not completed]
2019-06-18 03:19:36,627 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da: new RaftServerImpl for group-DCF3B5790B5F:[8ad883bb-b09f-453d-8f57-e9c29c7027da:127.0.0.1:45035] with ContainerStateMachine:uninitialized
2019-06-18 03:19:36,629 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 03:19:36,629 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 03:19:36,629 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 03:19:36,630 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 03:19:36,636 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da:group-DCF3B5790B5F ConfigurationManager, init=-1: [8ad883bb-b09f-453d-8f57-e9c29c7027da:127.0.0.1:45035], old=null, confs=<EMPTY_MAP>
2019-06-18 03:19:36,636 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere3a68ac8-bea5-44f7-b812-0114596403e7/ratis] (custom)
2019-06-18 03:19:36,643 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere3a68ac8-bea5-44f7-b812-0114596403e7/ratis/5ba4c59d-165c-4661-ad13-dcf3b5790b5f does not exist. Creating ...
2019-06-18 03:19:36,652 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere3a68ac8-bea5-44f7-b812-0114596403e7/ratis/5ba4c59d-165c-4661-ad13-dcf3b5790b5f/in_use.lock acquired by nodename 4320@ozone-unit-076618677d3hqq9x-4294872
2019-06-18 03:19:36,661 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere3a68ac8-bea5-44f7-b812-0114596403e7/ratis/5ba4c59d-165c-4661-ad13-dcf3b5790b5f has been successfully formatted.
2019-06-18 03:19:36,663 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 03:19:36,664 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 03:19:36,665 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 03:19:36,668 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 03:19:36,671 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 03:19:36,675 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 03:19:36,678 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 8ad883bb-b09f-453d-8f57-e9c29c7027da-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere3a68ac8-bea5-44f7-b812-0114596403e7/ratis/5ba4c59d-165c-4661-ad13-dcf3b5790b5f
2019-06-18 03:19:36,679 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 03:19:36,680 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 03:19:36,682 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 03:19:36,682 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 03:19:36,683 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 03:19:36,683 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 03:19:36,684 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 03:19:36,684 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 03:19:36,685 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 03:19:36,687 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 03:19:36,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 03:19:36,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 03:19:36,694 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 03:19:36,814 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da: start group-DCF3B5790B5F
2019-06-18 03:19:36,816 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da:group-DCF3B5790B5F changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 03:19:36,817 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da: start FollowerState
2019-06-18 03:19:36,820 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-DCF3B5790B5F,id=8ad883bb-b09f-453d-8f57-e9c29c7027da
2019-06-18 03:19:37,995 INFO  impl.FollowerState (FollowerState.java:run(101)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da:group-DCF3B5790B5F changes to CANDIDATE, lastRpcTime:1178, electionTimeout:1177ms
2019-06-18 03:19:37,995 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da: shutdown FollowerState
2019-06-18 03:19:37,995 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da:group-DCF3B5790B5F changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 03:19:37,997 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da: start LeaderElection
2019-06-18 03:19:38,001 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da:group-DCF3B5790B5F:LeaderElection1: begin an election at term 1 for -1: [8ad883bb-b09f-453d-8f57-e9c29c7027da:127.0.0.1:45035], old=null
2019-06-18 03:19:38,002 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da: shutdown LeaderElection
2019-06-18 03:19:38,003 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da:group-DCF3B5790B5F changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 03:19:38,003 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da:group-DCF3B5790B5F change Leader from null to 8ad883bb-b09f-453d-8f57-e9c29c7027da at term 1 for becomeLeader, leader elected after 1339ms
2019-06-18 03:19:38,008 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 03:19:38,008 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 03:19:38,011 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 03:19:38,011 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 03:19:38,022 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da: start LeaderState
2019-06-18 03:19:38,040 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da-RaftLogWorker: Starting segment from index:0
2019-06-18 03:19:38,066 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da:group-DCF3B5790B5F set configuration 0: [8ad883bb-b09f-453d-8f57-e9c29c7027da:127.0.0.1:45035], old=null at 0
2019-06-18 03:19:38,230 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere3a68ac8-bea5-44f7-b812-0114596403e7/ratis/5ba4c59d-165c-4661-ad13-dcf3b5790b5f/current/log_inprogress_0
2019-06-18 03:19:39,126 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-18 03:19:39,205 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 17885064649601841 is closed with bcsId 0.
2019-06-18 03:19:39,206 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 03:19:39,207 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da: close
2019-06-18 03:19:39,209 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da: shutdown group-DCF3B5790B5F
2019-06-18 03:19:39,209 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-DCF3B5790B5F,id=8ad883bb-b09f-453d-8f57-e9c29c7027da
2019-06-18 03:19:39,210 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da: shutdown LeaderState
2019-06-18 03:19:39,210 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da-PendingRequests: sendNotLeaderResponses
2019-06-18 03:19:39,214 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-8ad883bb-b09f-453d-8f57-e9c29c7027da-group-DCF3B5790B5F: set stopIndex = 4
2019-06-18 03:19:39,214 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-18 03:19:39,215 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere3a68ac8-bea5-44f7-b812-0114596403e7/ratis/5ba4c59d-165c-4661-ad13-dcf3b5790b5f/sm/snapshot.1_4
2019-06-18 03:19:39,223 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da:group-DCF3B5790B5F closes. The last applied log index is 4
2019-06-18 03:19:39,224 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 03:19:39,226 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da-RaftLogWorker close()
2019-06-18 03:19:39,227 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da: shutdown server with port 45035 now
2019-06-18 03:19:39,231 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 8ad883bb-b09f-453d-8f57-e9c29c7027da: shutdown server with port 45035 successfully
2019-06-18 03:19:39,246 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-18 03:19:39,292 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5af5523f-73a4-4bab-b079-8624b3cac3fb/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 03:19:39,292 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5af5523f-73a4-4bab-b079-8624b3cac3fb/hdds to VolumeSet
2019-06-18 03:19:39,292 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@12958360
2019-06-18 03:19:39,293 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@12958360
2019-06-18 03:19:39,308 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 33259
2019-06-18 03:19:39,310 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 03:19:39,311 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 03:19:39,311 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 33259 (custom)
2019-06-18 03:19:39,311 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 03:19:39,312 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 03:19:39,312 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 03:19:39,312 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 03:19:39,314 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5af5523f-73a4-4bab-b079-8624b3cac3fb/ratis] (custom)
2019-06-18 03:19:39,314 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 46793
2019-06-18 03:19:39,316 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 03:19:39,316 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 03:19:39,316 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 905de77b-fd10-4ca1-abc9-aaafb00c79c9 at port 33259
2019-06-18 03:19:39,406 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9: start RPC server
2019-06-18 03:19:39,408 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9: GrpcService started, listening on 0.0.0.0/0.0.0.0:33259
2019-06-18 03:19:39,424 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9: addNew group-41480294201B:[905de77b-fd10-4ca1-abc9-aaafb00c79c9:127.0.0.1:33259] returns group-41480294201B:java.util.concurrent.CompletableFuture@3253b014[Not completed]
2019-06-18 03:19:39,427 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9: new RaftServerImpl for group-41480294201B:[905de77b-fd10-4ca1-abc9-aaafb00c79c9:127.0.0.1:33259] with ContainerStateMachine:uninitialized
2019-06-18 03:19:39,429 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 03:19:39,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 03:19:39,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 03:19:39,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 03:19:39,430 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9:group-41480294201B ConfigurationManager, init=-1: [905de77b-fd10-4ca1-abc9-aaafb00c79c9:127.0.0.1:33259], old=null, confs=<EMPTY_MAP>
2019-06-18 03:19:39,430 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5af5523f-73a4-4bab-b079-8624b3cac3fb/ratis] (custom)
2019-06-18 03:19:39,431 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5af5523f-73a4-4bab-b079-8624b3cac3fb/ratis/7511f107-ca27-47bf-a6e7-41480294201b does not exist. Creating ...
2019-06-18 03:19:39,434 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5af5523f-73a4-4bab-b079-8624b3cac3fb/ratis/7511f107-ca27-47bf-a6e7-41480294201b/in_use.lock acquired by nodename 4320@ozone-unit-076618677d3hqq9x-4294872
2019-06-18 03:19:39,436 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5af5523f-73a4-4bab-b079-8624b3cac3fb/ratis/7511f107-ca27-47bf-a6e7-41480294201b has been successfully formatted.
2019-06-18 03:19:39,437 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 03:19:39,437 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 03:19:39,437 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 03:19:39,437 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 03:19:39,437 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 03:19:39,438 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 03:19:39,438 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 905de77b-fd10-4ca1-abc9-aaafb00c79c9-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5af5523f-73a4-4bab-b079-8624b3cac3fb/ratis/7511f107-ca27-47bf-a6e7-41480294201b
2019-06-18 03:19:39,438 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 03:19:39,438 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 03:19:39,438 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 03:19:39,438 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 03:19:39,439 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 03:19:39,439 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 03:19:39,439 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 03:19:39,439 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 03:19:39,439 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 03:19:39,439 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 03:19:39,440 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 03:19:39,440 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 03:19:39,440 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 03:19:39,440 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9: start group-41480294201B
2019-06-18 03:19:39,441 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9:group-41480294201B changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 03:19:39,441 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9: start FollowerState
2019-06-18 03:19:39,441 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-41480294201B,id=905de77b-fd10-4ca1-abc9-aaafb00c79c9
2019-06-18 03:19:40,450 INFO  impl.FollowerState (FollowerState.java:run(101)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9:group-41480294201B changes to CANDIDATE, lastRpcTime:1009, electionTimeout:1009ms
2019-06-18 03:19:40,450 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9: shutdown FollowerState
2019-06-18 03:19:40,451 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9:group-41480294201B changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 03:19:40,451 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9: start LeaderElection
2019-06-18 03:19:40,454 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9:group-41480294201B:LeaderElection2: begin an election at term 1 for -1: [905de77b-fd10-4ca1-abc9-aaafb00c79c9:127.0.0.1:33259], old=null
2019-06-18 03:19:40,455 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9: shutdown LeaderElection
2019-06-18 03:19:40,455 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9:group-41480294201B changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 03:19:40,455 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9:group-41480294201B change Leader from null to 905de77b-fd10-4ca1-abc9-aaafb00c79c9 at term 1 for becomeLeader, leader elected after 1018ms
2019-06-18 03:19:40,455 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 03:19:40,455 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 03:19:40,456 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 03:19:40,456 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 03:19:40,456 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9: start LeaderState
2019-06-18 03:19:40,456 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9-RaftLogWorker: Starting segment from index:0
2019-06-18 03:19:40,457 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9:group-41480294201B set configuration 0: [905de77b-fd10-4ca1-abc9-aaafb00c79c9:127.0.0.1:33259], old=null at 0
2019-06-18 03:19:40,503 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5af5523f-73a4-4bab-b079-8624b3cac3fb/ratis/7511f107-ca27-47bf-a6e7-41480294201b/current/log_inprogress_0
2019-06-18 03:19:41,500 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 03:19:41,501 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9: close
2019-06-18 03:19:41,502 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9: shutdown group-41480294201B
2019-06-18 03:19:41,502 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-41480294201B,id=905de77b-fd10-4ca1-abc9-aaafb00c79c9
2019-06-18 03:19:41,502 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9: shutdown LeaderState
2019-06-18 03:19:41,503 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9-PendingRequests: sendNotLeaderResponses
2019-06-18 03:19:41,504 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-905de77b-fd10-4ca1-abc9-aaafb00c79c9-group-41480294201B: set stopIndex = 2
2019-06-18 03:19:41,504 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-18 03:19:41,505 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5af5523f-73a4-4bab-b079-8624b3cac3fb/ratis/7511f107-ca27-47bf-a6e7-41480294201b/sm/snapshot.1_2
2019-06-18 03:19:41,505 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9:group-41480294201B closes. The last applied log index is 2
2019-06-18 03:19:41,506 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 03:19:41,507 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9-RaftLogWorker close()
2019-06-18 03:19:41,509 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9: shutdown server with port 33259 now
2019-06-18 03:19:41,510 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 905de77b-fd10-4ca1-abc9-aaafb00c79c9: shutdown server with port 33259 successfully
2019-06-18 03:19:41,530 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-18 03:19:41,550 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler993880c3-b8ec-4740-bf1f-e7746a2dd92f/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 03:19:41,550 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler993880c3-b8ec-4740-bf1f-e7746a2dd92f/hdds to VolumeSet
2019-06-18 03:19:41,551 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@8bffb8b
2019-06-18 03:19:41,551 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@8bffb8b
2019-06-18 03:19:41,571 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 45423
2019-06-18 03:19:41,572 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 03:19:41,573 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 03:19:41,574 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 45423 (custom)
2019-06-18 03:19:41,574 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 03:19:41,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 03:19:41,575 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 03:19:41,575 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 03:19:41,576 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler993880c3-b8ec-4740-bf1f-e7746a2dd92f/ratis] (custom)
2019-06-18 03:19:41,577 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 38707
2019-06-18 03:19:41,577 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 03:19:41,578 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 03:19:41,578 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 3a3ab888-bd94-43ef-8099-a3625f49a055 at port 45423
2019-06-18 03:19:41,593 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 3a3ab888-bd94-43ef-8099-a3625f49a055: start RPC server
2019-06-18 03:19:41,596 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 3a3ab888-bd94-43ef-8099-a3625f49a055: GrpcService started, listening on 0.0.0.0/0.0.0.0:45423
2019-06-18 03:19:41,608 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 3a3ab888-bd94-43ef-8099-a3625f49a055: addNew group-C4972B16D2C8:[3a3ab888-bd94-43ef-8099-a3625f49a055:127.0.0.1:45423] returns group-C4972B16D2C8:java.util.concurrent.CompletableFuture@3a5d24db[Not completed]
2019-06-18 03:19:41,611 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 3a3ab888-bd94-43ef-8099-a3625f49a055: new RaftServerImpl for group-C4972B16D2C8:[3a3ab888-bd94-43ef-8099-a3625f49a055:127.0.0.1:45423] with ContainerStateMachine:uninitialized
2019-06-18 03:19:41,613 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 03:19:41,613 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 03:19:41,613 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 03:19:41,614 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 03:19:41,614 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 3a3ab888-bd94-43ef-8099-a3625f49a055:group-C4972B16D2C8 ConfigurationManager, init=-1: [3a3ab888-bd94-43ef-8099-a3625f49a055:127.0.0.1:45423], old=null, confs=<EMPTY_MAP>
2019-06-18 03:19:41,614 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler993880c3-b8ec-4740-bf1f-e7746a2dd92f/ratis] (custom)
2019-06-18 03:19:41,614 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler993880c3-b8ec-4740-bf1f-e7746a2dd92f/ratis/f819355c-df7f-448e-9a8e-c4972b16d2c8 does not exist. Creating ...
2019-06-18 03:19:41,619 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler993880c3-b8ec-4740-bf1f-e7746a2dd92f/ratis/f819355c-df7f-448e-9a8e-c4972b16d2c8/in_use.lock acquired by nodename 4320@ozone-unit-076618677d3hqq9x-4294872
2019-06-18 03:19:41,621 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler993880c3-b8ec-4740-bf1f-e7746a2dd92f/ratis/f819355c-df7f-448e-9a8e-c4972b16d2c8 has been successfully formatted.
2019-06-18 03:19:41,622 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 03:19:41,622 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 03:19:41,622 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 03:19:41,622 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 03:19:41,622 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 03:19:41,623 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 03:19:41,623 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 3a3ab888-bd94-43ef-8099-a3625f49a055-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler993880c3-b8ec-4740-bf1f-e7746a2dd92f/ratis/f819355c-df7f-448e-9a8e-c4972b16d2c8
2019-06-18 03:19:41,623 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 03:19:41,623 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 03:19:41,623 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 03:19:41,623 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 03:19:41,624 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 03:19:41,624 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 03:19:41,624 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 03:19:41,624 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 03:19:41,624 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 03:19:41,624 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 03:19:41,625 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 03:19:41,625 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 03:19:41,626 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 03:19:41,626 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 3a3ab888-bd94-43ef-8099-a3625f49a055: start group-C4972B16D2C8
2019-06-18 03:19:41,626 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3a3ab888-bd94-43ef-8099-a3625f49a055:group-C4972B16D2C8 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 03:19:41,626 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3a3ab888-bd94-43ef-8099-a3625f49a055: start FollowerState
2019-06-18 03:19:41,627 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C4972B16D2C8,id=3a3ab888-bd94-43ef-8099-a3625f49a055
2019-06-18 03:19:42,672 INFO  impl.FollowerState (FollowerState.java:run(101)) - 3a3ab888-bd94-43ef-8099-a3625f49a055:group-C4972B16D2C8 changes to CANDIDATE, lastRpcTime:1045, electionTimeout:1045ms
2019-06-18 03:19:42,672 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 3a3ab888-bd94-43ef-8099-a3625f49a055: shutdown FollowerState
2019-06-18 03:19:42,672 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3a3ab888-bd94-43ef-8099-a3625f49a055:group-C4972B16D2C8 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 03:19:42,672 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3a3ab888-bd94-43ef-8099-a3625f49a055: start LeaderElection
2019-06-18 03:19:42,676 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 3a3ab888-bd94-43ef-8099-a3625f49a055:group-C4972B16D2C8:LeaderElection3: begin an election at term 1 for -1: [3a3ab888-bd94-43ef-8099-a3625f49a055:127.0.0.1:45423], old=null
2019-06-18 03:19:42,676 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 3a3ab888-bd94-43ef-8099-a3625f49a055: shutdown LeaderElection
2019-06-18 03:19:42,676 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3a3ab888-bd94-43ef-8099-a3625f49a055:group-C4972B16D2C8 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 03:19:42,676 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 3a3ab888-bd94-43ef-8099-a3625f49a055:group-C4972B16D2C8 change Leader from null to 3a3ab888-bd94-43ef-8099-a3625f49a055 at term 1 for becomeLeader, leader elected after 1054ms
2019-06-18 03:19:42,676 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 03:19:42,677 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 03:19:42,677 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 03:19:42,677 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 03:19:42,677 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3a3ab888-bd94-43ef-8099-a3625f49a055: start LeaderState
2019-06-18 03:19:42,678 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 3a3ab888-bd94-43ef-8099-a3625f49a055-RaftLogWorker: Starting segment from index:0
2019-06-18 03:19:42,708 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 3a3ab888-bd94-43ef-8099-a3625f49a055:group-C4972B16D2C8 set configuration 0: [3a3ab888-bd94-43ef-8099-a3625f49a055:127.0.0.1:45423], old=null at 0
2019-06-18 03:19:42,745 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 3a3ab888-bd94-43ef-8099-a3625f49a055-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler993880c3-b8ec-4740-bf1f-e7746a2dd92f/ratis/f819355c-df7f-448e-9a8e-c4972b16d2c8/current/log_inprogress_0
2019-06-18 03:19:43,681 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 2150761799086479684 is closed with bcsId 0.
2019-06-18 03:19:43,682 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 03:19:43,682 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 3a3ab888-bd94-43ef-8099-a3625f49a055: close
2019-06-18 03:19:43,683 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 3a3ab888-bd94-43ef-8099-a3625f49a055: shutdown group-C4972B16D2C8
2019-06-18 03:19:43,683 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C4972B16D2C8,id=3a3ab888-bd94-43ef-8099-a3625f49a055
2019-06-18 03:19:43,683 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 3a3ab888-bd94-43ef-8099-a3625f49a055: shutdown LeaderState
2019-06-18 03:19:43,685 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 3a3ab888-bd94-43ef-8099-a3625f49a055-PendingRequests: sendNotLeaderResponses
2019-06-18 03:19:43,686 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-18 03:19:43,686 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler993880c3-b8ec-4740-bf1f-e7746a2dd92f/ratis/f819355c-df7f-448e-9a8e-c4972b16d2c8/sm/snapshot.1_2
2019-06-18 03:19:43,687 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-3a3ab888-bd94-43ef-8099-a3625f49a055-group-C4972B16D2C8: set stopIndex = 2
2019-06-18 03:19:43,687 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 3a3ab888-bd94-43ef-8099-a3625f49a055:group-C4972B16D2C8 closes. The last applied log index is 2
2019-06-18 03:19:43,688 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 3a3ab888-bd94-43ef-8099-a3625f49a055-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 03:19:43,688 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 3a3ab888-bd94-43ef-8099-a3625f49a055-RaftLogWorker close()
2019-06-18 03:19:43,689 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 3a3ab888-bd94-43ef-8099-a3625f49a055: shutdown server with port 45423 now
2019-06-18 03:19:43,691 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 3a3ab888-bd94-43ef-8099-a3625f49a055: shutdown server with port 45423 successfully
2019-06-18 03:19:43,721 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-18 03:19:43,761 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9726df53-e2d5-4bf2-8ca1-493943cddc7d/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 03:19:43,761 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9726df53-e2d5-4bf2-8ca1-493943cddc7d/hdds to VolumeSet
2019-06-18 03:19:43,762 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@455824ad
2019-06-18 03:19:43,762 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@455824ad
2019-06-18 03:19:43,778 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 40727
2019-06-18 03:19:43,778 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 03:19:43,784 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 03:19:43,784 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 40727 (custom)
2019-06-18 03:19:43,784 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 03:19:43,785 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 03:19:43,785 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 03:19:43,785 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 03:19:43,785 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9726df53-e2d5-4bf2-8ca1-493943cddc7d/ratis] (custom)
2019-06-18 03:19:43,786 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 44855
2019-06-18 03:19:43,786 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 03:19:43,786 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 03:19:43,786 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 3e8b958b-c344-4fa1-b10d-68a1c7d88daf at port 40727
2019-06-18 03:19:43,810 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf: start RPC server
2019-06-18 03:19:43,811 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf: GrpcService started, listening on 0.0.0.0/0.0.0.0:40727
Jun 18, 2019 3:19:43 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:45423} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 18, 2019 3:19:43 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:33259} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-18 03:19:43,841 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf: addNew group-49F9AF33E788:[3e8b958b-c344-4fa1-b10d-68a1c7d88daf:127.0.0.1:40727] returns group-49F9AF33E788:java.util.concurrent.CompletableFuture@594e3f50[Not completed]
2019-06-18 03:19:43,842 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf: new RaftServerImpl for group-49F9AF33E788:[3e8b958b-c344-4fa1-b10d-68a1c7d88daf:127.0.0.1:40727] with ContainerStateMachine:uninitialized
2019-06-18 03:19:43,842 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 03:19:43,842 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 03:19:43,842 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 03:19:43,842 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 03:19:43,843 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf:group-49F9AF33E788 ConfigurationManager, init=-1: [3e8b958b-c344-4fa1-b10d-68a1c7d88daf:127.0.0.1:40727], old=null, confs=<EMPTY_MAP>
2019-06-18 03:19:43,843 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9726df53-e2d5-4bf2-8ca1-493943cddc7d/ratis] (custom)
2019-06-18 03:19:43,843 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9726df53-e2d5-4bf2-8ca1-493943cddc7d/ratis/2926cf9b-c71d-428b-9596-49f9af33e788 does not exist. Creating ...
2019-06-18 03:19:43,846 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9726df53-e2d5-4bf2-8ca1-493943cddc7d/ratis/2926cf9b-c71d-428b-9596-49f9af33e788/in_use.lock acquired by nodename 4320@ozone-unit-076618677d3hqq9x-4294872
2019-06-18 03:19:43,848 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9726df53-e2d5-4bf2-8ca1-493943cddc7d/ratis/2926cf9b-c71d-428b-9596-49f9af33e788 has been successfully formatted.
2019-06-18 03:19:43,849 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 03:19:43,849 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 03:19:43,849 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 03:19:43,849 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 03:19:43,849 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 03:19:43,849 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 03:19:43,849 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 3e8b958b-c344-4fa1-b10d-68a1c7d88daf-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9726df53-e2d5-4bf2-8ca1-493943cddc7d/ratis/2926cf9b-c71d-428b-9596-49f9af33e788
2019-06-18 03:19:43,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 03:19:43,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 03:19:43,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 03:19:43,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 03:19:43,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 03:19:43,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 03:19:43,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 03:19:43,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 03:19:43,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 03:19:43,851 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 03:19:43,851 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 03:19:43,851 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 03:19:43,852 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 03:19:43,852 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf: start group-49F9AF33E788
2019-06-18 03:19:43,852 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf:group-49F9AF33E788 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 03:19:43,852 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf: start FollowerState
2019-06-18 03:19:43,853 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-49F9AF33E788,id=3e8b958b-c344-4fa1-b10d-68a1c7d88daf
2019-06-18 03:19:44,957 INFO  impl.FollowerState (FollowerState.java:run(101)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf:group-49F9AF33E788 changes to CANDIDATE, lastRpcTime:1104, electionTimeout:1103ms
2019-06-18 03:19:44,957 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf: shutdown FollowerState
2019-06-18 03:19:44,957 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf:group-49F9AF33E788 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 03:19:44,957 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf: start LeaderElection
2019-06-18 03:19:44,961 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf:group-49F9AF33E788:LeaderElection4: begin an election at term 1 for -1: [3e8b958b-c344-4fa1-b10d-68a1c7d88daf:127.0.0.1:40727], old=null
2019-06-18 03:19:44,962 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf: shutdown LeaderElection
2019-06-18 03:19:44,972 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf:group-49F9AF33E788 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 03:19:44,972 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf:group-49F9AF33E788 change Leader from null to 3e8b958b-c344-4fa1-b10d-68a1c7d88daf at term 1 for becomeLeader, leader elected after 1123ms
2019-06-18 03:19:44,972 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 03:19:44,972 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 03:19:44,973 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 03:19:44,973 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 03:19:44,973 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf: start LeaderState
2019-06-18 03:19:44,973 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf-RaftLogWorker: Starting segment from index:0
2019-06-18 03:19:44,974 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf:group-49F9AF33E788 set configuration 0: [3e8b958b-c344-4fa1-b10d-68a1c7d88daf:127.0.0.1:40727], old=null at 0
2019-06-18 03:19:45,019 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9726df53-e2d5-4bf2-8ca1-493943cddc7d/ratis/2926cf9b-c71d-428b-9596-49f9af33e788/current/log_inprogress_0
2019-06-18 03:19:45,911 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 2367647896925721199 is closed with bcsId 0.
2019-06-18 03:19:45,911 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 03:19:45,912 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf: close
2019-06-18 03:19:45,912 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf: shutdown group-49F9AF33E788
2019-06-18 03:19:45,912 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-49F9AF33E788,id=3e8b958b-c344-4fa1-b10d-68a1c7d88daf
2019-06-18 03:19:45,912 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf: shutdown LeaderState
2019-06-18 03:19:45,913 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf-PendingRequests: sendNotLeaderResponses
2019-06-18 03:19:45,914 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-3e8b958b-c344-4fa1-b10d-68a1c7d88daf-group-49F9AF33E788: set stopIndex = 2
2019-06-18 03:19:45,914 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-18 03:19:45,915 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9726df53-e2d5-4bf2-8ca1-493943cddc7d/ratis/2926cf9b-c71d-428b-9596-49f9af33e788/sm/snapshot.1_2
2019-06-18 03:19:45,915 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf:group-49F9AF33E788 closes. The last applied log index is 2
2019-06-18 03:19:45,915 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 03:19:45,916 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf-RaftLogWorker close()
2019-06-18 03:19:45,917 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf: shutdown server with port 40727 now
2019-06-18 03:19:45,919 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 3e8b958b-c344-4fa1-b10d-68a1c7d88daf: shutdown server with port 40727 successfully
2019-06-18 03:19:45,925 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-18 03:19:45,968 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerde29bfbd-02fa-42bf-941d-32f499d76d30/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 03:19:45,968 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerde29bfbd-02fa-42bf-941d-32f499d76d30/hdds to VolumeSet
2019-06-18 03:19:45,969 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3e5d4f6b
2019-06-18 03:19:45,977 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3e5d4f6b
2019-06-18 03:19:45,996 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 40347
2019-06-18 03:19:45,996 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 03:19:45,997 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 03:19:45,997 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 40347 (custom)
2019-06-18 03:19:45,998 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 03:19:45,998 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 03:19:45,998 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 03:19:45,998 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 03:19:45,999 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerde29bfbd-02fa-42bf-941d-32f499d76d30/ratis] (custom)
2019-06-18 03:19:45,999 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 41749
2019-06-18 03:19:46,000 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 03:19:46,000 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 03:19:46,000 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 09c02e08-48fc-42ac-b559-a0c54b1d4645 at port 40347
2019-06-18 03:19:46,046 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645: start RPC server
2019-06-18 03:19:46,047 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645: GrpcService started, listening on 0.0.0.0/0.0.0.0:40347
2019-06-18 03:19:46,065 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645: addNew group-8B8064A6AFA8:[09c02e08-48fc-42ac-b559-a0c54b1d4645:127.0.0.1:40347] returns group-8B8064A6AFA8:java.util.concurrent.CompletableFuture@1abd2310[Not completed]
2019-06-18 03:19:46,066 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645: new RaftServerImpl for group-8B8064A6AFA8:[09c02e08-48fc-42ac-b559-a0c54b1d4645:127.0.0.1:40347] with ContainerStateMachine:uninitialized
2019-06-18 03:19:46,066 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 03:19:46,066 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 03:19:46,066 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 03:19:46,067 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 03:19:46,067 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645:group-8B8064A6AFA8 ConfigurationManager, init=-1: [09c02e08-48fc-42ac-b559-a0c54b1d4645:127.0.0.1:40347], old=null, confs=<EMPTY_MAP>
2019-06-18 03:19:46,067 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerde29bfbd-02fa-42bf-941d-32f499d76d30/ratis] (custom)
2019-06-18 03:19:46,067 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerde29bfbd-02fa-42bf-941d-32f499d76d30/ratis/e4d8ef78-573a-4b8a-896e-8b8064a6afa8 does not exist. Creating ...
2019-06-18 03:19:46,070 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerde29bfbd-02fa-42bf-941d-32f499d76d30/ratis/e4d8ef78-573a-4b8a-896e-8b8064a6afa8/in_use.lock acquired by nodename 4320@ozone-unit-076618677d3hqq9x-4294872
2019-06-18 03:19:46,073 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerde29bfbd-02fa-42bf-941d-32f499d76d30/ratis/e4d8ef78-573a-4b8a-896e-8b8064a6afa8 has been successfully formatted.
2019-06-18 03:19:46,073 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 03:19:46,073 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 03:19:46,073 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 03:19:46,073 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 03:19:46,074 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 03:19:46,074 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 03:19:46,074 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 09c02e08-48fc-42ac-b559-a0c54b1d4645-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerde29bfbd-02fa-42bf-941d-32f499d76d30/ratis/e4d8ef78-573a-4b8a-896e-8b8064a6afa8
2019-06-18 03:19:46,074 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 03:19:46,074 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 03:19:46,074 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 03:19:46,074 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 03:19:46,075 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 03:19:46,075 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 03:19:46,075 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 03:19:46,075 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 03:19:46,075 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 03:19:46,075 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 03:19:46,079 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 03:19:46,079 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 03:19:46,079 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 03:19:46,079 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645: start group-8B8064A6AFA8
2019-06-18 03:19:46,079 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645:group-8B8064A6AFA8 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 03:19:46,079 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645: start FollowerState
2019-06-18 03:19:46,081 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-8B8064A6AFA8,id=09c02e08-48fc-42ac-b559-a0c54b1d4645
2019-06-18 03:19:47,210 INFO  impl.FollowerState (FollowerState.java:run(101)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645:group-8B8064A6AFA8 changes to CANDIDATE, lastRpcTime:1130, electionTimeout:1129ms
2019-06-18 03:19:47,210 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645: shutdown FollowerState
2019-06-18 03:19:47,210 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645:group-8B8064A6AFA8 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 03:19:47,210 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645: start LeaderElection
2019-06-18 03:19:47,215 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645:group-8B8064A6AFA8:LeaderElection5: begin an election at term 1 for -1: [09c02e08-48fc-42ac-b559-a0c54b1d4645:127.0.0.1:40347], old=null
2019-06-18 03:19:47,215 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645: shutdown LeaderElection
2019-06-18 03:19:47,215 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645:group-8B8064A6AFA8 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 03:19:47,216 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645:group-8B8064A6AFA8 change Leader from null to 09c02e08-48fc-42ac-b559-a0c54b1d4645 at term 1 for becomeLeader, leader elected after 1142ms
2019-06-18 03:19:47,216 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 03:19:47,216 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 03:19:47,216 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 03:19:47,216 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 03:19:47,216 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645: start LeaderState
2019-06-18 03:19:47,217 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645-RaftLogWorker: Starting segment from index:0
2019-06-18 03:19:47,217 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645:group-8B8064A6AFA8 set configuration 0: [09c02e08-48fc-42ac-b559-a0c54b1d4645:127.0.0.1:40347], old=null at 0
2019-06-18 03:19:47,259 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerde29bfbd-02fa-42bf-941d-32f499d76d30/ratis/e4d8ef78-573a-4b8a-896e-8b8064a6afa8/current/log_inprogress_0
2019-06-18 03:19:48,141 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 4055229642728144775 is closed with bcsId 0.
2019-06-18 03:19:48,142 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 03:19:48,142 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645: close
2019-06-18 03:19:48,142 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645: shutdown group-8B8064A6AFA8
2019-06-18 03:19:48,143 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-8B8064A6AFA8,id=09c02e08-48fc-42ac-b559-a0c54b1d4645
2019-06-18 03:19:48,143 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645: shutdown LeaderState
2019-06-18 03:19:48,144 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645-PendingRequests: sendNotLeaderResponses
2019-06-18 03:19:48,146 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-09c02e08-48fc-42ac-b559-a0c54b1d4645-group-8B8064A6AFA8: set stopIndex = 4
2019-06-18 03:19:48,146 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-18 03:19:48,147 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerde29bfbd-02fa-42bf-941d-32f499d76d30/ratis/e4d8ef78-573a-4b8a-896e-8b8064a6afa8/sm/snapshot.1_4
2019-06-18 03:19:48,147 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645:group-8B8064A6AFA8 closes. The last applied log index is 4
2019-06-18 03:19:48,148 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 03:19:48,149 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645-RaftLogWorker close()
2019-06-18 03:19:48,150 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645: shutdown server with port 40347 now
2019-06-18 03:19:48,152 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 09c02e08-48fc-42ac-b559-a0c54b1d4645: shutdown server with port 40347 successfully
2019-06-18 03:19:48,154 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
