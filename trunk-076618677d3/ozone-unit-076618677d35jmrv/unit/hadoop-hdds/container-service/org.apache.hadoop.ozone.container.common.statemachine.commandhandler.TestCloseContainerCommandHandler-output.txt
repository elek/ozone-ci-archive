2019-06-17 23:20:36,202 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb9bdbf2e-0db0-48dc-b3bf-0809191fc7ee/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 23:20:36,207 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb9bdbf2e-0db0-48dc-b3bf-0809191fc7ee/hdds to VolumeSet
2019-06-17 23:20:36,218 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-17 23:20:36,264 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-17 23:20:36,629 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 39719
2019-06-17 23:20:37,091 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 23:20:37,119 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 23:20:37,131 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 39719 (custom)
2019-06-17 23:20:37,133 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 23:20:37,135 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 23:20:37,136 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 23:20:37,137 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 23:20:37,295 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb9bdbf2e-0db0-48dc-b3bf-0809191fc7ee/ratis] (custom)
2019-06-17 23:20:37,310 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 35223
2019-06-17 23:20:37,337 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 23:20:37,338 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 23:20:37,339 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis caa158e1-12d4-417c-9169-52c2657f5cc5 at port 39719
2019-06-17 23:20:37,353 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - caa158e1-12d4-417c-9169-52c2657f5cc5: start RPC server
2019-06-17 23:20:37,507 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - caa158e1-12d4-417c-9169-52c2657f5cc5: GrpcService started, listening on 0.0.0.0/0.0.0.0:39719
2019-06-17 23:20:37,838 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - caa158e1-12d4-417c-9169-52c2657f5cc5: addNew group-0392CF3D7F60:[caa158e1-12d4-417c-9169-52c2657f5cc5:127.0.0.1:39719] returns group-0392CF3D7F60:java.util.concurrent.CompletableFuture@2c69a941[Not completed]
2019-06-17 23:20:37,871 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - caa158e1-12d4-417c-9169-52c2657f5cc5: new RaftServerImpl for group-0392CF3D7F60:[caa158e1-12d4-417c-9169-52c2657f5cc5:127.0.0.1:39719] with ContainerStateMachine:uninitialized
2019-06-17 23:20:37,872 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 23:20:37,873 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 23:20:37,873 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 23:20:37,874 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 23:20:37,878 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - caa158e1-12d4-417c-9169-52c2657f5cc5:group-0392CF3D7F60 ConfigurationManager, init=-1: [caa158e1-12d4-417c-9169-52c2657f5cc5:127.0.0.1:39719], old=null, confs=<EMPTY_MAP>
2019-06-17 23:20:37,879 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb9bdbf2e-0db0-48dc-b3bf-0809191fc7ee/ratis] (custom)
2019-06-17 23:20:37,886 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb9bdbf2e-0db0-48dc-b3bf-0809191fc7ee/ratis/bf592a94-91d6-49ff-9bed-0392cf3d7f60 does not exist. Creating ...
2019-06-17 23:20:37,897 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb9bdbf2e-0db0-48dc-b3bf-0809191fc7ee/ratis/bf592a94-91d6-49ff-9bed-0392cf3d7f60/in_use.lock acquired by nodename 4308@ozone-unit-076618677d35jmrv-2334044359
2019-06-17 23:20:37,904 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb9bdbf2e-0db0-48dc-b3bf-0809191fc7ee/ratis/bf592a94-91d6-49ff-9bed-0392cf3d7f60 has been successfully formatted.
2019-06-17 23:20:37,906 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 23:20:37,906 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 23:20:37,908 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 23:20:37,910 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 23:20:37,912 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 23:20:37,916 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 23:20:37,918 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new caa158e1-12d4-417c-9169-52c2657f5cc5-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb9bdbf2e-0db0-48dc-b3bf-0809191fc7ee/ratis/bf592a94-91d6-49ff-9bed-0392cf3d7f60
2019-06-17 23:20:37,919 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 23:20:37,920 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 23:20:37,922 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 23:20:37,922 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 23:20:37,923 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 23:20:37,923 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 23:20:37,924 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 23:20:37,925 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 23:20:37,925 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 23:20:37,927 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 23:20:37,932 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 23:20:37,933 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 23:20:37,933 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 23:20:38,073 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - caa158e1-12d4-417c-9169-52c2657f5cc5: start group-0392CF3D7F60
2019-06-17 23:20:38,074 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - caa158e1-12d4-417c-9169-52c2657f5cc5:group-0392CF3D7F60 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 23:20:38,075 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - caa158e1-12d4-417c-9169-52c2657f5cc5: start FollowerState
2019-06-17 23:20:38,077 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-0392CF3D7F60,id=caa158e1-12d4-417c-9169-52c2657f5cc5
2019-06-17 23:20:39,168 INFO  impl.FollowerState (FollowerState.java:run(101)) - caa158e1-12d4-417c-9169-52c2657f5cc5:group-0392CF3D7F60 changes to CANDIDATE, lastRpcTime:1093, electionTimeout:1092ms
2019-06-17 23:20:39,168 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - caa158e1-12d4-417c-9169-52c2657f5cc5: shutdown FollowerState
2019-06-17 23:20:39,168 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - caa158e1-12d4-417c-9169-52c2657f5cc5:group-0392CF3D7F60 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 23:20:39,170 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - caa158e1-12d4-417c-9169-52c2657f5cc5: start LeaderElection
2019-06-17 23:20:39,173 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - caa158e1-12d4-417c-9169-52c2657f5cc5:group-0392CF3D7F60:LeaderElection1: begin an election at term 1 for -1: [caa158e1-12d4-417c-9169-52c2657f5cc5:127.0.0.1:39719], old=null
2019-06-17 23:20:39,174 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - caa158e1-12d4-417c-9169-52c2657f5cc5: shutdown LeaderElection
2019-06-17 23:20:39,175 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - caa158e1-12d4-417c-9169-52c2657f5cc5:group-0392CF3D7F60 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 23:20:39,175 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - caa158e1-12d4-417c-9169-52c2657f5cc5:group-0392CF3D7F60 change Leader from null to caa158e1-12d4-417c-9169-52c2657f5cc5 at term 1 for becomeLeader, leader elected after 1268ms
2019-06-17 23:20:39,178 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 23:20:39,179 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 23:20:39,181 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 23:20:39,181 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 23:20:39,189 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - caa158e1-12d4-417c-9169-52c2657f5cc5: start LeaderState
2019-06-17 23:20:39,201 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - caa158e1-12d4-417c-9169-52c2657f5cc5-RaftLogWorker: Starting segment from index:0
2019-06-17 23:20:39,208 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - caa158e1-12d4-417c-9169-52c2657f5cc5:group-0392CF3D7F60 set configuration 0: [caa158e1-12d4-417c-9169-52c2657f5cc5:127.0.0.1:39719], old=null at 0
2019-06-17 23:20:39,333 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - caa158e1-12d4-417c-9169-52c2657f5cc5-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb9bdbf2e-0db0-48dc-b3bf-0809191fc7ee/ratis/bf592a94-91d6-49ff-9bed-0392cf3d7f60/current/log_inprogress_0
2019-06-17 23:20:40,322 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-17 23:20:40,385 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 5118039881966107913 is closed with bcsId 0.
2019-06-17 23:20:40,386 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 23:20:40,387 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - caa158e1-12d4-417c-9169-52c2657f5cc5: close
2019-06-17 23:20:40,388 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - caa158e1-12d4-417c-9169-52c2657f5cc5: shutdown group-0392CF3D7F60
2019-06-17 23:20:40,389 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-0392CF3D7F60,id=caa158e1-12d4-417c-9169-52c2657f5cc5
2019-06-17 23:20:40,389 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - caa158e1-12d4-417c-9169-52c2657f5cc5: shutdown LeaderState
2019-06-17 23:20:40,390 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - caa158e1-12d4-417c-9169-52c2657f5cc5-PendingRequests: sendNotLeaderResponses
2019-06-17 23:20:40,392 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-caa158e1-12d4-417c-9169-52c2657f5cc5-group-0392CF3D7F60: set stopIndex = 4
2019-06-17 23:20:40,392 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 23:20:40,393 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb9bdbf2e-0db0-48dc-b3bf-0809191fc7ee/ratis/bf592a94-91d6-49ff-9bed-0392cf3d7f60/sm/snapshot.1_4
2019-06-17 23:20:40,401 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - caa158e1-12d4-417c-9169-52c2657f5cc5:group-0392CF3D7F60 closes. The last applied log index is 4
2019-06-17 23:20:40,402 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - caa158e1-12d4-417c-9169-52c2657f5cc5-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 23:20:40,403 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - caa158e1-12d4-417c-9169-52c2657f5cc5-RaftLogWorker close()
2019-06-17 23:20:40,404 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - caa158e1-12d4-417c-9169-52c2657f5cc5: shutdown server with port 39719 now
2019-06-17 23:20:40,407 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - caa158e1-12d4-417c-9169-52c2657f5cc5: shutdown server with port 39719 successfully
2019-06-17 23:20:40,418 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 23:20:40,448 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercadcdd0f-1db1-4b91-9b5b-311b508c3344/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 23:20:40,448 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercadcdd0f-1db1-4b91-9b5b-311b508c3344/hdds to VolumeSet
2019-06-17 23:20:40,448 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3a2b2322
2019-06-17 23:20:40,449 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3a2b2322
2019-06-17 23:20:40,461 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 42673
2019-06-17 23:20:40,462 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 23:20:40,462 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 23:20:40,462 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42673 (custom)
2019-06-17 23:20:40,463 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 23:20:40,463 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 23:20:40,463 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 23:20:40,463 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 23:20:40,464 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercadcdd0f-1db1-4b91-9b5b-311b508c3344/ratis] (custom)
2019-06-17 23:20:40,465 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 45263
2019-06-17 23:20:40,465 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 23:20:40,465 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 23:20:40,465 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 603afe80-dd61-4d8d-b03d-67a606b8f8ca at port 42673
2019-06-17 23:20:40,496 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca: start RPC server
2019-06-17 23:20:40,497 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca: GrpcService started, listening on 0.0.0.0/0.0.0.0:42673
2019-06-17 23:20:40,513 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca: addNew group-A68F96B51D9A:[603afe80-dd61-4d8d-b03d-67a606b8f8ca:127.0.0.1:42673] returns group-A68F96B51D9A:java.util.concurrent.CompletableFuture@59488b08[Not completed]
2019-06-17 23:20:40,518 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca: new RaftServerImpl for group-A68F96B51D9A:[603afe80-dd61-4d8d-b03d-67a606b8f8ca:127.0.0.1:42673] with ContainerStateMachine:uninitialized
2019-06-17 23:20:40,518 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 23:20:40,518 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 23:20:40,518 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 23:20:40,518 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 23:20:40,519 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca:group-A68F96B51D9A ConfigurationManager, init=-1: [603afe80-dd61-4d8d-b03d-67a606b8f8ca:127.0.0.1:42673], old=null, confs=<EMPTY_MAP>
2019-06-17 23:20:40,519 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercadcdd0f-1db1-4b91-9b5b-311b508c3344/ratis] (custom)
2019-06-17 23:20:40,519 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercadcdd0f-1db1-4b91-9b5b-311b508c3344/ratis/363c5860-16ab-4202-aa09-a68f96b51d9a does not exist. Creating ...
2019-06-17 23:20:40,522 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercadcdd0f-1db1-4b91-9b5b-311b508c3344/ratis/363c5860-16ab-4202-aa09-a68f96b51d9a/in_use.lock acquired by nodename 4308@ozone-unit-076618677d35jmrv-2334044359
2019-06-17 23:20:40,525 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercadcdd0f-1db1-4b91-9b5b-311b508c3344/ratis/363c5860-16ab-4202-aa09-a68f96b51d9a has been successfully formatted.
2019-06-17 23:20:40,525 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 23:20:40,525 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 23:20:40,525 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 23:20:40,525 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 23:20:40,529 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 23:20:40,530 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 23:20:40,530 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 603afe80-dd61-4d8d-b03d-67a606b8f8ca-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercadcdd0f-1db1-4b91-9b5b-311b508c3344/ratis/363c5860-16ab-4202-aa09-a68f96b51d9a
2019-06-17 23:20:40,530 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 23:20:40,530 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 23:20:40,530 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 23:20:40,530 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 23:20:40,531 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 23:20:40,531 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 23:20:40,531 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 23:20:40,531 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 23:20:40,531 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 23:20:40,531 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 23:20:40,532 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 23:20:40,532 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 23:20:40,532 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 23:20:40,533 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca: start group-A68F96B51D9A
2019-06-17 23:20:40,533 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca:group-A68F96B51D9A changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 23:20:40,533 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca: start FollowerState
2019-06-17 23:20:40,533 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-A68F96B51D9A,id=603afe80-dd61-4d8d-b03d-67a606b8f8ca
2019-06-17 23:20:41,694 INFO  impl.FollowerState (FollowerState.java:run(101)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca:group-A68F96B51D9A changes to CANDIDATE, lastRpcTime:1161, electionTimeout:1161ms
2019-06-17 23:20:41,694 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca: shutdown FollowerState
2019-06-17 23:20:41,695 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca:group-A68F96B51D9A changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 23:20:41,695 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca: start LeaderElection
2019-06-17 23:20:41,700 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca:group-A68F96B51D9A:LeaderElection2: begin an election at term 1 for -1: [603afe80-dd61-4d8d-b03d-67a606b8f8ca:127.0.0.1:42673], old=null
2019-06-17 23:20:41,700 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca: shutdown LeaderElection
2019-06-17 23:20:41,700 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca:group-A68F96B51D9A changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 23:20:41,700 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca:group-A68F96B51D9A change Leader from null to 603afe80-dd61-4d8d-b03d-67a606b8f8ca at term 1 for becomeLeader, leader elected after 1175ms
2019-06-17 23:20:41,701 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 23:20:41,701 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 23:20:41,701 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 23:20:41,701 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 23:20:41,701 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca: start LeaderState
2019-06-17 23:20:41,702 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca-RaftLogWorker: Starting segment from index:0
2019-06-17 23:20:41,706 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca:group-A68F96B51D9A set configuration 0: [603afe80-dd61-4d8d-b03d-67a606b8f8ca:127.0.0.1:42673], old=null at 0
2019-06-17 23:20:41,741 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercadcdd0f-1db1-4b91-9b5b-311b508c3344/ratis/363c5860-16ab-4202-aa09-a68f96b51d9a/current/log_inprogress_0
2019-06-17 23:20:42,574 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 23:20:42,578 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca: close
2019-06-17 23:20:42,578 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca: shutdown group-A68F96B51D9A
2019-06-17 23:20:42,579 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-A68F96B51D9A,id=603afe80-dd61-4d8d-b03d-67a606b8f8ca
2019-06-17 23:20:42,579 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca: shutdown LeaderState
2019-06-17 23:20:42,580 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca-PendingRequests: sendNotLeaderResponses
2019-06-17 23:20:42,581 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 23:20:42,582 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercadcdd0f-1db1-4b91-9b5b-311b508c3344/ratis/363c5860-16ab-4202-aa09-a68f96b51d9a/sm/snapshot.1_2
2019-06-17 23:20:42,582 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-603afe80-dd61-4d8d-b03d-67a606b8f8ca-group-A68F96B51D9A: set stopIndex = 2
2019-06-17 23:20:42,583 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca:group-A68F96B51D9A closes. The last applied log index is 2
2019-06-17 23:20:42,583 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 23:20:42,585 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca-RaftLogWorker close()
2019-06-17 23:20:42,586 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca: shutdown server with port 42673 now
2019-06-17 23:20:42,588 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 603afe80-dd61-4d8d-b03d-67a606b8f8ca: shutdown server with port 42673 successfully
2019-06-17 23:20:42,596 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 23:20:42,638 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler77ff76a4-b85a-4f17-9edb-61e6e32fd5c6/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 23:20:42,638 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler77ff76a4-b85a-4f17-9edb-61e6e32fd5c6/hdds to VolumeSet
2019-06-17 23:20:42,638 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@26a2f7f9
2019-06-17 23:20:42,639 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@26a2f7f9
2019-06-17 23:20:42,653 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 38301
2019-06-17 23:20:42,654 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 23:20:42,655 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 23:20:42,656 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 38301 (custom)
2019-06-17 23:20:42,656 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 23:20:42,656 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 23:20:42,656 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 23:20:42,657 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 23:20:42,658 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler77ff76a4-b85a-4f17-9edb-61e6e32fd5c6/ratis] (custom)
2019-06-17 23:20:42,658 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42665
2019-06-17 23:20:42,659 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 23:20:42,659 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 23:20:42,659 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis b7291365-56b8-4d53-bdc0-4024d875833c at port 38301
2019-06-17 23:20:42,668 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - b7291365-56b8-4d53-bdc0-4024d875833c: start RPC server
2019-06-17 23:20:42,670 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - b7291365-56b8-4d53-bdc0-4024d875833c: GrpcService started, listening on 0.0.0.0/0.0.0.0:38301
2019-06-17 23:20:42,679 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - b7291365-56b8-4d53-bdc0-4024d875833c: addNew group-2B8EBF550746:[b7291365-56b8-4d53-bdc0-4024d875833c:127.0.0.1:38301] returns group-2B8EBF550746:java.util.concurrent.CompletableFuture@141dd21b[Not completed]
2019-06-17 23:20:42,679 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - b7291365-56b8-4d53-bdc0-4024d875833c: new RaftServerImpl for group-2B8EBF550746:[b7291365-56b8-4d53-bdc0-4024d875833c:127.0.0.1:38301] with ContainerStateMachine:uninitialized
2019-06-17 23:20:42,681 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 23:20:42,681 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 23:20:42,681 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 23:20:42,681 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 23:20:42,681 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - b7291365-56b8-4d53-bdc0-4024d875833c:group-2B8EBF550746 ConfigurationManager, init=-1: [b7291365-56b8-4d53-bdc0-4024d875833c:127.0.0.1:38301], old=null, confs=<EMPTY_MAP>
2019-06-17 23:20:42,681 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler77ff76a4-b85a-4f17-9edb-61e6e32fd5c6/ratis] (custom)
2019-06-17 23:20:42,682 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler77ff76a4-b85a-4f17-9edb-61e6e32fd5c6/ratis/c119396a-1a3b-408b-8b50-2b8ebf550746 does not exist. Creating ...
2019-06-17 23:20:42,685 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler77ff76a4-b85a-4f17-9edb-61e6e32fd5c6/ratis/c119396a-1a3b-408b-8b50-2b8ebf550746/in_use.lock acquired by nodename 4308@ozone-unit-076618677d35jmrv-2334044359
2019-06-17 23:20:42,687 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler77ff76a4-b85a-4f17-9edb-61e6e32fd5c6/ratis/c119396a-1a3b-408b-8b50-2b8ebf550746 has been successfully formatted.
2019-06-17 23:20:42,688 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 23:20:42,688 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 23:20:42,688 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 23:20:42,688 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 23:20:42,688 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 23:20:42,688 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 23:20:42,688 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new b7291365-56b8-4d53-bdc0-4024d875833c-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler77ff76a4-b85a-4f17-9edb-61e6e32fd5c6/ratis/c119396a-1a3b-408b-8b50-2b8ebf550746
2019-06-17 23:20:42,688 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 23:20:42,688 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 23:20:42,689 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 23:20:42,689 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 23:20:42,689 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 23:20:42,689 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 23:20:42,689 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 23:20:42,689 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 23:20:42,689 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 23:20:42,690 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 23:20:42,690 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 23:20:42,690 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 23:20:42,690 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 23:20:42,691 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - b7291365-56b8-4d53-bdc0-4024d875833c: start group-2B8EBF550746
2019-06-17 23:20:42,691 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b7291365-56b8-4d53-bdc0-4024d875833c:group-2B8EBF550746 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 23:20:42,691 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b7291365-56b8-4d53-bdc0-4024d875833c: start FollowerState
2019-06-17 23:20:42,691 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-2B8EBF550746,id=b7291365-56b8-4d53-bdc0-4024d875833c
2019-06-17 23:20:43,758 INFO  impl.FollowerState (FollowerState.java:run(101)) - b7291365-56b8-4d53-bdc0-4024d875833c:group-2B8EBF550746 changes to CANDIDATE, lastRpcTime:1067, electionTimeout:1067ms
2019-06-17 23:20:43,758 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b7291365-56b8-4d53-bdc0-4024d875833c: shutdown FollowerState
2019-06-17 23:20:43,758 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b7291365-56b8-4d53-bdc0-4024d875833c:group-2B8EBF550746 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 23:20:43,759 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b7291365-56b8-4d53-bdc0-4024d875833c: start LeaderElection
2019-06-17 23:20:43,763 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b7291365-56b8-4d53-bdc0-4024d875833c:group-2B8EBF550746:LeaderElection3: begin an election at term 1 for -1: [b7291365-56b8-4d53-bdc0-4024d875833c:127.0.0.1:38301], old=null
2019-06-17 23:20:43,764 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b7291365-56b8-4d53-bdc0-4024d875833c: shutdown LeaderElection
2019-06-17 23:20:43,764 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b7291365-56b8-4d53-bdc0-4024d875833c:group-2B8EBF550746 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 23:20:43,764 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - b7291365-56b8-4d53-bdc0-4024d875833c:group-2B8EBF550746 change Leader from null to b7291365-56b8-4d53-bdc0-4024d875833c at term 1 for becomeLeader, leader elected after 1075ms
2019-06-17 23:20:43,764 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 23:20:43,764 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 23:20:43,764 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 23:20:43,764 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 23:20:43,764 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b7291365-56b8-4d53-bdc0-4024d875833c: start LeaderState
2019-06-17 23:20:43,765 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - b7291365-56b8-4d53-bdc0-4024d875833c-RaftLogWorker: Starting segment from index:0
2019-06-17 23:20:43,767 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - b7291365-56b8-4d53-bdc0-4024d875833c:group-2B8EBF550746 set configuration 0: [b7291365-56b8-4d53-bdc0-4024d875833c:127.0.0.1:38301], old=null at 0
2019-06-17 23:20:43,801 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - b7291365-56b8-4d53-bdc0-4024d875833c-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler77ff76a4-b85a-4f17-9edb-61e6e32fd5c6/ratis/c119396a-1a3b-408b-8b50-2b8ebf550746/current/log_inprogress_0
2019-06-17 23:20:44,737 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 1556908599056021276 is closed with bcsId 0.
2019-06-17 23:20:44,738 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 23:20:44,738 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - b7291365-56b8-4d53-bdc0-4024d875833c: close
2019-06-17 23:20:44,739 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - b7291365-56b8-4d53-bdc0-4024d875833c: shutdown group-2B8EBF550746
2019-06-17 23:20:44,739 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-2B8EBF550746,id=b7291365-56b8-4d53-bdc0-4024d875833c
2019-06-17 23:20:44,739 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - b7291365-56b8-4d53-bdc0-4024d875833c: shutdown LeaderState
2019-06-17 23:20:44,740 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - b7291365-56b8-4d53-bdc0-4024d875833c-PendingRequests: sendNotLeaderResponses
2019-06-17 23:20:44,740 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-b7291365-56b8-4d53-bdc0-4024d875833c-group-2B8EBF550746: set stopIndex = 2
2019-06-17 23:20:44,740 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 23:20:44,741 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler77ff76a4-b85a-4f17-9edb-61e6e32fd5c6/ratis/c119396a-1a3b-408b-8b50-2b8ebf550746/sm/snapshot.1_2
2019-06-17 23:20:44,741 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - b7291365-56b8-4d53-bdc0-4024d875833c:group-2B8EBF550746 closes. The last applied log index is 2
2019-06-17 23:20:44,742 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - b7291365-56b8-4d53-bdc0-4024d875833c-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 23:20:44,742 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - b7291365-56b8-4d53-bdc0-4024d875833c-RaftLogWorker close()
2019-06-17 23:20:44,743 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - b7291365-56b8-4d53-bdc0-4024d875833c: shutdown server with port 38301 now
2019-06-17 23:20:44,744 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - b7291365-56b8-4d53-bdc0-4024d875833c: shutdown server with port 38301 successfully
2019-06-17 23:20:44,749 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 23:20:44,790 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4eaa12d4-a957-4fe9-8bd0-e676038c9298/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 23:20:44,790 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4eaa12d4-a957-4fe9-8bd0-e676038c9298/hdds to VolumeSet
2019-06-17 23:20:44,790 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@66153688
2019-06-17 23:20:44,791 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@66153688
2019-06-17 23:20:44,799 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 36057
2019-06-17 23:20:44,800 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 23:20:44,801 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 23:20:44,801 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 36057 (custom)
2019-06-17 23:20:44,801 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 23:20:44,802 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 23:20:44,802 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 23:20:44,802 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 23:20:44,802 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4eaa12d4-a957-4fe9-8bd0-e676038c9298/ratis] (custom)
2019-06-17 23:20:44,803 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 45817
2019-06-17 23:20:44,803 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 23:20:44,803 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 23:20:44,803 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis d969c932-fcdd-4d6f-bf9e-a98e81862cb9 at port 36057
2019-06-17 23:20:44,813 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9: start RPC server
2019-06-17 23:20:44,820 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9: GrpcService started, listening on 0.0.0.0/0.0.0.0:36057
Jun 17, 2019 11:20:44 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:42673} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 17, 2019 11:20:44 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:38301} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-17 23:20:44,841 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9: addNew group-C39BB486FB4E:[d969c932-fcdd-4d6f-bf9e-a98e81862cb9:127.0.0.1:36057] returns group-C39BB486FB4E:java.util.concurrent.CompletableFuture@6eaf626[Not completed]
2019-06-17 23:20:44,842 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9: new RaftServerImpl for group-C39BB486FB4E:[d969c932-fcdd-4d6f-bf9e-a98e81862cb9:127.0.0.1:36057] with ContainerStateMachine:uninitialized
2019-06-17 23:20:44,842 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 23:20:44,842 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 23:20:44,842 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 23:20:44,843 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 23:20:44,843 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9:group-C39BB486FB4E ConfigurationManager, init=-1: [d969c932-fcdd-4d6f-bf9e-a98e81862cb9:127.0.0.1:36057], old=null, confs=<EMPTY_MAP>
2019-06-17 23:20:44,843 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4eaa12d4-a957-4fe9-8bd0-e676038c9298/ratis] (custom)
2019-06-17 23:20:44,843 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4eaa12d4-a957-4fe9-8bd0-e676038c9298/ratis/6a637856-7710-4933-8178-c39bb486fb4e does not exist. Creating ...
2019-06-17 23:20:44,847 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4eaa12d4-a957-4fe9-8bd0-e676038c9298/ratis/6a637856-7710-4933-8178-c39bb486fb4e/in_use.lock acquired by nodename 4308@ozone-unit-076618677d35jmrv-2334044359
2019-06-17 23:20:44,849 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4eaa12d4-a957-4fe9-8bd0-e676038c9298/ratis/6a637856-7710-4933-8178-c39bb486fb4e has been successfully formatted.
2019-06-17 23:20:44,849 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 23:20:44,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 23:20:44,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 23:20:44,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 23:20:44,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 23:20:44,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 23:20:44,850 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new d969c932-fcdd-4d6f-bf9e-a98e81862cb9-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4eaa12d4-a957-4fe9-8bd0-e676038c9298/ratis/6a637856-7710-4933-8178-c39bb486fb4e
2019-06-17 23:20:44,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 23:20:44,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 23:20:44,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 23:20:44,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 23:20:44,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 23:20:44,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 23:20:44,850 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 23:20:44,851 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 23:20:44,851 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 23:20:44,851 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 23:20:44,851 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 23:20:44,851 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 23:20:44,851 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 23:20:44,852 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9: start group-C39BB486FB4E
2019-06-17 23:20:44,852 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9:group-C39BB486FB4E changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 23:20:44,852 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9: start FollowerState
2019-06-17 23:20:44,852 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C39BB486FB4E,id=d969c932-fcdd-4d6f-bf9e-a98e81862cb9
2019-06-17 23:20:46,026 INFO  impl.FollowerState (FollowerState.java:run(101)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9:group-C39BB486FB4E changes to CANDIDATE, lastRpcTime:1174, electionTimeout:1174ms
2019-06-17 23:20:46,026 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9: shutdown FollowerState
2019-06-17 23:20:46,026 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9:group-C39BB486FB4E changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 23:20:46,026 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9: start LeaderElection
2019-06-17 23:20:46,031 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9:group-C39BB486FB4E:LeaderElection4: begin an election at term 1 for -1: [d969c932-fcdd-4d6f-bf9e-a98e81862cb9:127.0.0.1:36057], old=null
2019-06-17 23:20:46,031 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9: shutdown LeaderElection
2019-06-17 23:20:46,031 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9:group-C39BB486FB4E changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 23:20:46,032 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9:group-C39BB486FB4E change Leader from null to d969c932-fcdd-4d6f-bf9e-a98e81862cb9 at term 1 for becomeLeader, leader elected after 1182ms
2019-06-17 23:20:46,032 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 23:20:46,032 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 23:20:46,032 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 23:20:46,032 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 23:20:46,032 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9: start LeaderState
2019-06-17 23:20:46,032 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9-RaftLogWorker: Starting segment from index:0
2019-06-17 23:20:46,033 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9:group-C39BB486FB4E set configuration 0: [d969c932-fcdd-4d6f-bf9e-a98e81862cb9:127.0.0.1:36057], old=null at 0
2019-06-17 23:20:46,071 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4eaa12d4-a957-4fe9-8bd0-e676038c9298/ratis/6a637856-7710-4933-8178-c39bb486fb4e/current/log_inprogress_0
2019-06-17 23:20:46,896 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 5708262511567530598 is closed with bcsId 0.
2019-06-17 23:20:46,896 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 23:20:46,897 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9: close
2019-06-17 23:20:46,897 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9: shutdown group-C39BB486FB4E
2019-06-17 23:20:46,897 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C39BB486FB4E,id=d969c932-fcdd-4d6f-bf9e-a98e81862cb9
2019-06-17 23:20:46,897 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9: shutdown LeaderState
2019-06-17 23:20:46,898 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9-PendingRequests: sendNotLeaderResponses
2019-06-17 23:20:46,899 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-d969c932-fcdd-4d6f-bf9e-a98e81862cb9-group-C39BB486FB4E: set stopIndex = 2
2019-06-17 23:20:46,899 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 23:20:46,899 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4eaa12d4-a957-4fe9-8bd0-e676038c9298/ratis/6a637856-7710-4933-8178-c39bb486fb4e/sm/snapshot.1_2
2019-06-17 23:20:46,899 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9:group-C39BB486FB4E closes. The last applied log index is 2
2019-06-17 23:20:46,900 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 23:20:46,900 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9-RaftLogWorker close()
2019-06-17 23:20:46,901 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9: shutdown server with port 36057 now
2019-06-17 23:20:46,902 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - d969c932-fcdd-4d6f-bf9e-a98e81862cb9: shutdown server with port 36057 successfully
2019-06-17 23:20:46,905 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 23:20:46,927 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1ce3244c-8b72-4411-8a6f-93a1fd9321d0/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 23:20:46,928 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1ce3244c-8b72-4411-8a6f-93a1fd9321d0/hdds to VolumeSet
2019-06-17 23:20:46,928 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@68217d41
2019-06-17 23:20:46,930 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@68217d41
2019-06-17 23:20:46,939 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43995
2019-06-17 23:20:46,939 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 23:20:46,940 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 23:20:46,940 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43995 (custom)
2019-06-17 23:20:46,940 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 23:20:46,940 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 23:20:46,941 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 23:20:46,941 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 23:20:46,941 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1ce3244c-8b72-4411-8a6f-93a1fd9321d0/ratis] (custom)
2019-06-17 23:20:46,941 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 35569
2019-06-17 23:20:46,942 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 23:20:46,942 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 23:20:46,942 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis f82435f2-0f01-4463-804e-6417fe1184af at port 43995
2019-06-17 23:20:46,956 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - f82435f2-0f01-4463-804e-6417fe1184af: start RPC server
2019-06-17 23:20:46,958 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - f82435f2-0f01-4463-804e-6417fe1184af: GrpcService started, listening on 0.0.0.0/0.0.0.0:43995
2019-06-17 23:20:46,968 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - f82435f2-0f01-4463-804e-6417fe1184af: addNew group-152693766474:[f82435f2-0f01-4463-804e-6417fe1184af:127.0.0.1:43995] returns group-152693766474:java.util.concurrent.CompletableFuture@1dfc30d3[Not completed]
2019-06-17 23:20:46,969 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - f82435f2-0f01-4463-804e-6417fe1184af: new RaftServerImpl for group-152693766474:[f82435f2-0f01-4463-804e-6417fe1184af:127.0.0.1:43995] with ContainerStateMachine:uninitialized
2019-06-17 23:20:46,969 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 23:20:46,970 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 23:20:46,970 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 23:20:46,970 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 23:20:46,970 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - f82435f2-0f01-4463-804e-6417fe1184af:group-152693766474 ConfigurationManager, init=-1: [f82435f2-0f01-4463-804e-6417fe1184af:127.0.0.1:43995], old=null, confs=<EMPTY_MAP>
2019-06-17 23:20:46,970 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1ce3244c-8b72-4411-8a6f-93a1fd9321d0/ratis] (custom)
2019-06-17 23:20:46,970 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1ce3244c-8b72-4411-8a6f-93a1fd9321d0/ratis/fc2e6360-4a41-416e-868c-152693766474 does not exist. Creating ...
2019-06-17 23:20:46,973 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1ce3244c-8b72-4411-8a6f-93a1fd9321d0/ratis/fc2e6360-4a41-416e-868c-152693766474/in_use.lock acquired by nodename 4308@ozone-unit-076618677d35jmrv-2334044359
2019-06-17 23:20:46,976 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1ce3244c-8b72-4411-8a6f-93a1fd9321d0/ratis/fc2e6360-4a41-416e-868c-152693766474 has been successfully formatted.
2019-06-17 23:20:46,976 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 23:20:46,976 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 23:20:46,976 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 23:20:46,976 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 23:20:46,976 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 23:20:46,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 23:20:46,977 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new f82435f2-0f01-4463-804e-6417fe1184af-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1ce3244c-8b72-4411-8a6f-93a1fd9321d0/ratis/fc2e6360-4a41-416e-868c-152693766474
2019-06-17 23:20:46,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 23:20:46,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 23:20:46,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 23:20:46,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 23:20:46,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 23:20:46,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 23:20:46,978 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 23:20:46,978 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 23:20:46,978 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 23:20:46,978 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 23:20:46,978 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 23:20:46,979 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 23:20:46,979 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 23:20:46,979 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - f82435f2-0f01-4463-804e-6417fe1184af: start group-152693766474
2019-06-17 23:20:46,979 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f82435f2-0f01-4463-804e-6417fe1184af:group-152693766474 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 23:20:46,979 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f82435f2-0f01-4463-804e-6417fe1184af: start FollowerState
2019-06-17 23:20:46,980 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-152693766474,id=f82435f2-0f01-4463-804e-6417fe1184af
2019-06-17 23:20:48,128 INFO  impl.FollowerState (FollowerState.java:run(101)) - f82435f2-0f01-4463-804e-6417fe1184af:group-152693766474 changes to CANDIDATE, lastRpcTime:1148, electionTimeout:1148ms
2019-06-17 23:20:48,128 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - f82435f2-0f01-4463-804e-6417fe1184af: shutdown FollowerState
2019-06-17 23:20:48,128 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f82435f2-0f01-4463-804e-6417fe1184af:group-152693766474 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 23:20:48,128 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f82435f2-0f01-4463-804e-6417fe1184af: start LeaderElection
2019-06-17 23:20:48,132 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - f82435f2-0f01-4463-804e-6417fe1184af:group-152693766474:LeaderElection5: begin an election at term 1 for -1: [f82435f2-0f01-4463-804e-6417fe1184af:127.0.0.1:43995], old=null
2019-06-17 23:20:48,132 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - f82435f2-0f01-4463-804e-6417fe1184af: shutdown LeaderElection
2019-06-17 23:20:48,132 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f82435f2-0f01-4463-804e-6417fe1184af:group-152693766474 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 23:20:48,132 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - f82435f2-0f01-4463-804e-6417fe1184af:group-152693766474 change Leader from null to f82435f2-0f01-4463-804e-6417fe1184af at term 1 for becomeLeader, leader elected after 1155ms
2019-06-17 23:20:48,132 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 23:20:48,132 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 23:20:48,132 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 23:20:48,132 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 23:20:48,132 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f82435f2-0f01-4463-804e-6417fe1184af: start LeaderState
2019-06-17 23:20:48,133 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - f82435f2-0f01-4463-804e-6417fe1184af-RaftLogWorker: Starting segment from index:0
2019-06-17 23:20:48,135 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - f82435f2-0f01-4463-804e-6417fe1184af:group-152693766474 set configuration 0: [f82435f2-0f01-4463-804e-6417fe1184af:127.0.0.1:43995], old=null at 0
2019-06-17 23:20:48,172 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - f82435f2-0f01-4463-804e-6417fe1184af-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1ce3244c-8b72-4411-8a6f-93a1fd9321d0/ratis/fc2e6360-4a41-416e-868c-152693766474/current/log_inprogress_0
2019-06-17 23:20:49,026 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 4690941207998630225 is closed with bcsId 0.
2019-06-17 23:20:49,027 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 23:20:49,027 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - f82435f2-0f01-4463-804e-6417fe1184af: close
2019-06-17 23:20:49,027 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - f82435f2-0f01-4463-804e-6417fe1184af: shutdown group-152693766474
2019-06-17 23:20:49,027 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-152693766474,id=f82435f2-0f01-4463-804e-6417fe1184af
2019-06-17 23:20:49,028 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - f82435f2-0f01-4463-804e-6417fe1184af: shutdown LeaderState
2019-06-17 23:20:49,028 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - f82435f2-0f01-4463-804e-6417fe1184af-PendingRequests: sendNotLeaderResponses
2019-06-17 23:20:49,029 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-f82435f2-0f01-4463-804e-6417fe1184af-group-152693766474: set stopIndex = 4
2019-06-17 23:20:49,029 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 23:20:49,029 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1ce3244c-8b72-4411-8a6f-93a1fd9321d0/ratis/fc2e6360-4a41-416e-868c-152693766474/sm/snapshot.1_4
2019-06-17 23:20:49,030 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - f82435f2-0f01-4463-804e-6417fe1184af:group-152693766474 closes. The last applied log index is 4
2019-06-17 23:20:49,030 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - f82435f2-0f01-4463-804e-6417fe1184af-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 23:20:49,031 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - f82435f2-0f01-4463-804e-6417fe1184af-RaftLogWorker close()
2019-06-17 23:20:49,031 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - f82435f2-0f01-4463-804e-6417fe1184af: shutdown server with port 43995 now
2019-06-17 23:20:49,032 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - f82435f2-0f01-4463-804e-6417fe1184af: shutdown server with port 43995 successfully
2019-06-17 23:20:49,033 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
