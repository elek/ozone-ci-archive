2019-06-15 08:30:57,928 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-15 08:30:58,024 INFO  ozone.RatisTestHelper (RatisTestHelper.java:initRatisConf(109)) - dfs.container.ratis.rpc.type = GRPC
2019-06-15 08:30:58,091 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-15 08:30:58,101 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 36657 (custom)
2019-06-15 08:30:58,102 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-15 08:30:58,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 08:30:58,105 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-15 08:30:58,106 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-15 08:30:58,156 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d4214172-1154-4d65-8c72-9ea3dee7063a] (custom)
2019-06-15 08:30:58,161 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis d4214172-1154-4d65-8c72-9ea3dee7063a at port 36657
2019-06-15 08:30:58,197 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - d4214172-1154-4d65-8c72-9ea3dee7063a: start RPC server
2019-06-15 08:30:58,201 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - d4214172-1154-4d65-8c72-9ea3dee7063a: GrpcService started, listening on 0.0.0.0/0.0.0.0:36657
2019-06-15 08:30:58,272 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - d4214172-1154-4d65-8c72-9ea3dee7063a: addNew group-73167082ACC2:[d4214172-1154-4d65-8c72-9ea3dee7063a:0.0.0.0:36657] returns group-73167082ACC2:java.util.concurrent.CompletableFuture@246d8830[Not completed]
2019-06-15 08:30:58,277 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - d4214172-1154-4d65-8c72-9ea3dee7063a: new RaftServerImpl for group-73167082ACC2:[d4214172-1154-4d65-8c72-9ea3dee7063a:0.0.0.0:36657] with ContainerStateMachine:uninitialized
2019-06-15 08:30:58,278 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-15 08:30:58,278 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-15 08:30:58,279 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-15 08:30:58,280 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-15 08:30:58,283 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - d4214172-1154-4d65-8c72-9ea3dee7063a:group-73167082ACC2 ConfigurationManager, init=-1: [d4214172-1154-4d65-8c72-9ea3dee7063a:0.0.0.0:36657], old=null, confs=<EMPTY_MAP>
2019-06-15 08:30:58,284 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d4214172-1154-4d65-8c72-9ea3dee7063a] (custom)
2019-06-15 08:30:58,288 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d4214172-1154-4d65-8c72-9ea3dee7063a/832ff9df-eb8a-4375-9799-73167082acc2 does not exist. Creating ...
2019-06-15 08:30:58,296 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d4214172-1154-4d65-8c72-9ea3dee7063a/832ff9df-eb8a-4375-9799-73167082acc2/in_use.lock acquired by nodename 26653@ozone-unit-076618677d3-xbqfw-572796842
2019-06-15 08:30:58,302 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d4214172-1154-4d65-8c72-9ea3dee7063a/832ff9df-eb8a-4375-9799-73167082acc2 has been successfully formatted.
2019-06-15 08:30:58,303 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-15 08:30:58,304 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-15 08:30:58,305 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-15 08:30:58,307 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 08:30:58,309 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 08:30:58,311 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-15 08:30:58,314 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new d4214172-1154-4d65-8c72-9ea3dee7063a-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d4214172-1154-4d65-8c72-9ea3dee7063a/832ff9df-eb8a-4375-9799-73167082acc2
2019-06-15 08:30:58,314 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-15 08:30:58,314 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-15 08:30:58,316 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 08:30:58,316 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-15 08:30:58,317 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-15 08:30:58,317 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-15 08:30:58,318 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-15 08:30:58,318 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-15 08:30:58,319 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-15 08:30:58,321 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-15 08:30:58,325 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-15 08:30:58,326 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-15 08:30:58,326 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-15 08:30:58,339 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - d4214172-1154-4d65-8c72-9ea3dee7063a: start group-73167082ACC2
2019-06-15 08:30:58,339 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d4214172-1154-4d65-8c72-9ea3dee7063a:group-73167082ACC2 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-15 08:30:58,340 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d4214172-1154-4d65-8c72-9ea3dee7063a: start FollowerState
2019-06-15 08:30:58,385 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-73167082ACC2,id=d4214172-1154-4d65-8c72-9ea3dee7063a
2019-06-15 08:30:58,437 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-40DCE6D7AC23->d4214172-1154-4d65-8c72-9ea3dee7063a: receive RaftClientReply:client-40DCE6D7AC23->d4214172-1154-4d65-8c72-9ea3dee7063a@group-73167082ACC2, cid=1, FAILED org.apache.ratis.protocol.NotLeaderException: Server d4214172-1154-4d65-8c72-9ea3dee7063a is not the leader (null). Request must be sent to leader., logIndex=0, commits[d4214172-1154-4d65-8c72-9ea3dee7063a:c-1]
2019-06-15 08:30:59,444 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-40DCE6D7AC23->d4214172-1154-4d65-8c72-9ea3dee7063a: receive RaftClientReply:client-40DCE6D7AC23->d4214172-1154-4d65-8c72-9ea3dee7063a@group-73167082ACC2, cid=1, FAILED org.apache.ratis.protocol.NotLeaderException: Server d4214172-1154-4d65-8c72-9ea3dee7063a is not the leader (null). Request must be sent to leader., logIndex=0, commits[d4214172-1154-4d65-8c72-9ea3dee7063a:c-1]
2019-06-15 08:30:59,505 INFO  impl.FollowerState (FollowerState.java:run(101)) - d4214172-1154-4d65-8c72-9ea3dee7063a:group-73167082ACC2 changes to CANDIDATE, lastRpcTime:1164, electionTimeout:1164ms
2019-06-15 08:30:59,505 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d4214172-1154-4d65-8c72-9ea3dee7063a: shutdown FollowerState
2019-06-15 08:30:59,505 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d4214172-1154-4d65-8c72-9ea3dee7063a:group-73167082ACC2 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-15 08:30:59,506 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d4214172-1154-4d65-8c72-9ea3dee7063a: start LeaderElection
2019-06-15 08:30:59,509 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - d4214172-1154-4d65-8c72-9ea3dee7063a:group-73167082ACC2:LeaderElection1: begin an election at term 1 for -1: [d4214172-1154-4d65-8c72-9ea3dee7063a:0.0.0.0:36657], old=null
2019-06-15 08:30:59,510 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - d4214172-1154-4d65-8c72-9ea3dee7063a: shutdown LeaderElection
2019-06-15 08:30:59,510 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d4214172-1154-4d65-8c72-9ea3dee7063a:group-73167082ACC2 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-15 08:30:59,510 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - d4214172-1154-4d65-8c72-9ea3dee7063a:group-73167082ACC2 change Leader from null to d4214172-1154-4d65-8c72-9ea3dee7063a at term 1 for becomeLeader, leader elected after 1206ms
2019-06-15 08:30:59,514 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-15 08:30:59,514 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-15 08:30:59,516 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-15 08:30:59,516 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-15 08:30:59,522 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d4214172-1154-4d65-8c72-9ea3dee7063a: start LeaderState
2019-06-15 08:30:59,532 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - d4214172-1154-4d65-8c72-9ea3dee7063a-RaftLogWorker: Starting segment from index:0
2019-06-15 08:30:59,539 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - d4214172-1154-4d65-8c72-9ea3dee7063a:group-73167082ACC2 set configuration 0: [d4214172-1154-4d65-8c72-9ea3dee7063a:0.0.0.0:36657], old=null at 0
2019-06-15 08:30:59,658 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - d4214172-1154-4d65-8c72-9ea3dee7063a-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d4214172-1154-4d65-8c72-9ea3dee7063a/832ff9df-eb8a-4375-9799-73167082acc2/current/log_inprogress_0
2019-06-15 08:31:00,459 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-15 08:31:00,463 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-40DCE6D7AC23->d4214172-1154-4d65-8c72-9ea3dee7063a: receive RaftClientReply:client-40DCE6D7AC23->d4214172-1154-4d65-8c72-9ea3dee7063a@group-73167082ACC2, cid=1, SUCCESS, logIndex=1, commits[d4214172-1154-4d65-8c72-9ea3dee7063a:c1]
2019-06-15 08:31:00,465 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-15 08:31:00,479 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-434D4F0A8383->d4214172-1154-4d65-8c72-9ea3dee7063a: receive RaftClientReply:client-434D4F0A8383->d4214172-1154-4d65-8c72-9ea3dee7063a@group-73167082ACC2, cid=2, SUCCESS, logIndex=3, commits[d4214172-1154-4d65-8c72-9ea3dee7063a:c3]
2019-06-15 08:31:00,484 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - d4214172-1154-4d65-8c72-9ea3dee7063a: close
2019-06-15 08:31:00,485 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-15 08:31:00,485 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-15 08:31:00,486 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - d4214172-1154-4d65-8c72-9ea3dee7063a: shutdown group-73167082ACC2
2019-06-15 08:31:00,487 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-73167082ACC2,id=d4214172-1154-4d65-8c72-9ea3dee7063a
2019-06-15 08:31:00,487 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - d4214172-1154-4d65-8c72-9ea3dee7063a: shutdown LeaderState
2019-06-15 08:31:00,487 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - d4214172-1154-4d65-8c72-9ea3dee7063a-PendingRequests: sendNotLeaderResponses
2019-06-15 08:31:00,490 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-15 08:31:00,490 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d4214172-1154-4d65-8c72-9ea3dee7063a/832ff9df-eb8a-4375-9799-73167082acc2/sm/snapshot.1_3
2019-06-15 08:31:00,491 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-d4214172-1154-4d65-8c72-9ea3dee7063a-group-73167082ACC2: set stopIndex = 4
2019-06-15 08:31:00,497 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - d4214172-1154-4d65-8c72-9ea3dee7063a:group-73167082ACC2 closes. The last applied log index is 4
2019-06-15 08:31:00,498 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - d4214172-1154-4d65-8c72-9ea3dee7063a-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-15 08:31:00,498 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - d4214172-1154-4d65-8c72-9ea3dee7063a-RaftLogWorker close()
2019-06-15 08:31:00,499 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - d4214172-1154-4d65-8c72-9ea3dee7063a: shutdown server with port 36657 now
2019-06-15 08:31:00,500 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - d4214172-1154-4d65-8c72-9ea3dee7063a: shutdown server with port 36657 successfully
2019-06-15 08:31:00,520 INFO  ozone.RatisTestHelper (RatisTestHelper.java:initRatisConf(109)) - dfs.container.ratis.rpc.type = GRPC
2019-06-15 08:31:00,522 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-15 08:31:00,522 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 39563 (custom)
2019-06-15 08:31:00,523 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-15 08:31:00,523 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 08:31:00,525 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-15 08:31:00,526 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-15 08:31:00,526 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1f6cd938-8a40-4e41-b454-fd2f9c4de295] (custom)
2019-06-15 08:31:00,527 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 1f6cd938-8a40-4e41-b454-fd2f9c4de295 at port 39563
2019-06-15 08:31:00,539 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295: start RPC server
2019-06-15 08:31:00,541 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295: GrpcService started, listening on 0.0.0.0/0.0.0.0:39563
Jun 15, 2019 8:31:00 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=17, target=0.0.0.0:36657} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:130)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 15, 2019 8:31:00 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=9, target=0.0.0.0:42235} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connectToDatanode(XceiverClientGrpc.java:163)
	at org.apache.hadoop.hdds.scm.XceiverClientGrpc.connect(XceiverClientGrpc.java:120)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:227)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServer(TestSecureContainerServer.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-15 08:31:00,564 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295: addNew group-12CC79CB7E9E:[1f6cd938-8a40-4e41-b454-fd2f9c4de295:0.0.0.0:39563, 00210cb2-5dd1-41c4-a568-19aeeb0122c8:0.0.0.0:42055, d28958c1-9a0f-4765-91a3-703c66461aa9:0.0.0.0:34661] returns group-12CC79CB7E9E:java.util.concurrent.CompletableFuture@238eabad[Not completed]
2019-06-15 08:31:00,565 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295: new RaftServerImpl for group-12CC79CB7E9E:[1f6cd938-8a40-4e41-b454-fd2f9c4de295:0.0.0.0:39563, 00210cb2-5dd1-41c4-a568-19aeeb0122c8:0.0.0.0:42055, d28958c1-9a0f-4765-91a3-703c66461aa9:0.0.0.0:34661] with ContainerStateMachine:uninitialized
2019-06-15 08:31:00,565 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-15 08:31:00,565 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-15 08:31:00,565 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-15 08:31:00,566 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-15 08:31:00,566 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295:group-12CC79CB7E9E ConfigurationManager, init=-1: [1f6cd938-8a40-4e41-b454-fd2f9c4de295:0.0.0.0:39563, 00210cb2-5dd1-41c4-a568-19aeeb0122c8:0.0.0.0:42055, d28958c1-9a0f-4765-91a3-703c66461aa9:0.0.0.0:34661], old=null, confs=<EMPTY_MAP>
2019-06-15 08:31:00,566 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1f6cd938-8a40-4e41-b454-fd2f9c4de295] (custom)
2019-06-15 08:31:00,566 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1f6cd938-8a40-4e41-b454-fd2f9c4de295/2c804f70-208e-4688-975a-12cc79cb7e9e does not exist. Creating ...
2019-06-15 08:31:00,569 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1f6cd938-8a40-4e41-b454-fd2f9c4de295/2c804f70-208e-4688-975a-12cc79cb7e9e/in_use.lock acquired by nodename 26653@ozone-unit-076618677d3-xbqfw-572796842
2019-06-15 08:31:00,571 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1f6cd938-8a40-4e41-b454-fd2f9c4de295/2c804f70-208e-4688-975a-12cc79cb7e9e has been successfully formatted.
2019-06-15 08:31:00,572 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-15 08:31:00,572 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-15 08:31:00,572 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-15 08:31:00,572 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 08:31:00,572 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 08:31:00,572 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-15 08:31:00,572 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 1f6cd938-8a40-4e41-b454-fd2f9c4de295-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1f6cd938-8a40-4e41-b454-fd2f9c4de295/2c804f70-208e-4688-975a-12cc79cb7e9e
2019-06-15 08:31:00,573 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-15 08:31:00,573 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-15 08:31:00,573 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 08:31:00,573 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-15 08:31:00,573 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-15 08:31:00,573 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-15 08:31:00,573 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-15 08:31:00,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-15 08:31:00,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-15 08:31:00,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-15 08:31:00,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-15 08:31:00,575 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-15 08:31:00,575 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-15 08:31:00,575 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295: start group-12CC79CB7E9E
2019-06-15 08:31:00,575 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295:group-12CC79CB7E9E changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-15 08:31:00,575 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295: start FollowerState
2019-06-15 08:31:00,576 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-12CC79CB7E9E,id=1f6cd938-8a40-4e41-b454-fd2f9c4de295
2019-06-15 08:31:00,580 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-15 08:31:00,580 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 34661 (custom)
2019-06-15 08:31:00,580 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-15 08:31:00,581 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 08:31:00,581 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-15 08:31:00,581 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-15 08:31:00,581 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d28958c1-9a0f-4765-91a3-703c66461aa9] (custom)
2019-06-15 08:31:00,581 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis d28958c1-9a0f-4765-91a3-703c66461aa9 at port 34661
2019-06-15 08:31:00,587 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - d28958c1-9a0f-4765-91a3-703c66461aa9: start RPC server
2019-06-15 08:31:00,588 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - d28958c1-9a0f-4765-91a3-703c66461aa9: GrpcService started, listening on 0.0.0.0/0.0.0.0:34661
2019-06-15 08:31:00,605 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - d28958c1-9a0f-4765-91a3-703c66461aa9: addNew group-12CC79CB7E9E:[1f6cd938-8a40-4e41-b454-fd2f9c4de295:0.0.0.0:39563, 00210cb2-5dd1-41c4-a568-19aeeb0122c8:0.0.0.0:42055, d28958c1-9a0f-4765-91a3-703c66461aa9:0.0.0.0:34661] returns group-12CC79CB7E9E:java.util.concurrent.CompletableFuture@57a0a410[Not completed]
2019-06-15 08:31:00,605 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - d28958c1-9a0f-4765-91a3-703c66461aa9: new RaftServerImpl for group-12CC79CB7E9E:[1f6cd938-8a40-4e41-b454-fd2f9c4de295:0.0.0.0:39563, 00210cb2-5dd1-41c4-a568-19aeeb0122c8:0.0.0.0:42055, d28958c1-9a0f-4765-91a3-703c66461aa9:0.0.0.0:34661] with ContainerStateMachine:uninitialized
2019-06-15 08:31:00,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-15 08:31:00,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-15 08:31:00,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-15 08:31:00,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-15 08:31:00,606 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - d28958c1-9a0f-4765-91a3-703c66461aa9:group-12CC79CB7E9E ConfigurationManager, init=-1: [1f6cd938-8a40-4e41-b454-fd2f9c4de295:0.0.0.0:39563, 00210cb2-5dd1-41c4-a568-19aeeb0122c8:0.0.0.0:42055, d28958c1-9a0f-4765-91a3-703c66461aa9:0.0.0.0:34661], old=null, confs=<EMPTY_MAP>
2019-06-15 08:31:00,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d28958c1-9a0f-4765-91a3-703c66461aa9] (custom)
2019-06-15 08:31:00,607 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d28958c1-9a0f-4765-91a3-703c66461aa9/2c804f70-208e-4688-975a-12cc79cb7e9e does not exist. Creating ...
2019-06-15 08:31:00,609 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d28958c1-9a0f-4765-91a3-703c66461aa9/2c804f70-208e-4688-975a-12cc79cb7e9e/in_use.lock acquired by nodename 26653@ozone-unit-076618677d3-xbqfw-572796842
2019-06-15 08:31:00,611 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d28958c1-9a0f-4765-91a3-703c66461aa9/2c804f70-208e-4688-975a-12cc79cb7e9e has been successfully formatted.
2019-06-15 08:31:00,611 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-15 08:31:00,612 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-15 08:31:00,612 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-15 08:31:00,612 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 08:31:00,612 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 08:31:00,612 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-15 08:31:00,612 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new d28958c1-9a0f-4765-91a3-703c66461aa9-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d28958c1-9a0f-4765-91a3-703c66461aa9/2c804f70-208e-4688-975a-12cc79cb7e9e
2019-06-15 08:31:00,612 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-15 08:31:00,612 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-15 08:31:00,612 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 08:31:00,613 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-15 08:31:00,613 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-15 08:31:00,613 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-15 08:31:00,613 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-15 08:31:00,613 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-15 08:31:00,613 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-15 08:31:00,613 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-15 08:31:00,614 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-15 08:31:00,614 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-15 08:31:00,614 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-15 08:31:00,614 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - d28958c1-9a0f-4765-91a3-703c66461aa9: start group-12CC79CB7E9E
2019-06-15 08:31:00,614 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d28958c1-9a0f-4765-91a3-703c66461aa9:group-12CC79CB7E9E changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-15 08:31:00,614 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d28958c1-9a0f-4765-91a3-703c66461aa9: start FollowerState
2019-06-15 08:31:00,615 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-12CC79CB7E9E,id=d28958c1-9a0f-4765-91a3-703c66461aa9
2019-06-15 08:31:00,618 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-15 08:31:00,618 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42055 (custom)
2019-06-15 08:31:00,618 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-15 08:31:00,619 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 08:31:00,619 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-15 08:31:00,619 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-15 08:31:00,620 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/00210cb2-5dd1-41c4-a568-19aeeb0122c8] (custom)
2019-06-15 08:31:00,620 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 00210cb2-5dd1-41c4-a568-19aeeb0122c8 at port 42055
2019-06-15 08:31:00,625 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8: start RPC server
2019-06-15 08:31:00,626 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8: GrpcService started, listening on 0.0.0.0/0.0.0.0:42055
2019-06-15 08:31:00,644 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8: addNew group-12CC79CB7E9E:[1f6cd938-8a40-4e41-b454-fd2f9c4de295:0.0.0.0:39563, 00210cb2-5dd1-41c4-a568-19aeeb0122c8:0.0.0.0:42055, d28958c1-9a0f-4765-91a3-703c66461aa9:0.0.0.0:34661] returns group-12CC79CB7E9E:java.util.concurrent.CompletableFuture@648e142a[Not completed]
2019-06-15 08:31:00,645 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8: new RaftServerImpl for group-12CC79CB7E9E:[1f6cd938-8a40-4e41-b454-fd2f9c4de295:0.0.0.0:39563, 00210cb2-5dd1-41c4-a568-19aeeb0122c8:0.0.0.0:42055, d28958c1-9a0f-4765-91a3-703c66461aa9:0.0.0.0:34661] with ContainerStateMachine:uninitialized
2019-06-15 08:31:00,645 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-15 08:31:00,646 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-15 08:31:00,646 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-15 08:31:00,646 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-15 08:31:00,646 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8:group-12CC79CB7E9E ConfigurationManager, init=-1: [1f6cd938-8a40-4e41-b454-fd2f9c4de295:0.0.0.0:39563, 00210cb2-5dd1-41c4-a568-19aeeb0122c8:0.0.0.0:42055, d28958c1-9a0f-4765-91a3-703c66461aa9:0.0.0.0:34661], old=null, confs=<EMPTY_MAP>
2019-06-15 08:31:00,646 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/00210cb2-5dd1-41c4-a568-19aeeb0122c8] (custom)
2019-06-15 08:31:00,646 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/00210cb2-5dd1-41c4-a568-19aeeb0122c8/2c804f70-208e-4688-975a-12cc79cb7e9e does not exist. Creating ...
2019-06-15 08:31:00,648 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/00210cb2-5dd1-41c4-a568-19aeeb0122c8/2c804f70-208e-4688-975a-12cc79cb7e9e/in_use.lock acquired by nodename 26653@ozone-unit-076618677d3-xbqfw-572796842
2019-06-15 08:31:00,650 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/00210cb2-5dd1-41c4-a568-19aeeb0122c8/2c804f70-208e-4688-975a-12cc79cb7e9e has been successfully formatted.
2019-06-15 08:31:00,651 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-15 08:31:00,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-15 08:31:00,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-15 08:31:00,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 08:31:00,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 08:31:00,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-15 08:31:00,651 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 00210cb2-5dd1-41c4-a568-19aeeb0122c8-RaftLogWorker for Storage Directory /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/00210cb2-5dd1-41c4-a568-19aeeb0122c8/2c804f70-208e-4688-975a-12cc79cb7e9e
2019-06-15 08:31:00,651 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-15 08:31:00,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-15 08:31:00,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 08:31:00,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-15 08:31:00,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-15 08:31:00,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-15 08:31:00,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-15 08:31:00,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-15 08:31:00,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-15 08:31:00,652 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-15 08:31:00,653 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-15 08:31:00,653 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-15 08:31:00,653 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-15 08:31:00,653 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8: start group-12CC79CB7E9E
2019-06-15 08:31:00,653 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8:group-12CC79CB7E9E changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-15 08:31:00,653 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8: start FollowerState
2019-06-15 08:31:00,654 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-12CC79CB7E9E,id=00210cb2-5dd1-41c4-a568-19aeeb0122c8
2019-06-15 08:31:00,666 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-4DD993CD410A->1f6cd938-8a40-4e41-b454-fd2f9c4de295: receive RaftClientReply:client-4DD993CD410A->1f6cd938-8a40-4e41-b454-fd2f9c4de295@group-12CC79CB7E9E, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server 1f6cd938-8a40-4e41-b454-fd2f9c4de295 is not the leader (d28958c1-9a0f-4765-91a3-703c66461aa9:0.0.0.0:34661). Request must be sent to leader., logIndex=0, commits[1f6cd938-8a40-4e41-b454-fd2f9c4de295:c-1]
2019-06-15 08:31:00,669 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-15 08:31:01,677 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-4DD993CD410A->00210cb2-5dd1-41c4-a568-19aeeb0122c8: receive RaftClientReply:client-4DD993CD410A->00210cb2-5dd1-41c4-a568-19aeeb0122c8@group-12CC79CB7E9E, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server 00210cb2-5dd1-41c4-a568-19aeeb0122c8 is not the leader (d28958c1-9a0f-4765-91a3-703c66461aa9:0.0.0.0:34661). Request must be sent to leader., logIndex=0, commits[00210cb2-5dd1-41c4-a568-19aeeb0122c8:c-1]
2019-06-15 08:31:01,679 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-15 08:31:01,770 INFO  impl.FollowerState (FollowerState.java:run(101)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295:group-12CC79CB7E9E changes to CANDIDATE, lastRpcTime:1194, electionTimeout:1194ms
2019-06-15 08:31:01,770 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295: shutdown FollowerState
2019-06-15 08:31:01,770 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295:group-12CC79CB7E9E changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-15 08:31:01,770 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295: start LeaderElection
2019-06-15 08:31:01,773 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295:group-12CC79CB7E9E:LeaderElection2: begin an election at term 1 for -1: [1f6cd938-8a40-4e41-b454-fd2f9c4de295:0.0.0.0:39563, 00210cb2-5dd1-41c4-a568-19aeeb0122c8:0.0.0.0:42055, d28958c1-9a0f-4765-91a3-703c66461aa9:0.0.0.0:34661], old=null
2019-06-15 08:31:01,781 INFO  impl.FollowerState (FollowerState.java:run(101)) - d28958c1-9a0f-4765-91a3-703c66461aa9:group-12CC79CB7E9E changes to CANDIDATE, lastRpcTime:1166, electionTimeout:1165ms
2019-06-15 08:31:01,781 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d28958c1-9a0f-4765-91a3-703c66461aa9: shutdown FollowerState
2019-06-15 08:31:01,781 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d28958c1-9a0f-4765-91a3-703c66461aa9:group-12CC79CB7E9E changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-15 08:31:01,781 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d28958c1-9a0f-4765-91a3-703c66461aa9: start LeaderElection
2019-06-15 08:31:01,787 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - d28958c1-9a0f-4765-91a3-703c66461aa9:group-12CC79CB7E9E:LeaderElection3: begin an election at term 1 for -1: [1f6cd938-8a40-4e41-b454-fd2f9c4de295:0.0.0.0:39563, 00210cb2-5dd1-41c4-a568-19aeeb0122c8:0.0.0.0:42055, d28958c1-9a0f-4765-91a3-703c66461aa9:0.0.0.0:34661], old=null
2019-06-15 08:31:01,788 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8:group-12CC79CB7E9E changes role from FOLLOWER to FOLLOWER at term 1 for recognizeCandidate:1f6cd938-8a40-4e41-b454-fd2f9c4de295
2019-06-15 08:31:01,788 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8: shutdown FollowerState
2019-06-15 08:31:01,789 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8: start FollowerState
2019-06-15 08:31:01,790 INFO  impl.FollowerState (FollowerState.java:run(109)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-15 08:31:01,802 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295:group-12CC79CB7E9E:LeaderElection2: Election PASSED; received 1 response(s) [1f6cd938-8a40-4e41-b454-fd2f9c4de295->00210cb2-5dd1-41c4-a568-19aeeb0122c8,true-t1] and 0 exception(s); 1f6cd938-8a40-4e41-b454-fd2f9c4de295:t1, leader=null, voted=1f6cd938-8a40-4e41-b454-fd2f9c4de295, raftlog=1f6cd938-8a40-4e41-b454-fd2f9c4de295-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [1f6cd938-8a40-4e41-b454-fd2f9c4de295:0.0.0.0:39563, 00210cb2-5dd1-41c4-a568-19aeeb0122c8:0.0.0.0:42055, d28958c1-9a0f-4765-91a3-703c66461aa9:0.0.0.0:34661], old=null
2019-06-15 08:31:01,802 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295: shutdown LeaderElection
2019-06-15 08:31:01,802 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295:group-12CC79CB7E9E changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-15 08:31:01,802 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295:group-12CC79CB7E9E change Leader from null to 1f6cd938-8a40-4e41-b454-fd2f9c4de295 at term 1 for becomeLeader, leader elected after 1230ms
2019-06-15 08:31:01,803 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-15 08:31:01,803 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-15 08:31:01,803 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-15 08:31:01,803 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-15 08:31:01,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-15 08:31:01,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 08:31:01,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-15 08:31:01,807 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-15 08:31:01,808 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-15 08:31:01,808 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-15 08:31:01,808 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.snapshot.chunk.size.max = 16MB (=16777216) (default)
2019-06-15 08:31:01,808 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 08:31:01,808 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.element-limit = 1 (custom)
2019-06-15 08:31:01,808 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.leader.outstanding.appends.max = 128 (default)
2019-06-15 08:31:01,809 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-15 08:31:01,809 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-15 08:31:01,809 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295: start LeaderState
2019-06-15 08:31:01,809 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295-RaftLogWorker: Starting segment from index:0
2019-06-15 08:31:01,827 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295:group-12CC79CB7E9E set configuration 0: [1f6cd938-8a40-4e41-b454-fd2f9c4de295:0.0.0.0:39563, 00210cb2-5dd1-41c4-a568-19aeeb0122c8:0.0.0.0:42055, d28958c1-9a0f-4765-91a3-703c66461aa9:0.0.0.0:34661], old=null at 0
2019-06-15 08:31:01,830 INFO  impl.RaftServerImpl (RaftServerImpl.java:requestVote(738)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295-LEADER: Withhold vote from candidate d28958c1-9a0f-4765-91a3-703c66461aa9 with term 1. State: leader=1f6cd938-8a40-4e41-b454-fd2f9c4de295, term=1, lastRpcElapsed=null
2019-06-15 08:31:01,909 INFO  impl.LeaderElection (LeaderElection.java:logAndReturn(56)) - d28958c1-9a0f-4765-91a3-703c66461aa9:group-12CC79CB7E9E:LeaderElection3: Election REJECTED; received 2 response(s) [d28958c1-9a0f-4765-91a3-703c66461aa9->1f6cd938-8a40-4e41-b454-fd2f9c4de295,false-t1, d28958c1-9a0f-4765-91a3-703c66461aa9->00210cb2-5dd1-41c4-a568-19aeeb0122c8,false-t1] and 0 exception(s); d28958c1-9a0f-4765-91a3-703c66461aa9:t1, leader=null, voted=d28958c1-9a0f-4765-91a3-703c66461aa9, raftlog=d28958c1-9a0f-4765-91a3-703c66461aa9-SegmentedRaftLog:OPENED:c-1,f-1,i0, conf=-1: [1f6cd938-8a40-4e41-b454-fd2f9c4de295:0.0.0.0:39563, 00210cb2-5dd1-41c4-a568-19aeeb0122c8:0.0.0.0:42055, d28958c1-9a0f-4765-91a3-703c66461aa9:0.0.0.0:34661], old=null
2019-06-15 08:31:01,912 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d28958c1-9a0f-4765-91a3-703c66461aa9:group-12CC79CB7E9E changes role from CANDIDATE to FOLLOWER at term 1 for DISCOVERED_A_NEW_TERM
2019-06-15 08:31:01,913 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - d28958c1-9a0f-4765-91a3-703c66461aa9: shutdown LeaderElection
2019-06-15 08:31:01,913 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d28958c1-9a0f-4765-91a3-703c66461aa9: start FollowerState
2019-06-15 08:31:01,910 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1f6cd938-8a40-4e41-b454-fd2f9c4de295/2c804f70-208e-4688-975a-12cc79cb7e9e/current/log_inprogress_0
2019-06-15 08:31:01,913 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8:group-12CC79CB7E9E change Leader from null to 1f6cd938-8a40-4e41-b454-fd2f9c4de295 at term 1 for appendEntries, leader elected after 1261ms
2019-06-15 08:31:01,918 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - d28958c1-9a0f-4765-91a3-703c66461aa9:group-12CC79CB7E9E change Leader from null to 1f6cd938-8a40-4e41-b454-fd2f9c4de295 at term 1 for appendEntries, leader elected after 1306ms
2019-06-15 08:31:01,934 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - d28958c1-9a0f-4765-91a3-703c66461aa9:group-12CC79CB7E9E set configuration 0: [1f6cd938-8a40-4e41-b454-fd2f9c4de295:0.0.0.0:39563, 00210cb2-5dd1-41c4-a568-19aeeb0122c8:0.0.0.0:42055, d28958c1-9a0f-4765-91a3-703c66461aa9:0.0.0.0:34661], old=null at 0
2019-06-15 08:31:01,934 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8:group-12CC79CB7E9E set configuration 0: [1f6cd938-8a40-4e41-b454-fd2f9c4de295:0.0.0.0:39563, 00210cb2-5dd1-41c4-a568-19aeeb0122c8:0.0.0.0:42055, d28958c1-9a0f-4765-91a3-703c66461aa9:0.0.0.0:34661], old=null at 0
2019-06-15 08:31:01,934 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - d28958c1-9a0f-4765-91a3-703c66461aa9-RaftLogWorker: Starting segment from index:0
2019-06-15 08:31:01,934 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8-RaftLogWorker: Starting segment from index:0
2019-06-15 08:31:01,970 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - d28958c1-9a0f-4765-91a3-703c66461aa9-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d28958c1-9a0f-4765-91a3-703c66461aa9/2c804f70-208e-4688-975a-12cc79cb7e9e/current/log_inprogress_0
2019-06-15 08:31:01,988 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8-RaftLogWorker: created new log segment /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/00210cb2-5dd1-41c4-a568-19aeeb0122c8/2c804f70-208e-4688-975a-12cc79cb7e9e/current/log_inprogress_0
Jun 15, 2019 8:31:02 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=43, target=0.0.0.0:34661} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:131)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 15, 2019 8:31:02 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=51, target=0.0.0.0:42055} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:131)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 15, 2019 8:31:02 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=35, target=0.0.0.0:39563} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.RatisTestHelper.initXceiverServerRatis(RatisTestHelper.java:135)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.lambda$runTestClientServerRatis$4(TestSecureContainerServer.java:159)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServer(TestSecureContainerServer.java:184)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.runTestClientServerRatis(TestSecureContainerServer.java:155)
	at org.apache.hadoop.ozone.container.server.TestSecureContainerServer.testClientServerRatisGrpc(TestSecureContainerServer.java:131)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-15 08:31:02,688 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-4DD993CD410A->d28958c1-9a0f-4765-91a3-703c66461aa9: receive RaftClientReply:client-4DD993CD410A->d28958c1-9a0f-4765-91a3-703c66461aa9@group-12CC79CB7E9E, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server d28958c1-9a0f-4765-91a3-703c66461aa9 is not the leader (1f6cd938-8a40-4e41-b454-fd2f9c4de295:0.0.0.0:39563). Request must be sent to leader., logIndex=0, commits[d28958c1-9a0f-4765-91a3-703c66461aa9:c0, 1f6cd938-8a40-4e41-b454-fd2f9c4de295:c0, 00210cb2-5dd1-41c4-a568-19aeeb0122c8:c0]
2019-06-15 08:31:02,690 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 0-OrderedRequestStreamObserver0: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-15 08:31:03,696 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-4DD993CD410A->00210cb2-5dd1-41c4-a568-19aeeb0122c8: receive RaftClientReply:client-4DD993CD410A->00210cb2-5dd1-41c4-a568-19aeeb0122c8@group-12CC79CB7E9E, cid=6, FAILED org.apache.ratis.protocol.NotLeaderException: Server 00210cb2-5dd1-41c4-a568-19aeeb0122c8 is not the leader (1f6cd938-8a40-4e41-b454-fd2f9c4de295:0.0.0.0:39563). Request must be sent to leader., logIndex=0, commits[00210cb2-5dd1-41c4-a568-19aeeb0122c8:c0, 1f6cd938-8a40-4e41-b454-fd2f9c4de295:c0, d28958c1-9a0f-4765-91a3-703c66461aa9:c0]
2019-06-15 08:31:03,699 WARN  client.GrpcClientProtocolService (LogUtils.java:warn(134)) - 1-OrderedRequestStreamObserver1: onError: org.apache.ratis.thirdparty.io.grpc.StatusRuntimeException: CANCELLED: cancelled before receiving half close
2019-06-15 08:31:04,708 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-15 08:31:04,717 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-15 08:31:04,717 INFO  ratis.ContainerStateMachine (ContainerUtils.java:logAndReturnError(146)) - Operation: CreateContainer : Trace ID:  : Message: Block token verification failed. Fail to find any token (empty or null.) : Result: BLOCK_TOKEN_VERIFICATION_FAILED
2019-06-15 08:31:04,719 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-4DD993CD410A->1f6cd938-8a40-4e41-b454-fd2f9c4de295: receive RaftClientReply:client-4DD993CD410A->1f6cd938-8a40-4e41-b454-fd2f9c4de295@group-12CC79CB7E9E, cid=6, SUCCESS, logIndex=1, commits[1f6cd938-8a40-4e41-b454-fd2f9c4de295:c2, 00210cb2-5dd1-41c4-a568-19aeeb0122c8:c0, d28958c1-9a0f-4765-91a3-703c66461aa9:c1]
2019-06-15 08:31:04,719 INFO  security.OzoneBlockTokenSecretManager (OzoneSecretManager.java:updateCurrentKey(167)) - Updating the current master key for generating tokens
2019-06-15 08:31:04,747 INFO  client.GrpcClientProtocolClient (GrpcClientProtocolClient.java:onNext(254)) - client-4CE9F69B099C->1f6cd938-8a40-4e41-b454-fd2f9c4de295: receive RaftClientReply:client-4CE9F69B099C->1f6cd938-8a40-4e41-b454-fd2f9c4de295@group-12CC79CB7E9E, cid=7, SUCCESS, logIndex=3, commits[1f6cd938-8a40-4e41-b454-fd2f9c4de295:c3, 00210cb2-5dd1-41c4-a568-19aeeb0122c8:c2, d28958c1-9a0f-4765-91a3-703c66461aa9:c2]
2019-06-15 08:31:04,749 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295: close
2019-06-15 08:31:04,749 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295: shutdown group-12CC79CB7E9E
2019-06-15 08:31:04,750 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-12CC79CB7E9E,id=1f6cd938-8a40-4e41-b454-fd2f9c4de295
2019-06-15 08:31:04,750 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295: shutdown LeaderState
2019-06-15 08:31:04,750 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295-PendingRequests: sendNotLeaderResponses
2019-06-15 08:31:04,750 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(1f6cd938-8a40-4e41-b454-fd2f9c4de295 -> 00210cb2-5dd1-41c4-a568-19aeeb0122c8): Wait interrupted by java.lang.InterruptedException
2019-06-15 08:31:04,751 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8: appendEntries completed
2019-06-15 08:31:04,750 WARN  server.GrpcLogAppender (GrpcLogAppender.java:mayWait(142)) - GrpcLogAppender(1f6cd938-8a40-4e41-b454-fd2f9c4de295 -> d28958c1-9a0f-4765-91a3-703c66461aa9): Wait interrupted by java.lang.InterruptedException
2019-06-15 08:31:04,752 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295: follower 1f6cd938-8a40-4e41-b454-fd2f9c4de295->00210cb2-5dd1-41c4-a568-19aeeb0122c8(c3,m4,n5, attendVote=true, lastRpcSendTime=17, lastRpcResponseTime=12) response Completed
2019-06-15 08:31:04,754 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-15 08:31:04,754 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-1f6cd938-8a40-4e41-b454-fd2f9c4de295-group-12CC79CB7E9E: set stopIndex = 4
2019-06-15 08:31:04,755 INFO  server.GrpcServerProtocolService (GrpcServerProtocolService.java:onCompleted(104)) - d28958c1-9a0f-4765-91a3-703c66461aa9: appendEntries completed
2019-06-15 08:31:04,755 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/1f6cd938-8a40-4e41-b454-fd2f9c4de295/2c804f70-208e-4688-975a-12cc79cb7e9e/sm/snapshot.1_3
2019-06-15 08:31:04,755 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295->00210cb2-5dd1-41c4-a568-19aeeb0122c8: nextIndex: updateUnconditionally 5 -> 0
2019-06-15 08:31:04,758 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295:group-12CC79CB7E9E closes. The last applied log index is 4
2019-06-15 08:31:04,758 INFO  server.GrpcLogAppender (GrpcLogAppender.java:onCompleted(277)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295: follower 1f6cd938-8a40-4e41-b454-fd2f9c4de295->d28958c1-9a0f-4765-91a3-703c66461aa9(c3,m4,n5, attendVote=true, lastRpcSendTime=23, lastRpcResponseTime=19) response Completed
2019-06-15 08:31:04,758 INFO  impl.FollowerInfo (FollowerInfo.java:lambda$new$0(50)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295->d28958c1-9a0f-4765-91a3-703c66461aa9: nextIndex: updateUnconditionally 5 -> -1
2019-06-15 08:31:04,759 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-15 08:31:04,759 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295-RaftLogWorker close()
2019-06-15 08:31:04,760 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295: shutdown server with port 39563 now
2019-06-15 08:31:04,761 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 1f6cd938-8a40-4e41-b454-fd2f9c4de295: shutdown server with port 39563 successfully
2019-06-15 08:31:04,763 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - d28958c1-9a0f-4765-91a3-703c66461aa9: close
2019-06-15 08:31:04,764 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - d28958c1-9a0f-4765-91a3-703c66461aa9: shutdown group-12CC79CB7E9E
2019-06-15 08:31:04,764 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-12CC79CB7E9E,id=d28958c1-9a0f-4765-91a3-703c66461aa9
2019-06-15 08:31:04,764 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d28958c1-9a0f-4765-91a3-703c66461aa9: shutdown FollowerState
2019-06-15 08:31:04,765 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-d28958c1-9a0f-4765-91a3-703c66461aa9-group-12CC79CB7E9E: set stopIndex = 3
2019-06-15 08:31:04,765 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-15 08:31:04,766 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/d28958c1-9a0f-4765-91a3-703c66461aa9/2c804f70-208e-4688-975a-12cc79cb7e9e/sm/snapshot.1_3
2019-06-15 08:31:04,766 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - d28958c1-9a0f-4765-91a3-703c66461aa9:group-12CC79CB7E9E closes. The last applied log index is 3
2019-06-15 08:31:04,766 INFO  impl.FollowerState (FollowerState.java:run(109)) - d28958c1-9a0f-4765-91a3-703c66461aa9: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-15 08:31:04,766 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - d28958c1-9a0f-4765-91a3-703c66461aa9-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-15 08:31:04,768 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - d28958c1-9a0f-4765-91a3-703c66461aa9-RaftLogWorker close()
2019-06-15 08:31:04,768 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - d28958c1-9a0f-4765-91a3-703c66461aa9: shutdown server with port 34661 now
2019-06-15 08:31:04,769 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - d28958c1-9a0f-4765-91a3-703c66461aa9: shutdown server with port 34661 successfully
2019-06-15 08:31:04,772 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8: close
2019-06-15 08:31:04,773 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8: shutdown group-12CC79CB7E9E
2019-06-15 08:31:04,773 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-12CC79CB7E9E,id=00210cb2-5dd1-41c4-a568-19aeeb0122c8
2019-06-15 08:31:04,773 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8: shutdown FollowerState
2019-06-15 08:31:04,774 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-00210cb2-5dd1-41c4-a568-19aeeb0122c8-group-12CC79CB7E9E: set stopIndex = 3
2019-06-15 08:31:04,774 INFO  impl.FollowerState (FollowerState.java:run(109)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8: FollowerState was interrupted: java.lang.InterruptedException: sleep interrupted
2019-06-15 08:31:04,774 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:3)
2019-06-15 08:31:04,775 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-ozone/integration-test/target/test-dir/dfs/00210cb2-5dd1-41c4-a568-19aeeb0122c8/2c804f70-208e-4688-975a-12cc79cb7e9e/sm/snapshot.1_3
2019-06-15 08:31:04,775 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8:group-12CC79CB7E9E closes. The last applied log index is 3
2019-06-15 08:31:04,775 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-15 08:31:04,776 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8-RaftLogWorker close()
2019-06-15 08:31:04,776 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8: shutdown server with port 42055 now
2019-06-15 08:31:04,777 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 00210cb2-5dd1-41c4-a568-19aeeb0122c8: shutdown server with port 42055 successfully
