2019-06-15 11:31:55,327 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler08bb80c0-0644-4ba8-a2b2-b4ef04058828/hdds of  storage type : DISK and capacity : 104021790720
2019-06-15 11:31:55,331 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler08bb80c0-0644-4ba8-a2b2-b4ef04058828/hdds to VolumeSet
2019-06-15 11:31:55,340 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-15 11:31:55,367 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-15 11:31:55,689 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 40443
2019-06-15 11:31:56,051 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-15 11:31:56,070 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-15 11:31:56,077 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 40443 (custom)
2019-06-15 11:31:56,077 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-15 11:31:56,079 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 11:31:56,079 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-15 11:31:56,080 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-15 11:31:56,205 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler08bb80c0-0644-4ba8-a2b2-b4ef04058828/ratis] (custom)
2019-06-15 11:31:56,216 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 37045
2019-06-15 11:31:56,240 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-15 11:31:56,240 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-15 11:31:56,241 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis b21c467d-dfe3-461d-b553-ca0b248f6db5 at port 40443
2019-06-15 11:31:56,251 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - b21c467d-dfe3-461d-b553-ca0b248f6db5: start RPC server
2019-06-15 11:31:56,378 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - b21c467d-dfe3-461d-b553-ca0b248f6db5: GrpcService started, listening on 0.0.0.0/0.0.0.0:40443
2019-06-15 11:31:56,652 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - b21c467d-dfe3-461d-b553-ca0b248f6db5: addNew group-D9E76359013A:[b21c467d-dfe3-461d-b553-ca0b248f6db5:127.0.0.1:40443] returns group-D9E76359013A:java.util.concurrent.CompletableFuture@54bce65a[Not completed]
2019-06-15 11:31:56,679 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - b21c467d-dfe3-461d-b553-ca0b248f6db5: new RaftServerImpl for group-D9E76359013A:[b21c467d-dfe3-461d-b553-ca0b248f6db5:127.0.0.1:40443] with ContainerStateMachine:uninitialized
2019-06-15 11:31:56,680 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-15 11:31:56,680 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-15 11:31:56,680 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-15 11:31:56,681 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-15 11:31:56,685 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - b21c467d-dfe3-461d-b553-ca0b248f6db5:group-D9E76359013A ConfigurationManager, init=-1: [b21c467d-dfe3-461d-b553-ca0b248f6db5:127.0.0.1:40443], old=null, confs=<EMPTY_MAP>
2019-06-15 11:31:56,685 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler08bb80c0-0644-4ba8-a2b2-b4ef04058828/ratis] (custom)
2019-06-15 11:31:56,690 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler08bb80c0-0644-4ba8-a2b2-b4ef04058828/ratis/0fa23aa2-ae59-492f-8f25-d9e76359013a does not exist. Creating ...
2019-06-15 11:31:56,697 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler08bb80c0-0644-4ba8-a2b2-b4ef04058828/ratis/0fa23aa2-ae59-492f-8f25-d9e76359013a/in_use.lock acquired by nodename 4196@ozone-unit-076618677d3-cbxt7-2821487498
2019-06-15 11:31:56,704 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler08bb80c0-0644-4ba8-a2b2-b4ef04058828/ratis/0fa23aa2-ae59-492f-8f25-d9e76359013a has been successfully formatted.
2019-06-15 11:31:56,705 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-15 11:31:56,706 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-15 11:31:56,707 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-15 11:31:56,709 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 11:31:56,711 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 11:31:56,714 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-15 11:31:56,716 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new b21c467d-dfe3-461d-b553-ca0b248f6db5-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler08bb80c0-0644-4ba8-a2b2-b4ef04058828/ratis/0fa23aa2-ae59-492f-8f25-d9e76359013a
2019-06-15 11:31:56,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-15 11:31:56,717 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-15 11:31:56,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 11:31:56,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-15 11:31:56,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-15 11:31:56,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-15 11:31:56,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-15 11:31:56,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-15 11:31:56,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-15 11:31:56,722 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-15 11:31:56,727 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-15 11:31:56,728 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-15 11:31:56,728 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-15 11:31:56,822 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - b21c467d-dfe3-461d-b553-ca0b248f6db5: start group-D9E76359013A
2019-06-15 11:31:56,823 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b21c467d-dfe3-461d-b553-ca0b248f6db5:group-D9E76359013A changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-15 11:31:56,825 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b21c467d-dfe3-461d-b553-ca0b248f6db5: start FollowerState
2019-06-15 11:31:56,827 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D9E76359013A,id=b21c467d-dfe3-461d-b553-ca0b248f6db5
2019-06-15 11:31:57,937 INFO  impl.FollowerState (FollowerState.java:run(101)) - b21c467d-dfe3-461d-b553-ca0b248f6db5:group-D9E76359013A changes to CANDIDATE, lastRpcTime:1112, electionTimeout:1111ms
2019-06-15 11:31:57,937 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b21c467d-dfe3-461d-b553-ca0b248f6db5: shutdown FollowerState
2019-06-15 11:31:57,937 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b21c467d-dfe3-461d-b553-ca0b248f6db5:group-D9E76359013A changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-15 11:31:57,939 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b21c467d-dfe3-461d-b553-ca0b248f6db5: start LeaderElection
2019-06-15 11:31:57,942 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b21c467d-dfe3-461d-b553-ca0b248f6db5:group-D9E76359013A:LeaderElection1: begin an election at term 1 for -1: [b21c467d-dfe3-461d-b553-ca0b248f6db5:127.0.0.1:40443], old=null
2019-06-15 11:31:57,943 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b21c467d-dfe3-461d-b553-ca0b248f6db5: shutdown LeaderElection
2019-06-15 11:31:57,943 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b21c467d-dfe3-461d-b553-ca0b248f6db5:group-D9E76359013A changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-15 11:31:57,944 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - b21c467d-dfe3-461d-b553-ca0b248f6db5:group-D9E76359013A change Leader from null to b21c467d-dfe3-461d-b553-ca0b248f6db5 at term 1 for becomeLeader, leader elected after 1237ms
2019-06-15 11:31:57,947 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-15 11:31:57,947 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-15 11:31:57,949 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-15 11:31:57,949 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-15 11:31:57,956 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b21c467d-dfe3-461d-b553-ca0b248f6db5: start LeaderState
2019-06-15 11:31:57,967 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - b21c467d-dfe3-461d-b553-ca0b248f6db5-RaftLogWorker: Starting segment from index:0
2019-06-15 11:31:57,974 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - b21c467d-dfe3-461d-b553-ca0b248f6db5:group-D9E76359013A set configuration 0: [b21c467d-dfe3-461d-b553-ca0b248f6db5:127.0.0.1:40443], old=null at 0
2019-06-15 11:31:58,096 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - b21c467d-dfe3-461d-b553-ca0b248f6db5-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler08bb80c0-0644-4ba8-a2b2-b4ef04058828/ratis/0fa23aa2-ae59-492f-8f25-d9e76359013a/current/log_inprogress_0
2019-06-15 11:31:59,038 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-15 11:31:59,094 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 8290667030516608238 is closed with bcsId 0.
2019-06-15 11:31:59,095 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-15 11:31:59,096 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - b21c467d-dfe3-461d-b553-ca0b248f6db5: close
2019-06-15 11:31:59,097 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - b21c467d-dfe3-461d-b553-ca0b248f6db5: shutdown group-D9E76359013A
2019-06-15 11:31:59,098 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D9E76359013A,id=b21c467d-dfe3-461d-b553-ca0b248f6db5
2019-06-15 11:31:59,098 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - b21c467d-dfe3-461d-b553-ca0b248f6db5: shutdown LeaderState
2019-06-15 11:31:59,098 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - b21c467d-dfe3-461d-b553-ca0b248f6db5-PendingRequests: sendNotLeaderResponses
2019-06-15 11:31:59,100 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-b21c467d-dfe3-461d-b553-ca0b248f6db5-group-D9E76359013A: set stopIndex = 4
2019-06-15 11:31:59,100 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-15 11:31:59,101 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler08bb80c0-0644-4ba8-a2b2-b4ef04058828/ratis/0fa23aa2-ae59-492f-8f25-d9e76359013a/sm/snapshot.1_4
2019-06-15 11:31:59,107 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - b21c467d-dfe3-461d-b553-ca0b248f6db5:group-D9E76359013A closes. The last applied log index is 4
2019-06-15 11:31:59,108 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - b21c467d-dfe3-461d-b553-ca0b248f6db5-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-15 11:31:59,108 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - b21c467d-dfe3-461d-b553-ca0b248f6db5-RaftLogWorker close()
2019-06-15 11:31:59,109 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - b21c467d-dfe3-461d-b553-ca0b248f6db5: shutdown server with port 40443 now
2019-06-15 11:31:59,112 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - b21c467d-dfe3-461d-b553-ca0b248f6db5: shutdown server with port 40443 successfully
2019-06-15 11:31:59,122 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-15 11:31:59,146 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlereed53f55-f668-4eed-8977-6b914e46f8c5/hdds of  storage type : DISK and capacity : 104021790720
2019-06-15 11:31:59,146 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlereed53f55-f668-4eed-8977-6b914e46f8c5/hdds to VolumeSet
2019-06-15 11:31:59,147 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@655523dd
2019-06-15 11:31:59,147 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@655523dd
2019-06-15 11:31:59,162 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 46193
2019-06-15 11:31:59,163 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-15 11:31:59,164 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-15 11:31:59,164 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 46193 (custom)
2019-06-15 11:31:59,164 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-15 11:31:59,164 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 11:31:59,165 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-15 11:31:59,165 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-15 11:31:59,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlereed53f55-f668-4eed-8977-6b914e46f8c5/ratis] (custom)
2019-06-15 11:31:59,166 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 44629
2019-06-15 11:31:59,166 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-15 11:31:59,166 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-15 11:31:59,167 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 62ea3db0-c282-4808-b3aa-806e490e6f11 at port 46193
2019-06-15 11:31:59,176 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 62ea3db0-c282-4808-b3aa-806e490e6f11: start RPC server
2019-06-15 11:31:59,177 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 62ea3db0-c282-4808-b3aa-806e490e6f11: GrpcService started, listening on 0.0.0.0/0.0.0.0:46193
2019-06-15 11:31:59,186 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 62ea3db0-c282-4808-b3aa-806e490e6f11: addNew group-FB38A10973FA:[62ea3db0-c282-4808-b3aa-806e490e6f11:127.0.0.1:46193] returns group-FB38A10973FA:java.util.concurrent.CompletableFuture@18a3f4f4[Not completed]
2019-06-15 11:31:59,190 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 62ea3db0-c282-4808-b3aa-806e490e6f11: new RaftServerImpl for group-FB38A10973FA:[62ea3db0-c282-4808-b3aa-806e490e6f11:127.0.0.1:46193] with ContainerStateMachine:uninitialized
2019-06-15 11:31:59,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-15 11:31:59,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-15 11:31:59,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-15 11:31:59,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-15 11:31:59,191 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 62ea3db0-c282-4808-b3aa-806e490e6f11:group-FB38A10973FA ConfigurationManager, init=-1: [62ea3db0-c282-4808-b3aa-806e490e6f11:127.0.0.1:46193], old=null, confs=<EMPTY_MAP>
2019-06-15 11:31:59,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlereed53f55-f668-4eed-8977-6b914e46f8c5/ratis] (custom)
2019-06-15 11:31:59,192 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlereed53f55-f668-4eed-8977-6b914e46f8c5/ratis/6e0a0af7-6730-4dc1-8111-fb38a10973fa does not exist. Creating ...
2019-06-15 11:31:59,194 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlereed53f55-f668-4eed-8977-6b914e46f8c5/ratis/6e0a0af7-6730-4dc1-8111-fb38a10973fa/in_use.lock acquired by nodename 4196@ozone-unit-076618677d3-cbxt7-2821487498
2019-06-15 11:31:59,196 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlereed53f55-f668-4eed-8977-6b914e46f8c5/ratis/6e0a0af7-6730-4dc1-8111-fb38a10973fa has been successfully formatted.
2019-06-15 11:31:59,197 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-15 11:31:59,197 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-15 11:31:59,197 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-15 11:31:59,197 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 11:31:59,197 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 11:31:59,197 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-15 11:31:59,197 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 62ea3db0-c282-4808-b3aa-806e490e6f11-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlereed53f55-f668-4eed-8977-6b914e46f8c5/ratis/6e0a0af7-6730-4dc1-8111-fb38a10973fa
2019-06-15 11:31:59,198 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-15 11:31:59,198 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-15 11:31:59,198 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 11:31:59,198 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-15 11:31:59,198 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-15 11:31:59,198 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-15 11:31:59,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-15 11:31:59,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-15 11:31:59,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-15 11:31:59,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-15 11:31:59,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-15 11:31:59,200 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-15 11:31:59,200 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-15 11:31:59,200 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 62ea3db0-c282-4808-b3aa-806e490e6f11: start group-FB38A10973FA
2019-06-15 11:31:59,200 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 62ea3db0-c282-4808-b3aa-806e490e6f11:group-FB38A10973FA changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-15 11:31:59,200 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 62ea3db0-c282-4808-b3aa-806e490e6f11: start FollowerState
2019-06-15 11:31:59,202 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-FB38A10973FA,id=62ea3db0-c282-4808-b3aa-806e490e6f11
2019-06-15 11:32:00,299 INFO  impl.FollowerState (FollowerState.java:run(101)) - 62ea3db0-c282-4808-b3aa-806e490e6f11:group-FB38A10973FA changes to CANDIDATE, lastRpcTime:1099, electionTimeout:1097ms
2019-06-15 11:32:00,300 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 62ea3db0-c282-4808-b3aa-806e490e6f11: shutdown FollowerState
2019-06-15 11:32:00,300 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 62ea3db0-c282-4808-b3aa-806e490e6f11:group-FB38A10973FA changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-15 11:32:00,300 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 62ea3db0-c282-4808-b3aa-806e490e6f11: start LeaderElection
2019-06-15 11:32:00,304 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 62ea3db0-c282-4808-b3aa-806e490e6f11:group-FB38A10973FA:LeaderElection2: begin an election at term 1 for -1: [62ea3db0-c282-4808-b3aa-806e490e6f11:127.0.0.1:46193], old=null
2019-06-15 11:32:00,304 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 62ea3db0-c282-4808-b3aa-806e490e6f11: shutdown LeaderElection
2019-06-15 11:32:00,304 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 62ea3db0-c282-4808-b3aa-806e490e6f11:group-FB38A10973FA changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-15 11:32:00,304 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 62ea3db0-c282-4808-b3aa-806e490e6f11:group-FB38A10973FA change Leader from null to 62ea3db0-c282-4808-b3aa-806e490e6f11 at term 1 for becomeLeader, leader elected after 1107ms
2019-06-15 11:32:00,304 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-15 11:32:00,304 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-15 11:32:00,304 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-15 11:32:00,304 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-15 11:32:00,305 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 62ea3db0-c282-4808-b3aa-806e490e6f11: start LeaderState
2019-06-15 11:32:00,305 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 62ea3db0-c282-4808-b3aa-806e490e6f11-RaftLogWorker: Starting segment from index:0
2019-06-15 11:32:00,305 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 62ea3db0-c282-4808-b3aa-806e490e6f11:group-FB38A10973FA set configuration 0: [62ea3db0-c282-4808-b3aa-806e490e6f11:127.0.0.1:46193], old=null at 0
2019-06-15 11:32:00,340 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 62ea3db0-c282-4808-b3aa-806e490e6f11-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlereed53f55-f668-4eed-8977-6b914e46f8c5/ratis/6e0a0af7-6730-4dc1-8111-fb38a10973fa/current/log_inprogress_0
2019-06-15 11:32:01,235 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-15 11:32:01,235 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 62ea3db0-c282-4808-b3aa-806e490e6f11: close
2019-06-15 11:32:01,236 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 62ea3db0-c282-4808-b3aa-806e490e6f11: shutdown group-FB38A10973FA
2019-06-15 11:32:01,236 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-FB38A10973FA,id=62ea3db0-c282-4808-b3aa-806e490e6f11
2019-06-15 11:32:01,237 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 62ea3db0-c282-4808-b3aa-806e490e6f11: shutdown LeaderState
2019-06-15 11:32:01,237 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 62ea3db0-c282-4808-b3aa-806e490e6f11-PendingRequests: sendNotLeaderResponses
2019-06-15 11:32:01,238 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-62ea3db0-c282-4808-b3aa-806e490e6f11-group-FB38A10973FA: set stopIndex = 2
2019-06-15 11:32:01,238 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-15 11:32:01,239 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlereed53f55-f668-4eed-8977-6b914e46f8c5/ratis/6e0a0af7-6730-4dc1-8111-fb38a10973fa/sm/snapshot.1_2
2019-06-15 11:32:01,239 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 62ea3db0-c282-4808-b3aa-806e490e6f11:group-FB38A10973FA closes. The last applied log index is 2
2019-06-15 11:32:01,240 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 62ea3db0-c282-4808-b3aa-806e490e6f11-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-15 11:32:01,240 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 62ea3db0-c282-4808-b3aa-806e490e6f11-RaftLogWorker close()
2019-06-15 11:32:01,241 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 62ea3db0-c282-4808-b3aa-806e490e6f11: shutdown server with port 46193 now
2019-06-15 11:32:01,243 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 62ea3db0-c282-4808-b3aa-806e490e6f11: shutdown server with port 46193 successfully
2019-06-15 11:32:01,245 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-15 11:32:01,269 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler954996ea-a106-4bf7-af00-33f2208001ba/hdds of  storage type : DISK and capacity : 104021790720
2019-06-15 11:32:01,269 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler954996ea-a106-4bf7-af00-33f2208001ba/hdds to VolumeSet
2019-06-15 11:32:01,269 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@dc7b462
2019-06-15 11:32:01,270 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@dc7b462
2019-06-15 11:32:01,277 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 33551
2019-06-15 11:32:01,278 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-15 11:32:01,279 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-15 11:32:01,279 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 33551 (custom)
2019-06-15 11:32:01,279 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-15 11:32:01,279 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 11:32:01,280 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-15 11:32:01,280 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-15 11:32:01,281 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler954996ea-a106-4bf7-af00-33f2208001ba/ratis] (custom)
2019-06-15 11:32:01,281 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 44947
2019-06-15 11:32:01,281 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-15 11:32:01,281 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-15 11:32:01,282 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 2ebda382-593f-4750-a419-6c00ab38075c at port 33551
2019-06-15 11:32:01,291 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 2ebda382-593f-4750-a419-6c00ab38075c: start RPC server
2019-06-15 11:32:01,292 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 2ebda382-593f-4750-a419-6c00ab38075c: GrpcService started, listening on 0.0.0.0/0.0.0.0:33551
2019-06-15 11:32:01,304 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 2ebda382-593f-4750-a419-6c00ab38075c: addNew group-DB8E1F29184D:[2ebda382-593f-4750-a419-6c00ab38075c:127.0.0.1:33551] returns group-DB8E1F29184D:java.util.concurrent.CompletableFuture@56c3651f[Not completed]
2019-06-15 11:32:01,304 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 2ebda382-593f-4750-a419-6c00ab38075c: new RaftServerImpl for group-DB8E1F29184D:[2ebda382-593f-4750-a419-6c00ab38075c:127.0.0.1:33551] with ContainerStateMachine:uninitialized
2019-06-15 11:32:01,304 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-15 11:32:01,304 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-15 11:32:01,305 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-15 11:32:01,305 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-15 11:32:01,305 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 2ebda382-593f-4750-a419-6c00ab38075c:group-DB8E1F29184D ConfigurationManager, init=-1: [2ebda382-593f-4750-a419-6c00ab38075c:127.0.0.1:33551], old=null, confs=<EMPTY_MAP>
2019-06-15 11:32:01,305 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler954996ea-a106-4bf7-af00-33f2208001ba/ratis] (custom)
2019-06-15 11:32:01,305 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler954996ea-a106-4bf7-af00-33f2208001ba/ratis/1c06d129-43b9-4dd1-af8e-db8e1f29184d does not exist. Creating ...
2019-06-15 11:32:01,307 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler954996ea-a106-4bf7-af00-33f2208001ba/ratis/1c06d129-43b9-4dd1-af8e-db8e1f29184d/in_use.lock acquired by nodename 4196@ozone-unit-076618677d3-cbxt7-2821487498
2019-06-15 11:32:01,310 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler954996ea-a106-4bf7-af00-33f2208001ba/ratis/1c06d129-43b9-4dd1-af8e-db8e1f29184d has been successfully formatted.
2019-06-15 11:32:01,310 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-15 11:32:01,310 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-15 11:32:01,310 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-15 11:32:01,310 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 11:32:01,310 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 11:32:01,310 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-15 11:32:01,310 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 2ebda382-593f-4750-a419-6c00ab38075c-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler954996ea-a106-4bf7-af00-33f2208001ba/ratis/1c06d129-43b9-4dd1-af8e-db8e1f29184d
2019-06-15 11:32:01,311 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-15 11:32:01,311 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-15 11:32:01,311 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 11:32:01,311 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-15 11:32:01,311 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-15 11:32:01,311 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-15 11:32:01,311 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-15 11:32:01,311 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-15 11:32:01,311 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-15 11:32:01,311 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-15 11:32:01,312 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-15 11:32:01,312 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-15 11:32:01,312 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-15 11:32:01,312 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 2ebda382-593f-4750-a419-6c00ab38075c: start group-DB8E1F29184D
2019-06-15 11:32:01,312 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2ebda382-593f-4750-a419-6c00ab38075c:group-DB8E1F29184D changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-15 11:32:01,312 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2ebda382-593f-4750-a419-6c00ab38075c: start FollowerState
2019-06-15 11:32:01,313 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-DB8E1F29184D,id=2ebda382-593f-4750-a419-6c00ab38075c
2019-06-15 11:32:02,336 INFO  impl.FollowerState (FollowerState.java:run(101)) - 2ebda382-593f-4750-a419-6c00ab38075c:group-DB8E1F29184D changes to CANDIDATE, lastRpcTime:1023, electionTimeout:1023ms
2019-06-15 11:32:02,336 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 2ebda382-593f-4750-a419-6c00ab38075c: shutdown FollowerState
2019-06-15 11:32:02,336 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2ebda382-593f-4750-a419-6c00ab38075c:group-DB8E1F29184D changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-15 11:32:02,336 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2ebda382-593f-4750-a419-6c00ab38075c: start LeaderElection
2019-06-15 11:32:02,340 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 2ebda382-593f-4750-a419-6c00ab38075c:group-DB8E1F29184D:LeaderElection3: begin an election at term 1 for -1: [2ebda382-593f-4750-a419-6c00ab38075c:127.0.0.1:33551], old=null
2019-06-15 11:32:02,340 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 2ebda382-593f-4750-a419-6c00ab38075c: shutdown LeaderElection
2019-06-15 11:32:02,340 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2ebda382-593f-4750-a419-6c00ab38075c:group-DB8E1F29184D changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-15 11:32:02,340 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 2ebda382-593f-4750-a419-6c00ab38075c:group-DB8E1F29184D change Leader from null to 2ebda382-593f-4750-a419-6c00ab38075c at term 1 for becomeLeader, leader elected after 1030ms
2019-06-15 11:32:02,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-15 11:32:02,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-15 11:32:02,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-15 11:32:02,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-15 11:32:02,341 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2ebda382-593f-4750-a419-6c00ab38075c: start LeaderState
2019-06-15 11:32:02,341 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 2ebda382-593f-4750-a419-6c00ab38075c-RaftLogWorker: Starting segment from index:0
2019-06-15 11:32:02,343 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 2ebda382-593f-4750-a419-6c00ab38075c:group-DB8E1F29184D set configuration 0: [2ebda382-593f-4750-a419-6c00ab38075c:127.0.0.1:33551], old=null at 0
2019-06-15 11:32:02,377 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 2ebda382-593f-4750-a419-6c00ab38075c-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler954996ea-a106-4bf7-af00-33f2208001ba/ratis/1c06d129-43b9-4dd1-af8e-db8e1f29184d/current/log_inprogress_0
2019-06-15 11:32:03,350 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 8772442268417047379 is closed with bcsId 0.
2019-06-15 11:32:03,351 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-15 11:32:03,352 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 2ebda382-593f-4750-a419-6c00ab38075c: close
2019-06-15 11:32:03,352 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 2ebda382-593f-4750-a419-6c00ab38075c: shutdown group-DB8E1F29184D
2019-06-15 11:32:03,352 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-DB8E1F29184D,id=2ebda382-593f-4750-a419-6c00ab38075c
2019-06-15 11:32:03,352 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 2ebda382-593f-4750-a419-6c00ab38075c: shutdown LeaderState
2019-06-15 11:32:03,353 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 2ebda382-593f-4750-a419-6c00ab38075c-PendingRequests: sendNotLeaderResponses
2019-06-15 11:32:03,353 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-2ebda382-593f-4750-a419-6c00ab38075c-group-DB8E1F29184D: set stopIndex = 2
2019-06-15 11:32:03,353 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-15 11:32:03,354 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler954996ea-a106-4bf7-af00-33f2208001ba/ratis/1c06d129-43b9-4dd1-af8e-db8e1f29184d/sm/snapshot.1_2
2019-06-15 11:32:03,354 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 2ebda382-593f-4750-a419-6c00ab38075c:group-DB8E1F29184D closes. The last applied log index is 2
2019-06-15 11:32:03,354 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 2ebda382-593f-4750-a419-6c00ab38075c-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-15 11:32:03,355 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 2ebda382-593f-4750-a419-6c00ab38075c-RaftLogWorker close()
2019-06-15 11:32:03,357 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 2ebda382-593f-4750-a419-6c00ab38075c: shutdown server with port 33551 now
2019-06-15 11:32:03,358 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 2ebda382-593f-4750-a419-6c00ab38075c: shutdown server with port 33551 successfully
2019-06-15 11:32:03,386 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-15 11:32:03,407 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler92123516-08fd-4fb7-a8f1-29530f8ff8d3/hdds of  storage type : DISK and capacity : 104021790720
2019-06-15 11:32:03,407 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler92123516-08fd-4fb7-a8f1-29530f8ff8d3/hdds to VolumeSet
2019-06-15 11:32:03,408 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3971f0fe
2019-06-15 11:32:03,408 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3971f0fe
2019-06-15 11:32:03,418 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 42323
2019-06-15 11:32:03,418 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-15 11:32:03,419 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-15 11:32:03,419 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42323 (custom)
2019-06-15 11:32:03,420 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-15 11:32:03,420 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 11:32:03,420 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-15 11:32:03,420 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-15 11:32:03,421 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler92123516-08fd-4fb7-a8f1-29530f8ff8d3/ratis] (custom)
2019-06-15 11:32:03,421 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 35583
2019-06-15 11:32:03,422 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-15 11:32:03,422 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-15 11:32:03,422 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis c163056f-fe02-4eed-ba66-1b248d584446 at port 42323
2019-06-15 11:32:03,426 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - c163056f-fe02-4eed-ba66-1b248d584446: start RPC server
2019-06-15 11:32:03,427 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - c163056f-fe02-4eed-ba66-1b248d584446: GrpcService started, listening on 0.0.0.0/0.0.0.0:42323
Jun 15, 2019 11:32:03 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:46193} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 15, 2019 11:32:03 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:33551} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-15 11:32:03,443 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - c163056f-fe02-4eed-ba66-1b248d584446: addNew group-FB53D55380E7:[c163056f-fe02-4eed-ba66-1b248d584446:127.0.0.1:42323] returns group-FB53D55380E7:java.util.concurrent.CompletableFuture@e460268[Not completed]
2019-06-15 11:32:03,443 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - c163056f-fe02-4eed-ba66-1b248d584446: new RaftServerImpl for group-FB53D55380E7:[c163056f-fe02-4eed-ba66-1b248d584446:127.0.0.1:42323] with ContainerStateMachine:uninitialized
2019-06-15 11:32:03,443 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-15 11:32:03,444 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-15 11:32:03,444 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-15 11:32:03,444 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-15 11:32:03,444 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - c163056f-fe02-4eed-ba66-1b248d584446:group-FB53D55380E7 ConfigurationManager, init=-1: [c163056f-fe02-4eed-ba66-1b248d584446:127.0.0.1:42323], old=null, confs=<EMPTY_MAP>
2019-06-15 11:32:03,444 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler92123516-08fd-4fb7-a8f1-29530f8ff8d3/ratis] (custom)
2019-06-15 11:32:03,444 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler92123516-08fd-4fb7-a8f1-29530f8ff8d3/ratis/f6015dc5-0d2a-4da3-8c2e-fb53d55380e7 does not exist. Creating ...
2019-06-15 11:32:03,446 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler92123516-08fd-4fb7-a8f1-29530f8ff8d3/ratis/f6015dc5-0d2a-4da3-8c2e-fb53d55380e7/in_use.lock acquired by nodename 4196@ozone-unit-076618677d3-cbxt7-2821487498
2019-06-15 11:32:03,449 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler92123516-08fd-4fb7-a8f1-29530f8ff8d3/ratis/f6015dc5-0d2a-4da3-8c2e-fb53d55380e7 has been successfully formatted.
2019-06-15 11:32:03,449 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-15 11:32:03,449 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-15 11:32:03,449 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-15 11:32:03,449 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 11:32:03,449 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 11:32:03,449 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-15 11:32:03,449 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new c163056f-fe02-4eed-ba66-1b248d584446-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler92123516-08fd-4fb7-a8f1-29530f8ff8d3/ratis/f6015dc5-0d2a-4da3-8c2e-fb53d55380e7
2019-06-15 11:32:03,450 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-15 11:32:03,450 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-15 11:32:03,450 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 11:32:03,450 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-15 11:32:03,450 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-15 11:32:03,450 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-15 11:32:03,450 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-15 11:32:03,450 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-15 11:32:03,450 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-15 11:32:03,450 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-15 11:32:03,451 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-15 11:32:03,451 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-15 11:32:03,451 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-15 11:32:03,451 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - c163056f-fe02-4eed-ba66-1b248d584446: start group-FB53D55380E7
2019-06-15 11:32:03,451 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - c163056f-fe02-4eed-ba66-1b248d584446:group-FB53D55380E7 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-15 11:32:03,451 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c163056f-fe02-4eed-ba66-1b248d584446: start FollowerState
2019-06-15 11:32:03,452 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-FB53D55380E7,id=c163056f-fe02-4eed-ba66-1b248d584446
2019-06-15 11:32:04,591 INFO  impl.FollowerState (FollowerState.java:run(101)) - c163056f-fe02-4eed-ba66-1b248d584446:group-FB53D55380E7 changes to CANDIDATE, lastRpcTime:1139, electionTimeout:1139ms
2019-06-15 11:32:04,591 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - c163056f-fe02-4eed-ba66-1b248d584446: shutdown FollowerState
2019-06-15 11:32:04,591 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - c163056f-fe02-4eed-ba66-1b248d584446:group-FB53D55380E7 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-15 11:32:04,591 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c163056f-fe02-4eed-ba66-1b248d584446: start LeaderElection
2019-06-15 11:32:04,594 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - c163056f-fe02-4eed-ba66-1b248d584446:group-FB53D55380E7:LeaderElection4: begin an election at term 1 for -1: [c163056f-fe02-4eed-ba66-1b248d584446:127.0.0.1:42323], old=null
2019-06-15 11:32:04,594 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - c163056f-fe02-4eed-ba66-1b248d584446: shutdown LeaderElection
2019-06-15 11:32:04,594 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - c163056f-fe02-4eed-ba66-1b248d584446:group-FB53D55380E7 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-15 11:32:04,594 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - c163056f-fe02-4eed-ba66-1b248d584446:group-FB53D55380E7 change Leader from null to c163056f-fe02-4eed-ba66-1b248d584446 at term 1 for becomeLeader, leader elected after 1145ms
2019-06-15 11:32:04,595 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-15 11:32:04,595 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-15 11:32:04,595 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-15 11:32:04,595 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-15 11:32:04,595 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - c163056f-fe02-4eed-ba66-1b248d584446: start LeaderState
2019-06-15 11:32:04,595 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - c163056f-fe02-4eed-ba66-1b248d584446-RaftLogWorker: Starting segment from index:0
2019-06-15 11:32:04,596 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - c163056f-fe02-4eed-ba66-1b248d584446:group-FB53D55380E7 set configuration 0: [c163056f-fe02-4eed-ba66-1b248d584446:127.0.0.1:42323], old=null at 0
2019-06-15 11:32:04,632 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - c163056f-fe02-4eed-ba66-1b248d584446-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler92123516-08fd-4fb7-a8f1-29530f8ff8d3/ratis/f6015dc5-0d2a-4da3-8c2e-fb53d55380e7/current/log_inprogress_0
2019-06-15 11:32:05,491 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 3301899839850331605 is closed with bcsId 0.
2019-06-15 11:32:05,491 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-15 11:32:05,491 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - c163056f-fe02-4eed-ba66-1b248d584446: close
2019-06-15 11:32:05,492 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - c163056f-fe02-4eed-ba66-1b248d584446: shutdown group-FB53D55380E7
2019-06-15 11:32:05,492 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-FB53D55380E7,id=c163056f-fe02-4eed-ba66-1b248d584446
2019-06-15 11:32:05,492 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - c163056f-fe02-4eed-ba66-1b248d584446: shutdown LeaderState
2019-06-15 11:32:05,492 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - c163056f-fe02-4eed-ba66-1b248d584446-PendingRequests: sendNotLeaderResponses
2019-06-15 11:32:05,493 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-c163056f-fe02-4eed-ba66-1b248d584446-group-FB53D55380E7: set stopIndex = 2
2019-06-15 11:32:05,493 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-15 11:32:05,493 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler92123516-08fd-4fb7-a8f1-29530f8ff8d3/ratis/f6015dc5-0d2a-4da3-8c2e-fb53d55380e7/sm/snapshot.1_2
2019-06-15 11:32:05,494 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - c163056f-fe02-4eed-ba66-1b248d584446:group-FB53D55380E7 closes. The last applied log index is 2
2019-06-15 11:32:05,494 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - c163056f-fe02-4eed-ba66-1b248d584446-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-15 11:32:05,494 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - c163056f-fe02-4eed-ba66-1b248d584446-RaftLogWorker close()
2019-06-15 11:32:05,495 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - c163056f-fe02-4eed-ba66-1b248d584446: shutdown server with port 42323 now
2019-06-15 11:32:05,496 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - c163056f-fe02-4eed-ba66-1b248d584446: shutdown server with port 42323 successfully
2019-06-15 11:32:05,498 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-15 11:32:05,517 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4a938a18-29bc-4902-8ce9-3d3d1cf940e7/hdds of  storage type : DISK and capacity : 104021790720
2019-06-15 11:32:05,518 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4a938a18-29bc-4902-8ce9-3d3d1cf940e7/hdds to VolumeSet
2019-06-15 11:32:05,518 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@4fad6218
2019-06-15 11:32:05,518 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@4fad6218
2019-06-15 11:32:05,529 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43959
2019-06-15 11:32:05,530 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-15 11:32:05,530 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-15 11:32:05,531 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43959 (custom)
2019-06-15 11:32:05,531 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-15 11:32:05,531 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 11:32:05,531 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-15 11:32:05,531 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-15 11:32:05,532 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4a938a18-29bc-4902-8ce9-3d3d1cf940e7/ratis] (custom)
2019-06-15 11:32:05,532 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 37261
2019-06-15 11:32:05,532 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-15 11:32:05,532 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-15 11:32:05,532 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 27c36a26-e513-4305-af16-c07293554a97 at port 43959
2019-06-15 11:32:05,545 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 27c36a26-e513-4305-af16-c07293554a97: start RPC server
2019-06-15 11:32:05,545 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 27c36a26-e513-4305-af16-c07293554a97: GrpcService started, listening on 0.0.0.0/0.0.0.0:43959
2019-06-15 11:32:05,559 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 27c36a26-e513-4305-af16-c07293554a97: addNew group-08A83499A89F:[27c36a26-e513-4305-af16-c07293554a97:127.0.0.1:43959] returns group-08A83499A89F:java.util.concurrent.CompletableFuture@5a5645f2[Not completed]
2019-06-15 11:32:05,559 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 27c36a26-e513-4305-af16-c07293554a97: new RaftServerImpl for group-08A83499A89F:[27c36a26-e513-4305-af16-c07293554a97:127.0.0.1:43959] with ContainerStateMachine:uninitialized
2019-06-15 11:32:05,560 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-15 11:32:05,560 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-15 11:32:05,560 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-15 11:32:05,560 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-15 11:32:05,560 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 27c36a26-e513-4305-af16-c07293554a97:group-08A83499A89F ConfigurationManager, init=-1: [27c36a26-e513-4305-af16-c07293554a97:127.0.0.1:43959], old=null, confs=<EMPTY_MAP>
2019-06-15 11:32:05,560 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4a938a18-29bc-4902-8ce9-3d3d1cf940e7/ratis] (custom)
2019-06-15 11:32:05,560 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4a938a18-29bc-4902-8ce9-3d3d1cf940e7/ratis/ddeb5086-18e3-4240-ae6b-08a83499a89f does not exist. Creating ...
2019-06-15 11:32:05,563 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4a938a18-29bc-4902-8ce9-3d3d1cf940e7/ratis/ddeb5086-18e3-4240-ae6b-08a83499a89f/in_use.lock acquired by nodename 4196@ozone-unit-076618677d3-cbxt7-2821487498
2019-06-15 11:32:05,565 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4a938a18-29bc-4902-8ce9-3d3d1cf940e7/ratis/ddeb5086-18e3-4240-ae6b-08a83499a89f has been successfully formatted.
2019-06-15 11:32:05,565 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-15 11:32:05,565 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-15 11:32:05,565 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-15 11:32:05,565 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-15 11:32:05,565 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 11:32:05,566 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-15 11:32:05,566 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 27c36a26-e513-4305-af16-c07293554a97-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4a938a18-29bc-4902-8ce9-3d3d1cf940e7/ratis/ddeb5086-18e3-4240-ae6b-08a83499a89f
2019-06-15 11:32:05,566 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-15 11:32:05,566 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-15 11:32:05,566 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-15 11:32:05,566 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-15 11:32:05,566 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-15 11:32:05,566 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-15 11:32:05,566 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-15 11:32:05,566 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-15 11:32:05,567 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-15 11:32:05,567 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-15 11:32:05,567 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-15 11:32:05,567 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-15 11:32:05,567 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-15 11:32:05,567 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 27c36a26-e513-4305-af16-c07293554a97: start group-08A83499A89F
2019-06-15 11:32:05,567 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 27c36a26-e513-4305-af16-c07293554a97:group-08A83499A89F changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-15 11:32:05,568 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 27c36a26-e513-4305-af16-c07293554a97: start FollowerState
2019-06-15 11:32:05,571 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-08A83499A89F,id=27c36a26-e513-4305-af16-c07293554a97
2019-06-15 11:32:06,645 INFO  impl.FollowerState (FollowerState.java:run(101)) - 27c36a26-e513-4305-af16-c07293554a97:group-08A83499A89F changes to CANDIDATE, lastRpcTime:1077, electionTimeout:1074ms
2019-06-15 11:32:06,645 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 27c36a26-e513-4305-af16-c07293554a97: shutdown FollowerState
2019-06-15 11:32:06,645 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 27c36a26-e513-4305-af16-c07293554a97:group-08A83499A89F changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-15 11:32:06,645 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 27c36a26-e513-4305-af16-c07293554a97: start LeaderElection
2019-06-15 11:32:06,648 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 27c36a26-e513-4305-af16-c07293554a97:group-08A83499A89F:LeaderElection5: begin an election at term 1 for -1: [27c36a26-e513-4305-af16-c07293554a97:127.0.0.1:43959], old=null
2019-06-15 11:32:06,648 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 27c36a26-e513-4305-af16-c07293554a97: shutdown LeaderElection
2019-06-15 11:32:06,648 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 27c36a26-e513-4305-af16-c07293554a97:group-08A83499A89F changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-15 11:32:06,648 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 27c36a26-e513-4305-af16-c07293554a97:group-08A83499A89F change Leader from null to 27c36a26-e513-4305-af16-c07293554a97 at term 1 for becomeLeader, leader elected after 1083ms
2019-06-15 11:32:06,649 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-15 11:32:06,649 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-15 11:32:06,649 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-15 11:32:06,649 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-15 11:32:06,649 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 27c36a26-e513-4305-af16-c07293554a97: start LeaderState
2019-06-15 11:32:06,649 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 27c36a26-e513-4305-af16-c07293554a97-RaftLogWorker: Starting segment from index:0
2019-06-15 11:32:06,650 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 27c36a26-e513-4305-af16-c07293554a97:group-08A83499A89F set configuration 0: [27c36a26-e513-4305-af16-c07293554a97:127.0.0.1:43959], old=null at 0
2019-06-15 11:32:06,685 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 27c36a26-e513-4305-af16-c07293554a97-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4a938a18-29bc-4902-8ce9-3d3d1cf940e7/ratis/ddeb5086-18e3-4240-ae6b-08a83499a89f/current/log_inprogress_0
2019-06-15 11:32:07,611 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 8482455755803742544 is closed with bcsId 0.
2019-06-15 11:32:07,611 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-15 11:32:07,611 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 27c36a26-e513-4305-af16-c07293554a97: close
2019-06-15 11:32:07,612 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 27c36a26-e513-4305-af16-c07293554a97: shutdown group-08A83499A89F
2019-06-15 11:32:07,612 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-08A83499A89F,id=27c36a26-e513-4305-af16-c07293554a97
2019-06-15 11:32:07,612 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 27c36a26-e513-4305-af16-c07293554a97: shutdown LeaderState
2019-06-15 11:32:07,612 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 27c36a26-e513-4305-af16-c07293554a97-PendingRequests: sendNotLeaderResponses
2019-06-15 11:32:07,613 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-27c36a26-e513-4305-af16-c07293554a97-group-08A83499A89F: set stopIndex = 4
2019-06-15 11:32:07,613 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-15 11:32:07,613 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4a938a18-29bc-4902-8ce9-3d3d1cf940e7/ratis/ddeb5086-18e3-4240-ae6b-08a83499a89f/sm/snapshot.1_4
2019-06-15 11:32:07,614 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 27c36a26-e513-4305-af16-c07293554a97:group-08A83499A89F closes. The last applied log index is 4
2019-06-15 11:32:07,614 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 27c36a26-e513-4305-af16-c07293554a97-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-15 11:32:07,615 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 27c36a26-e513-4305-af16-c07293554a97-RaftLogWorker close()
2019-06-15 11:32:07,616 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 27c36a26-e513-4305-af16-c07293554a97: shutdown server with port 43959 now
2019-06-15 11:32:07,617 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 27c36a26-e513-4305-af16-c07293554a97: shutdown server with port 43959 successfully
2019-06-15 11:32:07,620 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
