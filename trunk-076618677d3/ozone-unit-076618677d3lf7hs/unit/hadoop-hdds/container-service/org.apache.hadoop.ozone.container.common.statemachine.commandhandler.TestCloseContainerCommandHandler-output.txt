2019-06-16 21:27:27,050 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera36a692c-558d-444b-83af-f9ac6ac8aaad/hdds of  storage type : DISK and capacity : 104021790720
2019-06-16 21:27:27,056 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera36a692c-558d-444b-83af-f9ac6ac8aaad/hdds to VolumeSet
2019-06-16 21:27:27,097 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-16 21:27:27,134 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-16 21:27:27,588 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 38173
2019-06-16 21:27:28,049 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-16 21:27:28,071 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-16 21:27:28,078 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 38173 (custom)
2019-06-16 21:27:28,079 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-16 21:27:28,082 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-16 21:27:28,082 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-16 21:27:28,083 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-16 21:27:28,231 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera36a692c-558d-444b-83af-f9ac6ac8aaad/ratis] (custom)
2019-06-16 21:27:28,243 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 46647
2019-06-16 21:27:28,268 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-16 21:27:28,269 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-16 21:27:28,270 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 31294428-928c-4a96-ac5e-368abcb38edc at port 38173
2019-06-16 21:27:28,325 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 31294428-928c-4a96-ac5e-368abcb38edc: start RPC server
2019-06-16 21:27:28,476 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 31294428-928c-4a96-ac5e-368abcb38edc: GrpcService started, listening on 0.0.0.0/0.0.0.0:38173
2019-06-16 21:27:28,803 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 31294428-928c-4a96-ac5e-368abcb38edc: addNew group-7912CA9F1F10:[31294428-928c-4a96-ac5e-368abcb38edc:127.0.0.1:38173] returns group-7912CA9F1F10:java.util.concurrent.CompletableFuture@5669f4e2[Not completed]
2019-06-16 21:27:28,842 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 31294428-928c-4a96-ac5e-368abcb38edc: new RaftServerImpl for group-7912CA9F1F10:[31294428-928c-4a96-ac5e-368abcb38edc:127.0.0.1:38173] with ContainerStateMachine:uninitialized
2019-06-16 21:27:28,844 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-16 21:27:28,844 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-16 21:27:28,844 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-16 21:27:28,845 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-16 21:27:28,851 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 31294428-928c-4a96-ac5e-368abcb38edc:group-7912CA9F1F10 ConfigurationManager, init=-1: [31294428-928c-4a96-ac5e-368abcb38edc:127.0.0.1:38173], old=null, confs=<EMPTY_MAP>
2019-06-16 21:27:28,851 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera36a692c-558d-444b-83af-f9ac6ac8aaad/ratis] (custom)
2019-06-16 21:27:28,857 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera36a692c-558d-444b-83af-f9ac6ac8aaad/ratis/41a0769f-b4f1-4c8d-a641-7912ca9f1f10 does not exist. Creating ...
2019-06-16 21:27:28,986 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera36a692c-558d-444b-83af-f9ac6ac8aaad/ratis/41a0769f-b4f1-4c8d-a641-7912ca9f1f10/in_use.lock acquired by nodename 4314@ozone-unit-076618677d3lf7hs-768681339
2019-06-16 21:27:28,996 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera36a692c-558d-444b-83af-f9ac6ac8aaad/ratis/41a0769f-b4f1-4c8d-a641-7912ca9f1f10 has been successfully formatted.
2019-06-16 21:27:28,998 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-16 21:27:28,998 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-16 21:27:29,000 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-16 21:27:29,002 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-16 21:27:29,006 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-16 21:27:29,010 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-16 21:27:29,012 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 31294428-928c-4a96-ac5e-368abcb38edc-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera36a692c-558d-444b-83af-f9ac6ac8aaad/ratis/41a0769f-b4f1-4c8d-a641-7912ca9f1f10
2019-06-16 21:27:29,013 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-16 21:27:29,013 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-16 21:27:29,015 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-16 21:27:29,015 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-16 21:27:29,016 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-16 21:27:29,016 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-16 21:27:29,017 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-16 21:27:29,017 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-16 21:27:29,018 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-16 21:27:29,020 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-16 21:27:29,025 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-16 21:27:29,026 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-16 21:27:29,026 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-16 21:27:29,143 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 31294428-928c-4a96-ac5e-368abcb38edc: start group-7912CA9F1F10
2019-06-16 21:27:29,144 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 31294428-928c-4a96-ac5e-368abcb38edc:group-7912CA9F1F10 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-16 21:27:29,145 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 31294428-928c-4a96-ac5e-368abcb38edc: start FollowerState
2019-06-16 21:27:29,148 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-7912CA9F1F10,id=31294428-928c-4a96-ac5e-368abcb38edc
2019-06-16 21:27:30,217 INFO  impl.FollowerState (FollowerState.java:run(101)) - 31294428-928c-4a96-ac5e-368abcb38edc:group-7912CA9F1F10 changes to CANDIDATE, lastRpcTime:1072, electionTimeout:1071ms
2019-06-16 21:27:30,218 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 31294428-928c-4a96-ac5e-368abcb38edc: shutdown FollowerState
2019-06-16 21:27:30,218 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 31294428-928c-4a96-ac5e-368abcb38edc:group-7912CA9F1F10 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-16 21:27:30,219 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 31294428-928c-4a96-ac5e-368abcb38edc: start LeaderElection
2019-06-16 21:27:30,222 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 31294428-928c-4a96-ac5e-368abcb38edc:group-7912CA9F1F10:LeaderElection1: begin an election at term 1 for -1: [31294428-928c-4a96-ac5e-368abcb38edc:127.0.0.1:38173], old=null
2019-06-16 21:27:30,223 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 31294428-928c-4a96-ac5e-368abcb38edc: shutdown LeaderElection
2019-06-16 21:27:30,224 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 31294428-928c-4a96-ac5e-368abcb38edc:group-7912CA9F1F10 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-16 21:27:30,224 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 31294428-928c-4a96-ac5e-368abcb38edc:group-7912CA9F1F10 change Leader from null to 31294428-928c-4a96-ac5e-368abcb38edc at term 1 for becomeLeader, leader elected after 1225ms
2019-06-16 21:27:30,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-16 21:27:30,228 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-16 21:27:30,229 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-16 21:27:30,230 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-16 21:27:30,237 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 31294428-928c-4a96-ac5e-368abcb38edc: start LeaderState
2019-06-16 21:27:30,249 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 31294428-928c-4a96-ac5e-368abcb38edc-RaftLogWorker: Starting segment from index:0
2019-06-16 21:27:30,255 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 31294428-928c-4a96-ac5e-368abcb38edc:group-7912CA9F1F10 set configuration 0: [31294428-928c-4a96-ac5e-368abcb38edc:127.0.0.1:38173], old=null at 0
2019-06-16 21:27:30,389 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 31294428-928c-4a96-ac5e-368abcb38edc-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera36a692c-558d-444b-83af-f9ac6ac8aaad/ratis/41a0769f-b4f1-4c8d-a641-7912ca9f1f10/current/log_inprogress_0
2019-06-16 21:27:31,378 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-16 21:27:31,432 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 8449574402603108636 is closed with bcsId 0.
2019-06-16 21:27:31,433 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-16 21:27:31,434 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 31294428-928c-4a96-ac5e-368abcb38edc: close
2019-06-16 21:27:31,435 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 31294428-928c-4a96-ac5e-368abcb38edc: shutdown group-7912CA9F1F10
2019-06-16 21:27:31,435 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-7912CA9F1F10,id=31294428-928c-4a96-ac5e-368abcb38edc
2019-06-16 21:27:31,435 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 31294428-928c-4a96-ac5e-368abcb38edc: shutdown LeaderState
2019-06-16 21:27:31,436 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 31294428-928c-4a96-ac5e-368abcb38edc-PendingRequests: sendNotLeaderResponses
2019-06-16 21:27:31,438 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-31294428-928c-4a96-ac5e-368abcb38edc-group-7912CA9F1F10: set stopIndex = 4
2019-06-16 21:27:31,438 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-16 21:27:31,439 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera36a692c-558d-444b-83af-f9ac6ac8aaad/ratis/41a0769f-b4f1-4c8d-a641-7912ca9f1f10/sm/snapshot.1_4
2019-06-16 21:27:31,446 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 31294428-928c-4a96-ac5e-368abcb38edc:group-7912CA9F1F10 closes. The last applied log index is 4
2019-06-16 21:27:31,447 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 31294428-928c-4a96-ac5e-368abcb38edc-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-16 21:27:31,448 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 31294428-928c-4a96-ac5e-368abcb38edc-RaftLogWorker close()
2019-06-16 21:27:31,449 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 31294428-928c-4a96-ac5e-368abcb38edc: shutdown server with port 38173 now
2019-06-16 21:27:31,452 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 31294428-928c-4a96-ac5e-368abcb38edc: shutdown server with port 38173 successfully
2019-06-16 21:27:31,464 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-16 21:27:31,502 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler934591dd-da0d-4093-824c-a4759a4e7d63/hdds of  storage type : DISK and capacity : 104021790720
2019-06-16 21:27:31,503 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler934591dd-da0d-4093-824c-a4759a4e7d63/hdds to VolumeSet
2019-06-16 21:27:31,503 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3a2b2322
2019-06-16 21:27:31,509 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3a2b2322
2019-06-16 21:27:31,525 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 42275
2019-06-16 21:27:31,529 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-16 21:27:31,530 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-16 21:27:31,530 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42275 (custom)
2019-06-16 21:27:31,530 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-16 21:27:31,531 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-16 21:27:31,531 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-16 21:27:31,531 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-16 21:27:31,532 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler934591dd-da0d-4093-824c-a4759a4e7d63/ratis] (custom)
2019-06-16 21:27:31,533 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42415
2019-06-16 21:27:31,533 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-16 21:27:31,533 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-16 21:27:31,534 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 327bb961-9711-4534-a311-fe956cf3494e at port 42275
2019-06-16 21:27:31,580 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 327bb961-9711-4534-a311-fe956cf3494e: start RPC server
2019-06-16 21:27:31,581 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 327bb961-9711-4534-a311-fe956cf3494e: GrpcService started, listening on 0.0.0.0/0.0.0.0:42275
2019-06-16 21:27:31,595 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 327bb961-9711-4534-a311-fe956cf3494e: addNew group-3507CF822370:[327bb961-9711-4534-a311-fe956cf3494e:127.0.0.1:42275] returns group-3507CF822370:java.util.concurrent.CompletableFuture@59fb9cf5[Not completed]
2019-06-16 21:27:31,596 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 327bb961-9711-4534-a311-fe956cf3494e: new RaftServerImpl for group-3507CF822370:[327bb961-9711-4534-a311-fe956cf3494e:127.0.0.1:42275] with ContainerStateMachine:uninitialized
2019-06-16 21:27:31,597 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-16 21:27:31,597 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-16 21:27:31,597 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-16 21:27:31,597 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-16 21:27:31,597 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 327bb961-9711-4534-a311-fe956cf3494e:group-3507CF822370 ConfigurationManager, init=-1: [327bb961-9711-4534-a311-fe956cf3494e:127.0.0.1:42275], old=null, confs=<EMPTY_MAP>
2019-06-16 21:27:31,598 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler934591dd-da0d-4093-824c-a4759a4e7d63/ratis] (custom)
2019-06-16 21:27:31,598 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler934591dd-da0d-4093-824c-a4759a4e7d63/ratis/8186a1ca-837d-4b1c-ab37-3507cf822370 does not exist. Creating ...
2019-06-16 21:27:31,602 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler934591dd-da0d-4093-824c-a4759a4e7d63/ratis/8186a1ca-837d-4b1c-ab37-3507cf822370/in_use.lock acquired by nodename 4314@ozone-unit-076618677d3lf7hs-768681339
2019-06-16 21:27:31,604 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler934591dd-da0d-4093-824c-a4759a4e7d63/ratis/8186a1ca-837d-4b1c-ab37-3507cf822370 has been successfully formatted.
2019-06-16 21:27:31,604 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-16 21:27:31,604 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-16 21:27:31,605 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-16 21:27:31,605 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-16 21:27:31,605 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-16 21:27:31,605 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-16 21:27:31,605 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 327bb961-9711-4534-a311-fe956cf3494e-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler934591dd-da0d-4093-824c-a4759a4e7d63/ratis/8186a1ca-837d-4b1c-ab37-3507cf822370
2019-06-16 21:27:31,605 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-16 21:27:31,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-16 21:27:31,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-16 21:27:31,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-16 21:27:31,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-16 21:27:31,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-16 21:27:31,606 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-16 21:27:31,607 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-16 21:27:31,607 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-16 21:27:31,607 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-16 21:27:31,609 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-16 21:27:31,610 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-16 21:27:31,610 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-16 21:27:31,610 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 327bb961-9711-4534-a311-fe956cf3494e: start group-3507CF822370
2019-06-16 21:27:31,610 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 327bb961-9711-4534-a311-fe956cf3494e:group-3507CF822370 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-16 21:27:31,610 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 327bb961-9711-4534-a311-fe956cf3494e: start FollowerState
2019-06-16 21:27:31,611 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-3507CF822370,id=327bb961-9711-4534-a311-fe956cf3494e
2019-06-16 21:27:32,804 INFO  impl.FollowerState (FollowerState.java:run(101)) - 327bb961-9711-4534-a311-fe956cf3494e:group-3507CF822370 changes to CANDIDATE, lastRpcTime:1193, electionTimeout:1193ms
2019-06-16 21:27:32,804 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 327bb961-9711-4534-a311-fe956cf3494e: shutdown FollowerState
2019-06-16 21:27:32,804 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 327bb961-9711-4534-a311-fe956cf3494e:group-3507CF822370 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-16 21:27:32,805 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 327bb961-9711-4534-a311-fe956cf3494e: start LeaderElection
2019-06-16 21:27:32,808 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 327bb961-9711-4534-a311-fe956cf3494e:group-3507CF822370:LeaderElection2: begin an election at term 1 for -1: [327bb961-9711-4534-a311-fe956cf3494e:127.0.0.1:42275], old=null
2019-06-16 21:27:32,808 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 327bb961-9711-4534-a311-fe956cf3494e: shutdown LeaderElection
2019-06-16 21:27:32,808 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 327bb961-9711-4534-a311-fe956cf3494e:group-3507CF822370 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-16 21:27:32,809 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 327bb961-9711-4534-a311-fe956cf3494e:group-3507CF822370 change Leader from null to 327bb961-9711-4534-a311-fe956cf3494e at term 1 for becomeLeader, leader elected after 1204ms
2019-06-16 21:27:32,809 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-16 21:27:32,809 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-16 21:27:32,809 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-16 21:27:32,809 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-16 21:27:32,809 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 327bb961-9711-4534-a311-fe956cf3494e: start LeaderState
2019-06-16 21:27:32,810 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 327bb961-9711-4534-a311-fe956cf3494e-RaftLogWorker: Starting segment from index:0
2019-06-16 21:27:32,810 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 327bb961-9711-4534-a311-fe956cf3494e:group-3507CF822370 set configuration 0: [327bb961-9711-4534-a311-fe956cf3494e:127.0.0.1:42275], old=null at 0
2019-06-16 21:27:32,846 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 327bb961-9711-4534-a311-fe956cf3494e-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler934591dd-da0d-4093-824c-a4759a4e7d63/ratis/8186a1ca-837d-4b1c-ab37-3507cf822370/current/log_inprogress_0
2019-06-16 21:27:33,644 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-16 21:27:33,645 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 327bb961-9711-4534-a311-fe956cf3494e: close
2019-06-16 21:27:33,646 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 327bb961-9711-4534-a311-fe956cf3494e: shutdown group-3507CF822370
2019-06-16 21:27:33,646 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-3507CF822370,id=327bb961-9711-4534-a311-fe956cf3494e
2019-06-16 21:27:33,646 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 327bb961-9711-4534-a311-fe956cf3494e: shutdown LeaderState
2019-06-16 21:27:33,646 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 327bb961-9711-4534-a311-fe956cf3494e-PendingRequests: sendNotLeaderResponses
2019-06-16 21:27:33,647 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-327bb961-9711-4534-a311-fe956cf3494e-group-3507CF822370: set stopIndex = 2
2019-06-16 21:27:33,647 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-16 21:27:33,647 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler934591dd-da0d-4093-824c-a4759a4e7d63/ratis/8186a1ca-837d-4b1c-ab37-3507cf822370/sm/snapshot.1_2
2019-06-16 21:27:33,648 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 327bb961-9711-4534-a311-fe956cf3494e:group-3507CF822370 closes. The last applied log index is 2
2019-06-16 21:27:33,648 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 327bb961-9711-4534-a311-fe956cf3494e-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-16 21:27:33,649 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 327bb961-9711-4534-a311-fe956cf3494e-RaftLogWorker close()
2019-06-16 21:27:33,650 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 327bb961-9711-4534-a311-fe956cf3494e: shutdown server with port 42275 now
2019-06-16 21:27:33,651 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 327bb961-9711-4534-a311-fe956cf3494e: shutdown server with port 42275 successfully
2019-06-16 21:27:33,659 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-16 21:27:33,683 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerad19a945-b746-4eb6-a7b4-f896e7e8097e/hdds of  storage type : DISK and capacity : 104021790720
2019-06-16 21:27:33,683 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerad19a945-b746-4eb6-a7b4-f896e7e8097e/hdds to VolumeSet
2019-06-16 21:27:33,683 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@26a2f7f9
2019-06-16 21:27:33,684 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@26a2f7f9
2019-06-16 21:27:33,695 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 42767
2019-06-16 21:27:33,695 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-16 21:27:33,696 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-16 21:27:33,696 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42767 (custom)
2019-06-16 21:27:33,697 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-16 21:27:33,697 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-16 21:27:33,697 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-16 21:27:33,697 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-16 21:27:33,698 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerad19a945-b746-4eb6-a7b4-f896e7e8097e/ratis] (custom)
2019-06-16 21:27:33,698 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 44359
2019-06-16 21:27:33,699 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-16 21:27:33,699 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-16 21:27:33,699 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis fbb5ab6c-6cab-451d-ae1c-5e84e62f694c at port 42767
2019-06-16 21:27:33,720 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c: start RPC server
2019-06-16 21:27:33,721 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c: GrpcService started, listening on 0.0.0.0/0.0.0.0:42767
2019-06-16 21:27:33,733 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c: addNew group-D67383688172:[fbb5ab6c-6cab-451d-ae1c-5e84e62f694c:127.0.0.1:42767] returns group-D67383688172:java.util.concurrent.CompletableFuture@5ee17eb6[Not completed]
2019-06-16 21:27:33,734 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c: new RaftServerImpl for group-D67383688172:[fbb5ab6c-6cab-451d-ae1c-5e84e62f694c:127.0.0.1:42767] with ContainerStateMachine:uninitialized
2019-06-16 21:27:33,735 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-16 21:27:33,735 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-16 21:27:33,735 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-16 21:27:33,735 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-16 21:27:33,735 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c:group-D67383688172 ConfigurationManager, init=-1: [fbb5ab6c-6cab-451d-ae1c-5e84e62f694c:127.0.0.1:42767], old=null, confs=<EMPTY_MAP>
2019-06-16 21:27:33,736 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerad19a945-b746-4eb6-a7b4-f896e7e8097e/ratis] (custom)
2019-06-16 21:27:33,736 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerad19a945-b746-4eb6-a7b4-f896e7e8097e/ratis/6e96c479-a49d-4d7a-ae47-d67383688172 does not exist. Creating ...
2019-06-16 21:27:33,739 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerad19a945-b746-4eb6-a7b4-f896e7e8097e/ratis/6e96c479-a49d-4d7a-ae47-d67383688172/in_use.lock acquired by nodename 4314@ozone-unit-076618677d3lf7hs-768681339
2019-06-16 21:27:33,741 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerad19a945-b746-4eb6-a7b4-f896e7e8097e/ratis/6e96c479-a49d-4d7a-ae47-d67383688172 has been successfully formatted.
2019-06-16 21:27:33,741 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-16 21:27:33,741 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-16 21:27:33,742 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-16 21:27:33,742 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-16 21:27:33,742 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-16 21:27:33,742 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-16 21:27:33,742 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new fbb5ab6c-6cab-451d-ae1c-5e84e62f694c-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerad19a945-b746-4eb6-a7b4-f896e7e8097e/ratis/6e96c479-a49d-4d7a-ae47-d67383688172
2019-06-16 21:27:33,742 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-16 21:27:33,742 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-16 21:27:33,742 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-16 21:27:33,742 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-16 21:27:33,743 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-16 21:27:33,743 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-16 21:27:33,743 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-16 21:27:33,743 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-16 21:27:33,743 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-16 21:27:33,743 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-16 21:27:33,745 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-16 21:27:33,745 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-16 21:27:33,746 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-16 21:27:33,746 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c: start group-D67383688172
2019-06-16 21:27:33,746 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c:group-D67383688172 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-16 21:27:33,746 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c: start FollowerState
2019-06-16 21:27:33,746 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-D67383688172,id=fbb5ab6c-6cab-451d-ae1c-5e84e62f694c
2019-06-16 21:27:34,826 INFO  impl.FollowerState (FollowerState.java:run(101)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c:group-D67383688172 changes to CANDIDATE, lastRpcTime:1080, electionTimeout:1080ms
2019-06-16 21:27:34,827 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c: shutdown FollowerState
2019-06-16 21:27:34,827 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c:group-D67383688172 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-16 21:27:34,827 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c: start LeaderElection
2019-06-16 21:27:34,830 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c:group-D67383688172:LeaderElection3: begin an election at term 1 for -1: [fbb5ab6c-6cab-451d-ae1c-5e84e62f694c:127.0.0.1:42767], old=null
2019-06-16 21:27:34,830 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c: shutdown LeaderElection
2019-06-16 21:27:34,830 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c:group-D67383688172 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-16 21:27:34,830 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c:group-D67383688172 change Leader from null to fbb5ab6c-6cab-451d-ae1c-5e84e62f694c at term 1 for becomeLeader, leader elected after 1088ms
2019-06-16 21:27:34,830 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-16 21:27:34,831 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-16 21:27:34,831 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-16 21:27:34,831 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-16 21:27:34,831 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c: start LeaderState
2019-06-16 21:27:34,831 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c-RaftLogWorker: Starting segment from index:0
2019-06-16 21:27:34,832 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c:group-D67383688172 set configuration 0: [fbb5ab6c-6cab-451d-ae1c-5e84e62f694c:127.0.0.1:42767], old=null at 0
2019-06-16 21:27:34,867 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerad19a945-b746-4eb6-a7b4-f896e7e8097e/ratis/6e96c479-a49d-4d7a-ae47-d67383688172/current/log_inprogress_0
2019-06-16 21:27:35,802 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 5009446777841316691 is closed with bcsId 0.
2019-06-16 21:27:35,803 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-16 21:27:35,803 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c: close
2019-06-16 21:27:35,804 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c: shutdown group-D67383688172
2019-06-16 21:27:35,804 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-D67383688172,id=fbb5ab6c-6cab-451d-ae1c-5e84e62f694c
2019-06-16 21:27:35,804 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c: shutdown LeaderState
2019-06-16 21:27:35,805 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c-PendingRequests: sendNotLeaderResponses
2019-06-16 21:27:35,806 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-fbb5ab6c-6cab-451d-ae1c-5e84e62f694c-group-D67383688172: set stopIndex = 2
2019-06-16 21:27:35,806 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-16 21:27:35,806 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerad19a945-b746-4eb6-a7b4-f896e7e8097e/ratis/6e96c479-a49d-4d7a-ae47-d67383688172/sm/snapshot.1_2
2019-06-16 21:27:35,806 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c:group-D67383688172 closes. The last applied log index is 2
2019-06-16 21:27:35,807 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-16 21:27:35,808 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c-RaftLogWorker close()
2019-06-16 21:27:35,810 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c: shutdown server with port 42767 now
2019-06-16 21:27:35,811 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - fbb5ab6c-6cab-451d-ae1c-5e84e62f694c: shutdown server with port 42767 successfully
2019-06-16 21:27:35,818 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-16 21:27:35,853 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler431770d7-6337-40bb-9d62-68b066353001/hdds of  storage type : DISK and capacity : 104021790720
2019-06-16 21:27:35,853 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler431770d7-6337-40bb-9d62-68b066353001/hdds to VolumeSet
2019-06-16 21:27:35,853 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@66153688
2019-06-16 21:27:35,854 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@66153688
2019-06-16 21:27:35,868 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 42235
2019-06-16 21:27:35,869 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-16 21:27:35,869 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-16 21:27:35,870 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42235 (custom)
2019-06-16 21:27:35,870 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-16 21:27:35,870 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-16 21:27:35,870 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-16 21:27:35,871 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-16 21:27:35,871 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler431770d7-6337-40bb-9d62-68b066353001/ratis] (custom)
2019-06-16 21:27:35,872 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 34637
2019-06-16 21:27:35,872 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-16 21:27:35,872 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-16 21:27:35,872 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 92e44fef-dc45-4c53-b2db-17d755232072 at port 42235
2019-06-16 21:27:35,900 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 92e44fef-dc45-4c53-b2db-17d755232072: start RPC server
2019-06-16 21:27:35,901 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 92e44fef-dc45-4c53-b2db-17d755232072: GrpcService started, listening on 0.0.0.0/0.0.0.0:42235
Jun 16, 2019 9:27:35 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:42275} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 16, 2019 9:27:35 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:42767} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-16 21:27:35,915 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 92e44fef-dc45-4c53-b2db-17d755232072: addNew group-0F248ADEA881:[92e44fef-dc45-4c53-b2db-17d755232072:127.0.0.1:42235] returns group-0F248ADEA881:java.util.concurrent.CompletableFuture@1b4be1ee[Not completed]
2019-06-16 21:27:35,916 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 92e44fef-dc45-4c53-b2db-17d755232072: new RaftServerImpl for group-0F248ADEA881:[92e44fef-dc45-4c53-b2db-17d755232072:127.0.0.1:42235] with ContainerStateMachine:uninitialized
2019-06-16 21:27:35,916 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-16 21:27:35,916 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-16 21:27:35,916 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-16 21:27:35,917 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-16 21:27:35,917 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 92e44fef-dc45-4c53-b2db-17d755232072:group-0F248ADEA881 ConfigurationManager, init=-1: [92e44fef-dc45-4c53-b2db-17d755232072:127.0.0.1:42235], old=null, confs=<EMPTY_MAP>
2019-06-16 21:27:35,917 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler431770d7-6337-40bb-9d62-68b066353001/ratis] (custom)
2019-06-16 21:27:35,917 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler431770d7-6337-40bb-9d62-68b066353001/ratis/13e7dd25-c90f-4ab9-8a67-0f248adea881 does not exist. Creating ...
2019-06-16 21:27:35,920 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler431770d7-6337-40bb-9d62-68b066353001/ratis/13e7dd25-c90f-4ab9-8a67-0f248adea881/in_use.lock acquired by nodename 4314@ozone-unit-076618677d3lf7hs-768681339
2019-06-16 21:27:35,922 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler431770d7-6337-40bb-9d62-68b066353001/ratis/13e7dd25-c90f-4ab9-8a67-0f248adea881 has been successfully formatted.
2019-06-16 21:27:35,922 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-16 21:27:35,922 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-16 21:27:35,922 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-16 21:27:35,922 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-16 21:27:35,922 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-16 21:27:35,923 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-16 21:27:35,923 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 92e44fef-dc45-4c53-b2db-17d755232072-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler431770d7-6337-40bb-9d62-68b066353001/ratis/13e7dd25-c90f-4ab9-8a67-0f248adea881
2019-06-16 21:27:35,923 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-16 21:27:35,923 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-16 21:27:35,923 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-16 21:27:35,923 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-16 21:27:35,923 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-16 21:27:35,923 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-16 21:27:35,924 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-16 21:27:35,924 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-16 21:27:35,924 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-16 21:27:35,924 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-16 21:27:35,924 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-16 21:27:35,924 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-16 21:27:35,924 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-16 21:27:35,925 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 92e44fef-dc45-4c53-b2db-17d755232072: start group-0F248ADEA881
2019-06-16 21:27:35,925 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 92e44fef-dc45-4c53-b2db-17d755232072:group-0F248ADEA881 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-16 21:27:35,925 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 92e44fef-dc45-4c53-b2db-17d755232072: start FollowerState
2019-06-16 21:27:35,925 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-0F248ADEA881,id=92e44fef-dc45-4c53-b2db-17d755232072
2019-06-16 21:27:36,962 INFO  impl.FollowerState (FollowerState.java:run(101)) - 92e44fef-dc45-4c53-b2db-17d755232072:group-0F248ADEA881 changes to CANDIDATE, lastRpcTime:1037, electionTimeout:1037ms
2019-06-16 21:27:36,962 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 92e44fef-dc45-4c53-b2db-17d755232072: shutdown FollowerState
2019-06-16 21:27:36,962 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 92e44fef-dc45-4c53-b2db-17d755232072:group-0F248ADEA881 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-16 21:27:36,962 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 92e44fef-dc45-4c53-b2db-17d755232072: start LeaderElection
2019-06-16 21:27:36,965 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 92e44fef-dc45-4c53-b2db-17d755232072:group-0F248ADEA881:LeaderElection4: begin an election at term 1 for -1: [92e44fef-dc45-4c53-b2db-17d755232072:127.0.0.1:42235], old=null
2019-06-16 21:27:36,966 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 92e44fef-dc45-4c53-b2db-17d755232072: shutdown LeaderElection
2019-06-16 21:27:36,966 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 92e44fef-dc45-4c53-b2db-17d755232072:group-0F248ADEA881 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-16 21:27:36,966 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 92e44fef-dc45-4c53-b2db-17d755232072:group-0F248ADEA881 change Leader from null to 92e44fef-dc45-4c53-b2db-17d755232072 at term 1 for becomeLeader, leader elected after 1043ms
2019-06-16 21:27:36,966 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-16 21:27:36,966 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-16 21:27:36,966 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-16 21:27:36,966 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-16 21:27:36,966 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 92e44fef-dc45-4c53-b2db-17d755232072: start LeaderState
2019-06-16 21:27:36,966 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 92e44fef-dc45-4c53-b2db-17d755232072-RaftLogWorker: Starting segment from index:0
2019-06-16 21:27:36,967 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 92e44fef-dc45-4c53-b2db-17d755232072:group-0F248ADEA881 set configuration 0: [92e44fef-dc45-4c53-b2db-17d755232072:127.0.0.1:42235], old=null at 0
2019-06-16 21:27:37,008 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 92e44fef-dc45-4c53-b2db-17d755232072-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler431770d7-6337-40bb-9d62-68b066353001/ratis/13e7dd25-c90f-4ab9-8a67-0f248adea881/current/log_inprogress_0
2019-06-16 21:27:37,965 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 3914278099196845579 is closed with bcsId 0.
2019-06-16 21:27:37,966 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-16 21:27:37,966 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 92e44fef-dc45-4c53-b2db-17d755232072: close
2019-06-16 21:27:37,966 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 92e44fef-dc45-4c53-b2db-17d755232072: shutdown group-0F248ADEA881
2019-06-16 21:27:37,967 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-0F248ADEA881,id=92e44fef-dc45-4c53-b2db-17d755232072
2019-06-16 21:27:37,967 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 92e44fef-dc45-4c53-b2db-17d755232072: shutdown LeaderState
2019-06-16 21:27:37,967 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 92e44fef-dc45-4c53-b2db-17d755232072-PendingRequests: sendNotLeaderResponses
2019-06-16 21:27:37,968 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-92e44fef-dc45-4c53-b2db-17d755232072-group-0F248ADEA881: set stopIndex = 2
2019-06-16 21:27:37,968 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-16 21:27:37,969 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler431770d7-6337-40bb-9d62-68b066353001/ratis/13e7dd25-c90f-4ab9-8a67-0f248adea881/sm/snapshot.1_2
2019-06-16 21:27:37,969 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 92e44fef-dc45-4c53-b2db-17d755232072:group-0F248ADEA881 closes. The last applied log index is 2
2019-06-16 21:27:37,969 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 92e44fef-dc45-4c53-b2db-17d755232072-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-16 21:27:37,970 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 92e44fef-dc45-4c53-b2db-17d755232072-RaftLogWorker close()
2019-06-16 21:27:37,971 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 92e44fef-dc45-4c53-b2db-17d755232072: shutdown server with port 42235 now
2019-06-16 21:27:37,972 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 92e44fef-dc45-4c53-b2db-17d755232072: shutdown server with port 42235 successfully
2019-06-16 21:27:37,975 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-16 21:27:37,999 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb5220fc8-aa8a-4365-a7b5-8c31c08c124e/hdds of  storage type : DISK and capacity : 104021790720
2019-06-16 21:27:38,000 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb5220fc8-aa8a-4365-a7b5-8c31c08c124e/hdds to VolumeSet
2019-06-16 21:27:38,000 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@68217d41
2019-06-16 21:27:38,000 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@68217d41
2019-06-16 21:27:38,011 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 42213
2019-06-16 21:27:38,012 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-16 21:27:38,013 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-16 21:27:38,013 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42213 (custom)
2019-06-16 21:27:38,013 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-16 21:27:38,013 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-16 21:27:38,014 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-16 21:27:38,014 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-16 21:27:38,014 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb5220fc8-aa8a-4365-a7b5-8c31c08c124e/ratis] (custom)
2019-06-16 21:27:38,015 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 39795
2019-06-16 21:27:38,015 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-16 21:27:38,015 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-16 21:27:38,019 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4 at port 42213
2019-06-16 21:27:38,056 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4: start RPC server
2019-06-16 21:27:38,058 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4: GrpcService started, listening on 0.0.0.0/0.0.0.0:42213
2019-06-16 21:27:38,077 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4: addNew group-F551D3354062:[b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4:127.0.0.1:42213] returns group-F551D3354062:java.util.concurrent.CompletableFuture@19f7f8c7[Not completed]
2019-06-16 21:27:38,078 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4: new RaftServerImpl for group-F551D3354062:[b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4:127.0.0.1:42213] with ContainerStateMachine:uninitialized
2019-06-16 21:27:38,079 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-16 21:27:38,079 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-16 21:27:38,079 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-16 21:27:38,080 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-16 21:27:38,080 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4:group-F551D3354062 ConfigurationManager, init=-1: [b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4:127.0.0.1:42213], old=null, confs=<EMPTY_MAP>
2019-06-16 21:27:38,080 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb5220fc8-aa8a-4365-a7b5-8c31c08c124e/ratis] (custom)
2019-06-16 21:27:38,080 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb5220fc8-aa8a-4365-a7b5-8c31c08c124e/ratis/926b31e2-3b02-4c51-ae20-f551d3354062 does not exist. Creating ...
2019-06-16 21:27:38,083 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb5220fc8-aa8a-4365-a7b5-8c31c08c124e/ratis/926b31e2-3b02-4c51-ae20-f551d3354062/in_use.lock acquired by nodename 4314@ozone-unit-076618677d3lf7hs-768681339
2019-06-16 21:27:38,085 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb5220fc8-aa8a-4365-a7b5-8c31c08c124e/ratis/926b31e2-3b02-4c51-ae20-f551d3354062 has been successfully formatted.
2019-06-16 21:27:38,085 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-16 21:27:38,085 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-16 21:27:38,085 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-16 21:27:38,085 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-16 21:27:38,085 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-16 21:27:38,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-16 21:27:38,086 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb5220fc8-aa8a-4365-a7b5-8c31c08c124e/ratis/926b31e2-3b02-4c51-ae20-f551d3354062
2019-06-16 21:27:38,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-16 21:27:38,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-16 21:27:38,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-16 21:27:38,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-16 21:27:38,086 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-16 21:27:38,087 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-16 21:27:38,087 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-16 21:27:38,087 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-16 21:27:38,087 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-16 21:27:38,087 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-16 21:27:38,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-16 21:27:38,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-16 21:27:38,088 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-16 21:27:38,088 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4: start group-F551D3354062
2019-06-16 21:27:38,088 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4:group-F551D3354062 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-16 21:27:38,088 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4: start FollowerState
2019-06-16 21:27:38,089 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-F551D3354062,id=b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4
2019-06-16 21:27:39,160 INFO  impl.FollowerState (FollowerState.java:run(101)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4:group-F551D3354062 changes to CANDIDATE, lastRpcTime:1072, electionTimeout:1071ms
2019-06-16 21:27:39,161 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4: shutdown FollowerState
2019-06-16 21:27:39,161 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4:group-F551D3354062 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-16 21:27:39,161 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4: start LeaderElection
2019-06-16 21:27:39,165 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4:group-F551D3354062:LeaderElection5: begin an election at term 1 for -1: [b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4:127.0.0.1:42213], old=null
2019-06-16 21:27:39,165 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4: shutdown LeaderElection
2019-06-16 21:27:39,166 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4:group-F551D3354062 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-16 21:27:39,166 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4:group-F551D3354062 change Leader from null to b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4 at term 1 for becomeLeader, leader elected after 1080ms
2019-06-16 21:27:39,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-16 21:27:39,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-16 21:27:39,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-16 21:27:39,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-16 21:27:39,166 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4: start LeaderState
2019-06-16 21:27:39,167 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4-RaftLogWorker: Starting segment from index:0
2019-06-16 21:27:39,167 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4:group-F551D3354062 set configuration 0: [b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4:127.0.0.1:42213], old=null at 0
2019-06-16 21:27:39,208 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb5220fc8-aa8a-4365-a7b5-8c31c08c124e/ratis/926b31e2-3b02-4c51-ae20-f551d3354062/current/log_inprogress_0
2019-06-16 21:27:40,135 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 7063518574439886501 is closed with bcsId 0.
2019-06-16 21:27:40,136 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-16 21:27:40,136 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4: close
2019-06-16 21:27:40,136 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4: shutdown group-F551D3354062
2019-06-16 21:27:40,137 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-F551D3354062,id=b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4
2019-06-16 21:27:40,137 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4: shutdown LeaderState
2019-06-16 21:27:40,138 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4-PendingRequests: sendNotLeaderResponses
2019-06-16 21:27:40,139 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4-group-F551D3354062: set stopIndex = 4
2019-06-16 21:27:40,139 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-16 21:27:40,139 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerb5220fc8-aa8a-4365-a7b5-8c31c08c124e/ratis/926b31e2-3b02-4c51-ae20-f551d3354062/sm/snapshot.1_4
2019-06-16 21:27:40,140 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4:group-F551D3354062 closes. The last applied log index is 4
2019-06-16 21:27:40,140 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-16 21:27:40,141 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4-RaftLogWorker close()
2019-06-16 21:27:40,141 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4: shutdown server with port 42213 now
2019-06-16 21:27:40,142 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - b5e8ab1d-5cd5-4799-8da6-0fb6d45c51d4: shutdown server with port 42213 successfully
2019-06-16 21:27:40,144 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
