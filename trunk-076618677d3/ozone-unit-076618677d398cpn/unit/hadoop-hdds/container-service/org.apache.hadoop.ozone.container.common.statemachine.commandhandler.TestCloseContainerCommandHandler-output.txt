2019-06-17 20:01:41,950 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfc08c6a4-ddde-410d-b107-e3a7bd869aa4/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 20:01:41,956 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfc08c6a4-ddde-410d-b107-e3a7bd869aa4/hdds to VolumeSet
2019-06-17 20:01:42,022 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-17 20:01:42,068 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-17 20:01:42,572 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 42227
2019-06-17 20:01:43,114 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 20:01:43,137 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 20:01:43,149 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42227 (custom)
2019-06-17 20:01:43,150 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 20:01:43,152 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 20:01:43,153 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 20:01:43,154 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 20:01:43,319 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfc08c6a4-ddde-410d-b107-e3a7bd869aa4/ratis] (custom)
2019-06-17 20:01:43,332 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 44757
2019-06-17 20:01:43,364 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 20:01:43,364 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 20:01:43,366 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 19c621ea-3694-40f5-81c2-ade5343f20df at port 42227
2019-06-17 20:01:43,405 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 19c621ea-3694-40f5-81c2-ade5343f20df: start RPC server
2019-06-17 20:01:43,579 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 19c621ea-3694-40f5-81c2-ade5343f20df: GrpcService started, listening on 0.0.0.0/0.0.0.0:42227
2019-06-17 20:01:43,993 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 19c621ea-3694-40f5-81c2-ade5343f20df: addNew group-4B630F779AB7:[19c621ea-3694-40f5-81c2-ade5343f20df:127.0.0.1:42227] returns group-4B630F779AB7:java.util.concurrent.CompletableFuture@5207c96a[Not completed]
2019-06-17 20:01:44,033 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 19c621ea-3694-40f5-81c2-ade5343f20df: new RaftServerImpl for group-4B630F779AB7:[19c621ea-3694-40f5-81c2-ade5343f20df:127.0.0.1:42227] with ContainerStateMachine:uninitialized
2019-06-17 20:01:44,035 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 20:01:44,035 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 20:01:44,035 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 20:01:44,036 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 20:01:44,043 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 19c621ea-3694-40f5-81c2-ade5343f20df:group-4B630F779AB7 ConfigurationManager, init=-1: [19c621ea-3694-40f5-81c2-ade5343f20df:127.0.0.1:42227], old=null, confs=<EMPTY_MAP>
2019-06-17 20:01:44,044 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfc08c6a4-ddde-410d-b107-e3a7bd869aa4/ratis] (custom)
2019-06-17 20:01:44,051 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfc08c6a4-ddde-410d-b107-e3a7bd869aa4/ratis/7bae251c-5b67-4533-bf6a-4b630f779ab7 does not exist. Creating ...
2019-06-17 20:01:44,061 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfc08c6a4-ddde-410d-b107-e3a7bd869aa4/ratis/7bae251c-5b67-4533-bf6a-4b630f779ab7/in_use.lock acquired by nodename 4313@ozone-unit-076618677d398cpn-497012465
2019-06-17 20:01:44,070 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfc08c6a4-ddde-410d-b107-e3a7bd869aa4/ratis/7bae251c-5b67-4533-bf6a-4b630f779ab7 has been successfully formatted.
2019-06-17 20:01:44,073 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 20:01:44,073 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 20:01:44,075 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 20:01:44,077 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 20:01:44,081 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 20:01:44,085 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 20:01:44,089 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 19c621ea-3694-40f5-81c2-ade5343f20df-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfc08c6a4-ddde-410d-b107-e3a7bd869aa4/ratis/7bae251c-5b67-4533-bf6a-4b630f779ab7
2019-06-17 20:01:44,089 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 20:01:44,090 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 20:01:44,092 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 20:01:44,092 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 20:01:44,093 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 20:01:44,093 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 20:01:44,094 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 20:01:44,095 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 20:01:44,095 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 20:01:44,097 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 20:01:44,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 20:01:44,104 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 20:01:44,105 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 20:01:44,238 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 19c621ea-3694-40f5-81c2-ade5343f20df: start group-4B630F779AB7
2019-06-17 20:01:44,239 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 19c621ea-3694-40f5-81c2-ade5343f20df:group-4B630F779AB7 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 20:01:44,240 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 19c621ea-3694-40f5-81c2-ade5343f20df: start FollowerState
2019-06-17 20:01:44,243 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-4B630F779AB7,id=19c621ea-3694-40f5-81c2-ade5343f20df
2019-06-17 20:01:45,411 INFO  impl.FollowerState (FollowerState.java:run(101)) - 19c621ea-3694-40f5-81c2-ade5343f20df:group-4B630F779AB7 changes to CANDIDATE, lastRpcTime:1171, electionTimeout:1171ms
2019-06-17 20:01:45,412 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 19c621ea-3694-40f5-81c2-ade5343f20df: shutdown FollowerState
2019-06-17 20:01:45,412 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 19c621ea-3694-40f5-81c2-ade5343f20df:group-4B630F779AB7 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 20:01:45,414 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 19c621ea-3694-40f5-81c2-ade5343f20df: start LeaderElection
2019-06-17 20:01:45,418 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 19c621ea-3694-40f5-81c2-ade5343f20df:group-4B630F779AB7:LeaderElection1: begin an election at term 1 for -1: [19c621ea-3694-40f5-81c2-ade5343f20df:127.0.0.1:42227], old=null
2019-06-17 20:01:45,419 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 19c621ea-3694-40f5-81c2-ade5343f20df: shutdown LeaderElection
2019-06-17 20:01:45,420 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 19c621ea-3694-40f5-81c2-ade5343f20df:group-4B630F779AB7 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 20:01:45,420 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 19c621ea-3694-40f5-81c2-ade5343f20df:group-4B630F779AB7 change Leader from null to 19c621ea-3694-40f5-81c2-ade5343f20df at term 1 for becomeLeader, leader elected after 1347ms
2019-06-17 20:01:45,424 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 20:01:45,425 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 20:01:45,427 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 20:01:45,427 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 20:01:45,437 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 19c621ea-3694-40f5-81c2-ade5343f20df: start LeaderState
2019-06-17 20:01:45,455 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 19c621ea-3694-40f5-81c2-ade5343f20df-RaftLogWorker: Starting segment from index:0
2019-06-17 20:01:45,466 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 19c621ea-3694-40f5-81c2-ade5343f20df:group-4B630F779AB7 set configuration 0: [19c621ea-3694-40f5-81c2-ade5343f20df:127.0.0.1:42227], old=null at 0
2019-06-17 20:01:45,630 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 19c621ea-3694-40f5-81c2-ade5343f20df-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfc08c6a4-ddde-410d-b107-e3a7bd869aa4/ratis/7bae251c-5b67-4533-bf6a-4b630f779ab7/current/log_inprogress_0
2019-06-17 20:01:46,539 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-17 20:01:46,616 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 8544011157194925995 is closed with bcsId 0.
2019-06-17 20:01:46,618 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 20:01:46,619 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 19c621ea-3694-40f5-81c2-ade5343f20df: close
2019-06-17 20:01:46,621 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 19c621ea-3694-40f5-81c2-ade5343f20df: shutdown group-4B630F779AB7
2019-06-17 20:01:46,621 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-4B630F779AB7,id=19c621ea-3694-40f5-81c2-ade5343f20df
2019-06-17 20:01:46,621 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 19c621ea-3694-40f5-81c2-ade5343f20df: shutdown LeaderState
2019-06-17 20:01:46,622 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 19c621ea-3694-40f5-81c2-ade5343f20df-PendingRequests: sendNotLeaderResponses
2019-06-17 20:01:46,626 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-19c621ea-3694-40f5-81c2-ade5343f20df-group-4B630F779AB7: set stopIndex = 4
2019-06-17 20:01:46,626 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 20:01:46,626 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerfc08c6a4-ddde-410d-b107-e3a7bd869aa4/ratis/7bae251c-5b67-4533-bf6a-4b630f779ab7/sm/snapshot.1_4
2019-06-17 20:01:46,638 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 19c621ea-3694-40f5-81c2-ade5343f20df:group-4B630F779AB7 closes. The last applied log index is 4
2019-06-17 20:01:46,639 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 19c621ea-3694-40f5-81c2-ade5343f20df-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 20:01:46,640 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 19c621ea-3694-40f5-81c2-ade5343f20df-RaftLogWorker close()
2019-06-17 20:01:46,641 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 19c621ea-3694-40f5-81c2-ade5343f20df: shutdown server with port 42227 now
2019-06-17 20:01:46,646 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 19c621ea-3694-40f5-81c2-ade5343f20df: shutdown server with port 42227 successfully
2019-06-17 20:01:46,656 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 20:01:46,704 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00cedb79-e499-41f4-940b-a7bd919e8ad0/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 20:01:46,704 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00cedb79-e499-41f4-940b-a7bd919e8ad0/hdds to VolumeSet
2019-06-17 20:01:46,705 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3a2b2322
2019-06-17 20:01:46,718 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3a2b2322
2019-06-17 20:01:46,732 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 37967
2019-06-17 20:01:46,738 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 20:01:46,739 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 20:01:46,739 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 37967 (custom)
2019-06-17 20:01:46,739 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 20:01:46,739 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 20:01:46,740 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 20:01:46,740 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 20:01:46,741 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00cedb79-e499-41f4-940b-a7bd919e8ad0/ratis] (custom)
2019-06-17 20:01:46,741 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 37311
2019-06-17 20:01:46,742 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 20:01:46,742 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 20:01:46,742 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 6bc74127-5b60-4f30-b326-bb3b12e7e4e6 at port 37967
2019-06-17 20:01:46,761 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6: start RPC server
2019-06-17 20:01:46,763 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6: GrpcService started, listening on 0.0.0.0/0.0.0.0:37967
2019-06-17 20:01:46,778 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6: addNew group-70B3115A8891:[6bc74127-5b60-4f30-b326-bb3b12e7e4e6:127.0.0.1:37967] returns group-70B3115A8891:java.util.concurrent.CompletableFuture@533634d1[Not completed]
2019-06-17 20:01:46,779 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6: new RaftServerImpl for group-70B3115A8891:[6bc74127-5b60-4f30-b326-bb3b12e7e4e6:127.0.0.1:37967] with ContainerStateMachine:uninitialized
2019-06-17 20:01:46,780 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 20:01:46,780 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 20:01:46,780 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 20:01:46,780 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 20:01:46,781 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6:group-70B3115A8891 ConfigurationManager, init=-1: [6bc74127-5b60-4f30-b326-bb3b12e7e4e6:127.0.0.1:37967], old=null, confs=<EMPTY_MAP>
2019-06-17 20:01:46,781 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00cedb79-e499-41f4-940b-a7bd919e8ad0/ratis] (custom)
2019-06-17 20:01:46,781 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00cedb79-e499-41f4-940b-a7bd919e8ad0/ratis/09032591-92c5-49fe-b5a7-70b3115a8891 does not exist. Creating ...
2019-06-17 20:01:46,785 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00cedb79-e499-41f4-940b-a7bd919e8ad0/ratis/09032591-92c5-49fe-b5a7-70b3115a8891/in_use.lock acquired by nodename 4313@ozone-unit-076618677d398cpn-497012465
2019-06-17 20:01:46,787 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00cedb79-e499-41f4-940b-a7bd919e8ad0/ratis/09032591-92c5-49fe-b5a7-70b3115a8891 has been successfully formatted.
2019-06-17 20:01:46,788 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 20:01:46,788 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 20:01:46,788 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 20:01:46,788 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 20:01:46,789 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 20:01:46,789 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 20:01:46,789 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 6bc74127-5b60-4f30-b326-bb3b12e7e4e6-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00cedb79-e499-41f4-940b-a7bd919e8ad0/ratis/09032591-92c5-49fe-b5a7-70b3115a8891
2019-06-17 20:01:46,789 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 20:01:46,789 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 20:01:46,789 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 20:01:46,790 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 20:01:46,790 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 20:01:46,790 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 20:01:46,790 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 20:01:46,790 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 20:01:46,790 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 20:01:46,791 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 20:01:46,791 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 20:01:46,791 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 20:01:46,791 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 20:01:46,792 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6: start group-70B3115A8891
2019-06-17 20:01:46,792 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6:group-70B3115A8891 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 20:01:46,792 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6: start FollowerState
2019-06-17 20:01:46,798 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-70B3115A8891,id=6bc74127-5b60-4f30-b326-bb3b12e7e4e6
2019-06-17 20:01:47,948 INFO  impl.FollowerState (FollowerState.java:run(101)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6:group-70B3115A8891 changes to CANDIDATE, lastRpcTime:1156, electionTimeout:1150ms
2019-06-17 20:01:47,949 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6: shutdown FollowerState
2019-06-17 20:01:47,949 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6:group-70B3115A8891 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 20:01:47,949 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6: start LeaderElection
2019-06-17 20:01:47,953 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6:group-70B3115A8891:LeaderElection2: begin an election at term 1 for -1: [6bc74127-5b60-4f30-b326-bb3b12e7e4e6:127.0.0.1:37967], old=null
2019-06-17 20:01:47,954 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6: shutdown LeaderElection
2019-06-17 20:01:47,954 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6:group-70B3115A8891 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 20:01:47,954 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6:group-70B3115A8891 change Leader from null to 6bc74127-5b60-4f30-b326-bb3b12e7e4e6 at term 1 for becomeLeader, leader elected after 1166ms
2019-06-17 20:01:47,954 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 20:01:47,954 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 20:01:47,955 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 20:01:47,955 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 20:01:47,955 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6: start LeaderState
2019-06-17 20:01:47,955 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6-RaftLogWorker: Starting segment from index:0
2019-06-17 20:01:47,970 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6:group-70B3115A8891 set configuration 0: [6bc74127-5b60-4f30-b326-bb3b12e7e4e6:127.0.0.1:37967], old=null at 0
2019-06-17 20:01:47,999 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00cedb79-e499-41f4-940b-a7bd919e8ad0/ratis/09032591-92c5-49fe-b5a7-70b3115a8891/current/log_inprogress_0
2019-06-17 20:01:48,846 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 20:01:48,847 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6: close
2019-06-17 20:01:48,848 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6: shutdown group-70B3115A8891
2019-06-17 20:01:48,849 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-70B3115A8891,id=6bc74127-5b60-4f30-b326-bb3b12e7e4e6
2019-06-17 20:01:48,850 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6: shutdown LeaderState
2019-06-17 20:01:48,850 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6-PendingRequests: sendNotLeaderResponses
2019-06-17 20:01:48,851 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-6bc74127-5b60-4f30-b326-bb3b12e7e4e6-group-70B3115A8891: set stopIndex = 2
2019-06-17 20:01:48,851 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 20:01:48,852 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler00cedb79-e499-41f4-940b-a7bd919e8ad0/ratis/09032591-92c5-49fe-b5a7-70b3115a8891/sm/snapshot.1_2
2019-06-17 20:01:48,852 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6:group-70B3115A8891 closes. The last applied log index is 2
2019-06-17 20:01:48,853 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 20:01:48,854 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6-RaftLogWorker close()
2019-06-17 20:01:48,856 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6: shutdown server with port 37967 now
2019-06-17 20:01:48,858 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 6bc74127-5b60-4f30-b326-bb3b12e7e4e6: shutdown server with port 37967 successfully
2019-06-17 20:01:48,863 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 20:01:48,894 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8d557280-102a-48cd-83f0-67e4d13dc2ee/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 20:01:48,894 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8d557280-102a-48cd-83f0-67e4d13dc2ee/hdds to VolumeSet
2019-06-17 20:01:48,895 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@26a2f7f9
2019-06-17 20:01:48,895 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@26a2f7f9
2019-06-17 20:01:48,909 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 41829
2019-06-17 20:01:48,910 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 20:01:48,911 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 20:01:48,911 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 41829 (custom)
2019-06-17 20:01:48,912 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 20:01:48,912 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 20:01:48,912 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 20:01:48,912 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 20:01:48,913 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8d557280-102a-48cd-83f0-67e4d13dc2ee/ratis] (custom)
2019-06-17 20:01:48,913 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 37173
2019-06-17 20:01:48,914 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 20:01:48,914 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 20:01:48,914 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 0f75e6ce-0be0-44a8-bffc-2dae00becef9 at port 41829
2019-06-17 20:01:48,937 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9: start RPC server
2019-06-17 20:01:48,941 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9: GrpcService started, listening on 0.0.0.0/0.0.0.0:41829
2019-06-17 20:01:48,961 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9: addNew group-5CF6E8458F7F:[0f75e6ce-0be0-44a8-bffc-2dae00becef9:127.0.0.1:41829] returns group-5CF6E8458F7F:java.util.concurrent.CompletableFuture@d4d3a50[Not completed]
2019-06-17 20:01:48,962 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9: new RaftServerImpl for group-5CF6E8458F7F:[0f75e6ce-0be0-44a8-bffc-2dae00becef9:127.0.0.1:41829] with ContainerStateMachine:uninitialized
2019-06-17 20:01:48,962 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 20:01:48,963 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 20:01:48,963 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 20:01:48,963 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 20:01:48,963 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9:group-5CF6E8458F7F ConfigurationManager, init=-1: [0f75e6ce-0be0-44a8-bffc-2dae00becef9:127.0.0.1:41829], old=null, confs=<EMPTY_MAP>
2019-06-17 20:01:48,963 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8d557280-102a-48cd-83f0-67e4d13dc2ee/ratis] (custom)
2019-06-17 20:01:48,964 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8d557280-102a-48cd-83f0-67e4d13dc2ee/ratis/bcc5cc1d-cd57-4f88-98a5-5cf6e8458f7f does not exist. Creating ...
2019-06-17 20:01:48,967 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8d557280-102a-48cd-83f0-67e4d13dc2ee/ratis/bcc5cc1d-cd57-4f88-98a5-5cf6e8458f7f/in_use.lock acquired by nodename 4313@ozone-unit-076618677d398cpn-497012465
2019-06-17 20:01:48,969 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8d557280-102a-48cd-83f0-67e4d13dc2ee/ratis/bcc5cc1d-cd57-4f88-98a5-5cf6e8458f7f has been successfully formatted.
2019-06-17 20:01:48,970 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 20:01:48,970 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 20:01:48,970 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 20:01:48,970 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 20:01:48,970 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 20:01:48,970 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 20:01:48,971 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 0f75e6ce-0be0-44a8-bffc-2dae00becef9-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8d557280-102a-48cd-83f0-67e4d13dc2ee/ratis/bcc5cc1d-cd57-4f88-98a5-5cf6e8458f7f
2019-06-17 20:01:48,971 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 20:01:48,971 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 20:01:48,971 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 20:01:48,971 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 20:01:48,971 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 20:01:48,972 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 20:01:48,972 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 20:01:48,972 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 20:01:48,972 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 20:01:48,972 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 20:01:48,973 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 20:01:48,973 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 20:01:48,973 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 20:01:48,973 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9: start group-5CF6E8458F7F
2019-06-17 20:01:48,973 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9:group-5CF6E8458F7F changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 20:01:48,974 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9: start FollowerState
2019-06-17 20:01:48,974 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-5CF6E8458F7F,id=0f75e6ce-0be0-44a8-bffc-2dae00becef9
2019-06-17 20:01:50,124 INFO  impl.FollowerState (FollowerState.java:run(101)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9:group-5CF6E8458F7F changes to CANDIDATE, lastRpcTime:1150, electionTimeout:1150ms
2019-06-17 20:01:50,125 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9: shutdown FollowerState
2019-06-17 20:01:50,125 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9:group-5CF6E8458F7F changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 20:01:50,125 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9: start LeaderElection
2019-06-17 20:01:50,130 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9:group-5CF6E8458F7F:LeaderElection3: begin an election at term 1 for -1: [0f75e6ce-0be0-44a8-bffc-2dae00becef9:127.0.0.1:41829], old=null
2019-06-17 20:01:50,130 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9: shutdown LeaderElection
2019-06-17 20:01:50,130 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9:group-5CF6E8458F7F changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 20:01:50,130 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9:group-5CF6E8458F7F change Leader from null to 0f75e6ce-0be0-44a8-bffc-2dae00becef9 at term 1 for becomeLeader, leader elected after 1160ms
2019-06-17 20:01:50,130 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 20:01:50,130 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 20:01:50,131 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 20:01:50,131 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 20:01:50,131 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9: start LeaderState
2019-06-17 20:01:50,131 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9-RaftLogWorker: Starting segment from index:0
2019-06-17 20:01:50,141 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9:group-5CF6E8458F7F set configuration 0: [0f75e6ce-0be0-44a8-bffc-2dae00becef9:127.0.0.1:41829], old=null at 0
2019-06-17 20:01:50,182 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8d557280-102a-48cd-83f0-67e4d13dc2ee/ratis/bcc5cc1d-cd57-4f88-98a5-5cf6e8458f7f/current/log_inprogress_0
2019-06-17 20:01:51,035 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 205092346167562732 is closed with bcsId 0.
2019-06-17 20:01:51,036 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 20:01:51,036 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9: close
2019-06-17 20:01:51,037 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9: shutdown group-5CF6E8458F7F
2019-06-17 20:01:51,037 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-5CF6E8458F7F,id=0f75e6ce-0be0-44a8-bffc-2dae00becef9
2019-06-17 20:01:51,037 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9: shutdown LeaderState
2019-06-17 20:01:51,038 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9-PendingRequests: sendNotLeaderResponses
2019-06-17 20:01:51,039 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-0f75e6ce-0be0-44a8-bffc-2dae00becef9-group-5CF6E8458F7F: set stopIndex = 2
2019-06-17 20:01:51,039 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 20:01:51,039 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8d557280-102a-48cd-83f0-67e4d13dc2ee/ratis/bcc5cc1d-cd57-4f88-98a5-5cf6e8458f7f/sm/snapshot.1_2
2019-06-17 20:01:51,040 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9:group-5CF6E8458F7F closes. The last applied log index is 2
2019-06-17 20:01:51,041 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 20:01:51,041 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9-RaftLogWorker close()
2019-06-17 20:01:51,042 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9: shutdown server with port 41829 now
2019-06-17 20:01:51,044 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 0f75e6ce-0be0-44a8-bffc-2dae00becef9: shutdown server with port 41829 successfully
2019-06-17 20:01:51,047 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 20:01:51,090 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1723c989-a249-4247-b1af-e10bf9effb26/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 20:01:51,091 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1723c989-a249-4247-b1af-e10bf9effb26/hdds to VolumeSet
2019-06-17 20:01:51,091 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@66153688
2019-06-17 20:01:51,100 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@66153688
2019-06-17 20:01:51,113 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 33735
2019-06-17 20:01:51,122 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 20:01:51,123 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 20:01:51,124 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 33735 (custom)
2019-06-17 20:01:51,124 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 20:01:51,124 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 20:01:51,124 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 20:01:51,124 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 20:01:51,125 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1723c989-a249-4247-b1af-e10bf9effb26/ratis] (custom)
2019-06-17 20:01:51,125 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 37655
2019-06-17 20:01:51,126 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 20:01:51,126 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 20:01:51,126 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis de2da1d5-1aac-4474-85d0-5e1bcf677891 at port 33735
2019-06-17 20:01:51,153 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - de2da1d5-1aac-4474-85d0-5e1bcf677891: start RPC server
2019-06-17 20:01:51,155 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - de2da1d5-1aac-4474-85d0-5e1bcf677891: GrpcService started, listening on 0.0.0.0/0.0.0.0:33735
Jun 17, 2019 8:01:51 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:37967} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 17, 2019 8:01:51 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:41829} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-17 20:01:51,187 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - de2da1d5-1aac-4474-85d0-5e1bcf677891: addNew group-C6F9D1454294:[de2da1d5-1aac-4474-85d0-5e1bcf677891:127.0.0.1:33735] returns group-C6F9D1454294:java.util.concurrent.CompletableFuture@56da3a0e[Not completed]
2019-06-17 20:01:51,188 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - de2da1d5-1aac-4474-85d0-5e1bcf677891: new RaftServerImpl for group-C6F9D1454294:[de2da1d5-1aac-4474-85d0-5e1bcf677891:127.0.0.1:33735] with ContainerStateMachine:uninitialized
2019-06-17 20:01:51,188 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 20:01:51,188 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 20:01:51,189 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 20:01:51,189 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 20:01:51,189 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - de2da1d5-1aac-4474-85d0-5e1bcf677891:group-C6F9D1454294 ConfigurationManager, init=-1: [de2da1d5-1aac-4474-85d0-5e1bcf677891:127.0.0.1:33735], old=null, confs=<EMPTY_MAP>
2019-06-17 20:01:51,189 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1723c989-a249-4247-b1af-e10bf9effb26/ratis] (custom)
2019-06-17 20:01:51,190 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1723c989-a249-4247-b1af-e10bf9effb26/ratis/4494a076-7d93-46f1-aab2-c6f9d1454294 does not exist. Creating ...
2019-06-17 20:01:51,193 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1723c989-a249-4247-b1af-e10bf9effb26/ratis/4494a076-7d93-46f1-aab2-c6f9d1454294/in_use.lock acquired by nodename 4313@ozone-unit-076618677d398cpn-497012465
2019-06-17 20:01:51,195 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1723c989-a249-4247-b1af-e10bf9effb26/ratis/4494a076-7d93-46f1-aab2-c6f9d1454294 has been successfully formatted.
2019-06-17 20:01:51,196 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 20:01:51,196 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 20:01:51,196 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 20:01:51,197 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 20:01:51,197 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 20:01:51,197 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 20:01:51,197 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new de2da1d5-1aac-4474-85d0-5e1bcf677891-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1723c989-a249-4247-b1af-e10bf9effb26/ratis/4494a076-7d93-46f1-aab2-c6f9d1454294
2019-06-17 20:01:51,198 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 20:01:51,198 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 20:01:51,198 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 20:01:51,198 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 20:01:51,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 20:01:51,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 20:01:51,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 20:01:51,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 20:01:51,199 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 20:01:51,200 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 20:01:51,200 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 20:01:51,201 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 20:01:51,201 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 20:01:51,201 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - de2da1d5-1aac-4474-85d0-5e1bcf677891: start group-C6F9D1454294
2019-06-17 20:01:51,201 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - de2da1d5-1aac-4474-85d0-5e1bcf677891:group-C6F9D1454294 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 20:01:51,201 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - de2da1d5-1aac-4474-85d0-5e1bcf677891: start FollowerState
2019-06-17 20:01:51,202 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-C6F9D1454294,id=de2da1d5-1aac-4474-85d0-5e1bcf677891
2019-06-17 20:01:52,240 INFO  impl.FollowerState (FollowerState.java:run(101)) - de2da1d5-1aac-4474-85d0-5e1bcf677891:group-C6F9D1454294 changes to CANDIDATE, lastRpcTime:1038, electionTimeout:1038ms
2019-06-17 20:01:52,240 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - de2da1d5-1aac-4474-85d0-5e1bcf677891: shutdown FollowerState
2019-06-17 20:01:52,240 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - de2da1d5-1aac-4474-85d0-5e1bcf677891:group-C6F9D1454294 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 20:01:52,240 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - de2da1d5-1aac-4474-85d0-5e1bcf677891: start LeaderElection
2019-06-17 20:01:52,245 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - de2da1d5-1aac-4474-85d0-5e1bcf677891:group-C6F9D1454294:LeaderElection4: begin an election at term 1 for -1: [de2da1d5-1aac-4474-85d0-5e1bcf677891:127.0.0.1:33735], old=null
2019-06-17 20:01:52,245 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - de2da1d5-1aac-4474-85d0-5e1bcf677891: shutdown LeaderElection
2019-06-17 20:01:52,245 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - de2da1d5-1aac-4474-85d0-5e1bcf677891:group-C6F9D1454294 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 20:01:52,245 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - de2da1d5-1aac-4474-85d0-5e1bcf677891:group-C6F9D1454294 change Leader from null to de2da1d5-1aac-4474-85d0-5e1bcf677891 at term 1 for becomeLeader, leader elected after 1049ms
2019-06-17 20:01:52,245 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 20:01:52,246 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 20:01:52,246 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 20:01:52,246 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 20:01:52,246 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - de2da1d5-1aac-4474-85d0-5e1bcf677891: start LeaderState
2019-06-17 20:01:52,246 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - de2da1d5-1aac-4474-85d0-5e1bcf677891-RaftLogWorker: Starting segment from index:0
2019-06-17 20:01:52,247 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - de2da1d5-1aac-4474-85d0-5e1bcf677891:group-C6F9D1454294 set configuration 0: [de2da1d5-1aac-4474-85d0-5e1bcf677891:127.0.0.1:33735], old=null at 0
2019-06-17 20:01:52,291 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - de2da1d5-1aac-4474-85d0-5e1bcf677891-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1723c989-a249-4247-b1af-e10bf9effb26/ratis/4494a076-7d93-46f1-aab2-c6f9d1454294/current/log_inprogress_0
2019-06-17 20:01:53,258 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 2216122238269738504 is closed with bcsId 0.
2019-06-17 20:01:53,259 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 20:01:53,259 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - de2da1d5-1aac-4474-85d0-5e1bcf677891: close
2019-06-17 20:01:53,259 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - de2da1d5-1aac-4474-85d0-5e1bcf677891: shutdown group-C6F9D1454294
2019-06-17 20:01:53,260 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-C6F9D1454294,id=de2da1d5-1aac-4474-85d0-5e1bcf677891
2019-06-17 20:01:53,260 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - de2da1d5-1aac-4474-85d0-5e1bcf677891: shutdown LeaderState
2019-06-17 20:01:53,260 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - de2da1d5-1aac-4474-85d0-5e1bcf677891-PendingRequests: sendNotLeaderResponses
2019-06-17 20:01:53,262 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 20:01:53,262 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1723c989-a249-4247-b1af-e10bf9effb26/ratis/4494a076-7d93-46f1-aab2-c6f9d1454294/sm/snapshot.1_2
2019-06-17 20:01:53,262 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-de2da1d5-1aac-4474-85d0-5e1bcf677891-group-C6F9D1454294: set stopIndex = 2
2019-06-17 20:01:53,263 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - de2da1d5-1aac-4474-85d0-5e1bcf677891:group-C6F9D1454294 closes. The last applied log index is 2
2019-06-17 20:01:53,263 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - de2da1d5-1aac-4474-85d0-5e1bcf677891-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 20:01:53,264 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - de2da1d5-1aac-4474-85d0-5e1bcf677891-RaftLogWorker close()
2019-06-17 20:01:53,265 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - de2da1d5-1aac-4474-85d0-5e1bcf677891: shutdown server with port 33735 now
2019-06-17 20:01:53,267 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - de2da1d5-1aac-4474-85d0-5e1bcf677891: shutdown server with port 33735 successfully
2019-06-17 20:01:53,269 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 20:01:53,299 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerec44b22b-f63f-413a-8528-b8391f6bec81/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 20:01:53,299 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerec44b22b-f63f-413a-8528-b8391f6bec81/hdds to VolumeSet
2019-06-17 20:01:53,300 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@68217d41
2019-06-17 20:01:53,306 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@68217d41
2019-06-17 20:01:53,317 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 42639
2019-06-17 20:01:53,318 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 20:01:53,318 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 20:01:53,319 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42639 (custom)
2019-06-17 20:01:53,319 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 20:01:53,319 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 20:01:53,320 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 20:01:53,320 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 20:01:53,321 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerec44b22b-f63f-413a-8528-b8391f6bec81/ratis] (custom)
2019-06-17 20:01:53,321 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 40251
2019-06-17 20:01:53,322 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 20:01:53,322 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 20:01:53,322 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis ceb84aef-90ff-4be5-8f6d-02e757982475 at port 42639
2019-06-17 20:01:53,336 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - ceb84aef-90ff-4be5-8f6d-02e757982475: start RPC server
2019-06-17 20:01:53,338 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - ceb84aef-90ff-4be5-8f6d-02e757982475: GrpcService started, listening on 0.0.0.0/0.0.0.0:42639
2019-06-17 20:01:53,349 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - ceb84aef-90ff-4be5-8f6d-02e757982475: addNew group-ADF35AC0F58E:[ceb84aef-90ff-4be5-8f6d-02e757982475:127.0.0.1:42639] returns group-ADF35AC0F58E:java.util.concurrent.CompletableFuture@4c577dc5[Not completed]
2019-06-17 20:01:53,349 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - ceb84aef-90ff-4be5-8f6d-02e757982475: new RaftServerImpl for group-ADF35AC0F58E:[ceb84aef-90ff-4be5-8f6d-02e757982475:127.0.0.1:42639] with ContainerStateMachine:uninitialized
2019-06-17 20:01:53,350 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 20:01:53,350 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 20:01:53,350 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 20:01:53,350 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 20:01:53,350 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - ceb84aef-90ff-4be5-8f6d-02e757982475:group-ADF35AC0F58E ConfigurationManager, init=-1: [ceb84aef-90ff-4be5-8f6d-02e757982475:127.0.0.1:42639], old=null, confs=<EMPTY_MAP>
2019-06-17 20:01:53,350 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerec44b22b-f63f-413a-8528-b8391f6bec81/ratis] (custom)
2019-06-17 20:01:53,350 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerec44b22b-f63f-413a-8528-b8391f6bec81/ratis/d1eb54a4-7616-44a3-b865-adf35ac0f58e does not exist. Creating ...
2019-06-17 20:01:53,353 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerec44b22b-f63f-413a-8528-b8391f6bec81/ratis/d1eb54a4-7616-44a3-b865-adf35ac0f58e/in_use.lock acquired by nodename 4313@ozone-unit-076618677d398cpn-497012465
2019-06-17 20:01:53,355 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerec44b22b-f63f-413a-8528-b8391f6bec81/ratis/d1eb54a4-7616-44a3-b865-adf35ac0f58e has been successfully formatted.
2019-06-17 20:01:53,355 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 20:01:53,355 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 20:01:53,355 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 20:01:53,356 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 20:01:53,356 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 20:01:53,356 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 20:01:53,356 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new ceb84aef-90ff-4be5-8f6d-02e757982475-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerec44b22b-f63f-413a-8528-b8391f6bec81/ratis/d1eb54a4-7616-44a3-b865-adf35ac0f58e
2019-06-17 20:01:53,356 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 20:01:53,356 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 20:01:53,356 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 20:01:53,356 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 20:01:53,356 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 20:01:53,356 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 20:01:53,356 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 20:01:53,357 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 20:01:53,357 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 20:01:53,357 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 20:01:53,358 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 20:01:53,359 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 20:01:53,359 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 20:01:53,360 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - ceb84aef-90ff-4be5-8f6d-02e757982475: start group-ADF35AC0F58E
2019-06-17 20:01:53,360 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - ceb84aef-90ff-4be5-8f6d-02e757982475:group-ADF35AC0F58E changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 20:01:53,360 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - ceb84aef-90ff-4be5-8f6d-02e757982475: start FollowerState
2019-06-17 20:01:53,361 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-ADF35AC0F58E,id=ceb84aef-90ff-4be5-8f6d-02e757982475
2019-06-17 20:01:54,548 INFO  impl.FollowerState (FollowerState.java:run(101)) - ceb84aef-90ff-4be5-8f6d-02e757982475:group-ADF35AC0F58E changes to CANDIDATE, lastRpcTime:1188, electionTimeout:1187ms
2019-06-17 20:01:54,548 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - ceb84aef-90ff-4be5-8f6d-02e757982475: shutdown FollowerState
2019-06-17 20:01:54,549 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - ceb84aef-90ff-4be5-8f6d-02e757982475:group-ADF35AC0F58E changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 20:01:54,549 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - ceb84aef-90ff-4be5-8f6d-02e757982475: start LeaderElection
2019-06-17 20:01:54,554 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - ceb84aef-90ff-4be5-8f6d-02e757982475:group-ADF35AC0F58E:LeaderElection5: begin an election at term 1 for -1: [ceb84aef-90ff-4be5-8f6d-02e757982475:127.0.0.1:42639], old=null
2019-06-17 20:01:54,554 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - ceb84aef-90ff-4be5-8f6d-02e757982475: shutdown LeaderElection
2019-06-17 20:01:54,554 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - ceb84aef-90ff-4be5-8f6d-02e757982475:group-ADF35AC0F58E changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 20:01:54,554 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - ceb84aef-90ff-4be5-8f6d-02e757982475:group-ADF35AC0F58E change Leader from null to ceb84aef-90ff-4be5-8f6d-02e757982475 at term 1 for becomeLeader, leader elected after 1198ms
2019-06-17 20:01:54,555 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 20:01:54,555 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 20:01:54,555 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 20:01:54,555 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 20:01:54,555 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - ceb84aef-90ff-4be5-8f6d-02e757982475: start LeaderState
2019-06-17 20:01:54,556 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - ceb84aef-90ff-4be5-8f6d-02e757982475-RaftLogWorker: Starting segment from index:0
2019-06-17 20:01:54,556 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - ceb84aef-90ff-4be5-8f6d-02e757982475:group-ADF35AC0F58E set configuration 0: [ceb84aef-90ff-4be5-8f6d-02e757982475:127.0.0.1:42639], old=null at 0
2019-06-17 20:01:54,605 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - ceb84aef-90ff-4be5-8f6d-02e757982475-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerec44b22b-f63f-413a-8528-b8391f6bec81/ratis/d1eb54a4-7616-44a3-b865-adf35ac0f58e/current/log_inprogress_0
2019-06-17 20:01:55,436 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 2915370584981084608 is closed with bcsId 0.
2019-06-17 20:01:55,437 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 20:01:55,437 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - ceb84aef-90ff-4be5-8f6d-02e757982475: close
2019-06-17 20:01:55,438 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - ceb84aef-90ff-4be5-8f6d-02e757982475: shutdown group-ADF35AC0F58E
2019-06-17 20:01:55,438 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-ADF35AC0F58E,id=ceb84aef-90ff-4be5-8f6d-02e757982475
2019-06-17 20:01:55,438 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - ceb84aef-90ff-4be5-8f6d-02e757982475: shutdown LeaderState
2019-06-17 20:01:55,439 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - ceb84aef-90ff-4be5-8f6d-02e757982475-PendingRequests: sendNotLeaderResponses
2019-06-17 20:01:55,441 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-ceb84aef-90ff-4be5-8f6d-02e757982475-group-ADF35AC0F58E: set stopIndex = 4
2019-06-17 20:01:55,441 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 20:01:55,442 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerec44b22b-f63f-413a-8528-b8391f6bec81/ratis/d1eb54a4-7616-44a3-b865-adf35ac0f58e/sm/snapshot.1_4
2019-06-17 20:01:55,442 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - ceb84aef-90ff-4be5-8f6d-02e757982475:group-ADF35AC0F58E closes. The last applied log index is 4
2019-06-17 20:01:55,443 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - ceb84aef-90ff-4be5-8f6d-02e757982475-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 20:01:55,444 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - ceb84aef-90ff-4be5-8f6d-02e757982475-RaftLogWorker close()
2019-06-17 20:01:55,445 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - ceb84aef-90ff-4be5-8f6d-02e757982475: shutdown server with port 42639 now
2019-06-17 20:01:55,446 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - ceb84aef-90ff-4be5-8f6d-02e757982475: shutdown server with port 42639 successfully
2019-06-17 20:01:55,451 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
