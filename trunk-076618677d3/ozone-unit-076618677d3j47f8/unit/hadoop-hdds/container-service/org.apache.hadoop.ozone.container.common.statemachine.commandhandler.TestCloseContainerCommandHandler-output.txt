2019-06-17 15:42:55,193 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler470509b2-c00b-45d9-a565-bcf20225cc81/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 15:42:55,198 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler470509b2-c00b-45d9-a565-bcf20225cc81/hdds to VolumeSet
2019-06-17 15:42:55,212 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-17 15:42:55,255 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-17 15:42:55,568 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 44963
2019-06-17 15:42:55,939 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 15:42:55,956 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 15:42:55,963 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 44963 (custom)
2019-06-17 15:42:55,964 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 15:42:55,966 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 15:42:55,966 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 15:42:55,967 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 15:42:56,080 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler470509b2-c00b-45d9-a565-bcf20225cc81/ratis] (custom)
2019-06-17 15:42:56,092 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 45689
2019-06-17 15:42:56,118 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 15:42:56,118 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 15:42:56,119 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis d6d353ff-efbe-4903-a6d2-7c8a4714078c at port 44963
2019-06-17 15:42:56,131 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c: start RPC server
2019-06-17 15:42:56,264 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c: GrpcService started, listening on 0.0.0.0/0.0.0.0:44963
2019-06-17 15:42:56,527 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c: addNew group-9DA140063FF9:[d6d353ff-efbe-4903-a6d2-7c8a4714078c:127.0.0.1:44963] returns group-9DA140063FF9:java.util.concurrent.CompletableFuture@59c58e78[Not completed]
2019-06-17 15:42:56,552 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c: new RaftServerImpl for group-9DA140063FF9:[d6d353ff-efbe-4903-a6d2-7c8a4714078c:127.0.0.1:44963] with ContainerStateMachine:uninitialized
2019-06-17 15:42:56,553 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 15:42:56,553 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 15:42:56,553 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 15:42:56,554 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 15:42:56,558 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c:group-9DA140063FF9 ConfigurationManager, init=-1: [d6d353ff-efbe-4903-a6d2-7c8a4714078c:127.0.0.1:44963], old=null, confs=<EMPTY_MAP>
2019-06-17 15:42:56,558 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler470509b2-c00b-45d9-a565-bcf20225cc81/ratis] (custom)
2019-06-17 15:42:56,563 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler470509b2-c00b-45d9-a565-bcf20225cc81/ratis/e8112918-d61a-4c2d-905e-9da140063ff9 does not exist. Creating ...
2019-06-17 15:42:56,570 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler470509b2-c00b-45d9-a565-bcf20225cc81/ratis/e8112918-d61a-4c2d-905e-9da140063ff9/in_use.lock acquired by nodename 4298@ozone-unit-076618677d3j47f8-1761748574
2019-06-17 15:42:56,579 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler470509b2-c00b-45d9-a565-bcf20225cc81/ratis/e8112918-d61a-4c2d-905e-9da140063ff9 has been successfully formatted.
2019-06-17 15:42:56,581 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 15:42:56,581 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 15:42:56,583 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 15:42:56,585 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 15:42:56,588 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 15:42:56,592 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 15:42:56,594 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new d6d353ff-efbe-4903-a6d2-7c8a4714078c-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler470509b2-c00b-45d9-a565-bcf20225cc81/ratis/e8112918-d61a-4c2d-905e-9da140063ff9
2019-06-17 15:42:56,595 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 15:42:56,595 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 15:42:56,597 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 15:42:56,597 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 15:42:56,598 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 15:42:56,598 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 15:42:56,599 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 15:42:56,600 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 15:42:56,600 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 15:42:56,602 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 15:42:56,608 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 15:42:56,608 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 15:42:56,609 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 15:42:56,710 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c: start group-9DA140063FF9
2019-06-17 15:42:56,711 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c:group-9DA140063FF9 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 15:42:56,712 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c: start FollowerState
2019-06-17 15:42:56,714 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-9DA140063FF9,id=d6d353ff-efbe-4903-a6d2-7c8a4714078c
2019-06-17 15:42:57,831 INFO  impl.FollowerState (FollowerState.java:run(101)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c:group-9DA140063FF9 changes to CANDIDATE, lastRpcTime:1119, electionTimeout:1118ms
2019-06-17 15:42:57,831 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c: shutdown FollowerState
2019-06-17 15:42:57,831 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c:group-9DA140063FF9 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 15:42:57,832 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c: start LeaderElection
2019-06-17 15:42:57,835 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c:group-9DA140063FF9:LeaderElection1: begin an election at term 1 for -1: [d6d353ff-efbe-4903-a6d2-7c8a4714078c:127.0.0.1:44963], old=null
2019-06-17 15:42:57,836 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c: shutdown LeaderElection
2019-06-17 15:42:57,837 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c:group-9DA140063FF9 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 15:42:57,837 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c:group-9DA140063FF9 change Leader from null to d6d353ff-efbe-4903-a6d2-7c8a4714078c at term 1 for becomeLeader, leader elected after 1256ms
2019-06-17 15:42:57,840 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 15:42:57,840 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 15:42:57,842 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 15:42:57,842 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 15:42:57,849 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c: start LeaderState
2019-06-17 15:42:57,860 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c-RaftLogWorker: Starting segment from index:0
2019-06-17 15:42:57,865 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c:group-9DA140063FF9 set configuration 0: [d6d353ff-efbe-4903-a6d2-7c8a4714078c:127.0.0.1:44963], old=null at 0
2019-06-17 15:42:57,991 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler470509b2-c00b-45d9-a565-bcf20225cc81/ratis/e8112918-d61a-4c2d-905e-9da140063ff9/current/log_inprogress_0
2019-06-17 15:42:58,924 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-17 15:42:58,974 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 9145592150116627542 is closed with bcsId 0.
2019-06-17 15:42:58,975 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 15:42:58,975 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c: close
2019-06-17 15:42:58,976 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c: shutdown group-9DA140063FF9
2019-06-17 15:42:58,977 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-9DA140063FF9,id=d6d353ff-efbe-4903-a6d2-7c8a4714078c
2019-06-17 15:42:58,977 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c: shutdown LeaderState
2019-06-17 15:42:58,977 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c-PendingRequests: sendNotLeaderResponses
2019-06-17 15:42:58,979 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-d6d353ff-efbe-4903-a6d2-7c8a4714078c-group-9DA140063FF9: set stopIndex = 4
2019-06-17 15:42:58,979 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 15:42:58,980 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler470509b2-c00b-45d9-a565-bcf20225cc81/ratis/e8112918-d61a-4c2d-905e-9da140063ff9/sm/snapshot.1_4
2019-06-17 15:42:58,987 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c:group-9DA140063FF9 closes. The last applied log index is 4
2019-06-17 15:42:58,988 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 15:42:58,989 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c-RaftLogWorker close()
2019-06-17 15:42:58,990 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c: shutdown server with port 44963 now
2019-06-17 15:42:58,995 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - d6d353ff-efbe-4903-a6d2-7c8a4714078c: shutdown server with port 44963 successfully
2019-06-17 15:42:59,002 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 15:42:59,030 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2f3f12a5-2593-45ef-a441-402497668afe/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 15:42:59,030 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2f3f12a5-2593-45ef-a441-402497668afe/hdds to VolumeSet
2019-06-17 15:42:59,030 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@12958360
2019-06-17 15:42:59,031 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@12958360
2019-06-17 15:42:59,046 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 35503
2019-06-17 15:42:59,046 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 15:42:59,047 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 15:42:59,047 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 35503 (custom)
2019-06-17 15:42:59,047 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 15:42:59,047 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 15:42:59,048 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 15:42:59,048 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 15:42:59,048 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2f3f12a5-2593-45ef-a441-402497668afe/ratis] (custom)
2019-06-17 15:42:59,049 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42449
2019-06-17 15:42:59,049 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 15:42:59,049 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 15:42:59,049 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 0abc2476-087a-4238-a970-496f6cd2db02 at port 35503
2019-06-17 15:42:59,067 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 0abc2476-087a-4238-a970-496f6cd2db02: start RPC server
2019-06-17 15:42:59,069 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 0abc2476-087a-4238-a970-496f6cd2db02: GrpcService started, listening on 0.0.0.0/0.0.0.0:35503
2019-06-17 15:42:59,079 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 0abc2476-087a-4238-a970-496f6cd2db02: addNew group-BB46FEC20A24:[0abc2476-087a-4238-a970-496f6cd2db02:127.0.0.1:35503] returns group-BB46FEC20A24:java.util.concurrent.CompletableFuture@75a5288c[Not completed]
2019-06-17 15:42:59,082 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 0abc2476-087a-4238-a970-496f6cd2db02: new RaftServerImpl for group-BB46FEC20A24:[0abc2476-087a-4238-a970-496f6cd2db02:127.0.0.1:35503] with ContainerStateMachine:uninitialized
2019-06-17 15:42:59,083 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 15:42:59,083 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 15:42:59,083 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 15:42:59,083 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 15:42:59,083 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 0abc2476-087a-4238-a970-496f6cd2db02:group-BB46FEC20A24 ConfigurationManager, init=-1: [0abc2476-087a-4238-a970-496f6cd2db02:127.0.0.1:35503], old=null, confs=<EMPTY_MAP>
2019-06-17 15:42:59,083 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2f3f12a5-2593-45ef-a441-402497668afe/ratis] (custom)
2019-06-17 15:42:59,084 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2f3f12a5-2593-45ef-a441-402497668afe/ratis/c545f542-715d-4595-b091-bb46fec20a24 does not exist. Creating ...
2019-06-17 15:42:59,086 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2f3f12a5-2593-45ef-a441-402497668afe/ratis/c545f542-715d-4595-b091-bb46fec20a24/in_use.lock acquired by nodename 4298@ozone-unit-076618677d3j47f8-1761748574
2019-06-17 15:42:59,089 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2f3f12a5-2593-45ef-a441-402497668afe/ratis/c545f542-715d-4595-b091-bb46fec20a24 has been successfully formatted.
2019-06-17 15:42:59,089 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 15:42:59,089 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 15:42:59,089 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 15:42:59,089 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 15:42:59,090 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 15:42:59,090 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 15:42:59,090 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 0abc2476-087a-4238-a970-496f6cd2db02-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2f3f12a5-2593-45ef-a441-402497668afe/ratis/c545f542-715d-4595-b091-bb46fec20a24
2019-06-17 15:42:59,090 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 15:42:59,090 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 15:42:59,090 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 15:42:59,091 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 15:42:59,091 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 15:42:59,091 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 15:42:59,091 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 15:42:59,091 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 15:42:59,091 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 15:42:59,092 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 15:42:59,092 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 15:42:59,092 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 15:42:59,092 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 15:42:59,093 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 0abc2476-087a-4238-a970-496f6cd2db02: start group-BB46FEC20A24
2019-06-17 15:42:59,093 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0abc2476-087a-4238-a970-496f6cd2db02:group-BB46FEC20A24 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 15:42:59,093 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0abc2476-087a-4238-a970-496f6cd2db02: start FollowerState
2019-06-17 15:42:59,094 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-BB46FEC20A24,id=0abc2476-087a-4238-a970-496f6cd2db02
2019-06-17 15:43:00,144 INFO  impl.FollowerState (FollowerState.java:run(101)) - 0abc2476-087a-4238-a970-496f6cd2db02:group-BB46FEC20A24 changes to CANDIDATE, lastRpcTime:1050, electionTimeout:1050ms
2019-06-17 15:43:00,144 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 0abc2476-087a-4238-a970-496f6cd2db02: shutdown FollowerState
2019-06-17 15:43:00,144 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0abc2476-087a-4238-a970-496f6cd2db02:group-BB46FEC20A24 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 15:43:00,144 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0abc2476-087a-4238-a970-496f6cd2db02: start LeaderElection
2019-06-17 15:43:00,147 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 0abc2476-087a-4238-a970-496f6cd2db02:group-BB46FEC20A24:LeaderElection2: begin an election at term 1 for -1: [0abc2476-087a-4238-a970-496f6cd2db02:127.0.0.1:35503], old=null
2019-06-17 15:43:00,147 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 0abc2476-087a-4238-a970-496f6cd2db02: shutdown LeaderElection
2019-06-17 15:43:00,147 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0abc2476-087a-4238-a970-496f6cd2db02:group-BB46FEC20A24 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 15:43:00,147 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 0abc2476-087a-4238-a970-496f6cd2db02:group-BB46FEC20A24 change Leader from null to 0abc2476-087a-4238-a970-496f6cd2db02 at term 1 for becomeLeader, leader elected after 1058ms
2019-06-17 15:43:00,148 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 15:43:00,148 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 15:43:00,148 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 15:43:00,148 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 15:43:00,148 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0abc2476-087a-4238-a970-496f6cd2db02: start LeaderState
2019-06-17 15:43:00,149 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 0abc2476-087a-4238-a970-496f6cd2db02-RaftLogWorker: Starting segment from index:0
2019-06-17 15:43:00,150 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 0abc2476-087a-4238-a970-496f6cd2db02:group-BB46FEC20A24 set configuration 0: [0abc2476-087a-4238-a970-496f6cd2db02:127.0.0.1:35503], old=null at 0
2019-06-17 15:43:00,185 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 0abc2476-087a-4238-a970-496f6cd2db02-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2f3f12a5-2593-45ef-a441-402497668afe/ratis/c545f542-715d-4595-b091-bb46fec20a24/current/log_inprogress_0
2019-06-17 15:43:01,128 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 15:43:01,128 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 0abc2476-087a-4238-a970-496f6cd2db02: close
2019-06-17 15:43:01,129 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 0abc2476-087a-4238-a970-496f6cd2db02: shutdown group-BB46FEC20A24
2019-06-17 15:43:01,129 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-BB46FEC20A24,id=0abc2476-087a-4238-a970-496f6cd2db02
2019-06-17 15:43:01,129 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 0abc2476-087a-4238-a970-496f6cd2db02: shutdown LeaderState
2019-06-17 15:43:01,130 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 0abc2476-087a-4238-a970-496f6cd2db02-PendingRequests: sendNotLeaderResponses
2019-06-17 15:43:01,131 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-0abc2476-087a-4238-a970-496f6cd2db02-group-BB46FEC20A24: set stopIndex = 2
2019-06-17 15:43:01,131 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 15:43:01,131 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler2f3f12a5-2593-45ef-a441-402497668afe/ratis/c545f542-715d-4595-b091-bb46fec20a24/sm/snapshot.1_2
2019-06-17 15:43:01,131 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 0abc2476-087a-4238-a970-496f6cd2db02:group-BB46FEC20A24 closes. The last applied log index is 2
2019-06-17 15:43:01,132 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 0abc2476-087a-4238-a970-496f6cd2db02-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 15:43:01,132 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 0abc2476-087a-4238-a970-496f6cd2db02-RaftLogWorker close()
2019-06-17 15:43:01,133 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 0abc2476-087a-4238-a970-496f6cd2db02: shutdown server with port 35503 now
2019-06-17 15:43:01,134 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 0abc2476-087a-4238-a970-496f6cd2db02: shutdown server with port 35503 successfully
2019-06-17 15:43:01,135 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 15:43:01,162 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler74c45077-e95e-4abd-8f00-ef20372ece8d/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 15:43:01,162 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler74c45077-e95e-4abd-8f00-ef20372ece8d/hdds to VolumeSet
2019-06-17 15:43:01,162 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@8bffb8b
2019-06-17 15:43:01,163 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@8bffb8b
2019-06-17 15:43:01,172 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 35851
2019-06-17 15:43:01,173 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 15:43:01,173 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 15:43:01,173 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 35851 (custom)
2019-06-17 15:43:01,173 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 15:43:01,174 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 15:43:01,174 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 15:43:01,174 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 15:43:01,174 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler74c45077-e95e-4abd-8f00-ef20372ece8d/ratis] (custom)
2019-06-17 15:43:01,175 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 34383
2019-06-17 15:43:01,175 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 15:43:01,175 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 15:43:01,175 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 3f71a798-6393-49aa-9a90-3e8d72997e13 at port 35851
2019-06-17 15:43:01,200 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 3f71a798-6393-49aa-9a90-3e8d72997e13: start RPC server
2019-06-17 15:43:01,201 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 3f71a798-6393-49aa-9a90-3e8d72997e13: GrpcService started, listening on 0.0.0.0/0.0.0.0:35851
2019-06-17 15:43:01,211 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 3f71a798-6393-49aa-9a90-3e8d72997e13: addNew group-B34BCE7E780D:[3f71a798-6393-49aa-9a90-3e8d72997e13:127.0.0.1:35851] returns group-B34BCE7E780D:java.util.concurrent.CompletableFuture@6bfbf4a0[Not completed]
2019-06-17 15:43:01,211 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 3f71a798-6393-49aa-9a90-3e8d72997e13: new RaftServerImpl for group-B34BCE7E780D:[3f71a798-6393-49aa-9a90-3e8d72997e13:127.0.0.1:35851] with ContainerStateMachine:uninitialized
2019-06-17 15:43:01,212 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 15:43:01,212 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 15:43:01,212 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 15:43:01,212 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 15:43:01,212 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 3f71a798-6393-49aa-9a90-3e8d72997e13:group-B34BCE7E780D ConfigurationManager, init=-1: [3f71a798-6393-49aa-9a90-3e8d72997e13:127.0.0.1:35851], old=null, confs=<EMPTY_MAP>
2019-06-17 15:43:01,212 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler74c45077-e95e-4abd-8f00-ef20372ece8d/ratis] (custom)
2019-06-17 15:43:01,213 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler74c45077-e95e-4abd-8f00-ef20372ece8d/ratis/a8877146-45df-4b82-8281-b34bce7e780d does not exist. Creating ...
2019-06-17 15:43:01,218 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler74c45077-e95e-4abd-8f00-ef20372ece8d/ratis/a8877146-45df-4b82-8281-b34bce7e780d/in_use.lock acquired by nodename 4298@ozone-unit-076618677d3j47f8-1761748574
2019-06-17 15:43:01,220 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler74c45077-e95e-4abd-8f00-ef20372ece8d/ratis/a8877146-45df-4b82-8281-b34bce7e780d has been successfully formatted.
2019-06-17 15:43:01,220 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 15:43:01,220 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 15:43:01,220 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 15:43:01,221 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 15:43:01,221 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 15:43:01,221 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 15:43:01,221 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 3f71a798-6393-49aa-9a90-3e8d72997e13-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler74c45077-e95e-4abd-8f00-ef20372ece8d/ratis/a8877146-45df-4b82-8281-b34bce7e780d
2019-06-17 15:43:01,221 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 15:43:01,221 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 15:43:01,221 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 15:43:01,221 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 15:43:01,221 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 15:43:01,221 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 15:43:01,221 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 15:43:01,222 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 15:43:01,222 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 15:43:01,222 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 15:43:01,222 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 15:43:01,222 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 15:43:01,223 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 15:43:01,223 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 3f71a798-6393-49aa-9a90-3e8d72997e13: start group-B34BCE7E780D
2019-06-17 15:43:01,223 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3f71a798-6393-49aa-9a90-3e8d72997e13:group-B34BCE7E780D changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 15:43:01,223 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3f71a798-6393-49aa-9a90-3e8d72997e13: start FollowerState
2019-06-17 15:43:01,223 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-B34BCE7E780D,id=3f71a798-6393-49aa-9a90-3e8d72997e13
2019-06-17 15:43:02,259 INFO  impl.FollowerState (FollowerState.java:run(101)) - 3f71a798-6393-49aa-9a90-3e8d72997e13:group-B34BCE7E780D changes to CANDIDATE, lastRpcTime:1036, electionTimeout:1036ms
2019-06-17 15:43:02,259 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 3f71a798-6393-49aa-9a90-3e8d72997e13: shutdown FollowerState
2019-06-17 15:43:02,260 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3f71a798-6393-49aa-9a90-3e8d72997e13:group-B34BCE7E780D changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 15:43:02,260 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3f71a798-6393-49aa-9a90-3e8d72997e13: start LeaderElection
2019-06-17 15:43:02,263 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 3f71a798-6393-49aa-9a90-3e8d72997e13:group-B34BCE7E780D:LeaderElection3: begin an election at term 1 for -1: [3f71a798-6393-49aa-9a90-3e8d72997e13:127.0.0.1:35851], old=null
2019-06-17 15:43:02,263 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 3f71a798-6393-49aa-9a90-3e8d72997e13: shutdown LeaderElection
2019-06-17 15:43:02,263 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3f71a798-6393-49aa-9a90-3e8d72997e13:group-B34BCE7E780D changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 15:43:02,263 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 3f71a798-6393-49aa-9a90-3e8d72997e13:group-B34BCE7E780D change Leader from null to 3f71a798-6393-49aa-9a90-3e8d72997e13 at term 1 for becomeLeader, leader elected after 1042ms
2019-06-17 15:43:02,263 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 15:43:02,263 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 15:43:02,263 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 15:43:02,263 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 15:43:02,264 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3f71a798-6393-49aa-9a90-3e8d72997e13: start LeaderState
2019-06-17 15:43:02,264 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 3f71a798-6393-49aa-9a90-3e8d72997e13-RaftLogWorker: Starting segment from index:0
2019-06-17 15:43:02,266 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 3f71a798-6393-49aa-9a90-3e8d72997e13:group-B34BCE7E780D set configuration 0: [3f71a798-6393-49aa-9a90-3e8d72997e13:127.0.0.1:35851], old=null at 0
2019-06-17 15:43:02,301 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 3f71a798-6393-49aa-9a90-3e8d72997e13-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler74c45077-e95e-4abd-8f00-ef20372ece8d/ratis/a8877146-45df-4b82-8281-b34bce7e780d/current/log_inprogress_0
2019-06-17 15:43:03,264 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 8966027309554733231 is closed with bcsId 0.
2019-06-17 15:43:03,265 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 15:43:03,265 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 3f71a798-6393-49aa-9a90-3e8d72997e13: close
2019-06-17 15:43:03,265 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 3f71a798-6393-49aa-9a90-3e8d72997e13: shutdown group-B34BCE7E780D
2019-06-17 15:43:03,265 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-B34BCE7E780D,id=3f71a798-6393-49aa-9a90-3e8d72997e13
2019-06-17 15:43:03,266 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 3f71a798-6393-49aa-9a90-3e8d72997e13: shutdown LeaderState
2019-06-17 15:43:03,266 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 3f71a798-6393-49aa-9a90-3e8d72997e13-PendingRequests: sendNotLeaderResponses
2019-06-17 15:43:03,267 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-3f71a798-6393-49aa-9a90-3e8d72997e13-group-B34BCE7E780D: set stopIndex = 2
2019-06-17 15:43:03,267 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 15:43:03,267 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler74c45077-e95e-4abd-8f00-ef20372ece8d/ratis/a8877146-45df-4b82-8281-b34bce7e780d/sm/snapshot.1_2
2019-06-17 15:43:03,267 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 3f71a798-6393-49aa-9a90-3e8d72997e13:group-B34BCE7E780D closes. The last applied log index is 2
2019-06-17 15:43:03,268 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 3f71a798-6393-49aa-9a90-3e8d72997e13-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 15:43:03,268 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 3f71a798-6393-49aa-9a90-3e8d72997e13-RaftLogWorker close()
2019-06-17 15:43:03,270 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 3f71a798-6393-49aa-9a90-3e8d72997e13: shutdown server with port 35851 now
2019-06-17 15:43:03,272 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 3f71a798-6393-49aa-9a90-3e8d72997e13: shutdown server with port 35851 successfully
2019-06-17 15:43:03,275 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 15:43:03,310 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler463eae9f-2422-4d45-abb3-4d5ada626d4e/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 15:43:03,310 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler463eae9f-2422-4d45-abb3-4d5ada626d4e/hdds to VolumeSet
2019-06-17 15:43:03,310 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@7318daf8
2019-06-17 15:43:03,310 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@7318daf8
2019-06-17 15:43:03,320 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 36751
2019-06-17 15:43:03,321 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 15:43:03,322 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 15:43:03,322 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 36751 (custom)
2019-06-17 15:43:03,322 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 15:43:03,323 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 15:43:03,323 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 15:43:03,323 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 15:43:03,324 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler463eae9f-2422-4d45-abb3-4d5ada626d4e/ratis] (custom)
2019-06-17 15:43:03,324 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 34523
2019-06-17 15:43:03,324 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 15:43:03,325 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 15:43:03,325 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1 at port 36751
2019-06-17 15:43:03,331 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1: start RPC server
2019-06-17 15:43:03,332 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1: GrpcService started, listening on 0.0.0.0/0.0.0.0:36751
Jun 17, 2019 3:43:03 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:35851} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 17, 2019 3:43:03 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:35503} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-17 15:43:03,344 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1: addNew group-7C9C0CEBB569:[10b8fa00-f484-4870-8d9c-5a56ac3e4bc1:127.0.0.1:36751] returns group-7C9C0CEBB569:java.util.concurrent.CompletableFuture@241d7a48[Not completed]
2019-06-17 15:43:03,344 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1: new RaftServerImpl for group-7C9C0CEBB569:[10b8fa00-f484-4870-8d9c-5a56ac3e4bc1:127.0.0.1:36751] with ContainerStateMachine:uninitialized
2019-06-17 15:43:03,344 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 15:43:03,345 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 15:43:03,345 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 15:43:03,345 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 15:43:03,345 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1:group-7C9C0CEBB569 ConfigurationManager, init=-1: [10b8fa00-f484-4870-8d9c-5a56ac3e4bc1:127.0.0.1:36751], old=null, confs=<EMPTY_MAP>
2019-06-17 15:43:03,345 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler463eae9f-2422-4d45-abb3-4d5ada626d4e/ratis] (custom)
2019-06-17 15:43:03,345 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler463eae9f-2422-4d45-abb3-4d5ada626d4e/ratis/e05915c3-0517-48bd-bff1-7c9c0cebb569 does not exist. Creating ...
2019-06-17 15:43:03,348 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler463eae9f-2422-4d45-abb3-4d5ada626d4e/ratis/e05915c3-0517-48bd-bff1-7c9c0cebb569/in_use.lock acquired by nodename 4298@ozone-unit-076618677d3j47f8-1761748574
2019-06-17 15:43:03,350 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler463eae9f-2422-4d45-abb3-4d5ada626d4e/ratis/e05915c3-0517-48bd-bff1-7c9c0cebb569 has been successfully formatted.
2019-06-17 15:43:03,350 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 15:43:03,351 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 15:43:03,351 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 15:43:03,351 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 15:43:03,351 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 15:43:03,351 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 15:43:03,351 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler463eae9f-2422-4d45-abb3-4d5ada626d4e/ratis/e05915c3-0517-48bd-bff1-7c9c0cebb569
2019-06-17 15:43:03,351 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 15:43:03,351 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 15:43:03,351 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 15:43:03,352 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 15:43:03,352 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 15:43:03,352 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 15:43:03,352 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 15:43:03,352 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 15:43:03,352 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 15:43:03,352 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 15:43:03,353 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 15:43:03,353 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 15:43:03,353 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 15:43:03,353 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1: start group-7C9C0CEBB569
2019-06-17 15:43:03,353 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1:group-7C9C0CEBB569 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 15:43:03,353 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1: start FollowerState
2019-06-17 15:43:03,354 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-7C9C0CEBB569,id=10b8fa00-f484-4870-8d9c-5a56ac3e4bc1
2019-06-17 15:43:04,481 INFO  impl.FollowerState (FollowerState.java:run(101)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1:group-7C9C0CEBB569 changes to CANDIDATE, lastRpcTime:1127, electionTimeout:1127ms
2019-06-17 15:43:04,481 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1: shutdown FollowerState
2019-06-17 15:43:04,481 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1:group-7C9C0CEBB569 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 15:43:04,481 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1: start LeaderElection
2019-06-17 15:43:04,484 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1:group-7C9C0CEBB569:LeaderElection4: begin an election at term 1 for -1: [10b8fa00-f484-4870-8d9c-5a56ac3e4bc1:127.0.0.1:36751], old=null
2019-06-17 15:43:04,484 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1: shutdown LeaderElection
2019-06-17 15:43:04,484 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1:group-7C9C0CEBB569 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 15:43:04,484 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1:group-7C9C0CEBB569 change Leader from null to 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1 at term 1 for becomeLeader, leader elected after 1133ms
2019-06-17 15:43:04,484 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 15:43:04,485 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 15:43:04,485 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 15:43:04,485 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 15:43:04,485 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1: start LeaderState
2019-06-17 15:43:04,485 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1-RaftLogWorker: Starting segment from index:0
2019-06-17 15:43:04,485 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1:group-7C9C0CEBB569 set configuration 0: [10b8fa00-f484-4870-8d9c-5a56ac3e4bc1:127.0.0.1:36751], old=null at 0
2019-06-17 15:43:04,521 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler463eae9f-2422-4d45-abb3-4d5ada626d4e/ratis/e05915c3-0517-48bd-bff1-7c9c0cebb569/current/log_inprogress_0
2019-06-17 15:43:05,394 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 6296714326744588229 is closed with bcsId 0.
2019-06-17 15:43:05,394 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 15:43:05,395 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1: close
2019-06-17 15:43:05,395 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1: shutdown group-7C9C0CEBB569
2019-06-17 15:43:05,395 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-7C9C0CEBB569,id=10b8fa00-f484-4870-8d9c-5a56ac3e4bc1
2019-06-17 15:43:05,395 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1: shutdown LeaderState
2019-06-17 15:43:05,395 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1-PendingRequests: sendNotLeaderResponses
2019-06-17 15:43:05,396 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-10b8fa00-f484-4870-8d9c-5a56ac3e4bc1-group-7C9C0CEBB569: set stopIndex = 2
2019-06-17 15:43:05,396 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 15:43:05,397 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler463eae9f-2422-4d45-abb3-4d5ada626d4e/ratis/e05915c3-0517-48bd-bff1-7c9c0cebb569/sm/snapshot.1_2
2019-06-17 15:43:05,397 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1:group-7C9C0CEBB569 closes. The last applied log index is 2
2019-06-17 15:43:05,397 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 15:43:05,398 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1-RaftLogWorker close()
2019-06-17 15:43:05,399 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1: shutdown server with port 36751 now
2019-06-17 15:43:05,400 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 10b8fa00-f484-4870-8d9c-5a56ac3e4bc1: shutdown server with port 36751 successfully
2019-06-17 15:43:05,405 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 15:43:05,422 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera8fb84e4-6bbe-4d2d-8000-a939e296a9fb/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 15:43:05,423 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera8fb84e4-6bbe-4d2d-8000-a939e296a9fb/hdds to VolumeSet
2019-06-17 15:43:05,423 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3e5d4f6b
2019-06-17 15:43:05,423 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3e5d4f6b
2019-06-17 15:43:05,431 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 33915
2019-06-17 15:43:05,432 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 15:43:05,432 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 15:43:05,433 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 33915 (custom)
2019-06-17 15:43:05,433 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 15:43:05,433 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 15:43:05,433 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 15:43:05,434 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 15:43:05,434 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera8fb84e4-6bbe-4d2d-8000-a939e296a9fb/ratis] (custom)
2019-06-17 15:43:05,434 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 40743
2019-06-17 15:43:05,435 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 15:43:05,435 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 15:43:05,435 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 7988cb39-08dc-4ab5-bf80-617956e5d1ae at port 33915
2019-06-17 15:43:05,444 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae: start RPC server
2019-06-17 15:43:05,445 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae: GrpcService started, listening on 0.0.0.0/0.0.0.0:33915
2019-06-17 15:43:05,453 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae: addNew group-9214781B2D72:[7988cb39-08dc-4ab5-bf80-617956e5d1ae:127.0.0.1:33915] returns group-9214781B2D72:java.util.concurrent.CompletableFuture@edcf49[Not completed]
2019-06-17 15:43:05,453 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae: new RaftServerImpl for group-9214781B2D72:[7988cb39-08dc-4ab5-bf80-617956e5d1ae:127.0.0.1:33915] with ContainerStateMachine:uninitialized
2019-06-17 15:43:05,453 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 15:43:05,454 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 15:43:05,454 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 15:43:05,454 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 15:43:05,454 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae:group-9214781B2D72 ConfigurationManager, init=-1: [7988cb39-08dc-4ab5-bf80-617956e5d1ae:127.0.0.1:33915], old=null, confs=<EMPTY_MAP>
2019-06-17 15:43:05,454 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera8fb84e4-6bbe-4d2d-8000-a939e296a9fb/ratis] (custom)
2019-06-17 15:43:05,454 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera8fb84e4-6bbe-4d2d-8000-a939e296a9fb/ratis/5c0feab0-fdce-4788-8550-9214781b2d72 does not exist. Creating ...
2019-06-17 15:43:05,457 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera8fb84e4-6bbe-4d2d-8000-a939e296a9fb/ratis/5c0feab0-fdce-4788-8550-9214781b2d72/in_use.lock acquired by nodename 4298@ozone-unit-076618677d3j47f8-1761748574
2019-06-17 15:43:05,460 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera8fb84e4-6bbe-4d2d-8000-a939e296a9fb/ratis/5c0feab0-fdce-4788-8550-9214781b2d72 has been successfully formatted.
2019-06-17 15:43:05,460 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 15:43:05,460 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 15:43:05,460 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 15:43:05,460 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 15:43:05,460 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 15:43:05,460 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 15:43:05,460 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 7988cb39-08dc-4ab5-bf80-617956e5d1ae-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera8fb84e4-6bbe-4d2d-8000-a939e296a9fb/ratis/5c0feab0-fdce-4788-8550-9214781b2d72
2019-06-17 15:43:05,460 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 15:43:05,460 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 15:43:05,461 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 15:43:05,461 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 15:43:05,461 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 15:43:05,461 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 15:43:05,461 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 15:43:05,461 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 15:43:05,461 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 15:43:05,461 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 15:43:05,461 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 15:43:05,461 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 15:43:05,462 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 15:43:05,462 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae: start group-9214781B2D72
2019-06-17 15:43:05,462 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae:group-9214781B2D72 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 15:43:05,462 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae: start FollowerState
2019-06-17 15:43:05,462 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-9214781B2D72,id=7988cb39-08dc-4ab5-bf80-617956e5d1ae
2019-06-17 15:43:06,557 INFO  impl.FollowerState (FollowerState.java:run(101)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae:group-9214781B2D72 changes to CANDIDATE, lastRpcTime:1095, electionTimeout:1095ms
2019-06-17 15:43:06,558 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae: shutdown FollowerState
2019-06-17 15:43:06,558 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae:group-9214781B2D72 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 15:43:06,558 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae: start LeaderElection
2019-06-17 15:43:06,561 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae:group-9214781B2D72:LeaderElection5: begin an election at term 1 for -1: [7988cb39-08dc-4ab5-bf80-617956e5d1ae:127.0.0.1:33915], old=null
2019-06-17 15:43:06,562 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae: shutdown LeaderElection
2019-06-17 15:43:06,562 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae:group-9214781B2D72 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 15:43:06,562 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae:group-9214781B2D72 change Leader from null to 7988cb39-08dc-4ab5-bf80-617956e5d1ae at term 1 for becomeLeader, leader elected after 1101ms
2019-06-17 15:43:06,562 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 15:43:06,562 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 15:43:06,562 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 15:43:06,562 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 15:43:06,563 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae: start LeaderState
2019-06-17 15:43:06,563 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae-RaftLogWorker: Starting segment from index:0
2019-06-17 15:43:06,580 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae:group-9214781B2D72 set configuration 0: [7988cb39-08dc-4ab5-bf80-617956e5d1ae:127.0.0.1:33915], old=null at 0
2019-06-17 15:43:06,599 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera8fb84e4-6bbe-4d2d-8000-a939e296a9fb/ratis/5c0feab0-fdce-4788-8550-9214781b2d72/current/log_inprogress_0
2019-06-17 15:43:07,498 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 2231959285191853831 is closed with bcsId 0.
2019-06-17 15:43:07,499 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 15:43:07,499 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae: close
2019-06-17 15:43:07,499 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae: shutdown group-9214781B2D72
2019-06-17 15:43:07,499 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-9214781B2D72,id=7988cb39-08dc-4ab5-bf80-617956e5d1ae
2019-06-17 15:43:07,500 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae: shutdown LeaderState
2019-06-17 15:43:07,500 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae-PendingRequests: sendNotLeaderResponses
2019-06-17 15:43:07,501 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-7988cb39-08dc-4ab5-bf80-617956e5d1ae-group-9214781B2D72: set stopIndex = 4
2019-06-17 15:43:07,501 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 15:43:07,501 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera8fb84e4-6bbe-4d2d-8000-a939e296a9fb/ratis/5c0feab0-fdce-4788-8550-9214781b2d72/sm/snapshot.1_4
2019-06-17 15:43:07,501 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae:group-9214781B2D72 closes. The last applied log index is 4
2019-06-17 15:43:07,502 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 15:43:07,503 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae-RaftLogWorker close()
2019-06-17 15:43:07,503 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae: shutdown server with port 33915 now
2019-06-17 15:43:07,505 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 7988cb39-08dc-4ab5-bf80-617956e5d1ae: shutdown server with port 33915 successfully
2019-06-17 15:43:07,510 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
