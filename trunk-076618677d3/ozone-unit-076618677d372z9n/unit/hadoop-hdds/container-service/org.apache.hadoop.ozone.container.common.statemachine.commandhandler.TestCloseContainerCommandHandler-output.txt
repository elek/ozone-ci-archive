2019-06-18 10:25:28,794 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8f4928d5-986a-4110-b07f-94c9a9ef8cd8/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 10:25:28,799 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8f4928d5-986a-4110-b07f-94c9a9ef8cd8/hdds to VolumeSet
2019-06-18 10:25:28,840 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-18 10:25:28,872 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-18 10:25:29,353 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 35901
2019-06-18 10:25:30,007 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 10:25:30,034 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 10:25:30,045 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 35901 (custom)
2019-06-18 10:25:30,046 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 10:25:30,048 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 10:25:30,049 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 10:25:30,050 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 10:25:30,228 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8f4928d5-986a-4110-b07f-94c9a9ef8cd8/ratis] (custom)
2019-06-18 10:25:30,242 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42269
2019-06-18 10:25:30,274 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 10:25:30,275 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 10:25:30,276 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 877c8119-9a58-4855-8163-f032796b84d0 at port 35901
2019-06-18 10:25:30,298 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 877c8119-9a58-4855-8163-f032796b84d0: start RPC server
2019-06-18 10:25:30,489 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 877c8119-9a58-4855-8163-f032796b84d0: GrpcService started, listening on 0.0.0.0/0.0.0.0:35901
2019-06-18 10:25:30,885 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 877c8119-9a58-4855-8163-f032796b84d0: addNew group-0F8FCC6D7F68:[877c8119-9a58-4855-8163-f032796b84d0:127.0.0.1:35901] returns group-0F8FCC6D7F68:java.util.concurrent.CompletableFuture@6a65e08e[Not completed]
2019-06-18 10:25:30,922 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 877c8119-9a58-4855-8163-f032796b84d0: new RaftServerImpl for group-0F8FCC6D7F68:[877c8119-9a58-4855-8163-f032796b84d0:127.0.0.1:35901] with ContainerStateMachine:uninitialized
2019-06-18 10:25:30,924 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 10:25:30,924 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 10:25:30,924 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 10:25:30,925 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 10:25:30,932 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 877c8119-9a58-4855-8163-f032796b84d0:group-0F8FCC6D7F68 ConfigurationManager, init=-1: [877c8119-9a58-4855-8163-f032796b84d0:127.0.0.1:35901], old=null, confs=<EMPTY_MAP>
2019-06-18 10:25:30,932 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8f4928d5-986a-4110-b07f-94c9a9ef8cd8/ratis] (custom)
2019-06-18 10:25:30,940 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8f4928d5-986a-4110-b07f-94c9a9ef8cd8/ratis/3705c2ed-506f-4b7d-9c41-0f8fcc6d7f68 does not exist. Creating ...
2019-06-18 10:25:30,951 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8f4928d5-986a-4110-b07f-94c9a9ef8cd8/ratis/3705c2ed-506f-4b7d-9c41-0f8fcc6d7f68/in_use.lock acquired by nodename 4320@ozone-unit-076618677d372z9n-3564682807
2019-06-18 10:25:30,960 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8f4928d5-986a-4110-b07f-94c9a9ef8cd8/ratis/3705c2ed-506f-4b7d-9c41-0f8fcc6d7f68 has been successfully formatted.
2019-06-18 10:25:30,962 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 10:25:30,962 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 10:25:30,964 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 10:25:30,966 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 10:25:30,969 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 10:25:30,973 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 10:25:30,976 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 877c8119-9a58-4855-8163-f032796b84d0-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8f4928d5-986a-4110-b07f-94c9a9ef8cd8/ratis/3705c2ed-506f-4b7d-9c41-0f8fcc6d7f68
2019-06-18 10:25:30,976 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 10:25:30,977 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 10:25:30,979 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 10:25:30,979 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 10:25:30,979 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 10:25:30,980 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 10:25:30,981 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 10:25:30,981 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 10:25:30,982 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 10:25:30,984 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 10:25:30,989 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 10:25:30,990 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 10:25:30,990 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 10:25:31,126 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 877c8119-9a58-4855-8163-f032796b84d0: start group-0F8FCC6D7F68
2019-06-18 10:25:31,127 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 877c8119-9a58-4855-8163-f032796b84d0:group-0F8FCC6D7F68 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 10:25:31,128 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 877c8119-9a58-4855-8163-f032796b84d0: start FollowerState
2019-06-18 10:25:31,130 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-0F8FCC6D7F68,id=877c8119-9a58-4855-8163-f032796b84d0
2019-06-18 10:25:32,327 INFO  impl.FollowerState (FollowerState.java:run(101)) - 877c8119-9a58-4855-8163-f032796b84d0:group-0F8FCC6D7F68 changes to CANDIDATE, lastRpcTime:1198, electionTimeout:1196ms
2019-06-18 10:25:32,327 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 877c8119-9a58-4855-8163-f032796b84d0: shutdown FollowerState
2019-06-18 10:25:32,327 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 877c8119-9a58-4855-8163-f032796b84d0:group-0F8FCC6D7F68 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 10:25:32,329 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 877c8119-9a58-4855-8163-f032796b84d0: start LeaderElection
2019-06-18 10:25:32,333 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 877c8119-9a58-4855-8163-f032796b84d0:group-0F8FCC6D7F68:LeaderElection1: begin an election at term 1 for -1: [877c8119-9a58-4855-8163-f032796b84d0:127.0.0.1:35901], old=null
2019-06-18 10:25:32,334 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 877c8119-9a58-4855-8163-f032796b84d0: shutdown LeaderElection
2019-06-18 10:25:32,335 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 877c8119-9a58-4855-8163-f032796b84d0:group-0F8FCC6D7F68 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 10:25:32,335 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 877c8119-9a58-4855-8163-f032796b84d0:group-0F8FCC6D7F68 change Leader from null to 877c8119-9a58-4855-8163-f032796b84d0 at term 1 for becomeLeader, leader elected after 1373ms
2019-06-18 10:25:32,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 10:25:32,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 10:25:32,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 10:25:32,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 10:25:32,351 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 877c8119-9a58-4855-8163-f032796b84d0: start LeaderState
2019-06-18 10:25:32,366 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 877c8119-9a58-4855-8163-f032796b84d0-RaftLogWorker: Starting segment from index:0
2019-06-18 10:25:32,380 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 877c8119-9a58-4855-8163-f032796b84d0:group-0F8FCC6D7F68 set configuration 0: [877c8119-9a58-4855-8163-f032796b84d0:127.0.0.1:35901], old=null at 0
2019-06-18 10:25:32,539 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 877c8119-9a58-4855-8163-f032796b84d0-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8f4928d5-986a-4110-b07f-94c9a9ef8cd8/ratis/3705c2ed-506f-4b7d-9c41-0f8fcc6d7f68/current/log_inprogress_0
2019-06-18 10:25:33,442 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-18 10:25:33,525 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 4354807680114583211 is closed with bcsId 0.
2019-06-18 10:25:33,526 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 10:25:33,528 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 877c8119-9a58-4855-8163-f032796b84d0: close
2019-06-18 10:25:33,529 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 877c8119-9a58-4855-8163-f032796b84d0: shutdown group-0F8FCC6D7F68
2019-06-18 10:25:33,530 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-0F8FCC6D7F68,id=877c8119-9a58-4855-8163-f032796b84d0
2019-06-18 10:25:33,530 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 877c8119-9a58-4855-8163-f032796b84d0: shutdown LeaderState
2019-06-18 10:25:33,531 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 877c8119-9a58-4855-8163-f032796b84d0-PendingRequests: sendNotLeaderResponses
2019-06-18 10:25:33,535 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-877c8119-9a58-4855-8163-f032796b84d0-group-0F8FCC6D7F68: set stopIndex = 4
2019-06-18 10:25:33,535 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-18 10:25:33,535 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8f4928d5-986a-4110-b07f-94c9a9ef8cd8/ratis/3705c2ed-506f-4b7d-9c41-0f8fcc6d7f68/sm/snapshot.1_4
2019-06-18 10:25:33,556 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 877c8119-9a58-4855-8163-f032796b84d0:group-0F8FCC6D7F68 closes. The last applied log index is 4
2019-06-18 10:25:33,557 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 877c8119-9a58-4855-8163-f032796b84d0-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 10:25:33,559 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 877c8119-9a58-4855-8163-f032796b84d0-RaftLogWorker close()
2019-06-18 10:25:33,560 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 877c8119-9a58-4855-8163-f032796b84d0: shutdown server with port 35901 now
2019-06-18 10:25:33,570 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 877c8119-9a58-4855-8163-f032796b84d0: shutdown server with port 35901 successfully
2019-06-18 10:25:33,575 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-18 10:25:33,618 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercf2c5919-6142-499b-807f-21b03a2c5e51/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 10:25:33,618 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercf2c5919-6142-499b-807f-21b03a2c5e51/hdds to VolumeSet
2019-06-18 10:25:33,618 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@655523dd
2019-06-18 10:25:33,627 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@655523dd
2019-06-18 10:25:33,641 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 33727
2019-06-18 10:25:33,647 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 10:25:33,648 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 10:25:33,648 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 33727 (custom)
2019-06-18 10:25:33,649 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 10:25:33,649 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 10:25:33,649 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 10:25:33,649 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 10:25:33,650 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercf2c5919-6142-499b-807f-21b03a2c5e51/ratis] (custom)
2019-06-18 10:25:33,651 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 43139
2019-06-18 10:25:33,651 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 10:25:33,651 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 10:25:33,652 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 71c7c414-cb60-4a87-9c6c-a136de486655 at port 33727
2019-06-18 10:25:33,714 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 71c7c414-cb60-4a87-9c6c-a136de486655: start RPC server
2019-06-18 10:25:33,719 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 71c7c414-cb60-4a87-9c6c-a136de486655: GrpcService started, listening on 0.0.0.0/0.0.0.0:33727
2019-06-18 10:25:33,739 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 71c7c414-cb60-4a87-9c6c-a136de486655: addNew group-B73F765C798D:[71c7c414-cb60-4a87-9c6c-a136de486655:127.0.0.1:33727] returns group-B73F765C798D:java.util.concurrent.CompletableFuture@431a180[Not completed]
2019-06-18 10:25:33,740 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 71c7c414-cb60-4a87-9c6c-a136de486655: new RaftServerImpl for group-B73F765C798D:[71c7c414-cb60-4a87-9c6c-a136de486655:127.0.0.1:33727] with ContainerStateMachine:uninitialized
2019-06-18 10:25:33,742 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 10:25:33,742 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 10:25:33,742 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 10:25:33,742 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 10:25:33,742 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 71c7c414-cb60-4a87-9c6c-a136de486655:group-B73F765C798D ConfigurationManager, init=-1: [71c7c414-cb60-4a87-9c6c-a136de486655:127.0.0.1:33727], old=null, confs=<EMPTY_MAP>
2019-06-18 10:25:33,742 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercf2c5919-6142-499b-807f-21b03a2c5e51/ratis] (custom)
2019-06-18 10:25:33,743 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercf2c5919-6142-499b-807f-21b03a2c5e51/ratis/48f25f62-90ca-4c1f-8fda-b73f765c798d does not exist. Creating ...
2019-06-18 10:25:33,746 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercf2c5919-6142-499b-807f-21b03a2c5e51/ratis/48f25f62-90ca-4c1f-8fda-b73f765c798d/in_use.lock acquired by nodename 4320@ozone-unit-076618677d372z9n-3564682807
2019-06-18 10:25:33,748 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercf2c5919-6142-499b-807f-21b03a2c5e51/ratis/48f25f62-90ca-4c1f-8fda-b73f765c798d has been successfully formatted.
2019-06-18 10:25:33,748 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 10:25:33,748 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 10:25:33,748 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 10:25:33,749 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 10:25:33,749 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 10:25:33,749 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 10:25:33,749 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 71c7c414-cb60-4a87-9c6c-a136de486655-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercf2c5919-6142-499b-807f-21b03a2c5e51/ratis/48f25f62-90ca-4c1f-8fda-b73f765c798d
2019-06-18 10:25:33,749 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 10:25:33,749 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 10:25:33,749 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 10:25:33,750 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 10:25:33,750 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 10:25:33,750 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 10:25:33,750 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 10:25:33,750 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 10:25:33,750 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 10:25:33,750 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 10:25:33,751 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 10:25:33,751 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 10:25:33,751 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 10:25:33,751 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 71c7c414-cb60-4a87-9c6c-a136de486655: start group-B73F765C798D
2019-06-18 10:25:33,751 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 71c7c414-cb60-4a87-9c6c-a136de486655:group-B73F765C798D changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 10:25:33,751 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 71c7c414-cb60-4a87-9c6c-a136de486655: start FollowerState
2019-06-18 10:25:33,752 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-B73F765C798D,id=71c7c414-cb60-4a87-9c6c-a136de486655
2019-06-18 10:25:34,792 INFO  impl.FollowerState (FollowerState.java:run(101)) - 71c7c414-cb60-4a87-9c6c-a136de486655:group-B73F765C798D changes to CANDIDATE, lastRpcTime:1040, electionTimeout:1040ms
2019-06-18 10:25:34,792 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 71c7c414-cb60-4a87-9c6c-a136de486655: shutdown FollowerState
2019-06-18 10:25:34,792 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 71c7c414-cb60-4a87-9c6c-a136de486655:group-B73F765C798D changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 10:25:34,792 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 71c7c414-cb60-4a87-9c6c-a136de486655: start LeaderElection
2019-06-18 10:25:34,796 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 71c7c414-cb60-4a87-9c6c-a136de486655:group-B73F765C798D:LeaderElection2: begin an election at term 1 for -1: [71c7c414-cb60-4a87-9c6c-a136de486655:127.0.0.1:33727], old=null
2019-06-18 10:25:34,797 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 71c7c414-cb60-4a87-9c6c-a136de486655: shutdown LeaderElection
2019-06-18 10:25:34,797 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 71c7c414-cb60-4a87-9c6c-a136de486655:group-B73F765C798D changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 10:25:34,797 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 71c7c414-cb60-4a87-9c6c-a136de486655:group-B73F765C798D change Leader from null to 71c7c414-cb60-4a87-9c6c-a136de486655 at term 1 for becomeLeader, leader elected after 1048ms
2019-06-18 10:25:34,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 10:25:34,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 10:25:34,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 10:25:34,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 10:25:34,798 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 71c7c414-cb60-4a87-9c6c-a136de486655: start LeaderState
2019-06-18 10:25:34,799 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 71c7c414-cb60-4a87-9c6c-a136de486655-RaftLogWorker: Starting segment from index:0
2019-06-18 10:25:34,799 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 71c7c414-cb60-4a87-9c6c-a136de486655:group-B73F765C798D set configuration 0: [71c7c414-cb60-4a87-9c6c-a136de486655:127.0.0.1:33727], old=null at 0
2019-06-18 10:25:34,844 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 71c7c414-cb60-4a87-9c6c-a136de486655-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercf2c5919-6142-499b-807f-21b03a2c5e51/ratis/48f25f62-90ca-4c1f-8fda-b73f765c798d/current/log_inprogress_0
2019-06-18 10:25:35,800 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 10:25:35,805 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 71c7c414-cb60-4a87-9c6c-a136de486655: close
2019-06-18 10:25:35,806 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 71c7c414-cb60-4a87-9c6c-a136de486655: shutdown group-B73F765C798D
2019-06-18 10:25:35,806 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-B73F765C798D,id=71c7c414-cb60-4a87-9c6c-a136de486655
2019-06-18 10:25:35,806 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 71c7c414-cb60-4a87-9c6c-a136de486655: shutdown LeaderState
2019-06-18 10:25:35,807 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 71c7c414-cb60-4a87-9c6c-a136de486655-PendingRequests: sendNotLeaderResponses
2019-06-18 10:25:35,808 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-71c7c414-cb60-4a87-9c6c-a136de486655-group-B73F765C798D: set stopIndex = 2
2019-06-18 10:25:35,808 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-18 10:25:35,809 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercf2c5919-6142-499b-807f-21b03a2c5e51/ratis/48f25f62-90ca-4c1f-8fda-b73f765c798d/sm/snapshot.1_2
2019-06-18 10:25:35,809 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 71c7c414-cb60-4a87-9c6c-a136de486655:group-B73F765C798D closes. The last applied log index is 2
2019-06-18 10:25:35,810 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 71c7c414-cb60-4a87-9c6c-a136de486655-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 10:25:35,811 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 71c7c414-cb60-4a87-9c6c-a136de486655-RaftLogWorker close()
2019-06-18 10:25:35,812 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 71c7c414-cb60-4a87-9c6c-a136de486655: shutdown server with port 33727 now
2019-06-18 10:25:35,815 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 71c7c414-cb60-4a87-9c6c-a136de486655: shutdown server with port 33727 successfully
2019-06-18 10:25:35,817 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-18 10:25:35,850 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler134b92c4-f7f4-45d9-b1ce-08ee97f1c4d7/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 10:25:35,851 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler134b92c4-f7f4-45d9-b1ce-08ee97f1c4d7/hdds to VolumeSet
2019-06-18 10:25:35,851 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@26a2f7f9
2019-06-18 10:25:35,852 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@26a2f7f9
2019-06-18 10:25:35,866 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 34287
2019-06-18 10:25:35,867 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 10:25:35,868 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 10:25:35,868 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 34287 (custom)
2019-06-18 10:25:35,868 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 10:25:35,869 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 10:25:35,869 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 10:25:35,869 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 10:25:35,870 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler134b92c4-f7f4-45d9-b1ce-08ee97f1c4d7/ratis] (custom)
2019-06-18 10:25:35,871 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 40053
2019-06-18 10:25:35,871 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 10:25:35,872 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 10:25:35,872 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 6ca7987c-8718-4f06-b06a-30ce528489be at port 34287
2019-06-18 10:25:35,884 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 6ca7987c-8718-4f06-b06a-30ce528489be: start RPC server
2019-06-18 10:25:35,886 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 6ca7987c-8718-4f06-b06a-30ce528489be: GrpcService started, listening on 0.0.0.0/0.0.0.0:34287
2019-06-18 10:25:35,901 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 6ca7987c-8718-4f06-b06a-30ce528489be: addNew group-3317F33122BE:[6ca7987c-8718-4f06-b06a-30ce528489be:127.0.0.1:34287] returns group-3317F33122BE:java.util.concurrent.CompletableFuture@1c957ad8[Not completed]
2019-06-18 10:25:35,904 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 6ca7987c-8718-4f06-b06a-30ce528489be: new RaftServerImpl for group-3317F33122BE:[6ca7987c-8718-4f06-b06a-30ce528489be:127.0.0.1:34287] with ContainerStateMachine:uninitialized
2019-06-18 10:25:35,904 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 10:25:35,904 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 10:25:35,905 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 10:25:35,905 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 10:25:35,905 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 6ca7987c-8718-4f06-b06a-30ce528489be:group-3317F33122BE ConfigurationManager, init=-1: [6ca7987c-8718-4f06-b06a-30ce528489be:127.0.0.1:34287], old=null, confs=<EMPTY_MAP>
2019-06-18 10:25:35,906 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler134b92c4-f7f4-45d9-b1ce-08ee97f1c4d7/ratis] (custom)
2019-06-18 10:25:35,906 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler134b92c4-f7f4-45d9-b1ce-08ee97f1c4d7/ratis/3fd810a8-1b93-4066-96c5-3317f33122be does not exist. Creating ...
2019-06-18 10:25:35,910 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler134b92c4-f7f4-45d9-b1ce-08ee97f1c4d7/ratis/3fd810a8-1b93-4066-96c5-3317f33122be/in_use.lock acquired by nodename 4320@ozone-unit-076618677d372z9n-3564682807
2019-06-18 10:25:35,913 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler134b92c4-f7f4-45d9-b1ce-08ee97f1c4d7/ratis/3fd810a8-1b93-4066-96c5-3317f33122be has been successfully formatted.
2019-06-18 10:25:35,914 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 10:25:35,914 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 10:25:35,914 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 10:25:35,914 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 10:25:35,914 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 10:25:35,915 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 10:25:35,915 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 6ca7987c-8718-4f06-b06a-30ce528489be-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler134b92c4-f7f4-45d9-b1ce-08ee97f1c4d7/ratis/3fd810a8-1b93-4066-96c5-3317f33122be
2019-06-18 10:25:35,915 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 10:25:35,915 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 10:25:35,915 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 10:25:35,915 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 10:25:35,915 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 10:25:35,916 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 10:25:35,916 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 10:25:35,916 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 10:25:35,916 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 10:25:35,916 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 10:25:35,918 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 10:25:35,918 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 10:25:35,918 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 10:25:35,919 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 6ca7987c-8718-4f06-b06a-30ce528489be: start group-3317F33122BE
2019-06-18 10:25:35,919 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6ca7987c-8718-4f06-b06a-30ce528489be:group-3317F33122BE changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 10:25:35,919 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6ca7987c-8718-4f06-b06a-30ce528489be: start FollowerState
2019-06-18 10:25:35,920 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-3317F33122BE,id=6ca7987c-8718-4f06-b06a-30ce528489be
2019-06-18 10:25:36,934 INFO  impl.FollowerState (FollowerState.java:run(101)) - 6ca7987c-8718-4f06-b06a-30ce528489be:group-3317F33122BE changes to CANDIDATE, lastRpcTime:1014, electionTimeout:1014ms
2019-06-18 10:25:36,934 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 6ca7987c-8718-4f06-b06a-30ce528489be: shutdown FollowerState
2019-06-18 10:25:36,934 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6ca7987c-8718-4f06-b06a-30ce528489be:group-3317F33122BE changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 10:25:36,935 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6ca7987c-8718-4f06-b06a-30ce528489be: start LeaderElection
2019-06-18 10:25:36,947 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 6ca7987c-8718-4f06-b06a-30ce528489be:group-3317F33122BE:LeaderElection3: begin an election at term 1 for -1: [6ca7987c-8718-4f06-b06a-30ce528489be:127.0.0.1:34287], old=null
2019-06-18 10:25:36,947 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 6ca7987c-8718-4f06-b06a-30ce528489be: shutdown LeaderElection
2019-06-18 10:25:36,948 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6ca7987c-8718-4f06-b06a-30ce528489be:group-3317F33122BE changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 10:25:36,948 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 6ca7987c-8718-4f06-b06a-30ce528489be:group-3317F33122BE change Leader from null to 6ca7987c-8718-4f06-b06a-30ce528489be at term 1 for becomeLeader, leader elected after 1033ms
2019-06-18 10:25:36,948 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 10:25:36,948 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 10:25:36,948 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 10:25:36,948 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 10:25:36,948 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6ca7987c-8718-4f06-b06a-30ce528489be: start LeaderState
2019-06-18 10:25:36,949 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 6ca7987c-8718-4f06-b06a-30ce528489be-RaftLogWorker: Starting segment from index:0
2019-06-18 10:25:36,949 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 6ca7987c-8718-4f06-b06a-30ce528489be:group-3317F33122BE set configuration 0: [6ca7987c-8718-4f06-b06a-30ce528489be:127.0.0.1:34287], old=null at 0
2019-06-18 10:25:37,002 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 6ca7987c-8718-4f06-b06a-30ce528489be-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler134b92c4-f7f4-45d9-b1ce-08ee97f1c4d7/ratis/3fd810a8-1b93-4066-96c5-3317f33122be/current/log_inprogress_0
2019-06-18 10:25:37,993 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 8460312426712354376 is closed with bcsId 0.
2019-06-18 10:25:37,994 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 10:25:37,994 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 6ca7987c-8718-4f06-b06a-30ce528489be: close
2019-06-18 10:25:37,994 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 6ca7987c-8718-4f06-b06a-30ce528489be: shutdown group-3317F33122BE
2019-06-18 10:25:37,998 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-3317F33122BE,id=6ca7987c-8718-4f06-b06a-30ce528489be
2019-06-18 10:25:37,998 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 6ca7987c-8718-4f06-b06a-30ce528489be: shutdown LeaderState
2019-06-18 10:25:37,999 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 6ca7987c-8718-4f06-b06a-30ce528489be-PendingRequests: sendNotLeaderResponses
2019-06-18 10:25:38,000 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-6ca7987c-8718-4f06-b06a-30ce528489be-group-3317F33122BE: set stopIndex = 2
2019-06-18 10:25:38,000 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-18 10:25:38,000 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler134b92c4-f7f4-45d9-b1ce-08ee97f1c4d7/ratis/3fd810a8-1b93-4066-96c5-3317f33122be/sm/snapshot.1_2
2019-06-18 10:25:38,001 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 6ca7987c-8718-4f06-b06a-30ce528489be:group-3317F33122BE closes. The last applied log index is 2
2019-06-18 10:25:38,001 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 6ca7987c-8718-4f06-b06a-30ce528489be-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 10:25:38,002 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 6ca7987c-8718-4f06-b06a-30ce528489be-RaftLogWorker close()
2019-06-18 10:25:38,004 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 6ca7987c-8718-4f06-b06a-30ce528489be: shutdown server with port 34287 now
2019-06-18 10:25:38,009 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 6ca7987c-8718-4f06-b06a-30ce528489be: shutdown server with port 34287 successfully
2019-06-18 10:25:38,031 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-18 10:25:38,076 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler52a8190e-09c9-4d1d-a70f-793ccefb7d1b/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 10:25:38,076 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler52a8190e-09c9-4d1d-a70f-793ccefb7d1b/hdds to VolumeSet
2019-06-18 10:25:38,076 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@455824ad
2019-06-18 10:25:38,084 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@455824ad
2019-06-18 10:25:38,097 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 36523
2019-06-18 10:25:38,098 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 10:25:38,099 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 10:25:38,100 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 36523 (custom)
2019-06-18 10:25:38,100 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 10:25:38,100 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 10:25:38,100 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 10:25:38,101 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 10:25:38,101 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler52a8190e-09c9-4d1d-a70f-793ccefb7d1b/ratis] (custom)
2019-06-18 10:25:38,102 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 43963
2019-06-18 10:25:38,102 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 10:25:38,102 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 10:25:38,103 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9 at port 36523
2019-06-18 10:25:38,121 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9: start RPC server
2019-06-18 10:25:38,129 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9: GrpcService started, listening on 0.0.0.0/0.0.0.0:36523
Jun 18, 2019 10:25:38 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:34287} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 18, 2019 10:25:38 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:33727} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-18 10:25:38,157 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9: addNew group-59449D84404D:[2cb913c9-4897-4144-9c40-2c7c0a4dd3a9:127.0.0.1:36523] returns group-59449D84404D:java.util.concurrent.CompletableFuture@742ae71a[Not completed]
2019-06-18 10:25:38,158 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9: new RaftServerImpl for group-59449D84404D:[2cb913c9-4897-4144-9c40-2c7c0a4dd3a9:127.0.0.1:36523] with ContainerStateMachine:uninitialized
2019-06-18 10:25:38,158 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 10:25:38,158 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 10:25:38,159 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 10:25:38,159 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 10:25:38,159 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9:group-59449D84404D ConfigurationManager, init=-1: [2cb913c9-4897-4144-9c40-2c7c0a4dd3a9:127.0.0.1:36523], old=null, confs=<EMPTY_MAP>
2019-06-18 10:25:38,159 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler52a8190e-09c9-4d1d-a70f-793ccefb7d1b/ratis] (custom)
2019-06-18 10:25:38,159 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler52a8190e-09c9-4d1d-a70f-793ccefb7d1b/ratis/0c1c9cdf-2494-44fe-883b-59449d84404d does not exist. Creating ...
2019-06-18 10:25:38,163 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler52a8190e-09c9-4d1d-a70f-793ccefb7d1b/ratis/0c1c9cdf-2494-44fe-883b-59449d84404d/in_use.lock acquired by nodename 4320@ozone-unit-076618677d372z9n-3564682807
2019-06-18 10:25:38,165 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler52a8190e-09c9-4d1d-a70f-793ccefb7d1b/ratis/0c1c9cdf-2494-44fe-883b-59449d84404d has been successfully formatted.
2019-06-18 10:25:38,166 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 10:25:38,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 10:25:38,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 10:25:38,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 10:25:38,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 10:25:38,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 10:25:38,166 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler52a8190e-09c9-4d1d-a70f-793ccefb7d1b/ratis/0c1c9cdf-2494-44fe-883b-59449d84404d
2019-06-18 10:25:38,167 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 10:25:38,167 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 10:25:38,167 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 10:25:38,167 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 10:25:38,167 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 10:25:38,167 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 10:25:38,167 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 10:25:38,168 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 10:25:38,168 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 10:25:38,168 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 10:25:38,168 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 10:25:38,168 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 10:25:38,169 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 10:25:38,169 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9: start group-59449D84404D
2019-06-18 10:25:38,169 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9:group-59449D84404D changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 10:25:38,169 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9: start FollowerState
2019-06-18 10:25:38,170 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-59449D84404D,id=2cb913c9-4897-4144-9c40-2c7c0a4dd3a9
2019-06-18 10:25:39,185 INFO  impl.FollowerState (FollowerState.java:run(101)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9:group-59449D84404D changes to CANDIDATE, lastRpcTime:1015, electionTimeout:1015ms
2019-06-18 10:25:39,185 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9: shutdown FollowerState
2019-06-18 10:25:39,185 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9:group-59449D84404D changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 10:25:39,185 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9: start LeaderElection
2019-06-18 10:25:39,190 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9:group-59449D84404D:LeaderElection4: begin an election at term 1 for -1: [2cb913c9-4897-4144-9c40-2c7c0a4dd3a9:127.0.0.1:36523], old=null
2019-06-18 10:25:39,190 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9: shutdown LeaderElection
2019-06-18 10:25:39,190 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9:group-59449D84404D changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 10:25:39,190 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9:group-59449D84404D change Leader from null to 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9 at term 1 for becomeLeader, leader elected after 1024ms
2019-06-18 10:25:39,190 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 10:25:39,190 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 10:25:39,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 10:25:39,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 10:25:39,191 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9: start LeaderState
2019-06-18 10:25:39,191 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9-RaftLogWorker: Starting segment from index:0
2019-06-18 10:25:39,192 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9:group-59449D84404D set configuration 0: [2cb913c9-4897-4144-9c40-2c7c0a4dd3a9:127.0.0.1:36523], old=null at 0
2019-06-18 10:25:39,246 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler52a8190e-09c9-4d1d-a70f-793ccefb7d1b/ratis/0c1c9cdf-2494-44fe-883b-59449d84404d/current/log_inprogress_0
2019-06-18 10:25:40,230 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 9154589593521154783 is closed with bcsId 0.
2019-06-18 10:25:40,231 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 10:25:40,232 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9: close
2019-06-18 10:25:40,232 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9: shutdown group-59449D84404D
2019-06-18 10:25:40,232 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-59449D84404D,id=2cb913c9-4897-4144-9c40-2c7c0a4dd3a9
2019-06-18 10:25:40,233 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9: shutdown LeaderState
2019-06-18 10:25:40,233 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9-PendingRequests: sendNotLeaderResponses
2019-06-18 10:25:40,234 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-2cb913c9-4897-4144-9c40-2c7c0a4dd3a9-group-59449D84404D: set stopIndex = 2
2019-06-18 10:25:40,234 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-18 10:25:40,235 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler52a8190e-09c9-4d1d-a70f-793ccefb7d1b/ratis/0c1c9cdf-2494-44fe-883b-59449d84404d/sm/snapshot.1_2
2019-06-18 10:25:40,235 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9:group-59449D84404D closes. The last applied log index is 2
2019-06-18 10:25:40,236 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 10:25:40,237 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9-RaftLogWorker close()
2019-06-18 10:25:40,237 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9: shutdown server with port 36523 now
2019-06-18 10:25:40,239 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 2cb913c9-4897-4144-9c40-2c7c0a4dd3a9: shutdown server with port 36523 successfully
2019-06-18 10:25:40,240 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-18 10:25:40,271 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6c2100b-227b-4b4d-ac91-611aa8303ab8/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 10:25:40,271 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6c2100b-227b-4b4d-ac91-611aa8303ab8/hdds to VolumeSet
2019-06-18 10:25:40,271 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1ac45389
2019-06-18 10:25:40,278 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1ac45389
2019-06-18 10:25:40,289 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 33445
2019-06-18 10:25:40,289 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 10:25:40,290 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 10:25:40,290 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 33445 (custom)
2019-06-18 10:25:40,291 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 10:25:40,291 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 10:25:40,291 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 10:25:40,291 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 10:25:40,292 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6c2100b-227b-4b4d-ac91-611aa8303ab8/ratis] (custom)
2019-06-18 10:25:40,292 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 45829
2019-06-18 10:25:40,293 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 10:25:40,293 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 10:25:40,293 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis b63c6d40-504e-46b0-8a74-8b3c85d56c1b at port 33445
2019-06-18 10:25:40,308 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b: start RPC server
2019-06-18 10:25:40,309 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b: GrpcService started, listening on 0.0.0.0/0.0.0.0:33445
2019-06-18 10:25:40,326 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b: addNew group-ECA5BDF45DFA:[b63c6d40-504e-46b0-8a74-8b3c85d56c1b:127.0.0.1:33445] returns group-ECA5BDF45DFA:java.util.concurrent.CompletableFuture@ae6a35e[Not completed]
2019-06-18 10:25:40,327 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b: new RaftServerImpl for group-ECA5BDF45DFA:[b63c6d40-504e-46b0-8a74-8b3c85d56c1b:127.0.0.1:33445] with ContainerStateMachine:uninitialized
2019-06-18 10:25:40,329 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 10:25:40,329 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 10:25:40,329 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 10:25:40,329 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 10:25:40,330 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b:group-ECA5BDF45DFA ConfigurationManager, init=-1: [b63c6d40-504e-46b0-8a74-8b3c85d56c1b:127.0.0.1:33445], old=null, confs=<EMPTY_MAP>
2019-06-18 10:25:40,330 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6c2100b-227b-4b4d-ac91-611aa8303ab8/ratis] (custom)
2019-06-18 10:25:40,330 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6c2100b-227b-4b4d-ac91-611aa8303ab8/ratis/8ae736f0-0825-4cf1-9587-eca5bdf45dfa does not exist. Creating ...
2019-06-18 10:25:40,333 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6c2100b-227b-4b4d-ac91-611aa8303ab8/ratis/8ae736f0-0825-4cf1-9587-eca5bdf45dfa/in_use.lock acquired by nodename 4320@ozone-unit-076618677d372z9n-3564682807
2019-06-18 10:25:40,336 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6c2100b-227b-4b4d-ac91-611aa8303ab8/ratis/8ae736f0-0825-4cf1-9587-eca5bdf45dfa has been successfully formatted.
2019-06-18 10:25:40,336 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 10:25:40,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 10:25:40,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 10:25:40,337 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 10:25:40,337 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 10:25:40,337 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 10:25:40,337 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new b63c6d40-504e-46b0-8a74-8b3c85d56c1b-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6c2100b-227b-4b4d-ac91-611aa8303ab8/ratis/8ae736f0-0825-4cf1-9587-eca5bdf45dfa
2019-06-18 10:25:40,337 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 10:25:40,338 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 10:25:40,338 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 10:25:40,338 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 10:25:40,338 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 10:25:40,338 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 10:25:40,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 10:25:40,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 10:25:40,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 10:25:40,339 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 10:25:40,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 10:25:40,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 10:25:40,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 10:25:40,340 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b: start group-ECA5BDF45DFA
2019-06-18 10:25:40,340 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b:group-ECA5BDF45DFA changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 10:25:40,341 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b: start FollowerState
2019-06-18 10:25:40,341 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-ECA5BDF45DFA,id=b63c6d40-504e-46b0-8a74-8b3c85d56c1b
2019-06-18 10:25:41,501 INFO  impl.FollowerState (FollowerState.java:run(101)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b:group-ECA5BDF45DFA changes to CANDIDATE, lastRpcTime:1160, electionTimeout:1160ms
2019-06-18 10:25:41,501 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b: shutdown FollowerState
2019-06-18 10:25:41,502 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b:group-ECA5BDF45DFA changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 10:25:41,502 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b: start LeaderElection
2019-06-18 10:25:41,506 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b:group-ECA5BDF45DFA:LeaderElection5: begin an election at term 1 for -1: [b63c6d40-504e-46b0-8a74-8b3c85d56c1b:127.0.0.1:33445], old=null
2019-06-18 10:25:41,507 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b: shutdown LeaderElection
2019-06-18 10:25:41,507 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b:group-ECA5BDF45DFA changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 10:25:41,507 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b:group-ECA5BDF45DFA change Leader from null to b63c6d40-504e-46b0-8a74-8b3c85d56c1b at term 1 for becomeLeader, leader elected after 1170ms
2019-06-18 10:25:41,507 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 10:25:41,507 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 10:25:41,507 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 10:25:41,508 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 10:25:41,508 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b: start LeaderState
2019-06-18 10:25:41,508 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b-RaftLogWorker: Starting segment from index:0
2019-06-18 10:25:41,509 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b:group-ECA5BDF45DFA set configuration 0: [b63c6d40-504e-46b0-8a74-8b3c85d56c1b:127.0.0.1:33445], old=null at 0
2019-06-18 10:25:41,555 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6c2100b-227b-4b4d-ac91-611aa8303ab8/ratis/8ae736f0-0825-4cf1-9587-eca5bdf45dfa/current/log_inprogress_0
2019-06-18 10:25:42,399 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 5813790630537243167 is closed with bcsId 0.
2019-06-18 10:25:42,400 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 10:25:42,400 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b: close
2019-06-18 10:25:42,400 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b: shutdown group-ECA5BDF45DFA
2019-06-18 10:25:42,401 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-ECA5BDF45DFA,id=b63c6d40-504e-46b0-8a74-8b3c85d56c1b
2019-06-18 10:25:42,401 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b: shutdown LeaderState
2019-06-18 10:25:42,402 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b-PendingRequests: sendNotLeaderResponses
2019-06-18 10:25:42,404 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-b63c6d40-504e-46b0-8a74-8b3c85d56c1b-group-ECA5BDF45DFA: set stopIndex = 4
2019-06-18 10:25:42,404 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-18 10:25:42,404 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6c2100b-227b-4b4d-ac91-611aa8303ab8/ratis/8ae736f0-0825-4cf1-9587-eca5bdf45dfa/sm/snapshot.1_4
2019-06-18 10:25:42,404 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b:group-ECA5BDF45DFA closes. The last applied log index is 4
2019-06-18 10:25:42,405 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 10:25:42,406 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b-RaftLogWorker close()
2019-06-18 10:25:42,407 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b: shutdown server with port 33445 now
2019-06-18 10:25:42,409 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - b63c6d40-504e-46b0-8a74-8b3c85d56c1b: shutdown server with port 33445 successfully
2019-06-18 10:25:42,418 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
