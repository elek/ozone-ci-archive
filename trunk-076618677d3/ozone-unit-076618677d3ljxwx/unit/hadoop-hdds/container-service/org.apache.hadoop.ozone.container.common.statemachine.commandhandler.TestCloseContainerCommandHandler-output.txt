2019-06-17 12:16:00,052 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9c32b86d-2495-4070-ac09-5443338e68a3/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 12:16:00,058 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9c32b86d-2495-4070-ac09-5443338e68a3/hdds to VolumeSet
2019-06-17 12:16:00,088 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-17 12:16:00,119 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-17 12:16:00,519 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 39465
2019-06-17 12:16:01,078 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 12:16:01,104 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 12:16:01,115 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 39465 (custom)
2019-06-17 12:16:01,116 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 12:16:01,118 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 12:16:01,119 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 12:16:01,120 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 12:16:01,285 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9c32b86d-2495-4070-ac09-5443338e68a3/ratis] (custom)
2019-06-17 12:16:01,298 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 34241
2019-06-17 12:16:01,324 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 12:16:01,324 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 12:16:01,325 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 15f3eb44-8c7c-4524-a065-8c1d82918b95 at port 39465
2019-06-17 12:16:01,340 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95: start RPC server
2019-06-17 12:16:01,497 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95: GrpcService started, listening on 0.0.0.0/0.0.0.0:39465
2019-06-17 12:16:01,786 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95: addNew group-4D8D17B72C1F:[15f3eb44-8c7c-4524-a065-8c1d82918b95:127.0.0.1:39465] returns group-4D8D17B72C1F:java.util.concurrent.CompletableFuture@2dacbee5[Not completed]
2019-06-17 12:16:01,819 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95: new RaftServerImpl for group-4D8D17B72C1F:[15f3eb44-8c7c-4524-a065-8c1d82918b95:127.0.0.1:39465] with ContainerStateMachine:uninitialized
2019-06-17 12:16:01,820 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 12:16:01,820 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 12:16:01,820 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 12:16:01,821 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 12:16:01,826 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95:group-4D8D17B72C1F ConfigurationManager, init=-1: [15f3eb44-8c7c-4524-a065-8c1d82918b95:127.0.0.1:39465], old=null, confs=<EMPTY_MAP>
2019-06-17 12:16:01,826 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9c32b86d-2495-4070-ac09-5443338e68a3/ratis] (custom)
2019-06-17 12:16:01,832 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9c32b86d-2495-4070-ac09-5443338e68a3/ratis/f290c45e-029b-4ce3-855d-4d8d17b72c1f does not exist. Creating ...
2019-06-17 12:16:01,841 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9c32b86d-2495-4070-ac09-5443338e68a3/ratis/f290c45e-029b-4ce3-855d-4d8d17b72c1f/in_use.lock acquired by nodename 4307@ozone-unit-076618677d3ljxwx-2492325314
2019-06-17 12:16:01,851 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9c32b86d-2495-4070-ac09-5443338e68a3/ratis/f290c45e-029b-4ce3-855d-4d8d17b72c1f has been successfully formatted.
2019-06-17 12:16:01,853 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 12:16:01,853 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 12:16:01,855 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 12:16:01,857 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 12:16:01,859 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 12:16:01,863 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 12:16:01,865 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 15f3eb44-8c7c-4524-a065-8c1d82918b95-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9c32b86d-2495-4070-ac09-5443338e68a3/ratis/f290c45e-029b-4ce3-855d-4d8d17b72c1f
2019-06-17 12:16:01,866 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 12:16:01,866 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 12:16:01,868 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 12:16:01,868 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 12:16:01,869 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 12:16:01,869 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 12:16:01,870 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 12:16:01,870 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 12:16:01,871 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 12:16:01,873 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 12:16:01,877 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 12:16:01,878 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 12:16:01,879 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 12:16:01,984 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95: start group-4D8D17B72C1F
2019-06-17 12:16:01,985 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95:group-4D8D17B72C1F changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 12:16:01,986 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95: start FollowerState
2019-06-17 12:16:01,988 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-4D8D17B72C1F,id=15f3eb44-8c7c-4524-a065-8c1d82918b95
2019-06-17 12:16:03,152 INFO  impl.FollowerState (FollowerState.java:run(101)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95:group-4D8D17B72C1F changes to CANDIDATE, lastRpcTime:1165, electionTimeout:1165ms
2019-06-17 12:16:03,152 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95: shutdown FollowerState
2019-06-17 12:16:03,152 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95:group-4D8D17B72C1F changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 12:16:03,154 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95: start LeaderElection
2019-06-17 12:16:03,157 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95:group-4D8D17B72C1F:LeaderElection1: begin an election at term 1 for -1: [15f3eb44-8c7c-4524-a065-8c1d82918b95:127.0.0.1:39465], old=null
2019-06-17 12:16:03,158 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95: shutdown LeaderElection
2019-06-17 12:16:03,159 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95:group-4D8D17B72C1F changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 12:16:03,159 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95:group-4D8D17B72C1F change Leader from null to 15f3eb44-8c7c-4524-a065-8c1d82918b95 at term 1 for becomeLeader, leader elected after 1305ms
2019-06-17 12:16:03,163 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 12:16:03,163 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 12:16:03,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 12:16:03,166 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 12:16:03,175 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95: start LeaderState
2019-06-17 12:16:03,189 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95-RaftLogWorker: Starting segment from index:0
2019-06-17 12:16:03,196 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95:group-4D8D17B72C1F set configuration 0: [15f3eb44-8c7c-4524-a065-8c1d82918b95:127.0.0.1:39465], old=null at 0
2019-06-17 12:16:03,361 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9c32b86d-2495-4070-ac09-5443338e68a3/ratis/f290c45e-029b-4ce3-855d-4d8d17b72c1f/current/log_inprogress_0
2019-06-17 12:16:04,247 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-17 12:16:04,315 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 4424207654468514826 is closed with bcsId 0.
2019-06-17 12:16:04,316 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 12:16:04,317 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95: close
2019-06-17 12:16:04,318 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95: shutdown group-4D8D17B72C1F
2019-06-17 12:16:04,319 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-4D8D17B72C1F,id=15f3eb44-8c7c-4524-a065-8c1d82918b95
2019-06-17 12:16:04,319 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95: shutdown LeaderState
2019-06-17 12:16:04,320 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95-PendingRequests: sendNotLeaderResponses
2019-06-17 12:16:04,323 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-15f3eb44-8c7c-4524-a065-8c1d82918b95-group-4D8D17B72C1F: set stopIndex = 4
2019-06-17 12:16:04,323 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 12:16:04,323 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9c32b86d-2495-4070-ac09-5443338e68a3/ratis/f290c45e-029b-4ce3-855d-4d8d17b72c1f/sm/snapshot.1_4
2019-06-17 12:16:04,329 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95:group-4D8D17B72C1F closes. The last applied log index is 4
2019-06-17 12:16:04,330 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 12:16:04,331 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95-RaftLogWorker close()
2019-06-17 12:16:04,332 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95: shutdown server with port 39465 now
2019-06-17 12:16:04,338 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 15f3eb44-8c7c-4524-a065-8c1d82918b95: shutdown server with port 39465 successfully
2019-06-17 12:16:04,346 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 12:16:04,376 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6749ee43-9c73-4238-9991-1bb2b997602f/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 12:16:04,376 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6749ee43-9c73-4238-9991-1bb2b997602f/hdds to VolumeSet
2019-06-17 12:16:04,376 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@47547132
2019-06-17 12:16:04,382 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@47547132
2019-06-17 12:16:04,395 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 39981
2019-06-17 12:16:04,396 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 12:16:04,397 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 12:16:04,397 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 39981 (custom)
2019-06-17 12:16:04,397 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 12:16:04,398 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 12:16:04,398 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 12:16:04,398 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 12:16:04,399 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6749ee43-9c73-4238-9991-1bb2b997602f/ratis] (custom)
2019-06-17 12:16:04,399 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 41779
2019-06-17 12:16:04,400 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 12:16:04,400 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 12:16:04,400 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f at port 39981
2019-06-17 12:16:04,439 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f: start RPC server
2019-06-17 12:16:04,441 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f: GrpcService started, listening on 0.0.0.0/0.0.0.0:39981
2019-06-17 12:16:04,451 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f: addNew group-36008EEAB698:[d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f:127.0.0.1:39981] returns group-36008EEAB698:java.util.concurrent.CompletableFuture@3e16da[Not completed]
2019-06-17 12:16:04,453 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f: new RaftServerImpl for group-36008EEAB698:[d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f:127.0.0.1:39981] with ContainerStateMachine:uninitialized
2019-06-17 12:16:04,453 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 12:16:04,453 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 12:16:04,453 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 12:16:04,453 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 12:16:04,453 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f:group-36008EEAB698 ConfigurationManager, init=-1: [d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f:127.0.0.1:39981], old=null, confs=<EMPTY_MAP>
2019-06-17 12:16:04,454 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6749ee43-9c73-4238-9991-1bb2b997602f/ratis] (custom)
2019-06-17 12:16:04,454 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6749ee43-9c73-4238-9991-1bb2b997602f/ratis/cf55cc8d-f199-4406-b8ca-36008eeab698 does not exist. Creating ...
2019-06-17 12:16:04,457 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6749ee43-9c73-4238-9991-1bb2b997602f/ratis/cf55cc8d-f199-4406-b8ca-36008eeab698/in_use.lock acquired by nodename 4307@ozone-unit-076618677d3ljxwx-2492325314
2019-06-17 12:16:04,459 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6749ee43-9c73-4238-9991-1bb2b997602f/ratis/cf55cc8d-f199-4406-b8ca-36008eeab698 has been successfully formatted.
2019-06-17 12:16:04,459 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 12:16:04,460 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 12:16:04,460 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 12:16:04,460 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 12:16:04,460 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 12:16:04,460 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 12:16:04,460 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6749ee43-9c73-4238-9991-1bb2b997602f/ratis/cf55cc8d-f199-4406-b8ca-36008eeab698
2019-06-17 12:16:04,460 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 12:16:04,461 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 12:16:04,461 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 12:16:04,461 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 12:16:04,461 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 12:16:04,462 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 12:16:04,462 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 12:16:04,462 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 12:16:04,462 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 12:16:04,462 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 12:16:04,463 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 12:16:04,463 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 12:16:04,463 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 12:16:04,463 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f: start group-36008EEAB698
2019-06-17 12:16:04,463 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f:group-36008EEAB698 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 12:16:04,463 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f: start FollowerState
2019-06-17 12:16:04,469 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-36008EEAB698,id=d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f
2019-06-17 12:16:05,523 INFO  impl.FollowerState (FollowerState.java:run(101)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f:group-36008EEAB698 changes to CANDIDATE, lastRpcTime:1059, electionTimeout:1054ms
2019-06-17 12:16:05,523 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f: shutdown FollowerState
2019-06-17 12:16:05,524 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f:group-36008EEAB698 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 12:16:05,524 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f: start LeaderElection
2019-06-17 12:16:05,527 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f:group-36008EEAB698:LeaderElection2: begin an election at term 1 for -1: [d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f:127.0.0.1:39981], old=null
2019-06-17 12:16:05,527 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f: shutdown LeaderElection
2019-06-17 12:16:05,528 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f:group-36008EEAB698 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 12:16:05,528 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f:group-36008EEAB698 change Leader from null to d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f at term 1 for becomeLeader, leader elected after 1068ms
2019-06-17 12:16:05,528 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 12:16:05,528 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 12:16:05,528 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 12:16:05,528 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 12:16:05,529 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f: start LeaderState
2019-06-17 12:16:05,529 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f-RaftLogWorker: Starting segment from index:0
2019-06-17 12:16:05,529 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f:group-36008EEAB698 set configuration 0: [d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f:127.0.0.1:39981], old=null at 0
2019-06-17 12:16:05,570 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6749ee43-9c73-4238-9991-1bb2b997602f/ratis/cf55cc8d-f199-4406-b8ca-36008eeab698/current/log_inprogress_0
2019-06-17 12:16:06,506 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 12:16:06,507 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f: close
2019-06-17 12:16:06,507 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f: shutdown group-36008EEAB698
2019-06-17 12:16:06,507 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-36008EEAB698,id=d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f
2019-06-17 12:16:06,508 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f: shutdown LeaderState
2019-06-17 12:16:06,508 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f-PendingRequests: sendNotLeaderResponses
2019-06-17 12:16:06,509 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f-group-36008EEAB698: set stopIndex = 2
2019-06-17 12:16:06,509 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 12:16:06,510 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler6749ee43-9c73-4238-9991-1bb2b997602f/ratis/cf55cc8d-f199-4406-b8ca-36008eeab698/sm/snapshot.1_2
2019-06-17 12:16:06,510 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f:group-36008EEAB698 closes. The last applied log index is 2
2019-06-17 12:16:06,511 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 12:16:06,511 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f-RaftLogWorker close()
2019-06-17 12:16:06,512 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f: shutdown server with port 39981 now
2019-06-17 12:16:06,514 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - d73e7d1b-ce8f-4d98-b96b-2ce5bddc5d4f: shutdown server with port 39981 successfully
2019-06-17 12:16:06,527 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 12:16:06,559 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6f60a40-5f52-403b-82f6-919fae4359de/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 12:16:06,559 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6f60a40-5f52-403b-82f6-919fae4359de/hdds to VolumeSet
2019-06-17 12:16:06,559 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1bd0b0e5
2019-06-17 12:16:06,560 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1bd0b0e5
2019-06-17 12:16:06,572 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 40301
2019-06-17 12:16:06,573 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 12:16:06,574 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 12:16:06,574 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 40301 (custom)
2019-06-17 12:16:06,574 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 12:16:06,574 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 12:16:06,575 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 12:16:06,575 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 12:16:06,575 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6f60a40-5f52-403b-82f6-919fae4359de/ratis] (custom)
2019-06-17 12:16:06,576 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 46735
2019-06-17 12:16:06,576 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 12:16:06,576 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 12:16:06,577 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c at port 40301
2019-06-17 12:16:06,603 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c: start RPC server
2019-06-17 12:16:06,605 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c: GrpcService started, listening on 0.0.0.0/0.0.0.0:40301
2019-06-17 12:16:06,623 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c: addNew group-58605B05E4B7:[3bd3e8d8-21a4-4de8-9156-0ade5ac8091c:127.0.0.1:40301] returns group-58605B05E4B7:java.util.concurrent.CompletableFuture@13df1ece[Not completed]
2019-06-17 12:16:06,623 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c: new RaftServerImpl for group-58605B05E4B7:[3bd3e8d8-21a4-4de8-9156-0ade5ac8091c:127.0.0.1:40301] with ContainerStateMachine:uninitialized
2019-06-17 12:16:06,624 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 12:16:06,624 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 12:16:06,624 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 12:16:06,624 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 12:16:06,624 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c:group-58605B05E4B7 ConfigurationManager, init=-1: [3bd3e8d8-21a4-4de8-9156-0ade5ac8091c:127.0.0.1:40301], old=null, confs=<EMPTY_MAP>
2019-06-17 12:16:06,624 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6f60a40-5f52-403b-82f6-919fae4359de/ratis] (custom)
2019-06-17 12:16:06,625 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6f60a40-5f52-403b-82f6-919fae4359de/ratis/a56a35a9-6312-49c8-a739-58605b05e4b7 does not exist. Creating ...
2019-06-17 12:16:06,628 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6f60a40-5f52-403b-82f6-919fae4359de/ratis/a56a35a9-6312-49c8-a739-58605b05e4b7/in_use.lock acquired by nodename 4307@ozone-unit-076618677d3ljxwx-2492325314
2019-06-17 12:16:06,630 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6f60a40-5f52-403b-82f6-919fae4359de/ratis/a56a35a9-6312-49c8-a739-58605b05e4b7 has been successfully formatted.
2019-06-17 12:16:06,631 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 12:16:06,631 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 12:16:06,631 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 12:16:06,631 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 12:16:06,631 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 12:16:06,631 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 12:16:06,632 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6f60a40-5f52-403b-82f6-919fae4359de/ratis/a56a35a9-6312-49c8-a739-58605b05e4b7
2019-06-17 12:16:06,632 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 12:16:06,632 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 12:16:06,632 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 12:16:06,632 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 12:16:06,632 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 12:16:06,632 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 12:16:06,632 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 12:16:06,633 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 12:16:06,633 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 12:16:06,633 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 12:16:06,634 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 12:16:06,634 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 12:16:06,634 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 12:16:06,634 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c: start group-58605B05E4B7
2019-06-17 12:16:06,634 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c:group-58605B05E4B7 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 12:16:06,634 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c: start FollowerState
2019-06-17 12:16:06,635 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-58605B05E4B7,id=3bd3e8d8-21a4-4de8-9156-0ade5ac8091c
2019-06-17 12:16:07,688 INFO  impl.FollowerState (FollowerState.java:run(101)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c:group-58605B05E4B7 changes to CANDIDATE, lastRpcTime:1053, electionTimeout:1053ms
2019-06-17 12:16:07,688 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c: shutdown FollowerState
2019-06-17 12:16:07,688 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c:group-58605B05E4B7 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 12:16:07,688 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c: start LeaderElection
2019-06-17 12:16:07,691 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c:group-58605B05E4B7:LeaderElection3: begin an election at term 1 for -1: [3bd3e8d8-21a4-4de8-9156-0ade5ac8091c:127.0.0.1:40301], old=null
2019-06-17 12:16:07,692 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c: shutdown LeaderElection
2019-06-17 12:16:07,692 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c:group-58605B05E4B7 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 12:16:07,692 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c:group-58605B05E4B7 change Leader from null to 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c at term 1 for becomeLeader, leader elected after 1061ms
2019-06-17 12:16:07,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 12:16:07,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 12:16:07,692 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 12:16:07,693 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 12:16:07,693 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c: start LeaderState
2019-06-17 12:16:07,693 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c-RaftLogWorker: Starting segment from index:0
2019-06-17 12:16:07,694 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c:group-58605B05E4B7 set configuration 0: [3bd3e8d8-21a4-4de8-9156-0ade5ac8091c:127.0.0.1:40301], old=null at 0
2019-06-17 12:16:07,733 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6f60a40-5f52-403b-82f6-919fae4359de/ratis/a56a35a9-6312-49c8-a739-58605b05e4b7/current/log_inprogress_0
2019-06-17 12:16:08,681 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 8675761846556581779 is closed with bcsId 0.
2019-06-17 12:16:08,682 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 12:16:08,682 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c: close
2019-06-17 12:16:08,682 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c: shutdown group-58605B05E4B7
2019-06-17 12:16:08,683 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-58605B05E4B7,id=3bd3e8d8-21a4-4de8-9156-0ade5ac8091c
2019-06-17 12:16:08,683 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c: shutdown LeaderState
2019-06-17 12:16:08,683 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c-PendingRequests: sendNotLeaderResponses
2019-06-17 12:16:08,684 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-3bd3e8d8-21a4-4de8-9156-0ade5ac8091c-group-58605B05E4B7: set stopIndex = 2
2019-06-17 12:16:08,684 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 12:16:08,685 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc6f60a40-5f52-403b-82f6-919fae4359de/ratis/a56a35a9-6312-49c8-a739-58605b05e4b7/sm/snapshot.1_2
2019-06-17 12:16:08,685 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c:group-58605B05E4B7 closes. The last applied log index is 2
2019-06-17 12:16:08,686 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 12:16:08,686 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c-RaftLogWorker close()
2019-06-17 12:16:08,687 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c: shutdown server with port 40301 now
2019-06-17 12:16:08,689 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 3bd3e8d8-21a4-4de8-9156-0ade5ac8091c: shutdown server with port 40301 successfully
2019-06-17 12:16:08,699 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 12:16:08,741 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler414d3f3f-ce46-47d3-83be-89d9642df2cc/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 12:16:08,741 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler414d3f3f-ce46-47d3-83be-89d9642df2cc/hdds to VolumeSet
2019-06-17 12:16:08,741 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3971f0fe
2019-06-17 12:16:08,742 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3971f0fe
2019-06-17 12:16:08,755 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 37691
2019-06-17 12:16:08,756 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 12:16:08,757 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 12:16:08,757 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 37691 (custom)
2019-06-17 12:16:08,757 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 12:16:08,758 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 12:16:08,758 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 12:16:08,758 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 12:16:08,758 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler414d3f3f-ce46-47d3-83be-89d9642df2cc/ratis] (custom)
2019-06-17 12:16:08,759 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 39935
2019-06-17 12:16:08,759 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 12:16:08,760 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 12:16:08,760 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 606d43f5-d1f8-472d-95df-29f76a2cf2e6 at port 37691
2019-06-17 12:16:08,767 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6: start RPC server
2019-06-17 12:16:08,769 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6: GrpcService started, listening on 0.0.0.0/0.0.0.0:37691
Jun 17, 2019 12:16:08 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:39981} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 17, 2019 12:16:08 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:40301} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-17 12:16:08,790 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6: addNew group-19444464D46F:[606d43f5-d1f8-472d-95df-29f76a2cf2e6:127.0.0.1:37691] returns group-19444464D46F:java.util.concurrent.CompletableFuture@81d2084[Not completed]
2019-06-17 12:16:08,791 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6: new RaftServerImpl for group-19444464D46F:[606d43f5-d1f8-472d-95df-29f76a2cf2e6:127.0.0.1:37691] with ContainerStateMachine:uninitialized
2019-06-17 12:16:08,791 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 12:16:08,791 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 12:16:08,791 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 12:16:08,791 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 12:16:08,791 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6:group-19444464D46F ConfigurationManager, init=-1: [606d43f5-d1f8-472d-95df-29f76a2cf2e6:127.0.0.1:37691], old=null, confs=<EMPTY_MAP>
2019-06-17 12:16:08,792 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler414d3f3f-ce46-47d3-83be-89d9642df2cc/ratis] (custom)
2019-06-17 12:16:08,792 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler414d3f3f-ce46-47d3-83be-89d9642df2cc/ratis/47a06786-a9c6-4500-a4a6-19444464d46f does not exist. Creating ...
2019-06-17 12:16:08,794 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler414d3f3f-ce46-47d3-83be-89d9642df2cc/ratis/47a06786-a9c6-4500-a4a6-19444464d46f/in_use.lock acquired by nodename 4307@ozone-unit-076618677d3ljxwx-2492325314
2019-06-17 12:16:08,796 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler414d3f3f-ce46-47d3-83be-89d9642df2cc/ratis/47a06786-a9c6-4500-a4a6-19444464d46f has been successfully formatted.
2019-06-17 12:16:08,797 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 12:16:08,797 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 12:16:08,797 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 12:16:08,797 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 12:16:08,797 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 12:16:08,797 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 12:16:08,797 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 606d43f5-d1f8-472d-95df-29f76a2cf2e6-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler414d3f3f-ce46-47d3-83be-89d9642df2cc/ratis/47a06786-a9c6-4500-a4a6-19444464d46f
2019-06-17 12:16:08,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 12:16:08,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 12:16:08,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 12:16:08,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 12:16:08,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 12:16:08,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 12:16:08,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 12:16:08,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 12:16:08,798 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 12:16:08,799 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 12:16:08,799 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 12:16:08,799 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 12:16:08,799 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 12:16:08,799 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6: start group-19444464D46F
2019-06-17 12:16:08,799 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6:group-19444464D46F changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 12:16:08,800 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6: start FollowerState
2019-06-17 12:16:08,800 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-19444464D46F,id=606d43f5-d1f8-472d-95df-29f76a2cf2e6
2019-06-17 12:16:09,915 INFO  impl.FollowerState (FollowerState.java:run(101)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6:group-19444464D46F changes to CANDIDATE, lastRpcTime:1115, electionTimeout:1115ms
2019-06-17 12:16:09,915 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6: shutdown FollowerState
2019-06-17 12:16:09,915 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6:group-19444464D46F changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 12:16:09,915 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6: start LeaderElection
2019-06-17 12:16:09,919 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6:group-19444464D46F:LeaderElection4: begin an election at term 1 for -1: [606d43f5-d1f8-472d-95df-29f76a2cf2e6:127.0.0.1:37691], old=null
2019-06-17 12:16:09,919 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6: shutdown LeaderElection
2019-06-17 12:16:09,919 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6:group-19444464D46F changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 12:16:09,919 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6:group-19444464D46F change Leader from null to 606d43f5-d1f8-472d-95df-29f76a2cf2e6 at term 1 for becomeLeader, leader elected after 1122ms
2019-06-17 12:16:09,919 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 12:16:09,919 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 12:16:09,919 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 12:16:09,919 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 12:16:09,920 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6: start LeaderState
2019-06-17 12:16:09,920 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6-RaftLogWorker: Starting segment from index:0
2019-06-17 12:16:09,927 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6:group-19444464D46F set configuration 0: [606d43f5-d1f8-472d-95df-29f76a2cf2e6:127.0.0.1:37691], old=null at 0
2019-06-17 12:16:09,961 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler414d3f3f-ce46-47d3-83be-89d9642df2cc/ratis/47a06786-a9c6-4500-a4a6-19444464d46f/current/log_inprogress_0
2019-06-17 12:16:10,848 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 8154862026531384509 is closed with bcsId 0.
2019-06-17 12:16:10,848 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 12:16:10,848 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6: close
2019-06-17 12:16:10,849 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6: shutdown group-19444464D46F
2019-06-17 12:16:10,849 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-19444464D46F,id=606d43f5-d1f8-472d-95df-29f76a2cf2e6
2019-06-17 12:16:10,849 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6: shutdown LeaderState
2019-06-17 12:16:10,849 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6-PendingRequests: sendNotLeaderResponses
2019-06-17 12:16:10,850 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-606d43f5-d1f8-472d-95df-29f76a2cf2e6-group-19444464D46F: set stopIndex = 2
2019-06-17 12:16:10,851 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 12:16:10,851 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler414d3f3f-ce46-47d3-83be-89d9642df2cc/ratis/47a06786-a9c6-4500-a4a6-19444464d46f/sm/snapshot.1_2
2019-06-17 12:16:10,851 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6:group-19444464D46F closes. The last applied log index is 2
2019-06-17 12:16:10,852 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 12:16:10,852 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6-RaftLogWorker close()
2019-06-17 12:16:10,853 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6: shutdown server with port 37691 now
2019-06-17 12:16:10,855 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 606d43f5-d1f8-472d-95df-29f76a2cf2e6: shutdown server with port 37691 successfully
2019-06-17 12:16:10,857 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 12:16:10,878 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercad30d01-9354-4de9-bf28-2d1dbaa74377/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 12:16:10,878 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercad30d01-9354-4de9-bf28-2d1dbaa74377/hdds to VolumeSet
2019-06-17 12:16:10,879 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1bf39d06
2019-06-17 12:16:10,879 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1bf39d06
2019-06-17 12:16:10,891 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 39241
2019-06-17 12:16:10,891 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 12:16:10,892 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 12:16:10,892 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 39241 (custom)
2019-06-17 12:16:10,893 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 12:16:10,893 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 12:16:10,893 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 12:16:10,893 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 12:16:10,894 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercad30d01-9354-4de9-bf28-2d1dbaa74377/ratis] (custom)
2019-06-17 12:16:10,894 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 33025
2019-06-17 12:16:10,894 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 12:16:10,895 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 12:16:10,895 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis d4c77503-cbb2-49f3-b472-5ead97c1a3f9 at port 39241
2019-06-17 12:16:10,911 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9: start RPC server
2019-06-17 12:16:10,912 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9: GrpcService started, listening on 0.0.0.0/0.0.0.0:39241
2019-06-17 12:16:10,920 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9: addNew group-E67C5326BAD1:[d4c77503-cbb2-49f3-b472-5ead97c1a3f9:127.0.0.1:39241] returns group-E67C5326BAD1:java.util.concurrent.CompletableFuture@30430918[Not completed]
2019-06-17 12:16:10,920 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9: new RaftServerImpl for group-E67C5326BAD1:[d4c77503-cbb2-49f3-b472-5ead97c1a3f9:127.0.0.1:39241] with ContainerStateMachine:uninitialized
2019-06-17 12:16:10,921 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 12:16:10,921 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 12:16:10,921 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 12:16:10,921 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 12:16:10,921 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9:group-E67C5326BAD1 ConfigurationManager, init=-1: [d4c77503-cbb2-49f3-b472-5ead97c1a3f9:127.0.0.1:39241], old=null, confs=<EMPTY_MAP>
2019-06-17 12:16:10,921 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercad30d01-9354-4de9-bf28-2d1dbaa74377/ratis] (custom)
2019-06-17 12:16:10,922 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercad30d01-9354-4de9-bf28-2d1dbaa74377/ratis/a17a23b1-ff12-49d2-952a-e67c5326bad1 does not exist. Creating ...
2019-06-17 12:16:10,924 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercad30d01-9354-4de9-bf28-2d1dbaa74377/ratis/a17a23b1-ff12-49d2-952a-e67c5326bad1/in_use.lock acquired by nodename 4307@ozone-unit-076618677d3ljxwx-2492325314
2019-06-17 12:16:10,926 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercad30d01-9354-4de9-bf28-2d1dbaa74377/ratis/a17a23b1-ff12-49d2-952a-e67c5326bad1 has been successfully formatted.
2019-06-17 12:16:10,926 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 12:16:10,926 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 12:16:10,926 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 12:16:10,926 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 12:16:10,927 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 12:16:10,927 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 12:16:10,927 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new d4c77503-cbb2-49f3-b472-5ead97c1a3f9-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercad30d01-9354-4de9-bf28-2d1dbaa74377/ratis/a17a23b1-ff12-49d2-952a-e67c5326bad1
2019-06-17 12:16:10,927 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 12:16:10,927 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 12:16:10,927 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 12:16:10,927 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 12:16:10,927 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 12:16:10,927 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 12:16:10,928 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 12:16:10,928 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 12:16:10,928 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 12:16:10,928 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 12:16:10,928 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 12:16:10,928 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 12:16:10,929 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 12:16:10,929 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9: start group-E67C5326BAD1
2019-06-17 12:16:10,929 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9:group-E67C5326BAD1 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 12:16:10,929 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9: start FollowerState
2019-06-17 12:16:10,930 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-E67C5326BAD1,id=d4c77503-cbb2-49f3-b472-5ead97c1a3f9
2019-06-17 12:16:12,124 INFO  impl.FollowerState (FollowerState.java:run(101)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9:group-E67C5326BAD1 changes to CANDIDATE, lastRpcTime:1194, electionTimeout:1194ms
2019-06-17 12:16:12,124 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9: shutdown FollowerState
2019-06-17 12:16:12,124 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9:group-E67C5326BAD1 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 12:16:12,124 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9: start LeaderElection
2019-06-17 12:16:12,129 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9:group-E67C5326BAD1:LeaderElection5: begin an election at term 1 for -1: [d4c77503-cbb2-49f3-b472-5ead97c1a3f9:127.0.0.1:39241], old=null
2019-06-17 12:16:12,129 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9: shutdown LeaderElection
2019-06-17 12:16:12,129 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9:group-E67C5326BAD1 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 12:16:12,129 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9:group-E67C5326BAD1 change Leader from null to d4c77503-cbb2-49f3-b472-5ead97c1a3f9 at term 1 for becomeLeader, leader elected after 1203ms
2019-06-17 12:16:12,129 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 12:16:12,130 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 12:16:12,130 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 12:16:12,130 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 12:16:12,130 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9: start LeaderState
2019-06-17 12:16:12,130 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9-RaftLogWorker: Starting segment from index:0
2019-06-17 12:16:12,131 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9:group-E67C5326BAD1 set configuration 0: [d4c77503-cbb2-49f3-b472-5ead97c1a3f9:127.0.0.1:39241], old=null at 0
2019-06-17 12:16:12,171 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercad30d01-9354-4de9-bf28-2d1dbaa74377/ratis/a17a23b1-ff12-49d2-952a-e67c5326bad1/current/log_inprogress_0
2019-06-17 12:16:12,974 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 2044266999026386898 is closed with bcsId 0.
2019-06-17 12:16:12,974 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 12:16:12,975 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9: close
2019-06-17 12:16:12,975 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9: shutdown group-E67C5326BAD1
2019-06-17 12:16:12,975 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-E67C5326BAD1,id=d4c77503-cbb2-49f3-b472-5ead97c1a3f9
2019-06-17 12:16:12,976 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9: shutdown LeaderState
2019-06-17 12:16:12,976 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9-PendingRequests: sendNotLeaderResponses
2019-06-17 12:16:12,977 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-d4c77503-cbb2-49f3-b472-5ead97c1a3f9-group-E67C5326BAD1: set stopIndex = 4
2019-06-17 12:16:12,977 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 12:16:12,978 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercad30d01-9354-4de9-bf28-2d1dbaa74377/ratis/a17a23b1-ff12-49d2-952a-e67c5326bad1/sm/snapshot.1_4
2019-06-17 12:16:12,978 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9:group-E67C5326BAD1 closes. The last applied log index is 4
2019-06-17 12:16:12,978 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 12:16:12,979 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9-RaftLogWorker close()
2019-06-17 12:16:12,980 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9: shutdown server with port 39241 now
2019-06-17 12:16:12,982 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - d4c77503-cbb2-49f3-b472-5ead97c1a3f9: shutdown server with port 39241 successfully
2019-06-17 12:16:12,987 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
