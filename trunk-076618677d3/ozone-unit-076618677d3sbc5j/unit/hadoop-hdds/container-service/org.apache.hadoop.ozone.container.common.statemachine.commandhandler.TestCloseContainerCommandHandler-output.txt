2019-06-17 13:35:47,951 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleraf91cc80-67ec-4e4c-a819-3f52c8762be4/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 13:35:47,957 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleraf91cc80-67ec-4e4c-a819-3f52c8762be4/hdds to VolumeSet
2019-06-17 13:35:47,970 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-17 13:35:48,024 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-17 13:35:48,445 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 37821
2019-06-17 13:35:48,987 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 13:35:49,012 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 13:35:49,022 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 37821 (custom)
2019-06-17 13:35:49,023 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 13:35:49,025 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 13:35:49,026 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 13:35:49,027 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 13:35:49,184 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleraf91cc80-67ec-4e4c-a819-3f52c8762be4/ratis] (custom)
2019-06-17 13:35:49,196 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 36539
2019-06-17 13:35:49,216 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 13:35:49,216 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 13:35:49,217 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 6655ab31-3e15-4c85-912b-ecfcc2d96b43 at port 37821
2019-06-17 13:35:49,229 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43: start RPC server
2019-06-17 13:35:49,363 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43: GrpcService started, listening on 0.0.0.0/0.0.0.0:37821
2019-06-17 13:35:49,690 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43: addNew group-FBBC0ADD7CC0:[6655ab31-3e15-4c85-912b-ecfcc2d96b43:127.0.0.1:37821] returns group-FBBC0ADD7CC0:java.util.concurrent.CompletableFuture@2ec0ce8e[Not completed]
2019-06-17 13:35:49,724 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43: new RaftServerImpl for group-FBBC0ADD7CC0:[6655ab31-3e15-4c85-912b-ecfcc2d96b43:127.0.0.1:37821] with ContainerStateMachine:uninitialized
2019-06-17 13:35:49,725 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 13:35:49,725 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 13:35:49,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 13:35:49,727 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 13:35:49,732 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43:group-FBBC0ADD7CC0 ConfigurationManager, init=-1: [6655ab31-3e15-4c85-912b-ecfcc2d96b43:127.0.0.1:37821], old=null, confs=<EMPTY_MAP>
2019-06-17 13:35:49,733 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleraf91cc80-67ec-4e4c-a819-3f52c8762be4/ratis] (custom)
2019-06-17 13:35:49,738 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleraf91cc80-67ec-4e4c-a819-3f52c8762be4/ratis/d3de667d-12df-4a60-9f71-fbbc0add7cc0 does not exist. Creating ...
2019-06-17 13:35:49,747 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleraf91cc80-67ec-4e4c-a819-3f52c8762be4/ratis/d3de667d-12df-4a60-9f71-fbbc0add7cc0/in_use.lock acquired by nodename 4312@ozone-unit-076618677d3sbc5j-4242397806
2019-06-17 13:35:49,755 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleraf91cc80-67ec-4e4c-a819-3f52c8762be4/ratis/d3de667d-12df-4a60-9f71-fbbc0add7cc0 has been successfully formatted.
2019-06-17 13:35:49,757 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 13:35:49,757 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 13:35:49,759 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 13:35:49,761 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 13:35:49,765 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 13:35:49,769 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 13:35:49,772 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 6655ab31-3e15-4c85-912b-ecfcc2d96b43-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleraf91cc80-67ec-4e4c-a819-3f52c8762be4/ratis/d3de667d-12df-4a60-9f71-fbbc0add7cc0
2019-06-17 13:35:49,772 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 13:35:49,773 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 13:35:49,774 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 13:35:49,775 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 13:35:49,775 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 13:35:49,776 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 13:35:49,777 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 13:35:49,777 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 13:35:49,777 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 13:35:49,780 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 13:35:49,785 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 13:35:49,786 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 13:35:49,786 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 13:35:49,901 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43: start group-FBBC0ADD7CC0
2019-06-17 13:35:49,902 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43:group-FBBC0ADD7CC0 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 13:35:49,903 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43: start FollowerState
2019-06-17 13:35:49,905 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-FBBC0ADD7CC0,id=6655ab31-3e15-4c85-912b-ecfcc2d96b43
2019-06-17 13:35:51,064 INFO  impl.FollowerState (FollowerState.java:run(101)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43:group-FBBC0ADD7CC0 changes to CANDIDATE, lastRpcTime:1161, electionTimeout:1160ms
2019-06-17 13:35:51,064 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43: shutdown FollowerState
2019-06-17 13:35:51,064 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43:group-FBBC0ADD7CC0 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 13:35:51,066 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43: start LeaderElection
2019-06-17 13:35:51,069 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43:group-FBBC0ADD7CC0:LeaderElection1: begin an election at term 1 for -1: [6655ab31-3e15-4c85-912b-ecfcc2d96b43:127.0.0.1:37821], old=null
2019-06-17 13:35:51,070 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43: shutdown LeaderElection
2019-06-17 13:35:51,071 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43:group-FBBC0ADD7CC0 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 13:35:51,071 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43:group-FBBC0ADD7CC0 change Leader from null to 6655ab31-3e15-4c85-912b-ecfcc2d96b43 at term 1 for becomeLeader, leader elected after 1313ms
2019-06-17 13:35:51,076 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 13:35:51,076 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 13:35:51,078 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 13:35:51,079 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 13:35:51,087 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43: start LeaderState
2019-06-17 13:35:51,104 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43-RaftLogWorker: Starting segment from index:0
2019-06-17 13:35:51,112 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43:group-FBBC0ADD7CC0 set configuration 0: [6655ab31-3e15-4c85-912b-ecfcc2d96b43:127.0.0.1:37821], old=null at 0
2019-06-17 13:35:51,283 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleraf91cc80-67ec-4e4c-a819-3f52c8762be4/ratis/d3de667d-12df-4a60-9f71-fbbc0add7cc0/current/log_inprogress_0
2019-06-17 13:35:52,145 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-17 13:35:52,202 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 557997300261700642 is closed with bcsId 0.
2019-06-17 13:35:52,203 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 13:35:52,204 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43: close
2019-06-17 13:35:52,205 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43: shutdown group-FBBC0ADD7CC0
2019-06-17 13:35:52,206 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-FBBC0ADD7CC0,id=6655ab31-3e15-4c85-912b-ecfcc2d96b43
2019-06-17 13:35:52,206 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43: shutdown LeaderState
2019-06-17 13:35:52,207 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43-PendingRequests: sendNotLeaderResponses
2019-06-17 13:35:52,209 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-6655ab31-3e15-4c85-912b-ecfcc2d96b43-group-FBBC0ADD7CC0: set stopIndex = 4
2019-06-17 13:35:52,209 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 13:35:52,210 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleraf91cc80-67ec-4e4c-a819-3f52c8762be4/ratis/d3de667d-12df-4a60-9f71-fbbc0add7cc0/sm/snapshot.1_4
2019-06-17 13:35:52,216 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43:group-FBBC0ADD7CC0 closes. The last applied log index is 4
2019-06-17 13:35:52,217 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 13:35:52,218 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43-RaftLogWorker close()
2019-06-17 13:35:52,219 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43: shutdown server with port 37821 now
2019-06-17 13:35:52,223 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 6655ab31-3e15-4c85-912b-ecfcc2d96b43: shutdown server with port 37821 successfully
2019-06-17 13:35:52,233 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 13:35:52,264 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerae4814ed-2bc4-4441-abfe-ed0b802519b1/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 13:35:52,264 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerae4814ed-2bc4-4441-abfe-ed0b802519b1/hdds to VolumeSet
2019-06-17 13:35:52,265 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1f966492
2019-06-17 13:35:52,266 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1f966492
2019-06-17 13:35:52,279 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 42257
2019-06-17 13:35:52,280 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 13:35:52,281 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 13:35:52,282 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42257 (custom)
2019-06-17 13:35:52,282 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 13:35:52,282 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 13:35:52,282 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 13:35:52,283 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 13:35:52,283 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerae4814ed-2bc4-4441-abfe-ed0b802519b1/ratis] (custom)
2019-06-17 13:35:52,284 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 44049
2019-06-17 13:35:52,284 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 13:35:52,284 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 13:35:52,285 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 0ff5d86a-dab2-4e82-8c07-42dc15161161 at port 42257
2019-06-17 13:35:52,310 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161: start RPC server
2019-06-17 13:35:52,311 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161: GrpcService started, listening on 0.0.0.0/0.0.0.0:42257
2019-06-17 13:35:52,326 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161: addNew group-FF5E9CFCC1A7:[0ff5d86a-dab2-4e82-8c07-42dc15161161:127.0.0.1:42257] returns group-FF5E9CFCC1A7:java.util.concurrent.CompletableFuture@2a1cdfc3[Not completed]
2019-06-17 13:35:52,332 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161: new RaftServerImpl for group-FF5E9CFCC1A7:[0ff5d86a-dab2-4e82-8c07-42dc15161161:127.0.0.1:42257] with ContainerStateMachine:uninitialized
2019-06-17 13:35:52,333 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 13:35:52,333 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 13:35:52,333 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 13:35:52,333 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 13:35:52,333 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161:group-FF5E9CFCC1A7 ConfigurationManager, init=-1: [0ff5d86a-dab2-4e82-8c07-42dc15161161:127.0.0.1:42257], old=null, confs=<EMPTY_MAP>
2019-06-17 13:35:52,333 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerae4814ed-2bc4-4441-abfe-ed0b802519b1/ratis] (custom)
2019-06-17 13:35:52,334 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerae4814ed-2bc4-4441-abfe-ed0b802519b1/ratis/d5528f8b-2c01-427e-8189-ff5e9cfcc1a7 does not exist. Creating ...
2019-06-17 13:35:52,337 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerae4814ed-2bc4-4441-abfe-ed0b802519b1/ratis/d5528f8b-2c01-427e-8189-ff5e9cfcc1a7/in_use.lock acquired by nodename 4312@ozone-unit-076618677d3sbc5j-4242397806
2019-06-17 13:35:52,340 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerae4814ed-2bc4-4441-abfe-ed0b802519b1/ratis/d5528f8b-2c01-427e-8189-ff5e9cfcc1a7 has been successfully formatted.
2019-06-17 13:35:52,340 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 13:35:52,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 13:35:52,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 13:35:52,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 13:35:52,340 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 13:35:52,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 13:35:52,341 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 0ff5d86a-dab2-4e82-8c07-42dc15161161-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerae4814ed-2bc4-4441-abfe-ed0b802519b1/ratis/d5528f8b-2c01-427e-8189-ff5e9cfcc1a7
2019-06-17 13:35:52,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 13:35:52,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 13:35:52,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 13:35:52,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 13:35:52,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 13:35:52,341 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 13:35:52,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 13:35:52,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 13:35:52,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 13:35:52,342 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 13:35:52,345 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 13:35:52,346 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 13:35:52,346 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 13:35:52,346 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161: start group-FF5E9CFCC1A7
2019-06-17 13:35:52,346 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161:group-FF5E9CFCC1A7 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 13:35:52,346 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161: start FollowerState
2019-06-17 13:35:52,347 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-FF5E9CFCC1A7,id=0ff5d86a-dab2-4e82-8c07-42dc15161161
2019-06-17 13:35:53,459 INFO  impl.FollowerState (FollowerState.java:run(101)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161:group-FF5E9CFCC1A7 changes to CANDIDATE, lastRpcTime:1112, electionTimeout:1112ms
2019-06-17 13:35:53,459 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161: shutdown FollowerState
2019-06-17 13:35:53,459 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161:group-FF5E9CFCC1A7 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 13:35:53,459 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161: start LeaderElection
2019-06-17 13:35:53,463 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161:group-FF5E9CFCC1A7:LeaderElection2: begin an election at term 1 for -1: [0ff5d86a-dab2-4e82-8c07-42dc15161161:127.0.0.1:42257], old=null
2019-06-17 13:35:53,463 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161: shutdown LeaderElection
2019-06-17 13:35:53,463 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161:group-FF5E9CFCC1A7 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 13:35:53,463 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161:group-FF5E9CFCC1A7 change Leader from null to 0ff5d86a-dab2-4e82-8c07-42dc15161161 at term 1 for becomeLeader, leader elected after 1123ms
2019-06-17 13:35:53,463 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 13:35:53,464 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 13:35:53,464 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 13:35:53,464 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 13:35:53,464 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161: start LeaderState
2019-06-17 13:35:53,464 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161-RaftLogWorker: Starting segment from index:0
2019-06-17 13:35:53,465 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161:group-FF5E9CFCC1A7 set configuration 0: [0ff5d86a-dab2-4e82-8c07-42dc15161161:127.0.0.1:42257], old=null at 0
2019-06-17 13:35:53,504 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerae4814ed-2bc4-4441-abfe-ed0b802519b1/ratis/d5528f8b-2c01-427e-8189-ff5e9cfcc1a7/current/log_inprogress_0
2019-06-17 13:35:54,389 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 13:35:54,390 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161: close
2019-06-17 13:35:54,390 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161: shutdown group-FF5E9CFCC1A7
2019-06-17 13:35:54,391 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-FF5E9CFCC1A7,id=0ff5d86a-dab2-4e82-8c07-42dc15161161
2019-06-17 13:35:54,391 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161: shutdown LeaderState
2019-06-17 13:35:54,392 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161-PendingRequests: sendNotLeaderResponses
2019-06-17 13:35:54,393 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-0ff5d86a-dab2-4e82-8c07-42dc15161161-group-FF5E9CFCC1A7: set stopIndex = 2
2019-06-17 13:35:54,393 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 13:35:54,393 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerae4814ed-2bc4-4441-abfe-ed0b802519b1/ratis/d5528f8b-2c01-427e-8189-ff5e9cfcc1a7/sm/snapshot.1_2
2019-06-17 13:35:54,393 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161:group-FF5E9CFCC1A7 closes. The last applied log index is 2
2019-06-17 13:35:54,394 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 13:35:54,395 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161-RaftLogWorker close()
2019-06-17 13:35:54,396 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161: shutdown server with port 42257 now
2019-06-17 13:35:54,397 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 0ff5d86a-dab2-4e82-8c07-42dc15161161: shutdown server with port 42257 successfully
2019-06-17 13:35:54,404 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 13:35:54,435 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler71fbbfd7-a39d-4a32-92ce-5fcb6100c456/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 13:35:54,435 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler71fbbfd7-a39d-4a32-92ce-5fcb6100c456/hdds to VolumeSet
2019-06-17 13:35:54,435 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@692fd26
2019-06-17 13:35:54,436 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@692fd26
2019-06-17 13:35:54,450 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 32921
2019-06-17 13:35:54,456 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 13:35:54,457 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 13:35:54,457 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 32921 (custom)
2019-06-17 13:35:54,457 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 13:35:54,457 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 13:35:54,458 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 13:35:54,458 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 13:35:54,458 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler71fbbfd7-a39d-4a32-92ce-5fcb6100c456/ratis] (custom)
2019-06-17 13:35:54,463 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 37465
2019-06-17 13:35:54,463 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 13:35:54,464 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 13:35:54,464 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a at port 32921
2019-06-17 13:35:54,474 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a: start RPC server
2019-06-17 13:35:54,475 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a: GrpcService started, listening on 0.0.0.0/0.0.0.0:32921
2019-06-17 13:35:54,486 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a: addNew group-9271ECA1D3AC:[ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a:127.0.0.1:32921] returns group-9271ECA1D3AC:java.util.concurrent.CompletableFuture@469bf606[Not completed]
2019-06-17 13:35:54,487 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a: new RaftServerImpl for group-9271ECA1D3AC:[ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a:127.0.0.1:32921] with ContainerStateMachine:uninitialized
2019-06-17 13:35:54,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 13:35:54,488 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 13:35:54,488 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 13:35:54,488 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 13:35:54,488 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a:group-9271ECA1D3AC ConfigurationManager, init=-1: [ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a:127.0.0.1:32921], old=null, confs=<EMPTY_MAP>
2019-06-17 13:35:54,488 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler71fbbfd7-a39d-4a32-92ce-5fcb6100c456/ratis] (custom)
2019-06-17 13:35:54,489 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler71fbbfd7-a39d-4a32-92ce-5fcb6100c456/ratis/340b6172-4cba-4644-838a-9271eca1d3ac does not exist. Creating ...
2019-06-17 13:35:54,496 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler71fbbfd7-a39d-4a32-92ce-5fcb6100c456/ratis/340b6172-4cba-4644-838a-9271eca1d3ac/in_use.lock acquired by nodename 4312@ozone-unit-076618677d3sbc5j-4242397806
2019-06-17 13:35:54,498 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler71fbbfd7-a39d-4a32-92ce-5fcb6100c456/ratis/340b6172-4cba-4644-838a-9271eca1d3ac has been successfully formatted.
2019-06-17 13:35:54,498 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 13:35:54,498 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 13:35:54,498 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 13:35:54,498 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 13:35:54,499 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 13:35:54,499 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 13:35:54,499 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler71fbbfd7-a39d-4a32-92ce-5fcb6100c456/ratis/340b6172-4cba-4644-838a-9271eca1d3ac
2019-06-17 13:35:54,499 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 13:35:54,499 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 13:35:54,499 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 13:35:54,499 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 13:35:54,499 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 13:35:54,500 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 13:35:54,500 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 13:35:54,500 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 13:35:54,500 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 13:35:54,500 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 13:35:54,500 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 13:35:54,501 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 13:35:54,501 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 13:35:54,501 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a: start group-9271ECA1D3AC
2019-06-17 13:35:54,501 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a:group-9271ECA1D3AC changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 13:35:54,501 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a: start FollowerState
2019-06-17 13:35:54,502 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-9271ECA1D3AC,id=ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a
2019-06-17 13:35:55,620 INFO  impl.FollowerState (FollowerState.java:run(101)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a:group-9271ECA1D3AC changes to CANDIDATE, lastRpcTime:1118, electionTimeout:1118ms
2019-06-17 13:35:55,620 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a: shutdown FollowerState
2019-06-17 13:35:55,620 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a:group-9271ECA1D3AC changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 13:35:55,620 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a: start LeaderElection
2019-06-17 13:35:55,623 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a:group-9271ECA1D3AC:LeaderElection3: begin an election at term 1 for -1: [ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a:127.0.0.1:32921], old=null
2019-06-17 13:35:55,624 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a: shutdown LeaderElection
2019-06-17 13:35:55,624 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a:group-9271ECA1D3AC changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 13:35:55,624 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a:group-9271ECA1D3AC change Leader from null to ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a at term 1 for becomeLeader, leader elected after 1125ms
2019-06-17 13:35:55,624 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 13:35:55,624 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 13:35:55,624 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 13:35:55,625 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 13:35:55,625 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a: start LeaderState
2019-06-17 13:35:55,625 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a-RaftLogWorker: Starting segment from index:0
2019-06-17 13:35:55,630 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a:group-9271ECA1D3AC set configuration 0: [ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a:127.0.0.1:32921], old=null at 0
2019-06-17 13:35:55,666 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler71fbbfd7-a39d-4a32-92ce-5fcb6100c456/ratis/340b6172-4cba-4644-838a-9271eca1d3ac/current/log_inprogress_0
2019-06-17 13:35:56,553 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 8567524406782160965 is closed with bcsId 0.
2019-06-17 13:35:56,554 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 13:35:56,554 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a: close
2019-06-17 13:35:56,554 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a: shutdown group-9271ECA1D3AC
2019-06-17 13:35:56,555 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-9271ECA1D3AC,id=ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a
2019-06-17 13:35:56,555 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a: shutdown LeaderState
2019-06-17 13:35:56,555 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a-PendingRequests: sendNotLeaderResponses
2019-06-17 13:35:56,556 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a-group-9271ECA1D3AC: set stopIndex = 2
2019-06-17 13:35:56,556 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 13:35:56,557 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler71fbbfd7-a39d-4a32-92ce-5fcb6100c456/ratis/340b6172-4cba-4644-838a-9271eca1d3ac/sm/snapshot.1_2
2019-06-17 13:35:56,557 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a:group-9271ECA1D3AC closes. The last applied log index is 2
2019-06-17 13:35:56,557 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 13:35:56,562 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a-RaftLogWorker close()
2019-06-17 13:35:56,563 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a: shutdown server with port 32921 now
2019-06-17 13:35:56,567 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - ed98132c-4a1a-4ea7-b44b-0dbeabc9f35a: shutdown server with port 32921 successfully
2019-06-17 13:35:56,570 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 13:35:56,613 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc26da050-9ca2-4d2a-ada0-c5770aeaef8a/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 13:35:56,613 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc26da050-9ca2-4d2a-ada0-c5770aeaef8a/hdds to VolumeSet
2019-06-17 13:35:56,613 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@e1e2e5e
2019-06-17 13:35:56,617 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@e1e2e5e
2019-06-17 13:35:56,628 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 34445
2019-06-17 13:35:56,628 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 13:35:56,629 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 13:35:56,629 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 34445 (custom)
2019-06-17 13:35:56,630 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 13:35:56,630 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 13:35:56,630 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 13:35:56,630 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 13:35:56,631 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc26da050-9ca2-4d2a-ada0-c5770aeaef8a/ratis] (custom)
2019-06-17 13:35:56,631 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 33015
2019-06-17 13:35:56,632 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 13:35:56,632 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 13:35:56,632 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis f890be33-a5ba-49bc-ad5f-12f2f5f342d0 at port 34445
2019-06-17 13:35:56,643 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0: start RPC server
2019-06-17 13:35:56,644 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0: GrpcService started, listening on 0.0.0.0/0.0.0.0:34445
Jun 17, 2019 1:35:56 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:42257} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 17, 2019 1:35:56 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:32921} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-17 13:35:56,661 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0: addNew group-B05FA0788ACD:[f890be33-a5ba-49bc-ad5f-12f2f5f342d0:127.0.0.1:34445] returns group-B05FA0788ACD:java.util.concurrent.CompletableFuture@732a8f79[Not completed]
2019-06-17 13:35:56,662 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0: new RaftServerImpl for group-B05FA0788ACD:[f890be33-a5ba-49bc-ad5f-12f2f5f342d0:127.0.0.1:34445] with ContainerStateMachine:uninitialized
2019-06-17 13:35:56,662 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 13:35:56,662 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 13:35:56,662 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 13:35:56,662 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 13:35:56,663 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0:group-B05FA0788ACD ConfigurationManager, init=-1: [f890be33-a5ba-49bc-ad5f-12f2f5f342d0:127.0.0.1:34445], old=null, confs=<EMPTY_MAP>
2019-06-17 13:35:56,663 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc26da050-9ca2-4d2a-ada0-c5770aeaef8a/ratis] (custom)
2019-06-17 13:35:56,663 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc26da050-9ca2-4d2a-ada0-c5770aeaef8a/ratis/e6a26feb-d61e-4d0e-a448-b05fa0788acd does not exist. Creating ...
2019-06-17 13:35:56,667 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc26da050-9ca2-4d2a-ada0-c5770aeaef8a/ratis/e6a26feb-d61e-4d0e-a448-b05fa0788acd/in_use.lock acquired by nodename 4312@ozone-unit-076618677d3sbc5j-4242397806
2019-06-17 13:35:56,670 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc26da050-9ca2-4d2a-ada0-c5770aeaef8a/ratis/e6a26feb-d61e-4d0e-a448-b05fa0788acd has been successfully formatted.
2019-06-17 13:35:56,670 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 13:35:56,670 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 13:35:56,670 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 13:35:56,670 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 13:35:56,670 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 13:35:56,671 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 13:35:56,671 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new f890be33-a5ba-49bc-ad5f-12f2f5f342d0-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc26da050-9ca2-4d2a-ada0-c5770aeaef8a/ratis/e6a26feb-d61e-4d0e-a448-b05fa0788acd
2019-06-17 13:35:56,671 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 13:35:56,671 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 13:35:56,671 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 13:35:56,671 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 13:35:56,671 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 13:35:56,671 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 13:35:56,672 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 13:35:56,672 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 13:35:56,672 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 13:35:56,672 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 13:35:56,674 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 13:35:56,674 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 13:35:56,674 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 13:35:56,674 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0: start group-B05FA0788ACD
2019-06-17 13:35:56,674 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0:group-B05FA0788ACD changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 13:35:56,674 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0: start FollowerState
2019-06-17 13:35:56,675 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-B05FA0788ACD,id=f890be33-a5ba-49bc-ad5f-12f2f5f342d0
2019-06-17 13:35:57,778 INFO  impl.FollowerState (FollowerState.java:run(101)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0:group-B05FA0788ACD changes to CANDIDATE, lastRpcTime:1103, electionTimeout:1103ms
2019-06-17 13:35:57,778 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0: shutdown FollowerState
2019-06-17 13:35:57,778 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0:group-B05FA0788ACD changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 13:35:57,778 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0: start LeaderElection
2019-06-17 13:35:57,782 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0:group-B05FA0788ACD:LeaderElection4: begin an election at term 1 for -1: [f890be33-a5ba-49bc-ad5f-12f2f5f342d0:127.0.0.1:34445], old=null
2019-06-17 13:35:57,782 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0: shutdown LeaderElection
2019-06-17 13:35:57,782 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0:group-B05FA0788ACD changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 13:35:57,782 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0:group-B05FA0788ACD change Leader from null to f890be33-a5ba-49bc-ad5f-12f2f5f342d0 at term 1 for becomeLeader, leader elected after 1111ms
2019-06-17 13:35:57,782 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 13:35:57,782 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 13:35:57,783 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 13:35:57,783 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 13:35:57,783 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0: start LeaderState
2019-06-17 13:35:57,783 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0-RaftLogWorker: Starting segment from index:0
2019-06-17 13:35:57,791 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0:group-B05FA0788ACD set configuration 0: [f890be33-a5ba-49bc-ad5f-12f2f5f342d0:127.0.0.1:34445], old=null at 0
2019-06-17 13:35:57,823 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc26da050-9ca2-4d2a-ada0-c5770aeaef8a/ratis/e6a26feb-d61e-4d0e-a448-b05fa0788acd/current/log_inprogress_0
2019-06-17 13:35:58,714 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 6540159139436945463 is closed with bcsId 0.
2019-06-17 13:35:58,715 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 13:35:58,715 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0: close
2019-06-17 13:35:58,715 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0: shutdown group-B05FA0788ACD
2019-06-17 13:35:58,716 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-B05FA0788ACD,id=f890be33-a5ba-49bc-ad5f-12f2f5f342d0
2019-06-17 13:35:58,716 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0: shutdown LeaderState
2019-06-17 13:35:58,716 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0-PendingRequests: sendNotLeaderResponses
2019-06-17 13:35:58,717 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-f890be33-a5ba-49bc-ad5f-12f2f5f342d0-group-B05FA0788ACD: set stopIndex = 2
2019-06-17 13:35:58,717 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 13:35:58,718 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerc26da050-9ca2-4d2a-ada0-c5770aeaef8a/ratis/e6a26feb-d61e-4d0e-a448-b05fa0788acd/sm/snapshot.1_2
2019-06-17 13:35:58,718 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0:group-B05FA0788ACD closes. The last applied log index is 2
2019-06-17 13:35:58,718 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 13:35:58,719 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0-RaftLogWorker close()
2019-06-17 13:35:58,720 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0: shutdown server with port 34445 now
2019-06-17 13:35:58,721 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - f890be33-a5ba-49bc-ad5f-12f2f5f342d0: shutdown server with port 34445 successfully
2019-06-17 13:35:58,726 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 13:35:58,754 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler83e73434-6902-467d-8a56-ae50ae634b6c/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 13:35:58,754 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler83e73434-6902-467d-8a56-ae50ae634b6c/hdds to VolumeSet
2019-06-17 13:35:58,754 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@367b22e5
2019-06-17 13:35:58,754 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@367b22e5
2019-06-17 13:35:58,767 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 42211
2019-06-17 13:35:58,768 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 13:35:58,768 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 13:35:58,769 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42211 (custom)
2019-06-17 13:35:58,769 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 13:35:58,769 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 13:35:58,769 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 13:35:58,769 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 13:35:58,770 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler83e73434-6902-467d-8a56-ae50ae634b6c/ratis] (custom)
2019-06-17 13:35:58,770 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 34157
2019-06-17 13:35:58,771 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 13:35:58,771 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 13:35:58,771 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis ec6b8704-b803-437d-8bc5-ec134a56cfe8 at port 42211
2019-06-17 13:35:58,781 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8: start RPC server
2019-06-17 13:35:58,782 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8: GrpcService started, listening on 0.0.0.0/0.0.0.0:42211
2019-06-17 13:35:58,792 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8: addNew group-4A4205E6E82C:[ec6b8704-b803-437d-8bc5-ec134a56cfe8:127.0.0.1:42211] returns group-4A4205E6E82C:java.util.concurrent.CompletableFuture@1dad7b0d[Not completed]
2019-06-17 13:35:58,793 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8: new RaftServerImpl for group-4A4205E6E82C:[ec6b8704-b803-437d-8bc5-ec134a56cfe8:127.0.0.1:42211] with ContainerStateMachine:uninitialized
2019-06-17 13:35:58,793 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 13:35:58,793 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 13:35:58,793 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 13:35:58,793 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 13:35:58,793 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8:group-4A4205E6E82C ConfigurationManager, init=-1: [ec6b8704-b803-437d-8bc5-ec134a56cfe8:127.0.0.1:42211], old=null, confs=<EMPTY_MAP>
2019-06-17 13:35:58,794 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler83e73434-6902-467d-8a56-ae50ae634b6c/ratis] (custom)
2019-06-17 13:35:58,794 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler83e73434-6902-467d-8a56-ae50ae634b6c/ratis/effdf2d3-1dcf-4849-919b-4a4205e6e82c does not exist. Creating ...
2019-06-17 13:35:58,797 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler83e73434-6902-467d-8a56-ae50ae634b6c/ratis/effdf2d3-1dcf-4849-919b-4a4205e6e82c/in_use.lock acquired by nodename 4312@ozone-unit-076618677d3sbc5j-4242397806
2019-06-17 13:35:58,799 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler83e73434-6902-467d-8a56-ae50ae634b6c/ratis/effdf2d3-1dcf-4849-919b-4a4205e6e82c has been successfully formatted.
2019-06-17 13:35:58,799 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 13:35:58,799 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 13:35:58,799 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 13:35:58,799 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 13:35:58,800 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 13:35:58,800 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 13:35:58,800 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new ec6b8704-b803-437d-8bc5-ec134a56cfe8-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler83e73434-6902-467d-8a56-ae50ae634b6c/ratis/effdf2d3-1dcf-4849-919b-4a4205e6e82c
2019-06-17 13:35:58,800 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 13:35:58,800 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 13:35:58,800 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 13:35:58,801 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 13:35:58,801 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 13:35:58,801 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 13:35:58,801 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 13:35:58,801 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 13:35:58,801 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 13:35:58,801 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 13:35:58,802 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 13:35:58,802 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 13:35:58,802 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 13:35:58,802 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8: start group-4A4205E6E82C
2019-06-17 13:35:58,802 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8:group-4A4205E6E82C changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 13:35:58,803 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8: start FollowerState
2019-06-17 13:35:58,803 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-4A4205E6E82C,id=ec6b8704-b803-437d-8bc5-ec134a56cfe8
2019-06-17 13:35:59,831 INFO  impl.FollowerState (FollowerState.java:run(101)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8:group-4A4205E6E82C changes to CANDIDATE, lastRpcTime:1028, electionTimeout:1028ms
2019-06-17 13:35:59,831 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8: shutdown FollowerState
2019-06-17 13:35:59,831 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8:group-4A4205E6E82C changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 13:35:59,831 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8: start LeaderElection
2019-06-17 13:35:59,842 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8:group-4A4205E6E82C:LeaderElection5: begin an election at term 1 for -1: [ec6b8704-b803-437d-8bc5-ec134a56cfe8:127.0.0.1:42211], old=null
2019-06-17 13:35:59,842 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8: shutdown LeaderElection
2019-06-17 13:35:59,842 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8:group-4A4205E6E82C changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 13:35:59,842 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8:group-4A4205E6E82C change Leader from null to ec6b8704-b803-437d-8bc5-ec134a56cfe8 at term 1 for becomeLeader, leader elected after 1043ms
2019-06-17 13:35:59,842 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 13:35:59,842 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 13:35:59,843 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 13:35:59,843 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 13:35:59,843 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8: start LeaderState
2019-06-17 13:35:59,843 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8-RaftLogWorker: Starting segment from index:0
2019-06-17 13:35:59,845 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8:group-4A4205E6E82C set configuration 0: [ec6b8704-b803-437d-8bc5-ec134a56cfe8:127.0.0.1:42211], old=null at 0
2019-06-17 13:35:59,891 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler83e73434-6902-467d-8a56-ae50ae634b6c/ratis/effdf2d3-1dcf-4849-919b-4a4205e6e82c/current/log_inprogress_0
2019-06-17 13:36:00,854 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 4777140493293609008 is closed with bcsId 0.
2019-06-17 13:36:00,855 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 13:36:00,855 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8: close
2019-06-17 13:36:00,855 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8: shutdown group-4A4205E6E82C
2019-06-17 13:36:00,856 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-4A4205E6E82C,id=ec6b8704-b803-437d-8bc5-ec134a56cfe8
2019-06-17 13:36:00,856 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8: shutdown LeaderState
2019-06-17 13:36:00,856 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8-PendingRequests: sendNotLeaderResponses
2019-06-17 13:36:00,858 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-ec6b8704-b803-437d-8bc5-ec134a56cfe8-group-4A4205E6E82C: set stopIndex = 4
2019-06-17 13:36:00,858 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 13:36:00,858 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler83e73434-6902-467d-8a56-ae50ae634b6c/ratis/effdf2d3-1dcf-4849-919b-4a4205e6e82c/sm/snapshot.1_4
2019-06-17 13:36:00,858 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8:group-4A4205E6E82C closes. The last applied log index is 4
2019-06-17 13:36:00,859 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 13:36:00,859 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8-RaftLogWorker close()
2019-06-17 13:36:00,860 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8: shutdown server with port 42211 now
2019-06-17 13:36:00,861 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - ec6b8704-b803-437d-8bc5-ec134a56cfe8: shutdown server with port 42211 successfully
2019-06-17 13:36:00,864 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
