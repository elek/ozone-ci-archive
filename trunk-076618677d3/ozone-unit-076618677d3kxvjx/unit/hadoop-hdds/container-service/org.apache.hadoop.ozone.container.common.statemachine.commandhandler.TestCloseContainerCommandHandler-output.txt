2019-06-17 18:16:26,830 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler75c8046c-2ef8-4d79-9c94-ffbe1017a290/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 18:16:26,836 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler75c8046c-2ef8-4d79-9c94-ffbe1017a290/hdds to VolumeSet
2019-06-17 18:16:26,872 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-17 18:16:26,906 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-17 18:16:27,305 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43785
2019-06-17 18:16:27,855 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 18:16:27,881 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 18:16:27,891 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43785 (custom)
2019-06-17 18:16:27,892 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 18:16:27,894 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 18:16:27,895 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 18:16:27,896 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 18:16:28,063 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler75c8046c-2ef8-4d79-9c94-ffbe1017a290/ratis] (custom)
2019-06-17 18:16:28,076 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 34527
2019-06-17 18:16:28,101 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 18:16:28,101 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 18:16:28,102 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 56763e97-4a5b-469f-bced-3b70be3a4092 at port 43785
2019-06-17 18:16:28,128 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 56763e97-4a5b-469f-bced-3b70be3a4092: start RPC server
2019-06-17 18:16:28,282 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 56763e97-4a5b-469f-bced-3b70be3a4092: GrpcService started, listening on 0.0.0.0/0.0.0.0:43785
2019-06-17 18:16:28,628 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 56763e97-4a5b-469f-bced-3b70be3a4092: addNew group-6978DCE83F74:[56763e97-4a5b-469f-bced-3b70be3a4092:127.0.0.1:43785] returns group-6978DCE83F74:java.util.concurrent.CompletableFuture@68fdff67[Not completed]
2019-06-17 18:16:28,665 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 56763e97-4a5b-469f-bced-3b70be3a4092: new RaftServerImpl for group-6978DCE83F74:[56763e97-4a5b-469f-bced-3b70be3a4092:127.0.0.1:43785] with ContainerStateMachine:uninitialized
2019-06-17 18:16:28,666 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 18:16:28,666 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 18:16:28,667 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 18:16:28,667 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 18:16:28,673 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 56763e97-4a5b-469f-bced-3b70be3a4092:group-6978DCE83F74 ConfigurationManager, init=-1: [56763e97-4a5b-469f-bced-3b70be3a4092:127.0.0.1:43785], old=null, confs=<EMPTY_MAP>
2019-06-17 18:16:28,673 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler75c8046c-2ef8-4d79-9c94-ffbe1017a290/ratis] (custom)
2019-06-17 18:16:28,680 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler75c8046c-2ef8-4d79-9c94-ffbe1017a290/ratis/06b81153-3afa-472e-a61a-6978dce83f74 does not exist. Creating ...
2019-06-17 18:16:28,690 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler75c8046c-2ef8-4d79-9c94-ffbe1017a290/ratis/06b81153-3afa-472e-a61a-6978dce83f74/in_use.lock acquired by nodename 4312@ozone-unit-076618677d3kxvjx-75383286
2019-06-17 18:16:28,699 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler75c8046c-2ef8-4d79-9c94-ffbe1017a290/ratis/06b81153-3afa-472e-a61a-6978dce83f74 has been successfully formatted.
2019-06-17 18:16:28,701 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 18:16:28,701 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 18:16:28,703 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 18:16:28,705 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 18:16:28,708 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 18:16:28,712 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 18:16:28,715 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 56763e97-4a5b-469f-bced-3b70be3a4092-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler75c8046c-2ef8-4d79-9c94-ffbe1017a290/ratis/06b81153-3afa-472e-a61a-6978dce83f74
2019-06-17 18:16:28,716 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 18:16:28,716 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 18:16:28,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 18:16:28,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 18:16:28,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 18:16:28,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 18:16:28,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 18:16:28,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 18:16:28,721 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 18:16:28,723 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 18:16:28,728 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 18:16:28,729 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 18:16:28,730 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 18:16:28,844 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 56763e97-4a5b-469f-bced-3b70be3a4092: start group-6978DCE83F74
2019-06-17 18:16:28,845 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 56763e97-4a5b-469f-bced-3b70be3a4092:group-6978DCE83F74 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 18:16:28,846 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 56763e97-4a5b-469f-bced-3b70be3a4092: start FollowerState
2019-06-17 18:16:28,847 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-6978DCE83F74,id=56763e97-4a5b-469f-bced-3b70be3a4092
2019-06-17 18:16:30,036 INFO  impl.FollowerState (FollowerState.java:run(101)) - 56763e97-4a5b-469f-bced-3b70be3a4092:group-6978DCE83F74 changes to CANDIDATE, lastRpcTime:1190, electionTimeout:1190ms
2019-06-17 18:16:30,037 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 56763e97-4a5b-469f-bced-3b70be3a4092: shutdown FollowerState
2019-06-17 18:16:30,037 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 56763e97-4a5b-469f-bced-3b70be3a4092:group-6978DCE83F74 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 18:16:30,039 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 56763e97-4a5b-469f-bced-3b70be3a4092: start LeaderElection
2019-06-17 18:16:30,042 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 56763e97-4a5b-469f-bced-3b70be3a4092:group-6978DCE83F74:LeaderElection1: begin an election at term 1 for -1: [56763e97-4a5b-469f-bced-3b70be3a4092:127.0.0.1:43785], old=null
2019-06-17 18:16:30,043 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 56763e97-4a5b-469f-bced-3b70be3a4092: shutdown LeaderElection
2019-06-17 18:16:30,043 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 56763e97-4a5b-469f-bced-3b70be3a4092:group-6978DCE83F74 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 18:16:30,044 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 56763e97-4a5b-469f-bced-3b70be3a4092:group-6978DCE83F74 change Leader from null to 56763e97-4a5b-469f-bced-3b70be3a4092 at term 1 for becomeLeader, leader elected after 1342ms
2019-06-17 18:16:30,047 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 18:16:30,047 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 18:16:30,049 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 18:16:30,050 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 18:16:30,057 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 56763e97-4a5b-469f-bced-3b70be3a4092: start LeaderState
2019-06-17 18:16:30,069 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 56763e97-4a5b-469f-bced-3b70be3a4092-RaftLogWorker: Starting segment from index:0
2019-06-17 18:16:30,076 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 56763e97-4a5b-469f-bced-3b70be3a4092:group-6978DCE83F74 set configuration 0: [56763e97-4a5b-469f-bced-3b70be3a4092:127.0.0.1:43785], old=null at 0
2019-06-17 18:16:30,201 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 56763e97-4a5b-469f-bced-3b70be3a4092-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler75c8046c-2ef8-4d79-9c94-ffbe1017a290/ratis/06b81153-3afa-472e-a61a-6978dce83f74/current/log_inprogress_0
2019-06-17 18:16:31,109 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-17 18:16:31,181 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 7883812416275659715 is closed with bcsId 0.
2019-06-17 18:16:31,185 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 18:16:31,186 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 56763e97-4a5b-469f-bced-3b70be3a4092: close
2019-06-17 18:16:31,188 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 56763e97-4a5b-469f-bced-3b70be3a4092: shutdown group-6978DCE83F74
2019-06-17 18:16:31,189 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-6978DCE83F74,id=56763e97-4a5b-469f-bced-3b70be3a4092
2019-06-17 18:16:31,189 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 56763e97-4a5b-469f-bced-3b70be3a4092: shutdown LeaderState
2019-06-17 18:16:31,190 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 56763e97-4a5b-469f-bced-3b70be3a4092-PendingRequests: sendNotLeaderResponses
2019-06-17 18:16:31,194 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-56763e97-4a5b-469f-bced-3b70be3a4092-group-6978DCE83F74: set stopIndex = 4
2019-06-17 18:16:31,194 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 18:16:31,194 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler75c8046c-2ef8-4d79-9c94-ffbe1017a290/ratis/06b81153-3afa-472e-a61a-6978dce83f74/sm/snapshot.1_4
2019-06-17 18:16:31,202 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 56763e97-4a5b-469f-bced-3b70be3a4092:group-6978DCE83F74 closes. The last applied log index is 4
2019-06-17 18:16:31,204 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 56763e97-4a5b-469f-bced-3b70be3a4092-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 18:16:31,205 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 56763e97-4a5b-469f-bced-3b70be3a4092-RaftLogWorker close()
2019-06-17 18:16:31,206 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 56763e97-4a5b-469f-bced-3b70be3a4092: shutdown server with port 43785 now
2019-06-17 18:16:31,212 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 56763e97-4a5b-469f-bced-3b70be3a4092: shutdown server with port 43785 successfully
2019-06-17 18:16:31,224 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 18:16:31,250 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf14b8568-749a-4f97-b5b2-aea4a716fb24/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 18:16:31,251 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf14b8568-749a-4f97-b5b2-aea4a716fb24/hdds to VolumeSet
2019-06-17 18:16:31,251 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1f966492
2019-06-17 18:16:31,258 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1f966492
2019-06-17 18:16:31,273 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 34691
2019-06-17 18:16:31,274 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 18:16:31,275 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 18:16:31,275 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 34691 (custom)
2019-06-17 18:16:31,275 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 18:16:31,275 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 18:16:31,276 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 18:16:31,276 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 18:16:31,277 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf14b8568-749a-4f97-b5b2-aea4a716fb24/ratis] (custom)
2019-06-17 18:16:31,277 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 42835
2019-06-17 18:16:31,278 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 18:16:31,278 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 18:16:31,278 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 3292d98d-6f7a-4b4d-83ae-3a25e914a48f at port 34691
2019-06-17 18:16:31,300 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f: start RPC server
2019-06-17 18:16:31,302 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f: GrpcService started, listening on 0.0.0.0/0.0.0.0:34691
2019-06-17 18:16:31,318 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f: addNew group-9F51CFCCB5AC:[3292d98d-6f7a-4b4d-83ae-3a25e914a48f:127.0.0.1:34691] returns group-9F51CFCCB5AC:java.util.concurrent.CompletableFuture@14fd0e72[Not completed]
2019-06-17 18:16:31,324 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f: new RaftServerImpl for group-9F51CFCCB5AC:[3292d98d-6f7a-4b4d-83ae-3a25e914a48f:127.0.0.1:34691] with ContainerStateMachine:uninitialized
2019-06-17 18:16:31,325 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 18:16:31,325 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 18:16:31,325 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 18:16:31,325 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 18:16:31,325 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f:group-9F51CFCCB5AC ConfigurationManager, init=-1: [3292d98d-6f7a-4b4d-83ae-3a25e914a48f:127.0.0.1:34691], old=null, confs=<EMPTY_MAP>
2019-06-17 18:16:31,326 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf14b8568-749a-4f97-b5b2-aea4a716fb24/ratis] (custom)
2019-06-17 18:16:31,326 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf14b8568-749a-4f97-b5b2-aea4a716fb24/ratis/a81eb3b2-f1c8-4a50-b274-9f51cfccb5ac does not exist. Creating ...
2019-06-17 18:16:31,337 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf14b8568-749a-4f97-b5b2-aea4a716fb24/ratis/a81eb3b2-f1c8-4a50-b274-9f51cfccb5ac/in_use.lock acquired by nodename 4312@ozone-unit-076618677d3kxvjx-75383286
2019-06-17 18:16:31,348 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf14b8568-749a-4f97-b5b2-aea4a716fb24/ratis/a81eb3b2-f1c8-4a50-b274-9f51cfccb5ac has been successfully formatted.
2019-06-17 18:16:31,349 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 18:16:31,349 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 18:16:31,349 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 18:16:31,349 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 18:16:31,350 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 18:16:31,351 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 18:16:31,351 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 3292d98d-6f7a-4b4d-83ae-3a25e914a48f-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf14b8568-749a-4f97-b5b2-aea4a716fb24/ratis/a81eb3b2-f1c8-4a50-b274-9f51cfccb5ac
2019-06-17 18:16:31,351 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 18:16:31,351 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 18:16:31,351 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 18:16:31,352 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 18:16:31,352 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 18:16:31,352 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 18:16:31,352 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 18:16:31,352 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 18:16:31,353 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 18:16:31,353 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 18:16:31,355 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 18:16:31,355 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 18:16:31,355 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 18:16:31,355 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f: start group-9F51CFCCB5AC
2019-06-17 18:16:31,356 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f:group-9F51CFCCB5AC changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 18:16:31,356 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f: start FollowerState
2019-06-17 18:16:31,357 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-9F51CFCCB5AC,id=3292d98d-6f7a-4b4d-83ae-3a25e914a48f
2019-06-17 18:16:32,486 INFO  impl.FollowerState (FollowerState.java:run(101)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f:group-9F51CFCCB5AC changes to CANDIDATE, lastRpcTime:1130, electionTimeout:1129ms
2019-06-17 18:16:32,487 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f: shutdown FollowerState
2019-06-17 18:16:32,487 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f:group-9F51CFCCB5AC changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 18:16:32,487 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f: start LeaderElection
2019-06-17 18:16:32,491 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f:group-9F51CFCCB5AC:LeaderElection2: begin an election at term 1 for -1: [3292d98d-6f7a-4b4d-83ae-3a25e914a48f:127.0.0.1:34691], old=null
2019-06-17 18:16:32,491 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f: shutdown LeaderElection
2019-06-17 18:16:32,491 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f:group-9F51CFCCB5AC changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 18:16:32,491 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f:group-9F51CFCCB5AC change Leader from null to 3292d98d-6f7a-4b4d-83ae-3a25e914a48f at term 1 for becomeLeader, leader elected after 1142ms
2019-06-17 18:16:32,492 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 18:16:32,492 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 18:16:32,492 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 18:16:32,492 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 18:16:32,492 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f: start LeaderState
2019-06-17 18:16:32,493 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f-RaftLogWorker: Starting segment from index:0
2019-06-17 18:16:32,493 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f:group-9F51CFCCB5AC set configuration 0: [3292d98d-6f7a-4b4d-83ae-3a25e914a48f:127.0.0.1:34691], old=null at 0
2019-06-17 18:16:32,532 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf14b8568-749a-4f97-b5b2-aea4a716fb24/ratis/a81eb3b2-f1c8-4a50-b274-9f51cfccb5ac/current/log_inprogress_0
2019-06-17 18:16:33,401 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 18:16:33,402 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f: close
2019-06-17 18:16:33,402 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f: shutdown group-9F51CFCCB5AC
2019-06-17 18:16:33,403 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-9F51CFCCB5AC,id=3292d98d-6f7a-4b4d-83ae-3a25e914a48f
2019-06-17 18:16:33,403 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f: shutdown LeaderState
2019-06-17 18:16:33,404 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f-PendingRequests: sendNotLeaderResponses
2019-06-17 18:16:33,404 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-3292d98d-6f7a-4b4d-83ae-3a25e914a48f-group-9F51CFCCB5AC: set stopIndex = 2
2019-06-17 18:16:33,404 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 18:16:33,405 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerf14b8568-749a-4f97-b5b2-aea4a716fb24/ratis/a81eb3b2-f1c8-4a50-b274-9f51cfccb5ac/sm/snapshot.1_2
2019-06-17 18:16:33,405 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f:group-9F51CFCCB5AC closes. The last applied log index is 2
2019-06-17 18:16:33,406 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 18:16:33,406 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f-RaftLogWorker close()
2019-06-17 18:16:33,407 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f: shutdown server with port 34691 now
2019-06-17 18:16:33,408 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 3292d98d-6f7a-4b4d-83ae-3a25e914a48f: shutdown server with port 34691 successfully
2019-06-17 18:16:33,419 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 18:16:33,442 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8e9664e8-619b-4156-b5b5-e9b40bda68e2/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 18:16:33,442 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8e9664e8-619b-4156-b5b5-e9b40bda68e2/hdds to VolumeSet
2019-06-17 18:16:33,443 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@36f1046f
2019-06-17 18:16:33,453 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@36f1046f
2019-06-17 18:16:33,466 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43601
2019-06-17 18:16:33,467 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 18:16:33,467 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 18:16:33,468 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43601 (custom)
2019-06-17 18:16:33,468 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 18:16:33,468 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 18:16:33,468 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 18:16:33,468 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 18:16:33,469 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8e9664e8-619b-4156-b5b5-e9b40bda68e2/ratis] (custom)
2019-06-17 18:16:33,469 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 33277
2019-06-17 18:16:33,470 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 18:16:33,470 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 18:16:33,470 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1 at port 43601
2019-06-17 18:16:33,475 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1: start RPC server
2019-06-17 18:16:33,477 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1: GrpcService started, listening on 0.0.0.0/0.0.0.0:43601
2019-06-17 18:16:33,485 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1: addNew group-7DA1FF62D4C7:[dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1:127.0.0.1:43601] returns group-7DA1FF62D4C7:java.util.concurrent.CompletableFuture@7ab4c968[Not completed]
2019-06-17 18:16:33,486 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1: new RaftServerImpl for group-7DA1FF62D4C7:[dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1:127.0.0.1:43601] with ContainerStateMachine:uninitialized
2019-06-17 18:16:33,486 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 18:16:33,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 18:16:33,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 18:16:33,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 18:16:33,487 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1:group-7DA1FF62D4C7 ConfigurationManager, init=-1: [dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1:127.0.0.1:43601], old=null, confs=<EMPTY_MAP>
2019-06-17 18:16:33,487 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8e9664e8-619b-4156-b5b5-e9b40bda68e2/ratis] (custom)
2019-06-17 18:16:33,487 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8e9664e8-619b-4156-b5b5-e9b40bda68e2/ratis/ffb3b653-75f2-4622-a3ff-7da1ff62d4c7 does not exist. Creating ...
2019-06-17 18:16:33,492 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8e9664e8-619b-4156-b5b5-e9b40bda68e2/ratis/ffb3b653-75f2-4622-a3ff-7da1ff62d4c7/in_use.lock acquired by nodename 4312@ozone-unit-076618677d3kxvjx-75383286
2019-06-17 18:16:33,495 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8e9664e8-619b-4156-b5b5-e9b40bda68e2/ratis/ffb3b653-75f2-4622-a3ff-7da1ff62d4c7 has been successfully formatted.
2019-06-17 18:16:33,495 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 18:16:33,495 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 18:16:33,495 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 18:16:33,495 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 18:16:33,495 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 18:16:33,496 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 18:16:33,496 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8e9664e8-619b-4156-b5b5-e9b40bda68e2/ratis/ffb3b653-75f2-4622-a3ff-7da1ff62d4c7
2019-06-17 18:16:33,496 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 18:16:33,496 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 18:16:33,496 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 18:16:33,496 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 18:16:33,496 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 18:16:33,496 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 18:16:33,497 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 18:16:33,497 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 18:16:33,497 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 18:16:33,497 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 18:16:33,497 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 18:16:33,497 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 18:16:33,498 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 18:16:33,498 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1: start group-7DA1FF62D4C7
2019-06-17 18:16:33,498 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1:group-7DA1FF62D4C7 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 18:16:33,498 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1: start FollowerState
2019-06-17 18:16:33,498 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-7DA1FF62D4C7,id=dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1
2019-06-17 18:16:34,548 INFO  impl.FollowerState (FollowerState.java:run(101)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1:group-7DA1FF62D4C7 changes to CANDIDATE, lastRpcTime:1049, electionTimeout:1049ms
2019-06-17 18:16:34,548 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1: shutdown FollowerState
2019-06-17 18:16:34,548 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1:group-7DA1FF62D4C7 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 18:16:34,548 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1: start LeaderElection
2019-06-17 18:16:34,551 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1:group-7DA1FF62D4C7:LeaderElection3: begin an election at term 1 for -1: [dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1:127.0.0.1:43601], old=null
2019-06-17 18:16:34,551 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1: shutdown LeaderElection
2019-06-17 18:16:34,552 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1:group-7DA1FF62D4C7 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 18:16:34,552 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1:group-7DA1FF62D4C7 change Leader from null to dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1 at term 1 for becomeLeader, leader elected after 1056ms
2019-06-17 18:16:34,552 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 18:16:34,552 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 18:16:34,552 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 18:16:34,552 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 18:16:34,553 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1: start LeaderState
2019-06-17 18:16:34,553 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1-RaftLogWorker: Starting segment from index:0
2019-06-17 18:16:34,559 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1:group-7DA1FF62D4C7 set configuration 0: [dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1:127.0.0.1:43601], old=null at 0
2019-06-17 18:16:34,592 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8e9664e8-619b-4156-b5b5-e9b40bda68e2/ratis/ffb3b653-75f2-4622-a3ff-7da1ff62d4c7/current/log_inprogress_0
2019-06-17 18:16:35,546 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 1948950731151092 is closed with bcsId 0.
2019-06-17 18:16:35,547 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 18:16:35,548 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1: close
2019-06-17 18:16:35,548 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1: shutdown group-7DA1FF62D4C7
2019-06-17 18:16:35,548 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-7DA1FF62D4C7,id=dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1
2019-06-17 18:16:35,548 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1: shutdown LeaderState
2019-06-17 18:16:35,549 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1-PendingRequests: sendNotLeaderResponses
2019-06-17 18:16:35,549 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1-group-7DA1FF62D4C7: set stopIndex = 2
2019-06-17 18:16:35,550 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 18:16:35,550 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler8e9664e8-619b-4156-b5b5-e9b40bda68e2/ratis/ffb3b653-75f2-4622-a3ff-7da1ff62d4c7/sm/snapshot.1_2
2019-06-17 18:16:35,550 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1:group-7DA1FF62D4C7 closes. The last applied log index is 2
2019-06-17 18:16:35,551 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 18:16:35,551 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1-RaftLogWorker close()
2019-06-17 18:16:35,552 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1: shutdown server with port 43601 now
2019-06-17 18:16:35,554 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - dcd01b0e-4c5b-4fc3-851e-4cf166a14fc1: shutdown server with port 43601 successfully
2019-06-17 18:16:35,559 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 18:16:35,601 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9a606a76-aafb-414d-a38e-b35ae29afa8d/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 18:16:35,603 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9a606a76-aafb-414d-a38e-b35ae29afa8d/hdds to VolumeSet
2019-06-17 18:16:35,604 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@37864b77
2019-06-17 18:16:35,606 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@37864b77
2019-06-17 18:16:35,615 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 46261
2019-06-17 18:16:35,616 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 18:16:35,617 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 18:16:35,617 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 46261 (custom)
2019-06-17 18:16:35,618 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 18:16:35,618 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 18:16:35,618 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 18:16:35,618 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 18:16:35,619 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9a606a76-aafb-414d-a38e-b35ae29afa8d/ratis] (custom)
2019-06-17 18:16:35,619 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 32779
2019-06-17 18:16:35,619 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 18:16:35,619 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 18:16:35,619 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 24d93b40-56a3-476f-8324-e5ecf6d8ff5b at port 46261
2019-06-17 18:16:35,644 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b: start RPC server
2019-06-17 18:16:35,645 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b: GrpcService started, listening on 0.0.0.0/0.0.0.0:46261
Jun 17, 2019 6:16:35 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:43601} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 17, 2019 6:16:35 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:34691} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-17 18:16:35,660 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b: addNew group-41C654C4A5E4:[24d93b40-56a3-476f-8324-e5ecf6d8ff5b:127.0.0.1:46261] returns group-41C654C4A5E4:java.util.concurrent.CompletableFuture@54784d8f[Not completed]
2019-06-17 18:16:35,661 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b: new RaftServerImpl for group-41C654C4A5E4:[24d93b40-56a3-476f-8324-e5ecf6d8ff5b:127.0.0.1:46261] with ContainerStateMachine:uninitialized
2019-06-17 18:16:35,661 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 18:16:35,661 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 18:16:35,661 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 18:16:35,662 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 18:16:35,662 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b:group-41C654C4A5E4 ConfigurationManager, init=-1: [24d93b40-56a3-476f-8324-e5ecf6d8ff5b:127.0.0.1:46261], old=null, confs=<EMPTY_MAP>
2019-06-17 18:16:35,662 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9a606a76-aafb-414d-a38e-b35ae29afa8d/ratis] (custom)
2019-06-17 18:16:35,662 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9a606a76-aafb-414d-a38e-b35ae29afa8d/ratis/27ab9dd6-d45b-4b85-b69e-41c654c4a5e4 does not exist. Creating ...
2019-06-17 18:16:35,665 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9a606a76-aafb-414d-a38e-b35ae29afa8d/ratis/27ab9dd6-d45b-4b85-b69e-41c654c4a5e4/in_use.lock acquired by nodename 4312@ozone-unit-076618677d3kxvjx-75383286
2019-06-17 18:16:35,667 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9a606a76-aafb-414d-a38e-b35ae29afa8d/ratis/27ab9dd6-d45b-4b85-b69e-41c654c4a5e4 has been successfully formatted.
2019-06-17 18:16:35,667 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 18:16:35,667 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 18:16:35,667 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 18:16:35,668 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 18:16:35,668 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 18:16:35,668 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 18:16:35,668 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 24d93b40-56a3-476f-8324-e5ecf6d8ff5b-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9a606a76-aafb-414d-a38e-b35ae29afa8d/ratis/27ab9dd6-d45b-4b85-b69e-41c654c4a5e4
2019-06-17 18:16:35,668 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 18:16:35,668 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 18:16:35,668 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 18:16:35,668 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 18:16:35,668 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 18:16:35,668 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 18:16:35,669 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 18:16:35,669 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 18:16:35,669 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 18:16:35,669 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 18:16:35,670 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 18:16:35,670 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 18:16:35,670 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 18:16:35,670 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b: start group-41C654C4A5E4
2019-06-17 18:16:35,670 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b:group-41C654C4A5E4 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 18:16:35,670 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b: start FollowerState
2019-06-17 18:16:35,671 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-41C654C4A5E4,id=24d93b40-56a3-476f-8324-e5ecf6d8ff5b
2019-06-17 18:16:36,841 INFO  impl.FollowerState (FollowerState.java:run(101)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b:group-41C654C4A5E4 changes to CANDIDATE, lastRpcTime:1170, electionTimeout:1170ms
2019-06-17 18:16:36,841 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b: shutdown FollowerState
2019-06-17 18:16:36,841 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b:group-41C654C4A5E4 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 18:16:36,841 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b: start LeaderElection
2019-06-17 18:16:36,845 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b:group-41C654C4A5E4:LeaderElection4: begin an election at term 1 for -1: [24d93b40-56a3-476f-8324-e5ecf6d8ff5b:127.0.0.1:46261], old=null
2019-06-17 18:16:36,845 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b: shutdown LeaderElection
2019-06-17 18:16:36,845 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b:group-41C654C4A5E4 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 18:16:36,845 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b:group-41C654C4A5E4 change Leader from null to 24d93b40-56a3-476f-8324-e5ecf6d8ff5b at term 1 for becomeLeader, leader elected after 1177ms
2019-06-17 18:16:36,845 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 18:16:36,845 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 18:16:36,846 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 18:16:36,846 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 18:16:36,846 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b: start LeaderState
2019-06-17 18:16:36,846 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b-RaftLogWorker: Starting segment from index:0
2019-06-17 18:16:36,847 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b:group-41C654C4A5E4 set configuration 0: [24d93b40-56a3-476f-8324-e5ecf6d8ff5b:127.0.0.1:46261], old=null at 0
2019-06-17 18:16:36,882 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9a606a76-aafb-414d-a38e-b35ae29afa8d/ratis/27ab9dd6-d45b-4b85-b69e-41c654c4a5e4/current/log_inprogress_0
2019-06-17 18:16:37,714 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 8223105193254221880 is closed with bcsId 0.
2019-06-17 18:16:37,714 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 18:16:37,715 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b: close
2019-06-17 18:16:37,715 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b: shutdown group-41C654C4A5E4
2019-06-17 18:16:37,715 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-41C654C4A5E4,id=24d93b40-56a3-476f-8324-e5ecf6d8ff5b
2019-06-17 18:16:37,715 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b: shutdown LeaderState
2019-06-17 18:16:37,716 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b-PendingRequests: sendNotLeaderResponses
2019-06-17 18:16:37,717 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-24d93b40-56a3-476f-8324-e5ecf6d8ff5b-group-41C654C4A5E4: set stopIndex = 2
2019-06-17 18:16:37,717 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 18:16:37,718 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler9a606a76-aafb-414d-a38e-b35ae29afa8d/ratis/27ab9dd6-d45b-4b85-b69e-41c654c4a5e4/sm/snapshot.1_2
2019-06-17 18:16:37,718 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b:group-41C654C4A5E4 closes. The last applied log index is 2
2019-06-17 18:16:37,718 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 18:16:37,719 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b-RaftLogWorker close()
2019-06-17 18:16:37,720 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b: shutdown server with port 46261 now
2019-06-17 18:16:37,722 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 24d93b40-56a3-476f-8324-e5ecf6d8ff5b: shutdown server with port 46261 successfully
2019-06-17 18:16:37,725 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 18:16:37,746 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler16d82157-5e9e-40d0-bea1-b07d44a6f905/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 18:16:37,746 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler16d82157-5e9e-40d0-bea1-b07d44a6f905/hdds to VolumeSet
2019-06-17 18:16:37,746 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@10bd9df0
2019-06-17 18:16:37,748 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@10bd9df0
2019-06-17 18:16:37,756 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43679
2019-06-17 18:16:37,757 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 18:16:37,758 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 18:16:37,758 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43679 (custom)
2019-06-17 18:16:37,759 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 18:16:37,759 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 18:16:37,759 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 18:16:37,759 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 18:16:37,760 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler16d82157-5e9e-40d0-bea1-b07d44a6f905/ratis] (custom)
2019-06-17 18:16:37,760 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 40521
2019-06-17 18:16:37,760 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 18:16:37,760 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 18:16:37,760 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 814774fa-fa38-4c18-9ffb-eba986e7058b at port 43679
2019-06-17 18:16:37,778 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 814774fa-fa38-4c18-9ffb-eba986e7058b: start RPC server
2019-06-17 18:16:37,779 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 814774fa-fa38-4c18-9ffb-eba986e7058b: GrpcService started, listening on 0.0.0.0/0.0.0.0:43679
2019-06-17 18:16:37,794 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 814774fa-fa38-4c18-9ffb-eba986e7058b: addNew group-A565A250ECD7:[814774fa-fa38-4c18-9ffb-eba986e7058b:127.0.0.1:43679] returns group-A565A250ECD7:java.util.concurrent.CompletableFuture@181c9b9f[Not completed]
2019-06-17 18:16:37,795 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 814774fa-fa38-4c18-9ffb-eba986e7058b: new RaftServerImpl for group-A565A250ECD7:[814774fa-fa38-4c18-9ffb-eba986e7058b:127.0.0.1:43679] with ContainerStateMachine:uninitialized
2019-06-17 18:16:37,795 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 18:16:37,795 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 18:16:37,796 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 18:16:37,796 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 18:16:37,796 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 814774fa-fa38-4c18-9ffb-eba986e7058b:group-A565A250ECD7 ConfigurationManager, init=-1: [814774fa-fa38-4c18-9ffb-eba986e7058b:127.0.0.1:43679], old=null, confs=<EMPTY_MAP>
2019-06-17 18:16:37,796 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler16d82157-5e9e-40d0-bea1-b07d44a6f905/ratis] (custom)
2019-06-17 18:16:37,796 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler16d82157-5e9e-40d0-bea1-b07d44a6f905/ratis/f461a6d0-ad9c-43b1-b473-a565a250ecd7 does not exist. Creating ...
2019-06-17 18:16:37,800 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler16d82157-5e9e-40d0-bea1-b07d44a6f905/ratis/f461a6d0-ad9c-43b1-b473-a565a250ecd7/in_use.lock acquired by nodename 4312@ozone-unit-076618677d3kxvjx-75383286
2019-06-17 18:16:37,802 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler16d82157-5e9e-40d0-bea1-b07d44a6f905/ratis/f461a6d0-ad9c-43b1-b473-a565a250ecd7 has been successfully formatted.
2019-06-17 18:16:37,802 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 18:16:37,802 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 18:16:37,802 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 18:16:37,802 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 18:16:37,803 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 18:16:37,803 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 18:16:37,803 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 814774fa-fa38-4c18-9ffb-eba986e7058b-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler16d82157-5e9e-40d0-bea1-b07d44a6f905/ratis/f461a6d0-ad9c-43b1-b473-a565a250ecd7
2019-06-17 18:16:37,803 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 18:16:37,803 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 18:16:37,803 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 18:16:37,803 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 18:16:37,803 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 18:16:37,804 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 18:16:37,804 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 18:16:37,804 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 18:16:37,804 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 18:16:37,804 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 18:16:37,805 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 18:16:37,805 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 18:16:37,806 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 18:16:37,806 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 814774fa-fa38-4c18-9ffb-eba986e7058b: start group-A565A250ECD7
2019-06-17 18:16:37,806 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 814774fa-fa38-4c18-9ffb-eba986e7058b:group-A565A250ECD7 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 18:16:37,806 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 814774fa-fa38-4c18-9ffb-eba986e7058b: start FollowerState
2019-06-17 18:16:37,806 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-A565A250ECD7,id=814774fa-fa38-4c18-9ffb-eba986e7058b
2019-06-17 18:16:38,959 INFO  impl.FollowerState (FollowerState.java:run(101)) - 814774fa-fa38-4c18-9ffb-eba986e7058b:group-A565A250ECD7 changes to CANDIDATE, lastRpcTime:1153, electionTimeout:1153ms
2019-06-17 18:16:38,960 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 814774fa-fa38-4c18-9ffb-eba986e7058b: shutdown FollowerState
2019-06-17 18:16:38,960 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 814774fa-fa38-4c18-9ffb-eba986e7058b:group-A565A250ECD7 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 18:16:38,960 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 814774fa-fa38-4c18-9ffb-eba986e7058b: start LeaderElection
2019-06-17 18:16:38,963 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 814774fa-fa38-4c18-9ffb-eba986e7058b:group-A565A250ECD7:LeaderElection5: begin an election at term 1 for -1: [814774fa-fa38-4c18-9ffb-eba986e7058b:127.0.0.1:43679], old=null
2019-06-17 18:16:38,963 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 814774fa-fa38-4c18-9ffb-eba986e7058b: shutdown LeaderElection
2019-06-17 18:16:38,963 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 814774fa-fa38-4c18-9ffb-eba986e7058b:group-A565A250ECD7 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 18:16:38,963 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 814774fa-fa38-4c18-9ffb-eba986e7058b:group-A565A250ECD7 change Leader from null to 814774fa-fa38-4c18-9ffb-eba986e7058b at term 1 for becomeLeader, leader elected after 1161ms
2019-06-17 18:16:38,964 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 18:16:38,964 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 18:16:38,964 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 18:16:38,964 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 18:16:38,964 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 814774fa-fa38-4c18-9ffb-eba986e7058b: start LeaderState
2019-06-17 18:16:38,964 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 814774fa-fa38-4c18-9ffb-eba986e7058b-RaftLogWorker: Starting segment from index:0
2019-06-17 18:16:38,965 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 814774fa-fa38-4c18-9ffb-eba986e7058b:group-A565A250ECD7 set configuration 0: [814774fa-fa38-4c18-9ffb-eba986e7058b:127.0.0.1:43679], old=null at 0
2019-06-17 18:16:39,000 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 814774fa-fa38-4c18-9ffb-eba986e7058b-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler16d82157-5e9e-40d0-bea1-b07d44a6f905/ratis/f461a6d0-ad9c-43b1-b473-a565a250ecd7/current/log_inprogress_0
2019-06-17 18:16:39,871 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 3157409742239907344 is closed with bcsId 0.
2019-06-17 18:16:39,871 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 18:16:39,871 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 814774fa-fa38-4c18-9ffb-eba986e7058b: close
2019-06-17 18:16:39,872 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 814774fa-fa38-4c18-9ffb-eba986e7058b: shutdown group-A565A250ECD7
2019-06-17 18:16:39,872 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-A565A250ECD7,id=814774fa-fa38-4c18-9ffb-eba986e7058b
2019-06-17 18:16:39,872 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 814774fa-fa38-4c18-9ffb-eba986e7058b: shutdown LeaderState
2019-06-17 18:16:39,872 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 814774fa-fa38-4c18-9ffb-eba986e7058b-PendingRequests: sendNotLeaderResponses
2019-06-17 18:16:39,874 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-814774fa-fa38-4c18-9ffb-eba986e7058b-group-A565A250ECD7: set stopIndex = 4
2019-06-17 18:16:39,874 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 18:16:39,875 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler16d82157-5e9e-40d0-bea1-b07d44a6f905/ratis/f461a6d0-ad9c-43b1-b473-a565a250ecd7/sm/snapshot.1_4
2019-06-17 18:16:39,875 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 814774fa-fa38-4c18-9ffb-eba986e7058b:group-A565A250ECD7 closes. The last applied log index is 4
2019-06-17 18:16:39,875 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 814774fa-fa38-4c18-9ffb-eba986e7058b-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 18:16:39,876 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 814774fa-fa38-4c18-9ffb-eba986e7058b-RaftLogWorker close()
2019-06-17 18:16:39,876 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 814774fa-fa38-4c18-9ffb-eba986e7058b: shutdown server with port 43679 now
2019-06-17 18:16:39,878 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 814774fa-fa38-4c18-9ffb-eba986e7058b: shutdown server with port 43679 successfully
2019-06-17 18:16:39,879 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
