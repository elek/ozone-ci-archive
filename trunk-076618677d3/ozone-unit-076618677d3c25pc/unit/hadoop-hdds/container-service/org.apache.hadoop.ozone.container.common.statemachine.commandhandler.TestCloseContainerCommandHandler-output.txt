2019-06-18 08:55:32,856 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd8ce543c-1825-47cb-a18c-52744faecb10/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 08:55:32,860 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd8ce543c-1825-47cb-a18c-52744faecb10/hdds to VolumeSet
2019-06-18 08:55:32,873 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-18 08:55:32,915 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-18 08:55:33,270 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 43583
2019-06-18 08:55:33,722 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 08:55:33,741 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 08:55:33,749 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 43583 (custom)
2019-06-18 08:55:33,751 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 08:55:33,753 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 08:55:33,754 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 08:55:33,755 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 08:55:33,877 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd8ce543c-1825-47cb-a18c-52744faecb10/ratis] (custom)
2019-06-18 08:55:33,891 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 41987
2019-06-18 08:55:33,913 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 08:55:33,914 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 08:55:33,915 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis be649b9c-87c3-4459-a56b-efcbd7414691 at port 43583
2019-06-18 08:55:33,941 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - be649b9c-87c3-4459-a56b-efcbd7414691: start RPC server
2019-06-18 08:55:34,081 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - be649b9c-87c3-4459-a56b-efcbd7414691: GrpcService started, listening on 0.0.0.0/0.0.0.0:43583
2019-06-18 08:55:34,411 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - be649b9c-87c3-4459-a56b-efcbd7414691: addNew group-71EE7D08487A:[be649b9c-87c3-4459-a56b-efcbd7414691:127.0.0.1:43583] returns group-71EE7D08487A:java.util.concurrent.CompletableFuture@2dacbee5[Not completed]
2019-06-18 08:55:34,441 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - be649b9c-87c3-4459-a56b-efcbd7414691: new RaftServerImpl for group-71EE7D08487A:[be649b9c-87c3-4459-a56b-efcbd7414691:127.0.0.1:43583] with ContainerStateMachine:uninitialized
2019-06-18 08:55:34,442 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 08:55:34,443 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 08:55:34,443 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 08:55:34,444 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 08:55:34,450 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - be649b9c-87c3-4459-a56b-efcbd7414691:group-71EE7D08487A ConfigurationManager, init=-1: [be649b9c-87c3-4459-a56b-efcbd7414691:127.0.0.1:43583], old=null, confs=<EMPTY_MAP>
2019-06-18 08:55:34,450 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd8ce543c-1825-47cb-a18c-52744faecb10/ratis] (custom)
2019-06-18 08:55:34,457 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd8ce543c-1825-47cb-a18c-52744faecb10/ratis/d2215030-9ee5-4502-aa43-71ee7d08487a does not exist. Creating ...
2019-06-18 08:55:34,466 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd8ce543c-1825-47cb-a18c-52744faecb10/ratis/d2215030-9ee5-4502-aa43-71ee7d08487a/in_use.lock acquired by nodename 4311@ozone-unit-076618677d3c25pc-3638826206
2019-06-18 08:55:34,476 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd8ce543c-1825-47cb-a18c-52744faecb10/ratis/d2215030-9ee5-4502-aa43-71ee7d08487a has been successfully formatted.
2019-06-18 08:55:34,479 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 08:55:34,479 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 08:55:34,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 08:55:34,484 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 08:55:34,488 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 08:55:34,493 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 08:55:34,496 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new be649b9c-87c3-4459-a56b-efcbd7414691-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd8ce543c-1825-47cb-a18c-52744faecb10/ratis/d2215030-9ee5-4502-aa43-71ee7d08487a
2019-06-18 08:55:34,497 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 08:55:34,498 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 08:55:34,500 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 08:55:34,500 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 08:55:34,501 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 08:55:34,501 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 08:55:34,502 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 08:55:34,503 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 08:55:34,503 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 08:55:34,505 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 08:55:34,512 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 08:55:34,513 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 08:55:34,513 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 08:55:34,635 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - be649b9c-87c3-4459-a56b-efcbd7414691: start group-71EE7D08487A
2019-06-18 08:55:34,636 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - be649b9c-87c3-4459-a56b-efcbd7414691:group-71EE7D08487A changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 08:55:34,638 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - be649b9c-87c3-4459-a56b-efcbd7414691: start FollowerState
2019-06-18 08:55:34,642 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-71EE7D08487A,id=be649b9c-87c3-4459-a56b-efcbd7414691
2019-06-18 08:55:35,822 INFO  impl.FollowerState (FollowerState.java:run(101)) - be649b9c-87c3-4459-a56b-efcbd7414691:group-71EE7D08487A changes to CANDIDATE, lastRpcTime:1185, electionTimeout:1179ms
2019-06-18 08:55:35,822 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - be649b9c-87c3-4459-a56b-efcbd7414691: shutdown FollowerState
2019-06-18 08:55:35,822 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - be649b9c-87c3-4459-a56b-efcbd7414691:group-71EE7D08487A changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 08:55:35,824 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - be649b9c-87c3-4459-a56b-efcbd7414691: start LeaderElection
2019-06-18 08:55:35,828 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - be649b9c-87c3-4459-a56b-efcbd7414691:group-71EE7D08487A:LeaderElection1: begin an election at term 1 for -1: [be649b9c-87c3-4459-a56b-efcbd7414691:127.0.0.1:43583], old=null
2019-06-18 08:55:35,828 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - be649b9c-87c3-4459-a56b-efcbd7414691: shutdown LeaderElection
2019-06-18 08:55:35,829 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - be649b9c-87c3-4459-a56b-efcbd7414691:group-71EE7D08487A changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 08:55:35,829 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - be649b9c-87c3-4459-a56b-efcbd7414691:group-71EE7D08487A change Leader from null to be649b9c-87c3-4459-a56b-efcbd7414691 at term 1 for becomeLeader, leader elected after 1349ms
2019-06-18 08:55:35,832 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 08:55:35,832 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 08:55:35,834 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 08:55:35,835 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 08:55:35,844 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - be649b9c-87c3-4459-a56b-efcbd7414691: start LeaderState
2019-06-18 08:55:35,859 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - be649b9c-87c3-4459-a56b-efcbd7414691-RaftLogWorker: Starting segment from index:0
2019-06-18 08:55:35,865 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - be649b9c-87c3-4459-a56b-efcbd7414691:group-71EE7D08487A set configuration 0: [be649b9c-87c3-4459-a56b-efcbd7414691:127.0.0.1:43583], old=null at 0
2019-06-18 08:55:35,996 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - be649b9c-87c3-4459-a56b-efcbd7414691-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd8ce543c-1825-47cb-a18c-52744faecb10/ratis/d2215030-9ee5-4502-aa43-71ee7d08487a/current/log_inprogress_0
2019-06-18 08:55:36,876 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-18 08:55:36,936 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 5029733280869430418 is closed with bcsId 0.
2019-06-18 08:55:36,937 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 08:55:36,938 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - be649b9c-87c3-4459-a56b-efcbd7414691: close
2019-06-18 08:55:36,939 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - be649b9c-87c3-4459-a56b-efcbd7414691: shutdown group-71EE7D08487A
2019-06-18 08:55:36,939 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-71EE7D08487A,id=be649b9c-87c3-4459-a56b-efcbd7414691
2019-06-18 08:55:36,939 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - be649b9c-87c3-4459-a56b-efcbd7414691: shutdown LeaderState
2019-06-18 08:55:36,940 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - be649b9c-87c3-4459-a56b-efcbd7414691-PendingRequests: sendNotLeaderResponses
2019-06-18 08:55:36,943 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-be649b9c-87c3-4459-a56b-efcbd7414691-group-71EE7D08487A: set stopIndex = 4
2019-06-18 08:55:36,943 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-18 08:55:36,943 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlerd8ce543c-1825-47cb-a18c-52744faecb10/ratis/d2215030-9ee5-4502-aa43-71ee7d08487a/sm/snapshot.1_4
2019-06-18 08:55:36,953 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - be649b9c-87c3-4459-a56b-efcbd7414691:group-71EE7D08487A closes. The last applied log index is 4
2019-06-18 08:55:36,954 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - be649b9c-87c3-4459-a56b-efcbd7414691-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 08:55:36,955 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - be649b9c-87c3-4459-a56b-efcbd7414691-RaftLogWorker close()
2019-06-18 08:55:36,957 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - be649b9c-87c3-4459-a56b-efcbd7414691: shutdown server with port 43583 now
2019-06-18 08:55:36,960 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - be649b9c-87c3-4459-a56b-efcbd7414691: shutdown server with port 43583 successfully
2019-06-18 08:55:36,967 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-18 08:55:36,994 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere779cbd4-d05e-46de-9813-1c316ee567ac/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 08:55:36,994 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere779cbd4-d05e-46de-9813-1c316ee567ac/hdds to VolumeSet
2019-06-18 08:55:36,995 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@c6e0f32
2019-06-18 08:55:36,995 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@c6e0f32
2019-06-18 08:55:37,008 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 42147
2019-06-18 08:55:37,008 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 08:55:37,009 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 08:55:37,010 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42147 (custom)
2019-06-18 08:55:37,010 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 08:55:37,010 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 08:55:37,010 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 08:55:37,011 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 08:55:37,012 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere779cbd4-d05e-46de-9813-1c316ee567ac/ratis] (custom)
2019-06-18 08:55:37,012 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 37445
2019-06-18 08:55:37,012 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 08:55:37,013 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 08:55:37,013 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis a4807f12-f759-4dea-8b22-fd26dacd0e92 at port 42147
2019-06-18 08:55:37,030 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - a4807f12-f759-4dea-8b22-fd26dacd0e92: start RPC server
2019-06-18 08:55:37,031 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - a4807f12-f759-4dea-8b22-fd26dacd0e92: GrpcService started, listening on 0.0.0.0/0.0.0.0:42147
2019-06-18 08:55:37,043 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - a4807f12-f759-4dea-8b22-fd26dacd0e92: addNew group-E0F98291D0FC:[a4807f12-f759-4dea-8b22-fd26dacd0e92:127.0.0.1:42147] returns group-E0F98291D0FC:java.util.concurrent.CompletableFuture@65dc35b3[Not completed]
2019-06-18 08:55:37,044 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - a4807f12-f759-4dea-8b22-fd26dacd0e92: new RaftServerImpl for group-E0F98291D0FC:[a4807f12-f759-4dea-8b22-fd26dacd0e92:127.0.0.1:42147] with ContainerStateMachine:uninitialized
2019-06-18 08:55:37,044 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 08:55:37,044 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 08:55:37,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 08:55:37,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 08:55:37,045 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - a4807f12-f759-4dea-8b22-fd26dacd0e92:group-E0F98291D0FC ConfigurationManager, init=-1: [a4807f12-f759-4dea-8b22-fd26dacd0e92:127.0.0.1:42147], old=null, confs=<EMPTY_MAP>
2019-06-18 08:55:37,045 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere779cbd4-d05e-46de-9813-1c316ee567ac/ratis] (custom)
2019-06-18 08:55:37,045 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere779cbd4-d05e-46de-9813-1c316ee567ac/ratis/4809449a-738a-4718-9cf0-e0f98291d0fc does not exist. Creating ...
2019-06-18 08:55:37,048 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere779cbd4-d05e-46de-9813-1c316ee567ac/ratis/4809449a-738a-4718-9cf0-e0f98291d0fc/in_use.lock acquired by nodename 4311@ozone-unit-076618677d3c25pc-3638826206
2019-06-18 08:55:37,051 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere779cbd4-d05e-46de-9813-1c316ee567ac/ratis/4809449a-738a-4718-9cf0-e0f98291d0fc has been successfully formatted.
2019-06-18 08:55:37,051 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 08:55:37,051 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 08:55:37,051 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 08:55:37,051 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 08:55:37,051 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 08:55:37,052 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 08:55:37,052 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new a4807f12-f759-4dea-8b22-fd26dacd0e92-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere779cbd4-d05e-46de-9813-1c316ee567ac/ratis/4809449a-738a-4718-9cf0-e0f98291d0fc
2019-06-18 08:55:37,052 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 08:55:37,052 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 08:55:37,052 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 08:55:37,052 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 08:55:37,053 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 08:55:37,053 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 08:55:37,053 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 08:55:37,053 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 08:55:37,053 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 08:55:37,053 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 08:55:37,054 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 08:55:37,054 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 08:55:37,054 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 08:55:37,054 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - a4807f12-f759-4dea-8b22-fd26dacd0e92: start group-E0F98291D0FC
2019-06-18 08:55:37,054 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a4807f12-f759-4dea-8b22-fd26dacd0e92:group-E0F98291D0FC changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 08:55:37,055 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a4807f12-f759-4dea-8b22-fd26dacd0e92: start FollowerState
2019-06-18 08:55:37,055 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-E0F98291D0FC,id=a4807f12-f759-4dea-8b22-fd26dacd0e92
2019-06-18 08:55:38,158 INFO  impl.FollowerState (FollowerState.java:run(101)) - a4807f12-f759-4dea-8b22-fd26dacd0e92:group-E0F98291D0FC changes to CANDIDATE, lastRpcTime:1103, electionTimeout:1103ms
2019-06-18 08:55:38,158 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - a4807f12-f759-4dea-8b22-fd26dacd0e92: shutdown FollowerState
2019-06-18 08:55:38,158 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a4807f12-f759-4dea-8b22-fd26dacd0e92:group-E0F98291D0FC changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 08:55:38,159 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a4807f12-f759-4dea-8b22-fd26dacd0e92: start LeaderElection
2019-06-18 08:55:38,162 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - a4807f12-f759-4dea-8b22-fd26dacd0e92:group-E0F98291D0FC:LeaderElection2: begin an election at term 1 for -1: [a4807f12-f759-4dea-8b22-fd26dacd0e92:127.0.0.1:42147], old=null
2019-06-18 08:55:38,163 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - a4807f12-f759-4dea-8b22-fd26dacd0e92: shutdown LeaderElection
2019-06-18 08:55:38,163 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - a4807f12-f759-4dea-8b22-fd26dacd0e92:group-E0F98291D0FC changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 08:55:38,163 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - a4807f12-f759-4dea-8b22-fd26dacd0e92:group-E0F98291D0FC change Leader from null to a4807f12-f759-4dea-8b22-fd26dacd0e92 at term 1 for becomeLeader, leader elected after 1111ms
2019-06-18 08:55:38,163 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 08:55:38,163 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 08:55:38,163 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 08:55:38,163 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 08:55:38,164 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - a4807f12-f759-4dea-8b22-fd26dacd0e92: start LeaderState
2019-06-18 08:55:38,164 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - a4807f12-f759-4dea-8b22-fd26dacd0e92-RaftLogWorker: Starting segment from index:0
2019-06-18 08:55:38,167 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - a4807f12-f759-4dea-8b22-fd26dacd0e92:group-E0F98291D0FC set configuration 0: [a4807f12-f759-4dea-8b22-fd26dacd0e92:127.0.0.1:42147], old=null at 0
2019-06-18 08:55:38,205 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - a4807f12-f759-4dea-8b22-fd26dacd0e92-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere779cbd4-d05e-46de-9813-1c316ee567ac/ratis/4809449a-738a-4718-9cf0-e0f98291d0fc/current/log_inprogress_0
2019-06-18 08:55:39,095 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 08:55:39,105 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - a4807f12-f759-4dea-8b22-fd26dacd0e92: close
2019-06-18 08:55:39,106 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - a4807f12-f759-4dea-8b22-fd26dacd0e92: shutdown group-E0F98291D0FC
2019-06-18 08:55:39,106 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-E0F98291D0FC,id=a4807f12-f759-4dea-8b22-fd26dacd0e92
2019-06-18 08:55:39,106 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - a4807f12-f759-4dea-8b22-fd26dacd0e92: shutdown LeaderState
2019-06-18 08:55:39,107 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - a4807f12-f759-4dea-8b22-fd26dacd0e92-PendingRequests: sendNotLeaderResponses
2019-06-18 08:55:39,107 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-a4807f12-f759-4dea-8b22-fd26dacd0e92-group-E0F98291D0FC: set stopIndex = 2
2019-06-18 08:55:39,107 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-18 08:55:39,108 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere779cbd4-d05e-46de-9813-1c316ee567ac/ratis/4809449a-738a-4718-9cf0-e0f98291d0fc/sm/snapshot.1_2
2019-06-18 08:55:39,108 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - a4807f12-f759-4dea-8b22-fd26dacd0e92:group-E0F98291D0FC closes. The last applied log index is 2
2019-06-18 08:55:39,109 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - a4807f12-f759-4dea-8b22-fd26dacd0e92-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 08:55:39,109 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - a4807f12-f759-4dea-8b22-fd26dacd0e92-RaftLogWorker close()
2019-06-18 08:55:39,110 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - a4807f12-f759-4dea-8b22-fd26dacd0e92: shutdown server with port 42147 now
2019-06-18 08:55:39,112 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - a4807f12-f759-4dea-8b22-fd26dacd0e92: shutdown server with port 42147 successfully
2019-06-18 08:55:39,116 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-18 08:55:39,142 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleref7e6e33-7eb3-439f-b142-310b44cca408/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 08:55:39,143 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleref7e6e33-7eb3-439f-b142-310b44cca408/hdds to VolumeSet
2019-06-18 08:55:39,143 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@10ee04df
2019-06-18 08:55:39,143 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@10ee04df
2019-06-18 08:55:39,157 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 34765
2019-06-18 08:55:39,158 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 08:55:39,159 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 08:55:39,159 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 34765 (custom)
2019-06-18 08:55:39,159 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 08:55:39,160 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 08:55:39,160 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 08:55:39,160 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 08:55:39,161 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleref7e6e33-7eb3-439f-b142-310b44cca408/ratis] (custom)
2019-06-18 08:55:39,162 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 35323
2019-06-18 08:55:39,162 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 08:55:39,162 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 08:55:39,162 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 894df696-b469-4828-96de-787af46719af at port 34765
2019-06-18 08:55:39,172 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 894df696-b469-4828-96de-787af46719af: start RPC server
2019-06-18 08:55:39,173 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 894df696-b469-4828-96de-787af46719af: GrpcService started, listening on 0.0.0.0/0.0.0.0:34765
2019-06-18 08:55:39,181 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 894df696-b469-4828-96de-787af46719af: addNew group-B49CB8B565CE:[894df696-b469-4828-96de-787af46719af:127.0.0.1:34765] returns group-B49CB8B565CE:java.util.concurrent.CompletableFuture@44bca4d[Not completed]
2019-06-18 08:55:39,182 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 894df696-b469-4828-96de-787af46719af: new RaftServerImpl for group-B49CB8B565CE:[894df696-b469-4828-96de-787af46719af:127.0.0.1:34765] with ContainerStateMachine:uninitialized
2019-06-18 08:55:39,182 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 08:55:39,182 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 08:55:39,183 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 08:55:39,183 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 08:55:39,183 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 894df696-b469-4828-96de-787af46719af:group-B49CB8B565CE ConfigurationManager, init=-1: [894df696-b469-4828-96de-787af46719af:127.0.0.1:34765], old=null, confs=<EMPTY_MAP>
2019-06-18 08:55:39,183 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleref7e6e33-7eb3-439f-b142-310b44cca408/ratis] (custom)
2019-06-18 08:55:39,183 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleref7e6e33-7eb3-439f-b142-310b44cca408/ratis/e7c709af-7675-49e2-a80d-b49cb8b565ce does not exist. Creating ...
2019-06-18 08:55:39,187 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleref7e6e33-7eb3-439f-b142-310b44cca408/ratis/e7c709af-7675-49e2-a80d-b49cb8b565ce/in_use.lock acquired by nodename 4311@ozone-unit-076618677d3c25pc-3638826206
2019-06-18 08:55:39,189 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleref7e6e33-7eb3-439f-b142-310b44cca408/ratis/e7c709af-7675-49e2-a80d-b49cb8b565ce has been successfully formatted.
2019-06-18 08:55:39,189 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 08:55:39,189 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 08:55:39,189 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 08:55:39,190 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 08:55:39,190 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 08:55:39,190 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 08:55:39,190 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 894df696-b469-4828-96de-787af46719af-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleref7e6e33-7eb3-439f-b142-310b44cca408/ratis/e7c709af-7675-49e2-a80d-b49cb8b565ce
2019-06-18 08:55:39,190 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 08:55:39,190 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 08:55:39,190 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 08:55:39,190 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 08:55:39,190 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 08:55:39,190 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 08:55:39,190 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 08:55:39,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 08:55:39,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 08:55:39,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 08:55:39,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 08:55:39,191 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 08:55:39,192 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 08:55:39,192 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 894df696-b469-4828-96de-787af46719af: start group-B49CB8B565CE
2019-06-18 08:55:39,192 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 894df696-b469-4828-96de-787af46719af:group-B49CB8B565CE changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 08:55:39,192 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 894df696-b469-4828-96de-787af46719af: start FollowerState
2019-06-18 08:55:39,192 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-B49CB8B565CE,id=894df696-b469-4828-96de-787af46719af
2019-06-18 08:55:40,261 INFO  impl.FollowerState (FollowerState.java:run(101)) - 894df696-b469-4828-96de-787af46719af:group-B49CB8B565CE changes to CANDIDATE, lastRpcTime:1069, electionTimeout:1069ms
2019-06-18 08:55:40,261 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 894df696-b469-4828-96de-787af46719af: shutdown FollowerState
2019-06-18 08:55:40,261 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 894df696-b469-4828-96de-787af46719af:group-B49CB8B565CE changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 08:55:40,262 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 894df696-b469-4828-96de-787af46719af: start LeaderElection
2019-06-18 08:55:40,267 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 894df696-b469-4828-96de-787af46719af:group-B49CB8B565CE:LeaderElection3: begin an election at term 1 for -1: [894df696-b469-4828-96de-787af46719af:127.0.0.1:34765], old=null
2019-06-18 08:55:40,267 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 894df696-b469-4828-96de-787af46719af: shutdown LeaderElection
2019-06-18 08:55:40,267 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 894df696-b469-4828-96de-787af46719af:group-B49CB8B565CE changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 08:55:40,267 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 894df696-b469-4828-96de-787af46719af:group-B49CB8B565CE change Leader from null to 894df696-b469-4828-96de-787af46719af at term 1 for becomeLeader, leader elected after 1078ms
2019-06-18 08:55:40,268 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 08:55:40,268 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 08:55:40,268 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 08:55:40,268 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 08:55:40,268 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 894df696-b469-4828-96de-787af46719af: start LeaderState
2019-06-18 08:55:40,268 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 894df696-b469-4828-96de-787af46719af-RaftLogWorker: Starting segment from index:0
2019-06-18 08:55:40,275 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 894df696-b469-4828-96de-787af46719af:group-B49CB8B565CE set configuration 0: [894df696-b469-4828-96de-787af46719af:127.0.0.1:34765], old=null at 0
2019-06-18 08:55:40,319 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 894df696-b469-4828-96de-787af46719af-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleref7e6e33-7eb3-439f-b142-310b44cca408/ratis/e7c709af-7675-49e2-a80d-b49cb8b565ce/current/log_inprogress_0
2019-06-18 08:55:41,240 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 7834535388278026598 is closed with bcsId 0.
2019-06-18 08:55:41,240 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 08:55:41,241 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 894df696-b469-4828-96de-787af46719af: close
2019-06-18 08:55:41,241 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 894df696-b469-4828-96de-787af46719af: shutdown group-B49CB8B565CE
2019-06-18 08:55:41,241 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-B49CB8B565CE,id=894df696-b469-4828-96de-787af46719af
2019-06-18 08:55:41,242 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 894df696-b469-4828-96de-787af46719af: shutdown LeaderState
2019-06-18 08:55:41,242 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 894df696-b469-4828-96de-787af46719af-PendingRequests: sendNotLeaderResponses
2019-06-18 08:55:41,243 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-894df696-b469-4828-96de-787af46719af-group-B49CB8B565CE: set stopIndex = 2
2019-06-18 08:55:41,243 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-18 08:55:41,243 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandleref7e6e33-7eb3-439f-b142-310b44cca408/ratis/e7c709af-7675-49e2-a80d-b49cb8b565ce/sm/snapshot.1_2
2019-06-18 08:55:41,243 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 894df696-b469-4828-96de-787af46719af:group-B49CB8B565CE closes. The last applied log index is 2
2019-06-18 08:55:41,244 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 894df696-b469-4828-96de-787af46719af-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 08:55:41,244 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 894df696-b469-4828-96de-787af46719af-RaftLogWorker close()
2019-06-18 08:55:41,245 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 894df696-b469-4828-96de-787af46719af: shutdown server with port 34765 now
2019-06-18 08:55:41,247 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 894df696-b469-4828-96de-787af46719af: shutdown server with port 34765 successfully
2019-06-18 08:55:41,252 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-18 08:55:41,286 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler15d345ce-e191-473b-a1e4-3ad401f01930/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 08:55:41,286 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler15d345ce-e191-473b-a1e4-3ad401f01930/hdds to VolumeSet
2019-06-18 08:55:41,286 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3f1ddac2
2019-06-18 08:55:41,289 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3f1ddac2
2019-06-18 08:55:41,297 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 41117
2019-06-18 08:55:41,298 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 08:55:41,299 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 08:55:41,299 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 41117 (custom)
2019-06-18 08:55:41,299 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 08:55:41,299 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 08:55:41,299 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 08:55:41,299 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 08:55:41,300 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler15d345ce-e191-473b-a1e4-3ad401f01930/ratis] (custom)
2019-06-18 08:55:41,300 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 40711
2019-06-18 08:55:41,300 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 08:55:41,301 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 08:55:41,301 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis b228d45a-17d6-4eb0-b7f4-f3636c606888 at port 41117
2019-06-18 08:55:41,311 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - b228d45a-17d6-4eb0-b7f4-f3636c606888: start RPC server
2019-06-18 08:55:41,312 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - b228d45a-17d6-4eb0-b7f4-f3636c606888: GrpcService started, listening on 0.0.0.0/0.0.0.0:41117
Jun 18, 2019 8:55:41 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:42147} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 18, 2019 8:55:41 AM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:34765} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-18 08:55:41,327 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - b228d45a-17d6-4eb0-b7f4-f3636c606888: addNew group-226B550941BA:[b228d45a-17d6-4eb0-b7f4-f3636c606888:127.0.0.1:41117] returns group-226B550941BA:java.util.concurrent.CompletableFuture@39e4e075[Not completed]
2019-06-18 08:55:41,328 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - b228d45a-17d6-4eb0-b7f4-f3636c606888: new RaftServerImpl for group-226B550941BA:[b228d45a-17d6-4eb0-b7f4-f3636c606888:127.0.0.1:41117] with ContainerStateMachine:uninitialized
2019-06-18 08:55:41,328 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 08:55:41,328 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 08:55:41,328 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 08:55:41,328 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 08:55:41,328 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - b228d45a-17d6-4eb0-b7f4-f3636c606888:group-226B550941BA ConfigurationManager, init=-1: [b228d45a-17d6-4eb0-b7f4-f3636c606888:127.0.0.1:41117], old=null, confs=<EMPTY_MAP>
2019-06-18 08:55:41,328 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler15d345ce-e191-473b-a1e4-3ad401f01930/ratis] (custom)
2019-06-18 08:55:41,329 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler15d345ce-e191-473b-a1e4-3ad401f01930/ratis/993ff6d8-a03c-443e-a8d9-226b550941ba does not exist. Creating ...
2019-06-18 08:55:41,332 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler15d345ce-e191-473b-a1e4-3ad401f01930/ratis/993ff6d8-a03c-443e-a8d9-226b550941ba/in_use.lock acquired by nodename 4311@ozone-unit-076618677d3c25pc-3638826206
2019-06-18 08:55:41,334 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler15d345ce-e191-473b-a1e4-3ad401f01930/ratis/993ff6d8-a03c-443e-a8d9-226b550941ba has been successfully formatted.
2019-06-18 08:55:41,334 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 08:55:41,334 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 08:55:41,334 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 08:55:41,334 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 08:55:41,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 08:55:41,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 08:55:41,335 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new b228d45a-17d6-4eb0-b7f4-f3636c606888-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler15d345ce-e191-473b-a1e4-3ad401f01930/ratis/993ff6d8-a03c-443e-a8d9-226b550941ba
2019-06-18 08:55:41,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 08:55:41,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 08:55:41,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 08:55:41,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 08:55:41,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 08:55:41,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 08:55:41,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 08:55:41,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 08:55:41,335 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 08:55:41,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 08:55:41,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 08:55:41,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 08:55:41,336 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 08:55:41,336 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - b228d45a-17d6-4eb0-b7f4-f3636c606888: start group-226B550941BA
2019-06-18 08:55:41,337 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b228d45a-17d6-4eb0-b7f4-f3636c606888:group-226B550941BA changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 08:55:41,337 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b228d45a-17d6-4eb0-b7f4-f3636c606888: start FollowerState
2019-06-18 08:55:41,337 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-226B550941BA,id=b228d45a-17d6-4eb0-b7f4-f3636c606888
2019-06-18 08:55:42,514 INFO  impl.FollowerState (FollowerState.java:run(101)) - b228d45a-17d6-4eb0-b7f4-f3636c606888:group-226B550941BA changes to CANDIDATE, lastRpcTime:1177, electionTimeout:1177ms
2019-06-18 08:55:42,514 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b228d45a-17d6-4eb0-b7f4-f3636c606888: shutdown FollowerState
2019-06-18 08:55:42,514 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b228d45a-17d6-4eb0-b7f4-f3636c606888:group-226B550941BA changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 08:55:42,514 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b228d45a-17d6-4eb0-b7f4-f3636c606888: start LeaderElection
2019-06-18 08:55:42,519 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b228d45a-17d6-4eb0-b7f4-f3636c606888:group-226B550941BA:LeaderElection4: begin an election at term 1 for -1: [b228d45a-17d6-4eb0-b7f4-f3636c606888:127.0.0.1:41117], old=null
2019-06-18 08:55:42,519 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b228d45a-17d6-4eb0-b7f4-f3636c606888: shutdown LeaderElection
2019-06-18 08:55:42,519 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b228d45a-17d6-4eb0-b7f4-f3636c606888:group-226B550941BA changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 08:55:42,519 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - b228d45a-17d6-4eb0-b7f4-f3636c606888:group-226B550941BA change Leader from null to b228d45a-17d6-4eb0-b7f4-f3636c606888 at term 1 for becomeLeader, leader elected after 1185ms
2019-06-18 08:55:42,519 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 08:55:42,519 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 08:55:42,520 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 08:55:42,520 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 08:55:42,520 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b228d45a-17d6-4eb0-b7f4-f3636c606888: start LeaderState
2019-06-18 08:55:42,520 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - b228d45a-17d6-4eb0-b7f4-f3636c606888-RaftLogWorker: Starting segment from index:0
2019-06-18 08:55:42,540 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - b228d45a-17d6-4eb0-b7f4-f3636c606888:group-226B550941BA set configuration 0: [b228d45a-17d6-4eb0-b7f4-f3636c606888:127.0.0.1:41117], old=null at 0
2019-06-18 08:55:42,561 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - b228d45a-17d6-4eb0-b7f4-f3636c606888-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler15d345ce-e191-473b-a1e4-3ad401f01930/ratis/993ff6d8-a03c-443e-a8d9-226b550941ba/current/log_inprogress_0
2019-06-18 08:55:43,378 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 3008802993828593924 is closed with bcsId 0.
2019-06-18 08:55:43,379 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 08:55:43,379 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - b228d45a-17d6-4eb0-b7f4-f3636c606888: close
2019-06-18 08:55:43,380 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - b228d45a-17d6-4eb0-b7f4-f3636c606888: shutdown group-226B550941BA
2019-06-18 08:55:43,380 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-226B550941BA,id=b228d45a-17d6-4eb0-b7f4-f3636c606888
2019-06-18 08:55:43,380 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - b228d45a-17d6-4eb0-b7f4-f3636c606888: shutdown LeaderState
2019-06-18 08:55:43,380 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - b228d45a-17d6-4eb0-b7f4-f3636c606888-PendingRequests: sendNotLeaderResponses
2019-06-18 08:55:43,382 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-b228d45a-17d6-4eb0-b7f4-f3636c606888-group-226B550941BA: set stopIndex = 2
2019-06-18 08:55:43,382 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-18 08:55:43,382 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler15d345ce-e191-473b-a1e4-3ad401f01930/ratis/993ff6d8-a03c-443e-a8d9-226b550941ba/sm/snapshot.1_2
2019-06-18 08:55:43,382 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - b228d45a-17d6-4eb0-b7f4-f3636c606888:group-226B550941BA closes. The last applied log index is 2
2019-06-18 08:55:43,383 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - b228d45a-17d6-4eb0-b7f4-f3636c606888-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 08:55:43,383 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - b228d45a-17d6-4eb0-b7f4-f3636c606888-RaftLogWorker close()
2019-06-18 08:55:43,384 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - b228d45a-17d6-4eb0-b7f4-f3636c606888: shutdown server with port 41117 now
2019-06-18 08:55:43,386 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - b228d45a-17d6-4eb0-b7f4-f3636c606888: shutdown server with port 41117 successfully
2019-06-18 08:55:43,387 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-18 08:55:43,415 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1485b361-cf32-466a-8aa4-7f9373582480/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 08:55:43,415 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1485b361-cf32-466a-8aa4-7f9373582480/hdds to VolumeSet
2019-06-18 08:55:43,416 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@5ae95707
2019-06-18 08:55:43,417 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@5ae95707
2019-06-18 08:55:43,429 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 33435
2019-06-18 08:55:43,430 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 08:55:43,431 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 08:55:43,431 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 33435 (custom)
2019-06-18 08:55:43,431 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 08:55:43,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 08:55:43,432 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 08:55:43,432 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 08:55:43,433 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1485b361-cf32-466a-8aa4-7f9373582480/ratis] (custom)
2019-06-18 08:55:43,433 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 35085
2019-06-18 08:55:43,433 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 08:55:43,434 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 08:55:43,434 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis b1011e6f-f48d-435b-ac1c-73a3aea68af4 at port 33435
2019-06-18 08:55:43,441 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4: start RPC server
2019-06-18 08:55:43,442 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4: GrpcService started, listening on 0.0.0.0/0.0.0.0:33435
2019-06-18 08:55:43,453 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4: addNew group-CF740D9B8592:[b1011e6f-f48d-435b-ac1c-73a3aea68af4:127.0.0.1:33435] returns group-CF740D9B8592:java.util.concurrent.CompletableFuture@4fffa2ac[Not completed]
2019-06-18 08:55:43,454 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4: new RaftServerImpl for group-CF740D9B8592:[b1011e6f-f48d-435b-ac1c-73a3aea68af4:127.0.0.1:33435] with ContainerStateMachine:uninitialized
2019-06-18 08:55:43,454 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 08:55:43,454 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 08:55:43,454 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 08:55:43,454 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 08:55:43,454 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4:group-CF740D9B8592 ConfigurationManager, init=-1: [b1011e6f-f48d-435b-ac1c-73a3aea68af4:127.0.0.1:33435], old=null, confs=<EMPTY_MAP>
2019-06-18 08:55:43,454 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1485b361-cf32-466a-8aa4-7f9373582480/ratis] (custom)
2019-06-18 08:55:43,455 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1485b361-cf32-466a-8aa4-7f9373582480/ratis/a4419061-da7b-4270-9fec-cf740d9b8592 does not exist. Creating ...
2019-06-18 08:55:43,458 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1485b361-cf32-466a-8aa4-7f9373582480/ratis/a4419061-da7b-4270-9fec-cf740d9b8592/in_use.lock acquired by nodename 4311@ozone-unit-076618677d3c25pc-3638826206
2019-06-18 08:55:43,460 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1485b361-cf32-466a-8aa4-7f9373582480/ratis/a4419061-da7b-4270-9fec-cf740d9b8592 has been successfully formatted.
2019-06-18 08:55:43,460 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 08:55:43,460 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 08:55:43,460 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 08:55:43,460 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 08:55:43,460 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 08:55:43,460 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 08:55:43,460 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new b1011e6f-f48d-435b-ac1c-73a3aea68af4-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1485b361-cf32-466a-8aa4-7f9373582480/ratis/a4419061-da7b-4270-9fec-cf740d9b8592
2019-06-18 08:55:43,461 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 08:55:43,461 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 08:55:43,461 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 08:55:43,461 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 08:55:43,461 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 08:55:43,462 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 08:55:43,462 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 08:55:43,462 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 08:55:43,462 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 08:55:43,462 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 08:55:43,462 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 08:55:43,463 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 08:55:43,463 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 08:55:43,463 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4: start group-CF740D9B8592
2019-06-18 08:55:43,463 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4:group-CF740D9B8592 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 08:55:43,463 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4: start FollowerState
2019-06-18 08:55:43,463 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-CF740D9B8592,id=b1011e6f-f48d-435b-ac1c-73a3aea68af4
2019-06-18 08:55:44,507 INFO  impl.FollowerState (FollowerState.java:run(101)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4:group-CF740D9B8592 changes to CANDIDATE, lastRpcTime:1044, electionTimeout:1044ms
2019-06-18 08:55:44,508 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4: shutdown FollowerState
2019-06-18 08:55:44,508 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4:group-CF740D9B8592 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 08:55:44,508 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4: start LeaderElection
2019-06-18 08:55:44,513 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4:group-CF740D9B8592:LeaderElection5: begin an election at term 1 for -1: [b1011e6f-f48d-435b-ac1c-73a3aea68af4:127.0.0.1:33435], old=null
2019-06-18 08:55:44,513 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4: shutdown LeaderElection
2019-06-18 08:55:44,513 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4:group-CF740D9B8592 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 08:55:44,513 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4:group-CF740D9B8592 change Leader from null to b1011e6f-f48d-435b-ac1c-73a3aea68af4 at term 1 for becomeLeader, leader elected after 1053ms
2019-06-18 08:55:44,513 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 08:55:44,513 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 08:55:44,514 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 08:55:44,514 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 08:55:44,514 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4: start LeaderState
2019-06-18 08:55:44,514 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4-RaftLogWorker: Starting segment from index:0
2019-06-18 08:55:44,514 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4:group-CF740D9B8592 set configuration 0: [b1011e6f-f48d-435b-ac1c-73a3aea68af4:127.0.0.1:33435], old=null at 0
2019-06-18 08:55:44,550 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1485b361-cf32-466a-8aa4-7f9373582480/ratis/a4419061-da7b-4270-9fec-cf740d9b8592/current/log_inprogress_0
2019-06-18 08:55:45,504 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 2586278778405850089 is closed with bcsId 0.
2019-06-18 08:55:45,505 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 08:55:45,505 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4: close
2019-06-18 08:55:45,506 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4: shutdown group-CF740D9B8592
2019-06-18 08:55:45,506 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-CF740D9B8592,id=b1011e6f-f48d-435b-ac1c-73a3aea68af4
2019-06-18 08:55:45,506 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4: shutdown LeaderState
2019-06-18 08:55:45,507 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4-PendingRequests: sendNotLeaderResponses
2019-06-18 08:55:45,508 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-b1011e6f-f48d-435b-ac1c-73a3aea68af4-group-CF740D9B8592: set stopIndex = 4
2019-06-18 08:55:45,508 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-18 08:55:45,508 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler1485b361-cf32-466a-8aa4-7f9373582480/ratis/a4419061-da7b-4270-9fec-cf740d9b8592/sm/snapshot.1_4
2019-06-18 08:55:45,509 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4:group-CF740D9B8592 closes. The last applied log index is 4
2019-06-18 08:55:45,509 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 08:55:45,510 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4-RaftLogWorker close()
2019-06-18 08:55:45,511 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4: shutdown server with port 33435 now
2019-06-18 08:55:45,512 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - b1011e6f-f48d-435b-ac1c-73a3aea68af4: shutdown server with port 33435 successfully
2019-06-18 08:55:45,516 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
