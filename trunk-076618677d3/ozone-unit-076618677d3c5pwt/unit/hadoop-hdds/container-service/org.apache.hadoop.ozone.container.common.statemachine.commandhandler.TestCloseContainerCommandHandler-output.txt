2019-06-17 16:12:28,054 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5a73c570-6c14-4004-9132-5f1461e29905/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 16:12:28,058 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5a73c570-6c14-4004-9132-5f1461e29905/hdds to VolumeSet
2019-06-17 16:12:28,068 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-17 16:12:28,107 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-17 16:12:28,447 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 46217
2019-06-17 16:12:28,840 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 16:12:28,858 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 16:12:28,865 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 46217 (custom)
2019-06-17 16:12:28,866 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 16:12:28,867 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 16:12:28,868 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 16:12:28,868 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 16:12:28,979 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5a73c570-6c14-4004-9132-5f1461e29905/ratis] (custom)
2019-06-17 16:12:28,988 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 33101
2019-06-17 16:12:29,006 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 16:12:29,006 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 16:12:29,007 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17 at port 46217
2019-06-17 16:12:29,019 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17: start RPC server
2019-06-17 16:12:29,146 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17: GrpcService started, listening on 0.0.0.0/0.0.0.0:46217
2019-06-17 16:12:29,425 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17: addNew group-8C9CD3927CC9:[bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17:127.0.0.1:46217] returns group-8C9CD3927CC9:java.util.concurrent.CompletableFuture@6a65e08e[Not completed]
2019-06-17 16:12:29,453 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17: new RaftServerImpl for group-8C9CD3927CC9:[bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17:127.0.0.1:46217] with ContainerStateMachine:uninitialized
2019-06-17 16:12:29,454 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 16:12:29,454 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 16:12:29,454 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 16:12:29,455 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 16:12:29,459 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17:group-8C9CD3927CC9 ConfigurationManager, init=-1: [bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17:127.0.0.1:46217], old=null, confs=<EMPTY_MAP>
2019-06-17 16:12:29,459 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5a73c570-6c14-4004-9132-5f1461e29905/ratis] (custom)
2019-06-17 16:12:29,465 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5a73c570-6c14-4004-9132-5f1461e29905/ratis/694dfd7e-9977-4ec8-80ee-8c9cd3927cc9 does not exist. Creating ...
2019-06-17 16:12:29,474 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5a73c570-6c14-4004-9132-5f1461e29905/ratis/694dfd7e-9977-4ec8-80ee-8c9cd3927cc9/in_use.lock acquired by nodename 4299@ozone-unit-076618677d3c5pwt-2100892724
2019-06-17 16:12:29,480 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5a73c570-6c14-4004-9132-5f1461e29905/ratis/694dfd7e-9977-4ec8-80ee-8c9cd3927cc9 has been successfully formatted.
2019-06-17 16:12:29,482 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 16:12:29,482 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 16:12:29,484 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 16:12:29,485 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 16:12:29,488 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 16:12:29,491 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 16:12:29,493 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5a73c570-6c14-4004-9132-5f1461e29905/ratis/694dfd7e-9977-4ec8-80ee-8c9cd3927cc9
2019-06-17 16:12:29,493 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 16:12:29,494 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 16:12:29,495 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 16:12:29,495 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 16:12:29,496 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 16:12:29,496 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 16:12:29,497 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 16:12:29,497 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 16:12:29,497 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 16:12:29,499 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 16:12:29,503 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 16:12:29,504 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 16:12:29,504 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 16:12:29,615 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17: start group-8C9CD3927CC9
2019-06-17 16:12:29,616 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17:group-8C9CD3927CC9 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 16:12:29,618 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17: start FollowerState
2019-06-17 16:12:29,620 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-8C9CD3927CC9,id=bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17
2019-06-17 16:12:30,708 INFO  impl.FollowerState (FollowerState.java:run(101)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17:group-8C9CD3927CC9 changes to CANDIDATE, lastRpcTime:1090, electionTimeout:1090ms
2019-06-17 16:12:30,708 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17: shutdown FollowerState
2019-06-17 16:12:30,709 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17:group-8C9CD3927CC9 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 16:12:30,710 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17: start LeaderElection
2019-06-17 16:12:30,713 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17:group-8C9CD3927CC9:LeaderElection1: begin an election at term 1 for -1: [bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17:127.0.0.1:46217], old=null
2019-06-17 16:12:30,714 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17: shutdown LeaderElection
2019-06-17 16:12:30,715 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17:group-8C9CD3927CC9 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 16:12:30,715 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17:group-8C9CD3927CC9 change Leader from null to bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17 at term 1 for becomeLeader, leader elected after 1233ms
2019-06-17 16:12:30,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 16:12:30,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 16:12:30,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 16:12:30,720 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 16:12:30,729 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17: start LeaderState
2019-06-17 16:12:30,740 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17-RaftLogWorker: Starting segment from index:0
2019-06-17 16:12:30,746 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17:group-8C9CD3927CC9 set configuration 0: [bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17:127.0.0.1:46217], old=null at 0
2019-06-17 16:12:30,871 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5a73c570-6c14-4004-9132-5f1461e29905/ratis/694dfd7e-9977-4ec8-80ee-8c9cd3927cc9/current/log_inprogress_0
2019-06-17 16:12:31,829 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-17 16:12:31,891 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 3221274355608246264 is closed with bcsId 0.
2019-06-17 16:12:31,892 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 16:12:31,893 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17: close
2019-06-17 16:12:31,894 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17: shutdown group-8C9CD3927CC9
2019-06-17 16:12:31,894 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-8C9CD3927CC9,id=bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17
2019-06-17 16:12:31,894 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17: shutdown LeaderState
2019-06-17 16:12:31,895 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17-PendingRequests: sendNotLeaderResponses
2019-06-17 16:12:31,897 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17-group-8C9CD3927CC9: set stopIndex = 4
2019-06-17 16:12:31,897 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 16:12:31,897 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler5a73c570-6c14-4004-9132-5f1461e29905/ratis/694dfd7e-9977-4ec8-80ee-8c9cd3927cc9/sm/snapshot.1_4
2019-06-17 16:12:31,905 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17:group-8C9CD3927CC9 closes. The last applied log index is 4
2019-06-17 16:12:31,906 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 16:12:31,906 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17-RaftLogWorker close()
2019-06-17 16:12:31,907 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17: shutdown server with port 46217 now
2019-06-17 16:12:31,911 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - bb1c2c8f-4279-4c20-8bef-8a4ce9b11e17: shutdown server with port 46217 successfully
2019-06-17 16:12:31,918 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 16:12:31,949 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler16987fd1-5b62-4ff7-8e65-87b15b22c4c8/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 16:12:31,949 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler16987fd1-5b62-4ff7-8e65-87b15b22c4c8/hdds to VolumeSet
2019-06-17 16:12:31,949 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@6f7e336b
2019-06-17 16:12:31,950 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@6f7e336b
2019-06-17 16:12:31,959 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 38277
2019-06-17 16:12:31,959 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 16:12:31,960 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 16:12:31,960 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 38277 (custom)
2019-06-17 16:12:31,960 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 16:12:31,960 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 16:12:31,961 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 16:12:31,961 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 16:12:31,961 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler16987fd1-5b62-4ff7-8e65-87b15b22c4c8/ratis] (custom)
2019-06-17 16:12:31,962 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 38173
2019-06-17 16:12:31,962 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 16:12:31,962 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 16:12:31,962 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 947f72c5-2d7e-480f-b308-fb044c8bf4f9 at port 38277
2019-06-17 16:12:31,992 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9: start RPC server
2019-06-17 16:12:31,993 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9: GrpcService started, listening on 0.0.0.0/0.0.0.0:38277
2019-06-17 16:12:32,004 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9: addNew group-F452C555F162:[947f72c5-2d7e-480f-b308-fb044c8bf4f9:127.0.0.1:38277] returns group-F452C555F162:java.util.concurrent.CompletableFuture@3253b014[Not completed]
2019-06-17 16:12:32,007 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9: new RaftServerImpl for group-F452C555F162:[947f72c5-2d7e-480f-b308-fb044c8bf4f9:127.0.0.1:38277] with ContainerStateMachine:uninitialized
2019-06-17 16:12:32,007 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 16:12:32,007 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 16:12:32,007 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 16:12:32,007 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 16:12:32,008 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9:group-F452C555F162 ConfigurationManager, init=-1: [947f72c5-2d7e-480f-b308-fb044c8bf4f9:127.0.0.1:38277], old=null, confs=<EMPTY_MAP>
2019-06-17 16:12:32,008 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler16987fd1-5b62-4ff7-8e65-87b15b22c4c8/ratis] (custom)
2019-06-17 16:12:32,008 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler16987fd1-5b62-4ff7-8e65-87b15b22c4c8/ratis/d5821178-9b69-4f37-9a67-f452c555f162 does not exist. Creating ...
2019-06-17 16:12:32,010 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler16987fd1-5b62-4ff7-8e65-87b15b22c4c8/ratis/d5821178-9b69-4f37-9a67-f452c555f162/in_use.lock acquired by nodename 4299@ozone-unit-076618677d3c5pwt-2100892724
2019-06-17 16:12:32,013 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler16987fd1-5b62-4ff7-8e65-87b15b22c4c8/ratis/d5821178-9b69-4f37-9a67-f452c555f162 has been successfully formatted.
2019-06-17 16:12:32,013 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 16:12:32,013 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 16:12:32,013 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 16:12:32,014 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 16:12:32,014 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 16:12:32,014 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 16:12:32,014 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 947f72c5-2d7e-480f-b308-fb044c8bf4f9-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler16987fd1-5b62-4ff7-8e65-87b15b22c4c8/ratis/d5821178-9b69-4f37-9a67-f452c555f162
2019-06-17 16:12:32,014 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 16:12:32,015 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 16:12:32,015 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 16:12:32,015 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 16:12:32,015 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 16:12:32,015 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 16:12:32,015 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 16:12:32,016 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 16:12:32,016 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 16:12:32,016 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 16:12:32,018 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 16:12:32,018 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 16:12:32,018 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 16:12:32,018 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9: start group-F452C555F162
2019-06-17 16:12:32,019 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9:group-F452C555F162 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 16:12:32,019 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9: start FollowerState
2019-06-17 16:12:32,022 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-F452C555F162,id=947f72c5-2d7e-480f-b308-fb044c8bf4f9
2019-06-17 16:12:33,042 INFO  impl.FollowerState (FollowerState.java:run(101)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9:group-F452C555F162 changes to CANDIDATE, lastRpcTime:1023, electionTimeout:1020ms
2019-06-17 16:12:33,042 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9: shutdown FollowerState
2019-06-17 16:12:33,043 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9:group-F452C555F162 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 16:12:33,043 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9: start LeaderElection
2019-06-17 16:12:33,045 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9:group-F452C555F162:LeaderElection2: begin an election at term 1 for -1: [947f72c5-2d7e-480f-b308-fb044c8bf4f9:127.0.0.1:38277], old=null
2019-06-17 16:12:33,046 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9: shutdown LeaderElection
2019-06-17 16:12:33,046 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9:group-F452C555F162 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 16:12:33,046 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9:group-F452C555F162 change Leader from null to 947f72c5-2d7e-480f-b308-fb044c8bf4f9 at term 1 for becomeLeader, leader elected after 1032ms
2019-06-17 16:12:33,046 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 16:12:33,046 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 16:12:33,046 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 16:12:33,047 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 16:12:33,047 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9: start LeaderState
2019-06-17 16:12:33,047 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9-RaftLogWorker: Starting segment from index:0
2019-06-17 16:12:33,047 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9:group-F452C555F162 set configuration 0: [947f72c5-2d7e-480f-b308-fb044c8bf4f9:127.0.0.1:38277], old=null at 0
2019-06-17 16:12:33,083 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler16987fd1-5b62-4ff7-8e65-87b15b22c4c8/ratis/d5821178-9b69-4f37-9a67-f452c555f162/current/log_inprogress_0
2019-06-17 16:12:34,052 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 16:12:34,053 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9: close
2019-06-17 16:12:34,054 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9: shutdown group-F452C555F162
2019-06-17 16:12:34,054 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-F452C555F162,id=947f72c5-2d7e-480f-b308-fb044c8bf4f9
2019-06-17 16:12:34,055 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9: shutdown LeaderState
2019-06-17 16:12:34,055 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9-PendingRequests: sendNotLeaderResponses
2019-06-17 16:12:34,057 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 16:12:34,057 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler16987fd1-5b62-4ff7-8e65-87b15b22c4c8/ratis/d5821178-9b69-4f37-9a67-f452c555f162/sm/snapshot.1_2
2019-06-17 16:12:34,057 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-947f72c5-2d7e-480f-b308-fb044c8bf4f9-group-F452C555F162: set stopIndex = 2
2019-06-17 16:12:34,057 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9:group-F452C555F162 closes. The last applied log index is 2
2019-06-17 16:12:34,058 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 16:12:34,058 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9-RaftLogWorker close()
2019-06-17 16:12:34,059 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9: shutdown server with port 38277 now
2019-06-17 16:12:34,060 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 947f72c5-2d7e-480f-b308-fb044c8bf4f9: shutdown server with port 38277 successfully
2019-06-17 16:12:34,063 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 16:12:34,094 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera3ae53fe-e7d5-403a-9492-dd3a8458aa00/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 16:12:34,095 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera3ae53fe-e7d5-403a-9492-dd3a8458aa00/hdds to VolumeSet
2019-06-17 16:12:34,095 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1f51431
2019-06-17 16:12:34,099 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1f51431
2019-06-17 16:12:34,112 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 42119
2019-06-17 16:12:34,112 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 16:12:34,113 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 16:12:34,113 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 42119 (custom)
2019-06-17 16:12:34,113 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 16:12:34,113 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 16:12:34,114 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 16:12:34,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 16:12:34,114 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera3ae53fe-e7d5-403a-9492-dd3a8458aa00/ratis] (custom)
2019-06-17 16:12:34,115 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 46769
2019-06-17 16:12:34,115 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 16:12:34,115 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 16:12:34,116 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis b488d7e8-d816-4f83-b5af-4a8d3baf8159 at port 42119
2019-06-17 16:12:34,122 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159: start RPC server
2019-06-17 16:12:34,123 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159: GrpcService started, listening on 0.0.0.0/0.0.0.0:42119
2019-06-17 16:12:34,132 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159: addNew group-EF6CA89DA184:[b488d7e8-d816-4f83-b5af-4a8d3baf8159:127.0.0.1:42119] returns group-EF6CA89DA184:java.util.concurrent.CompletableFuture@15a1e56b[Not completed]
2019-06-17 16:12:34,132 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159: new RaftServerImpl for group-EF6CA89DA184:[b488d7e8-d816-4f83-b5af-4a8d3baf8159:127.0.0.1:42119] with ContainerStateMachine:uninitialized
2019-06-17 16:12:34,133 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 16:12:34,133 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 16:12:34,133 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 16:12:34,133 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 16:12:34,133 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159:group-EF6CA89DA184 ConfigurationManager, init=-1: [b488d7e8-d816-4f83-b5af-4a8d3baf8159:127.0.0.1:42119], old=null, confs=<EMPTY_MAP>
2019-06-17 16:12:34,134 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera3ae53fe-e7d5-403a-9492-dd3a8458aa00/ratis] (custom)
2019-06-17 16:12:34,134 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera3ae53fe-e7d5-403a-9492-dd3a8458aa00/ratis/d0557110-2d15-4070-8e42-ef6ca89da184 does not exist. Creating ...
2019-06-17 16:12:34,136 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera3ae53fe-e7d5-403a-9492-dd3a8458aa00/ratis/d0557110-2d15-4070-8e42-ef6ca89da184/in_use.lock acquired by nodename 4299@ozone-unit-076618677d3c5pwt-2100892724
2019-06-17 16:12:34,139 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera3ae53fe-e7d5-403a-9492-dd3a8458aa00/ratis/d0557110-2d15-4070-8e42-ef6ca89da184 has been successfully formatted.
2019-06-17 16:12:34,139 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 16:12:34,140 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 16:12:34,140 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 16:12:34,140 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 16:12:34,140 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 16:12:34,140 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 16:12:34,140 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new b488d7e8-d816-4f83-b5af-4a8d3baf8159-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera3ae53fe-e7d5-403a-9492-dd3a8458aa00/ratis/d0557110-2d15-4070-8e42-ef6ca89da184
2019-06-17 16:12:34,140 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 16:12:34,140 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 16:12:34,140 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 16:12:34,140 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 16:12:34,140 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 16:12:34,140 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 16:12:34,141 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 16:12:34,141 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 16:12:34,141 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 16:12:34,141 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 16:12:34,142 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 16:12:34,142 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 16:12:34,142 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 16:12:34,142 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159: start group-EF6CA89DA184
2019-06-17 16:12:34,142 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159:group-EF6CA89DA184 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 16:12:34,143 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159: start FollowerState
2019-06-17 16:12:34,143 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-EF6CA89DA184,id=b488d7e8-d816-4f83-b5af-4a8d3baf8159
2019-06-17 16:12:35,292 INFO  impl.FollowerState (FollowerState.java:run(101)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159:group-EF6CA89DA184 changes to CANDIDATE, lastRpcTime:1149, electionTimeout:1149ms
2019-06-17 16:12:35,292 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159: shutdown FollowerState
2019-06-17 16:12:35,292 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159:group-EF6CA89DA184 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 16:12:35,292 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159: start LeaderElection
2019-06-17 16:12:35,295 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159:group-EF6CA89DA184:LeaderElection3: begin an election at term 1 for -1: [b488d7e8-d816-4f83-b5af-4a8d3baf8159:127.0.0.1:42119], old=null
2019-06-17 16:12:35,296 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159: shutdown LeaderElection
2019-06-17 16:12:35,296 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159:group-EF6CA89DA184 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 16:12:35,296 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159:group-EF6CA89DA184 change Leader from null to b488d7e8-d816-4f83-b5af-4a8d3baf8159 at term 1 for becomeLeader, leader elected after 1156ms
2019-06-17 16:12:35,296 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 16:12:35,296 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 16:12:35,296 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 16:12:35,296 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 16:12:35,297 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159: start LeaderState
2019-06-17 16:12:35,297 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159-RaftLogWorker: Starting segment from index:0
2019-06-17 16:12:35,297 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159:group-EF6CA89DA184 set configuration 0: [b488d7e8-d816-4f83-b5af-4a8d3baf8159:127.0.0.1:42119], old=null at 0
2019-06-17 16:12:35,336 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera3ae53fe-e7d5-403a-9492-dd3a8458aa00/ratis/d0557110-2d15-4070-8e42-ef6ca89da184/current/log_inprogress_0
2019-06-17 16:12:36,181 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 165196631286473491 is closed with bcsId 0.
2019-06-17 16:12:36,181 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 16:12:36,182 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159: close
2019-06-17 16:12:36,182 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159: shutdown group-EF6CA89DA184
2019-06-17 16:12:36,182 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-EF6CA89DA184,id=b488d7e8-d816-4f83-b5af-4a8d3baf8159
2019-06-17 16:12:36,182 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159: shutdown LeaderState
2019-06-17 16:12:36,183 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159-PendingRequests: sendNotLeaderResponses
2019-06-17 16:12:36,183 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-b488d7e8-d816-4f83-b5af-4a8d3baf8159-group-EF6CA89DA184: set stopIndex = 2
2019-06-17 16:12:36,183 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 16:12:36,184 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlera3ae53fe-e7d5-403a-9492-dd3a8458aa00/ratis/d0557110-2d15-4070-8e42-ef6ca89da184/sm/snapshot.1_2
2019-06-17 16:12:36,184 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159:group-EF6CA89DA184 closes. The last applied log index is 2
2019-06-17 16:12:36,184 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 16:12:36,185 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159-RaftLogWorker close()
2019-06-17 16:12:36,186 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159: shutdown server with port 42119 now
2019-06-17 16:12:36,187 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - b488d7e8-d816-4f83-b5af-4a8d3baf8159: shutdown server with port 42119 successfully
2019-06-17 16:12:36,190 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 16:12:36,226 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler29ea8202-268d-423e-8216-e05f20610d91/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 16:12:36,226 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler29ea8202-268d-423e-8216-e05f20610d91/hdds to VolumeSet
2019-06-17 16:12:36,226 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@23940f86
2019-06-17 16:12:36,227 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@23940f86
2019-06-17 16:12:36,239 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 34465
2019-06-17 16:12:36,240 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 16:12:36,240 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 16:12:36,241 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 34465 (custom)
2019-06-17 16:12:36,241 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 16:12:36,241 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 16:12:36,241 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 16:12:36,241 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 16:12:36,242 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler29ea8202-268d-423e-8216-e05f20610d91/ratis] (custom)
2019-06-17 16:12:36,242 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 40631
2019-06-17 16:12:36,242 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 16:12:36,242 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 16:12:36,242 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 6da01f66-92a3-4fb1-a7d6-3fc58572dac4 at port 34465
2019-06-17 16:12:36,249 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4: start RPC server
2019-06-17 16:12:36,250 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4: GrpcService started, listening on 0.0.0.0/0.0.0.0:34465
Jun 17, 2019 4:12:36 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:38277} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 17, 2019 4:12:36 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:42119} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-17 16:12:36,264 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4: addNew group-10FDFDC6EBD9:[6da01f66-92a3-4fb1-a7d6-3fc58572dac4:127.0.0.1:34465] returns group-10FDFDC6EBD9:java.util.concurrent.CompletableFuture@43de10fd[Not completed]
2019-06-17 16:12:36,265 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4: new RaftServerImpl for group-10FDFDC6EBD9:[6da01f66-92a3-4fb1-a7d6-3fc58572dac4:127.0.0.1:34465] with ContainerStateMachine:uninitialized
2019-06-17 16:12:36,265 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 16:12:36,265 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 16:12:36,265 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 16:12:36,265 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 16:12:36,265 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4:group-10FDFDC6EBD9 ConfigurationManager, init=-1: [6da01f66-92a3-4fb1-a7d6-3fc58572dac4:127.0.0.1:34465], old=null, confs=<EMPTY_MAP>
2019-06-17 16:12:36,266 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler29ea8202-268d-423e-8216-e05f20610d91/ratis] (custom)
2019-06-17 16:12:36,266 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler29ea8202-268d-423e-8216-e05f20610d91/ratis/045f2736-d735-4272-90f7-10fdfdc6ebd9 does not exist. Creating ...
2019-06-17 16:12:36,268 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler29ea8202-268d-423e-8216-e05f20610d91/ratis/045f2736-d735-4272-90f7-10fdfdc6ebd9/in_use.lock acquired by nodename 4299@ozone-unit-076618677d3c5pwt-2100892724
2019-06-17 16:12:36,270 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler29ea8202-268d-423e-8216-e05f20610d91/ratis/045f2736-d735-4272-90f7-10fdfdc6ebd9 has been successfully formatted.
2019-06-17 16:12:36,271 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 16:12:36,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 16:12:36,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 16:12:36,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 16:12:36,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 16:12:36,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 16:12:36,271 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 6da01f66-92a3-4fb1-a7d6-3fc58572dac4-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler29ea8202-268d-423e-8216-e05f20610d91/ratis/045f2736-d735-4272-90f7-10fdfdc6ebd9
2019-06-17 16:12:36,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 16:12:36,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 16:12:36,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 16:12:36,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 16:12:36,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 16:12:36,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 16:12:36,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 16:12:36,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 16:12:36,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 16:12:36,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 16:12:36,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 16:12:36,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 16:12:36,273 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 16:12:36,273 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4: start group-10FDFDC6EBD9
2019-06-17 16:12:36,273 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4:group-10FDFDC6EBD9 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 16:12:36,273 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4: start FollowerState
2019-06-17 16:12:36,273 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-10FDFDC6EBD9,id=6da01f66-92a3-4fb1-a7d6-3fc58572dac4
2019-06-17 16:12:37,286 INFO  impl.FollowerState (FollowerState.java:run(101)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4:group-10FDFDC6EBD9 changes to CANDIDATE, lastRpcTime:1013, electionTimeout:1013ms
2019-06-17 16:12:37,286 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4: shutdown FollowerState
2019-06-17 16:12:37,287 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4:group-10FDFDC6EBD9 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 16:12:37,287 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4: start LeaderElection
2019-06-17 16:12:37,289 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4:group-10FDFDC6EBD9:LeaderElection4: begin an election at term 1 for -1: [6da01f66-92a3-4fb1-a7d6-3fc58572dac4:127.0.0.1:34465], old=null
2019-06-17 16:12:37,289 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4: shutdown LeaderElection
2019-06-17 16:12:37,290 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4:group-10FDFDC6EBD9 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 16:12:37,290 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4:group-10FDFDC6EBD9 change Leader from null to 6da01f66-92a3-4fb1-a7d6-3fc58572dac4 at term 1 for becomeLeader, leader elected after 1018ms
2019-06-17 16:12:37,290 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 16:12:37,290 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 16:12:37,290 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 16:12:37,290 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 16:12:37,290 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4: start LeaderState
2019-06-17 16:12:37,290 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4-RaftLogWorker: Starting segment from index:0
2019-06-17 16:12:37,295 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4:group-10FDFDC6EBD9 set configuration 0: [6da01f66-92a3-4fb1-a7d6-3fc58572dac4:127.0.0.1:34465], old=null at 0
2019-06-17 16:12:37,325 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler29ea8202-268d-423e-8216-e05f20610d91/ratis/045f2736-d735-4272-90f7-10fdfdc6ebd9/current/log_inprogress_0
2019-06-17 16:12:38,311 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 5890569451881889965 is closed with bcsId 0.
2019-06-17 16:12:38,311 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 16:12:38,311 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4: close
2019-06-17 16:12:38,312 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4: shutdown group-10FDFDC6EBD9
2019-06-17 16:12:38,312 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-10FDFDC6EBD9,id=6da01f66-92a3-4fb1-a7d6-3fc58572dac4
2019-06-17 16:12:38,312 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4: shutdown LeaderState
2019-06-17 16:12:38,312 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4-PendingRequests: sendNotLeaderResponses
2019-06-17 16:12:38,313 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-6da01f66-92a3-4fb1-a7d6-3fc58572dac4-group-10FDFDC6EBD9: set stopIndex = 2
2019-06-17 16:12:38,313 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-17 16:12:38,314 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler29ea8202-268d-423e-8216-e05f20610d91/ratis/045f2736-d735-4272-90f7-10fdfdc6ebd9/sm/snapshot.1_2
2019-06-17 16:12:38,314 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4:group-10FDFDC6EBD9 closes. The last applied log index is 2
2019-06-17 16:12:38,314 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 16:12:38,315 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4-RaftLogWorker close()
2019-06-17 16:12:38,316 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4: shutdown server with port 34465 now
2019-06-17 16:12:38,317 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 6da01f66-92a3-4fb1-a7d6-3fc58572dac4: shutdown server with port 34465 successfully
2019-06-17 16:12:38,321 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-17 16:12:38,338 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere27ffcb6-3fcf-41ca-be68-6ef1b1edf6d7/hdds of  storage type : DISK and capacity : 104021790720
2019-06-17 16:12:38,338 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere27ffcb6-3fcf-41ca-be68-6ef1b1edf6d7/hdds to VolumeSet
2019-06-17 16:12:38,338 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1bf39d06
2019-06-17 16:12:38,338 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1bf39d06
2019-06-17 16:12:38,346 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 38675
2019-06-17 16:12:38,347 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-17 16:12:38,347 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-17 16:12:38,348 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 38675 (custom)
2019-06-17 16:12:38,348 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-17 16:12:38,348 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 16:12:38,348 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-17 16:12:38,349 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-17 16:12:38,349 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere27ffcb6-3fcf-41ca-be68-6ef1b1edf6d7/ratis] (custom)
2019-06-17 16:12:38,349 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 41223
2019-06-17 16:12:38,350 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-17 16:12:38,350 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-17 16:12:38,350 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis e5b7bba3-c522-47e4-b46f-cfd142423cd6 at port 38675
2019-06-17 16:12:38,359 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6: start RPC server
2019-06-17 16:12:38,360 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6: GrpcService started, listening on 0.0.0.0/0.0.0.0:38675
2019-06-17 16:12:38,368 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6: addNew group-3633E19989A0:[e5b7bba3-c522-47e4-b46f-cfd142423cd6:127.0.0.1:38675] returns group-3633E19989A0:java.util.concurrent.CompletableFuture@29d7872f[Not completed]
2019-06-17 16:12:38,368 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6: new RaftServerImpl for group-3633E19989A0:[e5b7bba3-c522-47e4-b46f-cfd142423cd6:127.0.0.1:38675] with ContainerStateMachine:uninitialized
2019-06-17 16:12:38,368 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-17 16:12:38,368 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-17 16:12:38,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-17 16:12:38,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-17 16:12:38,369 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6:group-3633E19989A0 ConfigurationManager, init=-1: [e5b7bba3-c522-47e4-b46f-cfd142423cd6:127.0.0.1:38675], old=null, confs=<EMPTY_MAP>
2019-06-17 16:12:38,369 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere27ffcb6-3fcf-41ca-be68-6ef1b1edf6d7/ratis] (custom)
2019-06-17 16:12:38,369 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere27ffcb6-3fcf-41ca-be68-6ef1b1edf6d7/ratis/67692841-a186-40a7-874a-3633e19989a0 does not exist. Creating ...
2019-06-17 16:12:38,371 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere27ffcb6-3fcf-41ca-be68-6ef1b1edf6d7/ratis/67692841-a186-40a7-874a-3633e19989a0/in_use.lock acquired by nodename 4299@ozone-unit-076618677d3c5pwt-2100892724
2019-06-17 16:12:38,373 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere27ffcb6-3fcf-41ca-be68-6ef1b1edf6d7/ratis/67692841-a186-40a7-874a-3633e19989a0 has been successfully formatted.
2019-06-17 16:12:38,374 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-17 16:12:38,374 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-17 16:12:38,374 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-17 16:12:38,374 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-17 16:12:38,374 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 16:12:38,374 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-17 16:12:38,374 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new e5b7bba3-c522-47e4-b46f-cfd142423cd6-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere27ffcb6-3fcf-41ca-be68-6ef1b1edf6d7/ratis/67692841-a186-40a7-874a-3633e19989a0
2019-06-17 16:12:38,374 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-17 16:12:38,374 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-17 16:12:38,374 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-17 16:12:38,375 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-17 16:12:38,375 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-17 16:12:38,375 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-17 16:12:38,375 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-17 16:12:38,375 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-17 16:12:38,375 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-17 16:12:38,375 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-17 16:12:38,375 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-17 16:12:38,376 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-17 16:12:38,376 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-17 16:12:38,376 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6: start group-3633E19989A0
2019-06-17 16:12:38,376 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6:group-3633E19989A0 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-17 16:12:38,376 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6: start FollowerState
2019-06-17 16:12:38,376 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-3633E19989A0,id=e5b7bba3-c522-47e4-b46f-cfd142423cd6
2019-06-17 16:12:39,554 INFO  impl.FollowerState (FollowerState.java:run(101)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6:group-3633E19989A0 changes to CANDIDATE, lastRpcTime:1178, electionTimeout:1178ms
2019-06-17 16:12:39,555 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6: shutdown FollowerState
2019-06-17 16:12:39,555 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6:group-3633E19989A0 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-17 16:12:39,555 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6: start LeaderElection
2019-06-17 16:12:39,558 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6:group-3633E19989A0:LeaderElection5: begin an election at term 1 for -1: [e5b7bba3-c522-47e4-b46f-cfd142423cd6:127.0.0.1:38675], old=null
2019-06-17 16:12:39,558 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6: shutdown LeaderElection
2019-06-17 16:12:39,558 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6:group-3633E19989A0 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-17 16:12:39,558 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6:group-3633E19989A0 change Leader from null to e5b7bba3-c522-47e4-b46f-cfd142423cd6 at term 1 for becomeLeader, leader elected after 1184ms
2019-06-17 16:12:39,559 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-17 16:12:39,559 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-17 16:12:39,559 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-17 16:12:39,559 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-17 16:12:39,559 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6: start LeaderState
2019-06-17 16:12:39,560 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6-RaftLogWorker: Starting segment from index:0
2019-06-17 16:12:39,561 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6:group-3633E19989A0 set configuration 0: [e5b7bba3-c522-47e4-b46f-cfd142423cd6:127.0.0.1:38675], old=null at 0
2019-06-17 16:12:39,595 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere27ffcb6-3fcf-41ca-be68-6ef1b1edf6d7/ratis/67692841-a186-40a7-874a-3633e19989a0/current/log_inprogress_0
2019-06-17 16:12:40,414 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 8163683838932132941 is closed with bcsId 0.
2019-06-17 16:12:40,414 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-17 16:12:40,415 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6: close
2019-06-17 16:12:40,415 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6: shutdown group-3633E19989A0
2019-06-17 16:12:40,415 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-3633E19989A0,id=e5b7bba3-c522-47e4-b46f-cfd142423cd6
2019-06-17 16:12:40,415 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6: shutdown LeaderState
2019-06-17 16:12:40,415 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6-PendingRequests: sendNotLeaderResponses
2019-06-17 16:12:40,416 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-e5b7bba3-c522-47e4-b46f-cfd142423cd6-group-3633E19989A0: set stopIndex = 4
2019-06-17 16:12:40,416 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-17 16:12:40,416 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlere27ffcb6-3fcf-41ca-be68-6ef1b1edf6d7/ratis/67692841-a186-40a7-874a-3633e19989a0/sm/snapshot.1_4
2019-06-17 16:12:40,417 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6:group-3633E19989A0 closes. The last applied log index is 4
2019-06-17 16:12:40,417 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-17 16:12:40,417 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6-RaftLogWorker close()
2019-06-17 16:12:40,418 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6: shutdown server with port 38675 now
2019-06-17 16:12:40,419 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - e5b7bba3-c522-47e4-b46f-cfd142423cd6: shutdown server with port 38675 successfully
2019-06-17 16:12:40,420 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
