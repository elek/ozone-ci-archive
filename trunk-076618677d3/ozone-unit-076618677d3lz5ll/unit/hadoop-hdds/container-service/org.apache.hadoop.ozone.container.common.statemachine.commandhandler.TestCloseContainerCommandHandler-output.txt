2019-06-18 13:09:38,047 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler856872f5-d4fc-46dc-876e-465f8e622c1b/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 13:09:38,053 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler856872f5-d4fc-46dc-876e-465f8e622c1b/hdds to VolumeSet
2019-06-18 13:09:38,069 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
2019-06-18 13:09:38,130 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@1500b2f3
ERROR StatusLogger No Log4j 2 configuration file found. Using default configuration (logging only errors to the console), or user programmatically provided configurations. Set system property 'log4j2.debug' to show Log4j 2 internal initialization logging. See https://logging.apache.org/log4j/2.x/manual/configuration.html for instructions on how to configure Log4j 2
2019-06-18 13:09:38,629 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 40045
2019-06-18 13:09:39,193 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 13:09:39,221 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 13:09:39,232 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 40045 (custom)
2019-06-18 13:09:39,233 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 13:09:39,235 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 13:09:39,236 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 13:09:39,237 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 13:09:39,427 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler856872f5-d4fc-46dc-876e-465f8e622c1b/ratis] (custom)
2019-06-18 13:09:39,441 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 34693
2019-06-18 13:09:39,472 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 13:09:39,473 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 13:09:39,474 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 5332432a-449c-4ebf-9606-b034e8f55fed at port 40045
2019-06-18 13:09:39,505 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 5332432a-449c-4ebf-9606-b034e8f55fed: start RPC server
2019-06-18 13:09:39,747 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 5332432a-449c-4ebf-9606-b034e8f55fed: GrpcService started, listening on 0.0.0.0/0.0.0.0:40045
2019-06-18 13:09:40,170 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 5332432a-449c-4ebf-9606-b034e8f55fed: addNew group-0A11075EC2C8:[5332432a-449c-4ebf-9606-b034e8f55fed:127.0.0.1:40045] returns group-0A11075EC2C8:java.util.concurrent.CompletableFuture@6a65e08e[Not completed]
2019-06-18 13:09:40,217 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 5332432a-449c-4ebf-9606-b034e8f55fed: new RaftServerImpl for group-0A11075EC2C8:[5332432a-449c-4ebf-9606-b034e8f55fed:127.0.0.1:40045] with ContainerStateMachine:uninitialized
2019-06-18 13:09:40,218 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 13:09:40,219 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 13:09:40,219 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 13:09:40,220 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 13:09:40,226 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 5332432a-449c-4ebf-9606-b034e8f55fed:group-0A11075EC2C8 ConfigurationManager, init=-1: [5332432a-449c-4ebf-9606-b034e8f55fed:127.0.0.1:40045], old=null, confs=<EMPTY_MAP>
2019-06-18 13:09:40,227 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler856872f5-d4fc-46dc-876e-465f8e622c1b/ratis] (custom)
2019-06-18 13:09:40,234 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler856872f5-d4fc-46dc-876e-465f8e622c1b/ratis/0b01248e-5a46-42a6-ab5a-0a11075ec2c8 does not exist. Creating ...
2019-06-18 13:09:40,244 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler856872f5-d4fc-46dc-876e-465f8e622c1b/ratis/0b01248e-5a46-42a6-ab5a-0a11075ec2c8/in_use.lock acquired by nodename 4317@ozone-unit-076618677d3lz5ll-188941294
2019-06-18 13:09:40,253 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler856872f5-d4fc-46dc-876e-465f8e622c1b/ratis/0b01248e-5a46-42a6-ab5a-0a11075ec2c8 has been successfully formatted.
2019-06-18 13:09:40,255 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 13:09:40,256 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 13:09:40,258 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 13:09:40,260 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 13:09:40,264 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 13:09:40,268 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 13:09:40,272 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 5332432a-449c-4ebf-9606-b034e8f55fed-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler856872f5-d4fc-46dc-876e-465f8e622c1b/ratis/0b01248e-5a46-42a6-ab5a-0a11075ec2c8
2019-06-18 13:09:40,272 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 13:09:40,273 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 13:09:40,275 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 13:09:40,276 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 13:09:40,276 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 13:09:40,277 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 13:09:40,278 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 13:09:40,278 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 13:09:40,279 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 13:09:40,282 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 13:09:40,290 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 13:09:40,291 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 13:09:40,292 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 13:09:40,417 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 5332432a-449c-4ebf-9606-b034e8f55fed: start group-0A11075EC2C8
2019-06-18 13:09:40,418 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5332432a-449c-4ebf-9606-b034e8f55fed:group-0A11075EC2C8 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 13:09:40,420 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5332432a-449c-4ebf-9606-b034e8f55fed: start FollowerState
2019-06-18 13:09:40,426 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-0A11075EC2C8,id=5332432a-449c-4ebf-9606-b034e8f55fed
2019-06-18 13:09:41,463 INFO  impl.FollowerState (FollowerState.java:run(101)) - 5332432a-449c-4ebf-9606-b034e8f55fed:group-0A11075EC2C8 changes to CANDIDATE, lastRpcTime:1044, electionTimeout:1043ms
2019-06-18 13:09:41,463 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 5332432a-449c-4ebf-9606-b034e8f55fed: shutdown FollowerState
2019-06-18 13:09:41,464 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5332432a-449c-4ebf-9606-b034e8f55fed:group-0A11075EC2C8 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 13:09:41,466 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5332432a-449c-4ebf-9606-b034e8f55fed: start LeaderElection
2019-06-18 13:09:41,470 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 5332432a-449c-4ebf-9606-b034e8f55fed:group-0A11075EC2C8:LeaderElection1: begin an election at term 1 for -1: [5332432a-449c-4ebf-9606-b034e8f55fed:127.0.0.1:40045], old=null
2019-06-18 13:09:41,471 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 5332432a-449c-4ebf-9606-b034e8f55fed: shutdown LeaderElection
2019-06-18 13:09:41,471 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 5332432a-449c-4ebf-9606-b034e8f55fed:group-0A11075EC2C8 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 13:09:41,472 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 5332432a-449c-4ebf-9606-b034e8f55fed:group-0A11075EC2C8 change Leader from null to 5332432a-449c-4ebf-9606-b034e8f55fed at term 1 for becomeLeader, leader elected after 1216ms
2019-06-18 13:09:41,476 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 13:09:41,476 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 13:09:41,479 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 13:09:41,479 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 13:09:41,488 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 5332432a-449c-4ebf-9606-b034e8f55fed: start LeaderState
2019-06-18 13:09:41,505 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 5332432a-449c-4ebf-9606-b034e8f55fed-RaftLogWorker: Starting segment from index:0
2019-06-18 13:09:41,512 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 5332432a-449c-4ebf-9606-b034e8f55fed:group-0A11075EC2C8 set configuration 0: [5332432a-449c-4ebf-9606-b034e8f55fed:127.0.0.1:40045], old=null at 0
2019-06-18 13:09:41,684 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 5332432a-449c-4ebf-9606-b034e8f55fed-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler856872f5-d4fc-46dc-876e-465f8e622c1b/ratis/0b01248e-5a46-42a6-ab5a-0a11075ec2c8/current/log_inprogress_0
2019-06-18 13:09:42,720 WARN  util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-06-18 13:09:42,805 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 5533232604759614613 is closed with bcsId 0.
2019-06-18 13:09:42,806 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 13:09:42,807 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 5332432a-449c-4ebf-9606-b034e8f55fed: close
2019-06-18 13:09:42,808 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 5332432a-449c-4ebf-9606-b034e8f55fed: shutdown group-0A11075EC2C8
2019-06-18 13:09:42,809 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-0A11075EC2C8,id=5332432a-449c-4ebf-9606-b034e8f55fed
2019-06-18 13:09:42,810 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 5332432a-449c-4ebf-9606-b034e8f55fed: shutdown LeaderState
2019-06-18 13:09:42,811 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 5332432a-449c-4ebf-9606-b034e8f55fed-PendingRequests: sendNotLeaderResponses
2019-06-18 13:09:42,814 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-5332432a-449c-4ebf-9606-b034e8f55fed-group-0A11075EC2C8: set stopIndex = 4
2019-06-18 13:09:42,814 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-18 13:09:42,815 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler856872f5-d4fc-46dc-876e-465f8e622c1b/ratis/0b01248e-5a46-42a6-ab5a-0a11075ec2c8/sm/snapshot.1_4
2019-06-18 13:09:42,825 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 5332432a-449c-4ebf-9606-b034e8f55fed:group-0A11075EC2C8 closes. The last applied log index is 4
2019-06-18 13:09:42,827 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 5332432a-449c-4ebf-9606-b034e8f55fed-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 13:09:42,829 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 5332432a-449c-4ebf-9606-b034e8f55fed-RaftLogWorker close()
2019-06-18 13:09:42,831 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 5332432a-449c-4ebf-9606-b034e8f55fed: shutdown server with port 40045 now
2019-06-18 13:09:42,839 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 5332432a-449c-4ebf-9606-b034e8f55fed: shutdown server with port 40045 successfully
2019-06-18 13:09:42,848 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-18 13:09:42,890 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4c8c6329-ebc3-4d6f-8361-1b9a3988db34/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 13:09:42,890 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4c8c6329-ebc3-4d6f-8361-1b9a3988db34/hdds to VolumeSet
2019-06-18 13:09:42,891 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@3a2b2322
2019-06-18 13:09:42,891 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@3a2b2322
2019-06-18 13:09:42,906 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 41833
2019-06-18 13:09:42,913 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 13:09:42,914 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 13:09:42,914 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 41833 (custom)
2019-06-18 13:09:42,914 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 13:09:42,915 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 13:09:42,915 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 13:09:42,915 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 13:09:42,916 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4c8c6329-ebc3-4d6f-8361-1b9a3988db34/ratis] (custom)
2019-06-18 13:09:42,917 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 34469
2019-06-18 13:09:42,917 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 13:09:42,918 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 13:09:42,918 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 82c82966-1b67-4b90-8e30-32f3ac8d58a5 at port 41833
2019-06-18 13:09:43,018 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5: start RPC server
2019-06-18 13:09:43,021 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5: GrpcService started, listening on 0.0.0.0/0.0.0.0:41833
2019-06-18 13:09:43,056 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5: addNew group-CD6D404B7175:[82c82966-1b67-4b90-8e30-32f3ac8d58a5:127.0.0.1:41833] returns group-CD6D404B7175:java.util.concurrent.CompletableFuture@28dd134e[Not completed]
2019-06-18 13:09:43,057 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5: new RaftServerImpl for group-CD6D404B7175:[82c82966-1b67-4b90-8e30-32f3ac8d58a5:127.0.0.1:41833] with ContainerStateMachine:uninitialized
2019-06-18 13:09:43,059 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 13:09:43,059 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 13:09:43,059 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 13:09:43,059 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 13:09:43,059 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5:group-CD6D404B7175 ConfigurationManager, init=-1: [82c82966-1b67-4b90-8e30-32f3ac8d58a5:127.0.0.1:41833], old=null, confs=<EMPTY_MAP>
2019-06-18 13:09:43,060 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4c8c6329-ebc3-4d6f-8361-1b9a3988db34/ratis] (custom)
2019-06-18 13:09:43,060 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4c8c6329-ebc3-4d6f-8361-1b9a3988db34/ratis/a5159984-3c53-4ccb-ae1a-cd6d404b7175 does not exist. Creating ...
2019-06-18 13:09:43,063 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4c8c6329-ebc3-4d6f-8361-1b9a3988db34/ratis/a5159984-3c53-4ccb-ae1a-cd6d404b7175/in_use.lock acquired by nodename 4317@ozone-unit-076618677d3lz5ll-188941294
2019-06-18 13:09:43,066 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4c8c6329-ebc3-4d6f-8361-1b9a3988db34/ratis/a5159984-3c53-4ccb-ae1a-cd6d404b7175 has been successfully formatted.
2019-06-18 13:09:43,066 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 13:09:43,066 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 13:09:43,067 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 13:09:43,067 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 13:09:43,067 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 13:09:43,067 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 13:09:43,067 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 82c82966-1b67-4b90-8e30-32f3ac8d58a5-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4c8c6329-ebc3-4d6f-8361-1b9a3988db34/ratis/a5159984-3c53-4ccb-ae1a-cd6d404b7175
2019-06-18 13:09:43,068 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 13:09:43,068 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 13:09:43,068 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 13:09:43,068 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 13:09:43,068 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 13:09:43,068 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 13:09:43,069 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 13:09:43,069 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 13:09:43,069 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 13:09:43,069 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 13:09:43,073 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 13:09:43,074 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 13:09:43,074 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 13:09:43,074 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5: start group-CD6D404B7175
2019-06-18 13:09:43,074 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5:group-CD6D404B7175 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 13:09:43,074 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5: start FollowerState
2019-06-18 13:09:43,075 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-CD6D404B7175,id=82c82966-1b67-4b90-8e30-32f3ac8d58a5
2019-06-18 13:09:44,199 INFO  impl.FollowerState (FollowerState.java:run(101)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5:group-CD6D404B7175 changes to CANDIDATE, lastRpcTime:1124, electionTimeout:1124ms
2019-06-18 13:09:44,199 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5: shutdown FollowerState
2019-06-18 13:09:44,199 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5:group-CD6D404B7175 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 13:09:44,200 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5: start LeaderElection
2019-06-18 13:09:44,205 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5:group-CD6D404B7175:LeaderElection2: begin an election at term 1 for -1: [82c82966-1b67-4b90-8e30-32f3ac8d58a5:127.0.0.1:41833], old=null
2019-06-18 13:09:44,205 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5: shutdown LeaderElection
2019-06-18 13:09:44,205 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5:group-CD6D404B7175 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 13:09:44,205 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5:group-CD6D404B7175 change Leader from null to 82c82966-1b67-4b90-8e30-32f3ac8d58a5 at term 1 for becomeLeader, leader elected after 1138ms
2019-06-18 13:09:44,206 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 13:09:44,206 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 13:09:44,206 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 13:09:44,206 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 13:09:44,207 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5: start LeaderState
2019-06-18 13:09:44,207 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5-RaftLogWorker: Starting segment from index:0
2019-06-18 13:09:44,208 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5:group-CD6D404B7175 set configuration 0: [82c82966-1b67-4b90-8e30-32f3ac8d58a5:127.0.0.1:41833], old=null at 0
2019-06-18 13:09:44,249 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4c8c6329-ebc3-4d6f-8361-1b9a3988db34/ratis/a5159984-3c53-4ccb-ae1a-cd6d404b7175/current/log_inprogress_0
2019-06-18 13:09:45,138 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 13:09:45,139 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5: close
2019-06-18 13:09:45,139 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5: shutdown group-CD6D404B7175
2019-06-18 13:09:45,140 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-CD6D404B7175,id=82c82966-1b67-4b90-8e30-32f3ac8d58a5
2019-06-18 13:09:45,141 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5: shutdown LeaderState
2019-06-18 13:09:45,141 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5-PendingRequests: sendNotLeaderResponses
2019-06-18 13:09:45,142 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-18 13:09:45,143 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler4c8c6329-ebc3-4d6f-8361-1b9a3988db34/ratis/a5159984-3c53-4ccb-ae1a-cd6d404b7175/sm/snapshot.1_2
2019-06-18 13:09:45,143 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-82c82966-1b67-4b90-8e30-32f3ac8d58a5-group-CD6D404B7175: set stopIndex = 2
2019-06-18 13:09:45,144 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5:group-CD6D404B7175 closes. The last applied log index is 2
2019-06-18 13:09:45,144 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 13:09:45,146 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5-RaftLogWorker close()
2019-06-18 13:09:45,147 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5: shutdown server with port 41833 now
2019-06-18 13:09:45,149 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 82c82966-1b67-4b90-8e30-32f3ac8d58a5: shutdown server with port 41833 successfully
2019-06-18 13:09:45,155 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-18 13:09:45,190 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercf8cef82-f4e8-48b7-896b-eb46873062c5/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 13:09:45,191 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercf8cef82-f4e8-48b7-896b-eb46873062c5/hdds to VolumeSet
2019-06-18 13:09:45,191 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@26a2f7f9
2019-06-18 13:09:45,192 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@26a2f7f9
2019-06-18 13:09:45,207 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 36703
2019-06-18 13:09:45,207 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 13:09:45,208 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 13:09:45,209 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 36703 (custom)
2019-06-18 13:09:45,209 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 13:09:45,209 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 13:09:45,209 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 13:09:45,210 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 13:09:45,210 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercf8cef82-f4e8-48b7-896b-eb46873062c5/ratis] (custom)
2019-06-18 13:09:45,211 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 44067
2019-06-18 13:09:45,211 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 13:09:45,211 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 13:09:45,212 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 6724a490-9be1-4a7d-8eba-721cc32613fd at port 36703
2019-06-18 13:09:45,238 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 6724a490-9be1-4a7d-8eba-721cc32613fd: start RPC server
2019-06-18 13:09:45,240 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 6724a490-9be1-4a7d-8eba-721cc32613fd: GrpcService started, listening on 0.0.0.0/0.0.0.0:36703
2019-06-18 13:09:45,255 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 6724a490-9be1-4a7d-8eba-721cc32613fd: addNew group-2EA17202CE0C:[6724a490-9be1-4a7d-8eba-721cc32613fd:127.0.0.1:36703] returns group-2EA17202CE0C:java.util.concurrent.CompletableFuture@5c124577[Not completed]
2019-06-18 13:09:45,260 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 6724a490-9be1-4a7d-8eba-721cc32613fd: new RaftServerImpl for group-2EA17202CE0C:[6724a490-9be1-4a7d-8eba-721cc32613fd:127.0.0.1:36703] with ContainerStateMachine:uninitialized
2019-06-18 13:09:45,260 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 13:09:45,261 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 13:09:45,261 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 13:09:45,261 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 13:09:45,261 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 6724a490-9be1-4a7d-8eba-721cc32613fd:group-2EA17202CE0C ConfigurationManager, init=-1: [6724a490-9be1-4a7d-8eba-721cc32613fd:127.0.0.1:36703], old=null, confs=<EMPTY_MAP>
2019-06-18 13:09:45,261 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercf8cef82-f4e8-48b7-896b-eb46873062c5/ratis] (custom)
2019-06-18 13:09:45,262 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercf8cef82-f4e8-48b7-896b-eb46873062c5/ratis/430d2ce4-0813-4858-8859-2ea17202ce0c does not exist. Creating ...
2019-06-18 13:09:45,265 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercf8cef82-f4e8-48b7-896b-eb46873062c5/ratis/430d2ce4-0813-4858-8859-2ea17202ce0c/in_use.lock acquired by nodename 4317@ozone-unit-076618677d3lz5ll-188941294
2019-06-18 13:09:45,268 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercf8cef82-f4e8-48b7-896b-eb46873062c5/ratis/430d2ce4-0813-4858-8859-2ea17202ce0c has been successfully formatted.
2019-06-18 13:09:45,268 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 13:09:45,268 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 13:09:45,268 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 13:09:45,268 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 13:09:45,268 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 13:09:45,269 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 13:09:45,269 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 6724a490-9be1-4a7d-8eba-721cc32613fd-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercf8cef82-f4e8-48b7-896b-eb46873062c5/ratis/430d2ce4-0813-4858-8859-2ea17202ce0c
2019-06-18 13:09:45,269 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 13:09:45,269 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 13:09:45,269 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 13:09:45,269 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 13:09:45,270 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 13:09:45,270 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 13:09:45,270 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 13:09:45,270 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 13:09:45,270 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 13:09:45,270 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 13:09:45,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 13:09:45,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 13:09:45,271 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 13:09:45,272 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 6724a490-9be1-4a7d-8eba-721cc32613fd: start group-2EA17202CE0C
2019-06-18 13:09:45,272 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6724a490-9be1-4a7d-8eba-721cc32613fd:group-2EA17202CE0C changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 13:09:45,272 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6724a490-9be1-4a7d-8eba-721cc32613fd: start FollowerState
2019-06-18 13:09:45,272 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-2EA17202CE0C,id=6724a490-9be1-4a7d-8eba-721cc32613fd
2019-06-18 13:09:46,301 INFO  impl.FollowerState (FollowerState.java:run(101)) - 6724a490-9be1-4a7d-8eba-721cc32613fd:group-2EA17202CE0C changes to CANDIDATE, lastRpcTime:1029, electionTimeout:1029ms
2019-06-18 13:09:46,302 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 6724a490-9be1-4a7d-8eba-721cc32613fd: shutdown FollowerState
2019-06-18 13:09:46,302 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6724a490-9be1-4a7d-8eba-721cc32613fd:group-2EA17202CE0C changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 13:09:46,302 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6724a490-9be1-4a7d-8eba-721cc32613fd: start LeaderElection
2019-06-18 13:09:46,307 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 6724a490-9be1-4a7d-8eba-721cc32613fd:group-2EA17202CE0C:LeaderElection3: begin an election at term 1 for -1: [6724a490-9be1-4a7d-8eba-721cc32613fd:127.0.0.1:36703], old=null
2019-06-18 13:09:46,307 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 6724a490-9be1-4a7d-8eba-721cc32613fd: shutdown LeaderElection
2019-06-18 13:09:46,308 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 6724a490-9be1-4a7d-8eba-721cc32613fd:group-2EA17202CE0C changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 13:09:46,308 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 6724a490-9be1-4a7d-8eba-721cc32613fd:group-2EA17202CE0C change Leader from null to 6724a490-9be1-4a7d-8eba-721cc32613fd at term 1 for becomeLeader, leader elected after 1039ms
2019-06-18 13:09:46,308 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 13:09:46,308 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 13:09:46,308 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 13:09:46,309 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 13:09:46,309 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 6724a490-9be1-4a7d-8eba-721cc32613fd: start LeaderState
2019-06-18 13:09:46,309 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 6724a490-9be1-4a7d-8eba-721cc32613fd-RaftLogWorker: Starting segment from index:0
2019-06-18 13:09:46,329 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 6724a490-9be1-4a7d-8eba-721cc32613fd:group-2EA17202CE0C set configuration 0: [6724a490-9be1-4a7d-8eba-721cc32613fd:127.0.0.1:36703], old=null at 0
2019-06-18 13:09:46,359 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 6724a490-9be1-4a7d-8eba-721cc32613fd-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercf8cef82-f4e8-48b7-896b-eb46873062c5/ratis/430d2ce4-0813-4858-8859-2ea17202ce0c/current/log_inprogress_0
2019-06-18 13:09:47,330 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 945121823358414051 is closed with bcsId 0.
2019-06-18 13:09:47,331 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 13:09:47,332 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 6724a490-9be1-4a7d-8eba-721cc32613fd: close
2019-06-18 13:09:47,332 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 6724a490-9be1-4a7d-8eba-721cc32613fd: shutdown group-2EA17202CE0C
2019-06-18 13:09:47,332 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-2EA17202CE0C,id=6724a490-9be1-4a7d-8eba-721cc32613fd
2019-06-18 13:09:47,333 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 6724a490-9be1-4a7d-8eba-721cc32613fd: shutdown LeaderState
2019-06-18 13:09:47,333 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 6724a490-9be1-4a7d-8eba-721cc32613fd-PendingRequests: sendNotLeaderResponses
2019-06-18 13:09:47,334 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-6724a490-9be1-4a7d-8eba-721cc32613fd-group-2EA17202CE0C: set stopIndex = 2
2019-06-18 13:09:47,334 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-18 13:09:47,335 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandlercf8cef82-f4e8-48b7-896b-eb46873062c5/ratis/430d2ce4-0813-4858-8859-2ea17202ce0c/sm/snapshot.1_2
2019-06-18 13:09:47,342 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 6724a490-9be1-4a7d-8eba-721cc32613fd:group-2EA17202CE0C closes. The last applied log index is 2
2019-06-18 13:09:47,342 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 6724a490-9be1-4a7d-8eba-721cc32613fd-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 13:09:47,348 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 6724a490-9be1-4a7d-8eba-721cc32613fd-RaftLogWorker close()
2019-06-18 13:09:47,349 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 6724a490-9be1-4a7d-8eba-721cc32613fd: shutdown server with port 36703 now
2019-06-18 13:09:47,351 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 6724a490-9be1-4a7d-8eba-721cc32613fd: shutdown server with port 36703 successfully
2019-06-18 13:09:47,382 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-18 13:09:47,424 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler89bf63ea-3d2c-4a3a-be93-c53501b4b827/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 13:09:47,429 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler89bf63ea-3d2c-4a3a-be93-c53501b4b827/hdds to VolumeSet
2019-06-18 13:09:47,430 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@66153688
2019-06-18 13:09:47,431 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@66153688
2019-06-18 13:09:47,470 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 32829
2019-06-18 13:09:47,471 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 13:09:47,472 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 13:09:47,472 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 32829 (custom)
2019-06-18 13:09:47,472 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 13:09:47,472 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 13:09:47,473 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 13:09:47,473 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 13:09:47,474 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler89bf63ea-3d2c-4a3a-be93-c53501b4b827/ratis] (custom)
2019-06-18 13:09:47,474 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 46563
2019-06-18 13:09:47,474 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 13:09:47,475 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 13:09:47,475 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 7470c307-ee5b-484a-a1b3-0676a78111b6 at port 32829
2019-06-18 13:09:47,494 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 7470c307-ee5b-484a-a1b3-0676a78111b6: start RPC server
2019-06-18 13:09:47,497 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 7470c307-ee5b-484a-a1b3-0676a78111b6: GrpcService started, listening on 0.0.0.0/0.0.0.0:32829
Jun 18, 2019 1:09:47 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=18, target=127.0.0.1:41833} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testCloseContainerViaStandalone(TestCloseContainerCommandHandler.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

Jun 18, 2019 1:09:47 PM org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference cleanQueue
SEVERE: *~*~*~ Channel ManagedChannelImpl{logId=29, target=127.0.0.1:36703} was not shutdown properly!!! ~*~*~*
    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.
java.lang.RuntimeException: ManagedChannel allocation site
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:103)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:53)
	at org.apache.ratis.thirdparty.io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:44)
	at org.apache.ratis.thirdparty.io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:411)
	at org.apache.ratis.grpc.client.GrpcClientProtocolClient.<init>(GrpcClientProtocolClient.java:118)
	at org.apache.ratis.grpc.client.GrpcClientRpc.lambda$new$0(GrpcClientRpc.java:55)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.lambda$getProxy$0(PeerProxyMap.java:61)
	at org.apache.ratis.util.LifeCycle.startAndTransition(LifeCycle.java:202)
	at org.apache.ratis.util.PeerProxyMap$PeerAndProxy.getProxy(PeerProxyMap.java:60)
	at org.apache.ratis.util.PeerProxyMap.getProxy(PeerProxyMap.java:107)
	at org.apache.ratis.grpc.client.GrpcClientRpc.sendRequest(GrpcClientRpc.java:91)
	at org.apache.ratis.client.impl.RaftClientImpl.sendRequest(RaftClientImpl.java:401)
	at org.apache.ratis.client.impl.RaftClientImpl.groupAdd(RaftClientImpl.java:270)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.createContainer(TestCloseContainerCommandHandler.java:300)
	at org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler.testQuasiCloseToClose(TestCloseContainerCommandHandler.java:147)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)

2019-06-18 13:09:47,524 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 7470c307-ee5b-484a-a1b3-0676a78111b6: addNew group-523E9F1AD0E9:[7470c307-ee5b-484a-a1b3-0676a78111b6:127.0.0.1:32829] returns group-523E9F1AD0E9:java.util.concurrent.CompletableFuture@3a5d24db[Not completed]
2019-06-18 13:09:47,525 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 7470c307-ee5b-484a-a1b3-0676a78111b6: new RaftServerImpl for group-523E9F1AD0E9:[7470c307-ee5b-484a-a1b3-0676a78111b6:127.0.0.1:32829] with ContainerStateMachine:uninitialized
2019-06-18 13:09:47,526 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 13:09:47,526 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 13:09:47,526 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 13:09:47,526 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 13:09:47,526 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 7470c307-ee5b-484a-a1b3-0676a78111b6:group-523E9F1AD0E9 ConfigurationManager, init=-1: [7470c307-ee5b-484a-a1b3-0676a78111b6:127.0.0.1:32829], old=null, confs=<EMPTY_MAP>
2019-06-18 13:09:47,527 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler89bf63ea-3d2c-4a3a-be93-c53501b4b827/ratis] (custom)
2019-06-18 13:09:47,527 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler89bf63ea-3d2c-4a3a-be93-c53501b4b827/ratis/834af11f-0569-4154-9b32-523e9f1ad0e9 does not exist. Creating ...
2019-06-18 13:09:47,530 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler89bf63ea-3d2c-4a3a-be93-c53501b4b827/ratis/834af11f-0569-4154-9b32-523e9f1ad0e9/in_use.lock acquired by nodename 4317@ozone-unit-076618677d3lz5ll-188941294
2019-06-18 13:09:47,533 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler89bf63ea-3d2c-4a3a-be93-c53501b4b827/ratis/834af11f-0569-4154-9b32-523e9f1ad0e9 has been successfully formatted.
2019-06-18 13:09:47,533 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 13:09:47,533 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 13:09:47,533 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 13:09:47,533 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 13:09:47,533 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 13:09:47,534 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 13:09:47,534 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 7470c307-ee5b-484a-a1b3-0676a78111b6-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler89bf63ea-3d2c-4a3a-be93-c53501b4b827/ratis/834af11f-0569-4154-9b32-523e9f1ad0e9
2019-06-18 13:09:47,534 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 13:09:47,534 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 13:09:47,534 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 13:09:47,534 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 13:09:47,535 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 13:09:47,536 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 13:09:47,536 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 13:09:47,536 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 13:09:47,536 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 13:09:47,536 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 13:09:47,538 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 13:09:47,538 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 13:09:47,539 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 13:09:47,539 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 7470c307-ee5b-484a-a1b3-0676a78111b6: start group-523E9F1AD0E9
2019-06-18 13:09:47,539 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7470c307-ee5b-484a-a1b3-0676a78111b6:group-523E9F1AD0E9 changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 13:09:47,539 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7470c307-ee5b-484a-a1b3-0676a78111b6: start FollowerState
2019-06-18 13:09:47,541 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-523E9F1AD0E9,id=7470c307-ee5b-484a-a1b3-0676a78111b6
2019-06-18 13:09:48,667 INFO  impl.FollowerState (FollowerState.java:run(101)) - 7470c307-ee5b-484a-a1b3-0676a78111b6:group-523E9F1AD0E9 changes to CANDIDATE, lastRpcTime:1128, electionTimeout:1127ms
2019-06-18 13:09:48,667 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 7470c307-ee5b-484a-a1b3-0676a78111b6: shutdown FollowerState
2019-06-18 13:09:48,667 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7470c307-ee5b-484a-a1b3-0676a78111b6:group-523E9F1AD0E9 changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 13:09:48,668 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7470c307-ee5b-484a-a1b3-0676a78111b6: start LeaderElection
2019-06-18 13:09:48,672 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 7470c307-ee5b-484a-a1b3-0676a78111b6:group-523E9F1AD0E9:LeaderElection4: begin an election at term 1 for -1: [7470c307-ee5b-484a-a1b3-0676a78111b6:127.0.0.1:32829], old=null
2019-06-18 13:09:48,672 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 7470c307-ee5b-484a-a1b3-0676a78111b6: shutdown LeaderElection
2019-06-18 13:09:48,673 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 7470c307-ee5b-484a-a1b3-0676a78111b6:group-523E9F1AD0E9 changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 13:09:48,673 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 7470c307-ee5b-484a-a1b3-0676a78111b6:group-523E9F1AD0E9 change Leader from null to 7470c307-ee5b-484a-a1b3-0676a78111b6 at term 1 for becomeLeader, leader elected after 1139ms
2019-06-18 13:09:48,673 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 13:09:48,673 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 13:09:48,673 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 13:09:48,674 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 13:09:48,674 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 7470c307-ee5b-484a-a1b3-0676a78111b6: start LeaderState
2019-06-18 13:09:48,674 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 7470c307-ee5b-484a-a1b3-0676a78111b6-RaftLogWorker: Starting segment from index:0
2019-06-18 13:09:48,682 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 7470c307-ee5b-484a-a1b3-0676a78111b6:group-523E9F1AD0E9 set configuration 0: [7470c307-ee5b-484a-a1b3-0676a78111b6:127.0.0.1:32829], old=null at 0
2019-06-18 13:09:48,721 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 7470c307-ee5b-484a-a1b3-0676a78111b6-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler89bf63ea-3d2c-4a3a-be93-c53501b4b827/ratis/834af11f-0569-4154-9b32-523e9f1ad0e9/current/log_inprogress_0
2019-06-18 13:09:49,591 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 5602901305029382886 is closed with bcsId 0.
2019-06-18 13:09:49,591 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 13:09:49,592 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 7470c307-ee5b-484a-a1b3-0676a78111b6: close
2019-06-18 13:09:49,592 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 7470c307-ee5b-484a-a1b3-0676a78111b6: shutdown group-523E9F1AD0E9
2019-06-18 13:09:49,592 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-523E9F1AD0E9,id=7470c307-ee5b-484a-a1b3-0676a78111b6
2019-06-18 13:09:49,593 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 7470c307-ee5b-484a-a1b3-0676a78111b6: shutdown LeaderState
2019-06-18 13:09:49,593 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 7470c307-ee5b-484a-a1b3-0676a78111b6-PendingRequests: sendNotLeaderResponses
2019-06-18 13:09:49,594 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-7470c307-ee5b-484a-a1b3-0676a78111b6-group-523E9F1AD0E9: set stopIndex = 2
2019-06-18 13:09:49,594 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:2)
2019-06-18 13:09:49,595 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler89bf63ea-3d2c-4a3a-be93-c53501b4b827/ratis/834af11f-0569-4154-9b32-523e9f1ad0e9/sm/snapshot.1_2
2019-06-18 13:09:49,595 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 7470c307-ee5b-484a-a1b3-0676a78111b6:group-523E9F1AD0E9 closes. The last applied log index is 2
2019-06-18 13:09:49,596 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 7470c307-ee5b-484a-a1b3-0676a78111b6-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 13:09:49,597 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 7470c307-ee5b-484a-a1b3-0676a78111b6-RaftLogWorker close()
2019-06-18 13:09:49,598 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 7470c307-ee5b-484a-a1b3-0676a78111b6: shutdown server with port 32829 now
2019-06-18 13:09:49,600 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 7470c307-ee5b-484a-a1b3-0676a78111b6: shutdown server with port 32829 successfully
2019-06-18 13:09:49,605 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2019-06-18 13:09:49,634 INFO  volume.HddsVolume (HddsVolume.java:<init>(176)) - Creating Volume: /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler19b64af3-7812-4459-b533-2554e78ec6dd/hdds of  storage type : DISK and capacity : 104021790720
2019-06-18 13:09:49,634 INFO  volume.VolumeSet (VolumeSet.java:initializeVolumeSet(170)) - Added Volume : /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler19b64af3-7812-4459-b533-2554e78ec6dd/hdds to VolumeSet
2019-06-18 13:09:49,634 INFO  volume.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(140)) - Scheduling a check for org.apache.hadoop.ozone.container.common.volume.HddsVolume@68217d41
2019-06-18 13:09:49,635 INFO  volume.HddsVolumeChecker (HddsVolumeChecker.java:checkAllVolumes(203)) - Scheduled health check for volume org.apache.hadoop.ozone.container.common.volume.HddsVolume@68217d41
2019-06-18 13:09:49,665 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:newXceiverServerRatis(401)) - Found a free port for the server : 36529
2019-06-18 13:09:49,666 WARN  scm.HddsServerUtil (HddsServerUtil.java:getDefaultRatisDirectory(354)) - Storage directory for Ratis is not configured. It is a good idea to map this to an SSD disk. Falling back to ozone.metadata.dirs
2019-06-18 13:09:49,666 INFO  impl.RaftServerProxy (ConfUtils.java:logGet(43)) - raft.rpc.type = GRPC (default)
2019-06-18 13:09:49,667 INFO  grpc.GrpcConfigKeys$Server (ConfUtils.java:logGet(43)) - raft.grpc.server.port = 36529 (custom)
2019-06-18 13:09:49,667 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.message.size.max = 33570816 (custom)
2019-06-18 13:09:49,667 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 13:09:49,667 INFO  server.GrpcService (ConfUtils.java:logGet(43)) - raft.grpc.flow.control.window = 1MB (=1048576) (default)
2019-06-18 13:09:49,668 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.request.timeout = 3000ms (default)
2019-06-18 13:09:49,668 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler19b64af3-7812-4459-b533-2554e78ec6dd/ratis] (custom)
2019-06-18 13:09:49,669 INFO  server.XceiverServerGrpc (XceiverServerGrpc.java:<init>(97)) - Found a free port for the server : 35611
2019-06-18 13:09:49,669 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:start(186)) - Attempting to start container services.
2019-06-18 13:09:49,669 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:startContainerScrub(160)) - Background container scrubber has been disabled by hdds.containerscrub.enabled
2019-06-18 13:09:49,669 INFO  ratis.XceiverServerRatis (XceiverServerRatis.java:start(418)) - Starting XceiverServerRatis 9d60a119-48ea-445a-ac63-bd1f0a66c974 at port 36529
2019-06-18 13:09:49,685 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$start$3(299)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974: start RPC server
2019-06-18 13:09:49,694 INFO  server.GrpcService (GrpcService.java:startImpl(148)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974: GrpcService started, listening on 0.0.0.0/0.0.0.0:36529
2019-06-18 13:09:49,717 INFO  impl.RaftServerProxy (RaftServerProxy.java:addNew(89)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974: addNew group-A0EC2F1BC86B:[9d60a119-48ea-445a-ac63-bd1f0a66c974:127.0.0.1:36529] returns group-A0EC2F1BC86B:java.util.concurrent.CompletableFuture@594e3f50[Not completed]
2019-06-18 13:09:49,718 INFO  impl.RaftServerImpl (RaftServerImpl.java:<init>(91)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974: new RaftServerImpl for group-A0EC2F1BC86B:[9d60a119-48ea-445a-ac63-bd1f0a66c974:127.0.0.1:36529] with ContainerStateMachine:uninitialized
2019-06-18 13:09:49,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.min = 1s (custom)
2019-06-18 13:09:49,718 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.timeout.max = 1200ms (custom)
2019-06-18 13:09:49,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpcslowness.timeout = 120s (custom)
2019-06-18 13:09:49,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.install.snapshot.enabled = true (default)
2019-06-18 13:09:49,719 INFO  impl.RaftServerImpl (ServerState.java:<init>(101)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974:group-A0EC2F1BC86B ConfigurationManager, init=-1: [9d60a119-48ea-445a-ac63-bd1f0a66c974:127.0.0.1:36529], old=null, confs=<EMPTY_MAP>
2019-06-18 13:09:49,719 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.storage.dir = [/opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler19b64af3-7812-4459-b533-2554e78ec6dd/ratis] (custom)
2019-06-18 13:09:49,720 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:analyzeStorage(246)) - The storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler19b64af3-7812-4459-b533-2554e78ec6dd/ratis/30a085a8-6486-4691-8913-a0ec2f1bc86b does not exist. Creating ...
2019-06-18 13:09:49,722 INFO  storage.RaftStorageDirectory (RaftStorageDirectory.java:tryLock(328)) - Lock on /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler19b64af3-7812-4459-b533-2554e78ec6dd/ratis/30a085a8-6486-4691-8913-a0ec2f1bc86b/in_use.lock acquired by nodename 4317@ozone-unit-076618677d3lz5ll-188941294
2019-06-18 13:09:49,725 INFO  storage.RaftStorage (RaftStorage.java:format(75)) - Storage directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler19b64af3-7812-4459-b533-2554e78ec6dd/ratis/30a085a8-6486-4691-8913-a0ec2f1bc86b has been successfully formatted.
2019-06-18 13:09:49,725 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:loadSnapshot(199)) - The snapshot info is null.Setting the last applied index to:(t:0, i:~)
2019-06-18 13:09:49,725 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.leader.election.timeout = 120s (custom)
2019-06-18 13:09:49,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.use.memory = false (default)
2019-06-18 13:09:49,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.appender.buffer.byte-limit = 33554432 (custom)
2019-06-18 13:09:49,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 13:09:49,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.cache.num.max = 2 (custom)
2019-06-18 13:09:49,726 INFO  storage.RaftLogWorker (RaftLogWorker.java:<init>(123)) - new 9d60a119-48ea-445a-ac63-bd1f0a66c974-RaftLogWorker for Storage Directory /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler19b64af3-7812-4459-b533-2554e78ec6dd/ratis/30a085a8-6486-4691-8913-a0ec2f1bc86b
2019-06-18 13:09:49,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.byte-limit = 2147483647 (custom)
2019-06-18 13:09:49,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.queue.element-limit = 1024 (custom)
2019-06-18 13:09:49,726 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.segment.size.max = 16384 (custom)
2019-06-18 13:09:49,727 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.preallocated.size = 16384 (custom)
2019-06-18 13:09:49,727 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.write.buffer.size = 33554432 (custom)
2019-06-18 13:09:49,727 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.force.sync.num = 128 (default)
2019-06-18 13:09:49,727 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync = true (default)
2019-06-18 13:09:49,727 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout = 10s (default)
2019-06-18 13:09:49,727 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.sync.timeout.retry = -1 (default)
2019-06-18 13:09:49,727 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.log.statemachine.data.caching.enabled = true (custom)
2019-06-18 13:09:49,728 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.enabled = true (custom)
2019-06-18 13:09:49,728 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.snapshot.auto.trigger.threshold = 10000 (custom)
2019-06-18 13:09:49,728 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.retrycache.expirytime = 600000ms (custom)
2019-06-18 13:09:49,728 INFO  impl.RaftServerImpl (RaftServerImpl.java:start(173)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974: start group-A0EC2F1BC86B
2019-06-18 13:09:49,728 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974:group-A0EC2F1BC86B changes role from null to FOLLOWER at term 0 for startAsFollower
2019-06-18 13:09:49,728 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974: start FollowerState
2019-06-18 13:09:49,728 INFO  util.JmxRegister (JmxRegister.java:tryRegister(44)) - Successfully registered JMX Bean with object name Ratis:service=RaftServer,group=group-A0EC2F1BC86B,id=9d60a119-48ea-445a-ac63-bd1f0a66c974
2019-06-18 13:09:50,927 INFO  impl.FollowerState (FollowerState.java:run(101)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974:group-A0EC2F1BC86B changes to CANDIDATE, lastRpcTime:1199, electionTimeout:1199ms
2019-06-18 13:09:50,928 INFO  impl.RoleInfo (RoleInfo.java:shutdownFollowerState(121)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974: shutdown FollowerState
2019-06-18 13:09:50,928 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974:group-A0EC2F1BC86B changes role from FOLLOWER to CANDIDATE at term 0 for changeToCandidate
2019-06-18 13:09:50,928 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974: start LeaderElection
2019-06-18 13:09:50,932 INFO  impl.LeaderElection (LeaderElection.java:askForVotes(181)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974:group-A0EC2F1BC86B:LeaderElection5: begin an election at term 1 for -1: [9d60a119-48ea-445a-ac63-bd1f0a66c974:127.0.0.1:36529], old=null
2019-06-18 13:09:50,932 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderElection(134)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974: shutdown LeaderElection
2019-06-18 13:09:50,932 INFO  impl.RaftServerImpl (RaftServerImpl.java:setRole(164)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974:group-A0EC2F1BC86B changes role from CANDIDATE to LEADER at term 1 for changeToLeader
2019-06-18 13:09:50,932 INFO  impl.RaftServerImpl (ServerState.java:setLeader(263)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974:group-A0EC2F1BC86B change Leader from null to 9d60a119-48ea-445a-ac63-bd1f0a66c974 at term 1 for becomeLeader, leader elected after 1207ms
2019-06-18 13:09:50,933 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.staging.catchup.gap = 1000 (default)
2019-06-18 13:09:50,933 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.rpc.sleep.time = 25ms (default)
2019-06-18 13:09:50,933 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout = 10s (default)
2019-06-18 13:09:50,933 INFO  server.RaftServerConfigKeys (ConfUtils.java:logGet(43)) - raft.server.watch.timeout.denomination = 1s (default)
2019-06-18 13:09:50,933 INFO  impl.RoleInfo (RoleInfo.java:updateAndGet(143)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974: start LeaderState
2019-06-18 13:09:50,934 INFO  storage.RaftLogWorker (RaftLogWorker.java:startLogSegment(298)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974-RaftLogWorker: Starting segment from index:0
2019-06-18 13:09:50,934 INFO  impl.RaftServerImpl (ServerState.java:setRaftConf(361)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974:group-A0EC2F1BC86B set configuration 0: [9d60a119-48ea-445a-ac63-bd1f0a66c974:127.0.0.1:36529], old=null at 0
2019-06-18 13:09:50,975 INFO  storage.RaftLogWorker (RaftLogWorker.java:execute(469)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974-RaftLogWorker: created new log segment /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler19b64af3-7812-4459-b533-2554e78ec6dd/ratis/30a085a8-6486-4691-8913-a0ec2f1bc86b/current/log_inprogress_0
2019-06-18 13:09:51,791 INFO  interfaces.Container (KeyValueContainer.java:compactDB(356)) - Container 2677333003090269653 is closed with bcsId 0.
2019-06-18 13:09:51,794 INFO  ozoneimpl.OzoneContainer (OzoneContainer.java:stop(199)) - Attempting to stop container services.
2019-06-18 13:09:51,794 INFO  impl.RaftServerProxy (RaftServerProxy.java:lambda$close$4(314)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974: close
2019-06-18 13:09:51,794 INFO  impl.RaftServerImpl (RaftServerImpl.java:lambda$shutdown$3(238)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974: shutdown group-A0EC2F1BC86B
2019-06-18 13:09:51,794 INFO  util.JmxRegister (JmxRegister.java:unregister(73)) - Successfully un-registered JMX Bean with object name Ratis:service=RaftServer,group=group-A0EC2F1BC86B,id=9d60a119-48ea-445a-ac63-bd1f0a66c974
2019-06-18 13:09:51,795 INFO  impl.RoleInfo (RoleInfo.java:shutdownLeaderState(104)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974: shutdown LeaderState
2019-06-18 13:09:51,796 INFO  impl.PendingRequests (PendingRequests.java:sendNotLeaderResponses(140)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974-PendingRequests: sendNotLeaderResponses
2019-06-18 13:09:51,797 INFO  impl.StateMachineUpdater (StateMachineUpdater.java:stopAndJoin(109)) - StateMachineUpdater-9d60a119-48ea-445a-ac63-bd1f0a66c974-group-A0EC2F1BC86B: set stopIndex = 4
2019-06-18 13:09:51,798 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(245)) - Taking snapshot at termIndex:(t:1, i:4)
2019-06-18 13:09:51,798 INFO  ratis.ContainerStateMachine (ContainerStateMachine.java:takeSnapshot(249)) - Taking a snapshot to file /opt/src/hadoop-hdds/container-service/target/test-dir/org.apache.hadoop.ozone.container.common.statemachine.commandhandler.TestCloseContainerCommandHandler19b64af3-7812-4459-b533-2554e78ec6dd/ratis/30a085a8-6486-4691-8913-a0ec2f1bc86b/sm/snapshot.1_4
2019-06-18 13:09:51,799 INFO  impl.RaftServerImpl (ServerState.java:close(394)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974:group-A0EC2F1BC86B closes. The last applied log index is 4
2019-06-18 13:09:51,799 INFO  storage.RaftLogWorker (RaftLogWorker.java:run(236)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974-RaftLogWorker was interrupted, exiting. There are 0 tasks remaining in the queue.
2019-06-18 13:09:51,800 INFO  storage.RaftLogWorker (RaftLogWorker.java:close(168)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974-RaftLogWorker close()
2019-06-18 13:09:51,801 INFO  server.GrpcService (GrpcService.java:closeImpl(154)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974: shutdown server with port 36529 now
2019-06-18 13:09:51,803 INFO  server.GrpcService (GrpcService.java:closeImpl(162)) - 9d60a119-48ea-445a-ac63-bd1f0a66c974: shutdown server with port 36529 successfully
2019-06-18 13:09:51,809 WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
